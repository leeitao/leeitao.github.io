(function(){var requirejs,require,define;(function(e){var t,r,i,n,a={},o={},s={},l={},u=Object.prototype.hasOwnProperty,c=[].slice,d=/\.js$/;function f(e,t){return u.call(e,t)}function h(e,t){var r,i,n,a,o,l,u,c,f,h,p,m,v=t&&t.split("/"),g=s.map,_=g&&g["*"]||{};if(e){e=e.split("/");o=e.length-1;if(s.nodeIdCompat&&d.test(e[o])){e[o]=e[o].replace(d,"")}if(e[0].charAt(0)==="."&&v){m=v.slice(0,v.length-1);e=m.concat(e)}for(f=0;f<e.length;f++){p=e[f];if(p==="."){e.splice(f,1);f-=1}else if(p===".."){if(f===0||f===1&&e[2]===".."||e[f-1]===".."){continue}else if(f>0){e.splice(f-1,2);f-=2}}}e=e.join("/")}if((v||_)&&g){r=e.split("/");for(f=r.length;f>0;f-=1){i=r.slice(0,f).join("/");if(v){for(h=v.length;h>0;h-=1){n=g[v.slice(0,h).join("/")];if(n){n=n[i];if(n){a=n;l=f;break}}}}if(a){break}if(!u&&_&&_[i]){u=_[i];c=f}}if(!a&&u){a=u;l=c}if(a){r.splice(0,l,a);e=r.join("/")}}return e}function p(t,i){return function(){var n=c.call(arguments,0);if(typeof n[0]!=="string"&&n.length===1){n.push(null)}return r.apply(e,n.concat([t,i]))}}function m(e){return function(t){return h(t,e)}}function v(e){return function(t){a[e]=t}}function g(r){if(f(o,r)){var i=o[r];delete o[r];l[r]=true;t.apply(e,i)}if(!f(a,r)&&!f(l,r)){throw new Error("No "+r)}return a[r]}function _(e){var t,r=e?e.indexOf("!"):-1;if(r>-1){t=e.substring(0,r);e=e.substring(r+1,e.length)}return[t,e]}function y(e){return e?_(e):[]}i=function(e,t){var r,i=_(e),n=i[0],a=t[1];e=i[1];if(n){n=h(n,a);r=g(n)}if(n){if(r&&r.normalize){e=r.normalize(e,m(a))}else{e=h(e,a)}}else{e=h(e,a);i=_(e);n=i[0];e=i[1];if(n){r=g(n)}}return{f:n?n+"!"+e:e,n:e,pr:n,p:r}};function b(e){return function(){return s&&s.config&&s.config[e]||{}}}n={require:function(e){return p(e)},exports:function(e){var t=a[e];if(typeof t!=="undefined"){return t}else{return a[e]={}}},module:function(e){return{id:e,uri:"",exports:a[e],config:b(e)}}};t=function(t,r,s,u){var c,d,h,m,_,b,w=[],C=typeof s,S;u=u||t;b=y(u);if(C==="undefined"||C==="function"){r=!r.length&&s.length?["require","exports","module"]:r;for(_=0;_<r.length;_+=1){m=i(r[_],b);d=m.f;if(d==="require"){w[_]=n.require(t)}else if(d==="exports"){w[_]=n.exports(t);S=true}else if(d==="module"){c=w[_]=n.module(t)}else if(f(a,d)||f(o,d)||f(l,d)){w[_]=g(d)}else if(m.p){m.p.load(m.n,p(u,true),v(d),{});w[_]=a[d]}else{throw new Error(t+" missing "+d)}}h=s?s.apply(a[t],w):undefined;if(t){if(c&&c.exports!==e&&c.exports!==a[t]){a[t]=c.exports}else if(h!==e||!S){a[t]=h}}}else if(t){a[t]=s}};requirejs=require=r=function(a,o,l,u,c){if(typeof a==="string"){if(n[a]){return n[a](o)}return g(i(a,y(o)).f)}else if(!a.splice){s=a;if(s.deps){r(s.deps,s.callback)}if(!o){return}if(o.splice){a=o;o=l;l=null}else{a=e}}o=o||function(){};if(typeof l==="function"){l=u;u=c}if(u){t(e,a,o,l)}else{setTimeout(function(){t(e,a,o,l)},4)}return r};r.config=function(e){return r(e)};requirejs._defined=a;define=function(e,t,r){if(typeof e!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!t.splice){r=t;t=[]}if(!f(a,e)&&!f(o,e)){o[e]=[e,t,r]}};define.amd={jQuery:true}})();define("Core/appendForwardSlash",[],function(){"use strict";function e(e){if(e.length===0||e[e.length-1]!=="/"){e=e+"/"}return e}return e});define("Core/defined",[],function(){"use strict";function e(e){return e!==undefined&&e!==null}return e});define("Core/DeveloperError",["./defined"],function(e){"use strict";function t(e){this.name="DeveloperError";this.message=e;var t;try{throw new Error}catch(e){t=e.stack}this.stack=t}if(e(Object.create)){t.prototype=Object.create(Error.prototype);t.prototype.constructor=t}t.prototype.toString=function(){var t=this.name+": "+this.message;if(e(this.stack)){t+="\n"+this.stack.toString()}return t};t.throwInstantiationError=function(){throw new t("This function defines an interface and should not be called directly.")};return t});define("Core/Check",["./defined","./DeveloperError"],function(e,t){"use strict";var r={};r.typeOf={};function i(e){return e+" is required, actual value was undefined"}function n(e,t,r){return"Expected "+r+" to be typeof "+t+", actual typeof was "+e}r.defined=function(r,n){if(!e(n)){throw new t(i(r))}};r.typeOf.func=function(e,r){if(typeof r!=="function"){throw new t(n(typeof r,"function",e))}};r.typeOf.string=function(e,r){if(typeof r!=="string"){throw new t(n(typeof r,"string",e))}};r.typeOf.number=function(e,r){if(typeof r!=="number"){throw new t(n(typeof r,"number",e))}};r.typeOf.number.lessThan=function(e,i,n){r.typeOf.number(e,i);if(i>=n){throw new t("Expected "+e+" to be less than "+n+", actual value was "+i)}};r.typeOf.number.lessThanOrEquals=function(e,i,n){r.typeOf.number(e,i);if(i>n){throw new t("Expected "+e+" to be less than or equal to "+n+", actual value was "+i)}};r.typeOf.number.greaterThan=function(e,i,n){r.typeOf.number(e,i);if(i<=n){throw new t("Expected "+e+" to be greater than "+n+", actual value was "+i)}};r.typeOf.number.greaterThanOrEquals=function(e,i,n){r.typeOf.number(e,i);if(i<n){throw new t("Expected "+e+" to be greater than or equal to"+n+", actual value was "+i)}};r.typeOf.object=function(e,r){if(typeof r!=="object"){throw new t(n(typeof r,"object",e))}};r.typeOf.bool=function(e,r){if(typeof r!=="boolean"){throw new t(n(typeof r,"boolean",e))}};r.typeOf.number.equals=function(e,i,n,a){r.typeOf.number(e,n);r.typeOf.number(i,a);if(n!==a){throw new t(e+" must be equal to "+i+", the actual values are "+n+" and "+a)}};return r});define("Core/freezeObject",["./defined"],function(e){"use strict";var t=Object.freeze;if(!e(t)){t=function(e){return e}}return t});define("Core/defaultValue",["./freezeObject"],function(e){"use strict";function t(e,t){if(e!==undefined&&e!==null){return e}return t}t.EMPTY_OBJECT=e({});return t});define("Core/arrayFill",["./Check","./defaultValue","./defined"],function(e,t,r){"use strict";function i(i,n,a,o){e.defined("array",i);e.defined("value",n);if(r(a)){e.typeOf.number("start",a)}if(r(o)){e.typeOf.number("end",o)}if(typeof i.fill==="function"){return i.fill(n,a,o)}var s=i.length>>>0;var l=t(a,0);var u=l<0?Math.max(s+l,0):Math.min(l,s);var c=t(o,s);var d=c<0?Math.max(s+c,0):Math.min(c,s);while(u<d){i[u]=n;u++}return i}return i});define("ThirdParty/mersenne-twister",[],function(){var e=function(e){if(e==undefined){e=(new Date).getTime()}this.N=624;this.M=397;this.MATRIX_A=2567483615;this.UPPER_MASK=2147483648;this.LOWER_MASK=2147483647;this.mt=new Array(this.N);this.mti=this.N+1;this.init_genrand(e)};e.prototype.init_genrand=function(e){this.mt[0]=e>>>0;for(this.mti=1;this.mti<this.N;this.mti++){var e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti;this.mt[this.mti]>>>=0}};e.prototype.genrand_int32=function(){var e;var t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var r;if(this.mti==this.N+1)this.init_genrand(5489);for(r=0;r<this.N-this.M;r++){e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK;this.mt[r]=this.mt[r+this.M]^e>>>1^t[e&1]}for(;r<this.N-1;r++){e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK;this.mt[r]=this.mt[r+(this.M-this.N)]^e>>>1^t[e&1]}e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK;this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[e&1];this.mti=0}e=this.mt[this.mti++];e^=e>>>11;e^=e<<7&2636928640;e^=e<<15&4022730752;e^=e>>>18;return e>>>0};e.prototype.random=function(){return this.genrand_int32()*(1/4294967296)};return e});define("Core/Math",["../ThirdParty/mersenne-twister","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i){"use strict";var n={};n.EPSILON1=.1;n.EPSILON2=.01;n.EPSILON3=.001;n.EPSILON4=1e-4;n.EPSILON5=1e-5;n.EPSILON6=1e-6;n.EPSILON7=1e-7;n.EPSILON8=1e-8;n.EPSILON9=1e-9;n.EPSILON10=1e-10;n.EPSILON11=1e-11;n.EPSILON12=1e-12;n.EPSILON13=1e-13;n.EPSILON14=1e-14;n.EPSILON15=1e-15;n.EPSILON16=1e-16;n.EPSILON17=1e-17;n.EPSILON18=1e-18;n.EPSILON19=1e-19;n.EPSILON20=1e-20;n.GRAVITATIONALPARAMETER=3986004418e5;n.SOLAR_RADIUS=6955e5;n.LUNAR_RADIUS=1737400;n.SIXTY_FOUR_KILOBYTES=64*1024;n.sign=function(e){if(e>0){return 1}if(e<0){return-1}return 0};n.signNotZero=function(e){return e<0?-1:1};n.toSNorm=function(e,r){r=t(r,255);return Math.round((n.clamp(e,-1,1)*.5+.5)*r)};n.fromSNorm=function(e,r){r=t(r,255);return n.clamp(e,0,r)/r*2-1};n.sinh=function(e){var t=Math.pow(Math.E,e);var r=Math.pow(Math.E,-1*e);return(t-r)*.5};n.cosh=function(e){var t=Math.pow(Math.E,e);var r=Math.pow(Math.E,-1*e);return(t+r)*.5};n.lerp=function(e,t,r){return(1-r)*e+r*t};n.PI=Math.PI;n.ONE_OVER_PI=1/Math.PI;n.PI_OVER_TWO=Math.PI*.5;n.PI_OVER_THREE=Math.PI/3;n.PI_OVER_FOUR=Math.PI/4;n.PI_OVER_SIX=Math.PI/6;n.THREE_PI_OVER_TWO=3*Math.PI*.5;n.TWO_PI=2*Math.PI;n.ONE_OVER_TWO_PI=1/(2*Math.PI);n.RADIANS_PER_DEGREE=Math.PI/180;n.DEGREES_PER_RADIAN=180/Math.PI;n.RADIANS_PER_ARCSECOND=n.RADIANS_PER_DEGREE/3600;n.toRadians=function(e){if(!r(e)){throw new i("degrees is required.")}return e*n.RADIANS_PER_DEGREE};n.toDegrees=function(e){if(!r(e)){throw new i("radians is required.")}return e*n.DEGREES_PER_RADIAN};n.convertLongitudeRange=function(e){if(!r(e)){throw new i("angle is required.")}var t=n.TWO_PI;var a=e-Math.floor(e/t)*t;if(a<-Math.PI){return a+t}if(a>=Math.PI){return a-t}return a};n.clampToLatitudeRange=function(e){if(!r(e)){throw new i("angle is required.")}return n.clamp(e,-1*n.PI_OVER_TWO,n.PI_OVER_TWO)};n.negativePiToPi=function(e){if(!r(e)){throw new i("angle is required.")}return n.zeroToTwoPi(e+n.PI)-n.PI};n.zeroToTwoPi=function(e){if(!r(e)){throw new i("angle is required.")}var t=n.mod(e,n.TWO_PI);if(Math.abs(t)<n.EPSILON14&&Math.abs(e)>n.EPSILON14){return n.TWO_PI}return t};n.mod=function(e,t){if(!r(e)){throw new i("m is required.")}if(!r(t)){throw new i("n is required.")}return(e%t+t)%t};n.equalsEpsilon=function(e,n,a,o){if(!r(e)){throw new i("left is required.")}if(!r(n)){throw new i("right is required.")}if(!r(a)){throw new i("relativeEpsilon is required.")}o=t(o,a);var s=Math.abs(e-n);return s<=o||s<=a*Math.max(Math.abs(e),Math.abs(n))};var a=[1];n.factorial=function(e){if(typeof e!=="number"||e<0){throw new i("A number greater than or equal to 0 is required.")}var t=a.length;if(e>=t){var r=a[t-1];for(var n=t;n<=e;n++){a.push(r*n)}}return a[e]};n.incrementWrap=function(e,n,a){a=t(a,0);if(!r(e)){throw new i("n is required.")}if(n<=a){throw new i("maximumValue must be greater than minimumValue.")}++e;if(e>n){e=a}return e};n.isPowerOfTwo=function(e){if(typeof e!=="number"||e<0){throw new i("A number greater than or equal to 0 is required.")}return e!==0&&(e&e-1)===0};n.nextPowerOfTwo=function(e){if(typeof e!=="number"||e<0){throw new i("A number greater than or equal to 0 is required.")}--e;e|=e>>1;e|=e>>2;e|=e>>4;e|=e>>8;e|=e>>16;++e;return e};n.clamp=function(e,t,n){if(!r(e)){throw new i("value is required")}if(!r(t)){throw new i("min is required.")}if(!r(n)){throw new i("max is required.")}return e<t?t:e>n?n:e};var o=new e;n.setRandomNumberSeed=function(t){if(!r(t)){throw new i("seed is required.")}o=new e(t)};n.nextRandomNumber=function(){return o.random()};n.randomBetween=function(e,t){return n.nextRandomNumber()*(t-e)+e};n.acosClamped=function(e){if(!r(e)){throw new i("value is required.")}return Math.acos(n.clamp(e,-1,1))};n.asinClamped=function(e){if(!r(e)){throw new i("value is required.")}return Math.asin(n.clamp(e,-1,1))};n.chordLength=function(e,t){if(!r(e)){throw new i("angle is required.")}if(!r(t)){throw new i("radius is required.")}return 2*t*Math.sin(e*.5)};n.logBase=function(e,t){if(!r(e)){throw new i("number is required.")}if(!r(t)){throw new i("base is required.")}return Math.log(e)/Math.log(t)};n.fog=function(e,t){var r=e*t;return 1-Math.exp(-(r*r))};return n});define("Core/arrayRemoveDuplicates",["./Check","./defaultValue","./defined","./Math"],function(e,t,r,i){"use strict";var n=i.EPSILON10;function a(i,a,o){e.defined("equalsEpsilon",a);if(!r(i)){return undefined}o=t(o,false);var s=i.length;if(s<2){return i}var l;var u;var c;for(l=1;l<s;++l){u=i[l-1];c=i[l];if(a(u,c,n)){break}}if(l===s){if(o&&a(i[0],i[i.length-1],n)){return i.slice(1)}return i}var d=i.slice(0,l);for(;l<s;++l){c=i[l];if(!a(u,c,n)){d.push(c);u=c}}if(o&&d.length>1&&a(d[0],d[d.length-1],n)){d.shift()}return d}return a});define("Core/defineProperties",["./defined"],function(e){"use strict";var t=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return false}}();var r=Object.defineProperties;if(!t||!e(r)){r=function(e){return e}}return r});define("Core/AssociativeArray",["./defined","./defineProperties","./DeveloperError"],function(e,t,r){"use strict";function i(){this._array=[];this._hash={}}t(i.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}});i.prototype.contains=function(t){if(typeof t!=="string"&&typeof t!=="number"){throw new r("key is required to be a string or number.")}return e(this._hash[t])};i.prototype.set=function(e,t){if(typeof e!=="string"&&typeof e!=="number"){throw new r("key is required to be a string or number.")}var i=this._hash[e];if(t!==i){this.remove(e);this._hash[e]=t;this._array.push(t)}};i.prototype.get=function(e){if(typeof e!=="string"&&typeof e!=="number"){throw new r("key is required to be a string or number.")}return this._hash[e]};i.prototype.remove=function(t){if(e(t)&&typeof t!=="string"&&typeof t!=="number"){throw new r("key is required to be a string or number.")}var i=this._hash[t];var n=e(i);if(n){var a=this._array;a.splice(a.indexOf(i),1);delete this._hash[t]}return n};i.prototype.removeAll=function(){var e=this._array;if(e.length>0){this._hash={};e.length=0}};return i});define("Core/Cartesian2",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,r,i,n,a){"use strict";function o(e,r){this.x=t(e,0);this.y=t(r,0)}o.fromElements=function(e,t,i){if(!r(i)){return new o(e,t)}i.x=e;i.y=t;return i};o.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new o(e.x,e.y)}t.x=e.x;t.y=e.y;return t};o.fromCartesian3=o.clone;o.fromCartesian4=o.clone;o.packedLength=2;o.pack=function(r,i,n){e.typeOf.object("value",r);e.defined("array",i);n=t(n,0);i[n++]=r.x;i[n]=r.y;return i};o.unpack=function(i,n,a){e.defined("array",i);n=t(n,0);if(!r(a)){a=new o}a.x=i[n++];a.y=i[n];return a};o.packArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n*2)}else{i.length=n*2}for(var a=0;a<n;++a){o.pack(t[a],i,a*2)}return i};o.unpackArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n/2)}else{i.length=n/2}for(var a=0;a<n;a+=2){var s=a/2;i[s]=o.unpack(t,a,i[s])}return i};o.fromArray=o.unpack;o.maximumComponent=function(t){e.typeOf.object("cartesian",t);return Math.max(t.x,t.y)};o.minimumComponent=function(t){e.typeOf.object("cartesian",t);return Math.min(t.x,t.y)};o.minimumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.min(t.x,r.x);i.y=Math.min(t.y,r.y);return i};o.maximumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.max(t.x,r.x);i.y=Math.max(t.y,r.y);return i};o.magnitudeSquared=function(t){e.typeOf.object("cartesian",t);return t.x*t.x+t.y*t.y};o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitude(s)};o.distanceSquared=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitudeSquared(s)};o.normalize=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var n=o.magnitude(t);r.x=t.x/n;r.y=t.y/n;if(isNaN(r.x)||isNaN(r.y)){throw new i("normalized result is not a number")}return r};o.dot=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);return t.x*r.x+t.y*r.y};o.multiplyComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x*r.x;i.y=t.y*r.y;return i};o.divideComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x/r.x;i.y=t.y/r.y;return i};o.add=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x+r.x;i.y=t.y+r.y;return i};o.subtract=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x-r.x;i.y=t.y-r.y;return i};o.multiplyByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x*r;i.y=t.y*r;return i};o.divideByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x/r;i.y=t.y/r;return i};o.negate=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=-t.x;r.y=-t.y;return r};o.abs=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=Math.abs(t.x);r.y=Math.abs(t.y);return r};var l=new o;o.lerp=function(t,r,i,n){e.typeOf.object("start",t);e.typeOf.object("end",r);e.typeOf.number("t",i);e.typeOf.object("result",n);o.multiplyByScalar(r,i,l);n=o.multiplyByScalar(t,1-i,n);return o.add(l,n,n)};var u=new o;var c=new o;o.angleBetween=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.normalize(t,u);o.normalize(r,c);return a.acosClamped(o.dot(u,c))};var d=new o;o.mostOrthogonalAxis=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var i=o.normalize(t,d);o.abs(i,i);if(i.x<=i.y){r=o.clone(o.UNIT_X,r)}else{r=o.clone(o.UNIT_Y,r)}return r};o.equals=function(e,t){return e===t||r(e)&&r(t)&&e.x===t.x&&e.y===t.y};o.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]};o.equalsEpsilon=function(e,t,i,n){return e===t||r(e)&&r(t)&&a.equalsEpsilon(e.x,t.x,i,n)&&a.equalsEpsilon(e.y,t.y,i,n)};o.ZERO=n(new o(0,0));o.UNIT_X=n(new o(1,0));o.UNIT_Y=n(new o(0,1));o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e){return o.equals(this,e)};o.prototype.equalsEpsilon=function(e,t,r){return o.equalsEpsilon(this,e,t,r)};o.prototype.toString=function(){return"("+this.x+", "+this.y+")"};return o});define("Core/Cartesian3",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,r,i,n,a){"use strict";function o(e,r,i){this.x=t(e,0);this.y=t(r,0);this.z=t(i,0)}o.fromSpherical=function(i,n){e.typeOf.object("spherical",i);if(!r(n)){n=new o}var a=i.clock;var s=i.cone;var l=t(i.magnitude,1);var u=l*Math.sin(s);n.x=u*Math.cos(a);n.y=u*Math.sin(a);n.z=l*Math.cos(s);return n};o.fromElements=function(e,t,i,n){if(!r(n)){return new o(e,t,i)}n.x=e;n.y=t;n.z=i;return n};o.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new o(e.x,e.y,e.z)}t.x=e.x;t.y=e.y;t.z=e.z;return t};o.fromCartesian4=o.clone;o.packedLength=3;o.pack=function(r,i,n){e.typeOf.object("value",r);e.defined("array",i);n=t(n,0);i[n++]=r.x;i[n++]=r.y;i[n]=r.z;return i};o.unpack=function(i,n,a){e.defined("array",i);n=t(n,0);if(!r(a)){a=new o}a.x=i[n++];a.y=i[n++];a.z=i[n];return a};o.packArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n*3)}else{i.length=n*3}for(var a=0;a<n;++a){o.pack(t[a],i,a*3)}return i};o.unpackArray=function(t,n){e.defined("array",t);e.typeOf.number.greaterThanOrEquals("array.length",t.length,3);if(t.length%3!==0){throw new i("array length must be a multiple of 3.")}var a=t.length;if(!r(n)){n=new Array(a/3)}else{n.length=a/3}for(var s=0;s<a;s+=3){var l=s/3;n[l]=o.unpack(t,s,n[l])}return n};o.fromArray=o.unpack;o.maximumComponent=function(t){e.typeOf.object("cartesian",t);return Math.max(t.x,t.y,t.z)};o.minimumComponent=function(t){e.typeOf.object("cartesian",t);return Math.min(t.x,t.y,t.z)};o.minimumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.min(t.x,r.x);i.y=Math.min(t.y,r.y);i.z=Math.min(t.z,r.z);return i};o.maximumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.max(t.x,r.x);i.y=Math.max(t.y,r.y);i.z=Math.max(t.z,r.z);return i};o.magnitudeSquared=function(t){e.typeOf.object("cartesian",t);return t.x*t.x+t.y*t.y+t.z*t.z};o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitude(s)};o.distanceSquared=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitudeSquared(s)};o.normalize=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var n=o.magnitude(t);r.x=t.x/n;r.y=t.y/n;r.z=t.z/n;if(isNaN(r.x)||isNaN(r.y)||isNaN(r.z)){throw new i("normalized result is not a number")}return r};o.dot=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);return t.x*r.x+t.y*r.y+t.z*r.z};o.multiplyComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x*r.x;i.y=t.y*r.y;i.z=t.z*r.z;return i};o.divideComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x/r.x;i.y=t.y/r.y;i.z=t.z/r.z;return i};o.add=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x+r.x;i.y=t.y+r.y;i.z=t.z+r.z;return i};o.subtract=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x-r.x;i.y=t.y-r.y;i.z=t.z-r.z;return i};o.multiplyByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x*r;i.y=t.y*r;i.z=t.z*r;return i};o.divideByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x/r;i.y=t.y/r;i.z=t.z/r;return i};o.negate=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=-t.x;r.y=-t.y;r.z=-t.z;return r};o.abs=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=Math.abs(t.x);r.y=Math.abs(t.y);r.z=Math.abs(t.z);return r};var l=new o;o.lerp=function(t,r,i,n){e.typeOf.object("start",t);e.typeOf.object("end",r);e.typeOf.number("t",i);e.typeOf.object("result",n);o.multiplyByScalar(r,i,l);n=o.multiplyByScalar(t,1-i,n);return o.add(l,n,n)};var u=new o;var c=new o;o.angleBetween=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.normalize(t,u);o.normalize(r,c);var i=o.dot(u,c);var n=o.magnitude(o.cross(u,c,u));return Math.atan2(n,i)};var d=new o;o.mostOrthogonalAxis=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var i=o.normalize(t,d);o.abs(i,i);if(i.x<=i.y){if(i.x<=i.z){r=o.clone(o.UNIT_X,r)}else{r=o.clone(o.UNIT_Z,r)}}else if(i.y<=i.z){r=o.clone(o.UNIT_Y,r)}else{r=o.clone(o.UNIT_Z,r)}return r};o.equals=function(e,t){return e===t||r(e)&&r(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z};o.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]&&e.z===t[r+2]};o.equalsEpsilon=function(e,t,i,n){return e===t||r(e)&&r(t)&&a.equalsEpsilon(e.x,t.x,i,n)&&a.equalsEpsilon(e.y,t.y,i,n)&&a.equalsEpsilon(e.z,t.z,i,n)};o.cross=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=r.x;var l=r.y;var u=r.z;var c=a*u-o*l;var d=o*s-n*u;var f=n*l-a*s;i.x=c;i.y=d;i.z=f;return i};o.fromDegrees=function(t,r,i,n,s){e.typeOf.number("longitude",t);e.typeOf.number("latitude",r);t=a.toRadians(t);r=a.toRadians(r);return o.fromRadians(t,r,i,n,s)};var f=new o;var h=new o;var p=new o(6378137*6378137,6378137*6378137,6356752.314245179*6356752.314245179);o.fromRadians=function(i,n,a,s,l){e.typeOf.number("longitude",i);e.typeOf.number("latitude",n);a=t(a,0);var u=r(s)?s.radiiSquared:p;var c=Math.cos(n);f.x=c*Math.cos(i);f.y=c*Math.sin(i);f.z=Math.sin(n);f=o.normalize(f,f);o.multiplyComponents(u,f,h);var d=Math.sqrt(o.dot(f,h));h=o.divideByScalar(h,d,h);f=o.multiplyByScalar(f,a,f);if(!r(l)){l=new o}return o.add(h,f,l)};o.fromDegreesArray=function(t,n,a){e.defined("coordinates",t);if(t.length<2||t.length%2!==0){throw new i("the number of coordinates must be a multiple of 2 and at least 2")}var s=t.length;if(!r(a)){a=new Array(s/2)}else{a.length=s/2}for(var l=0;l<s;l+=2){var u=t[l];var c=t[l+1];var d=l/2;a[d]=o.fromDegrees(u,c,0,n,a[d])}return a};o.fromRadiansArray=function(t,n,a){e.defined("coordinates",t);if(t.length<2||t.length%2!==0){throw new i("the number of coordinates must be a multiple of 2 and at least 2")}var s=t.length;if(!r(a)){a=new Array(s/2)}else{a.length=s/2}for(var l=0;l<s;l+=2){var u=t[l];var c=t[l+1];var d=l/2;a[d]=o.fromRadians(u,c,0,n,a[d])}return a};o.fromDegreesArrayHeights=function(t,n,a){e.defined("coordinates",t);if(t.length<3||t.length%3!==0){throw new i("the number of coordinates must be a multiple of 3 and at least 3")}var s=t.length;if(!r(a)){a=new Array(s/3)}else{a.length=s/3}for(var l=0;l<s;l+=3){var u=t[l];var c=t[l+1];var d=t[l+2];var f=l/3;a[f]=o.fromDegrees(u,c,d,n,a[f])}return a};o.fromRadiansArrayHeights=function(t,n,a){e.defined("coordinates",t);if(t.length<3||t.length%3!==0){throw new i("the number of coordinates must be a multiple of 3 and at least 3")}var s=t.length;if(!r(a)){a=new Array(s/3)}else{a.length=s/3}for(var l=0;l<s;l+=3){var u=t[l];var c=t[l+1];var d=t[l+2];var f=l/3;a[f]=o.fromRadians(u,c,d,n,a[f])}return a};o.ZERO=n(new o(0,0,0));o.UNIT_X=n(new o(1,0,0));o.UNIT_Y=n(new o(0,1,0));o.UNIT_Z=n(new o(0,0,1));o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e){return o.equals(this,e)};o.prototype.equalsEpsilon=function(e,t,r){return o.equalsEpsilon(this,e,t,r)};o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};return o});define("Core/AttributeCompression",["./Cartesian2","./Cartesian3","./Check","./defined","./DeveloperError","./Math"],function(e,t,r,i,n,a){"use strict";var o={};o.octEncodeInRange=function(e,i,o){r.defined("vector",e);r.defined("result",o);var s=t.magnitudeSquared(e);if(Math.abs(s-1)>a.EPSILON6){throw new n("vector must be normalized.")}o.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z));o.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z));if(e.z<0){var l=o.x;var u=o.y;o.x=(1-Math.abs(u))*a.signNotZero(l);o.y=(1-Math.abs(l))*a.signNotZero(u)}o.x=a.toSNorm(o.x,i);o.y=a.toSNorm(o.y,i);return o};o.octEncode=function(e,t){return o.octEncodeInRange(e,255,t)};o.octDecodeInRange=function(e,i,o,s){r.defined("result",s);if(e<0||e>o||i<0||i>o){throw new n("x and y must be a signed normalized integer between 0 and "+o)}s.x=a.fromSNorm(e,o);s.y=a.fromSNorm(i,o);s.z=1-(Math.abs(s.x)+Math.abs(s.y));if(s.z<0){var l=s.x;s.x=(1-Math.abs(s.y))*a.signNotZero(l);s.y=(1-Math.abs(l))*a.signNotZero(s.y)}return t.normalize(s,s)};o.octDecode=function(e,t,r){return o.octDecodeInRange(e,t,255,r)};o.octPackFloat=function(e){r.defined("encoded",e);return 256*e.x+e.y};var s=new e;o.octEncodeFloat=function(e){o.octEncode(e,s);return o.octPackFloat(s)};o.octDecodeFloat=function(e,t){r.defined("value",e);var i=e/256;var n=Math.floor(i);var a=(i-n)*256;return o.octDecode(n,a,t)};o.octPack=function(e,t,i,n){r.defined("v1",e);r.defined("v2",t);r.defined("v3",i);r.defined("result",n);var a=o.octEncodeFloat(e);var l=o.octEncodeFloat(t);var u=o.octEncode(i,s);n.x=65536*u.x+a;n.y=65536*u.y+l;return n};o.octUnpack=function(e,t,i,n){r.defined("packed",e);r.defined("v1",t);r.defined("v2",i);r.defined("v3",n);var a=e.x/65536;var s=Math.floor(a);var l=(a-s)*65536;a=e.y/65536;var u=Math.floor(a);var c=(a-u)*65536;o.octDecodeFloat(l,t);o.octDecodeFloat(c,i);o.octDecode(s,u,n)};o.compressTextureCoordinates=function(e){r.defined("textureCoordinates",e);var t=e.x*4095|0;var i=e.y*4095|0;return 4096*t+i};o.decompressTextureCoordinates=function(e,t){r.defined("compressed",e);r.defined("result",t);var i=e/4096;var n=Math.floor(i);t.x=n/4095;t.y=(e-n*4096)/4095;return t};return o});define("Core/Intersect",["./freezeObject"],function(e){"use strict";var t={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};return e(t)});define("Core/AxisAlignedBoundingBox",["./Cartesian3","./Check","./defaultValue","./defined","./Intersect"],function(e,t,r,i,n){"use strict";function a(t,n,a){this.minimum=e.clone(r(t,e.ZERO));this.maximum=e.clone(r(n,e.ZERO));if(!i(a)){a=e.add(this.minimum,this.maximum,new e);e.multiplyByScalar(a,.5,a)}else{a=e.clone(a)}this.center=a}a.fromPoints=function(t,r){if(!i(r)){r=new a}if(!i(t)||t.length===0){r.minimum=e.clone(e.ZERO,r.minimum);r.maximum=e.clone(e.ZERO,r.maximum);r.center=e.clone(e.ZERO,r.center);return r}var n=t[0].x;var o=t[0].y;var s=t[0].z;var l=t[0].x;var u=t[0].y;var c=t[0].z;var d=t.length;for(var f=1;f<d;f++){var h=t[f];var p=h.x;var m=h.y;var v=h.z;n=Math.min(p,n);l=Math.max(p,l);o=Math.min(m,o);u=Math.max(m,u);s=Math.min(v,s);c=Math.max(v,c)}var g=r.minimum;g.x=n;g.y=o;g.z=s;var _=r.maximum;_.x=l;_.y=u;_.z=c;var y=e.add(g,_,r.center);e.multiplyByScalar(y,.5,y);return r};a.clone=function(t,r){if(!i(t)){return undefined}if(!i(r)){return new a(t.minimum,t.maximum)}r.minimum=e.clone(t.minimum,r.minimum);r.maximum=e.clone(t.maximum,r.maximum);r.center=e.clone(t.center,r.center);return r};a.equals=function(t,r){return t===r||i(t)&&i(r)&&e.equals(t.center,r.center)&&e.equals(t.minimum,r.minimum)&&e.equals(t.maximum,r.maximum)};var o=new e;a.intersectPlane=function(r,i){t.defined("box",r);t.defined("plane",i);o=e.subtract(r.maximum,r.minimum,o);var a=e.multiplyByScalar(o,.5,o);var s=i.normal;var l=a.x*Math.abs(s.x)+a.y*Math.abs(s.y)+a.z*Math.abs(s.z);var u=e.dot(r.center,s)+i.distance;if(u-l>0){return n.INSIDE}if(u+l<0){return n.OUTSIDE}return n.INTERSECTING};a.prototype.clone=function(e){return a.clone(this,e)};a.prototype.intersectPlane=function(e){return a.intersectPlane(this,e)};a.prototype.equals=function(e){return a.equals(this,e)};return a});define("Core/barycentricCoordinates",["./Cartesian2","./Cartesian3","./Check","./defined"],function(e,t,r,i){"use strict";var n=new t;var a=new t;var o=new t;function s(s,l,u,c,d){r.defined("point",s);r.defined("p0",l);r.defined("p1",u);r.defined("p2",c);if(!i(d)){d=new t}var f,h,p;var m,v,g,_,y;if(!i(l.z)){f=e.subtract(u,l,n);h=e.subtract(c,l,a);p=e.subtract(s,l,o);m=e.dot(f,f);v=e.dot(f,h);g=e.dot(f,p);_=e.dot(h,h);y=e.dot(h,p)}else{f=t.subtract(u,l,n);h=t.subtract(c,l,a);p=t.subtract(s,l,o);m=t.dot(f,f);v=t.dot(f,h);g=t.dot(f,p);_=t.dot(h,h);y=t.dot(h,p)}var b=1/(m*_-v*v);d.y=(_*g-v*y)*b;d.z=(m*y-v*g)*b;d.x=1-d.y-d.z;return d}return s});define("Core/binarySearch",["./Check","./defined"],function(e,t){"use strict";function r(t,r,i){e.defined("array",t);e.defined("itemToFind",r);e.defined("comparator",i);var n=0;var a=t.length-1;var o;var s;while(n<=a){o=~~((n+a)/2);s=i(t[o],r);if(s<0){n=o+1;continue}if(s>0){a=o-1;continue}return o}return~(a+1)}return r});define("Core/Credit",["./defined","./defineProperties","./DeveloperError"],function(e,t,r){"use strict";var i=0;var n={};function a(t,a,o){var s=e(o);var l=e(a);var u=e(t);if(!u&&!l&&!s){throw new r("text, imageUrl or link is required")}if(!u&&!l){t=o}this._text=t;this._imageUrl=a;this._link=o;this._hasLink=s;this._hasImage=l;var c;var d=JSON.stringify([t,a,o]);if(e(n[d])){c=n[d]}else{c=i++;n[d]=c}this._id=c}t(a.prototype,{text:{get:function(){return this._text}},imageUrl:{get:function(){return this._imageUrl}},link:{get:function(){return this._link}},id:{get:function(){return this._id}}});a.prototype.hasImage=function(){return this._hasImage};a.prototype.hasLink=function(){return this._hasLink};a.equals=function(t,r){return t===r||e(t)&&e(r)&&t._id===r._id};a.prototype.equals=function(e){return a.equals(this,e)};return a});define("Core/BingMapsApi",["./Credit","./defined"],function(e,t){"use strict";var r={};r.defaultKey=undefined;var i=false;var n;var a="This application is using Cesium's default Bing Maps key.  Please create a new key for the application as soon as possible and prior to deployment by visiting https://www.bingmapsportal.com/, and provide your key to Cesium by setting the Cesium.BingMapsApi.defaultKey property before constructing the CesiumWidget or any other object that uses the Bing Maps API.";r.getKey=function(e){if(t(e)){return e}if(!t(r.defaultKey)){if(!i){console.log(a);i=true}return"AihaXS6TtE_olKOVdtkMenAMq1L5nDlnU69mRtNisz1vZavr1HhdqGRNkB2Bcqvs"}return r.defaultKey};r.getErrorCredit=function(i){if(t(i)||t(r.defaultKey)){return undefined}if(!t(n)){n=new e(a)}return n};return r});define("ThirdParty/Uri",[],function(){function e(r){if(r instanceof e){this.scheme=r.scheme;this.authority=r.authority;this.path=r.path;this.query=r.query;this.fragment=r.fragment}else if(r){var i=t.exec(r);this.scheme=i[1];this.authority=i[2];this.path=i[3];this.query=i[4];this.fragment=i[5]}}e.prototype.scheme=null;e.prototype.authority=null;e.prototype.path="";e.prototype.query=null;e.prototype.fragment=null;var t=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");e.prototype.getScheme=function(){return this.scheme};e.prototype.getAuthority=function(){return this.authority};e.prototype.getPath=function(){return this.path};e.prototype.getQuery=function(){return this.query};e.prototype.getFragment=function(){return this.fragment};e.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment};e.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query};e.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment};e.prototype.normalize=function(){this.removeDotSegments();if(this.scheme)this.scheme=this.scheme.toLowerCase();if(this.authority)this.authority=this.authority.replace(n,o).replace(r,a);if(this.path)this.path=this.path.replace(r,a);if(this.query)this.query=this.query.replace(r,a);if(this.fragment)this.fragment=this.fragment.replace(r,a)};var r=/%[0-9a-z]{2}/gi;var i=/[a-zA-Z0-9\-\._~]/;var n=/(.*@)?([^@:]*)(:.*)?/;function a(e){var t=unescape(e);return i.test(t)?t:e.toUpperCase()}function o(e,t,r,i){return(t||"")+r.toLowerCase()+(i||"")}e.prototype.resolve=function(t){var r=new e;if(this.scheme){r.scheme=this.scheme;r.authority=this.authority;r.path=this.path;r.query=this.query}else{r.scheme=t.scheme;if(this.authority){r.authority=this.authority;r.path=this.path;r.query=this.query}else{r.authority=t.authority;if(this.path==""){r.path=t.path;r.query=this.query||t.query}else{if(this.path.charAt(0)=="/"){r.path=this.path;r.removeDotSegments()}else{if(t.authority&&t.path==""){r.path="/"+this.path}else{r.path=t.path.substring(0,t.path.lastIndexOf("/")+1)+this.path}r.removeDotSegments()}r.query=this.query}}}r.fragment=this.fragment;return r};e.prototype.removeDotSegments=function(){var e=this.path.split("/"),t=[],r,i=e[0]=="";if(i)e.shift();var n=e[0]==""?e.shift():null;while(e.length){r=e.shift();if(r==".."){t.pop()}else if(r!="."){t.push(r)}}if(r=="."||r=="..")t.push("");if(i)t.unshift("");this.path=t.join("/")};e.prototype.toString=function(){var e="";if(this.scheme)e+=this.scheme+":";if(this.authority)e+="//"+this.authority;e+=this.path;if(this.query)e+="?"+this.query;if(this.fragment)e+="#"+this.fragment;return e};return e});(function(e){"use strict";e("ThirdParty/when",[],function(){var e,t,r;i.defer=u;i.resolve=n;i.reject=a;i.join=p;i.all=h;i.map=m;i.reduce=v;i.any=f;i.some=d;i.chain=g;i.isPromise=c;function i(e,t,r,i){return n(e).then(t,r,i)}function n(e){var t,r;if(e instanceof o){t=e}else{if(c(e)){r=u();e.then(function(e){r.resolve(e)},function(e){r.reject(e)},function(e){r.progress(e)});t=r.promise}else{t=s(e)}}return t}function a(e){return i(e,l)}function o(e){this.then=e}o.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(r,e)},yield:function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return h(t,function(t){return e.apply(r,t)})})}};function s(e){var t=new o(function(t){try{return n(t?t(e):e)}catch(e){return l(e)}});return t}function l(e){var t=new o(function(t,r){try{return r?n(r(e)):l(e)}catch(e){return l(e)}});return t}function u(){var e,t,i,a,s,c,d;t=new o(f);e={then:f,resolve:h,reject:p,progress:m,promise:t,resolver:{resolve:h,reject:p,progress:m}};i=[];a=[];s=function(e,t,r){var n,o;n=u();o=typeof r==="function"?function(e){try{n.progress(r(e))}catch(e){n.progress(e)}}:function(e){n.progress(e)};i.push(function(r){r.then(e,t).then(n.resolve,n.reject,o)});a.push(o);return n.promise};c=function(e){_(a,e);return e};d=function(e){e=n(e);s=e.then;d=n;c=b;_(i,e);a=i=r;return e};return e;function f(e,t,r){return s(e,t,r)}function h(e){return d(e)}function p(e){return d(l(e))}function m(e){return c(e)}}function c(e){return e&&typeof e.then==="function"}function d(e,t,r,n,a){y(2,arguments);return i(e,function(e){var o,s,l,c,d,f,h,p,m,v;m=e.length>>>0;o=Math.max(0,Math.min(t,m));l=[];s=m-o+1;c=[];d=u();if(!o){d.resolve(l)}else{p=d.progress;h=function(e){c.push(e);if(!--s){f=h=b;d.reject(c)}};f=function(e){l.push(e);if(!--o){f=h=b;d.resolve(l)}};for(v=0;v<m;++v){if(v in e){i(e[v],_,g,p)}}}return d.then(r,n,a);function g(e){h(e)}function _(e){f(e)}})}function f(e,t,r,i){function n(e){return t?t(e[0]):e[0]}return d(e,1,n,r,i)}function h(e,t,r,i){y(1,arguments);return m(e,w).then(t,r,i)}function p(){return m(arguments,w)}function m(e,t){return i(e,function(e){var r,n,a,o,s,l;a=n=e.length>>>0;r=[];l=u();if(!a){l.resolve(r)}else{o=function e(n,o){i(n,t).then(function(e){r[o]=e;if(!--a){l.resolve(r)}},l.reject)};for(s=0;s<n;s++){if(s in e){o(e[s],s)}else{--a}}}return l.promise})}function v(r,n){var a=t.call(arguments,1);return i(r,function(t){var r;r=t.length;a[0]=function(e,t,a){return i(e,function(e){return i(t,function(t){return n(e,t,a,r)})})};return e.apply(t,a)})}function g(e,t,r){var n=arguments.length>2;return i(e,function(e){e=n?r:e;t.resolve(e);return e},function(e){t.reject(e);return l(e)},t.progress)}function _(e,t){var r,i=0;while(r=e[i++]){r(t)}}function y(e,t){var r,i=t.length;while(i>e){r=t[--i];if(r!=null&&typeof r!="function"){throw new Error("arg "+i+" must be a function")}}}function b(){}t=[].slice;e=[].reduce||function(e){var t,r,i,n,a;a=0;t=Object(this);n=t.length>>>0;r=arguments;if(r.length<=1){for(;;){if(a in t){i=t[a++];break}if(++a>=n){throw new TypeError}}}else{i=r[1]}for(;a<n;++a){if(a in t){i=e(i,t[a],a,t)}}return i};function w(e){return e}return i})})(typeof define=="function"&&define.amd?define:function(e){typeof exports==="object"?module.exports=e():this.when=e()});define("Core/combine",["./defaultValue","./defined"],function(e,t){"use strict";function r(i,n,a){a=e(a,false);var o={};var s=t(i);var l=t(n);var u;var c;var d;if(s){for(u in i){if(i.hasOwnProperty(u)){c=i[u];if(l&&a&&typeof c==="object"&&n.hasOwnProperty(u)){d=n[u];if(typeof d==="object"){o[u]=r(c,d,a)}else{o[u]=c}}else{o[u]=c}}}}if(l){for(u in n){if(n.hasOwnProperty(u)&&!o.hasOwnProperty(u)){d=n[u];o[u]=d}}}return o}return r});define("Core/isArray",["./defined"],function(e){"use strict";var t=Array.isArray;if(!e(t)){t=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}return t});define("Core/objectToQuery",["./defined","./DeveloperError","./isArray"],function(e,t,r){"use strict";function i(i){if(!e(i)){throw new t("obj is required.")}var n="";for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];var s=encodeURIComponent(a)+"=";if(r(o)){for(var l=0,u=o.length;l<u;++l){n+=s+encodeURIComponent(o[l])+"&"}}else{n+=s+encodeURIComponent(o)+"&"}}}n=n.slice(0,-1);return n}return i});define("Core/queryToObject",["./defined","./DeveloperError","./isArray"],function(e,t,r){"use strict";function i(i){if(!e(i)){throw new t("queryString is required.")}var n={};if(i===""){return n}var a=i.replace(/\+/g,"%20").split("&");for(var o=0,s=a.length;o<s;++o){var l=a[o].split("=");var u=decodeURIComponent(l[0]);var c=l[1];if(e(c)){c=decodeURIComponent(c)}else{c=""}var d=n[u];if(typeof d==="string"){n[u]=[d,c]}else if(r(d)){d.push(c)}else{n[u]=c}}return n}return i});define("Core/RequestState",["../Core/freezeObject"],function(e){"use strict";var t={UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5};return e(t)});define("Core/RequestType",["../Core/freezeObject"],function(e){"use strict";var t={TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3};return e(t)});define("Core/Request",["./defaultValue","./defined","./defineProperties","./RequestState","./RequestType"],function(e,t,r,i,n){"use strict";function a(t){t=e(t,e.EMPTY_OBJECT);var r=e(t.throttleByServer,false);var a=r||e(t.throttle,false);this.url=t.url;this.requestFunction=t.requestFunction;this.cancelFunction=t.cancelFunction;this.priorityFunction=t.priorityFunction;this.priority=e(t.priority,0);this.throttle=a;this.throttleByServer=r;this.type=e(t.type,n.OTHER);this.serverKey=undefined;this.state=i.UNISSUED;this.deferred=undefined;this.cancelled=false}a.prototype.cancel=function(){this.cancelled=true};return a});define("Core/clone",["./defaultValue"],function(e){"use strict";function t(r,i){if(r===null||typeof r!=="object"){return r}i=e(i,false);var n=new r.constructor;for(var a in r){if(r.hasOwnProperty(a)){var o=r[a];if(i){o=t(o,i)}n[a]=o}}return n}return t});define("Core/Heap",["./Check","./defaultValue","./defined","./defineProperties"],function(e,t,r,i){"use strict";function n(t){e.typeOf.object("options",t);e.defined("options.comparator",t.comparator);this._comparator=t.comparator;this._array=[];this._length=0;this._maximumLength=undefined}i(n.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e;if(this._length>e&&e>0){this._length=e;this._array.length=e}}},comparator:{get:function(){return this._comparator}}});function a(e,t,r){var i=e[t];e[t]=e[r];e[r]=i}n.prototype.reserve=function(e){e=t(e,this._length);this._array.length=e};n.prototype.heapify=function(e){e=t(e,0);var r=this._length;var i=this._comparator;var n=this._array;var o=-1;var s=true;while(s){var l=2*(e+1);var u=l-1;if(u<r&&i(n[u],n[e])<0){o=u}else{o=e}if(l<r&&i(n[l],n[o])<0){o=l}if(o!==e){a(n,o,e);e=o}else{s=false}}};n.prototype.resort=function(){var e=this._length;for(var t=Math.ceil(e/2);t>=0;--t){this.heapify(t)}};n.prototype.insert=function(t){e.defined("element",t);var i=this._array;var n=this._comparator;var o=this._maximumLength;var s=this._length++;if(s<i.length){i[s]=t}else{i.push(t)}while(s!==0){var l=Math.floor((s-1)/2);if(n(i[s],i[l])<0){a(i,s,l);s=l}else{break}}var u;if(r(o)&&this._length>o){u=i[o];this._length=o}return u};n.prototype.pop=function(r){r=t(r,0);if(this._length===0){return undefined}e.typeOf.number.lessThan("index",r,this._length);var i=this._array;var n=i[r];a(i,r,--this._length);this.heapify(r);return n};return n});define("Core/isBlobUri",["./Check"],function(e){"use strict";var t=/^blob:/i;function r(r){e.typeOf.string("uri",r);return t.test(r)}return r});define("Core/isDataUri",["./Check"],function(e){"use strict";var t=/^data:/i;function r(r){e.typeOf.string("uri",r);return t.test(r)}return r});define("Core/RequestScheduler",["../ThirdParty/Uri","../ThirdParty/when","./Check","./clone","./defined","./defineProperties","./Heap","./isBlobUri","./isDataUri","./RequestState"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e,t){return e.priority-t.priority}var d={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0};var f=20;var h=new o({comparator:c});h.maximumLength=f;h.reserve(f);var p=[];var m={};var v=typeof document!=="undefined"?new e(document.location.href):new e;function g(){}g.maximumRequests=50;g.maximumRequestsPerServer=6;g.throttleRequests=true;g.debugShowStatistics=false;a(g,{statistics:{get:function(){return d}},priorityHeapLength:{get:function(){return f},set:function(e){if(e<f){while(h.length>e){var t=h.pop();T(t)}}f=e;h.maximumLength=e;h.reserve(e)}}});function _(e){if(n(e.priorityFunction)){e.priority=e.priorityFunction()}}function y(e){return m[e]<g.maximumRequestsPerServer}function b(e){if(e.state===u.UNISSUED){e.state=u.ISSUED;e.deferred=t.defer()}return e.deferred.promise}function w(e){return function(t){if(e.state===u.CANCELLED){return}--d.numberOfActiveRequests;--m[e.serverKey];e.state=u.RECEIVED;e.deferred.resolve(t)}}function C(e){return function(t){if(e.state===u.CANCELLED){return}++d.numberOfFailedRequests;--d.numberOfActiveRequests;--m[e.serverKey];e.state=u.FAILED;e.deferred.reject(t)}}function S(e){var t=b(e);e.state=u.ACTIVE;p.push(e);++d.numberOfActiveRequests;++d.numberOfActiveRequestsEver;++m[e.serverKey];e.requestFunction().then(w(e)).otherwise(C(e));return t}function T(e){var t=e.state===u.ACTIVE;e.state=u.CANCELLED;++d.numberOfCancelledRequests;e.deferred.reject();if(t){--d.numberOfActiveRequests;--m[e.serverKey];++d.numberOfCancelledActiveRequests}if(n(e.cancelFunction)){e.cancelFunction()}}g.update=function(){var e;var t;var r=0;var i=p.length;for(e=0;e<i;++e){t=p[e];if(t.cancelled){T(t)}if(t.state!==u.ACTIVE){++r;continue}if(r>0){p[e-r]=t}}p.length-=r;var n=h.internalArray;var a=h.length;for(e=0;e<a;++e){_(n[e])}h.resort();var o=Math.max(g.maximumRequests-p.length,0);var s=0;while(s<o&&h.length>0){t=h.pop();if(t.cancelled){T(t);continue}if(t.throttleByServer&&!y(t.serverKey)){T(t);continue}S(t);++s}x()};g.getServerKey=function(t){r.typeOf.string("url",t);var i=new e(t).resolve(v);i.normalize();var a=i.authority;if(!/:/.test(a)){a=a+":"+(i.scheme==="https"?"443":"80")}var o=m[a];if(!n(o)){m[a]=0}return a};g.request=function(e){r.typeOf.object("request",e);r.typeOf.string("request.url",e.url);r.typeOf.func("request.requestFunction",e.requestFunction);if(l(e.url)||s(e.url)){e.state=u.RECEIVED;return e.requestFunction()}++d.numberOfAttemptedRequests;if(!n(e.serverKey)){e.serverKey=g.getServerKey(e.url)}if(!g.throttleRequests||!e.throttle){return S(e)}if(p.length>=g.maximumRequests){return undefined}if(e.throttleByServer&&!y(e.serverKey)){return undefined}_(e);var t=h.insert(e);if(n(t)){if(t===e){return undefined}T(t)}return b(e)};function E(){d.numberOfAttemptedRequests=0;d.numberOfCancelledRequests=0;d.numberOfCancelledActiveRequests=0}function x(){if(!g.debugShowStatistics){return}if(d.numberOfAttemptedRequests>0){console.log("Number of attempted requests: "+d.numberOfAttemptedRequests)}if(d.numberOfActiveRequests>0){console.log("Number of active requests: "+d.numberOfActiveRequests)}if(d.numberOfCancelledRequests>0){console.log("Number of cancelled requests: "+d.numberOfCancelledRequests)}if(d.numberOfCancelledActiveRequests>0){console.log("Number of cancelled active requests: "+d.numberOfCancelledActiveRequests)}if(d.numberOfFailedRequests>0){console.log("Number of failed requests: "+d.numberOfFailedRequests)}E()}g.clearForSpecs=function(){while(h.length>0){var e=h.pop();T(e)}var t=p.length;for(var r=0;r<t;++r){T(p[r])}p.length=0;m={};d.numberOfAttemptedRequests=0;d.numberOfActiveRequests=0;d.numberOfCancelledRequests=0;d.numberOfCancelledActiveRequests=0;d.numberOfFailedRequests=0;d.numberOfActiveRequestsEver=0};g.numberOfActiveRequestsByServer=function(e){return m[e]};g.requestHeap=h;return g});define("Core/loadJsonp",["../ThirdParty/Uri","../ThirdParty/when","./combine","./defaultValue","./defined","./DeveloperError","./objectToQuery","./queryToObject","./Request","./RequestScheduler"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(d,f,h){if(!n(d)){throw new a("url is required.")}f=i(f,i.EMPTY_OBJECT);var p;do{p="loadJsonp"+Math.random().toString().substring(2,8)}while(n(window[p]));var m=new e(d);var v=s(i(m.query,""));if(n(f.parameters)){v=r(f.parameters,v)}var g=i(f.callbackParameterName,"callback");v[g]=p;m.query=o(v);d=m.toString();var _=f.proxy;if(n(_)){d=_.getURL(d)}h=n(h)?h:new l;h.url=d;h.requestFunction=function(){var e=t.defer();window[p]=function(t){e.resolve(t);try{delete window[p]}catch(e){window[p]=undefined}};c.loadAndExecuteScript(d,p,e);return e.promise};return u.request(h)}c.loadAndExecuteScript=function(e,t,r){var i=document.createElement("script");i.async=true;i.src=e;var n=document.getElementsByTagName("head")[0];i.onload=function(){i.onload=undefined;n.removeChild(i)};i.onerror=function(e){r.reject(e)};n.appendChild(i)};c.defaultLoadAndExecuteScript=c.loadAndExecuteScript;return c});define("Core/scaleToGeodeticSurface",["./Cartesian3","./defined","./DeveloperError","./Math"],function(e,t,r,i){"use strict";var n=new e;var a=new e;function o(o,s,l,u,c){if(!t(o)){throw new r("cartesian is required.")}if(!t(s)){throw new r("oneOverRadii is required.")}if(!t(l)){throw new r("oneOverRadiiSquared is required.")}if(!t(u)){throw new r("centerToleranceSquared is required.")}var d=o.x;var f=o.y;var h=o.z;var p=s.x;var m=s.y;var v=s.z;var g=d*d*p*p;var _=f*f*m*m;var y=h*h*v*v;var b=g+_+y;var w=Math.sqrt(1/b);var C=e.multiplyByScalar(o,w,n);if(b<u){return!isFinite(w)?undefined:e.clone(C,c)}var S=l.x;var T=l.y;var E=l.z;var x=a;x.x=C.x*S*2;x.y=C.y*T*2;x.z=C.z*E*2;var P=(1-w)*e.magnitude(o)/(.5*e.magnitude(x));var A=0;var O;var D;var I;var M;var R;var L;var N;var k;var F;var B;var U;do{P-=A;I=1/(1+P*S);M=1/(1+P*T);R=1/(1+P*E);L=I*I;N=M*M;k=R*R;F=L*I;B=N*M;U=k*R;O=g*L+_*N+y*k-1;D=g*F*S+_*B*T+y*U*E;var V=-2*D;A=O/V}while(Math.abs(O)>i.EPSILON12);if(!t(c)){return new e(d*I,f*M,h*R)}c.x=d*I;c.y=f*M;c.z=h*R;return c}return o});define("Core/Cartographic",["./Cartesian3","./Check","./defaultValue","./defined","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,r,i,n,a,o){"use strict";function s(e,t,i){this.longitude=r(e,0);this.latitude=r(t,0);this.height=r(i,0)}s.fromRadians=function(e,n,a,o){t.typeOf.number("longitude",e);t.typeOf.number("latitude",n);a=r(a,0);if(!i(o)){return new s(e,n,a)}o.longitude=e;o.latitude=n;o.height=a;return o};s.fromDegrees=function(e,r,i,n){t.typeOf.number("longitude",e);t.typeOf.number("latitude",r);e=a.toRadians(e);r=a.toRadians(r);return s.fromRadians(e,r,i,n)};var l=new e;var u=new e;var c=new e;var d=new e(1/6378137,1/6378137,1/6356752.314245179);var f=new e(1/(6378137*6378137),1/(6378137*6378137),1/(6356752.314245179*6356752.314245179));var h=a.EPSILON1;s.fromCartesian=function(t,r,n){var p=i(r)?r.oneOverRadii:d;var m=i(r)?r.oneOverRadiiSquared:f;var v=i(r)?r._centerToleranceSquared:h;var g=o(t,p,m,v,u);if(!i(g)){return undefined}var _=e.multiplyComponents(g,m,l);_=e.normalize(_,_);var y=e.subtract(t,g,c);var b=Math.atan2(_.y,_.x);var w=Math.asin(_.z);var C=a.sign(e.dot(y,t))*e.magnitude(y);if(!i(n)){return new s(b,w,C)}n.longitude=b;n.latitude=w;n.height=C;return n};s.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new s(e.longitude,e.latitude,e.height)}t.longitude=e.longitude;t.latitude=e.latitude;t.height=e.height;return t};s.equals=function(e,t){return e===t||i(e)&&i(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height};s.equalsEpsilon=function(e,r,n){t.typeOf.number("epsilon",n);return e===r||i(e)&&i(r)&&Math.abs(e.longitude-r.longitude)<=n&&Math.abs(e.latitude-r.latitude)<=n&&Math.abs(e.height-r.height)<=n};s.ZERO=n(new s(0,0,0));s.prototype.clone=function(e){return s.clone(this,e)};s.prototype.equals=function(e){return s.equals(this,e)};s.prototype.equalsEpsilon=function(e,t){return s.equalsEpsilon(this,e,t)};s.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"};return s});define("Core/Ellipsoid",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(t,n,a,o){n=i(n,0);a=i(a,0);o=i(o,0);r.typeOf.number.greaterThanOrEquals("x",n,0);r.typeOf.number.greaterThanOrEquals("y",a,0);r.typeOf.number.greaterThanOrEquals("z",o,0);t._radii=new e(n,a,o);t._radiiSquared=new e(n*n,a*a,o*o);t._radiiToTheFourth=new e(n*n*n*n,a*a*a*a,o*o*o*o);t._oneOverRadii=new e(n===0?0:1/n,a===0?0:1/a,o===0?0:1/o);t._oneOverRadiiSquared=new e(n===0?0:1/(n*n),a===0?0:1/(a*a),o===0?0:1/(o*o));t._minimumRadius=Math.min(n,a,o);t._maximumRadius=Math.max(n,a,o);t._centerToleranceSquared=l.EPSILON1;if(t._radiiSquared.z!==0){t._squaredXOverSquaredZ=t._radiiSquared.x/t._radiiSquared.z}}function d(e,t,r){this._radii=undefined;this._radiiSquared=undefined;this._radiiToTheFourth=undefined;this._oneOverRadii=undefined;this._oneOverRadiiSquared=undefined;this._minimumRadius=undefined;this._maximumRadius=undefined;this._centerToleranceSquared=undefined;this._squaredXOverSquaredZ=undefined;c(this,e,t,r)}a(d.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}});d.clone=function(t,r){if(!n(t)){return undefined}var i=t._radii;if(!n(r)){return new d(i.x,i.y,i.z)}e.clone(i,r._radii);e.clone(t._radiiSquared,r._radiiSquared);e.clone(t._radiiToTheFourth,r._radiiToTheFourth);e.clone(t._oneOverRadii,r._oneOverRadii);e.clone(t._oneOverRadiiSquared,r._oneOverRadiiSquared);r._minimumRadius=t._minimumRadius;r._maximumRadius=t._maximumRadius;r._centerToleranceSquared=t._centerToleranceSquared;return r};d.fromCartesian3=function(e,t){if(!n(t)){t=new d}if(!n(e)){return t}c(t,e.x,e.y,e.z);return t};d.WGS84=s(new d(6378137,6378137,6356752.314245179));d.UNIT_SPHERE=s(new d(1,1,1));d.MOON=s(new d(l.LUNAR_RADIUS,l.LUNAR_RADIUS,l.LUNAR_RADIUS));d.prototype.clone=function(e){return d.clone(this,e)};d.packedLength=e.packedLength;d.pack=function(t,n,a){r.typeOf.object("value",t);r.defined("array",n);a=i(a,0);e.pack(t._radii,n,a);return n};d.unpack=function(t,n,a){r.defined("array",t);n=i(n,0);var o=e.unpack(t,n);return d.fromCartesian3(o,a)};d.prototype.geocentricSurfaceNormal=e.normalize;d.prototype.geodeticSurfaceNormalCartographic=function(t,i){r.typeOf.object("cartographic",t);var a=t.longitude;var o=t.latitude;var s=Math.cos(o);var l=s*Math.cos(a);var u=s*Math.sin(a);var c=Math.sin(o);if(!n(i)){i=new e}i.x=l;i.y=u;i.z=c;return e.normalize(i,i)};d.prototype.geodeticSurfaceNormal=function(t,r){if(!n(r)){r=new e}r=e.multiplyComponents(t,this._oneOverRadiiSquared,r);return e.normalize(r,r)};var f=new e;var h=new e;d.prototype.cartographicToCartesian=function(t,r){var i=f;var a=h;this.geodeticSurfaceNormalCartographic(t,i);e.multiplyComponents(this._radiiSquared,i,a);var o=Math.sqrt(e.dot(i,a));e.divideByScalar(a,o,a);e.multiplyByScalar(i,t.height,i);if(!n(r)){r=new e}return e.add(a,i,r)};d.prototype.cartographicArrayToCartesianArray=function(e,t){r.defined("cartographics",e);var i=e.length;if(!n(t)){t=new Array(i)}else{t.length=i}for(var a=0;a<i;a++){t[a]=this.cartographicToCartesian(e[a],t[a])}return t};var p=new e;var m=new e;var v=new e;d.prototype.cartesianToCartographic=function(r,i){var a=this.scaleToGeodeticSurface(r,m);if(!n(a)){return undefined}var o=this.geodeticSurfaceNormal(a,p);var s=e.subtract(r,a,v);var u=Math.atan2(o.y,o.x);var c=Math.asin(o.z);var d=l.sign(e.dot(s,r))*e.magnitude(s);if(!n(i)){return new t(u,c,d)}i.longitude=u;i.latitude=c;i.height=d;return i};d.prototype.cartesianArrayToCartographicArray=function(e,t){r.defined("cartesians",e);var i=e.length;if(!n(t)){t=new Array(i)}else{t.length=i}for(var a=0;a<i;++a){t[a]=this.cartesianToCartographic(e[a],t[a])}return t};d.prototype.scaleToGeodeticSurface=function(e,t){return u(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)};d.prototype.scaleToGeocentricSurface=function(t,i){r.typeOf.object("cartesian",t);if(!n(i)){i=new e}var a=t.x;var o=t.y;var s=t.z;var l=this._oneOverRadiiSquared;var u=1/Math.sqrt(a*a*l.x+o*o*l.y+s*s*l.z);return e.multiplyByScalar(t,u,i)};d.prototype.transformPositionToScaledSpace=function(t,r){if(!n(r)){r=new e}return e.multiplyComponents(t,this._oneOverRadii,r)};d.prototype.transformPositionFromScaledSpace=function(t,r){if(!n(r)){r=new e}return e.multiplyComponents(t,this._radii,r)};d.prototype.equals=function(t){return this===t||n(t)&&e.equals(this._radii,t._radii)};d.prototype.toString=function(){return this._radii.toString()};d.prototype.getSurfaceNormalIntersectionWithZAxis=function(t,a,s){r.typeOf.object("position",t);if(!l.equalsEpsilon(this._radii.x,this._radii.y,l.EPSILON15)){throw new o("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)")}r.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0);a=i(a,0);var u=this._squaredXOverSquaredZ;if(!n(s)){s=new e}s.x=0;s.y=0;s.z=t.z*(1-u);if(Math.abs(s.z)>=this._radii.z-a){return undefined}return s};return d});define("Core/Rectangle",["./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./freezeObject","./Math"],function(e,t,r,i,n,a,o,s){"use strict";function l(e,t,i,n){this.west=r(e,0);this.south=r(t,0);this.east=r(i,0);this.north=r(n,0)}n(l.prototype,{width:{get:function(){return l.computeWidth(this)}},height:{get:function(){return l.computeHeight(this)}}});l.packedLength=4;l.pack=function(e,i,n){t.typeOf.object("value",e);t.defined("array",i);n=r(n,0);i[n++]=e.west;i[n++]=e.south;i[n++]=e.east;i[n]=e.north;return i};l.unpack=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new l}a.west=e[n++];a.south=e[n++];a.east=e[n++];a.north=e[n];return a};l.computeWidth=function(e){t.typeOf.object("rectangle",e);var r=e.east;var i=e.west;if(r<i){r+=s.TWO_PI}return r-i};l.computeHeight=function(e){t.typeOf.object("rectangle",e);return e.north-e.south};l.fromDegrees=function(e,t,n,a,o){e=s.toRadians(r(e,0));t=s.toRadians(r(t,0));n=s.toRadians(r(n,0));a=s.toRadians(r(a,0));if(!i(o)){return new l(e,t,n,a)}o.west=e;o.south=t;o.east=n;o.north=a;return o};l.fromRadians=function(e,t,n,a,o){if(!i(o)){return new l(e,t,n,a)}o.west=r(e,0);o.south=r(t,0);o.east=r(n,0);o.north=r(a,0);return o};l.fromCartographicArray=function(e,r){t.defined("cartographics",e);var n=Number.MAX_VALUE;var a=-Number.MAX_VALUE;var o=Number.MAX_VALUE;var u=-Number.MAX_VALUE;var c=Number.MAX_VALUE;var d=-Number.MAX_VALUE;for(var f=0,h=e.length;f<h;f++){var p=e[f];n=Math.min(n,p.longitude);a=Math.max(a,p.longitude);c=Math.min(c,p.latitude);d=Math.max(d,p.latitude);var m=p.longitude>=0?p.longitude:p.longitude+s.TWO_PI;o=Math.min(o,m);u=Math.max(u,m)}if(a-n>u-o){n=o;a=u;if(a>s.PI){a=a-s.TWO_PI}if(n>s.PI){n=n-s.TWO_PI}}if(!i(r)){return new l(n,c,a,d)}r.west=n;r.south=c;r.east=a;r.north=d;return r};l.fromCartesianArray=function(e,n,o){t.defined("cartesians",e);n=r(n,a.WGS84);var u=Number.MAX_VALUE;var c=-Number.MAX_VALUE;var d=Number.MAX_VALUE;var f=-Number.MAX_VALUE;var h=Number.MAX_VALUE;var p=-Number.MAX_VALUE;for(var m=0,v=e.length;m<v;m++){var g=n.cartesianToCartographic(e[m]);u=Math.min(u,g.longitude);c=Math.max(c,g.longitude);h=Math.min(h,g.latitude);p=Math.max(p,g.latitude);var _=g.longitude>=0?g.longitude:g.longitude+s.TWO_PI;d=Math.min(d,_);f=Math.max(f,_)}if(c-u>f-d){u=d;c=f;if(c>s.PI){c=c-s.TWO_PI}if(u>s.PI){u=u-s.TWO_PI}}if(!i(o)){return new l(u,h,c,p)}o.west=u;o.south=h;o.east=c;o.north=p;return o};l.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new l(e.west,e.south,e.east,e.north)}t.west=e.west;t.south=e.south;t.east=e.east;t.north=e.north;return t};l.prototype.clone=function(e){return l.clone(this,e)};l.prototype.equals=function(e){return l.equals(this,e)};l.equals=function(e,t){return e===t||i(e)&&i(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north};l.prototype.equalsEpsilon=function(e,r){t.typeOf.number("epsilon",r);return i(e)&&Math.abs(this.west-e.west)<=r&&Math.abs(this.south-e.south)<=r&&Math.abs(this.east-e.east)<=r&&Math.abs(this.north-e.north)<=r};l.validate=function(e){t.typeOf.object("rectangle",e);var r=e.north;t.typeOf.number.greaterThanOrEquals("north",r,-s.PI_OVER_TWO);t.typeOf.number.lessThanOrEquals("north",r,s.PI_OVER_TWO);var i=e.south;t.typeOf.number.greaterThanOrEquals("south",i,-s.PI_OVER_TWO);t.typeOf.number.lessThanOrEquals("south",i,s.PI_OVER_TWO);var n=e.west;t.typeOf.number.greaterThanOrEquals("west",n,-Math.PI);t.typeOf.number.lessThanOrEquals("west",n,Math.PI);var a=e.east;t.typeOf.number.greaterThanOrEquals("east",a,-Math.PI);t.typeOf.number.lessThanOrEquals("east",a,Math.PI)};l.southwest=function(r,n){t.typeOf.object("rectangle",r);if(!i(n)){return new e(r.west,r.south)}n.longitude=r.west;n.latitude=r.south;n.height=0;return n};l.northwest=function(r,n){t.typeOf.object("rectangle",r);if(!i(n)){return new e(r.west,r.north)}n.longitude=r.west;n.latitude=r.north;n.height=0;return n};l.northeast=function(r,n){t.typeOf.object("rectangle",r);if(!i(n)){return new e(r.east,r.north)}n.longitude=r.east;n.latitude=r.north;n.height=0;return n};l.southeast=function(r,n){t.typeOf.object("rectangle",r);if(!i(n)){return new e(r.east,r.south)}n.longitude=r.east;n.latitude=r.south;n.height=0;return n};l.center=function(r,n){t.typeOf.object("rectangle",r);var a=r.east;var o=r.west;if(a<o){a+=s.TWO_PI}var l=s.negativePiToPi((o+a)*.5);var u=(r.south+r.north)*.5;if(!i(n)){return new e(l,u)}n.longitude=l;n.latitude=u;n.height=0;return n};l.intersection=function(e,r,n){t.typeOf.object("rectangle",e);t.typeOf.object("otherRectangle",r);var a=e.east;var o=e.west;var u=r.east;var c=r.west;if(a<o&&u>0){a+=s.TWO_PI}else if(u<c&&a>0){u+=s.TWO_PI}if(a<o&&c<0){c+=s.TWO_PI}else if(u<c&&o<0){o+=s.TWO_PI}var d=s.negativePiToPi(Math.max(o,c));var f=s.negativePiToPi(Math.min(a,u));if((e.west<e.east||r.west<r.east)&&f<=d){return undefined}var h=Math.max(e.south,r.south);var p=Math.min(e.north,r.north);if(h>=p){return undefined}if(!i(n)){return new l(d,h,f,p)}n.west=d;n.south=h;n.east=f;n.north=p;return n};l.simpleIntersection=function(e,r,n){t.typeOf.object("rectangle",e);t.typeOf.object("otherRectangle",r);var a=Math.max(e.west,r.west);var o=Math.max(e.south,r.south);var s=Math.min(e.east,r.east);var u=Math.min(e.north,r.north);if(o>=u||a>=s){return undefined}if(!i(n)){return new l(a,o,s,u)}n.west=a;n.south=o;n.east=s;n.north=u;return n};l.union=function(e,r,n){t.typeOf.object("rectangle",e);t.typeOf.object("otherRectangle",r);if(!i(n)){n=new l}var a=e.east;var o=e.west;var u=r.east;var c=r.west;if(a<o&&u>0){a+=s.TWO_PI}else if(u<c&&a>0){u+=s.TWO_PI}if(a<o&&c<0){c+=s.TWO_PI}else if(u<c&&o<0){o+=s.TWO_PI}var d=s.convertLongitudeRange(Math.min(o,c));var f=s.convertLongitudeRange(Math.max(a,u));n.west=d;n.south=Math.min(e.south,r.south);n.east=f;n.north=Math.max(e.north,r.north);return n};l.expand=function(e,r,n){t.typeOf.object("rectangle",e);t.typeOf.object("cartographic",r);if(!i(n)){n=new l}n.west=Math.min(e.west,r.longitude);n.south=Math.min(e.south,r.latitude);n.east=Math.max(e.east,r.longitude);n.north=Math.max(e.north,r.latitude);return n};l.contains=function(e,r){t.typeOf.object("rectangle",e);t.typeOf.object("cartographic",r);var i=r.longitude;var n=r.latitude;var a=e.west;var o=e.east;if(o<a){o+=s.TWO_PI;if(i<0){i+=s.TWO_PI}}return(i>a||s.equalsEpsilon(i,a,s.EPSILON14))&&(i<o||s.equalsEpsilon(i,o,s.EPSILON14))&&n>=e.south&&n<=e.north};var u=new e;l.subsample=function(e,n,o,c){t.typeOf.object("rectangle",e);n=r(n,a.WGS84);o=r(o,0);if(!i(c)){c=[]}var d=0;var f=e.north;var h=e.south;var p=e.east;var m=e.west;var v=u;v.height=o;v.longitude=m;v.latitude=f;c[d]=n.cartographicToCartesian(v,c[d]);d++;v.longitude=p;c[d]=n.cartographicToCartesian(v,c[d]);d++;v.latitude=h;c[d]=n.cartographicToCartesian(v,c[d]);d++;v.longitude=m;c[d]=n.cartographicToCartesian(v,c[d]);d++;if(f<0){v.latitude=f}else if(h>0){v.latitude=h}else{v.latitude=0}for(var g=1;g<8;++g){v.longitude=-Math.PI+g*s.PI_OVER_TWO;if(l.contains(e,v)){c[d]=n.cartographicToCartesian(v,c[d]);d++}}if(v.latitude===0){v.longitude=m;c[d]=n.cartographicToCartesian(v,c[d]);d++;v.longitude=p;c[d]=n.cartographicToCartesian(v,c[d]);d++}c.length=d;return c};l.MAX_VALUE=o(new l(-Math.PI,-s.PI_OVER_TWO,Math.PI,s.PI_OVER_TWO));return l});define("Core/BingMapsGeocoderService",["./BingMapsApi","./Check","./defaultValue","./defined","./defineProperties","./loadJsonp","./Rectangle"],function(e,t,r,i,n,a,o){"use strict";var s="https://dev.virtualearth.net/REST/v1/Locations";function l(n){n=r(n,r.EMPTY_OBJECT);t.typeOf.object("options.scene",n.scene);var a=n.key;this._key=e.getKey(a);if(i(a)){var o=e.getErrorCredit(a);if(i(o)){n.scene._frameState.creditDisplay.addDefaultCredit(o)}}}n(l.prototype,{url:{get:function(){return s}},key:{get:function(){return this._key}}});l.prototype.geocode=function(e){t.typeOf.string("query",e);var r=this.key;var i=a(s,{parameters:{query:e,key:r},callbackParameterName:"jsonp"});return i.then(function(e){if(e.resourceSets.length===0){return[]}var t=e.resourceSets[0].resources;return t.map(function(e){var t=e.bbox;var r=t[0];var i=t[1];var n=t[2];var a=t[3];return{displayName:e.name,destination:o.fromDegrees(i,r,a,n)}})})};return l});define("Core/GeographicProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid"],function(e,t,r,i,n,a,o){"use strict";function s(e){this._ellipsoid=r(e,o.WGS84);this._semimajorAxis=this._ellipsoid.maximumRadius;this._oneOverSemimajorAxis=1/this._semimajorAxis}n(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});s.prototype.project=function(t,r){var n=this._semimajorAxis;var a=t.longitude*n;var o=t.latitude*n;var s=t.height;if(!i(r)){return new e(a,o,s)}r.x=a;r.y=o;r.z=s;return r};s.prototype.unproject=function(e,r){if(!i(e)){throw new a("cartesian is required")}var n=this._oneOverSemimajorAxis;var o=e.x*n;var s=e.y*n;var l=e.z;if(!i(r)){return new t(o,s,l)}r.longitude=o;r.latitude=s;r.height=l;return r};return s});define("Core/BoundingRectangle",["./Cartesian2","./Cartographic","./Check","./defaultValue","./defined","./GeographicProjection","./Intersect","./Rectangle"],function(e,t,r,i,n,a,o,s){"use strict";function l(e,t,r,n){this.x=i(e,0);this.y=i(t,0);this.width=i(r,0);this.height=i(n,0)}l.packedLength=4;l.pack=function(e,t,n){r.typeOf.object("value",e);r.defined("array",t);n=i(n,0);t[n++]=e.x;t[n++]=e.y;t[n++]=e.width;t[n]=e.height;return t};l.unpack=function(e,t,a){r.defined("array",e);t=i(t,0);if(!n(a)){a=new l}a.x=e[t++];a.y=e[t++];a.width=e[t++];a.height=e[t];return a};l.fromPoints=function(e,t){if(!n(t)){t=new l}if(!n(e)||e.length===0){t.x=0;t.y=0;t.width=0;t.height=0;return t}var r=e.length;var i=e[0].x;var a=e[0].y;var o=e[0].x;var s=e[0].y;for(var u=1;u<r;u++){var c=e[u];var d=c.x;var f=c.y;i=Math.min(d,i);o=Math.max(d,o);a=Math.min(f,a);s=Math.max(f,s)}t.x=i;t.y=a;t.width=o-i;t.height=s-a;return t};var u=new a;var c=new t;var d=new t;l.fromRectangle=function(t,r,a){if(!n(a)){a=new l}if(!n(t)){a.x=0;a.y=0;a.width=0;a.height=0;return a}r=i(r,u);var o=r.project(s.southwest(t,c));var f=r.project(s.northeast(t,d));e.subtract(f,o,f);a.x=o.x;a.y=o.y;a.width=f.x;a.height=f.y;return a};l.clone=function(e,t){if(!n(e)){return undefined}if(!n(t)){return new l(e.x,e.y,e.width,e.height)}t.x=e.x;t.y=e.y;t.width=e.width;t.height=e.height;return t};l.union=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);if(!n(i)){i=new l}var a=Math.min(e.x,t.x);var o=Math.min(e.y,t.y);var s=Math.max(e.x+e.width,t.x+t.width);var u=Math.max(e.y+e.height,t.y+t.height);i.x=a;i.y=o;i.width=s-a;i.height=u-o;return i};l.expand=function(e,t,i){r.typeOf.object("rectangle",e);r.typeOf.object("point",t);i=l.clone(e,i);var n=t.x-i.x;var a=t.y-i.y;if(n>i.width){i.width=n}else if(n<0){i.width-=n;i.x=t.x}if(a>i.height){i.height=a}else if(a<0){i.height-=a;i.y=t.y}return i};l.intersect=function(e,t){r.typeOf.object("left",e);r.typeOf.object("right",t);var i=e.x;var n=e.y;var a=t.x;var s=t.y;if(!(i>a+t.width||i+e.width<a||n+e.height<s||n>s+t.height)){return o.INTERSECTING}return o.OUTSIDE};l.equals=function(e,t){return e===t||n(e)&&n(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height};l.prototype.clone=function(e){return l.clone(this,e)};l.prototype.intersect=function(e){return l.intersect(this,e)};l.prototype.equals=function(e){return l.equals(this,e)};return l});define("Core/Interval",["./defaultValue"],function(e){"use strict";function t(t,r){this.start=e(t,0);this.stop=e(r,0)}return t});define("Core/Matrix3",["./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math"],function(e,t,r,i,n,a,o,s){"use strict";function l(e,t,i,n,a,o,s,l,u){this[0]=r(e,0);this[1]=r(n,0);this[2]=r(s,0);this[3]=r(t,0);this[4]=r(a,0);this[5]=r(l,0);this[6]=r(i,0);this[7]=r(o,0);this[8]=r(u,0)}l.packedLength=9;l.pack=function(e,i,n){t.typeOf.object("value",e);t.defined("array",i);n=r(n,0);i[n++]=e[0];i[n++]=e[1];i[n++]=e[2];i[n++]=e[3];i[n++]=e[4];i[n++]=e[5];i[n++]=e[6];i[n++]=e[7];i[n++]=e[8];return i};l.unpack=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new l}a[0]=e[n++];a[1]=e[n++];a[2]=e[n++];a[3]=e[n++];a[4]=e[n++];a[5]=e[n++];a[6]=e[n++];a[7]=e[n++];a[8]=e[n++];return a};l.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new l(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];return t};l.fromArray=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new l}a[0]=e[n];a[1]=e[n+1];a[2]=e[n+2];a[3]=e[n+3];a[4]=e[n+4];a[5]=e[n+5];a[6]=e[n+6];a[7]=e[n+7];a[8]=e[n+8];return a};l.fromColumnMajorArray=function(e,r){t.defined("values",e);return l.clone(e,r)};l.fromRowMajorArray=function(e,r){t.defined("values",e);if(!i(r)){return new l(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}r[0]=e[0];r[1]=e[3];r[2]=e[6];r[3]=e[1];r[4]=e[4];r[5]=e[7];r[6]=e[2];r[7]=e[5];r[8]=e[8];return r};l.fromQuaternion=function(e,r){t.typeOf.object("quaternion",e);var n=e.x*e.x;var a=e.x*e.y;var o=e.x*e.z;var s=e.x*e.w;var u=e.y*e.y;var c=e.y*e.z;var d=e.y*e.w;var f=e.z*e.z;var h=e.z*e.w;var p=e.w*e.w;var m=n-u-f+p;var v=2*(a-h);var g=2*(o+d);var _=2*(a+h);var y=-n+u-f+p;var b=2*(c-s);var w=2*(o-d);var C=2*(c+s);var S=-n-u+f+p;if(!i(r)){return new l(m,v,g,_,y,b,w,C,S)}r[0]=m;r[1]=_;r[2]=w;r[3]=v;r[4]=y;r[5]=C;r[6]=g;r[7]=b;r[8]=S;return r};l.fromHeadingPitchRoll=function(e,r){t.typeOf.object("headingPitchRoll",e);var n=Math.cos(-e.pitch);var a=Math.cos(-e.heading);var o=Math.cos(e.roll);var s=Math.sin(-e.pitch);var u=Math.sin(-e.heading);var c=Math.sin(e.roll);var d=n*a;var f=-o*u+c*s*a;var h=c*u+o*s*a;var p=n*u;var m=o*a+c*s*u;var v=-c*a+o*s*u;var g=-s;var _=c*n;var y=o*n;if(!i(r)){return new l(d,f,h,p,m,v,g,_,y)}r[0]=d;r[1]=p;r[2]=g;r[3]=f;r[4]=m;r[5]=_;r[6]=h;r[7]=v;r[8]=y;return r};l.fromScale=function(e,r){t.typeOf.object("scale",e);if(!i(r)){return new l(e.x,0,0,0,e.y,0,0,0,e.z)}r[0]=e.x;r[1]=0;r[2]=0;r[3]=0;r[4]=e.y;r[5]=0;r[6]=0;r[7]=0;r[8]=e.z;return r};l.fromUniformScale=function(e,r){t.typeOf.number("scale",e);if(!i(r)){return new l(e,0,0,0,e,0,0,0,e)}r[0]=e;r[1]=0;r[2]=0;r[3]=0;r[4]=e;r[5]=0;r[6]=0;r[7]=0;r[8]=e;return r};l.fromCrossProduct=function(e,r){t.typeOf.object("vector",e);if(!i(r)){return new l(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)}r[0]=0;r[1]=e.z;r[2]=-e.y;r[3]=-e.z;r[4]=0;r[5]=e.x;r[6]=e.y;r[7]=-e.x;r[8]=0;return r};l.fromRotationX=function(e,r){t.typeOf.number("angle",e);var n=Math.cos(e);var a=Math.sin(e);if(!i(r)){return new l(1,0,0,0,n,-a,0,a,n)}r[0]=1;r[1]=0;r[2]=0;r[3]=0;r[4]=n;r[5]=a;r[6]=0;r[7]=-a;r[8]=n;return r};l.fromRotationY=function(e,r){t.typeOf.number("angle",e);var n=Math.cos(e);var a=Math.sin(e);if(!i(r)){return new l(n,0,a,0,1,0,-a,0,n)}r[0]=n;r[1]=0;r[2]=-a;r[3]=0;r[4]=1;r[5]=0;r[6]=a;r[7]=0;r[8]=n;return r};l.fromRotationZ=function(e,r){t.typeOf.number("angle",e);var n=Math.cos(e);var a=Math.sin(e);if(!i(r)){return new l(n,-a,0,a,n,0,0,0,1)}r[0]=n;r[1]=a;r[2]=0;r[3]=-a;r[4]=n;r[5]=0;r[6]=0;r[7]=0;r[8]=1;return r};l.toArray=function(e,r){t.typeOf.object("matrix",e);if(!i(r)){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]}r[0]=e[0];r[1]=e[1];r[2]=e[2];r[3]=e[3];r[4]=e[4];r[5]=e[5];r[6]=e[6];r[7]=e[7];r[8]=e[8];return r};l.getElementIndex=function(e,r){t.typeOf.number.greaterThanOrEquals("row",r,0);t.typeOf.number.lessThanOrEquals("row",r,2);t.typeOf.number.greaterThanOrEquals("column",e,0);t.typeOf.number.lessThanOrEquals("column",e,2);return e*3+r};l.getColumn=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,2);t.typeOf.object("result",i);var n=r*3;var a=e[n];var o=e[n+1];var s=e[n+2];i.x=a;i.y=o;i.z=s;return i};l.setColumn=function(e,r,i,n){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,2);t.typeOf.object("cartesian",i);t.typeOf.object("result",n);n=l.clone(e,n);var a=r*3;n[a]=i.x;n[a+1]=i.y;n[a+2]=i.z;return n};l.getRow=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,2);t.typeOf.object("result",i);var n=e[r];var a=e[r+3];var o=e[r+6];i.x=n;i.y=a;i.z=o;return i};l.setRow=function(e,r,i,n){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,2);t.typeOf.object("cartesian",i);t.typeOf.object("result",n);n=l.clone(e,n);n[r]=i.x;n[r+3]=i.y;n[r+6]=i.z;return n};var u=new e;l.getScale=function(r,i){t.typeOf.object("matrix",r);t.typeOf.object("result",i);i.x=e.magnitude(e.fromElements(r[0],r[1],r[2],u));i.y=e.magnitude(e.fromElements(r[3],r[4],r[5],u));i.z=e.magnitude(e.fromElements(r[6],r[7],r[8],u));return i};var c=new e;l.getMaximumScale=function(t){l.getScale(t,c);return e.maximumComponent(c)};l.multiply=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);var n=e[0]*r[0]+e[3]*r[1]+e[6]*r[2];var a=e[1]*r[0]+e[4]*r[1]+e[7]*r[2];var o=e[2]*r[0]+e[5]*r[1]+e[8]*r[2];var s=e[0]*r[3]+e[3]*r[4]+e[6]*r[5];var l=e[1]*r[3]+e[4]*r[4]+e[7]*r[5];var u=e[2]*r[3]+e[5]*r[4]+e[8]*r[5];var c=e[0]*r[6]+e[3]*r[7]+e[6]*r[8];var d=e[1]*r[6]+e[4]*r[7]+e[7]*r[8];var f=e[2]*r[6]+e[5]*r[7]+e[8]*r[8];i[0]=n;i[1]=a;i[2]=o;i[3]=s;i[4]=l;i[5]=u;i[6]=c;i[7]=d;i[8]=f;return i};l.add=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i[0]=e[0]+r[0];i[1]=e[1]+r[1];i[2]=e[2]+r[2];i[3]=e[3]+r[3];i[4]=e[4]+r[4];i[5]=e[5]+r[5];i[6]=e[6]+r[6];i[7]=e[7]+r[7];i[8]=e[8]+r[8];return i};l.subtract=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i[0]=e[0]-r[0];i[1]=e[1]-r[1];i[2]=e[2]-r[2];i[3]=e[3]-r[3];i[4]=e[4]-r[4];i[5]=e[5]-r[5];i[6]=e[6]-r[6];i[7]=e[7]-r[7];i[8]=e[8]-r[8];return i};l.multiplyByVector=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.object("cartesian",r);t.typeOf.object("result",i);var n=r.x;var a=r.y;var o=r.z;var s=e[0]*n+e[3]*a+e[6]*o;var l=e[1]*n+e[4]*a+e[7]*o;var u=e[2]*n+e[5]*a+e[8]*o;i.x=s;i.y=l;i.z=u;return i};l.multiplyByScalar=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number("scalar",r);t.typeOf.object("result",i);i[0]=e[0]*r;i[1]=e[1]*r;i[2]=e[2]*r;i[3]=e[3]*r;i[4]=e[4]*r;i[5]=e[5]*r;i[6]=e[6]*r;i[7]=e[7]*r;i[8]=e[8]*r;return i};l.multiplyByScale=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.object("scale",r);t.typeOf.object("result",i);i[0]=e[0]*r.x;i[1]=e[1]*r.x;i[2]=e[2]*r.x;i[3]=e[3]*r.y;i[4]=e[4]*r.y;i[5]=e[5]*r.y;i[6]=e[6]*r.z;i[7]=e[7]*r.z;i[8]=e[8]*r.z;return i};l.negate=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);r[0]=-e[0];r[1]=-e[1];r[2]=-e[2];r[3]=-e[3];r[4]=-e[4];r[5]=-e[5];r[6]=-e[6];r[7]=-e[7];r[8]=-e[8];return r};l.transpose=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);var i=e[0];var n=e[3];var a=e[6];var o=e[1];var s=e[4];var l=e[7];var u=e[2];var c=e[5];var d=e[8];r[0]=i;r[1]=n;r[2]=a;r[3]=o;r[4]=s;r[5]=l;r[6]=u;r[7]=c;r[8]=d;return r};function d(e){var t=0;for(var r=0;r<9;++r){var i=e[r];t+=i*i}return Math.sqrt(t)}var f=[1,0,0];var h=[2,2,1];function p(e){var t=0;for(var r=0;r<3;++r){var i=e[l.getElementIndex(h[r],f[r])];t+=2*i*i}return Math.sqrt(t)}function m(e,t){var r=s.EPSILON15;var i=0;var n=1;for(var a=0;a<3;++a){var o=Math.abs(e[l.getElementIndex(h[a],f[a])]);if(o>i){n=a;i=o}}var u=1;var c=0;var d=f[n];var p=h[n];if(Math.abs(e[l.getElementIndex(p,d)])>r){var m=e[l.getElementIndex(p,p)];var v=e[l.getElementIndex(d,d)];var g=e[l.getElementIndex(p,d)];var _=(m-v)/2/g;var y;if(_<0){y=-1/(-_+Math.sqrt(1+_*_))}else{y=1/(_+Math.sqrt(1+_*_))}u=1/Math.sqrt(1+y*y);c=y*u}t=l.clone(l.IDENTITY,t);t[l.getElementIndex(d,d)]=t[l.getElementIndex(p,p)]=u;t[l.getElementIndex(p,d)]=c;t[l.getElementIndex(d,p)]=-c;return t}var v=new l;var g=new l;l.computeEigenDecomposition=function(e,r){t.typeOf.object("matrix",e);var n=s.EPSILON20;var a=10;var o=0;var u=0;if(!i(r)){r={}}var c=r.unitary=l.clone(l.IDENTITY,r.unitary);var f=r.diagonal=l.clone(e,r.diagonal);var h=n*d(f);while(u<a&&p(f)>h){m(f,v);l.transpose(v,g);l.multiply(f,v,f);l.multiply(g,f,f);l.multiply(c,v,c);if(++o>2){++u;o=0}}return r};l.abs=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);r[0]=Math.abs(e[0]);r[1]=Math.abs(e[1]);r[2]=Math.abs(e[2]);r[3]=Math.abs(e[3]);r[4]=Math.abs(e[4]);r[5]=Math.abs(e[5]);r[6]=Math.abs(e[6]);r[7]=Math.abs(e[7]);r[8]=Math.abs(e[8]);return r};l.determinant=function(e){t.typeOf.object("matrix",e);var r=e[0];var i=e[3];var n=e[6];var a=e[1];var o=e[4];var s=e[7];var l=e[2];var u=e[5];var c=e[8];return r*(o*c-u*s)+a*(u*n-i*c)+l*(i*s-o*n)};l.inverse=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);var i=e[0];var n=e[1];var o=e[2];var u=e[3];var c=e[4];var d=e[5];var f=e[6];var h=e[7];var p=e[8];var m=l.determinant(e);if(Math.abs(m)<=s.EPSILON15){throw new a("matrix is not invertible")}r[0]=c*p-h*d;r[1]=h*o-n*p;r[2]=n*d-c*o;r[3]=f*d-u*p;r[4]=i*p-f*o;r[5]=u*o-i*d;r[6]=u*h-f*c;r[7]=f*n-i*h;r[8]=i*c-u*n;var v=1/m;return l.multiplyByScalar(r,v,r)};l.equals=function(e,t){return e===t||i(e)&&i(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]};l.equalsEpsilon=function(e,r,n){t.typeOf.number("epsilon",n);return e===r||i(e)&&i(r)&&Math.abs(e[0]-r[0])<=n&&Math.abs(e[1]-r[1])<=n&&Math.abs(e[2]-r[2])<=n&&Math.abs(e[3]-r[3])<=n&&Math.abs(e[4]-r[4])<=n&&Math.abs(e[5]-r[5])<=n&&Math.abs(e[6]-r[6])<=n&&Math.abs(e[7]-r[7])<=n&&Math.abs(e[8]-r[8])<=n};l.IDENTITY=o(new l(1,0,0,0,1,0,0,0,1));l.ZERO=o(new l(0,0,0,0,0,0,0,0,0));l.COLUMN0ROW0=0;l.COLUMN0ROW1=1;l.COLUMN0ROW2=2;l.COLUMN1ROW0=3;l.COLUMN1ROW1=4;l.COLUMN1ROW2=5;l.COLUMN2ROW0=6;l.COLUMN2ROW1=7;l.COLUMN2ROW2=8;n(l.prototype,{length:{get:function(){return l.packedLength}}});l.prototype.clone=function(e){return l.clone(this,e)};l.prototype.equals=function(e){return l.equals(this,e)};l.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]&&e[4]===t[r+4]&&e[5]===t[r+5]&&e[6]===t[r+6]&&e[7]===t[r+7]&&e[8]===t[r+8]};l.prototype.equalsEpsilon=function(e,t){return l.equalsEpsilon(this,e,t)};l.prototype.toString=function(){return"("+this[0]+", "+this[3]+", "+this[6]+")\n"+"("+this[1]+", "+this[4]+", "+this[7]+")\n"+"("+this[2]+", "+this[5]+", "+this[8]+")"};return l});define("Core/Cartesian4",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,r,i,n,a){"use strict";function o(e,r,i,n){this.x=t(e,0);this.y=t(r,0);this.z=t(i,0);this.w=t(n,0)}o.fromElements=function(e,t,i,n,a){if(!r(a)){return new o(e,t,i,n)}a.x=e;a.y=t;a.z=i;a.w=n;return a};o.fromColor=function(t,i){e.typeOf.object("color",t);if(!r(i)){return new o(t.red,t.green,t.blue,t.alpha)}i.x=t.red;i.y=t.green;i.z=t.blue;i.w=t.alpha;return i};o.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new o(e.x,e.y,e.z,e.w)}t.x=e.x;t.y=e.y;t.z=e.z;t.w=e.w;return t};o.packedLength=4;o.pack=function(r,i,n){e.typeOf.object("value",r);e.defined("array",i);n=t(n,0);i[n++]=r.x;i[n++]=r.y;i[n++]=r.z;i[n]=r.w;return i};o.unpack=function(i,n,a){e.defined("array",i);n=t(n,0);if(!r(a)){a=new o}a.x=i[n++];a.y=i[n++];a.z=i[n++];a.w=i[n];return a};o.packArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n*4)}else{i.length=n*4}for(var a=0;a<n;++a){o.pack(t[a],i,a*4)}return i};o.unpackArray=function(t,i){e.defined("array",t);var n=t.length;if(!r(i)){i=new Array(n/4)}else{i.length=n/4}for(var a=0;a<n;a+=4){var s=a/4;i[s]=o.unpack(t,a,i[s])}return i};o.fromArray=o.unpack;o.maximumComponent=function(t){e.typeOf.object("cartesian",t);return Math.max(t.x,t.y,t.z,t.w)};o.minimumComponent=function(t){e.typeOf.object("cartesian",t);return Math.min(t.x,t.y,t.z,t.w)};o.minimumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.min(t.x,r.x);i.y=Math.min(t.y,r.y);i.z=Math.min(t.z,r.z);i.w=Math.min(t.w,r.w);return i};o.maximumByComponent=function(t,r,i){e.typeOf.object("first",t);e.typeOf.object("second",r);e.typeOf.object("result",i);i.x=Math.max(t.x,r.x);i.y=Math.max(t.y,r.y);i.z=Math.max(t.z,r.z);i.w=Math.max(t.w,r.w);return i};o.magnitudeSquared=function(t){e.typeOf.object("cartesian",t);return t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w};o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitude(s)};o.distanceSquared=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);o.subtract(t,r,s);return o.magnitudeSquared(s)};o.normalize=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var n=o.magnitude(t);r.x=t.x/n;r.y=t.y/n;r.z=t.z/n;r.w=t.w/n;if(isNaN(r.x)||isNaN(r.y)||isNaN(r.z)||isNaN(r.w)){throw new i("normalized result is not a number")}return r};o.dot=function(t,r){e.typeOf.object("left",t);e.typeOf.object("right",r);return t.x*r.x+t.y*r.y+t.z*r.z+t.w*r.w};o.multiplyComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x*r.x;i.y=t.y*r.y;i.z=t.z*r.z;i.w=t.w*r.w;return i};o.divideComponents=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x/r.x;i.y=t.y/r.y;i.z=t.z/r.z;i.w=t.w/r.w;return i};o.add=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x+r.x;i.y=t.y+r.y;i.z=t.z+r.z;i.w=t.w+r.w;return i};o.subtract=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.x=t.x-r.x;i.y=t.y-r.y;i.z=t.z-r.z;i.w=t.w-r.w;return i};o.multiplyByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x*r;i.y=t.y*r;i.z=t.z*r;i.w=t.w*r;return i};o.divideByScalar=function(t,r,i){e.typeOf.object("cartesian",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.x=t.x/r;i.y=t.y/r;i.z=t.z/r;i.w=t.w/r;return i};o.negate=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=-t.x;r.y=-t.y;r.z=-t.z;r.w=-t.w;return r};o.abs=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);r.x=Math.abs(t.x);r.y=Math.abs(t.y);r.z=Math.abs(t.z);r.w=Math.abs(t.w);return r};var l=new o;o.lerp=function(t,r,i,n){e.typeOf.object("start",t);e.typeOf.object("end",r);e.typeOf.number("t",i);e.typeOf.object("result",n);o.multiplyByScalar(r,i,l);n=o.multiplyByScalar(t,1-i,n);return o.add(l,n,n)};var u=new o;o.mostOrthogonalAxis=function(t,r){e.typeOf.object("cartesian",t);e.typeOf.object("result",r);var i=o.normalize(t,u);o.abs(i,i);if(i.x<=i.y){if(i.x<=i.z){if(i.x<=i.w){r=o.clone(o.UNIT_X,r)}else{r=o.clone(o.UNIT_W,r)}}else if(i.z<=i.w){r=o.clone(o.UNIT_Z,r)}else{r=o.clone(o.UNIT_W,r)}}else if(i.y<=i.z){if(i.y<=i.w){r=o.clone(o.UNIT_Y,r)}else{r=o.clone(o.UNIT_W,r)}}else if(i.z<=i.w){r=o.clone(o.UNIT_Z,r)}else{r=o.clone(o.UNIT_W,r)}return r};o.equals=function(e,t){return e===t||r(e)&&r(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};o.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]&&e.z===t[r+2]&&e.w===t[r+3]};o.equalsEpsilon=function(e,t,i,n){return e===t||r(e)&&r(t)&&a.equalsEpsilon(e.x,t.x,i,n)&&a.equalsEpsilon(e.y,t.y,i,n)&&a.equalsEpsilon(e.z,t.z,i,n)&&a.equalsEpsilon(e.w,t.w,i,n)};o.ZERO=n(new o(0,0,0,0));o.UNIT_X=n(new o(1,0,0,0));o.UNIT_Y=n(new o(0,1,0,0));o.UNIT_Z=n(new o(0,0,1,0));o.UNIT_W=n(new o(0,0,0,1));o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e){return o.equals(this,e)};o.prototype.equalsEpsilon=function(e,t,r){return o.equalsEpsilon(this,e,t,r)};o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};return o});define("Core/RuntimeError",["./defined"],function(e){"use strict";function t(e){this.name="RuntimeError";this.message=e;var t;try{throw new Error}catch(e){t=e.stack}this.stack=t}if(e(Object.create)){t.prototype=Object.create(Error.prototype);t.prototype.constructor=t}t.prototype.toString=function(){var t=this.name+": "+this.message;if(e(this.stack)){t+="\n"+this.stack.toString()}return t};return t});define("Core/Matrix4",["./Cartesian3","./Cartesian4","./Check","./defaultValue","./defined","./defineProperties","./freezeObject","./Math","./Matrix3","./RuntimeError"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e,t,r,n,a,o,s,l,u,c,d,f,h,p,m,v){this[0]=i(e,0);this[1]=i(a,0);this[2]=i(u,0);this[3]=i(h,0);this[4]=i(t,0);this[5]=i(o,0);this[6]=i(c,0);this[7]=i(p,0);this[8]=i(r,0);this[9]=i(s,0);this[10]=i(d,0);this[11]=i(m,0);this[12]=i(n,0);this[13]=i(l,0);this[14]=i(f,0);this[15]=i(v,0)}c.packedLength=16;c.pack=function(e,t,n){r.typeOf.object("value",e);r.defined("array",t);n=i(n,0);t[n++]=e[0];t[n++]=e[1];t[n++]=e[2];t[n++]=e[3];t[n++]=e[4];t[n++]=e[5];t[n++]=e[6];t[n++]=e[7];t[n++]=e[8];t[n++]=e[9];t[n++]=e[10];t[n++]=e[11];t[n++]=e[12];t[n++]=e[13];t[n++]=e[14];t[n]=e[15];return t};c.unpack=function(e,t,a){r.defined("array",e);t=i(t,0);if(!n(a)){a=new c}a[0]=e[t++];a[1]=e[t++];a[2]=e[t++];a[3]=e[t++];a[4]=e[t++];a[5]=e[t++];a[6]=e[t++];a[7]=e[t++];a[8]=e[t++];a[9]=e[t++];a[10]=e[t++];a[11]=e[t++];a[12]=e[t++];a[13]=e[t++];a[14]=e[t++];a[15]=e[t];return a};c.clone=function(e,t){if(!n(e)){return undefined}if(!n(t)){return new c(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};c.fromArray=c.unpack;c.fromColumnMajorArray=function(e,t){r.defined("values",e);return c.clone(e,t)};c.fromRowMajorArray=function(e,t){r.defined("values",e);if(!n(t)){return new c(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}t[0]=e[0];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=e[1];t[5]=e[5];t[6]=e[9];t[7]=e[13];t[8]=e[2];t[9]=e[6];t[10]=e[10];t[11]=e[14];t[12]=e[3];t[13]=e[7];t[14]=e[11];t[15]=e[15];return t};c.fromRotationTranslation=function(t,a,o){r.typeOf.object("rotation",t);a=i(a,e.ZERO);if(!n(o)){return new c(t[0],t[3],t[6],a.x,t[1],t[4],t[7],a.y,t[2],t[5],t[8],a.z,0,0,0,1)}o[0]=t[0];o[1]=t[1];o[2]=t[2];o[3]=0;o[4]=t[3];o[5]=t[4];o[6]=t[5];o[7]=0;o[8]=t[6];o[9]=t[7];o[10]=t[8];o[11]=0;o[12]=a.x;o[13]=a.y;o[14]=a.z;o[15]=1;return o};c.fromTranslationQuaternionRotationScale=function(e,t,i,a){r.typeOf.object("translation",e);r.typeOf.object("rotation",t);r.typeOf.object("scale",i);if(!n(a)){a=new c}var o=i.x;var s=i.y;var l=i.z;var u=t.x*t.x;var d=t.x*t.y;var f=t.x*t.z;var h=t.x*t.w;var p=t.y*t.y;var m=t.y*t.z;var v=t.y*t.w;var g=t.z*t.z;var _=t.z*t.w;var y=t.w*t.w;var b=u-p-g+y;var w=2*(d-_);var C=2*(f+v);var S=2*(d+_);var T=-u+p-g+y;var E=2*(m-h);var x=2*(f-v);var P=2*(m+h);var A=-u-p+g+y;a[0]=b*o;a[1]=S*o;a[2]=x*o;a[3]=0;a[4]=w*s;a[5]=T*s;a[6]=P*s;a[7]=0;a[8]=C*l;a[9]=E*l;a[10]=A*l;a[11]=0;a[12]=e.x;a[13]=e.y;a[14]=e.z;a[15]=1;return a};c.fromTranslationRotationScale=function(e,t){r.typeOf.object("translationRotationScale",e);return c.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)};c.fromTranslation=function(e,t){r.typeOf.object("translation",e);return c.fromRotationTranslation(l.IDENTITY,e,t)};c.fromScale=function(e,t){r.typeOf.object("scale",e);if(!n(t)){return new c(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)}t[0]=e.x;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=e.y;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=e.z;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};c.fromUniformScale=function(e,t){r.typeOf.number("scale",e);if(!n(t)){return new c(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)}t[0]=e;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=e;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=e;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t};var d=new e;var f=new e;var h=new e;c.fromCamera=function(t,i){r.typeOf.object("camera",t);var a=t.position;var o=t.direction;var s=t.up;r.typeOf.object("camera.position",a);r.typeOf.object("camera.direction",o);r.typeOf.object("camera.up",s);e.normalize(o,d);e.normalize(e.cross(d,s,f),f);e.normalize(e.cross(f,d,h),h);var l=f.x;var u=f.y;var p=f.z;var m=d.x;var v=d.y;var g=d.z;var _=h.x;var y=h.y;var b=h.z;var w=a.x;var C=a.y;var S=a.z;var T=l*-w+u*-C+p*-S;var E=_*-w+y*-C+b*-S;var x=m*w+v*C+g*S;if(!n(i)){return new c(l,u,p,T,_,y,b,E,-m,-v,-g,x,0,0,0,1)}i[0]=l;i[1]=_;i[2]=-m;i[3]=0;i[4]=u;i[5]=y;i[6]=-v;i[7]=0;i[8]=p;i[9]=b;i[10]=-g;i[11]=0;i[12]=T;i[13]=E;i[14]=x;i[15]=1;return i};c.computePerspectiveFieldOfView=function(e,t,i,n,a){r.typeOf.number.greaterThan("fovY",e,0);r.typeOf.number.lessThan("fovY",e,Math.PI);r.typeOf.number.greaterThan("near",i,0);r.typeOf.number.greaterThan("far",n,0);r.typeOf.object("result",a);var o=Math.tan(e*.5);var s=1/o;var l=s/t;var u=(n+i)/(i-n);var c=2*n*i/(i-n);a[0]=l;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=s;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=u;a[11]=-1;a[12]=0;a[13]=0;a[14]=c;a[15]=0;return a};c.computeOrthographicOffCenter=function(e,t,i,n,a,o,s){r.typeOf.number("left",e);r.typeOf.number("right",t);r.typeOf.number("bottom",i);r.typeOf.number("top",n);r.typeOf.number("near",a);r.typeOf.number("far",o);r.typeOf.object("result",s);var l=1/(t-e);var u=1/(n-i);var c=1/(o-a);var d=-(t+e)*l;var f=-(n+i)*u;var h=-(o+a)*c;l*=2;u*=2;c*=-2;s[0]=l;s[1]=0;s[2]=0;s[3]=0;s[4]=0;s[5]=u;s[6]=0;s[7]=0;s[8]=0;s[9]=0;s[10]=c;s[11]=0;s[12]=d;s[13]=f;s[14]=h;s[15]=1;return s};c.computePerspectiveOffCenter=function(e,t,i,n,a,o,s){r.typeOf.number("left",e);r.typeOf.number("right",t);r.typeOf.number("bottom",i);r.typeOf.number("top",n);r.typeOf.number("near",a);r.typeOf.number("far",o);r.typeOf.object("result",s);var l=2*a/(t-e);var u=2*a/(n-i);var c=(t+e)/(t-e);var d=(n+i)/(n-i);var f=-(o+a)/(o-a);var h=-1;var p=-2*o*a/(o-a);s[0]=l;s[1]=0;s[2]=0;s[3]=0;s[4]=0;s[5]=u;s[6]=0;s[7]=0;s[8]=c;s[9]=d;s[10]=f;s[11]=h;s[12]=0;s[13]=0;s[14]=p;s[15]=0;return s};c.computeInfinitePerspectiveOffCenter=function(e,t,i,n,a,o){r.typeOf.number("left",e);r.typeOf.number("right",t);r.typeOf.number("bottom",i);r.typeOf.number("top",n);r.typeOf.number("near",a);r.typeOf.object("result",o);var s=2*a/(t-e);var l=2*a/(n-i);var u=(t+e)/(t-e);var c=(n+i)/(n-i);var d=-1;var f=-1;var h=-2*a;o[0]=s;o[1]=0;o[2]=0;o[3]=0;o[4]=0;o[5]=l;o[6]=0;o[7]=0;o[8]=u;o[9]=c;o[10]=d;o[11]=f;o[12]=0;o[13]=0;o[14]=h;o[15]=0;return o};c.computeViewportTransformation=function(e,t,n,a){r.typeOf.object("result",a);e=i(e,i.EMPTY_OBJECT);var o=i(e.x,0);var s=i(e.y,0);var l=i(e.width,0);var u=i(e.height,0);t=i(t,0);n=i(n,1);var c=l*.5;var d=u*.5;var f=(n-t)*.5;var h=c;var p=d;var m=f;var v=o+c;var g=s+d;var _=t+f;var y=1;a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=p;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=m;a[11]=0;a[12]=v;a[13]=g;a[14]=_;a[15]=y;return a};c.computeView=function(t,i,n,a,o){r.typeOf.object("position",t);r.typeOf.object("direction",i);r.typeOf.object("up",n);r.typeOf.object("right",a);r.typeOf.object("result",o);o[0]=a.x;o[1]=n.x;o[2]=-i.x;o[3]=0;o[4]=a.y;o[5]=n.y;o[6]=-i.y;o[7]=0;o[8]=a.z;o[9]=n.z;o[10]=-i.z;o[11]=0;o[12]=-e.dot(a,t);o[13]=-e.dot(n,t);o[14]=e.dot(i,t);o[15]=1;return o};c.toArray=function(e,t){r.typeOf.object("matrix",e);if(!n(t)){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};c.getElementIndex=function(e,t){r.typeOf.number.greaterThanOrEquals("row",t,0);r.typeOf.number.lessThanOrEquals("row",t,3);r.typeOf.number.greaterThanOrEquals("column",e,0);r.typeOf.number.lessThanOrEquals("column",e,3);return e*4+t};c.getColumn=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.number.greaterThanOrEquals("index",t,0);r.typeOf.number.lessThanOrEquals("index",t,3);r.typeOf.object("result",i);var n=t*4;var a=e[n];var o=e[n+1];var s=e[n+2];var l=e[n+3];i.x=a;i.y=o;i.z=s;i.w=l;return i};c.setColumn=function(e,t,i,n){r.typeOf.object("matrix",e);r.typeOf.number.greaterThanOrEquals("index",t,0);r.typeOf.number.lessThanOrEquals("index",t,3);r.typeOf.object("cartesian",i);r.typeOf.object("result",n);n=c.clone(e,n);var a=t*4;n[a]=i.x;n[a+1]=i.y;n[a+2]=i.z;n[a+3]=i.w;return n};c.setTranslation=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("translation",t);r.typeOf.object("result",i);i[0]=e[0];i[1]=e[1];i[2]=e[2];i[3]=e[3];i[4]=e[4];i[5]=e[5];i[6]=e[6];i[7]=e[7];i[8]=e[8];i[9]=e[9];i[10]=e[10];i[11]=e[11];i[12]=t.x;i[13]=t.y;i[14]=t.z;i[15]=e[15];return i};c.getRow=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.number.greaterThanOrEquals("index",t,0);r.typeOf.number.lessThanOrEquals("index",t,3);r.typeOf.object("result",i);var n=e[t];var a=e[t+4];var o=e[t+8];var s=e[t+12];i.x=n;i.y=a;i.z=o;i.w=s;return i};c.setRow=function(e,t,i,n){r.typeOf.object("matrix",e);r.typeOf.number.greaterThanOrEquals("index",t,0);r.typeOf.number.lessThanOrEquals("index",t,3);r.typeOf.object("cartesian",i);r.typeOf.object("result",n);n=c.clone(e,n);n[t]=i.x;n[t+4]=i.y;n[t+8]=i.z;n[t+12]=i.w;return n};var p=new e;c.getScale=function(t,i){r.typeOf.object("matrix",t);r.typeOf.object("result",i);i.x=e.magnitude(e.fromElements(t[0],t[1],t[2],p));i.y=e.magnitude(e.fromElements(t[4],t[5],t[6],p));i.z=e.magnitude(e.fromElements(t[8],t[9],t[10],p));return i};var m=new e;c.getMaximumScale=function(t){c.getScale(t,m);return e.maximumComponent(m)};c.multiply=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);r.typeOf.object("result",i);var n=e[0];var a=e[1];var o=e[2];var s=e[3];var l=e[4];var u=e[5];var c=e[6];var d=e[7];var f=e[8];var h=e[9];var p=e[10];var m=e[11];var v=e[12];var g=e[13];var _=e[14];var y=e[15];var b=t[0];var w=t[1];var C=t[2];var S=t[3];var T=t[4];var E=t[5];var x=t[6];var P=t[7];var A=t[8];var O=t[9];var D=t[10];var I=t[11];var M=t[12];var R=t[13];var L=t[14];var N=t[15];var k=n*b+l*w+f*C+v*S;var F=a*b+u*w+h*C+g*S;var B=o*b+c*w+p*C+_*S;var U=s*b+d*w+m*C+y*S;var V=n*T+l*E+f*x+v*P;var z=a*T+u*E+h*x+g*P;var q=o*T+c*E+p*x+_*P;var G=s*T+d*E+m*x+y*P;var H=n*A+l*O+f*D+v*I;var j=a*A+u*O+h*D+g*I;var W=o*A+c*O+p*D+_*I;var Y=s*A+d*O+m*D+y*I;var X=n*M+l*R+f*L+v*N;var Q=a*M+u*R+h*L+g*N;var Z=o*M+c*R+p*L+_*N;var K=s*M+d*R+m*L+y*N;i[0]=k;i[1]=F;i[2]=B;i[3]=U;i[4]=V;i[5]=z;i[6]=q;i[7]=G;i[8]=H;i[9]=j;i[10]=W;i[11]=Y;i[12]=X;i[13]=Q;i[14]=Z;i[15]=K;return i};c.add=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);r.typeOf.object("result",i);i[0]=e[0]+t[0];i[1]=e[1]+t[1];i[2]=e[2]+t[2];i[3]=e[3]+t[3];i[4]=e[4]+t[4];i[5]=e[5]+t[5];i[6]=e[6]+t[6];i[7]=e[7]+t[7];i[8]=e[8]+t[8];i[9]=e[9]+t[9];i[10]=e[10]+t[10];i[11]=e[11]+t[11];i[12]=e[12]+t[12];i[13]=e[13]+t[13];i[14]=e[14]+t[14];i[15]=e[15]+t[15];return i};c.subtract=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);r.typeOf.object("result",i);i[0]=e[0]-t[0];i[1]=e[1]-t[1];i[2]=e[2]-t[2];i[3]=e[3]-t[3];i[4]=e[4]-t[4];i[5]=e[5]-t[5];i[6]=e[6]-t[6];i[7]=e[7]-t[7];i[8]=e[8]-t[8];i[9]=e[9]-t[9];i[10]=e[10]-t[10];i[11]=e[11]-t[11];i[12]=e[12]-t[12];i[13]=e[13]-t[13];i[14]=e[14]-t[14];i[15]=e[15]-t[15];return i};c.multiplyTransformation=function(e,t,i){r.typeOf.object("left",e);r.typeOf.object("right",t);r.typeOf.object("result",i);var n=e[0];var a=e[1];var o=e[2];var s=e[4];var l=e[5];var u=e[6];var c=e[8];var d=e[9];var f=e[10];var h=e[12];var p=e[13];var m=e[14];var v=t[0];var g=t[1];var _=t[2];var y=t[4];var b=t[5];var w=t[6];var C=t[8];var S=t[9];var T=t[10];var E=t[12];var x=t[13];var P=t[14];var A=n*v+s*g+c*_;var O=a*v+l*g+d*_;var D=o*v+u*g+f*_;var I=n*y+s*b+c*w;var M=a*y+l*b+d*w;var R=o*y+u*b+f*w;var L=n*C+s*S+c*T;var N=a*C+l*S+d*T;var k=o*C+u*S+f*T;var F=n*E+s*x+c*P+h;var B=a*E+l*x+d*P+p;var U=o*E+u*x+f*P+m;i[0]=A;i[1]=O;i[2]=D;i[3]=0;i[4]=I;i[5]=M;i[6]=R;i[7]=0;i[8]=L;i[9]=N;i[10]=k;i[11]=0;i[12]=F;i[13]=B;i[14]=U;i[15]=1;return i};c.multiplyByMatrix3=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("rotation",t);r.typeOf.object("result",i);var n=e[0];var a=e[1];var o=e[2];var s=e[4];var l=e[5];var u=e[6];var c=e[8];var d=e[9];var f=e[10];var h=t[0];var p=t[1];var m=t[2];var v=t[3];var g=t[4];var _=t[5];var y=t[6];var b=t[7];var w=t[8];var C=n*h+s*p+c*m;var S=a*h+l*p+d*m;var T=o*h+u*p+f*m;var E=n*v+s*g+c*_;var x=a*v+l*g+d*_;var P=o*v+u*g+f*_;var A=n*y+s*b+c*w;var O=a*y+l*b+d*w;var D=o*y+u*b+f*w;i[0]=C;i[1]=S;i[2]=T;i[3]=0;i[4]=E;i[5]=x;i[6]=P;i[7]=0;i[8]=A;i[9]=O;i[10]=D;i[11]=0;i[12]=e[12];i[13]=e[13];i[14]=e[14];i[15]=e[15];return i};c.multiplyByTranslation=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("translation",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=n*e[0]+a*e[4]+o*e[8]+e[12];var l=n*e[1]+a*e[5]+o*e[9]+e[13];var u=n*e[2]+a*e[6]+o*e[10]+e[14];i[0]=e[0];i[1]=e[1];i[2]=e[2];i[3]=e[3];i[4]=e[4];i[5]=e[5];i[6]=e[6];i[7]=e[7];i[8]=e[8];i[9]=e[9];i[10]=e[10];i[11]=e[11];i[12]=s;i[13]=l;i[14]=u;i[15]=e[15];return i};var v=new e;c.multiplyByUniformScale=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.number("scale",t);r.typeOf.object("result",i);v.x=t;v.y=t;v.z=t;return c.multiplyByScale(e,v,i)};c.multiplyByScale=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("scale",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;if(n===1&&a===1&&o===1){return c.clone(e,i)}i[0]=n*e[0];i[1]=n*e[1];i[2]=n*e[2];i[3]=0;i[4]=a*e[4];i[5]=a*e[5];i[6]=a*e[6];i[7]=0;i[8]=o*e[8];i[9]=o*e[9];i[10]=o*e[10];i[11]=0;i[12]=e[12];i[13]=e[13];i[14]=e[14];i[15]=1;return i};c.multiplyByVector=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("cartesian",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=t.w;var l=e[0]*n+e[4]*a+e[8]*o+e[12]*s;var u=e[1]*n+e[5]*a+e[9]*o+e[13]*s;var c=e[2]*n+e[6]*a+e[10]*o+e[14]*s;var d=e[3]*n+e[7]*a+e[11]*o+e[15]*s;i.x=l;i.y=u;i.z=c;i.w=d;return i};c.multiplyByPointAsVector=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("cartesian",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=e[0]*n+e[4]*a+e[8]*o;var l=e[1]*n+e[5]*a+e[9]*o;var u=e[2]*n+e[6]*a+e[10]*o;i.x=s;i.y=l;i.z=u;return i};c.multiplyByPoint=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.object("cartesian",t);r.typeOf.object("result",i);var n=t.x;var a=t.y;var o=t.z;var s=e[0]*n+e[4]*a+e[8]*o+e[12];var l=e[1]*n+e[5]*a+e[9]*o+e[13];var u=e[2]*n+e[6]*a+e[10]*o+e[14];i.x=s;i.y=l;i.z=u;return i};c.multiplyByScalar=function(e,t,i){r.typeOf.object("matrix",e);r.typeOf.number("scalar",t);r.typeOf.object("result",i);i[0]=e[0]*t;i[1]=e[1]*t;i[2]=e[2]*t;i[3]=e[3]*t;i[4]=e[4]*t;i[5]=e[5]*t;i[6]=e[6]*t;i[7]=e[7]*t;i[8]=e[8]*t;i[9]=e[9]*t;i[10]=e[10]*t;i[11]=e[11]*t;i[12]=e[12]*t;i[13]=e[13]*t;i[14]=e[14]*t;i[15]=e[15]*t;return i};c.negate=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);t[0]=-e[0];t[1]=-e[1];t[2]=-e[2];t[3]=-e[3];t[4]=-e[4];t[5]=-e[5];t[6]=-e[6];t[7]=-e[7];t[8]=-e[8];t[9]=-e[9];t[10]=-e[10];t[11]=-e[11];t[12]=-e[12];t[13]=-e[13];t[14]=-e[14];t[15]=-e[15];return t};c.transpose=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);var i=e[1];var n=e[2];var a=e[3];var o=e[6];var s=e[7];var l=e[11];t[0]=e[0];t[1]=e[4];t[2]=e[8];t[3]=e[12];t[4]=i;t[5]=e[5];t[6]=e[9];t[7]=e[13];t[8]=n;t[9]=o;t[10]=e[10];t[11]=e[14];t[12]=a;t[13]=s;t[14]=l;t[15]=e[15];return t};c.abs=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);t[0]=Math.abs(e[0]);t[1]=Math.abs(e[1]);t[2]=Math.abs(e[2]);t[3]=Math.abs(e[3]);t[4]=Math.abs(e[4]);t[5]=Math.abs(e[5]);t[6]=Math.abs(e[6]);t[7]=Math.abs(e[7]);t[8]=Math.abs(e[8]);t[9]=Math.abs(e[9]);t[10]=Math.abs(e[10]);t[11]=Math.abs(e[11]);t[12]=Math.abs(e[12]);t[13]=Math.abs(e[13]);t[14]=Math.abs(e[14]);t[15]=Math.abs(e[15]);return t};c.equals=function(e,t){return e===t||n(e)&&n(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]};c.equalsEpsilon=function(e,t,i){r.typeOf.number("epsilon",i);return e===t||n(e)&&n(t)&&Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i&&Math.abs(e[4]-t[4])<=i&&Math.abs(e[5]-t[5])<=i&&Math.abs(e[6]-t[6])<=i&&Math.abs(e[7]-t[7])<=i&&Math.abs(e[8]-t[8])<=i&&Math.abs(e[9]-t[9])<=i&&Math.abs(e[10]-t[10])<=i&&Math.abs(e[11]-t[11])<=i&&Math.abs(e[12]-t[12])<=i&&Math.abs(e[13]-t[13])<=i&&Math.abs(e[14]-t[14])<=i&&Math.abs(e[15]-t[15])<=i};c.getTranslation=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);t.x=e[12];t.y=e[13];t.z=e[14];return t};c.getRotation=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[4];t[4]=e[5];t[5]=e[6];t[6]=e[8];t[7]=e[9];t[8]=e[10];return t};var g=new l;var _=new l;var y=new t;var b=new t(0,0,0,1);c.inverse=function(e,i){r.typeOf.object("matrix",e);r.typeOf.object("result",i);if(l.equalsEpsilon(c.getRotation(e,g),_,s.EPSILON7)&&t.equals(c.getRow(e,3,y),b)){i[0]=0;i[1]=0;i[2]=0;i[3]=0;i[4]=0;i[5]=0;i[6]=0;i[7]=0;i[8]=0;i[9]=0;i[10]=0;i[11]=0;i[12]=-e[12];i[13]=-e[13];i[14]=-e[14];i[15]=1;return i}var n=e[0];var a=e[4];var o=e[8];var d=e[12];var f=e[1];var h=e[5];var p=e[9];var m=e[13];var v=e[2];var w=e[6];var C=e[10];var S=e[14];var T=e[3];var E=e[7];var x=e[11];var P=e[15];var A=C*P;var O=S*x;var D=w*P;var I=S*E;var M=w*x;var R=C*E;var L=v*P;var N=S*T;var k=v*x;var F=C*T;var B=v*E;var U=w*T;var V=A*h+I*p+M*m-(O*h+D*p+R*m);var z=O*f+L*p+F*m-(A*f+N*p+k*m);var q=D*f+N*h+B*m-(I*f+L*h+U*m);var G=R*f+k*h+U*p-(M*f+F*h+B*p);var H=O*a+D*o+R*d-(A*a+I*o+M*d);var j=A*n+N*o+k*d-(O*n+L*o+F*d);var W=I*n+L*a+U*d-(D*n+N*a+B*d);var Y=M*n+F*a+B*o-(R*n+k*a+U*o);A=o*m;O=d*p;D=a*m;I=d*h;M=a*p;R=o*h;L=n*m;N=d*f;k=n*p;F=o*f;B=n*h;U=a*f;var X=A*E+I*x+M*P-(O*E+D*x+R*P);var Q=O*T+L*x+F*P-(A*T+N*x+k*P);var Z=D*T+N*E+B*P-(I*T+L*E+U*P);var K=R*T+k*E+U*x-(M*T+F*E+B*x);var J=D*C+R*S+O*w-(M*S+A*w+I*C);var $=k*S+A*v+N*C-(L*C+F*S+O*v);var ee=L*w+U*S+I*v-(B*S+D*v+N*w);var te=B*C+M*v+F*w-(k*w+U*C+R*v);var re=n*V+a*z+o*q+d*G;if(Math.abs(re)<s.EPSILON20){throw new u("matrix is not invertible because its determinate is zero.")}re=1/re;i[0]=V*re;i[1]=z*re;i[2]=q*re;i[3]=G*re;i[4]=H*re;i[5]=j*re;i[6]=W*re;i[7]=Y*re;i[8]=X*re;i[9]=Q*re;i[10]=Z*re;i[11]=K*re;i[12]=J*re;i[13]=$*re;i[14]=ee*re;i[15]=te*re;return i};c.inverseTransformation=function(e,t){r.typeOf.object("matrix",e);r.typeOf.object("result",t);var i=e[0];var n=e[1];var a=e[2];var o=e[4];var s=e[5];var l=e[6];var u=e[8];var c=e[9];var d=e[10];var f=e[12];var h=e[13];var p=e[14];var m=-i*f-n*h-a*p;var v=-o*f-s*h-l*p;var g=-u*f-c*h-d*p;t[0]=i;t[1]=o;t[2]=u;t[3]=0;t[4]=n;t[5]=s;t[6]=c;t[7]=0;t[8]=a;t[9]=l;t[10]=d;t[11]=0;t[12]=m;t[13]=v;t[14]=g;t[15]=1;return t};c.IDENTITY=o(new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1));c.ZERO=o(new c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));c.COLUMN0ROW0=0;c.COLUMN0ROW1=1;c.COLUMN0ROW2=2;c.COLUMN0ROW3=3;c.COLUMN1ROW0=4;c.COLUMN1ROW1=5;c.COLUMN1ROW2=6;c.COLUMN1ROW3=7;c.COLUMN2ROW0=8;c.COLUMN2ROW1=9;c.COLUMN2ROW2=10;c.COLUMN2ROW3=11;c.COLUMN3ROW0=12;c.COLUMN3ROW1=13;c.COLUMN3ROW2=14;c.COLUMN3ROW3=15;a(c.prototype,{length:{get:function(){return c.packedLength}}});c.prototype.clone=function(e){return c.clone(this,e)};c.prototype.equals=function(e){return c.equals(this,e)};c.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]&&e[4]===t[r+4]&&e[5]===t[r+5]&&e[6]===t[r+6]&&e[7]===t[r+7]&&e[8]===t[r+8]&&e[9]===t[r+9]&&e[10]===t[r+10]&&e[11]===t[r+11]&&e[12]===t[r+12]&&e[13]===t[r+13]&&e[14]===t[r+14]&&e[15]===t[r+15]};c.prototype.equalsEpsilon=function(e,t){return c.equalsEpsilon(this,e,t)};c.prototype.toString=function(){return"("+this[0]+", "+this[4]+", "+this[8]+", "+this[12]+")\n"+"("+this[1]+", "+this[5]+", "+this[9]+", "+this[13]+")\n"+"("+this[2]+", "+this[6]+", "+this[10]+", "+this[14]+")\n"+"("+this[3]+", "+this[7]+", "+this[11]+", "+this[15]+")"};return c});define("Core/BoundingSphere",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./Ellipsoid","./GeographicProjection","./Intersect","./Interval","./Matrix3","./Matrix4","./Rectangle"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(t,r){this.center=e.clone(i(t,e.ZERO));this.radius=i(r,0)}var h=new e;var p=new e;var m=new e;var v=new e;var g=new e;var _=new e;var y=new e;var b=new e;var w=new e;var C=new e;var S=new e;var T=new e;f.fromPoints=function(t,r){if(!n(r)){r=new f}if(!n(t)||t.length===0){r.center=e.clone(e.ZERO,r.center);r.radius=0;return r}var i=e.clone(t[0],y);var a=e.clone(i,h);var o=e.clone(i,p);var s=e.clone(i,m);var l=e.clone(i,v);var u=e.clone(i,g);var c=e.clone(i,_);var d=t.length;var E;for(E=1;E<d;E++){e.clone(t[E],i);var x=i.x;var P=i.y;var A=i.z;if(x<a.x){e.clone(i,a)}if(x>l.x){e.clone(i,l)}if(P<o.y){e.clone(i,o)}if(P>u.y){e.clone(i,u)}if(A<s.z){e.clone(i,s)}if(A>c.z){e.clone(i,c)}}var O=e.magnitudeSquared(e.subtract(l,a,b));var D=e.magnitudeSquared(e.subtract(u,o,b));var I=e.magnitudeSquared(e.subtract(c,s,b));var M=a;var R=l;var L=O;if(D>L){L=D;M=o;R=u}if(I>L){L=I;M=s;R=c}var N=w;N.x=(M.x+R.x)*.5;N.y=(M.y+R.y)*.5;N.z=(M.z+R.z)*.5;var k=e.magnitudeSquared(e.subtract(R,N,b));var F=Math.sqrt(k);var B=C;B.x=a.x;B.y=o.y;B.z=s.z;var U=S;U.x=l.x;U.y=u.y;U.z=c.z;var V=e.multiplyByScalar(e.add(B,U,b),.5,T);var z=0;for(E=0;E<d;E++){e.clone(t[E],i);var q=e.magnitude(e.subtract(i,V,b));if(q>z){z=q}var G=e.magnitudeSquared(e.subtract(i,N,b));if(G>k){var H=Math.sqrt(G);F=(F+H)*.5;k=F*F;var j=H-F;N.x=(F*N.x+j*i.x)/H;N.y=(F*N.y+j*i.y)/H;N.z=(F*N.z+j*i.z)/H}}if(F<z){e.clone(N,r.center);r.radius=F}else{e.clone(V,r.center);r.radius=z}return r};var E=new o;var x=new e;var P=new e;var A=new t;var O=new t;f.fromRectangle2D=function(e,t,r){return f.fromRectangleWithHeights2D(e,t,0,0,r)};f.fromRectangleWithHeights2D=function(t,r,a,o,s){if(!n(s)){s=new f}if(!n(t)){s.center=e.clone(e.ZERO,s.center);s.radius=0;return s}r=i(r,E);d.southwest(t,A);A.height=a;d.northeast(t,O);O.height=o;var l=r.project(A,x);var u=r.project(O,P);var c=u.x-l.x;var h=u.y-l.y;var p=u.z-l.z;s.radius=Math.sqrt(c*c+h*h+p*p)*.5;var m=s.center;m.x=l.x+c*.5;m.y=l.y+h*.5;m.z=l.z+p*.5;return s};var D=[];f.fromRectangle3D=function(e,t,r,o){t=i(t,a.WGS84);r=i(r,0);var s;if(n(e)){s=d.subsample(e,t,r,D)}return f.fromPoints(s,o)};f.fromVertices=function(t,a,o,s){if(!n(s)){s=new f}if(!n(t)||t.length===0){s.center=e.clone(e.ZERO,s.center);s.radius=0;return s}a=i(a,e.ZERO);o=i(o,3);r.typeOf.number.greaterThanOrEquals("stride",o,3);var l=y;l.x=t[0]+a.x;l.y=t[1]+a.y;l.z=t[2]+a.z;var u=e.clone(l,h);var c=e.clone(l,p);var d=e.clone(l,m);var E=e.clone(l,v);var x=e.clone(l,g);var P=e.clone(l,_);var A=t.length;var O;for(O=0;O<A;O+=o){var D=t[O]+a.x;var I=t[O+1]+a.y;var M=t[O+2]+a.z;l.x=D;l.y=I;l.z=M;if(D<u.x){e.clone(l,u)}if(D>E.x){e.clone(l,E)}if(I<c.y){e.clone(l,c)}if(I>x.y){e.clone(l,x)}if(M<d.z){e.clone(l,d)}if(M>P.z){e.clone(l,P)}}var R=e.magnitudeSquared(e.subtract(E,u,b));var L=e.magnitudeSquared(e.subtract(x,c,b));var N=e.magnitudeSquared(e.subtract(P,d,b));var k=u;var F=E;var B=R;if(L>B){B=L;k=c;F=x}if(N>B){B=N;k=d;F=P}var U=w;U.x=(k.x+F.x)*.5;U.y=(k.y+F.y)*.5;U.z=(k.z+F.z)*.5;var V=e.magnitudeSquared(e.subtract(F,U,b));var z=Math.sqrt(V);var q=C;q.x=u.x;q.y=c.y;q.z=d.z;var G=S;G.x=E.x;G.y=x.y;G.z=P.z;var H=e.multiplyByScalar(e.add(q,G,b),.5,T);var j=0;for(O=0;O<A;O+=o){l.x=t[O]+a.x;l.y=t[O+1]+a.y;l.z=t[O+2]+a.z;var W=e.magnitude(e.subtract(l,H,b));if(W>j){j=W}var Y=e.magnitudeSquared(e.subtract(l,U,b));if(Y>V){var X=Math.sqrt(Y);z=(z+X)*.5;V=z*z;var Q=X-z;U.x=(z*U.x+Q*l.x)/X;U.y=(z*U.y+Q*l.y)/X;U.z=(z*U.z+Q*l.z)/X}}if(z<j){e.clone(U,s.center);s.radius=z}else{e.clone(H,s.center);s.radius=j}return s};f.fromEncodedCartesianVertices=function(t,r,i){if(!n(i)){i=new f}if(!n(t)||!n(r)||t.length!==r.length||t.length===0){i.center=e.clone(e.ZERO,i.center);i.radius=0;return i}var a=y;a.x=t[0]+r[0];a.y=t[1]+r[1];a.z=t[2]+r[2];var o=e.clone(a,h);var s=e.clone(a,p);var l=e.clone(a,m);var u=e.clone(a,v);var c=e.clone(a,g);var d=e.clone(a,_);var E=t.length;var x;for(x=0;x<E;x+=3){var P=t[x]+r[x];var A=t[x+1]+r[x+1];var O=t[x+2]+r[x+2];a.x=P;a.y=A;a.z=O;if(P<o.x){e.clone(a,o)}if(P>u.x){e.clone(a,u)}if(A<s.y){e.clone(a,s)}if(A>c.y){e.clone(a,c)}if(O<l.z){e.clone(a,l)}if(O>d.z){e.clone(a,d)}}var D=e.magnitudeSquared(e.subtract(u,o,b));var I=e.magnitudeSquared(e.subtract(c,s,b));var M=e.magnitudeSquared(e.subtract(d,l,b));var R=o;var L=u;var N=D;if(I>N){N=I;R=s;L=c}if(M>N){N=M;R=l;L=d}var k=w;k.x=(R.x+L.x)*.5;k.y=(R.y+L.y)*.5;k.z=(R.z+L.z)*.5;var F=e.magnitudeSquared(e.subtract(L,k,b));var B=Math.sqrt(F);var U=C;U.x=o.x;U.y=s.y;U.z=l.z;var V=S;V.x=u.x;V.y=c.y;V.z=d.z;var z=e.multiplyByScalar(e.add(U,V,b),.5,T);var q=0;for(x=0;x<E;x+=3){a.x=t[x]+r[x];a.y=t[x+1]+r[x+1];a.z=t[x+2]+r[x+2];var G=e.magnitude(e.subtract(a,z,b));if(G>q){q=G}var H=e.magnitudeSquared(e.subtract(a,k,b));if(H>F){var j=Math.sqrt(H);B=(B+j)*.5;F=B*B;var W=j-B;k.x=(B*k.x+W*a.x)/j;k.y=(B*k.y+W*a.y)/j;k.z=(B*k.z+W*a.z)/j}}if(B<q){e.clone(k,i.center);i.radius=B}else{e.clone(z,i.center);i.radius=q}return i};f.fromCornerPoints=function(t,i,a){r.typeOf.object("corner",t);r.typeOf.object("oppositeCorner",i);if(!n(a)){a=new f}var o=a.center;e.add(t,i,o);e.multiplyByScalar(o,.5,o);a.radius=e.distance(o,i);return a};f.fromEllipsoid=function(t,i){r.typeOf.object("ellipsoid",t);if(!n(i)){i=new f}e.clone(e.ZERO,i.center);i.radius=t.maximumRadius;return i};var I=new e;f.fromBoundingSpheres=function(t,r){if(!n(r)){r=new f}if(!n(t)||t.length===0){r.center=e.clone(e.ZERO,r.center);r.radius=0;return r}var i=t.length;if(i===1){return f.clone(t[0],r)}if(i===2){return f.union(t[0],t[1],r)}var a=[];var o;for(o=0;o<i;o++){a.push(t[o].center)}r=f.fromPoints(a,r);var s=r.center;var l=r.radius;for(o=0;o<i;o++){var u=t[o];l=Math.max(l,e.distance(s,u.center,I)+u.radius)}r.radius=l;return r};var M=new e;var R=new e;var L=new e;f.fromOrientedBoundingBox=function(t,i){r.defined("orientedBoundingBox",t);if(!n(i)){i=new f}var a=t.halfAxes;var o=u.getColumn(a,0,M);var s=u.getColumn(a,1,R);var l=u.getColumn(a,2,L);e.add(o,s,o);e.add(o,l,o);i.center=e.clone(t.center,i.center);i.radius=e.magnitude(o);return i};f.clone=function(t,r){if(!n(t)){return undefined}if(!n(r)){return new f(t.center,t.radius)}r.center=e.clone(t.center,r.center);r.radius=t.radius;return r};f.packedLength=4;f.pack=function(e,t,n){r.typeOf.object("value",e);r.defined("array",t);n=i(n,0);var a=e.center;t[n++]=a.x;t[n++]=a.y;t[n++]=a.z;t[n]=e.radius;return t};f.unpack=function(e,t,a){r.defined("array",e);t=i(t,0);if(!n(a)){a=new f}var o=a.center;o.x=e[t++];o.y=e[t++];o.z=e[t++];a.radius=e[t];return a};var N=new e;var k=new e;f.union=function(t,i,a){r.typeOf.object("left",t);r.typeOf.object("right",i);if(!n(a)){a=new f}var o=t.center;var s=t.radius;var l=i.center;var u=i.radius;var c=e.subtract(l,o,N);var d=e.magnitude(c);if(s>=d+u){t.clone(a);return a}if(u>=d+s){i.clone(a);return a}var h=(s+d+u)*.5;var p=e.multiplyByScalar(c,(-s+h)/d,k);e.add(p,o,p);e.clone(p,a.center);a.radius=h;return a};var F=new e;f.expand=function(t,i,n){r.typeOf.object("sphere",t);r.typeOf.object("point",i);n=f.clone(t,n);var a=e.magnitude(e.subtract(i,n.center,F));if(a>n.radius){n.radius=a}return n};f.intersectPlane=function(t,i){r.typeOf.object("sphere",t);r.typeOf.object("plane",i);var n=t.center;var a=t.radius;var o=i.normal;var l=e.dot(o,n)+i.distance;if(l<-a){return s.OUTSIDE}else if(l<a){return s.INTERSECTING}return s.INSIDE};f.transform=function(e,t,i){r.typeOf.object("sphere",e);r.typeOf.object("transform",t);if(!n(i)){i=new f}i.center=c.multiplyByPoint(t,e.center,i.center);i.radius=c.getMaximumScale(t)*e.radius;return i};var B=new e;f.distanceSquaredTo=function(t,i){r.typeOf.object("sphere",t);r.typeOf.object("cartesian",i);var n=e.subtract(t.center,i,B);return e.magnitudeSquared(n)-t.radius*t.radius};f.transformWithoutScale=function(e,t,i){r.typeOf.object("sphere",e);r.typeOf.object("transform",t);if(!n(i)){i=new f}i.center=c.multiplyByPoint(t,e.center,i.center);i.radius=e.radius;return i};var U=new e;f.computePlaneDistances=function(t,i,a,o){r.typeOf.object("sphere",t);r.typeOf.object("position",i);r.typeOf.object("direction",a);if(!n(o)){o=new l}var s=e.subtract(t.center,i,U);var u=e.dot(a,s);o.start=u-t.radius;o.stop=u+t.radius;return o};var V=new e;var z=new e;var q=new e;var G=new e;var H=new e;var j=new t;var W=new Array(8);for(var Y=0;Y<8;++Y){W[Y]=new e}var X=new o;f.projectTo2D=function(t,n,a){r.typeOf.object("sphere",t);n=i(n,X);var o=n.ellipsoid;var s=t.center;var l=t.radius;var u=o.geodeticSurfaceNormal(s,V);var c=e.cross(e.UNIT_Z,u,z);e.normalize(c,c);var d=e.cross(u,c,q);e.normalize(d,d);e.multiplyByScalar(u,l,u);e.multiplyByScalar(d,l,d);e.multiplyByScalar(c,l,c);var h=e.negate(d,H);var p=e.negate(c,G);var m=W;var v=m[0];e.add(u,d,v);e.add(v,c,v);v=m[1];e.add(u,d,v);e.add(v,p,v);v=m[2];e.add(u,h,v);e.add(v,p,v);v=m[3];e.add(u,h,v);e.add(v,c,v);e.negate(u,u);v=m[4];e.add(u,d,v);e.add(v,c,v);v=m[5];e.add(u,d,v);e.add(v,p,v);v=m[6];e.add(u,h,v);e.add(v,p,v);v=m[7];e.add(u,h,v);e.add(v,c,v);var g=m.length;for(var _=0;_<g;++_){var y=m[_];e.add(s,y,y);var b=o.cartesianToCartographic(y,j);n.project(b,y)}a=f.fromPoints(m,a);s=a.center;var w=s.x;var C=s.y;var S=s.z;s.x=S;s.y=w;s.z=C;return a};f.isOccluded=function(e,t){r.typeOf.object("sphere",e);r.typeOf.object("occluder",t);return!t.isBoundingSphereVisible(e)};f.equals=function(t,r){return t===r||n(t)&&n(r)&&e.equals(t.center,r.center)&&t.radius===r.radius};f.prototype.intersectPlane=function(e){return f.intersectPlane(this,e)};f.prototype.distanceSquaredTo=function(e){return f.distanceSquaredTo(this,e)};f.prototype.computePlaneDistances=function(e,t,r){return f.computePlaneDistances(this,e,t,r)};f.prototype.isOccluded=function(e){return f.isOccluded(this,e)};f.prototype.equals=function(e){return f.equals(this,e)};f.prototype.clone=function(e){return f.clone(this,e)};return f});define("Core/Fullscreen",["./defined","./defineProperties"],function(e,t){"use strict";var r;var i={requestFullscreen:undefined,exitFullscreen:undefined,fullscreenEnabled:undefined,fullscreenElement:undefined,fullscreenchange:undefined,fullscreenerror:undefined};var n={};t(n,{element:{get:function(){if(!n.supportsFullscreen()){return undefined}return document[i.fullscreenElement]}},changeEventName:{get:function(){if(!n.supportsFullscreen()){return undefined}return i.fullscreenchange}},errorEventName:{get:function(){if(!n.supportsFullscreen()){return undefined}return i.fullscreenerror}},enabled:{get:function(){if(!n.supportsFullscreen()){return undefined}return document[i.fullscreenEnabled]}},fullscreen:{get:function(){if(!n.supportsFullscreen()){return undefined}return n.element!==null}}});n.supportsFullscreen=function(){if(e(r)){return r}r=false;var t=document.body;if(typeof t.requestFullscreen==="function"){i.requestFullscreen="requestFullscreen";i.exitFullscreen="exitFullscreen";i.fullscreenEnabled="fullscreenEnabled";i.fullscreenElement="fullscreenElement";i.fullscreenchange="fullscreenchange";i.fullscreenerror="fullscreenerror";r=true;return r}var n=["webkit","moz","o","ms","khtml"];var a;for(var o=0,s=n.length;o<s;++o){var l=n[o];a=l+"RequestFullscreen";if(typeof t[a]==="function"){i.requestFullscreen=a;r=true}else{a=l+"RequestFullScreen";if(typeof t[a]==="function"){i.requestFullscreen=a;r=true}}a=l+"ExitFullscreen";if(typeof document[a]==="function"){i.exitFullscreen=a}else{a=l+"CancelFullScreen";if(typeof document[a]==="function"){i.exitFullscreen=a}}a=l+"FullscreenEnabled";if(document[a]!==undefined){i.fullscreenEnabled=a}else{a=l+"FullScreenEnabled";if(document[a]!==undefined){i.fullscreenEnabled=a}}a=l+"FullscreenElement";if(document[a]!==undefined){i.fullscreenElement=a}else{a=l+"FullScreenElement";if(document[a]!==undefined){i.fullscreenElement=a}}a=l+"fullscreenchange";if(document["on"+a]!==undefined){if(l==="ms"){a="MSFullscreenChange"}i.fullscreenchange=a}a=l+"fullscreenerror";if(document["on"+a]!==undefined){if(l==="ms"){a="MSFullscreenError"}i.fullscreenerror=a}}return r};n.requestFullscreen=function(e,t){if(!n.supportsFullscreen()){return}e[i.requestFullscreen]({vrDisplay:t})};n.exitFullscreen=function(){if(!n.supportsFullscreen()){return}document[i.exitFullscreen]()};return n});define("Core/FeatureDetection",["./defaultValue","./defined","./Fullscreen"],function(e,t,r){"use strict";var i;if(typeof navigator!=="undefined"){i=navigator}else{i={}}function n(e){var t=e.split(".");for(var r=0,i=t.length;r<i;++r){t[r]=parseInt(t[r],10)}return t}var a;var o;function s(){if(!t(a)){a=false;if(!S()){var e=/ Chrome\/([\.0-9]+)/.exec(i.userAgent);if(e!==null){a=true;o=n(e[1])}}}return a}function l(){return s()&&o}var u;var c;function d(){if(!t(u)){u=false;if(!s()&&!S()&&/ Safari\/[\.0-9]+/.test(i.userAgent)){var e=/ Version\/([\.0-9]+)/.exec(i.userAgent);if(e!==null){u=true;c=n(e[1])}}}return u}function f(){return d()&&c}var h;var p;function m(){if(!t(h)){h=false;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(i.userAgent);if(e!==null){h=true;p=n(e[1]);p.isNightly=!!e[2]}}return h}function v(){return m()&&p}var g;var _;function y(){if(!t(g)){g=false;var e;if(i.appName==="Microsoft Internet Explorer"){e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(i.userAgent);if(e!==null){g=true;_=n(e[1])}}else if(i.appName==="Netscape"){e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(i.userAgent);if(e!==null){g=true;_=n(e[1])}}}return g}function b(){return y()&&_}var w;var C;function S(){if(!t(w)){w=false;var e=/ Edge\/([\.0-9]+)/.exec(i.userAgent);if(e!==null){w=true;C=n(e[1])}}return w}function T(){return S()&&C}var E;var x;function P(){if(!t(E)){E=false;var e=/Firefox\/([\.0-9]+)/.exec(i.userAgent);if(e!==null){E=true;x=n(e[1])}}return E}var A;function O(){if(!t(A)){A=/Windows/i.test(i.appVersion)}return A}function D(){return P()&&x}var I;function M(){if(!t(I)){I=typeof PointerEvent!=="undefined"&&(!t(i.pointerEnabled)||i.pointerEnabled)}return I}var R;var L;function N(){if(!t(L)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;"+"image-rendering: pixelated;");var r=e.style.imageRendering;L=t(r)&&r!=="";if(L){R=r}}return L}function k(){return N()?R:undefined}var F={isChrome:s,chromeVersion:l,isSafari:d,safariVersion:f,isWebkit:m,webkitVersion:v,isInternetExplorer:y,internetExplorerVersion:b,isEdge:S,edgeVersion:T,isFirefox:P,firefoxVersion:D,isWindows:O,hardwareConcurrency:e(i.hardwareConcurrency,3),supportsPointerEvents:M,supportsImageRenderingPixelated:N,imageRenderingValue:k};F.supportsFullscreen=function(){return r.supportsFullscreen()};F.supportsTypedArrays=function(){return typeof ArrayBuffer!=="undefined"};F.supportsWebWorkers=function(){return typeof Worker!=="undefined"};return F});define("Core/WebGLConstants",["./freezeObject"],function(e){"use strict";var t={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047};return e(t)});define("Core/ComponentDatatype",["./defaultValue","./defined","./DeveloperError","./FeatureDetection","./freezeObject","./WebGLConstants"],function(e,t,r,i,n,a){"use strict";if(!i.supportsTypedArrays()){return{}}var o={BYTE:a.BYTE,UNSIGNED_BYTE:a.UNSIGNED_BYTE,SHORT:a.SHORT,UNSIGNED_SHORT:a.UNSIGNED_SHORT,INT:a.INT,UNSIGNED_INT:a.UNSIGNED_INT,FLOAT:a.FLOAT,DOUBLE:a.DOUBLE};o.getSizeInBytes=function(e){if(!t(e)){throw new r("value is required.")}switch(e){case o.BYTE:return Int8Array.BYTES_PER_ELEMENT;case o.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case o.SHORT:return Int16Array.BYTES_PER_ELEMENT;case o.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case o.INT:return Int32Array.BYTES_PER_ELEMENT;case o.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case o.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case o.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new r("componentDatatype is not a valid value.")}};o.fromTypedArray=function(e){if(e instanceof Int8Array){return o.BYTE}if(e instanceof Uint8Array){return o.UNSIGNED_BYTE}if(e instanceof Int16Array){return o.SHORT}if(e instanceof Uint16Array){return o.UNSIGNED_SHORT}if(e instanceof Int32Array){return o.INT}if(e instanceof Uint32Array){return o.UNSIGNED_INT}if(e instanceof Float32Array){return o.FLOAT}if(e instanceof Float64Array){return o.DOUBLE}};o.validate=function(e){return t(e)&&(e===o.BYTE||e===o.UNSIGNED_BYTE||e===o.SHORT||e===o.UNSIGNED_SHORT||e===o.INT||e===o.UNSIGNED_INT||e===o.FLOAT||e===o.DOUBLE)};o.createTypedArray=function(e,i){if(!t(e)){throw new r("componentDatatype is required.")}if(!t(i)){throw new r("valuesOrLength is required.")}switch(e){case o.BYTE:return new Int8Array(i);case o.UNSIGNED_BYTE:return new Uint8Array(i);case o.SHORT:return new Int16Array(i);case o.UNSIGNED_SHORT:return new Uint16Array(i);case o.INT:return new Int32Array(i);case o.UNSIGNED_INT:return new Uint32Array(i);case o.FLOAT:return new Float32Array(i);case o.DOUBLE:return new Float64Array(i);default:throw new r("componentDatatype is not a valid value.")}};o.createArrayBufferView=function(i,n,a,s){if(!t(i)){throw new r("componentDatatype is required.")}if(!t(n)){throw new r("buffer is required.")}a=e(a,0);s=e(s,(n.byteLength-a)/o.getSizeInBytes(i));switch(i){case o.BYTE:return new Int8Array(n,a,s);case o.UNSIGNED_BYTE:return new Uint8Array(n,a,s);case o.SHORT:return new Int16Array(n,a,s);case o.UNSIGNED_SHORT:return new Uint16Array(n,a,s);case o.INT:return new Int32Array(n,a,s);case o.UNSIGNED_INT:return new Uint32Array(n,a,s);case o.FLOAT:return new Float32Array(n,a,s);case o.DOUBLE:return new Float64Array(n,a,s);default:throw new r("componentDatatype is not a valid value.")}};o.fromName=function(e){switch(e){case"BYTE":return o.BYTE;case"UNSIGNED_BYTE":return o.UNSIGNED_BYTE;case"SHORT":return o.SHORT;case"UNSIGNED_SHORT":return o.UNSIGNED_SHORT;case"INT":return o.INT;case"UNSIGNED_INT":return o.UNSIGNED_INT;case"FLOAT":return o.FLOAT;case"DOUBLE":return o.DOUBLE;default:throw new r("name is not a valid value.")}};return n(o)});define("Core/GeometryType",["./freezeObject"],function(e){"use strict";var t={NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3};return e(t)});define("Core/PrimitiveType",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var r={POINTS:t.POINTS,LINES:t.LINES,LINE_LOOP:t.LINE_LOOP,LINE_STRIP:t.LINE_STRIP,TRIANGLES:t.TRIANGLES,TRIANGLE_STRIP:t.TRIANGLE_STRIP,TRIANGLE_FAN:t.TRIANGLE_FAN,validate:function(e){return e===r.POINTS||e===r.LINES||e===r.LINE_LOOP||e===r.LINE_STRIP||e===r.TRIANGLES||e===r.TRIANGLE_STRIP||e===r.TRIANGLE_FAN}};return e(r)});define("Core/Geometry",["./Check","./defaultValue","./defined","./DeveloperError","./GeometryType","./PrimitiveType"],function(e,t,r,i,n,a){"use strict";function o(r){r=t(r,t.EMPTY_OBJECT);e.typeOf.object("options.attributes",r.attributes);this.attributes=r.attributes;this.indices=r.indices;this.primitiveType=t(r.primitiveType,a.TRIANGLES);this.boundingSphere=r.boundingSphere;this.geometryType=t(r.geometryType,n.NONE);this.boundingSphereCV=r.boundingSphereCV}o.computeNumberOfVertices=function(t){e.typeOf.object("geometry",t);var n=-1;for(var a in t.attributes){if(t.attributes.hasOwnProperty(a)&&r(t.attributes[a])&&r(t.attributes[a].values)){var o=t.attributes[a];var s=o.values.length/o.componentsPerAttribute;if(n!==s&&n!==-1){throw new i("All attribute lists must have the same number of attributes.")}n=s}}return n};return o});define("Core/GeometryAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i){i=e(i,e.EMPTY_OBJECT);if(!t(i.componentDatatype)){throw new r("options.componentDatatype is required.")}if(!t(i.componentsPerAttribute)){throw new r("options.componentsPerAttribute is required.")}if(i.componentsPerAttribute<1||i.componentsPerAttribute>4){throw new r("options.componentsPerAttribute must be between 1 and 4.")}if(!t(i.values)){throw new r("options.values is required.")}this.componentDatatype=i.componentDatatype;this.componentsPerAttribute=i.componentsPerAttribute;this.normalize=e(i.normalize,false);this.values=i.values}return i});define("Core/GeometryAttributes",["./defaultValue"],function(e){"use strict";function t(t){t=e(t,e.EMPTY_OBJECT);this.position=t.position;this.normal=t.normal;this.st=t.st;this.bitangent=t.bitangent;this.tangent=t.tangent;this.color=t.color}return t});define("Core/VertexFormat",["./defaultValue","./defined","./DeveloperError","./freezeObject"],function(e,t,r,i){"use strict";function n(t){t=e(t,e.EMPTY_OBJECT);this.position=e(t.position,false);this.normal=e(t.normal,false);this.st=e(t.st,false);this.bitangent=e(t.bitangent,false);this.tangent=e(t.tangent,false);this.color=e(t.color,false)}n.POSITION_ONLY=i(new n({position:true}));n.POSITION_AND_NORMAL=i(new n({position:true,normal:true}));n.POSITION_NORMAL_AND_ST=i(new n({position:true,normal:true,st:true}));n.POSITION_AND_ST=i(new n({position:true,st:true}));n.POSITION_AND_COLOR=i(new n({position:true,color:true}));n.ALL=i(new n({position:true,normal:true,st:true,tangent:true,bitangent:true}));n.DEFAULT=n.POSITION_NORMAL_AND_ST;n.packedLength=6;n.pack=function(i,n,a){if(!t(i)){throw new r("value is required")}if(!t(n)){throw new r("array is required")}a=e(a,0);n[a++]=i.position?1:0;n[a++]=i.normal?1:0;n[a++]=i.st?1:0;n[a++]=i.tangent?1:0;n[a++]=i.bitangent?1:0;n[a]=i.color?1:0;return n};n.unpack=function(i,a,o){if(!t(i)){throw new r("array is required")}a=e(a,0);if(!t(o)){o=new n}o.position=i[a++]===1;o.normal=i[a++]===1;o.st=i[a++]===1;o.tangent=i[a++]===1;o.bitangent=i[a++]===1;o.color=i[a]===1;return o};n.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){r=new n}r.position=e.position;r.normal=e.normal;r.st=e.st;r.tangent=e.tangent;r.bitangent=e.bitangent;r.color=e.color;return r};return n});define("Core/BoxGeometry",["./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType","./VertexFormat"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";var d=new t;function f(e){e=n(e,n.EMPTY_OBJECT);var i=e.minimum;var a=e.maximum;r.typeOf.object("min",i);r.typeOf.object("max",a);var o=n(e.vertexFormat,c.DEFAULT);this._minimum=t.clone(i);this._maximum=t.clone(a);this._vertexFormat=o;this._workerName="createBoxGeometry"}f.fromDimensions=function(e){e=n(e,n.EMPTY_OBJECT);var i=e.dimensions;r.typeOf.object("dimensions",i);r.typeOf.number.greaterThanOrEquals("dimensions.x",i.x,0);r.typeOf.number.greaterThanOrEquals("dimensions.y",i.y,0);r.typeOf.number.greaterThanOrEquals("dimensions.z",i.z,0);var a=t.multiplyByScalar(i,.5,new t);return new f({minimum:t.negate(a,new t),maximum:a,vertexFormat:e.vertexFormat})};f.fromAxisAlignedBoundingBox=function(e){r.typeOf.object("boundingBox",e);return new f({minimum:e.minimum,maximum:e.maximum})};f.packedLength=2*t.packedLength+c.packedLength;f.pack=function(e,i,a){r.typeOf.object("value",e);r.defined("array",i);a=n(a,0);t.pack(e._minimum,i,a);t.pack(e._maximum,i,a+t.packedLength);c.pack(e._vertexFormat,i,a+2*t.packedLength);return i};var h=new t;var p=new t;var m=new c;var v={minimum:h,maximum:p,vertexFormat:m};f.unpack=function(e,i,o){r.defined("array",e);i=n(i,0);var s=t.unpack(e,i,h);var l=t.unpack(e,i+t.packedLength,p);var u=c.unpack(e,i+2*t.packedLength,m);if(!a(o)){return new f(v)}o._minimum=t.clone(s,o._minimum);o._maximum=t.clone(l,o._maximum);o._vertexFormat=c.clone(u,o._vertexFormat);return o};f.createGeometry=function(r){var n=r._minimum;var a=r._maximum;var c=r._vertexFormat;if(t.equals(n,a)){return}var f=new l;var h;var p;if(c.position&&(c.st||c.normal||c.tangent||c.bitangent)){if(c.position){p=new Float64Array(6*4*3);p[0]=n.x;p[1]=n.y;p[2]=a.z;p[3]=a.x;p[4]=n.y;p[5]=a.z;p[6]=a.x;p[7]=a.y;p[8]=a.z;p[9]=n.x;p[10]=a.y;p[11]=a.z;p[12]=n.x;p[13]=n.y;p[14]=n.z;p[15]=a.x;p[16]=n.y;p[17]=n.z;p[18]=a.x;p[19]=a.y;p[20]=n.z;p[21]=n.x;p[22]=a.y;p[23]=n.z;p[24]=a.x;p[25]=n.y;p[26]=n.z;p[27]=a.x;p[28]=a.y;p[29]=n.z;p[30]=a.x;p[31]=a.y;p[32]=a.z;p[33]=a.x;p[34]=n.y;p[35]=a.z;p[36]=n.x;p[37]=n.y;p[38]=n.z;p[39]=n.x;p[40]=a.y;p[41]=n.z;p[42]=n.x;p[43]=a.y;p[44]=a.z;p[45]=n.x;p[46]=n.y;p[47]=a.z;p[48]=n.x;p[49]=a.y;p[50]=n.z;p[51]=a.x;p[52]=a.y;p[53]=n.z;p[54]=a.x;p[55]=a.y;p[56]=a.z;p[57]=n.x;p[58]=a.y;p[59]=a.z;p[60]=n.x;p[61]=n.y;p[62]=n.z;p[63]=a.x;p[64]=n.y;p[65]=n.z;p[66]=a.x;p[67]=n.y;p[68]=a.z;p[69]=n.x;p[70]=n.y;p[71]=a.z;f.position=new s({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:p})}if(c.normal){var m=new Float32Array(6*4*3);m[0]=0;m[1]=0;m[2]=1;m[3]=0;m[4]=0;m[5]=1;m[6]=0;m[7]=0;m[8]=1;m[9]=0;m[10]=0;m[11]=1;m[12]=0;m[13]=0;m[14]=-1;m[15]=0;m[16]=0;m[17]=-1;m[18]=0;m[19]=0;m[20]=-1;m[21]=0;m[22]=0;m[23]=-1;m[24]=1;m[25]=0;m[26]=0;m[27]=1;m[28]=0;m[29]=0;m[30]=1;m[31]=0;m[32]=0;m[33]=1;m[34]=0;m[35]=0;m[36]=-1;m[37]=0;m[38]=0;m[39]=-1;m[40]=0;m[41]=0;m[42]=-1;m[43]=0;m[44]=0;m[45]=-1;m[46]=0;m[47]=0;m[48]=0;m[49]=1;m[50]=0;m[51]=0;m[52]=1;m[53]=0;m[54]=0;m[55]=1;m[56]=0;m[57]=0;m[58]=1;m[59]=0;m[60]=0;m[61]=-1;m[62]=0;m[63]=0;m[64]=-1;m[65]=0;m[66]=0;m[67]=-1;m[68]=0;m[69]=0;m[70]=-1;m[71]=0;f.normal=new s({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:m})}if(c.st){var v=new Float32Array(6*4*2);v[0]=0;v[1]=0;v[2]=1;v[3]=0;v[4]=1;v[5]=1;v[6]=0;v[7]=1;v[8]=1;v[9]=0;v[10]=0;v[11]=0;v[12]=0;v[13]=1;v[14]=1;v[15]=1;v[16]=0;v[17]=0;v[18]=1;v[19]=0;v[20]=1;v[21]=1;v[22]=0;v[23]=1;v[24]=1;v[25]=0;v[26]=0;v[27]=0;v[28]=0;v[29]=1;v[30]=1;v[31]=1;v[32]=1;v[33]=0;v[34]=0;v[35]=0;v[36]=0;v[37]=1;v[38]=1;v[39]=1;v[40]=0;v[41]=0;v[42]=1;v[43]=0;v[44]=1;v[45]=1;v[46]=0;v[47]=1;f.st=new s({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:v})}if(c.tangent){var g=new Float32Array(6*4*3);g[0]=1;g[1]=0;g[2]=0;g[3]=1;g[4]=0;g[5]=0;g[6]=1;g[7]=0;g[8]=0;g[9]=1;g[10]=0;g[11]=0;g[12]=-1;g[13]=0;g[14]=0;g[15]=-1;g[16]=0;g[17]=0;g[18]=-1;g[19]=0;g[20]=0;g[21]=-1;g[22]=0;g[23]=0;g[24]=0;g[25]=1;g[26]=0;g[27]=0;g[28]=1;g[29]=0;g[30]=0;g[31]=1;g[32]=0;g[33]=0;g[34]=1;g[35]=0;g[36]=0;g[37]=-1;g[38]=0;g[39]=0;g[40]=-1;g[41]=0;g[42]=0;g[43]=-1;g[44]=0;g[45]=0;g[46]=-1;g[47]=0;g[48]=-1;g[49]=0;g[50]=0;g[51]=-1;g[52]=0;g[53]=0;g[54]=-1;g[55]=0;g[56]=0;g[57]=-1;g[58]=0;g[59]=0;g[60]=1;g[61]=0;g[62]=0;g[63]=1;g[64]=0;g[65]=0;g[66]=1;g[67]=0;g[68]=0;g[69]=1;g[70]=0;g[71]=0;f.tangent=new s({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:g})}if(c.bitangent){var _=new Float32Array(6*4*3);_[0]=0;_[1]=1;_[2]=0;_[3]=0;_[4]=1;_[5]=0;_[6]=0;_[7]=1;_[8]=0;_[9]=0;_[10]=1;_[11]=0;_[12]=0;_[13]=1;_[14]=0;_[15]=0;_[16]=1;_[17]=0;_[18]=0;_[19]=1;_[20]=0;_[21]=0;_[22]=1;_[23]=0;_[24]=0;_[25]=0;_[26]=1;_[27]=0;_[28]=0;_[29]=1;_[30]=0;_[31]=0;_[32]=1;_[33]=0;_[34]=0;_[35]=1;_[36]=0;_[37]=0;_[38]=1;_[39]=0;_[40]=0;_[41]=1;_[42]=0;_[43]=0;_[44]=1;_[45]=0;_[46]=0;_[47]=1;_[48]=0;_[49]=0;_[50]=1;_[51]=0;_[52]=0;_[53]=1;_[54]=0;_[55]=0;_[56]=1;_[57]=0;_[58]=0;_[59]=1;_[60]=0;_[61]=0;_[62]=1;_[63]=0;_[64]=0;_[65]=1;_[66]=0;_[67]=0;_[68]=1;_[69]=0;_[70]=0;_[71]=1;f.bitangent=new s({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:_})}h=new Uint16Array(6*2*3);h[0]=0;h[1]=1;h[2]=2;h[3]=0;h[4]=2;h[5]=3;h[6]=4+2;h[7]=4+1;h[8]=4+0;h[9]=4+3;h[10]=4+2;h[11]=4+0;h[12]=8+0;h[13]=8+1;h[14]=8+2;h[15]=8+0;h[16]=8+2;h[17]=8+3;h[18]=12+2;h[19]=12+1;h[20]=12+0;h[21]=12+3;h[22]=12+2;h[23]=12+0;h[24]=16+2;h[25]=16+1;h[26]=16+0;h[27]=16+3;h[28]=16+2;h[29]=16+0;h[30]=20+0;h[31]=20+1;h[32]=20+2;h[33]=20+0;h[34]=20+2;h[35]=20+3}else{p=new Float64Array(8*3);p[0]=n.x;p[1]=n.y;p[2]=n.z;p[3]=a.x;p[4]=n.y;p[5]=n.z;p[6]=a.x;p[7]=a.y;p[8]=n.z;p[9]=n.x;p[10]=a.y;p[11]=n.z;p[12]=n.x;p[13]=n.y;p[14]=a.z;p[15]=a.x;p[16]=n.y;p[17]=a.z;p[18]=a.x;p[19]=a.y;p[20]=a.z;p[21]=n.x;p[22]=a.y;p[23]=a.z;f.position=new s({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:p});h=new Uint16Array(6*2*3);h[0]=4;h[1]=5;h[2]=6;h[3]=4;h[4]=6;h[5]=7;h[6]=1;h[7]=0;h[8]=3;h[9]=1;h[10]=3;h[11]=2;h[12]=1;h[13]=6;h[14]=5;h[15]=1;h[16]=2;h[17]=6;h[18]=2;h[19]=3;h[20]=7;h[21]=2;h[22]=7;h[23]=6;h[24]=3;h[25]=0;h[26]=4;h[27]=3;h[28]=4;h[29]=7;h[30]=0;h[31]=1;h[32]=5;h[33]=0;h[34]=5;h[35]=4}var y=t.subtract(a,n,d);var b=t.magnitude(y)*.5;return new o({attributes:f,indices:h,primitiveType:u.TRIANGLES,boundingSphere:new e(t.ZERO,b)})};return f});define("Core/BoxOutlineGeometry",["./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType"],function(e,t,r,i,n,a,o,s,l,u){"use strict";var c=new t;function d(e){e=n(e,n.EMPTY_OBJECT);var i=e.minimum;var a=e.maximum;r.typeOf.object("min",i);r.typeOf.object("max",a);this._min=t.clone(i);this._max=t.clone(a);this._workerName="createBoxOutlineGeometry"}d.fromDimensions=function(e){e=n(e,n.EMPTY_OBJECT);var i=e.dimensions;r.typeOf.object("dimensions",i);r.typeOf.number.greaterThanOrEquals("dimensions.x",i.x,0);r.typeOf.number.greaterThanOrEquals("dimensions.y",i.y,0);r.typeOf.number.greaterThanOrEquals("dimensions.z",i.z,0);var a=t.multiplyByScalar(i,.5,new t);return new d({minimum:t.negate(a,new t),maximum:a})};d.fromAxisAlignedBoundingBox=function(e){r.typeOf.object("boundindBox",e);return new d({minimum:e.minimum,maximum:e.maximum})};d.packedLength=2*t.packedLength;d.pack=function(e,i,a){r.typeOf.object("value",e);r.defined("array",i);a=n(a,0);t.pack(e._min,i,a);t.pack(e._max,i,a+t.packedLength);return i};var f=new t;var h=new t;var p={minimum:f,maximum:h};d.unpack=function(e,i,o){r.defined("array",e);i=n(i,0);var s=t.unpack(e,i,f);var l=t.unpack(e,i+t.packedLength,h);if(!a(o)){return new d(p)}o._min=t.clone(s,o._min);o._max=t.clone(l,o._max);return o};d.createGeometry=function(r){var n=r._min;var a=r._max;if(t.equals(n,a)){return}var d=new l;var f=new Uint16Array(12*2);var h=new Float64Array(8*3);h[0]=n.x;h[1]=n.y;h[2]=n.z;h[3]=a.x;h[4]=n.y;h[5]=n.z;h[6]=a.x;h[7]=a.y;h[8]=n.z;h[9]=n.x;h[10]=a.y;h[11]=n.z;h[12]=n.x;h[13]=n.y;h[14]=a.z;h[15]=a.x;h[16]=n.y;h[17]=a.z;h[18]=a.x;h[19]=a.y;h[20]=a.z;h[21]=n.x;h[22]=a.y;h[23]=a.z;d.position=new s({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:h});f[0]=4;f[1]=5;f[2]=5;f[3]=6;f[4]=6;f[5]=7;f[6]=7;f[7]=4;f[8]=0;f[9]=1;f[10]=1;f[11]=2;f[12]=2;f[13]=3;f[14]=3;f[15]=0;f[16]=0;f[17]=4;f[18]=1;f[19]=5;f[20]=2;f[21]=6;f[22]=3;f[23]=7;var p=t.subtract(a,n,c);var m=t.magnitude(p)*.5;return new o({attributes:d,indices:f,primitiveType:u.LINES,boundingSphere:new e(t.ZERO,m)})};return d});define("Core/getAbsoluteUri",["../ThirdParty/Uri","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i){"use strict";function n(n,a){if(!r(n)){throw new i("relative uri is required.")}a=t(a,document.location.href);var o=new e(a);var s=new e(n);return s.resolve(o).toString()}return n});define("Core/joinUrls",["../ThirdParty/Uri","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i){"use strict";function n(n,a,o){if(!r(n)){throw new i("first is required")}if(!r(a)){throw new i("second is required")}o=t(o,true);if(!(n instanceof e)){n=new e(n)}if(!(a instanceof e)){a=new e(a)}if(n.scheme==="data"){return n.toString()}if(a.scheme==="data"){return a.toString()}if(r(a.authority)&&!r(a.scheme)){if(typeof document!=="undefined"&&r(document.location)&&r(document.location.href)){a.scheme=new e(document.location.href).scheme}else{a.scheme=n.scheme}}var s=n;if(a.isAbsolute()){s=a}var l="";if(r(s.scheme)){l+=s.scheme+":"}if(r(s.authority)){l+="//"+s.authority;if(s.path!==""&&s.path!=="/"){l=l.replace(/\/?$/,"/");s.path=s.path.replace(/^\/?/g,"")}}if(s===n){if(o){l+=n.path.replace(/\/?$/,"/")+a.path.replace(/^\/?/g,"")}else{l+=n.path+a.path}}else{l+=a.path}var u=r(n.query);var c=r(a.query);if(u&&c){l+="?"+n.query+"&"+a.query}else if(u&&!c){l+="?"+n.query}else if(!u&&c){l+="?"+a.query}var d=r(a.fragment);if(r(n.fragment)&&!d){l+="#"+n.fragment}else if(d){l+="#"+a.fragment}return l}return n});define("Core/buildModuleUrl",["../ThirdParty/Uri","./defined","./DeveloperError","./getAbsoluteUri","./joinUrls","require"],function(e,t,r,i,n,a){"use strict";var o=/((?:.*\/)|^)cesium[\w-]*\.js(?:\W|$)/i;function s(){var e=document.getElementsByTagName("script");for(var t=0,r=e.length;t<r;++t){var i=e[t].getAttribute("src");var n=o.exec(i);if(n!==null){return n[1]}}return undefined}var l;function u(){if(t(l)){return l}var n;if(typeof CESIUM_BASE_URL!=="undefined"){n=CESIUM_BASE_URL}else{n=s()}if(!t(n)){throw new r("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.")}l=new e(i(n));return l}function c(e){return a.toUrl("../"+e)}function d(e){return n(u(),e)}var f;var h;function p(e){if(!t(f)){if(t(a.toUrl)){f=c}else{f=d}}if(!t(h)){h=document.createElement("a")}var r=f(e);h.href=r;h.href=h.href;return h.href}p._cesiumScriptRegex=o;p.setBaseUrl=function(t){l=new e(t).resolve(new e(document.location.href))};return p});define("Core/cancelAnimationFrame",["./defined"],function(e){"use strict";if(typeof window==="undefined"){return}var t=window.cancelAnimationFrame;(function(){if(!e(t)){var r=["webkit","moz","ms","o"];var i=0;var n=r.length;while(i<n&&!e(t)){t=window[r[i]+"CancelAnimationFrame"];if(!e(t)){t=window[r[i]+"CancelRequestAnimationFrame"]}++i}}if(!e(t)){t=clearTimeout}})();function r(e){t(e)}return r});define("Core/CartographicGeocoderService",["../ThirdParty/when","./Cartesian3","./Check","./defaultValue","./defined","./defineProperties"],function(e,t,r,i,n,a){"use strict";function o(){}o.prototype.geocode=function(i){r.typeOf.string("query",i);var n=i.match(/[^\s,\n]+/g);if(n.length===2||n.length===3){var a=+n[0];var o=+n[1];var s=n.length===3?+n[2]:300;if(isNaN(a)&&isNaN(o)){var l=/^(\d+.?\d*)([nsew])/i;for(var u=0;u<n.length;++u){var c=n[u].match(l);if(l.test(n[u])&&c.length===3){if(/^[ns]/i.test(c[2])){o=/^[n]/i.test(c[2])?+c[1]:-c[1]}else if(/^[ew]/i.test(c[2])){a=/^[e]/i.test(c[2])?+c[1]:-c[1]}}}}if(!isNaN(a)&&!isNaN(o)&&!isNaN(s)){var d={displayName:i,destination:t.fromDegrees(a,o,s)};return e.resolve([d])}}return e.resolve([])};return o});define("Core/Spline",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(){this.times=undefined;this.points=undefined;r.throwInstantiationError()}i.prototype.evaluate=r.throwInstantiationError;i.prototype.findTimeInterval=function(i,n){var a=this.times;var o=a.length;if(!t(i)){throw new r("time is required.")}if(i<a[0]||i>a[o-1]){throw new r("time is out of range.")}n=e(n,0);if(i>=a[n]){if(n+1<o&&i<a[n+1]){return n}else if(n+2<o&&i<a[n+2]){return n+1}}else if(n-1>=0&&i>=a[n-1]){return n-1}var s;if(i>a[n]){for(s=n;s<o-1;++s){if(i>=a[s]&&i<a[s+1]){break}}}else{for(s=n-1;s>=0;--s){if(i>=a[s]&&i<a[s+1]){break}}}if(s===o-1){s=o-2}return s};return i});define("Core/LinearSpline",["./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Spline"],function(e,t,r,i,n,a){"use strict";function o(e){e=t(e,t.EMPTY_OBJECT);var i=e.points;var a=e.times;if(!r(i)||!r(a)){throw new n("points and times are required.")}if(i.length<2){throw new n("points.length must be greater than or equal to 2.")}if(a.length!==i.length){throw new n("times.length must be equal to points.length.")}this._times=a;this._points=i;this._lastTimeIndex=0}i(o.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});o.prototype.findTimeInterval=a.prototype.findTimeInterval;o.prototype.evaluate=function(t,i){var n=this.points;var a=this.times;var o=this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex);var s=(t-a[o])/(a[o+1]-a[o]);if(!r(i)){i=new e}return e.lerp(n[o],n[o+1],s,i)};return o});define("Core/TridiagonalSystemSolver",["./Cartesian3","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};i.solve=function(i,n,a,o){if(!t(i)||!(i instanceof Array)){throw new r("The array lower is required.")}if(!t(n)||!(n instanceof Array)){throw new r("The array diagonal is required.")}if(!t(a)||!(a instanceof Array)){throw new r("The array upper is required.")}if(!t(o)||!(o instanceof Array)){throw new r("The array right is required.")}if(n.length!==o.length){throw new r("diagonal and right must have the same lengths.")}if(i.length!==a.length){throw new r("lower and upper must have the same lengths.")}else if(i.length!==n.length-1){throw new r("lower and upper must be one less than the length of diagonal.")}var s=new Array(a.length);var l=new Array(o.length);var u=new Array(o.length);var c;for(c=0;c<l.length;c++){l[c]=new e;u[c]=new e}s[0]=a[0]/n[0];l[0]=e.multiplyByScalar(o[0],1/n[0],l[0]);var d;for(c=1;c<s.length;++c){d=1/(n[c]-s[c-1]*i[c-1]);s[c]=a[c]*d;l[c]=e.subtract(o[c],e.multiplyByScalar(l[c-1],i[c-1],l[c]),l[c]);l[c]=e.multiplyByScalar(l[c],d,l[c])}d=1/(n[c]-s[c-1]*i[c-1]);l[c]=e.subtract(o[c],e.multiplyByScalar(l[c-1],i[c-1],l[c]),l[c]);l[c]=e.multiplyByScalar(l[c],d,l[c]);u[u.length-1]=l[l.length-1];for(c=u.length-2;c>=0;--c){u[c]=e.subtract(l[c],e.multiplyByScalar(u[c+1],s[c],u[c]),u[c])}return u};return i});define("Core/HermiteSpline",["./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./LinearSpline","./Matrix4","./Spline","./TridiagonalSystemSolver"],function(e,t,r,i,n,a,o,s,l,u){"use strict";var c=[];var d=[];var f=[];var h=[];function p(t,r,n){var a=c;var o=f;var s=d;var l=h;a.length=o.length=t.length-1;s.length=l.length=t.length;var p;a[0]=s[0]=1;o[0]=0;var m=l[0];if(!i(m)){m=l[0]=new e}e.clone(r,m);for(p=1;p<a.length-1;++p){a[p]=o[p]=1;s[p]=4;m=l[p];if(!i(m)){m=l[p]=new e}e.subtract(t[p+1],t[p-1],m);e.multiplyByScalar(m,3,m)}a[p]=0;o[p]=1;s[p]=4;m=l[p];if(!i(m)){m=l[p]=new e}e.subtract(t[p+1],t[p-1],m);e.multiplyByScalar(m,3,m);s[p+1]=1;m=l[p+1];if(!i(m)){m=l[p+1]=new e}e.clone(n,m);return u.solve(a,s,o,l)}function m(t){var r=c;var n=f;var a=d;var o=h;r.length=n.length=t.length-1;a.length=o.length=t.length;var s;r[0]=n[0]=1;a[0]=2;var l=o[0];if(!i(l)){l=o[0]=new e}e.subtract(t[1],t[0],l);e.multiplyByScalar(l,3,l);for(s=1;s<r.length;++s){r[s]=n[s]=1;a[s]=4;l=o[s];if(!i(l)){l=o[s]=new e}e.subtract(t[s+1],t[s-1],l);e.multiplyByScalar(l,3,l)}a[s]=2;l=o[s];if(!i(l)){l=o[s]=new e}e.subtract(t[s],t[s-1],l);e.multiplyByScalar(l,3,l);return u.solve(r,a,n,o)}function v(e){e=r(e,r.EMPTY_OBJECT);var t=e.points;var n=e.times;var o=e.inTangents;var s=e.outTangents;if(!i(t)||!i(n)||!i(o)||!i(s)){throw new a("times, points, inTangents, and outTangents are required.")}if(t.length<2){throw new a("points.length must be greater than or equal to 2.")}if(n.length!==t.length){throw new a("times.length must be equal to points.length.")}if(o.length!==s.length||o.length!==t.length-1){throw new a("inTangents and outTangents must have a length equal to points.length - 1.")}this._times=n;this._points=t;this._inTangents=o;this._outTangents=s;this._lastTimeIndex=0}n(v.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},inTangents:{get:function(){return this._inTangents}},outTangents:{get:function(){return this._outTangents}}});v.createC1=function(e){e=r(e,r.EMPTY_OBJECT);var t=e.times;var n=e.points;var o=e.tangents;if(!i(n)||!i(t)||!i(o)){throw new a("points, times and tangents are required.")}if(n.length<2){throw new a("points.length must be greater than or equal to 2.")}if(t.length!==n.length||t.length!==o.length){throw new a("times, points and tangents must have the same length.")}var s=o.slice(0,o.length-1);var l=o.slice(1,o.length);return new v({times:t,points:n,inTangents:l,outTangents:s})};v.createNaturalCubic=function(e){e=r(e,r.EMPTY_OBJECT);var t=e.times;var n=e.points;if(!i(n)||!i(t)){throw new a("points and times are required.")}if(n.length<2){throw new a("points.length must be greater than or equal to 2.")}if(t.length!==n.length){throw new a("times.length must be equal to points.length.")}if(n.length<3){return new o({points:n,times:t})}var s=m(n);var l=s.slice(0,s.length-1);var u=s.slice(1,s.length);return new v({times:t,points:n,inTangents:u,outTangents:l})};v.createClampedCubic=function(e){e=r(e,r.EMPTY_OBJECT);var t=e.times;var n=e.points;var s=e.firstTangent;var l=e.lastTangent;if(!i(n)||!i(t)||!i(s)||!i(l)){throw new a("points, times, firstTangent and lastTangent are required.")}if(n.length<2){throw new a("points.length must be greater than or equal to 2.")}if(t.length!==n.length){throw new a("times.length must be equal to points.length.")}if(n.length<3){return new o({points:n,times:t})}var u=p(n,s,l);var c=u.slice(0,u.length-1);var d=u.slice(1,u.length);return new v({times:t,points:n,inTangents:d,outTangents:c})};v.hermiteCoefficientMatrix=new s(2,-3,0,1,-2,3,0,0,1,-2,1,0,1,-1,0,0);v.prototype.findTimeInterval=l.prototype.findTimeInterval;var g=new t;var _=new e;v.prototype.evaluate=function(t,r){if(!i(r)){r=new e}var n=this.points;var a=this.times;var o=this.inTangents;var l=this.outTangents;var u=this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex);var c=(t-a[u])/(a[u+1]-a[u]);var d=g;d.z=c;d.y=c*c;d.x=d.y*c;d.w=1;var f=s.multiplyByVector(v.hermiteCoefficientMatrix,d,d);r=e.multiplyByScalar(n[u],f.x,r);e.multiplyByScalar(n[u+1],f.y,_);e.add(r,_,r);e.multiplyByScalar(l[u],f.z,_);e.add(r,_,r);e.multiplyByScalar(o[u],f.w,_);return e.add(r,_,r)};return v});define("Core/CatmullRomSpline",["./Cartesian3","./Cartesian4","./Check","./defaultValue","./defined","./defineProperties","./HermiteSpline","./Matrix4","./Spline"],function(e,t,r,i,n,a,o,s,l){"use strict";var u=new t;var c=new e;var d=new e;function f(t){var r=t.points;var i=t.times;if(r.length<3){var a=i[0];var l=1/(i[1]-a);var f=r[0];var h=r[1];return function(t,r){if(!n(r)){r=new e}var i=(t-a)*l;return e.lerp(f,h,i,r)}}return function(a,l){if(!n(l)){l=new e}var f=t._lastTimeIndex=t.findTimeInterval(a,t._lastTimeIndex);var h=(a-i[f])/(i[f+1]-i[f]);var p=u;p.z=h;p.y=h*h;p.x=p.y*h;p.w=1;var v;var g;var _;var y;var b;if(f===0){v=r[0];g=r[1];_=t.firstTangent;y=e.subtract(r[2],v,c);e.multiplyByScalar(y,.5,y);b=s.multiplyByVector(o.hermiteCoefficientMatrix,p,p)}else if(f===r.length-2){v=r[f];g=r[f+1];y=t.lastTangent;_=e.subtract(g,r[f-1],c);e.multiplyByScalar(_,.5,_);b=s.multiplyByVector(o.hermiteCoefficientMatrix,p,p)}else{v=r[f-1];g=r[f];_=r[f+1];y=r[f+2];b=s.multiplyByVector(m.catmullRomCoefficientMatrix,p,p)}l=e.multiplyByScalar(v,b.x,l);e.multiplyByScalar(g,b.y,d);e.add(l,d,l);e.multiplyByScalar(_,b.z,d);e.add(l,d,l);e.multiplyByScalar(y,b.w,d);return e.add(l,d,l)}}var h=new e;var p=new e;function m(t){t=i(t,i.EMPTY_OBJECT);var a=t.points;var o=t.times;var s=t.firstTangent;var l=t.lastTangent;r.defined("points",a);r.defined("times",o);r.typeOf.number.greaterThanOrEquals("points.length",a.length,2);r.typeOf.number.equals("times.length","points.length",o.length,a.length);if(a.length>2){if(!n(s)){s=h;e.multiplyByScalar(a[1],2,s);e.subtract(s,a[2],s);e.subtract(s,a[0],s);e.multiplyByScalar(s,.5,s)}if(!n(l)){var u=a.length-1;l=p;e.multiplyByScalar(a[u-1],2,l);e.subtract(a[u],l,l);e.add(l,a[u-2],l);e.multiplyByScalar(l,.5,l)}}this._times=o;this._points=a;this._firstTangent=e.clone(s);this._lastTangent=e.clone(l);this._evaluateFunction=f(this);this._lastTimeIndex=0}a(m.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},firstTangent:{get:function(){return this._firstTangent}},lastTangent:{get:function(){return this._lastTangent}}});m.catmullRomCoefficientMatrix=new s(-.5,1,-.5,0,1.5,-2.5,0,1,-1.5,2,.5,0,.5,-.5,0,0);m.prototype.findTimeInterval=l.prototype.findTimeInterval;m.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};return m});define("Core/oneTimeWarning",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};function n(n,a){if(!t(n)){throw new r("identifier is required.")}if(!t(i[n])){i[n]=true;console.warn(e(a,n))}}n.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.";return n});define("Core/deprecationWarning",["./defined","./DeveloperError","./oneTimeWarning"],function(e,t,r){"use strict";function i(i,n){if(!e(i)||!e(n)){throw new t("identifier and message are required.")}r(i,n)}return i});define("Core/Event",["./Check","./defined","./defineProperties"],function(e,t,r){"use strict";function i(){this._listeners=[];this._scopes=[];this._toRemove=[];this._insideRaiseEvent=false}r(i.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}});i.prototype.addEventListener=function(t,r){e.typeOf.func("listener",t);this._listeners.push(t);this._scopes.push(r);var i=this;return function(){i.removeEventListener(t,r)}};i.prototype.removeEventListener=function(t,r){e.typeOf.func("listener",t);var i=this._listeners;var n=this._scopes;var a=-1;for(var o=0;o<i.length;o++){if(i[o]===t&&n[o]===r){a=o;break}}if(a!==-1){if(this._insideRaiseEvent){this._toRemove.push(a);i[a]=undefined;n[a]=undefined}else{i.splice(a,1);n.splice(a,1)}return true}return false};i.prototype.raiseEvent=function(){this._insideRaiseEvent=true;var e;var r=this._listeners;var i=this._scopes;var n=r.length;for(e=0;e<n;e++){var a=r[e];if(t(a)){r[e].apply(i[e],arguments)}}var o=this._toRemove;n=o.length;for(e=0;e<n;e++){var s=o[e];r.splice(s,1);i.splice(s,1)}o.length=0;this._insideRaiseEvent=false};return i});define("Core/GeographicTilingScheme",["./Cartesian2","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./GeographicProjection","./Math","./Rectangle"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(e){e=r(e,{});this._ellipsoid=r(e.ellipsoid,a.WGS84);this._rectangle=r(e.rectangle,l.MAX_VALUE);this._projection=new o(this._ellipsoid);this._numberOfLevelZeroTilesX=r(e.numberOfLevelZeroTilesX,2);this._numberOfLevelZeroTilesY=r(e.numberOfLevelZeroTilesY,1)}n(u.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});u.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e};u.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e};u.prototype.rectangleToNativeRectangle=function(e,r){t.defined("rectangle",e);var n=s.toDegrees(e.west);var a=s.toDegrees(e.south);var o=s.toDegrees(e.east);var u=s.toDegrees(e.north);if(!i(r)){return new l(n,a,o,u)}r.west=n;r.south=a;r.east=o;r.north=u;return r};u.prototype.tileXYToNativeRectangle=function(e,t,r,i){var n=this.tileXYToRectangle(e,t,r,i);n.west=s.toDegrees(n.west);n.south=s.toDegrees(n.south);n.east=s.toDegrees(n.east);n.north=s.toDegrees(n.north);return n};u.prototype.tileXYToRectangle=function(e,t,r,n){var a=this._rectangle;var o=this.getNumberOfXTilesAtLevel(r);var s=this.getNumberOfYTilesAtLevel(r);var u=a.width/o;var c=e*u+a.west;var d=(e+1)*u+a.west;var f=a.height/s;var h=a.north-t*f;var p=a.north-(t+1)*f;if(!i(n)){n=new l(c,p,d,h)}n.west=c;n.south=p;n.east=d;n.north=h;return n};u.prototype.positionToTileXY=function(t,r,n){var a=this._rectangle;if(!l.contains(a,t)){return undefined}var o=this.getNumberOfXTilesAtLevel(r);var u=this.getNumberOfYTilesAtLevel(r);var c=a.width/o;var d=a.height/u;var f=t.longitude;if(a.east<a.west){f+=s.TWO_PI}var h=(f-a.west)/c|0;if(h>=o){h=o-1}var p=(a.north-t.latitude)/d|0;if(p>=u){p=u-1}if(!i(n)){return new e(h,p)}n.x=h;n.y=p;return n};return u});define("Core/EllipsoidalOccluder",["./BoundingSphere","./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./Rectangle"],function(e,t,r,i,n,a,o){"use strict";function s(e,i){r.typeOf.object("ellipsoid",e);this._ellipsoid=e;this._cameraPosition=new t;this._cameraPositionInScaledSpace=new t;this._distanceToLimbInScaledSpaceSquared=0;if(n(i)){this.cameraPosition=i}}a(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){var r=this._ellipsoid;var i=r.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace);var n=t.magnitudeSquared(i)-1;t.clone(e,this._cameraPosition);this._cameraPositionInScaledSpace=i;this._distanceToLimbInScaledSpaceSquared=n}}});var l=new t;s.prototype.isPointVisible=function(e){var t=this._ellipsoid;var r=t.transformPositionToScaledSpace(e,l);return this.isScaledSpacePointVisible(r)};s.prototype.isScaledSpacePointVisible=function(e){var r=this._cameraPositionInScaledSpace;var i=this._distanceToLimbInScaledSpaceSquared;var n=t.subtract(e,r,l);var a=-t.dot(n,r);var o=i<0?a>0:a>i&&a*a/t.magnitudeSquared(n)>i;return!o};s.prototype.computeHorizonCullingPoint=function(e,i,a){r.typeOf.object("directionToPoint",e);r.defined("positions",i);if(!n(a)){a=new t}var o=this._ellipsoid;var s=v(o,e);var l=0;for(var u=0,c=i.length;u<c;++u){var d=i[u];var f=h(o,d,s);l=Math.max(l,f)}return p(s,l,a)};var u=new t;s.prototype.computeHorizonCullingPointFromVertices=function(e,a,o,s,l){r.typeOf.object("directionToPoint",e);r.defined("vertices",a);r.typeOf.number("stride",o);if(!n(l)){l=new t}s=i(s,t.ZERO);var c=this._ellipsoid;var d=v(c,e);var f=0;for(var m=0,g=a.length;m<g;m+=o){u.x=a[m]+s.x;u.y=a[m+1]+s.y;u.z=a[m+2]+s.z;var _=h(c,u,d);f=Math.max(f,_)}return p(d,f,l)};var c=[];s.prototype.computeHorizonCullingPointFromRectangle=function(i,n,a){r.typeOf.object("rectangle",i);var s=o.subsample(i,n,0,c);var l=e.fromPoints(s);if(t.magnitude(l.center)<.1*n.minimumRadius){return undefined}return this.computeHorizonCullingPoint(l.center,s,a)};var d=new t;var f=new t;function h(e,r,i){var n=e.transformPositionToScaledSpace(r,d);var a=t.magnitudeSquared(n);var o=Math.sqrt(a);var s=t.divideByScalar(n,o,f);a=Math.max(1,a);o=Math.max(1,o);var l=t.dot(s,i);var u=t.magnitude(t.cross(s,i,s));var c=1/o;var h=Math.sqrt(a-1)*c;return 1/(l*c-u*h)}function p(e,r,i){if(r<=0||r===1/0||r!==r){return undefined}return t.multiplyByScalar(e,r,i)}var m=new t;function v(e,r){if(t.equals(r,t.ZERO)){return r}e.transformPositionToScaledSpace(r,m);return t.normalize(m,m)}return s});define("Core/QuadraticRealPolynomial",["./DeveloperError","./Math"],function(e,t){"use strict";var r={};r.computeDiscriminant=function(t,r,i){if(typeof t!=="number"){throw new e("a is a required number.")}if(typeof r!=="number"){throw new e("b is a required number.")}if(typeof i!=="number"){throw new e("c is a required number.")}var n=r*r-4*t*i;return n};function i(e,r,i){var n=e+r;if(t.sign(e)!==t.sign(r)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(r)))<i){return 0}return n}r.computeRealRoots=function(r,n,a){if(typeof r!=="number"){throw new e("a is a required number.")}if(typeof n!=="number"){throw new e("b is a required number.")}if(typeof a!=="number"){throw new e("c is a required number.")}var o;if(r===0){if(n===0){return[]}return[-a/n]}else if(n===0){if(a===0){return[0,0]}var s=Math.abs(a);var l=Math.abs(r);if(s<l&&s/l<t.EPSILON14){return[0,0]}else if(s>l&&l/s<t.EPSILON14){return[]}o=-a/r;if(o<0){return[]}var u=Math.sqrt(o);return[-u,u]}else if(a===0){o=-n/r;if(o<0){return[o,0]}return[0,o]}var c=n*n;var d=4*r*a;var f=i(c,-d,t.EPSILON14);if(f<0){return[]}var h=-.5*i(n,t.sign(n)*Math.sqrt(f),t.EPSILON14);if(n>0){return[h/r,a/h]}return[a/h,h/r]};return r});define("Core/CubicRealPolynomial",["./DeveloperError","./QuadraticRealPolynomial"],function(e,t){"use strict";var r={};r.computeDiscriminant=function(t,r,i,n){if(typeof t!=="number"){throw new e("a is a required number.")}if(typeof r!=="number"){throw new e("b is a required number.")}if(typeof i!=="number"){throw new e("c is a required number.")}if(typeof n!=="number"){throw new e("d is a required number.")}var a=t*t;var o=r*r;var s=i*i;var l=n*n;var u=18*t*r*i*n+o*s-27*a*l-4*(t*s*i+o*r*n);return u};function i(e,t,r,i){var n=e;var a=t/3;var o=r/3;var s=i;var l=n*o;var u=a*s;var c=a*a;var d=o*o;var f=n*o-c;var h=n*s-a*o;var p=a*s-d;var m=4*f*p-h*h;var v;var g;if(m<0){var _;var y;var b;if(c*u>=l*d){_=n;y=f;b=-2*a*f+n*h}else{_=s;y=p;b=-s*h+2*o*p}var w=b<0?-1:1;var C=-w*Math.abs(_)*Math.sqrt(-m);g=-b+C;var S=g/2;var T=S<0?-Math.pow(-S,1/3):Math.pow(S,1/3);var E=g===C?-T:-y/T;v=y<=0?T+E:-b/(T*T+E*E+y);if(c*u>=l*d){return[(v-a)/n]}return[-s/(v+o)]}var x=f;var P=-2*a*f+n*h;var A=p;var O=-s*h+2*o*p;var D=Math.sqrt(m);var I=Math.sqrt(3)/2;var M=Math.abs(Math.atan2(n*D,-P)/3);v=2*Math.sqrt(-x);var R=Math.cos(M);g=v*R;var L=v*(-R/2-I*Math.sin(M));var N=g+L>2*a?g-a:L-a;var k=n;var F=N/k;M=Math.abs(Math.atan2(s*D,-O)/3);v=2*Math.sqrt(-A);R=Math.cos(M);g=v*R;L=v*(-R/2-I*Math.sin(M));var B=-s;var U=g+L<2*o?g+o:L+o;var V=B/U;var z=k*U;var q=-N*U-k*B;var G=N*B;var H=(o*q-a*G)/(-a*q+o*z);if(F<=H){if(F<=V){if(H<=V){return[F,H,V]}return[F,V,H]}return[V,F,H]}if(F<=V){return[H,F,V]}if(H<=V){return[H,V,F]}return[V,H,F]}r.computeRealRoots=function(r,n,a,o){if(typeof r!=="number"){throw new e("a is a required number.")}if(typeof n!=="number"){throw new e("b is a required number.")}if(typeof a!=="number"){throw new e("c is a required number.")}if(typeof o!=="number"){throw new e("d is a required number.")}var s;var l;if(r===0){return t.computeRealRoots(n,a,o)}else if(n===0){if(a===0){if(o===0){return[0,0,0]}l=-o/r;var u=l<0?-Math.pow(-l,1/3):Math.pow(l,1/3);return[u,u,u]}else if(o===0){s=t.computeRealRoots(r,0,a);if(s.Length===0){return[0]}return[s[0],0,s[1]]}return i(r,0,a,o)}else if(a===0){if(o===0){l=-n/r;if(l<0){return[l,0,0]}return[0,0,l]}return i(r,n,0,o)}else if(o===0){s=t.computeRealRoots(r,n,a);if(s.length===0){return[0]}else if(s[1]<=0){return[s[0],s[1],0]}else if(s[0]>=0){return[0,s[0],s[1]]}return[s[0],0,s[1]]}return i(r,n,a,o)};return r});define("Core/QuarticRealPolynomial",["./CubicRealPolynomial","./DeveloperError","./Math","./QuadraticRealPolynomial"],function(e,t,r,i){"use strict";var n={};n.computeDiscriminant=function(e,r,i,n,a){if(typeof e!=="number"){throw new t("a is a required number.")}if(typeof r!=="number"){throw new t("b is a required number.")}if(typeof i!=="number"){throw new t("c is a required number.")}if(typeof n!=="number"){throw new t("d is a required number.")}if(typeof a!=="number"){throw new t("e is a required number.")}var o=e*e;var s=o*e;var l=r*r;var u=l*r;var c=i*i;var d=c*i;var f=n*n;var h=f*n;var p=a*a;var m=p*a;var v=l*c*f-4*u*h-4*e*d*f+18*e*r*i*h-27*o*f*f+256*s*m+a*(18*u*i*n-4*l*d+16*e*c*c-80*e*r*c*n-6*e*l*f+144*o*i*f)+p*(144*e*l*i-27*l*l-128*o*c-192*o*r*n);return v};function a(t,n,a,o){var s=t*t;var l=n-3*s/8;var u=a-n*t/2+s*t/8;var c=o-a*t/4+n*s/16-3*s*s/256;var d=e.computeRealRoots(1,2*l,l*l-4*c,-u*u);if(d.length>0){var f=-t/4;var h=d[d.length-1];if(Math.abs(h)<r.EPSILON14){var p=i.computeRealRoots(1,l,c);if(p.length===2){var m=p[0];var v=p[1];var g;if(m>=0&&v>=0){var _=Math.sqrt(m);var y=Math.sqrt(v);return[f-y,f-_,f+_,f+y]}else if(m>=0&&v<0){g=Math.sqrt(m);return[f-g,f+g]}else if(m<0&&v>=0){g=Math.sqrt(v);return[f-g,f+g]}}return[]}else if(h>0){var b=Math.sqrt(h);var w=(l+h-u/b)/2;var C=(l+h+u/b)/2;var S=i.computeRealRoots(1,b,w);var T=i.computeRealRoots(1,-b,C);if(S.length!==0){S[0]+=f;S[1]+=f;if(T.length!==0){T[0]+=f;T[1]+=f;if(S[1]<=T[0]){return[S[0],S[1],T[0],T[1]]}else if(T[1]<=S[0]){return[T[0],T[1],S[0],S[1]]}else if(S[0]>=T[0]&&S[1]<=T[1]){return[T[0],S[0],S[1],T[1]]}else if(T[0]>=S[0]&&T[1]<=S[1]){return[S[0],T[0],T[1],S[1]]}else if(S[0]>T[0]&&S[0]<T[1]){return[T[0],S[0],T[1],S[1]]}return[S[0],T[0],S[1],T[1]]}return S}if(T.length!==0){T[0]+=f;T[1]+=f;return T}return[]}}return[]}function o(t,n,a,o){var s=a*a;var l=n*n;var u=t*t;var c=-2*n;var d=a*t+l-4*o;var f=u*o-a*n*t+s;var h=e.computeRealRoots(1,c,d,f);if(h.length>0){var p=h[0];var m=n-p;var v=m*m;var g=t/2;var _=m/2;var y=v-4*o;var b=v+4*Math.abs(o);var w=u-4*p;var C=u+4*Math.abs(p);var S;var T;if(p<0||y*C<w*b){var E=Math.sqrt(w);S=E/2;T=E===0?0:(t*_-a)/E}else{var x=Math.sqrt(y);S=x===0?0:(t*_-a)/x;T=x/2}var P;var A;if(g===0&&S===0){P=0;A=0}else if(r.sign(g)===r.sign(S)){P=g+S;A=p/P}else{A=g-S;P=p/A}var O;var D;if(_===0&&T===0){O=0;D=0}else if(r.sign(_)===r.sign(T)){O=_+T;D=o/O}else{D=_-T;O=o/D}var I=i.computeRealRoots(1,P,O);var M=i.computeRealRoots(1,A,D);if(I.length!==0){if(M.length!==0){if(I[1]<=M[0]){return[I[0],I[1],M[0],M[1]]}else if(M[1]<=I[0]){return[M[0],M[1],I[0],I[1]]}else if(I[0]>=M[0]&&I[1]<=M[1]){return[M[0],I[0],I[1],M[1]]}else if(M[0]>=I[0]&&M[1]<=I[1]){return[I[0],M[0],M[1],I[1]]}else if(I[0]>M[0]&&I[0]<M[1]){return[M[0],I[0],M[1],I[1]]}return[I[0],M[0],I[1],M[1]]}return I}if(M.length!==0){return M}}return[]}n.computeRealRoots=function(i,n,s,l,u){if(typeof i!=="number"){throw new t("a is a required number.")}if(typeof n!=="number"){throw new t("b is a required number.")}if(typeof s!=="number"){throw new t("c is a required number.")}if(typeof l!=="number"){throw new t("d is a required number.")}if(typeof u!=="number"){throw new t("e is a required number.")}if(Math.abs(i)<r.EPSILON15){return e.computeRealRoots(n,s,l,u)}var c=n/i;var d=s/i;var f=l/i;var h=u/i;var p=c<0?1:0;p+=d<0?p+1:p;p+=f<0?p+1:p;p+=h<0?p+1:p;switch(p){case 0:return a(c,d,f,h);case 1:return o(c,d,f,h);case 2:return o(c,d,f,h);case 3:return a(c,d,f,h);case 4:return a(c,d,f,h);case 5:return o(c,d,f,h);case 6:return a(c,d,f,h);case 7:return a(c,d,f,h);case 8:return o(c,d,f,h);case 9:return a(c,d,f,h);case 10:return a(c,d,f,h);case 11:return o(c,d,f,h);case 12:return a(c,d,f,h);case 13:return a(c,d,f,h);case 14:return a(c,d,f,h);case 15:return a(c,d,f,h);default:return undefined}};return n});define("Core/Ray",["./Cartesian3","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i){"use strict";function n(r,i){i=e.clone(t(i,e.ZERO));if(!e.equals(i,e.ZERO)){e.normalize(i,i)}this.origin=e.clone(t(r,e.ZERO));this.direction=i}n.getPoint=function(t,n,a){if(!r(t)){throw new i("ray is requred")}if(typeof n!=="number"){throw new i("t is a required number")}if(!r(a)){a=new e}a=e.multiplyByScalar(t.direction,n,a);return e.add(t.origin,a,a)};return n});define("Core/IntersectionTests",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Interval","./Math","./Matrix3","./QuadraticRealPolynomial","./QuarticRealPolynomial","./Ray"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";var d={};d.rayPlane=function(t,r,a){if(!i(t)){throw new n("ray is required.")}if(!i(r)){throw new n("plane is required.")}if(!i(a)){a=new e}var s=t.origin;var l=t.direction;var u=r.normal;var c=e.dot(u,l);if(Math.abs(c)<o.EPSILON15){return undefined}var d=(-r.distance-e.dot(u,s))/c;if(d<0){return undefined}a=e.multiplyByScalar(l,d,a);return e.add(s,a,a)};var f=new e;var h=new e;var p=new e;var m=new e;var v=new e;d.rayTriangleParametric=function(t,a,s,l,u){if(!i(t)){throw new n("ray is required.")}if(!i(a)){throw new n("p0 is required.")}if(!i(s)){throw new n("p1 is required.")}if(!i(l)){throw new n("p2 is required.")}u=r(u,false);var c=t.origin;var d=t.direction;var g=e.subtract(s,a,f);var _=e.subtract(l,a,h);var y=e.cross(d,_,p);var b=e.dot(g,y);var w;var C;var S;var T;var E;if(u){if(b<o.EPSILON6){return undefined}w=e.subtract(c,a,m);S=e.dot(w,y);if(S<0||S>b){return undefined}C=e.cross(w,g,v);T=e.dot(d,C);if(T<0||S+T>b){return undefined}E=e.dot(_,C)/b}else{if(Math.abs(b)<o.EPSILON6){return undefined}var x=1/b;w=e.subtract(c,a,m);S=e.dot(w,y)*x;if(S<0||S>1){return undefined}C=e.cross(w,g,v);T=e.dot(d,C)*x;if(T<0||S+T>1){return undefined}E=e.dot(_,C)*x}return E};d.rayTriangle=function(t,r,n,a,o,s){var l=d.rayTriangleParametric(t,r,n,a,o);if(!i(l)||l<0){return undefined}if(!i(s)){s=new e}e.multiplyByScalar(t.direction,l,s);return e.add(t.origin,s,s)};var g=new c;d.lineSegmentTriangle=function(t,r,a,o,s,l,u){if(!i(t)){throw new n("v0 is required.")}if(!i(r)){throw new n("v1 is required.")}if(!i(a)){throw new n("p0 is required.")}if(!i(o)){throw new n("p1 is required.")}if(!i(s)){throw new n("p2 is required.")}var c=g;e.clone(t,c.origin);e.subtract(r,t,c.direction);e.normalize(c.direction,c.direction);var f=d.rayTriangleParametric(c,a,o,s,l);if(!i(f)||f<0||f>e.distance(t,r)){return undefined}if(!i(u)){u=new e}e.multiplyByScalar(c.direction,f,u);return e.add(c.origin,u,u)};function _(e,t,r,i){var n=t*t-4*e*r;if(n<0){return undefined}else if(n>0){var a=1/(2*e);var o=Math.sqrt(n);var s=(-t+o)*a;var l=(-t-o)*a;if(s<l){i.root0=s;i.root1=l}else{i.root0=l;i.root1=s}return i}var u=-t/(2*e);if(u===0){return undefined}i.root0=i.root1=u;return i}var y={root0:0,root1:0};function b(t,r,n){if(!i(n)){n=new a}var o=t.origin;var s=t.direction;var l=r.center;var u=r.radius*r.radius;var c=e.subtract(o,l,p);var d=e.dot(s,s);var f=2*e.dot(s,c);var h=e.magnitudeSquared(c)-u;var m=_(d,f,h,y);if(!i(m)){return undefined}n.start=m.root0;n.stop=m.root1;return n}d.raySphere=function(e,t,r){if(!i(e)){throw new n("ray is required.")}if(!i(t)){throw new n("sphere is required.")}r=b(e,t,r);if(!i(r)||r.stop<0){return undefined}r.start=Math.max(r.start,0);return r};var w=new c;d.lineSegmentSphere=function(t,r,a,o){if(!i(t)){throw new n("p0 is required.")}if(!i(r)){throw new n("p1 is required.")}if(!i(a)){throw new n("sphere is required.")}var s=w;e.clone(t,s.origin);var l=e.subtract(r,t,s.direction);var u=e.magnitude(l);e.normalize(l,l);o=b(s,a,o);if(!i(o)||o.stop<0||o.start>u){return undefined}o.start=Math.max(o.start,0);o.stop=Math.min(o.stop,u);return o};var C=new e;var S=new e;d.rayEllipsoid=function(t,r){if(!i(t)){throw new n("ray is required.")}if(!i(r)){throw new n("ellipsoid is required.")}var o=r.oneOverRadii;var s=e.multiplyComponents(o,t.origin,C);var l=e.multiplyComponents(o,t.direction,S);var u=e.magnitudeSquared(s);var c=e.dot(s,l);var d,f,h,p,m;if(u>1){if(c>=0){return undefined}var v=c*c;d=u-1;f=e.magnitudeSquared(l);h=f*d;if(v<h){return undefined}else if(v>h){p=c*c-h;m=-c+Math.sqrt(p);var g=m/f;var _=d/m;if(g<_){return new a(g,_)}return{start:_,stop:g}}var y=Math.sqrt(d/f);return new a(y,y)}else if(u<1){d=u-1;f=e.magnitudeSquared(l);h=f*d;p=c*c-h;m=-c+Math.sqrt(p);return new a(0,m/f)}if(c<0){f=e.magnitudeSquared(l);return new a(0,-c/f)}return undefined};function T(e,t,r){var i=e+t;if(o.sign(e)!==o.sign(t)&&Math.abs(i/Math.max(Math.abs(e),Math.abs(t)))<r){return 0}return i}function E(t,r,i,n,a){var c=n*n;var d=a*a;var f=(t[s.COLUMN1ROW1]-t[s.COLUMN2ROW2])*d;var h=a*(n*T(t[s.COLUMN1ROW0],t[s.COLUMN0ROW1],o.EPSILON15)+r.y);var p=t[s.COLUMN0ROW0]*c+t[s.COLUMN2ROW2]*d+n*r.x+i;var m=d*T(t[s.COLUMN2ROW1],t[s.COLUMN1ROW2],o.EPSILON15);var v=a*(n*T(t[s.COLUMN2ROW0],t[s.COLUMN0ROW2])+r.z);var g;var _=[];if(v===0&&m===0){g=l.computeRealRoots(f,h,p);if(g.length===0){return _}var y=g[0];var b=Math.sqrt(Math.max(1-y*y,0));_.push(new e(n,a*y,a*-b));_.push(new e(n,a*y,a*b));if(g.length===2){var w=g[1];var C=Math.sqrt(Math.max(1-w*w,0));_.push(new e(n,a*w,a*-C));_.push(new e(n,a*w,a*C))}return _}var S=v*v;var E=m*m;var x=f*f;var P=v*m;var A=x+E;var O=2*(h*f+P);var D=2*p*f+h*h-E+S;var I=2*(p*h-P);var M=p*p-S;if(A===0&&O===0&&D===0&&I===0){return _}g=u.computeRealRoots(A,O,D,I,M);var R=g.length;if(R===0){return _}for(var L=0;L<R;++L){var N=g[L];var k=N*N;var F=Math.max(1-k,0);var B=Math.sqrt(F);var U;if(o.sign(f)===o.sign(p)){U=T(f*k+p,h*N,o.EPSILON12)}else if(o.sign(p)===o.sign(h*N)){U=T(f*k,h*N+p,o.EPSILON12)}else{U=T(f*k+h*N,p,o.EPSILON12)}var V=T(m*N,v,o.EPSILON15);var z=U*V;if(z<0){_.push(new e(n,a*N,a*B))}else if(z>0){_.push(new e(n,a*N,a*-B))}else if(B!==0){_.push(new e(n,a*N,a*-B));_.push(new e(n,a*N,a*B));++L}else{_.push(new e(n,a*N,a*B))}}return _}var x=new e;var P=new e;var A=new e;var O=new e;var D=new e;var I=new s;var M=new s;var R=new s;var L=new s;var N=new s;var k=new s;var F=new s;var B=new e;var U=new e;var V=new t;d.grazingAltitudeLocation=function(t,r){if(!i(t)){throw new n("ray is required.")}if(!i(r)){throw new n("ellipsoid is required.")}var a=t.origin;var l=t.direction;if(!e.equals(a,e.ZERO)){var u=r.geodeticSurfaceNormal(a,x);if(e.dot(l,u)>=0){return a}}var c=i(this.rayEllipsoid(t,r));var d=r.transformPositionToScaledSpace(l,x);var f=e.normalize(d,d);var h=e.mostOrthogonalAxis(d,O);var p=e.normalize(e.cross(h,f,P),P);var m=e.normalize(e.cross(f,p,A),A);var v=I;v[0]=f.x;v[1]=f.y;v[2]=f.z;v[3]=p.x;v[4]=p.y;v[5]=p.z;v[6]=m.x;v[7]=m.y;v[8]=m.z;var g=s.transpose(v,M);var _=s.fromScale(r.radii,R);var y=s.fromScale(r.oneOverRadii,L);var b=N;b[0]=0;b[1]=-l.z;b[2]=l.y;b[3]=l.z;b[4]=0;b[5]=-l.x;b[6]=-l.y;b[7]=l.x;b[8]=0;var w=s.multiply(s.multiply(g,y,k),b,k);var C=s.multiply(s.multiply(w,_,F),v,F);var S=s.multiplyByVector(w,a,D);var T=E(C,e.negate(S,x),0,0,1);var z;var q;var G=T.length;if(G>0){var H=e.clone(e.ZERO,U);var j=Number.NEGATIVE_INFINITY;for(var W=0;W<G;++W){z=s.multiplyByVector(_,s.multiplyByVector(v,T[W],B),B);var Y=e.normalize(e.subtract(z,a,O),O);var X=e.dot(Y,l);if(X>j){j=X;H=e.clone(z,H)}}var Q=r.cartesianToCartographic(H,V);j=o.clamp(j,0,1);q=e.magnitude(e.subtract(H,a,O))*Math.sqrt(1-j*j);q=c?-q:q;Q.height=q;return r.cartographicToCartesian(Q,new e)}return undefined};var z=new e;d.lineSegmentPlane=function(t,r,a,s){if(!i(t)){throw new n("endPoint0 is required.")}if(!i(r)){throw new n("endPoint1 is required.")}if(!i(a)){throw new n("plane is required.")}if(!i(s)){s=new e}var l=e.subtract(r,t,z);var u=a.normal;var c=e.dot(u,l);if(Math.abs(c)<o.EPSILON6){return undefined}var d=e.dot(u,t);var f=-(a.distance+d)/c;if(f<0||f>1){return undefined}e.multiplyByScalar(l,f,s);e.add(t,s,s);return s};d.trianglePlaneIntersection=function(t,r,a,o){if(!i(t)||!i(r)||!i(a)||!i(o)){throw new n("p0, p1, p2, and plane are required.")}var s=o.normal;var l=o.distance;var u=e.dot(s,t)+l<0;var c=e.dot(s,r)+l<0;var f=e.dot(s,a)+l<0;var h=0;h+=u?1:0;h+=c?1:0;h+=f?1:0;var p,m;if(h===1||h===2){p=new e;m=new e}if(h===1){if(u){d.lineSegmentPlane(t,r,o,p);d.lineSegmentPlane(t,a,o,m);return{positions:[t,r,a,p,m],indices:[0,3,4,1,2,4,1,4,3]}}else if(c){d.lineSegmentPlane(r,a,o,p);d.lineSegmentPlane(r,t,o,m);return{positions:[t,r,a,p,m],indices:[1,3,4,2,0,4,2,4,3]}}else if(f){d.lineSegmentPlane(a,t,o,p);d.lineSegmentPlane(a,r,o,m);return{positions:[t,r,a,p,m],indices:[2,3,4,0,1,4,0,4,3]}}}else if(h===2){if(!u){d.lineSegmentPlane(r,t,o,p);d.lineSegmentPlane(a,t,o,m);return{positions:[t,r,a,p,m],indices:[1,2,4,1,4,3,0,3,4]}}else if(!c){d.lineSegmentPlane(a,r,o,p);d.lineSegmentPlane(t,r,o,m);return{positions:[t,r,a,p,m],indices:[2,0,4,2,4,3,1,3,4]}}else if(!f){d.lineSegmentPlane(t,a,o,p);d.lineSegmentPlane(r,a,o,m);return{positions:[t,r,a,p,m],indices:[0,1,4,0,4,3,2,3,4]}}}return undefined};return d});define("Core/Plane",["./Cartesian3","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,r,i,n){"use strict";function a(i,a){if(!t(i)){throw new r("normal is required.")}if(!n.equalsEpsilon(e.magnitude(i),1,n.EPSILON6)){throw new r("normal must be normalized.")}if(!t(a)){throw new r("distance is required.")}this.normal=e.clone(i);this.distance=a}a.fromPointNormal=function(i,o,s){if(!t(i)){throw new r("point is required.")}if(!t(o)){throw new r("normal is required.")}if(!n.equalsEpsilon(e.magnitude(o),1,n.EPSILON6)){throw new r("normal must be normalized.")}var l=-e.dot(o,i);if(!t(s)){return new a(o,l)}e.clone(o,s.normal);s.distance=l;return s};var o=new e;a.fromCartesian4=function(i,s){if(!t(i)){throw new r("coefficients is required.")}var l=e.fromCartesian4(i,o);var u=i.w;if(!n.equalsEpsilon(e.magnitude(l),1,n.EPSILON6)){throw new r("normal must be normalized.")}if(!t(s)){return new a(l,u)}e.clone(l,s.normal);s.distance=u;return s};a.getPointDistance=function(i,n){if(!t(i)){throw new r("plane is required.")}if(!t(n)){throw new r("point is required.")}return e.dot(i.normal,n)+i.distance};a.ORIGIN_XY_PLANE=i(new a(e.UNIT_Z,0));a.ORIGIN_YZ_PLANE=i(new a(e.UNIT_X,0));a.ORIGIN_ZX_PLANE=i(new a(e.UNIT_Y,0));return a});define("Core/EarthOrientationParametersSample",[],function(){"use strict";function e(e,t,r,i,n){this.xPoleWander=e;this.yPoleWander=t;this.xPoleOffset=r;this.yPoleOffset=i;this.ut1MinusUtc=n}return e});define("ThirdParty/sprintf",[],function(){function e(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g;var t=arguments,r=0,i=t[r++];var n=function(e,t,r,i){if(!r){r=" "}var n=e.length>=t?"":Array(1+t-e.length>>>0).join(r);return i?e+n:n+e};var a=function(e,t,r,i,a,o){var s=i-e.length;if(s>0){if(r||!a){e=n(e,i,o,r)}else{e=e.slice(0,t.length)+n("",s,"0",true)+e.slice(t.length)}}return e};var o=function(e,t,r,i,o,s,l){var u=e>>>0;r=r&&u&&{2:"0b",8:"0",16:"0x"}[t]||"";e=r+n(u.toString(t),s||0,"0",false);return a(e,r,i,o,l)};var s=function(e,t,r,i,n,o){if(i!=null){e=e.slice(0,i)}return a(e,"",t,r,n,o)};var l=function(e,i,l,u,c,d,f){var h;var p;var m;var v;var g;if(e=="%%"){return"%"}var _=false,y="",b=false,w=false,C=" ";var S=l.length;for(var T=0;l&&T<S;T++){switch(l.charAt(T)){case" ":y=" ";break;case"+":y="+";break;case"-":_=true;break;case"'":C=l.charAt(T+1);break;case"0":b=true;break;case"#":w=true;break}}if(!u){u=0}else if(u=="*"){u=+t[r++]}else if(u.charAt(0)=="*"){u=+t[u.slice(1,-1)]}else{u=+u}if(u<0){u=-u;_=true}if(!isFinite(u)){throw new Error("sprintf: (minimum-)width must be finite")}if(!d){d="fFeE".indexOf(f)>-1?6:f=="d"?0:undefined}else if(d=="*"){d=+t[r++]}else if(d.charAt(0)=="*"){d=+t[d.slice(1,-1)]}else{d=+d}g=i?t[i.slice(0,-1)]:t[r++];switch(f){case"s":return s(String(g),_,u,d,b,C);case"c":return s(String.fromCharCode(+g),_,u,d,b);case"b":return o(g,2,w,_,u,d,b);case"o":return o(g,8,w,_,u,d,b);case"x":return o(g,16,w,_,u,d,b);case"X":return o(g,16,w,_,u,d,b).toUpperCase();case"u":return o(g,10,w,_,u,d,b);case"i":case"d":h=+g||0;h=Math.round(h-h%1);p=h<0?"-":y;g=p+n(String(Math.abs(h)),d,"0",false);return a(g,p,_,u,b);case"e":case"E":case"f":case"F":case"g":case"G":h=+g;p=h<0?"-":y;m=["toExponential","toFixed","toPrecision"]["efg".indexOf(f.toLowerCase())];v=["toString","toUpperCase"]["eEfFgG".indexOf(f)%2];g=p+Math.abs(h)[m](d);return a(g,p,_,u,b)[v]();default:return e}};return i.replace(e,l)}return e});define("Core/GregorianDate",[],function(){"use strict";function e(e,t,r,i,n,a,o,s){this.year=e;this.month=t;this.day=r;this.hour=i;this.minute=n;this.second=a;this.millisecond=o;this.isLeapSecond=s}return e});define("Core/isLeapYear",["./DeveloperError"],function(e){"use strict";function t(t){if(t===null||isNaN(t)){throw new e("year is required and must be a number.")}return t%4===0&&t%100!==0||t%400===0}return t});define("Core/LeapSecond",[],function(){"use strict";function e(e,t){this.julianDate=e;this.offset=t}return e});define("Core/TimeConstants",["./freezeObject"],function(e){"use strict";var t={SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5};return e(t)});define("Core/TimeStandard",["./freezeObject"],function(e){"use strict";var t={UTC:0,TAI:1};return e(t)});define("Core/JulianDate",["../ThirdParty/sprintf","./binarySearch","./defaultValue","./defined","./DeveloperError","./GregorianDate","./isLeapYear","./LeapSecond","./TimeConstants","./TimeStandard"],function(e,t,r,i,n,a,o,s,l,u){"use strict";var c=new a;var d=[31,28,31,30,31,30,31,31,30,31,30,31];var f=29;function h(e,t){return O.compare(e.julianDate,t.julianDate)}var p=new s;function m(e){p.julianDate=e;var r=O.leapSeconds;var i=t(r,p,h);if(i<0){i=~i}if(i>=r.length){i=r.length-1}var n=r[i].offset;if(i>0){var a=O.secondsDifference(r[i].julianDate,e);if(a>n){i--;n=r[i].offset}}O.addSeconds(e,n,e)}function v(e,r){p.julianDate=e;var i=O.leapSeconds;var n=t(i,p,h);if(n<0){n=~n}if(n===0){return O.addSeconds(e,-i[0].offset,r)}if(n>=i.length){return O.addSeconds(e,-i[n-1].offset,r)}var a=O.secondsDifference(i[n].julianDate,e);if(a===0){return O.addSeconds(e,-i[n].offset,r)}if(a<=1){return undefined}return O.addSeconds(e,-i[--n].offset,r)}function g(e,t,r){var i=t/l.SECONDS_PER_DAY|0;e+=i;t-=l.SECONDS_PER_DAY*i;if(t<0){e--;t+=l.SECONDS_PER_DAY}r.dayNumber=e;r.secondsOfDay=t;return r}function _(e,t,r,i,n,a,o){var s=(t-14)/12|0;var u=e+4800+s;var c=(1461*u/4|0)+(367*(t-2-12*s)/12|0)-(3*((u+100)/100|0)/4|0)+r-32075;i=i-12;if(i<0){i+=24}var d=a+(i*l.SECONDS_PER_HOUR+n*l.SECONDS_PER_MINUTE+o*l.SECONDS_PER_MILLISECOND);if(d>=43200){c-=1}return[c,d]}var y=/^(\d{4})$/;var b=/^(\d{4})-(\d{2})$/;var w=/^(\d{4})-?(\d{3})$/;var C=/^(\d{4})-?W(\d{2})-?(\d{1})?$/;var S=/^(\d{4})-?(\d{2})-?(\d{2})$/;var T=/([Z+\-])?(\d{2})?:?(\d{2})?$/;var E=/^(\d{2})(\.\d+)?/.source+T.source;var x=/^(\d{2}):?(\d{2})(\.\d+)?/.source+T.source;var P=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+T.source;var A="Invalid ISO 8601 date.";function O(e,t,i){this.dayNumber=undefined;this.secondsOfDay=undefined;e=r(e,0);t=r(t,0);i=r(i,u.UTC);var n=e|0;t=t+(e-n)*l.SECONDS_PER_DAY;g(n,t,this);if(i===u.UTC){m(this)}}O.fromGregorianDate=function(e,t){if(!(e instanceof a)){throw new n("date must be a valid GregorianDate.")}var r=_(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);if(!i(t)){return new O(r[0],r[1],u.UTC)}g(r[0],r[1],t);m(t);return t};O.fromDate=function(e,t){if(!(e instanceof Date)||isNaN(e.getTime())){throw new n("date must be a valid JavaScript Date.")}var r=_(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());if(!i(t)){return new O(r[0],r[1],u.UTC)}g(r[0],r[1],t);m(t);return t};O.fromIso8601=function(e,t){if(typeof e!=="string"){throw new n(A)}e=e.replace(",",".");var r=e.split("T");var a;var s=1;var l=1;var c=0;var h=0;var p=0;var v=0;var T=r[0];var D=r[1];var I;var M;if(!i(T)){throw new n(A)}var R;r=T.match(S);if(r!==null){R=T.split("-").length-1;if(R>0&&R!==2){throw new n(A)}a=+r[1];s=+r[2];l=+r[3]}else{r=T.match(b);if(r!==null){a=+r[1];s=+r[2]}else{r=T.match(y);if(r!==null){a=+r[1]}else{var L;r=T.match(w);if(r!==null){a=+r[1];L=+r[2];M=o(a);if(L<1||M&&L>366||!M&&L>365){throw new n(A)}}else{r=T.match(C);if(r!==null){a=+r[1];var N=+r[2];var k=+r[3]||0;R=T.split("-").length-1;if(R>0&&(!i(r[3])&&R!==1||i(r[3])&&R!==2)){throw new n(A)}var F=new Date(Date.UTC(a,0,4));L=N*7+k-F.getUTCDay()-3}else{throw new n(A)}}I=new Date(Date.UTC(a,0,1));I.setUTCDate(L);s=I.getUTCMonth()+1;l=I.getUTCDate()}}}M=o(a);if(s<1||s>12||l<1||(s!==2||!M)&&l>d[s-1]||M&&s===2&&l>f){throw new n(A)}var B;if(i(D)){r=D.match(P);if(r!==null){R=D.split(":").length-1;if(R>0&&R!==2&&R!==3){throw new n(A)}c=+r[1];h=+r[2];p=+r[3];v=+(r[4]||0)*1e3;B=5}else{r=D.match(x);if(r!==null){R=D.split(":").length-1;if(R>2){throw new n(A)}c=+r[1];h=+r[2];p=+(r[3]||0)*60;B=4}else{r=D.match(E);if(r!==null){c=+r[1];h=+(r[2]||0)*60;B=3}else{throw new n(A)}}}if(h>=60||p>=61||c>24||c===24&&(h>0||p>0||v>0)){throw new n(A)}var U=r[B];var V=+r[B+1];var z=+(r[B+2]||0);switch(U){case"+":c=c-V;h=h-z;break;case"-":c=c+V;h=h+z;break;case"Z":break;default:h=h+new Date(Date.UTC(a,s-1,l,c,h)).getTimezoneOffset();break}}var q=p===60;if(q){p--}while(h>=60){h-=60;c++}while(c>=24){c-=24;l++}I=M&&s===2?f:d[s-1];while(l>I){l-=I;s++;if(s>12){s-=12;a++}I=M&&s===2?f:d[s-1]}while(h<0){h+=60;c--}while(c<0){c+=24;l--}while(l<1){s--;if(s<1){s+=12;a--}I=M&&s===2?f:d[s-1];l+=I}var G=_(a,s,l,c,h,p,v);if(!i(t)){t=new O(G[0],G[1],u.UTC)}else{g(G[0],G[1],t);m(t)}if(q){O.addSeconds(t,1,t)}return t};O.now=function(e){return O.fromDate(new Date,e)};var D=new O(0,0,u.TAI);O.toGregorianDate=function(e,t){if(!i(e)){throw new n("julianDate is required.")}var r=false;var o=v(e,D);if(!i(o)){O.addSeconds(e,-1,D);o=v(D,D);r=true}var s=o.dayNumber;var u=o.secondsOfDay;if(u>=43200){s+=1}var c=s+68569|0;var d=4*c/146097|0;c=c-((146097*d+3)/4|0)|0;var f=4e3*(c+1)/1461001|0;c=c-(1461*f/4|0)+31|0;var h=80*c/2447|0;var p=c-(2447*h/80|0)|0;c=h/11|0;var m=h+2-12*c|0;var g=100*(d-49)+f+c|0;var _=u/l.SECONDS_PER_HOUR|0;var y=u-_*l.SECONDS_PER_HOUR;var b=y/l.SECONDS_PER_MINUTE|0;y=y-b*l.SECONDS_PER_MINUTE;var w=y|0;var C=(y-w)/l.SECONDS_PER_MILLISECOND;_+=12;if(_>23){_-=24}if(r){w+=1}if(!i(t)){return new a(g,m,p,_,b,w,C,r)}t.year=g;t.month=m;t.day=p;t.hour=_;t.minute=b;t.second=w;t.millisecond=C;t.isLeapSecond=r;return t};O.toDate=function(e){if(!i(e)){throw new n("julianDate is required.")}var t=O.toGregorianDate(e,c);var r=t.second;if(t.isLeapSecond){r-=1}return new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,r,t.millisecond))};O.toIso8601=function(t,r){if(!i(t)){throw new n("julianDate is required.")}var a=O.toGregorianDate(t,c);var o;if(!i(r)&&a.millisecond!==0){o=(a.millisecond*.01).toString().replace(".","");return e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",a.year,a.month,a.day,a.hour,a.minute,a.second,o)}if(!i(r)||r===0){return e("%04d-%02d-%02dT%02d:%02d:%02dZ",a.year,a.month,a.day,a.hour,a.minute,a.second)}o=(a.millisecond*.01).toFixed(r).replace(".","").slice(0,r);return e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",a.year,a.month,a.day,a.hour,a.minute,a.second,o)};O.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new O(e.dayNumber,e.secondsOfDay,u.TAI)}t.dayNumber=e.dayNumber;t.secondsOfDay=e.secondsOfDay;return t};O.compare=function(e,t){if(!i(e)){throw new n("left is required.")}if(!i(t)){throw new n("right is required.")}var r=e.dayNumber-t.dayNumber;if(r!==0){return r}return e.secondsOfDay-t.secondsOfDay};O.equals=function(e,t){return e===t||i(e)&&i(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay};O.equalsEpsilon=function(e,t,r){if(!i(r)){throw new n("epsilon is required.")}return e===t||i(e)&&i(t)&&Math.abs(O.secondsDifference(e,t))<=r};O.totalDays=function(e){if(!i(e)){throw new n("julianDate is required.")}return e.dayNumber+e.secondsOfDay/l.SECONDS_PER_DAY};O.secondsDifference=function(e,t){if(!i(e)){throw new n("left is required.")}if(!i(t)){throw new n("right is required.")}var r=(e.dayNumber-t.dayNumber)*l.SECONDS_PER_DAY;return r+(e.secondsOfDay-t.secondsOfDay)};O.daysDifference=function(e,t){if(!i(e)){throw new n("left is required.")}if(!i(t)){throw new n("right is required.")}var r=e.dayNumber-t.dayNumber;var a=(e.secondsOfDay-t.secondsOfDay)/l.SECONDS_PER_DAY;return r+a};O.computeTaiMinusUtc=function(e){p.julianDate=e;var r=O.leapSeconds;var i=t(r,p,h);if(i<0){i=~i;--i;if(i<0){i=0}}return r[i].offset};O.addSeconds=function(e,t,r){if(!i(e)){throw new n("julianDate is required.")}if(!i(t)){throw new n("seconds is required.")}if(!i(r)){throw new n("result is required.")}return g(e.dayNumber,e.secondsOfDay+t,r)};O.addMinutes=function(e,t,r){if(!i(e)){throw new n("julianDate is required.")}if(!i(t)){throw new n("minutes is required.")}if(!i(r)){throw new n("result is required.")}var a=e.secondsOfDay+t*l.SECONDS_PER_MINUTE;return g(e.dayNumber,a,r)};O.addHours=function(e,t,r){if(!i(e)){throw new n("julianDate is required.")}if(!i(t)){throw new n("hours is required.")}if(!i(r)){throw new n("result is required.")}var a=e.secondsOfDay+t*l.SECONDS_PER_HOUR;return g(e.dayNumber,a,r)};O.addDays=function(e,t,r){if(!i(e)){throw new n("julianDate is required.")}if(!i(t)){throw new n("days is required.")}if(!i(r)){throw new n("result is required.")}var a=e.dayNumber+t;return g(a,e.secondsOfDay,r)};O.lessThan=function(e,t){return O.compare(e,t)<0};O.lessThanOrEquals=function(e,t){return O.compare(e,t)<=0};O.greaterThan=function(e,t){return O.compare(e,t)>0};O.greaterThanOrEquals=function(e,t){return O.compare(e,t)>=0};O.prototype.clone=function(e){return O.clone(this,e)};O.prototype.equals=function(e){return O.equals(this,e)};O.prototype.equalsEpsilon=function(e,t){return O.equalsEpsilon(this,e,t)};O.prototype.toString=function(){return O.toIso8601(this)};O.leapSeconds=[new s(new O(2441317,43210,u.TAI),10),new s(new O(2441499,43211,u.TAI),11),new s(new O(2441683,43212,u.TAI),12),new s(new O(2442048,43213,u.TAI),13),new s(new O(2442413,43214,u.TAI),14),new s(new O(2442778,43215,u.TAI),15),new s(new O(2443144,43216,u.TAI),16),new s(new O(2443509,43217,u.TAI),17),new s(new O(2443874,43218,u.TAI),18),new s(new O(2444239,43219,u.TAI),19),new s(new O(2444786,43220,u.TAI),20),new s(new O(2445151,43221,u.TAI),21),new s(new O(2445516,43222,u.TAI),22),new s(new O(2446247,43223,u.TAI),23),new s(new O(2447161,43224,u.TAI),24),new s(new O(2447892,43225,u.TAI),25),new s(new O(2448257,43226,u.TAI),26),new s(new O(2448804,43227,u.TAI),27),new s(new O(2449169,43228,u.TAI),28),new s(new O(2449534,43229,u.TAI),29),new s(new O(2450083,43230,u.TAI),30),new s(new O(2450630,43231,u.TAI),31),new s(new O(2451179,43232,u.TAI),32),new s(new O(2453736,43233,u.TAI),33),new s(new O(2454832,43234,u.TAI),34),new s(new O(2456109,43235,u.TAI),35),new s(new O(2457204,43236,u.TAI),36),new s(new O(2457754,43237,u.TAI),37)];return O});define("Core/parseResponseHeaders",[],function(){"use strict";function e(e){var t={};if(!e){return t}var r=e.split("\r\n");for(var i=0;i<r.length;++i){var n=r[i];var a=n.indexOf(": ");if(a>0){var o=n.substring(0,a);var s=n.substring(a+2);t[o]=s}}return t}return e});define("Core/RequestErrorEvent",["./defined","./parseResponseHeaders"],function(e,t){"use strict";function r(e,r,i){this.statusCode=e;this.response=r;this.responseHeaders=i;if(typeof this.responseHeaders==="string"){this.responseHeaders=t(this.responseHeaders)}}r.prototype.toString=function(){var t="Request has failed.";if(e(this.statusCode)){t+=" Status Code: "+this.statusCode}return t};return r});define("Core/TrustedServers",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};var n={};i.add=function(e,i){if(!t(e)){throw new r("host is required.")}if(!t(i)||i<=0){throw new r("port is required to be greater than 0.")}var a=e.toLowerCase()+":"+i;if(!t(n[a])){n[a]=true}};i.remove=function(e,i){if(!t(e)){throw new r("host is required.")}if(!t(i)||i<=0){throw new r("port is required to be greater than 0.")}var a=e.toLowerCase()+":"+i;if(t(n[a])){delete n[a]}};function a(r){var i=new e(r);i.normalize();var n=i.getAuthority();if(!t(n)){return undefined}if(n.indexOf("@")!==-1){var a=n.split("@");n=a[1]}if(n.indexOf(":")===-1){var o=i.getScheme();if(!t(o)){o=window.location.protocol;o=o.substring(0,o.length-1)}if(o==="http"){n+=":80"}else if(o==="https"){n+=":443"}else{return undefined}}return n}i.contains=function(e){if(!t(e)){throw new r("url is required.")}var i=a(e);if(t(i)&&t(n[i])){return true}return false};i.clear=function(){n={}};return i});define("Core/loadWithXhr",["../ThirdParty/when","./Check","./defaultValue","./defined","./deprecationWarning","./DeveloperError","./Request","./RequestErrorEvent","./RequestScheduler","./RuntimeError","./TrustedServers"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";function d(e){e=r(e,r.EMPTY_OBJECT);t.defined("options.url",e.url);var i=e.url;if(typeof i!=="string"){n("url promise","options.url as a Promise is deprecated and will be removed in Cesium 1.37");return i.then(function(t){return f(e,t)})}return f(e)}function f(t,n){var a=t.responseType;var s=r(t.method,"GET");var u=t.data;var c=t.headers;var f=t.overrideMimeType;n=r(n,t.url);var h=i(t.request)?t.request:new o;h.url=n;h.requestFunction=function(){var t=e.defer();var r=d.load(n,a,s,u,c,t,f);if(i(r)&&i(r.abort)){h.cancelFunction=function(){r.abort()}}return t.promise};return l.request(h)}var h=/^data:(.*?)(;base64)?,(.*)$/;function p(e,t){var r=decodeURIComponent(t);if(e){return atob(r)}return r}function m(e,t){var r=p(e,t);var i=new ArrayBuffer(r.length);var n=new Uint8Array(i);for(var a=0;a<r.length;a++){n[a]=r.charCodeAt(a)}return i}function v(e,t){t=r(t,"");var i=e[1];var n=!!e[2];var o=e[3];switch(t){case"":case"text":return p(n,o);case"arraybuffer":return m(n,o);case"blob":var s=m(n,o);return new Blob([s],{type:i});case"document":var l=new DOMParser;return l.parseFromString(p(n,o),i);case"json":return JSON.parse(p(n,o));default:throw new a("Unhandled responseType: "+t)}}d.load=function(e,t,r,n,a,o,l){var d=h.exec(e);if(d!==null){o.resolve(v(d,t));return}var f=new XMLHttpRequest;if(c.contains(e)){f.withCredentials=true}if(i(l)&&i(f.overrideMimeType)){f.overrideMimeType(l)}f.open(r,e,true);if(i(a)){for(var p in a){if(a.hasOwnProperty(p)){f.setRequestHeader(p,a[p])}}}if(i(t)){f.responseType=t}f.onload=function(){if(f.status<200||f.status>=300){o.reject(new s(f.status,f.response,f.getAllResponseHeaders()));return}var e=f.response;var r=f.responseType;if(i(e)&&(!i(t)||r===t)){o.resolve(e)}else if(t==="json"&&typeof e==="string"){try{o.resolve(JSON.parse(e))}catch(e){o.reject(e)}}else if((r===""||r==="document")&&i(f.responseXML)&&f.responseXML.hasChildNodes()){o.resolve(f.responseXML)}else if((r===""||r==="text")&&i(f.responseText)){o.resolve(f.responseText)}else{o.reject(new u("Invalid XMLHttpRequest response type."))}};f.onerror=function(e){o.reject(new s)};f.send(n);return f};d.defaultLoad=d.load;return d});define("Core/loadText",["./loadWithXhr"],function(e){"use strict";function t(t,r,i){return e({url:t,headers:r,request:i})}return t});define("Core/loadJson",["./clone","./defined","./DeveloperError","./loadText"],function(e,t,r,i){"use strict";var n={Accept:"application/json,*/*;q=0.01"};function a(a,o,s){if(!t(a)){throw new r("url is required.")}if(!t(o)){o=n}else if(!t(o.Accept)){o=e(o);o.Accept=n.Accept}var l=i(a,o,s);if(!t(l)){return undefined}return l.then(function(e){return JSON.parse(e)})}return a});define("Core/EarthOrientationParameters",["../ThirdParty/when","./binarySearch","./defaultValue","./defined","./EarthOrientationParametersSample","./freezeObject","./JulianDate","./LeapSecond","./loadJson","./RuntimeError","./TimeConstants","./TimeStandard"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(t){t=r(t,r.EMPTY_OBJECT);this._dates=undefined;this._samples=undefined;this._dateColumn=-1;this._xPoleWanderRadiansColumn=-1;this._yPoleWanderRadiansColumn=-1;this._ut1MinusUtcSecondsColumn=-1;this._xCelestialPoleOffsetRadiansColumn=-1;this._yCelestialPoleOffsetRadiansColumn=-1;this._taiMinusUtcSecondsColumn=-1;this._columnCount=0;this._lastIndex=-1;this._downloadPromise=undefined;this._dataError=undefined;this._addNewLeapSeconds=r(t.addNewLeapSeconds,true);if(i(t.data)){p(this,t.data)}else if(i(t.url)){var n=this;this._downloadPromise=e(l(t.url),function(e){p(n,e)},function(){n._dataError="An error occurred while retrieving the EOP data from the URL "+t.url+"."})}else{p(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}}f.NONE=a({getPromiseToLoad:function(){return e()},compute:function(e,t){if(!i(t)){t=new n(0,0,0,0,0)}else{t.xPoleWander=0;t.yPoleWander=0;t.xPoleOffset=0;t.yPoleOffset=0;t.ut1MinusUtc=0}return t}});f.prototype.getPromiseToLoad=function(){return e(this._downloadPromise)};f.prototype.compute=function(e,r){if(!i(this._samples)){if(i(this._dataError)){throw new u(this._dataError)}return undefined}if(!i(r)){r=new n(0,0,0,0,0)}if(this._samples.length===0){r.xPoleWander=0;r.yPoleWander=0;r.xPoleOffset=0;r.yPoleOffset=0;r.ut1MinusUtc=0;return r}var a=this._dates;var s=this._lastIndex;var l=0;var c=0;if(i(s)){var d=a[s];var f=a[s+1];var h=o.lessThanOrEquals(d,e);var p=!i(f);var m=p||o.greaterThanOrEquals(f,e);if(h&&m){l=s;if(!p&&f.equals(e)){++l}c=l+1;g(this,a,this._samples,e,l,c,r);return r}}var v=t(a,e,o.compare,this._dateColumn);if(v>=0){if(v<a.length-1&&a[v+1].equals(e)){++v}l=v;c=v}else{c=~v;l=c-1;if(l<0){l=0}}this._lastIndex=l;g(this,a,this._samples,e,l,c,r);return r};function h(e,t){return o.compare(e.julianDate,t)}function p(e,r){if(!i(r.columnNames)){e._dataError="Error in loaded EOP data: The columnNames property is required.";return}if(!i(r.samples)){e._dataError="Error in loaded EOP data: The samples property is required.";return}var n=r.columnNames.indexOf("modifiedJulianDateUtc");var a=r.columnNames.indexOf("xPoleWanderRadians");var l=r.columnNames.indexOf("yPoleWanderRadians");var u=r.columnNames.indexOf("ut1MinusUtcSeconds");var f=r.columnNames.indexOf("xCelestialPoleOffsetRadians");var p=r.columnNames.indexOf("yCelestialPoleOffsetRadians");var m=r.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||a<0||l<0||u<0||f<0||p<0||m<0){e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";return}var v=e._samples=r.samples;var g=e._dates=[];e._dateColumn=n;e._xPoleWanderRadiansColumn=a;e._yPoleWanderRadiansColumn=l;e._ut1MinusUtcSecondsColumn=u;e._xCelestialPoleOffsetRadiansColumn=f;e._yCelestialPoleOffsetRadiansColumn=p;e._taiMinusUtcSecondsColumn=m;e._columnCount=r.columnNames.length;e._lastIndex=undefined;var _;var y=e._addNewLeapSeconds;for(var b=0,w=v.length;b<w;b+=e._columnCount){var C=v[b+n];var S=v[b+m];var T=C+c.MODIFIED_JULIAN_DATE_DIFFERENCE;var E=new o(T,S,d.TAI);g.push(E);if(y){if(S!==_&&i(_)){var x=o.leapSeconds;var P=t(x,E,h);if(P<0){var A=new s(E,S);x.splice(~P,0,A)}}_=S}}}function m(e,t,r,i,n){var a=r*i;n.xPoleWander=t[a+e._xPoleWanderRadiansColumn];n.yPoleWander=t[a+e._yPoleWanderRadiansColumn];n.xPoleOffset=t[a+e._xCelestialPoleOffsetRadiansColumn];n.yPoleOffset=t[a+e._yCelestialPoleOffsetRadiansColumn];n.ut1MinusUtc=t[a+e._ut1MinusUtcSecondsColumn]}function v(e,t,r){return t+e*(r-t)}function g(e,t,r,i,n,a,s){var l=e._columnCount;if(a>t.length-1){s.xPoleWander=0;s.yPoleWander=0;s.xPoleOffset=0;s.yPoleOffset=0;s.ut1MinusUtc=0;return s}var u=t[n];var c=t[a];if(u.equals(c)||i.equals(u)){m(e,r,n,l,s);return s}else if(i.equals(c)){m(e,r,a,l,s);return s}var d=o.secondsDifference(i,u)/o.secondsDifference(c,u);var f=n*l;var h=a*l;var p=r[f+e._ut1MinusUtcSecondsColumn];var g=r[h+e._ut1MinusUtcSecondsColumn];var _=g-p;if(_>.5||_<-.5){var y=r[f+e._taiMinusUtcSecondsColumn];var b=r[h+e._taiMinusUtcSecondsColumn];if(y!==b){if(c.equals(i)){p=g}else{g-=b-y}}}s.xPoleWander=v(d,r[f+e._xPoleWanderRadiansColumn],r[h+e._xPoleWanderRadiansColumn]);s.yPoleWander=v(d,r[f+e._yPoleWanderRadiansColumn],r[h+e._yPoleWanderRadiansColumn]);s.xPoleOffset=v(d,r[f+e._xCelestialPoleOffsetRadiansColumn],r[h+e._xCelestialPoleOffsetRadiansColumn]);s.yPoleOffset=v(d,r[f+e._yCelestialPoleOffsetRadiansColumn],r[h+e._yCelestialPoleOffsetRadiansColumn]);s.ut1MinusUtc=v(d,p,g);return s}return f});define("Core/Iau2006XysSample",[],function(){"use strict";function e(e,t,r){this.x=e;this.y=t;this.s=r}return e});define("Core/Iau2006XysData",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./Iau2006XysSample","./JulianDate","./loadJson","./TimeStandard"],function(e,t,r,i,n,a,o,s){"use strict";function l(e){e=r(e,r.EMPTY_OBJECT);this._xysFileUrlTemplate=e.xysFileUrlTemplate;this._interpolationOrder=r(e.interpolationOrder,9);this._sampleZeroJulianEphemerisDate=r(e.sampleZeroJulianEphemerisDate,2442396.5);this._sampleZeroDateTT=new a(this._sampleZeroJulianEphemerisDate,0,s.TAI);this._stepSizeDays=r(e.stepSizeDays,1);this._samplesPerXysFile=r(e.samplesPerXysFile,1e3);this._totalSamples=r(e.totalSamples,27426);this._samples=new Array(this._totalSamples*3);this._chunkDownloadsInProgress=[];var t=this._interpolationOrder;var i=this._denominators=new Array(t+1);var n=this._xTable=new Array(t+1);var o=Math.pow(this._stepSizeDays,t);for(var l=0;l<=t;++l){i[l]=o;n[l]=l*this._stepSizeDays;for(var u=0;u<=t;++u){if(u!==l){i[l]*=l-u}}i[l]=1/i[l]}this._work=new Array(t+1);this._coef=new Array(t+1)}var u=new a(0,0,s.TAI);function c(e,t,r){var i=u;i.dayNumber=t;i.secondsOfDay=r;return a.daysDifference(i,e._sampleZeroDateTT)}l.prototype.preload=function(t,r,i,n){var a=c(this,t,r);var o=c(this,i,n);var s=a/this._stepSizeDays-this._interpolationOrder/2|0;if(s<0){s=0}var l=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;if(l>=this._totalSamples){l=this._totalSamples-1}var u=s/this._samplesPerXysFile|0;var f=l/this._samplesPerXysFile|0;var h=[];for(var p=u;p<=f;++p){h.push(d(this,p))}return e.all(h)};l.prototype.computeXysRadians=function(e,t,r){var a=c(this,e,t);if(a<0){return undefined}var o=a/this._stepSizeDays|0;if(o>=this._totalSamples){return undefined}var s=this._interpolationOrder;var l=o-(s/2|0);if(l<0){l=0}var u=l+s;if(u>=this._totalSamples){u=this._totalSamples-1;l=u-s;if(l<0){l=0}}var f=false;var h=this._samples;if(!i(h[l*3])){d(this,l/this._samplesPerXysFile|0);f=true}if(!i(h[u*3])){d(this,u/this._samplesPerXysFile|0);f=true}if(f){return undefined}if(!i(r)){r=new n(0,0,0)}else{r.x=0;r.y=0;r.s=0}var p=a-l*this._stepSizeDays;var m=this._work;var v=this._denominators;var g=this._coef;var _=this._xTable;var y,b;for(y=0;y<=s;++y){m[y]=p-_[y]}for(y=0;y<=s;++y){g[y]=1;for(b=0;b<=s;++b){if(b!==y){g[y]*=m[b]}}g[y]*=v[y];var w=(l+y)*3;r.x+=g[y]*h[w++];r.y+=g[y]*h[w++];r.s+=g[y]*h[w]}return r};function d(r,n){if(r._chunkDownloadsInProgress[n]){return r._chunkDownloadsInProgress[n]}var a=e.defer();r._chunkDownloadsInProgress[n]=a;var s;var l=r._xysFileUrlTemplate;if(i(l)){s=l.replace("{0}",n)}else{s=t("Assets/IAU2006_XYS/IAU2006_XYS_"+n+".json")}e(o(s),function(e){r._chunkDownloadsInProgress[n]=false;var t=r._samples;var i=e.samples;var o=n*r._samplesPerXysFile*3;for(var s=0,l=i.length;s<l;++s){t[o+s]=i[s]}a.resolve()});return a.promise}return l});define("Core/HeadingPitchRoll",["./defaultValue","./defined","./DeveloperError","./Math"],function(e,t,r,i){"use strict";function n(t,r,i){this.heading=e(t,0);this.pitch=e(r,0);this.roll=e(i,0)}n.fromQuaternion=function(e,i){if(!t(e)){throw new r("quaternion is required")}if(!t(i)){i=new n}var a=2*(e.w*e.y-e.z*e.x);var o=1-2*(e.x*e.x+e.y*e.y);var s=2*(e.w*e.x+e.y*e.z);var l=1-2*(e.y*e.y+e.z*e.z);var u=2*(e.w*e.z+e.x*e.y);i.heading=-Math.atan2(u,l);i.roll=Math.atan2(s,o);i.pitch=-Math.asin(a);return i};n.fromDegrees=function(e,a,o,s){if(!t(e)){throw new r("heading is required")}if(!t(a)){throw new r("pitch is required")}if(!t(o)){throw new r("roll is required")}if(!t(s)){s=new n}s.heading=e*i.RADIANS_PER_DEGREE;s.pitch=a*i.RADIANS_PER_DEGREE;s.roll=o*i.RADIANS_PER_DEGREE;return s};n.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){return new n(e.heading,e.pitch,e.roll)}r.heading=e.heading;r.pitch=e.pitch;r.roll=e.roll;return r};n.equals=function(e,r){return e===r||t(e)&&t(r)&&e.heading===r.heading&&e.pitch===r.pitch&&e.roll===r.roll};n.equalsEpsilon=function(e,r,n,a){return e===r||t(e)&&t(r)&&i.equalsEpsilon(e.heading,r.heading,n,a)&&i.equalsEpsilon(e.pitch,r.pitch,n,a)&&i.equalsEpsilon(e.roll,r.roll,n,a)};n.prototype.clone=function(e){return n.clone(this,e)};n.prototype.equals=function(e){return n.equals(this,e)};n.prototype.equalsEpsilon=function(e,t,r){return n.equalsEpsilon(this,e,t,r)};n.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"};return n});define("Core/Quaternion",["./Cartesian3","./Check","./defaultValue","./defined","./FeatureDetection","./freezeObject","./HeadingPitchRoll","./Math","./Matrix3"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(e,t,i,n){this.x=r(e,0);this.y=r(t,0);this.z=r(i,0);this.w=r(n,0)}var c=new e;u.fromAxisAngle=function(r,n,a){t.typeOf.object("axis",r);t.typeOf.number("angle",n);var o=n/2;var s=Math.sin(o);c=e.normalize(r,c);var l=c.x*s;var d=c.y*s;var f=c.z*s;var h=Math.cos(o);if(!i(a)){return new u(l,d,f,h)}a.x=l;a.y=d;a.z=f;a.w=h;return a};var d=[1,2,0];var f=new Array(3);u.fromRotationMatrix=function(e,r){t.typeOf.object("matrix",e);var n;var a;var o;var s;var c;var h=e[l.COLUMN0ROW0];var p=e[l.COLUMN1ROW1];var m=e[l.COLUMN2ROW2];var v=h+p+m;if(v>0){n=Math.sqrt(v+1);c=.5*n;n=.5/n;a=(e[l.COLUMN1ROW2]-e[l.COLUMN2ROW1])*n;o=(e[l.COLUMN2ROW0]-e[l.COLUMN0ROW2])*n;s=(e[l.COLUMN0ROW1]-e[l.COLUMN1ROW0])*n}else{var g=d;var _=0;if(p>h){_=1}if(m>h&&m>p){_=2}var y=g[_];var b=g[y];n=Math.sqrt(e[l.getElementIndex(_,_)]-e[l.getElementIndex(y,y)]-e[l.getElementIndex(b,b)]+1);var w=f;w[_]=.5*n;n=.5/n;c=(e[l.getElementIndex(b,y)]-e[l.getElementIndex(y,b)])*n;w[y]=(e[l.getElementIndex(y,_)]+e[l.getElementIndex(_,y)])*n;w[b]=(e[l.getElementIndex(b,_)]+e[l.getElementIndex(_,b)])*n;a=-w[0];o=-w[1];s=-w[2]}if(!i(r)){return new u(a,o,s,c)}r.x=a;r.y=o;r.z=s;r.w=c;return r};var h=new u;var p=new u;var m=new u;var v=new u;u.fromHeadingPitchRoll=function(r,i){t.typeOf.object("headingPitchRoll",r);v=u.fromAxisAngle(e.UNIT_X,r.roll,h);m=u.fromAxisAngle(e.UNIT_Y,-r.pitch,i);i=u.multiply(m,v,m);p=u.fromAxisAngle(e.UNIT_Z,-r.heading,h);return u.multiply(p,i,i)};var g=new e;var _=new e;var y=new u;var b=new u;var w=new u;u.packedLength=4;u.pack=function(e,i,n){t.typeOf.object("value",e);t.defined("array",i);n=r(n,0);i[n++]=e.x;i[n++]=e.y;i[n++]=e.z;i[n]=e.w;return i};u.unpack=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new u}a.x=e[n];a.y=e[n+1];a.z=e[n+2];a.w=e[n+3];return a};u.packedInterpolationLength=3;u.convertPackedArrayForInterpolation=function(e,t,r,i){u.unpack(e,r*4,w);u.conjugate(w,w);for(var n=0,a=r-t+1;n<a;n++){var o=n*3;u.unpack(e,(t+n)*4,y);u.multiply(y,w,y);if(y.w<0){u.negate(y,y)}u.computeAxis(y,g);var s=u.computeAngle(y);i[o]=g.x*s;i[o+1]=g.y*s;i[o+2]=g.z*s}};u.unpackInterpolationResult=function(t,r,n,a,o){if(!i(o)){o=new u}e.fromArray(t,0,_);var s=e.magnitude(_);u.unpack(r,a*4,b);if(s===0){u.clone(u.IDENTITY,y)}else{u.fromAxisAngle(_,s,y)}return u.multiply(y,b,o)};u.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new u(e.x,e.y,e.z,e.w)}t.x=e.x;t.y=e.y;t.z=e.z;t.w=e.w;return t};u.conjugate=function(e,r){t.typeOf.object("quaternion",e);t.typeOf.object("result",r);r.x=-e.x;r.y=-e.y;r.z=-e.z;r.w=e.w;return r};u.magnitudeSquared=function(e){t.typeOf.object("quaternion",e);return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};u.magnitude=function(e){return Math.sqrt(u.magnitudeSquared(e))};u.normalize=function(e,r){t.typeOf.object("result",r);var i=1/u.magnitude(e);var n=e.x*i;var a=e.y*i;var o=e.z*i;var s=e.w*i;r.x=n;r.y=a;r.z=o;r.w=s;return r};u.inverse=function(e,r){t.typeOf.object("result",r);var i=u.magnitudeSquared(e);r=u.conjugate(e,r);return u.multiplyByScalar(r,1/i,r)};u.add=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i.x=e.x+r.x;i.y=e.y+r.y;i.z=e.z+r.z;i.w=e.w+r.w;return i};u.subtract=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i.x=e.x-r.x;i.y=e.y-r.y;i.z=e.z-r.z;i.w=e.w-r.w;return i};u.negate=function(e,r){t.typeOf.object("quaternion",e);t.typeOf.object("result",r);r.x=-e.x;r.y=-e.y;r.z=-e.z;r.w=-e.w;return r};u.dot=function(e,r){t.typeOf.object("left",e);t.typeOf.object("right",r);return e.x*r.x+e.y*r.y+e.z*r.z+e.w*r.w};u.multiply=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);var n=e.x;var a=e.y;var o=e.z;var s=e.w;var l=r.x;var u=r.y;var c=r.z;var d=r.w;var f=s*l+n*d+a*c-o*u;var h=s*u-n*c+a*d+o*l;var p=s*c+n*u-a*l+o*d;var m=s*d-n*l-a*u-o*c;i.x=f;i.y=h;i.z=p;i.w=m;return i};u.multiplyByScalar=function(e,r,i){t.typeOf.object("quaternion",e);t.typeOf.number("scalar",r);t.typeOf.object("result",i);i.x=e.x*r;i.y=e.y*r;i.z=e.z*r;i.w=e.w*r;return i};u.divideByScalar=function(e,r,i){t.typeOf.object("quaternion",e);t.typeOf.number("scalar",r);t.typeOf.object("result",i);i.x=e.x/r;i.y=e.y/r;i.z=e.z/r;i.w=e.w/r;return i};u.computeAxis=function(e,r){t.typeOf.object("quaternion",e);t.typeOf.object("result",r);var i=e.w;if(Math.abs(i-1)<s.EPSILON6){r.x=r.y=r.z=0;return r}var n=1/Math.sqrt(1-i*i);r.x=e.x*n;r.y=e.y*n;r.z=e.z*n;return r};u.computeAngle=function(e){t.typeOf.object("quaternion",e);if(Math.abs(e.w-1)<s.EPSILON6){return 0}return 2*Math.acos(e.w)};var C=new u;u.lerp=function(e,r,i,n){t.typeOf.object("start",e);t.typeOf.object("end",r);t.typeOf.number("t",i);t.typeOf.object("result",n);C=u.multiplyByScalar(r,i,C);n=u.multiplyByScalar(e,1-i,n);return u.add(C,n,n)};var S=new u;var T=new u;var E=new u;u.slerp=function(e,r,i,n){t.typeOf.object("start",e);t.typeOf.object("end",r);t.typeOf.number("t",i);t.typeOf.object("result",n);var a=u.dot(e,r);var o=r;if(a<0){a=-a;o=S=u.negate(r,S)}if(1-a<s.EPSILON6){return u.lerp(e,o,i,n)}var l=Math.acos(a);T=u.multiplyByScalar(e,Math.sin((1-i)*l),T);E=u.multiplyByScalar(o,Math.sin(i*l),E);n=u.add(T,E,n);return u.multiplyByScalar(n,1/Math.sin(l),n)};u.log=function(r,i){t.typeOf.object("quaternion",r);t.typeOf.object("result",i);var n=s.acosClamped(r.w);var a=0;if(n!==0){a=n/Math.sin(n)}return e.multiplyByScalar(r,a,i)};u.exp=function(r,i){t.typeOf.object("cartesian",r);t.typeOf.object("result",i);var n=e.magnitude(r);var a=0;if(n!==0){a=Math.sin(n)/n}i.x=r.x*a;i.y=r.y*a;i.z=r.z*a;i.w=Math.cos(n);return i};var x=new e;var P=new e;var A=new u;var O=new u;u.computeInnerQuadrangle=function(r,i,n,a){t.typeOf.object("q0",r);t.typeOf.object("q1",i);t.typeOf.object("q2",n);t.typeOf.object("result",a);var o=u.conjugate(i,A);u.multiply(o,n,O);var s=u.log(O,x);u.multiply(o,r,O);var l=u.log(O,P);e.add(s,l,s);e.multiplyByScalar(s,.25,s);e.negate(s,s);u.exp(s,A);return u.multiply(i,A,a)};u.squad=function(e,r,i,n,a,o){t.typeOf.object("q0",e);t.typeOf.object("q1",r);t.typeOf.object("s0",i);t.typeOf.object("s1",n);t.typeOf.number("t",a);t.typeOf.object("result",o);var s=u.slerp(e,r,a,A);var l=u.slerp(i,n,a,O);return u.slerp(s,l,2*a*(1-a),o)};var D=new u;var I=1.9011074535173003;var M=n.supportsTypedArrays()?new Float32Array(8):[];var R=n.supportsTypedArrays()?new Float32Array(8):[];var L=n.supportsTypedArrays()?new Float32Array(8):[];var N=n.supportsTypedArrays()?new Float32Array(8):[];for(var k=0;k<7;++k){var F=k+1;var B=2*F+1;M[k]=1/(F*B);R[k]=F/B}M[7]=I/(8*17);R[7]=I*8/17;u.fastSlerp=function(e,r,i,n){t.typeOf.object("start",e);t.typeOf.object("end",r);t.typeOf.number("t",i);t.typeOf.object("result",n);var a=u.dot(e,r);var o;if(a>=0){o=1}else{o=-1;a=-a}var s=a-1;var l=1-i;var c=i*i;var d=l*l;for(var f=7;f>=0;--f){L[f]=(M[f]*c-R[f])*s;N[f]=(M[f]*d-R[f])*s}var h=o*i*(1+L[0]*(1+L[1]*(1+L[2]*(1+L[3]*(1+L[4]*(1+L[5]*(1+L[6]*(1+L[7]))))))));var p=l*(1+N[0]*(1+N[1]*(1+N[2]*(1+N[3]*(1+N[4]*(1+N[5]*(1+N[6]*(1+N[7]))))))));var m=u.multiplyByScalar(e,p,D);u.multiplyByScalar(r,h,n);return u.add(m,n,n)};u.fastSquad=function(e,r,i,n,a,o){t.typeOf.object("q0",e);t.typeOf.object("q1",r);t.typeOf.object("s0",i);t.typeOf.object("s1",n);t.typeOf.number("t",a);t.typeOf.object("result",o);var s=u.fastSlerp(e,r,a,A);var l=u.fastSlerp(i,n,a,O);return u.fastSlerp(s,l,2*a*(1-a),o)};u.equals=function(e,t){return e===t||i(e)&&i(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};u.equalsEpsilon=function(e,r,n){t.typeOf.number("epsilon",n);return e===r||i(e)&&i(r)&&Math.abs(e.x-r.x)<=n&&Math.abs(e.y-r.y)<=n&&Math.abs(e.z-r.z)<=n&&Math.abs(e.w-r.w)<=n};u.ZERO=a(new u(0,0,0,0));u.IDENTITY=a(new u(0,0,0,1));u.prototype.clone=function(e){return u.clone(this,e)};u.prototype.equals=function(e){return u.equals(this,e)};u.prototype.equalsEpsilon=function(e,t){return u.equalsEpsilon(this,e,t)};u.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};return u});define("Core/Transforms",["../ThirdParty/when","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./Check","./defaultValue","./defined","./DeveloperError","./EarthOrientationParameters","./EarthOrientationParametersSample","./Ellipsoid","./Iau2006XysData","./Iau2006XysSample","./JulianDate","./Math","./Matrix3","./Matrix4","./Quaternion","./TimeConstants"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y){"use strict";var b={};var w={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}};var C={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]};var S={};var T={east:new r,north:new r,up:new r,west:new r,south:new r,down:new r};var E=new r;var x=new r;var P=new r;b.localFrameToFixedFrameGenerator=function(e,t){if(!w.hasOwnProperty(e)||!w[e].hasOwnProperty(t)){throw new l("firstAxis and secondAxis must be east, north, up, west, south or down.")}var i=w[e][t];var n;var a=e+t;if(s(S[a])){n=S[a]}else{n=function(n,a,u){if(!s(n)){throw new l("origin is required.")}if(!s(u)){u=new g}if(m.equalsEpsilon(n.x,0,m.EPSILON14)&&m.equalsEpsilon(n.y,0,m.EPSILON14)){var c=m.sign(n.z);r.unpack(C[e],0,E);if(e!=="east"&&e!=="west"){r.multiplyByScalar(E,c,E)}r.unpack(C[t],0,x);if(t!=="east"&&t!=="west"){r.multiplyByScalar(x,c,x)}r.unpack(C[i],0,P);if(i!=="east"&&i!=="west"){r.multiplyByScalar(P,c,P)}}else{a=o(a,d.WGS84);a.geodeticSurfaceNormal(n,T.up);var f=T.up;var h=T.east;h.x=-n.y;h.y=n.x;h.z=0;r.normalize(h,T.east);r.cross(f,h,T.north);r.multiplyByScalar(T.up,-1,T.down);r.multiplyByScalar(T.east,-1,T.west);r.multiplyByScalar(T.north,-1,T.south);E=T[e];x=T[t];P=T[i]}u[0]=E.x;u[1]=E.y;u[2]=E.z;u[3]=0;u[4]=x.x;u[5]=x.y;u[6]=x.z;u[7]=0;u[8]=P.x;u[9]=P.y;u[10]=P.z;u[11]=0;u[12]=n.x;u[13]=n.y;u[14]=n.z;u[15]=1;return u};S[a]=n}return n};b.eastNorthUpToFixedFrame=b.localFrameToFixedFrameGenerator("east","north");b.northEastDownToFixedFrame=b.localFrameToFixedFrameGenerator("north","east");b.northUpEastToFixedFrame=b.localFrameToFixedFrameGenerator("north","up");b.northWestUpToFixedFrame=b.localFrameToFixedFrameGenerator("north","west");var A=new _;var O=new r(1,1,1);var D=new g;b.headingPitchRollToFixedFrame=function(e,t,i,n,s){a.typeOf.object("HeadingPitchRoll",t);n=o(n,b.eastNorthUpToFixedFrame);var l=_.fromHeadingPitchRoll(t,A);var u=g.fromTranslationQuaternionRotationScale(r.ZERO,l,O,D);s=n(e,i,s);return g.multiply(s,u,s)};var I=new g;var M=new v;b.headingPitchRollQuaternion=function(e,t,r,i,n){a.typeOf.object("HeadingPitchRoll",t);var o=b.headingPitchRollToFixedFrame(e,t,r,i,I);var s=g.getRotation(o,M);return _.fromRotationMatrix(s,n)};var R=6*3600+41*60+50.54841;var L=8640184.812866;var N=.093104;var k=-62e-7;var F=1.1772758384668e-19;var B=72921158553e-15;var U=m.TWO_PI/86400;var V=new p;b.computeTemeToPseudoFixedMatrix=function(e,t){if(!s(e)){throw new l("date is required.")}V=p.addSeconds(e,-p.computeTaiMinusUtc(e),V);var r=V.dayNumber;var i=V.secondsOfDay;var n;var a=r-2451545;if(i>=43200){n=(a+.5)/y.DAYS_PER_JULIAN_CENTURY}else{n=(a-.5)/y.DAYS_PER_JULIAN_CENTURY}var o=R+n*(L+n*(N+n*k));var u=o*U%m.TWO_PI;var c=B+F*(r-2451545.5);var d=(i+y.SECONDS_PER_DAY*.5)%y.SECONDS_PER_DAY;var f=u+c*d;var h=Math.cos(f);var g=Math.sin(f);if(!s(t)){return new v(h,g,0,-g,h,0,0,0,1)}t[0]=h;t[1]=-g;t[2]=0;t[3]=g;t[4]=h;t[5]=0;t[6]=0;t[7]=0;t[8]=1;return t};b.iau2006XysData=new f;b.earthOrientationParameters=u.NONE;var z=32.184;var q=2451545;b.preloadIcrfFixed=function(t){var r=t.start.dayNumber;var i=t.start.secondsOfDay+z;var n=t.stop.dayNumber;var a=t.stop.secondsOfDay+z;var o=b.iau2006XysData.preload(r,i,n,a);var s=b.earthOrientationParameters.getPromiseToLoad();return e.all([o,s])};b.computeIcrfToFixedMatrix=function(e,t){if(!s(e)){throw new l("date is required.")}if(!s(t)){t=new v}var r=b.computeFixedToIcrfMatrix(e,t);if(!s(r)){return undefined}return v.transpose(r,t)};var G=new h(0,0,0);var H=new c(0,0,0,0,0,0);var j=new v;var W=new v;b.computeFixedToIcrfMatrix=function(e,t){if(!s(e)){throw new l("date is required.")}if(!s(t)){t=new v}var r=b.earthOrientationParameters.compute(e,H);if(!s(r)){return undefined}var i=e.dayNumber;var n=e.secondsOfDay+z;var a=b.iau2006XysData.computeXysRadians(i,n,G);if(!s(a)){return undefined}var o=a.x+r.xPoleOffset;var u=a.y+r.yPoleOffset;var c=1/(1+Math.sqrt(1-o*o-u*u));var d=j;d[0]=1-c*o*o;d[3]=-c*o*u;d[6]=o;d[1]=-c*o*u;d[4]=1-c*u*u;d[7]=u;d[2]=-o;d[5]=-u;d[8]=1-c*(o*o+u*u);var f=v.fromRotationZ(-a.s,W);var h=v.multiply(d,f,j);var g=e.dayNumber;var _=e.secondsOfDay-p.computeTaiMinusUtc(e)+r.ut1MinusUtc;var w=g-2451545;var C=_/y.SECONDS_PER_DAY;var S=.779057273264+C+.00273781191135448*(w+C);S=S%1*m.TWO_PI;var T=v.fromRotationZ(S,W);var E=v.multiply(h,T,j);var x=Math.cos(r.xPoleWander);var P=Math.cos(r.yPoleWander);var A=Math.sin(r.xPoleWander);var O=Math.sin(r.yPoleWander);var D=i-q+n/y.SECONDS_PER_DAY;D/=36525;var I=-47e-6*D*m.RADIANS_PER_DEGREE/3600;var M=Math.cos(I);var R=Math.sin(I);var L=W;L[0]=x*M;L[1]=x*R;L[2]=A;L[3]=-P*R+O*A*M;L[4]=P*M+O*A*R;L[5]=-O*x;L[6]=-O*R-P*A*M;L[7]=O*M-P*A*R;L[8]=P*x;return v.multiply(E,L,t)};var Y=new i;b.pointToWindowCoordinates=function(e,t,r,i){i=b.pointToGLWindowCoordinates(e,t,r,i);i.y=2*t[5]-i.y;return i};b.pointToGLWindowCoordinates=function(e,r,n,a){if(!s(e)){throw new l("modelViewProjectionMatrix is required.")}if(!s(r)){throw new l("viewportTransformation is required.")}if(!s(n)){throw new l("point is required.")}if(!s(a)){a=new t}var o=Y;g.multiplyByVector(e,i.fromElements(n.x,n.y,n.z,1,o),o);i.multiplyByScalar(o,1/o.w,o);g.multiplyByVector(r,o,o);return t.fromCartesian4(o,a)};var X=new r;var Q=new r;var Z=new r;b.rotationMatrixFromPositionVelocity=function(e,t,i,n){if(!s(e)){throw new l("position is required.")}if(!s(t)){throw new l("velocity is required.")}var a=o(i,d.WGS84).geodeticSurfaceNormal(e,X);var u=r.cross(t,a,Q);if(r.equalsEpsilon(u,r.ZERO,m.EPSILON6)){u=r.clone(r.UNIT_X,u)}var c=r.cross(u,t,Z);r.cross(t,c,u);r.negate(u,u);if(!s(n)){n=new v}n[0]=t.x;n[1]=t.y;n[2]=t.z;n[3]=u.x;n[4]=u.y;n[5]=u.z;n[6]=c.x;n[7]=c.y;n[8]=c.z;return n};var K=new g(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);var J=new n;var $=new r;var ee=new r;var te=new v;var re=new g;var ie=new g;b.basisTo2D=function(e,t,i){if(!s(e)){throw new l("projection is required.")}if(!s(t)){throw new l("matrix is required.")}if(!s(i)){throw new l("result is required.")}var n=g.getTranslation(t,ee);var a=e.ellipsoid;var o=a.cartesianToCartographic(n,J);var u=e.project(o,$);r.fromElements(u.z,u.x,u.y,u);var c=b.eastNorthUpToFixedFrame(n,a,re);var d=g.inverseTransformation(c,ie);var f=g.getRotation(t,te);var h=g.multiplyByMatrix3(d,f,i);g.multiply(K,h,i);g.setTranslation(i,u,i);return i};b.wgs84To2DModelMatrix=function(e,t,i){if(!s(e)){throw new l("projection is required.")}if(!s(t)){throw new l("center is required.")}if(!s(i)){throw new l("result is required.")}var n=e.ellipsoid;var a=b.eastNorthUpToFixedFrame(t,n,re);var o=g.inverseTransformation(a,ie);var u=n.cartesianToCartographic(t,J);var c=e.project(u,$);r.fromElements(c.z,c.x,c.y,c);var d=g.fromTranslation(c,re);g.multiply(K,o,i);g.multiply(d,i,i);return i};return b});define("Core/EllipsoidTangentPlane",["./AxisAlignedBoundingBox","./Cartesian2","./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./IntersectionTests","./Matrix4","./Plane","./Ray","./Transforms"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";var p=new i;function m(e,t){if(!a(e)){throw new s("origin is required.")}t=n(t,l.WGS84);e=t.scaleToGeodeticSurface(e);if(!a(e)){throw new s("origin must not be at the center of the ellipsoid.")}var i=h.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t;this._origin=e;this._xAxis=r.fromCartesian4(c.getColumn(i,0,p));this._yAxis=r.fromCartesian4(c.getColumn(i,1,p));var o=r.fromCartesian4(c.getColumn(i,2,p));this._plane=d.fromPointNormal(e,o)}o(m.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var v=new e;m.fromPoints=function(t,r){if(!a(t)){throw new s("cartesians is required.")}var i=e.fromPoints(t,v);return new m(i.center,r)};var g=new f;var _=new r;m.prototype.projectPointOntoPlane=function(e,i){if(!a(e)){throw new s("cartesian is required.")}var n=g;n.origin=e;r.normalize(e,n.direction);var o=u.rayPlane(n,this._plane,_);if(!a(o)){r.negate(n.direction,n.direction);o=u.rayPlane(n,this._plane,_)}if(a(o)){var l=r.subtract(o,this._origin,o);var c=r.dot(this._xAxis,l);var d=r.dot(this._yAxis,l);if(!a(i)){return new t(c,d)}i.x=c;i.y=d;return i}return undefined};m.prototype.projectPointsOntoPlane=function(e,t){if(!a(e)){throw new s("cartesians is required.")}if(!a(t)){t=[]}var r=0;var i=e.length;for(var n=0;n<i;n++){var o=this.projectPointOntoPlane(e[n],t[r]);if(a(o)){t[r]=o;r++}}t.length=r;return t};m.prototype.projectPointToNearestOnPlane=function(e,i){if(!a(e)){throw new s("cartesian is required.")}if(!a(i)){i=new t}var n=g;n.origin=e;r.clone(this._plane.normal,n.direction);var o=u.rayPlane(n,this._plane,_);if(!a(o)){r.negate(n.direction,n.direction);o=u.rayPlane(n,this._plane,_)}var l=r.subtract(o,this._origin,o);var c=r.dot(this._xAxis,l);var d=r.dot(this._yAxis,l);i.x=c;i.y=d;return i};m.prototype.projectPointsToNearestOnPlane=function(e,t){if(!a(e)){throw new s("cartesians is required.")}if(!a(t)){t=[]}var r=e.length;t.length=r;for(var i=0;i<r;i++){t[i]=this.projectPointToNearestOnPlane(e[i],t[i])}return t};var y=new r;m.prototype.projectPointsOntoEllipsoid=function(e,t){if(!a(e)){throw new s("cartesians is required.")}var i=e.length;if(!a(t)){t=new Array(i)}else{t.length=i}var n=this._ellipsoid;var o=this._origin;var l=this._xAxis;var u=this._yAxis;var c=y;for(var d=0;d<i;++d){var f=e[d];r.multiplyByScalar(l,f.x,c);if(!a(t[d])){t[d]=new r}var h=r.add(o,c,t[d]);r.multiplyByScalar(u,f.y,c);r.add(h,c,h);n.scaleToGeocentricSurface(h,h)}return t};return m});define("Core/OrientedBoundingBox",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Intersect","./Interval","./Math","./Matrix3","./Plane","./Rectangle"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";function m(e,t){this.center=r.clone(n(e,r.ZERO));this.halfAxes=f.clone(n(t,f.ZERO))}var v=new r;var g=new r;var _=new r;var y=new r;var b=new r;var w=new r;var C=new f;var S={unitary:new f,diagonal:new f};m.fromPoints=function(e,t){if(!a(t)){t=new m}if(!a(e)||e.length===0){t.halfAxes=f.ZERO;t.center=r.ZERO;return t}var i;var n=e.length;var o=r.clone(e[0],v);for(i=1;i<n;i++){r.add(o,e[i],o)}var s=1/n;r.multiplyByScalar(o,s,o);var l=0;var u=0;var c=0;var d=0;var h=0;var p=0;var T;for(i=0;i<n;i++){T=r.subtract(e[i],o,g);l+=T.x*T.x;u+=T.x*T.y;c+=T.x*T.z;d+=T.y*T.y;h+=T.y*T.z;p+=T.z*T.z}l*=s;u*=s;c*=s;d*=s;h*=s;p*=s;var E=C;E[0]=l;E[1]=u;E[2]=c;E[3]=u;E[4]=d;E[5]=h;E[6]=c;E[7]=h;E[8]=p;var x=f.computeEigenDecomposition(E,S);var P=f.clone(x.unitary,t.halfAxes);var A=f.getColumn(P,0,y);var O=f.getColumn(P,1,b);var D=f.getColumn(P,2,w);var I=-Number.MAX_VALUE;var M=-Number.MAX_VALUE;var R=-Number.MAX_VALUE;var L=Number.MAX_VALUE;var N=Number.MAX_VALUE;var k=Number.MAX_VALUE;for(i=0;i<n;i++){T=e[i];I=Math.max(r.dot(A,T),I);M=Math.max(r.dot(O,T),M);R=Math.max(r.dot(D,T),R);L=Math.min(r.dot(A,T),L);N=Math.min(r.dot(O,T),N);k=Math.min(r.dot(D,T),k)}A=r.multiplyByScalar(A,.5*(L+I),A);O=r.multiplyByScalar(O,.5*(N+M),O);D=r.multiplyByScalar(D,.5*(k+R),D);var F=r.add(A,O,t.center);r.add(F,D,F);var B=_;B.x=I-L;B.y=M-N;B.z=R-k;r.multiplyByScalar(B,.5,B);f.multiplyByScale(t.halfAxes,B,t.halfAxes);return t};var T=new r;var E=new r;function x(e,t,i,n,s,l,u,c){if(!a(t)||!a(i)||!a(n)||!a(s)||!a(l)||!a(u)){throw new o("all extents (minimum/maximum X/Y/Z) are required.")}if(!a(c)){c=new m}var d=c.halfAxes;f.setColumn(d,0,e.xAxis,d);f.setColumn(d,1,e.yAxis,d);f.setColumn(d,2,e.zAxis,d);var h=T;h.x=(t+i)/2;h.y=(n+s)/2;h.z=(l+u)/2;var p=E;p.x=(i-t)/2;p.y=(s-n)/2;p.z=(u-l)/2;var v=c.center;h=f.multiplyByVector(d,h,h);r.add(e.origin,h,v);f.multiplyByScale(d,p,d);return c}var P=new i;var A=new r;var O=[new i,new i,new i,new i,new i,new i,new i,new i];var D=[new r,new r,new r,new r,new r,new r,new r,new r];var I=[new t,new t,new t,new t,new t,new t,new t,new t];m.fromRectangle=function(e,t,r,i,u){if(!a(e)){throw new o("rectangle is required")}if(e.width<0||e.width>d.PI){throw new o("Rectangle width must be between 0 and pi")}if(e.height<0||e.height>d.PI){throw new o("Rectangle height must be between 0 and pi")}if(a(i)&&!d.equalsEpsilon(i.radii.x,i.radii.y,d.EPSILON15)){throw new o("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)")}t=n(t,0);r=n(r,0);i=n(i,s.WGS84);var c=p.center(e,P);var f=i.cartographicToCartesian(c,A);var m=new l(f,i);var v=m.plane;var g=O[0];var _=O[1];var y=O[2];var b=O[3];var w=O[4];var C=O[5];var S=O[6];var T=O[7];var E=c.longitude;var M=e.south<0&&e.north>0?0:c.latitude;S.latitude=C.latitude=w.latitude=e.south;T.latitude=b.latitude=M;g.latitude=_.latitude=y.latitude=e.north;S.longitude=T.longitude=g.longitude=e.west;C.longitude=_.longitude=E;w.longitude=b.longitude=y.longitude=e.east;y.height=_.height=g.height=T.height=S.height=C.height=w.height=b.height=r;i.cartographicArrayToCartesianArray(O,D);m.projectPointsToNearestOnPlane(D,I);var R=Math.min(I[6].x,I[7].x,I[0].x);var L=Math.max(I[2].x,I[3].x,I[4].x);var N=Math.min(I[4].y,I[5].y,I[6].y);var k=Math.max(I[0].y,I[1].y,I[2].y);y.height=g.height=w.height=S.height=t;i.cartographicArrayToCartesianArray(O,D);var F=Math.min(h.getPointDistance(v,D[0]),h.getPointDistance(v,D[2]),h.getPointDistance(v,D[4]),h.getPointDistance(v,D[6]));var B=r;return x(m,R,L,N,k,F,B,u)};m.clone=function(e,t){if(!a(e)){return undefined}if(!a(t)){return new m(e.center,e.halfAxes)}r.clone(e.center,t.center);f.clone(e.halfAxes,t.halfAxes);return t};m.intersectPlane=function(e,t){if(!a(e)){throw new o("box is required.")}if(!a(t)){throw new o("plane is required.")}var i=e.center;var n=t.normal;var s=e.halfAxes;var l=n.x,c=n.y,d=n.z;var h=Math.abs(l*s[f.COLUMN0ROW0]+c*s[f.COLUMN0ROW1]+d*s[f.COLUMN0ROW2])+Math.abs(l*s[f.COLUMN1ROW0]+c*s[f.COLUMN1ROW1]+d*s[f.COLUMN1ROW2])+Math.abs(l*s[f.COLUMN2ROW0]+c*s[f.COLUMN2ROW1]+d*s[f.COLUMN2ROW2]);var p=r.dot(n,i)+t.distance;if(p<=-h){return u.OUTSIDE}else if(p>=h){return u.INSIDE}return u.INTERSECTING};var M=new r;var R=new r;var L=new r;var N=new r;m.distanceSquaredTo=function(e,t){if(!a(e)){throw new o("box is required.")}if(!a(t)){throw new o("cartesian is required.")}var i=r.subtract(t,e.center,T);var n=e.halfAxes;var s=f.getColumn(n,0,M);var l=f.getColumn(n,1,R);var u=f.getColumn(n,2,L);var c=r.magnitude(s);var d=r.magnitude(l);var h=r.magnitude(u);r.normalize(s,s);r.normalize(l,l);r.normalize(u,u);var p=N;p.x=r.dot(i,s);p.y=r.dot(i,l);p.z=r.dot(i,u);var m=0;var v;if(p.x<-c){v=p.x+c;m+=v*v}else if(p.x>c){v=p.x-c;m+=v*v}if(p.y<-d){v=p.y+d;m+=v*v}else if(p.y>d){v=p.y-d;m+=v*v}if(p.z<-h){v=p.z+h;m+=v*v}else if(p.z>h){v=p.z-h;m+=v*v}return m};var k=new r;var F=new r;m.computePlaneDistances=function(e,t,i,n){if(!a(e)){throw new o("box is required.")}if(!a(t)){throw new o("position is required.")}if(!a(i)){throw new o("direction is required.")}if(!a(n)){n=new c}var s=Number.POSITIVE_INFINITY;var l=Number.NEGATIVE_INFINITY;var u=e.center;var d=e.halfAxes;var h=f.getColumn(d,0,M);var p=f.getColumn(d,1,R);var m=f.getColumn(d,2,L);var v=r.add(h,p,k);r.add(v,m,v);r.add(v,u,v);var g=r.subtract(v,t,F);var _=r.dot(i,g);s=Math.min(_,s);l=Math.max(_,l);r.add(u,h,v);r.add(v,p,v);r.subtract(v,m,v);r.subtract(v,t,g);_=r.dot(i,g);s=Math.min(_,s);l=Math.max(_,l);r.add(u,h,v);r.subtract(v,p,v);r.add(v,m,v);r.subtract(v,t,g);_=r.dot(i,g);s=Math.min(_,s);l=Math.max(_,l);r.add(u,h,v);r.subtract(v,p,v);r.subtract(v,m,v);r.subtract(v,t,g);_=r.dot(i,g);s=Math.min(_,s);l=Math.max(_,l);r.subtract(u,h,v);r.add(v,p,v);r.add(v,m,v);r.subtract(v,t,g);_=r.dot(i,g);s=Math.min(_,s);l=Math.max(_,l);r.subtract(u,h,v);r.add(v,p,v);r.subtract(v,m,v);r.subtract(v,t,g);_=r.dot(i,g);s=Math.min(_,s);l=Math.max(_,l);r.subtract(u,h,v);r.subtract(v,p,v);r.add(v,m,v);r.subtract(v,t,g);_=r.dot(i,g);s=Math.min(_,s);l=Math.max(_,l);r.subtract(u,h,v);r.subtract(v,p,v);r.subtract(v,m,v);r.subtract(v,t,g);_=r.dot(i,g);s=Math.min(_,s);l=Math.max(_,l);n.start=s;n.stop=l;return n};var B=new e;m.isOccluded=function(t,r){if(!a(t)){throw new o("box is required.")}if(!a(r)){throw new o("occluder is required.")}var i=e.fromOrientedBoundingBox(t,B);return!r.isBoundingSphereVisible(i)};m.prototype.intersectPlane=function(e){return m.intersectPlane(this,e)};m.prototype.distanceSquaredTo=function(e){return m.distanceSquaredTo(this,e)};m.prototype.computePlaneDistances=function(e,t,r){return m.computePlaneDistances(this,e,t,r)};m.prototype.isOccluded=function(e){return m.isOccluded(this,e)};m.equals=function(e,t){return e===t||a(e)&&a(t)&&r.equals(e.center,t.center)&&f.equals(e.halfAxes,t.halfAxes)};m.prototype.clone=function(e){return m.clone(this,e)};m.prototype.equals=function(e){return m.equals(this,e)};return m});define("Core/TerrainQuantization",["./freezeObject"],function(e){"use strict";var t={NONE:0,BITS12:1};return e(t)});define("Core/TerrainEncoding",["./AttributeCompression","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./Math","./Matrix4","./TerrainQuantization"],function(e,t,r,i,n,a,o,s,l){"use strict";var u=new r;var c=new r;var d=new t;var f=new s;var h=new s;var p=Math.pow(2,12);function m(e,t,i,o,d,m){var v;var g;var _;var y;if(a(e)&&a(t)&&a(i)&&a(o)){var b=e.minimum;var w=e.maximum;var C=r.subtract(w,b,c);var S=i-t;var T=Math.max(r.maximumComponent(C),S);if(T<p-1){v=l.BITS12}else{v=l.NONE}g=e.center;_=s.inverseTransformation(o,new s);var E=r.negate(b,u);s.multiply(s.fromTranslation(E,f),_,_);var x=u;x.x=1/C.x;x.y=1/C.y;x.z=1/C.z;s.multiply(s.fromScale(x,f),_,_);y=s.clone(o);s.setTranslation(y,r.ZERO,y);o=s.clone(o,new s);var P=s.fromTranslation(b,f);var A=s.fromScale(C,h);var O=s.multiply(P,A,f);s.multiply(o,O,o);s.multiply(y,O,y)}this.quantization=v;this.minimumHeight=t;this.maximumHeight=i;this.center=g;this.toScaledENU=_;this.fromScaledENU=o;this.matrix=y;this.hasVertexNormals=d;this.hasWebMercatorT=n(m,false)}m.prototype.encode=function(i,n,a,c,f,h,p){var m=c.x;var v=c.y;if(this.quantization===l.BITS12){a=s.multiplyByPoint(this.toScaledENU,a,u);a.x=o.clamp(a.x,0,1);a.y=o.clamp(a.y,0,1);a.z=o.clamp(a.z,0,1);var g=this.maximumHeight-this.minimumHeight;var _=o.clamp((f-this.minimumHeight)/g,0,1);t.fromElements(a.x,a.y,d);var y=e.compressTextureCoordinates(d);t.fromElements(a.z,_,d);var b=e.compressTextureCoordinates(d);t.fromElements(m,v,d);var w=e.compressTextureCoordinates(d);i[n++]=y;i[n++]=b;i[n++]=w;if(this.hasWebMercatorT){t.fromElements(p,0,d);var C=e.compressTextureCoordinates(d);i[n++]=C}}else{r.subtract(a,this.center,u);i[n++]=u.x;i[n++]=u.y;i[n++]=u.z;i[n++]=f;i[n++]=m;i[n++]=v;if(this.hasWebMercatorT){i[n++]=p}}if(this.hasVertexNormals){i[n++]=e.octPackFloat(h)}return n};m.prototype.decodePosition=function(t,i,n){if(!a(n)){n=new r}i*=this.getStride();if(this.quantization===l.BITS12){var o=e.decompressTextureCoordinates(t[i],d);n.x=o.x;n.y=o.y;var u=e.decompressTextureCoordinates(t[i+1],d);n.z=u.x;return s.multiplyByPoint(this.fromScaledENU,n,n)}n.x=t[i];n.y=t[i+1];n.z=t[i+2];return r.add(n,this.center,n)};m.prototype.decodeTextureCoordinates=function(r,i,n){if(!a(n)){n=new t}i*=this.getStride();if(this.quantization===l.BITS12){return e.decompressTextureCoordinates(r[i+2],n)}return t.fromElements(r[i+4],r[i+5],n)};m.prototype.decodeHeight=function(t,r){r*=this.getStride();if(this.quantization===l.BITS12){var i=e.decompressTextureCoordinates(t[r+1],d);return i.y*(this.maximumHeight-this.minimumHeight)+this.minimumHeight}return t[r+3]};m.prototype.getOctEncodedNormal=function(e,r,i){var n=this.getStride();r=(r+1)*n-1;var a=e[r]/256;var o=Math.floor(a);var s=(a-o)*256;return t.fromElements(o,s,i)};m.prototype.getStride=function(){var e;switch(this.quantization){case l.BITS12:e=3;break;default:e=6}if(this.hasWebMercatorT){++e}if(this.hasVertexNormals){++e}return e};var v={position3DAndHeight:0,textureCoordAndEncodedNormals:1};var g={compressed0:0,compressed1:1};m.prototype.getAttributes=function(e){var t=i.FLOAT;var r=i.getSizeInBytes(t);var n;if(this.quantization===l.NONE){var a=4;var o=2;if(this.hasWebMercatorT){++o}if(this.hasVertexNormals){++o}n=(a+o)*r;return[{index:v.position3DAndHeight,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:a,offsetInBytes:0,strideInBytes:n},{index:v.textureCoordAndEncodedNormals,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:o,offsetInBytes:a*r,strideInBytes:n}]}var s=3;var u=0;if(this.hasWebMercatorT||this.hasVertexNormals){++s}if(this.hasWebMercatorT&&this.hasVertexNormals){++u;n=(s+u)*r;return[{index:g.compressed0,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:s,offsetInBytes:0,strideInBytes:n},{index:g.compressed1,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:u,offsetInBytes:s*r,strideInBytes:n}]}return[{index:g.compressed0,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:s}]};m.prototype.getAttributeLocations=function(){if(this.quantization===l.NONE){return v}return g};m.clone=function(e,t){if(!a(t)){t=new m}t.quantization=e.quantization;t.minimumHeight=e.minimumHeight;t.maximumHeight=e.maximumHeight;t.center=r.clone(e.center);t.toScaledENU=s.clone(e.toScaledENU);t.fromScaledENU=s.clone(e.fromScaledENU);t.matrix=s.clone(e.matrix);t.hasVertexNormals=e.hasVertexNormals;t.hasWebMercatorT=e.hasWebMercatorT;return t};return m});define("Core/WebMercatorProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math"],function(e,t,r,i,n,a,o,s){"use strict";function l(e){this._ellipsoid=r(e,o.WGS84);this._semimajorAxis=this._ellipsoid.maximumRadius;this._oneOverSemimajorAxis=1/this._semimajorAxis}n(l.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});l.mercatorAngleToGeodeticLatitude=function(e){return s.PI_OVER_TWO-2*Math.atan(Math.exp(-e))};l.geodeticLatitudeToMercatorAngle=function(e){if(e>l.MaximumLatitude){e=l.MaximumLatitude}else if(e<-l.MaximumLatitude){e=-l.MaximumLatitude}var t=Math.sin(e);return.5*Math.log((1+t)/(1-t))};l.MaximumLatitude=l.mercatorAngleToGeodeticLatitude(Math.PI);l.prototype.project=function(t,r){var n=this._semimajorAxis;var a=t.longitude*n;var o=l.geodeticLatitudeToMercatorAngle(t.latitude)*n;var s=t.height;if(!i(r)){return new e(a,o,s)}r.x=a;r.y=o;r.z=s;return r};l.prototype.unproject=function(e,r){if(!i(e)){throw new a("cartesian is required")}var n=this._oneOverSemimajorAxis;var o=e.x*n;var s=l.mercatorAngleToGeodeticLatitude(e.y*n);var u=e.z;if(!i(r)){return new t(o,s,u)}r.longitude=o;r.latitude=s;r.height=u;return r};return l});define("Core/HeightmapTessellator",["./AxisAlignedBoundingBox","./BoundingSphere","./Cartesian2","./Cartesian3","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidalOccluder","./freezeObject","./Math","./Matrix4","./OrientedBoundingBox","./Rectangle","./TerrainEncoding","./Transforms","./WebMercatorProjection"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";var g={};g.DEFAULT_STRUCTURE=u({heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:false});var _=new i;var y=new d;var b=new i;var w=new i;g.computeVertices=function(u){if(!a(u)||!a(u.heightmap)){throw new o("options.heightmap is required.")}if(!a(u.width)||!a(u.height)){throw new o("options.width and options.height are required.")}if(!a(u.nativeRectangle)){throw new o("options.nativeRectangle is required.")}if(!a(u.skirtHeight)){throw new o("options.skirtHeight is required.")}var C=Math.cos;var S=Math.sin;var T=Math.sqrt;var E=Math.atan;var x=Math.exp;var P=c.PI_OVER_TWO;var A=c.toRadians;var O=u.heightmap;var D=u.width;var I=u.height;var M=u.skirtHeight;var R=n(u.isGeographic,true);var L=n(u.ellipsoid,s.WGS84);var N=1/L.maximumRadius;var k=u.nativeRectangle;var F;var B;var U;var V;var z=u.rectangle;if(!a(z)){if(R){F=A(k.west);B=A(k.south);U=A(k.east);V=A(k.north)}else{F=k.west*N;B=P-2*E(x(-k.south*N));U=k.east*N;V=P-2*E(x(-k.north*N))}}else{F=z.west;B=z.south;U=z.east;V=z.north}var q=u.relativeToCenter;var G=a(q);q=G?q:i.ZERO;var H=n(u.exaggeration,1);var j=n(u.includeWebMercatorT,false);var W=n(u.structure,g.DEFAULT_STRUCTURE);var Y=n(W.heightScale,g.DEFAULT_STRUCTURE.heightScale);var X=n(W.heightOffset,g.DEFAULT_STRUCTURE.heightOffset);var Q=n(W.elementsPerHeight,g.DEFAULT_STRUCTURE.elementsPerHeight);var Z=n(W.stride,g.DEFAULT_STRUCTURE.stride);var K=n(W.elementMultiplier,g.DEFAULT_STRUCTURE.elementMultiplier);var J=n(W.isBigEndian,g.DEFAULT_STRUCTURE.isBigEndian);var $=h.computeWidth(k);var ee=h.computeHeight(k);var te=$/(D-1);var re=ee/(I-1);var ie=L.radiiSquared;var ne=ie.x;var ae=ie.y;var oe=ie.z;var se=65536;var le=-65536;var ue=m.eastNorthUpToFixedFrame(q,L);var ce=d.inverseTransformation(ue,y);var de;var fe;if(j){de=v.geodeticLatitudeToMercatorAngle(B);fe=1/(v.geodeticLatitudeToMercatorAngle(V)-de)}var he=b;he.x=Number.POSITIVE_INFINITY;he.y=Number.POSITIVE_INFINITY;he.z=Number.POSITIVE_INFINITY;var pe=w;pe.x=Number.NEGATIVE_INFINITY;pe.y=Number.NEGATIVE_INFINITY;pe.z=Number.NEGATIVE_INFINITY;var me=Number.POSITIVE_INFINITY;var ve=D+(M>0?2:0);var ge=I+(M>0?2:0);var _e=ve*ge;var ye=new Array(_e);var be=new Array(_e);var we=new Array(_e);var Ce=j?new Array(_e):[];var Se=0;var Te=I;var Ee=0;var xe=D;if(M>0){--Se;++Te;--Ee;++xe}var Pe=0;for(var Ae=Se;Ae<Te;++Ae){var Oe=Ae;if(Oe<0){Oe=0}if(Oe>=I){Oe=I-1}var De=k.north-re*Oe;if(!R){De=P-2*E(x(-De*N))}else{De=A(De)}var Ie=C(De);var Me=S(De);var Re=oe*Me;var Le=(De-B)/(V-B);Le=c.clamp(Le,0,1);var Ne;if(j){Ne=(v.geodeticLatitudeToMercatorAngle(De)-de)*fe}for(var ke=Ee;ke<xe;++ke){var Fe=ke;if(Fe<0){Fe=0}if(Fe>=D){Fe=D-1}var Be=k.west+te*Fe;if(!R){Be=Be*N}else{Be=A(Be)}var Ue=Oe*(D*Z)+Fe*Z;var Ve;if(Q===1){Ve=O[Ue]}else{Ve=0;var ze;if(J){for(ze=0;ze<Q;++ze){Ve=Ve*K+O[Ue+ze]}}else{for(ze=Q-1;ze>=0;--ze){Ve=Ve*K+O[Ue+ze]}}}Ve=(Ve*Y+X)*H;var qe=(Be-F)/(U-F);qe=c.clamp(qe,0,1);we[Pe]=new r(qe,Le);le=Math.max(le,Ve);se=Math.min(se,Ve);if(ke!==Fe||Ae!==Oe){var Ge=1e-5;if(ke<0){Be-=Ge*$}else{Be+=Ge*$}if(Ae<0){De+=Ge*ee}else{De-=Ge*ee}Ie=C(De);Me=S(De);Re=oe*Me;Ve-=M}var He=Ie*C(Be);var je=Ie*S(Be);var We=ne*He;var Ye=ae*je;var Xe=T(We*He+Ye*je+Re*Me);var Qe=1/Xe;var Ze=We*Qe;var Ke=Ye*Qe;var Je=Re*Qe;var $e=new i;$e.x=Ze+He*Ve;$e.y=Ke+je*Ve;$e.z=Je+Me*Ve;ye[Pe]=$e;be[Pe]=Ve;if(j){Ce[Pe]=Ne}Pe++;d.multiplyByPoint(ce,$e,_);i.minimumByComponent(_,he,he);i.maximumByComponent(_,pe,pe);me=Math.min(me,Ve)}}var et=t.fromPoints(ye);var tt;if(a(z)&&z.width<c.PI_OVER_TWO+c.EPSILON5){tt=f.fromRectangle(z,se,le,L)}var rt;if(G){var it=new l(L);rt=it.computeHorizonCullingPoint(q,ye)}var nt=new e(he,pe,q);var at=new p(nt,me,le,ue,false,j);var ot=new Float32Array(_e*at.getStride());var st=0;for(var lt=0;lt<_e;++lt){st=at.encode(ot,st,ye[lt],we[lt],be[lt],undefined,Ce[lt])}return{vertices:ot,maximumHeight:le,minimumHeight:se,encoding:at,boundingSphere3D:et,orientedBoundingBox:tt,occludeePointInScaledSpace:rt}};return g});define("Core/destroyObject",["./defaultValue","./DeveloperError"],function(e,t){"use strict";function r(){return true}function i(i,n){n=e(n,"This object was destroyed, i.e., destroy() was called.");function a(){throw new t(n)}for(var o in i){if(typeof i[o]==="function"){i[o]=a}}i.isDestroyed=r;return undefined}return i});define("Core/isCrossOriginUrl",["./defined"],function(e){"use strict";var t;function r(r){if(!e(t)){t=document.createElement("a")}t.href=window.location.href;var i=t.host;var n=t.protocol;t.href=r;t.href=t.href;return n!==t.protocol||i!==t.host}return r});define("Core/TaskProcessor",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./destroyObject","./DeveloperError","./getAbsoluteUri","./isCrossOriginUrl","./RuntimeError","require"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(){if(!i(v._canTransferArrayBuffer)){var t=new Worker(f("Workers/transferTypedArrayTest.js"));t.postMessage=r(t.webkitPostMessage,t.postMessage);var n=99;var a=new Int8Array([n]);try{t.postMessage({array:a},[a.buffer])}catch(e){v._canTransferArrayBuffer=false;return v._canTransferArrayBuffer}var o=e.defer();t.onmessage=function(e){var r=e.data.array;var a=i(r)&&r[0]===n;o.resolve(a);t.terminate();v._canTransferArrayBuffer=a};v._canTransferArrayBuffer=o.promise}return v._canTransferArrayBuffer}function d(e,t){--e._activeTasks;var r=t.id;if(!i(r)){return}var n=e._deferreds;var o=n[r];if(i(t.error)){var s=t.error;if(s.name==="RuntimeError"){s=new l(t.error.message);s.stack=t.error.stack}else if(s.name==="DeveloperError"){s=new a(t.error.message);s.stack=t.error.stack}o.reject(s)}else{o.resolve(t.result)}delete n[r]}function f(e){var r=t(e);if(s(r)){var i='importScripts("'+r+'");';var n;try{n=new Blob([i],{type:"application/javascript"})}catch(e){var a=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var o=new a;o.append(i);n=o.getBlob("application/javascript")}var l=window.URL||window.webkitURL;r=l.createObjectURL(n)}return r}var h;function p(){if(!i(h)){h=f("Workers/cesiumWorkerBootstrapper.js")}return h}function m(e){var n=new Worker(p());n.postMessage=r(n.webkitPostMessage,n.postMessage);var a={loaderConfig:{},workerModule:v._workerModulePrefix+e._workerName};if(i(v._loaderConfig)){a.loaderConfig=v._loaderConfig}else if(i(u.toUrl)){a.loaderConfig.baseUrl=o("..",t("Workers/cesiumWorkerBootstrapper.js"))}else{a.loaderConfig.paths={Workers:t("Workers")}}n.postMessage(a);n.onmessage=function(t){d(e,t.data)};return n}function v(e,t){this._workerName=e;this._maximumActiveTasks=r(t,5);this._activeTasks=0;this._deferreds={};this._nextID=0}var g=[];v.prototype.scheduleTask=function(t,r){if(!i(this._worker)){this._worker=m(this)}if(this._activeTasks>=this._maximumActiveTasks){return undefined}++this._activeTasks;var n=this;return e(c(),function(a){if(!i(r)){r=g}else if(!a){r.length=0}var o=n._nextID++;var s=e.defer();n._deferreds[o]=s;n._worker.postMessage({id:o,parameters:t,canTransferArrayBuffer:a},r);return s.promise})};v.prototype.isDestroyed=function(){return false};v.prototype.destroy=function(){if(i(this._worker)){this._worker.terminate()}return n(this)};v._defaultWorkerModulePrefix="Workers/";v._workerModulePrefix=v._defaultWorkerModulePrefix;v._loaderConfig=undefined;v._canTransferArrayBuffer=undefined;return v});define("Core/TerrainMesh",["./defaultValue"],function(e){"use strict";function t(t,r,i,n,a,o,s,l,u,c,d){this.center=t;this.vertices=r;this.stride=e(l,6);this.indices=i;this.minimumHeight=n;this.maximumHeight=a;this.boundingSphere3D=o;this.occludeePointInScaledSpace=s;this.orientedBoundingBox=u;this.encoding=c;this.exaggeration=d}return t});define("Core/TerrainProvider",["./defined","./defineProperties","./DeveloperError","./Math"],function(e,t,r,i){"use strict";function n(){r.throwInstantiationError()}t(n.prototype,{errorEvent:{get:r.throwInstantiationError},credit:{get:r.throwInstantiationError},tilingScheme:{get:r.throwInstantiationError},ready:{get:r.throwInstantiationError},readyPromise:{get:r.throwInstantiationError},hasWaterMask:{get:r.throwInstantiationError},hasVertexNormals:{get:r.throwInstantiationError},availability:{get:r.throwInstantiationError}});var a=[];n.getRegularGridIndices=function(t,n){if(t*n>=i.SIXTY_FOUR_KILOBYTES){throw new r("The total number of vertices (width * height) must be less than 65536.")}var o=a[t];if(!e(o)){a[t]=o=[]}var s=o[n];if(!e(s)){s=o[n]=new Uint16Array((t-1)*(n-1)*6);var l=0;var u=0;for(var c=0;c<n-1;++c){for(var d=0;d<t-1;++d){var f=l;var h=f+t;var p=h+1;var m=f+1;s[u++]=f;s[u++]=h;s[u++]=m;s[u++]=m;s[u++]=h;s[u++]=p;++l}++l}}return s};n.heightmapTerrainQuality=.25;n.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(e,t,r){return e.maximumRadius*2*Math.PI*n.heightmapTerrainQuality/(t*r)};n.prototype.requestTileGeometry=r.throwInstantiationError;n.prototype.getLevelMaximumGeometricError=r.throwInstantiationError;n.prototype.getTileDataAvailable=r.throwInstantiationError;return n});define("Core/HeightmapTerrainData",["../ThirdParty/when","./defaultValue","./defined","./defineProperties","./DeveloperError","./GeographicTilingScheme","./HeightmapTessellator","./Math","./Rectangle","./TaskProcessor","./TerrainEncoding","./TerrainMesh","./TerrainProvider"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";function h(e){if(!r(e)||!r(e.buffer)){throw new n("options.buffer is required.")}if(!r(e.width)){throw new n("options.width is required.")}if(!r(e.height)){throw new n("options.height is required.")}this._buffer=e.buffer;this._width=e.width;this._height=e.height;this._childTileMask=t(e.childTileMask,15);var i=o.DEFAULT_STRUCTURE;var a=e.structure;if(!r(a)){a=i}else if(a!==i){a.heightScale=t(a.heightScale,i.heightScale);a.heightOffset=t(a.heightOffset,i.heightOffset);a.elementsPerHeight=t(a.elementsPerHeight,i.elementsPerHeight);a.stride=t(a.stride,i.stride);a.elementMultiplier=t(a.elementMultiplier,i.elementMultiplier);a.isBigEndian=t(a.isBigEndian,i.isBigEndian)}this._structure=a;this._createdByUpsampling=t(e.createdByUpsampling,false);this._waterMask=e.waterMask;this._skirtHeight=undefined;this._bufferType=this._buffer.constructor;this._mesh=undefined}i(h.prototype,{credits:{get:function(){return undefined}},waterMask:{get:function(){return this._waterMask}}});var p=new u("createVerticesFromHeightmap");h.prototype.createMesh=function(i,o,s,u,h){if(!r(i)){throw new n("tilingScheme is required.")}if(!r(o)){throw new n("x is required.")}if(!r(s)){throw new n("y is required.")}if(!r(u)){throw new n("level is required.")}var m=i.ellipsoid;var v=i.tileXYToNativeRectangle(o,s,u);var g=i.tileXYToRectangle(o,s,u);h=t(h,1);var _=m.cartographicToCartesian(l.center(g));var y=this._structure;var b=f.getEstimatedLevelZeroGeometricErrorForAHeightmap(m,this._width,i.getNumberOfXTilesAtLevel(0));var w=b/(1<<u);this._skirtHeight=Math.min(w*4,1e3);var C=p.scheduleTask({heightmap:this._buffer,structure:y,includeWebMercatorT:true,width:this._width,height:this._height,nativeRectangle:v,rectangle:g,relativeToCenter:_,ellipsoid:m,skirtHeight:this._skirtHeight,isGeographic:i instanceof a,exaggeration:h});if(!r(C)){return undefined}var S=this;return e(C,function(e){S._mesh=new d(_,new Float32Array(e.vertices),f.getRegularGridIndices(e.gridWidth,e.gridHeight),e.minimumHeight,e.maximumHeight,e.boundingSphere3D,e.occludeePointInScaledSpace,e.numberOfAttributes,e.orientedBoundingBox,c.clone(e.encoding),h);S._buffer=undefined;return S._mesh})};h.prototype.interpolateHeight=function(e,t,i){var n=this._width;var a=this._height;var o=this._structure;var s=o.stride;var l=o.elementsPerHeight;var u=o.elementMultiplier;var c=o.isBigEndian;var d=o.heightOffset;var f=o.heightScale;var h;if(r(this._mesh)){var p=this._mesh.vertices;var g=this._mesh.encoding;var _=this._skirtHeight;var y=this._mesh.exaggeration;h=v(p,g,d,f,_,e,n,a,t,i,y)}else{h=m(this._buffer,l,u,s,c,e,n,a,t,i);h=h*f+d}return h};h.prototype.upsample=function(e,t,i,a,o,l,u){if(!r(e)){throw new n("tilingScheme is required.")}if(!r(t)){throw new n("thisX is required.")}if(!r(i)){throw new n("thisY is required.")}if(!r(a)){throw new n("thisLevel is required.")}if(!r(o)){throw new n("descendantX is required.")}if(!r(l)){throw new n("descendantY is required.")}if(!r(u)){throw new n("descendantLevel is required.")}var c=u-a;if(c>1){throw new n("Upsampling through more than one level at a time is not currently supported.")}var d=this._width;var f=this._height;var p=this._structure;var m=this._skirtHeight;var g=p.stride;var _=new this._bufferType(d*f*g);var b=this._mesh;if(!r(b)){return undefined}var w=b.vertices;var C=b.encoding;var S=e.tileXYToRectangle(t,i,a);var T=e.tileXYToRectangle(o,l,u);var E=p.heightOffset;var x=p.heightScale;var P=b.exaggeration;var A=p.elementsPerHeight;var O=p.elementMultiplier;var D=p.isBigEndian;var I=Math.pow(O,A-1);for(var M=0;M<f;++M){var R=s.lerp(T.north,T.south,M/(f-1));for(var L=0;L<d;++L){var N=s.lerp(T.west,T.east,L/(d-1));var k=v(w,C,E,x,m,S,d,f,N,R,P);k=k<p.lowestEncodedHeight?p.lowestEncodedHeight:k;k=k>p.highestEncodedHeight?p.highestEncodedHeight:k;y(_,A,O,I,g,D,M*d+L,k)}}return new h({buffer:_,width:d,height:f,childTileMask:0,structure:this._structure,createdByUpsampling:true})};h.prototype.isChildAvailable=function(e,t,i,a){if(!r(e)){throw new n("thisX is required.")}if(!r(t)){throw new n("thisY is required.")}if(!r(i)){throw new n("childX is required.")}if(!r(a)){throw new n("childY is required.")}var o=2;if(i!==e*2){++o}if(a!==t*2){o-=2}return(this._childTileMask&1<<o)!==0};h.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};function m(e,t,r,i,n,a,o,s,l,u){var c=(l-a.west)*(o-1)/(a.east-a.west);var d=(u-a.south)*(s-1)/(a.north-a.south);var f=c|0;var h=f+1;if(h>=o){h=o-1;f=o-2}var p=d|0;var m=p+1;if(m>=s){m=s-1;p=s-2}var v=c-f;var y=d-p;p=s-1-p;m=s-1-m;var b=_(e,t,r,i,n,p*o+f);var w=_(e,t,r,i,n,p*o+h);var C=_(e,t,r,i,n,m*o+f);var S=_(e,t,r,i,n,m*o+h);return g(v,y,b,w,C,S)}function v(e,t,r,i,n,a,o,s,l,u,c){var d=(l-a.west)*(o-1)/(a.east-a.west);var f=(u-a.south)*(s-1)/(a.north-a.south);if(n>0){d+=1;f+=1;o+=2;s+=2}var h=n>0?o-1:o;var p=d|0;var m=p+1;if(m>=h){m=o-1;p=o-2}var v=n>0?s-1:s;var _=f|0;var y=_+1;if(y>=v){y=s-1;_=s-2}var b=d-p;var w=f-_;_=s-1-_;y=s-1-y;var C=(t.decodeHeight(e,_*o+p)/c-r)/i;var S=(t.decodeHeight(e,_*o+m)/c-r)/i;var T=(t.decodeHeight(e,y*o+p)/c-r)/i;var E=(t.decodeHeight(e,y*o+m)/c-r)/i;return g(b,w,C,S,T,E)}function g(e,t,r,i,n,a){if(t<e){return r+e*(i-r)+t*(a-i)}return r+e*(a-n)+t*(n-r)}function _(e,t,r,i,n,a){a*=i;var o=0;var s;if(n){for(s=0;s<t;++s){o=o*r+e[a+s]}}else{for(s=t-1;s>=0;--s){o=o*r+e[a+s]}}return o}function y(e,t,r,i,n,a,o,s){o*=n;var l;if(a){for(l=0;l<t-1;++l){e[o+l]=s/i|0;s-=e[o+l]*i;i/=r}}else{for(l=t-1;l>0;--l){e[o+l]=s/i|0;s-=e[o+l]*i;i/=r}}e[o+l]=s}return h});define("Core/IndexDatatype",["./defined","./DeveloperError","./freezeObject","./Math","./WebGLConstants"],function(e,t,r,i,n){"use strict";var a={UNSIGNED_BYTE:n.UNSIGNED_BYTE,UNSIGNED_SHORT:n.UNSIGNED_SHORT,UNSIGNED_INT:n.UNSIGNED_INT};a.getSizeInBytes=function(e){switch(e){case a.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case a.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case a.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}throw new t("indexDatatype is required and must be a valid IndexDatatype constant.")};a.validate=function(t){return e(t)&&(t===a.UNSIGNED_BYTE||t===a.UNSIGNED_SHORT||t===a.UNSIGNED_INT)};a.createTypedArray=function(r,n){if(!e(r)){throw new t("numberOfVertices is required.")}if(r>=i.SIXTY_FOUR_KILOBYTES){return new Uint32Array(n)}return new Uint16Array(n)};a.createTypedArrayFromArrayBuffer=function(r,n,a,o){if(!e(r)){throw new t("numberOfVertices is required.")}if(!e(n)){throw new t("sourceArray is required.")}if(!e(a)){throw new t("byteOffset is required.")}if(r>=i.SIXTY_FOUR_KILOBYTES){return new Uint32Array(n,a,o)}return new Uint16Array(n,a,o)};return r(a)});define("Core/loadArrayBuffer",["./loadWithXhr"],function(e){"use strict";function t(t,r,i){return e({url:t,responseType:"arraybuffer",headers:r,request:i})}return t});define("Core/Intersections2D",["./Cartesian3","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};i.clipTriangleAtAxisAlignedThreshold=function(e,i,n,a,o,s){if(!t(e)){throw new r("threshold is required.")}if(!t(i)){throw new r("keepAbove is required.")}if(!t(n)){throw new r("u0 is required.")}if(!t(a)){throw new r("u1 is required.")}if(!t(o)){throw new r("u2 is required.")}if(!t(s)){s=[]}else{s.length=0}var l;var u;var c;if(i){l=n<e;u=a<e;c=o<e}else{l=n>e;u=a>e;c=o>e}var d=l+u+c;var f;var h;var p;var m;var v;var g;if(d===1){if(l){f=(e-n)/(a-n);h=(e-n)/(o-n);s.push(1);s.push(2);if(h!==1){s.push(-1);s.push(0);s.push(2);s.push(h)}if(f!==1){s.push(-1);s.push(0);s.push(1);s.push(f)}}else if(u){p=(e-a)/(o-a);m=(e-a)/(n-a);s.push(2);s.push(0);if(m!==1){s.push(-1);s.push(1);s.push(0);s.push(m)}if(p!==1){s.push(-1);s.push(1);s.push(2);s.push(p)}}else if(c){v=(e-o)/(n-o);g=(e-o)/(a-o);s.push(0);s.push(1);if(g!==1){s.push(-1);s.push(2);s.push(1);s.push(g)}if(v!==1){s.push(-1);s.push(2);s.push(0);s.push(v)}}}else if(d===2){if(!l&&n!==e){m=(e-a)/(n-a);v=(e-o)/(n-o);s.push(0);s.push(-1);s.push(1);s.push(0);s.push(m);s.push(-1);s.push(2);s.push(0);s.push(v)}else if(!u&&a!==e){g=(e-o)/(a-o);f=(e-n)/(a-n);s.push(1);s.push(-1);s.push(2);s.push(1);s.push(g);s.push(-1);s.push(0);s.push(1);s.push(f)}else if(!c&&o!==e){h=(e-n)/(o-n);p=(e-a)/(o-a);s.push(2);s.push(-1);s.push(0);s.push(2);s.push(h);s.push(-1);s.push(1);s.push(2);s.push(p)}}else if(d!==3){s.push(0);s.push(1);s.push(2)}return s};i.computeBarycentricCoordinates=function(i,n,a,o,s,l,u,c,d){if(!t(i)){throw new r("x is required.")}if(!t(n)){throw new r("y is required.")}if(!t(a)){throw new r("x1 is required.")}if(!t(o)){throw new r("y1 is required.")}if(!t(s)){throw new r("x2 is required.")}if(!t(l)){throw new r("y2 is required.")}if(!t(u)){throw new r("x3 is required.")}if(!t(c)){throw new r("y3 is required.")}var f=a-u;var h=u-s;var p=l-c;var m=o-c;var v=1/(p*f+h*m);var g=n-c;var _=i-u;var y=(p*_+h*g)*v;var b=(-m*_+f*g)*v;var w=1-y-b;if(t(d)){d.x=y;d.y=b;d.z=w;return d}return new e(y,b,w)};return i});define("Core/QuantizedMeshTerrainData",["../ThirdParty/when","./BoundingSphere","./Cartesian2","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./IndexDatatype","./Intersections2D","./Math","./OrientedBoundingBox","./TaskProcessor","./TerrainEncoding","./TerrainMesh"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";function m(e){if(!a(e)||!a(e.quantizedVertices)){throw new s("options.quantizedVertices is required.")}if(!a(e.indices)){throw new s("options.indices is required.")}if(!a(e.minimumHeight)){throw new s("options.minimumHeight is required.")}if(!a(e.maximumHeight)){throw new s("options.maximumHeight is required.")}if(!a(e.maximumHeight)){throw new s("options.maximumHeight is required.")}if(!a(e.boundingSphere)){throw new s("options.boundingSphere is required.")}if(!a(e.horizonOcclusionPoint)){throw new s("options.horizonOcclusionPoint is required.")}if(!a(e.westIndices)){throw new s("options.westIndices is required.")}if(!a(e.southIndices)){throw new s("options.southIndices is required.")}if(!a(e.eastIndices)){throw new s("options.eastIndices is required.")}if(!a(e.northIndices)){throw new s("options.northIndices is required.")}if(!a(e.westSkirtHeight)){throw new s("options.westSkirtHeight is required.")}if(!a(e.southSkirtHeight)){throw new s("options.southSkirtHeight is required.")}if(!a(e.eastSkirtHeight)){throw new s("options.eastSkirtHeight is required.")}if(!a(e.northSkirtHeight)){throw new s("options.northSkirtHeight is required.")}this._quantizedVertices=e.quantizedVertices;this._encodedNormals=e.encodedNormals;this._indices=e.indices;this._minimumHeight=e.minimumHeight;this._maximumHeight=e.maximumHeight;this._boundingSphere=e.boundingSphere;this._orientedBoundingBox=e.orientedBoundingBox;this._horizonOcclusionPoint=e.horizonOcclusionPoint;this._credits=e.credits;var t=this._quantizedVertices.length/3;var r=this._uValues=this._quantizedVertices.subarray(0,t);var i=this._vValues=this._quantizedVertices.subarray(t,2*t);this._heightValues=this._quantizedVertices.subarray(2*t,3*t);function o(e,t){return i[e]-i[t]}function l(e,t){return r[e]-r[t]}this._westIndices=g(e.westIndices,o,t);this._southIndices=g(e.southIndices,l,t);this._eastIndices=g(e.eastIndices,o,t);this._northIndices=g(e.northIndices,l,t);this._westSkirtHeight=e.westSkirtHeight;this._southSkirtHeight=e.southSkirtHeight;this._eastSkirtHeight=e.eastSkirtHeight;this._northSkirtHeight=e.northSkirtHeight;this._childTileMask=n(e.childTileMask,15);this._createdByUpsampling=n(e.createdByUpsampling,false);this._waterMask=e.waterMask;this._mesh=undefined}o(m.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){return this._waterMask}}});var v=[];function g(e,t,r){v.length=e.length;var i=false;for(var n=0,a=e.length;n<a;++n){v[n]=e[n];i=i||n>0&&t(e[n-1],e[n])>0}if(i){v.sort(t);return l.createTypedArray(r,v)}return e}var _=new f("createVerticesFromQuantizedTerrainMesh");m.prototype.createMesh=function(t,r,i,o,u){if(!a(t)){throw new s("tilingScheme is required.")}if(!a(r)){throw new s("x is required.")}if(!a(i)){throw new s("y is required.")}if(!a(o)){throw new s("level is required.")}var c=t.ellipsoid;var d=t.tileXYToRectangle(r,i,o);u=n(u,1);var f=_.scheduleTask({minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,quantizedVertices:this._quantizedVertices,octEncodedNormals:this._encodedNormals,includeWebMercatorT:true,indices:this._indices,westIndices:this._westIndices,southIndices:this._southIndices,eastIndices:this._eastIndices,northIndices:this._northIndices,westSkirtHeight:this._westSkirtHeight,southSkirtHeight:this._southSkirtHeight,eastSkirtHeight:this._eastSkirtHeight,northSkirtHeight:this._northSkirtHeight,rectangle:d,relativeToCenter:this._boundingSphere.center,ellipsoid:c,exaggeration:u});if(!a(f)){return undefined}var m=this;return e(f,function(e){var t=m._quantizedVertices.length/3;t+=m._westIndices.length+m._southIndices.length+m._eastIndices.length+m._northIndices.length;var r=l.createTypedArray(t,e.indices);var i=new Float32Array(e.vertices);var a=e.center;var o=e.minimumHeight;var s=e.maximumHeight;var c=n(e.boundingSphere,m._boundingSphere);var d=n(e.orientedBoundingBox,m._orientedBoundingBox);var f=m._horizonOcclusionPoint;var v=e.vertexStride;var g=h.clone(e.encoding);m._skirtIndex=e.skirtIndex;m._vertexCountWithoutSkirts=m._quantizedVertices.length/3;m._mesh=new p(a,i,r,o,s,c,f,v,d,g,u);m._quantizedVertices=undefined;m._encodedNormals=undefined;m._indices=undefined;m._uValues=undefined;m._vValues=undefined;m._heightValues=undefined;m._westIndices=undefined;m._southIndices=undefined;m._eastIndices=undefined;m._northIndices=undefined;return m._mesh})};var y=new f("upsampleQuantizedTerrainMesh");m.prototype.upsample=function(r,n,o,u,c,f,h){if(!a(r)){throw new s("tilingScheme is required.")}if(!a(n)){throw new s("thisX is required.")}if(!a(o)){throw new s("thisY is required.")}if(!a(u)){throw new s("thisLevel is required.")}if(!a(c)){throw new s("descendantX is required.")}if(!a(f)){throw new s("descendantY is required.")}if(!a(h)){throw new s("descendantLevel is required.")}var p=h-u;if(p>1){throw new s("Upsampling through more than one level at a time is not currently supported.")}var v=this._mesh;if(!a(this._mesh)){return undefined}var g=n*2!==c;var _=o*2===f;var b=r.ellipsoid;var w=r.tileXYToRectangle(c,f,h);var C=y.scheduleTask({vertices:v.vertices,vertexCountWithoutSkirts:this._vertexCountWithoutSkirts,indices:v.indices,skirtIndex:this._skirtIndex,encoding:v.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:g,isNorthChild:_,childRectangle:w,ellipsoid:b,exaggeration:v.exaggeration});if(!a(C)){return undefined}var S=Math.min(this._westSkirtHeight,this._eastSkirtHeight);S=Math.min(S,this._southSkirtHeight);S=Math.min(S,this._northSkirtHeight);var T=g?S*.5:this._westSkirtHeight;var E=_?S*.5:this._southSkirtHeight;var x=g?this._eastSkirtHeight:S*.5;var P=_?this._northSkirtHeight:S*.5;return e(C,function(e){var r=new Uint16Array(e.vertices);var n=l.createTypedArray(r.length/3,e.indices);var o;if(a(e.encodedNormals)){o=new Uint8Array(e.encodedNormals)}return new m({quantizedVertices:r,indices:n,encodedNormals:o,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:t.clone(e.boundingSphere),orientedBoundingBox:d.clone(e.orientedBoundingBox),horizonOcclusionPoint:i.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:T,southSkirtHeight:E,eastSkirtHeight:x,northSkirtHeight:P,childTileMask:0,createdByUpsampling:true})})};var b=32767;var w=new i;m.prototype.interpolateHeight=function(e,t,r){var i=c.clamp((t-e.west)/e.width,0,1);i*=b;var n=c.clamp((r-e.south)/e.height,0,1);n*=b;if(!a(this._mesh)){return x(this,i,n)}return E(this,i,n)};var C=new r;var S=new r;var T=new r;function E(e,t,r){var i=e._mesh;var n=i.vertices;var a=i.encoding;var o=i.indices;for(var s=0,l=o.length;s<l;s+=3){var c=o[s];var d=o[s+1];var f=o[s+2];var h=a.decodeTextureCoordinates(n,c,C);var p=a.decodeTextureCoordinates(n,d,S);var m=a.decodeTextureCoordinates(n,f,T);var v=u.computeBarycentricCoordinates(t,r,h.x,h.y,p.x,p.y,m.x,m.y,w);if(v.x>=-1e-15&&v.y>=-1e-15&&v.z>=-1e-15){var g=a.decodeHeight(n,c);var _=a.decodeHeight(n,d);var y=a.decodeHeight(n,f);return v.x*g+v.y*_+v.z*y}}return undefined}function x(e,t,r){var i=e._uValues;var n=e._vValues;var a=e._heightValues;var o=e._indices;for(var s=0,l=o.length;s<l;s+=3){var d=o[s];var f=o[s+1];var h=o[s+2];var p=i[d];var m=i[f];var v=i[h];var g=n[d];var _=n[f];var y=n[h];var C=u.computeBarycentricCoordinates(t,r,p,g,m,_,v,y,w);if(C.x>=-1e-15&&C.y>=-1e-15&&C.z>=-1e-15){var S=C.x*a[d]+C.y*a[f]+C.z*a[h];return c.lerp(e._minimumHeight,e._maximumHeight,S/b)}}return undefined}m.prototype.isChildAvailable=function(e,t,r,i){if(!a(e)){throw new s("thisX is required.")}if(!a(t)){throw new s("thisY is required.")}if(!a(r)){throw new s("childX is required.")}if(!a(i)){throw new s("childY is required.")}var n=2;if(r!==e*2){++n}if(i!==t*2){n-=2}return(this._childTileMask&1<<n)!==0};m.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};return m});define("Core/TileAvailability",["./binarySearch","./Cartographic","./defined","./defineProperties","./DeveloperError","./Rectangle"],function(e,t,r,i,n,a){"use strict";function o(e,t){this._tilingScheme=e;this._maximumLevel=t;this._rootNodes=[];for(var r=0;r<e.getNumberOfYTilesAtLevel();++r){for(var i=0;i<e.getNumberOfXTilesAtLevel();++i){this._rootNodes.push(new h(e,undefined,0,i,r))}}}var s=new a;o.prototype.addAvailableTileRange=function(e,t,r,i,n){var a=this._tilingScheme;a.tileXYToRectangle(t,r,e,s);var o=s.west;var l=s.north;a.tileXYToRectangle(i,n,e,s);var u=s.east;var c=s.south;var d=new p(e,o,c,u,l);for(var f=0;f<this._rootNodes.length;++f){var h=this._rootNodes[f];if(m(h.extent,d)){v(this._maximumLevel,h,d)}}};o.prototype.computeMaximumLevelAtPosition=function(e){var t;for(var i=0;i<this._rootNodes.length;++i){var a=this._rootNodes[i];if(y(a.extent,e)){t=a;break}}if(!r(t)){throw new n("The specified position does not exist in any root node of the tiling scheme.")}return b(undefined,t,e)};var l=[];var u=[];var c=new a;var d=new a;o.prototype.computeBestAvailableLevelOverRectangle=function(e){var t=l;t.length=0;if(e.east<e.west){t.push(a.fromRadians(-Math.PI,e.south,e.east,e.north,c));t.push(a.fromRadians(e.west,e.south,Math.PI,e.north,d))}else{t.push(e)}var i=u;i.length=0;var n;for(n=0;n<this._rootNodes.length;++n){w(i,this._rootNodes[n],t)}for(n=i.length-1;n>=0;--n){if(r(i[n])&&i[n].length===0){return n}}return 0};var f=new t;o.prototype.isTileAvailable=function(e,t,r){var i=this._tilingScheme.tileXYToRectangle(t,r,e,s);a.center(i,f);return this.computeMaximumLevelAtPosition(f)>=e};o.prototype.computeChildMaskForTile=function(e,t,r){var i=e+1;if(i>=this._maximumLevel){return 0}var n=0;n|=this.isTileAvailable(i,2*t,2*r+1)?1:0;n|=this.isTileAvailable(i,2*t+1,2*r+1)?2:0;n|=this.isTileAvailable(i,2*t,2*r)?4:0;n|=this.isTileAvailable(i,2*t+1,2*r)?8:0;return n};function h(e,t,r,i,n){this.tilingScheme=e;this.parent=t;this.level=r;this.x=i;this.y=n;this.extent=e.tileXYToRectangle(i,n,r);this.rectangles=[];this._sw=undefined;this._se=undefined;this._nw=undefined;this._ne=undefined}i(h.prototype,{nw:{get:function(){if(!this._nw){this._nw=new h(this.tilingScheme,this,this.level+1,this.x*2,this.y*2)}return this._nw}},ne:{get:function(){if(!this._ne){this._ne=new h(this.tilingScheme,this,this.level+1,this.x*2+1,this.y*2)}return this._ne}},sw:{get:function(){if(!this._sw){this._sw=new h(this.tilingScheme,this,this.level+1,this.x*2,this.y*2+1)}return this._sw}},se:{get:function(){if(!this._se){this._se=new h(this.tilingScheme,this,this.level+1,this.x*2+1,this.y*2+1)}return this._se}}});function p(e,t,r,i,n){this.level=e;this.west=t;this.south=r;this.east=i;this.north=n}function m(e,t){var r=Math.max(e.west,t.west);var i=Math.max(e.south,t.south);var n=Math.min(e.east,t.east);var a=Math.min(e.north,t.north);return i<a&&r<n}function v(t,r,i){while(r.level<t){if(_(r.nw.extent,i)){r=r.nw}else if(_(r.ne.extent,i)){r=r.ne}else if(_(r.sw.extent,i)){r=r.sw}else if(_(r.se.extent,i)){r=r.se}else{break}}if(r.rectangles.length===0||r.rectangles[r.rectangles.length-1].level<=i.level){r.rectangles.push(i)}else{var n=e(r.rectangles,i.level,g);if(n<=0){n=~n}r.rectangles.splice(n,0,i)}}function g(e,t){return e.level-t}function _(e,t){return t.west>=e.west&&t.east<=e.east&&t.south>=e.south&&t.north<=e.north}function y(e,t){return t.longitude>=e.west&&t.longitude<=e.east&&t.latitude>=e.south&&t.latitude<=e.north}function b(e,t,r){var i=0;var n=false;while(!n){var a=t._nw&&y(t._nw.extent,r);var o=t._ne&&y(t._ne.extent,r);var s=t._sw&&y(t._sw.extent,r);var l=t._se&&y(t._se.extent,r);if(a+o+s+l>1){if(a){i=Math.max(i,b(t,t._nw,r))}if(o){i=Math.max(i,b(t,t._ne,r))}if(s){i=Math.max(i,b(t,t._sw,r))}if(l){i=Math.max(i,b(t,t._se,r))}break}else if(a){t=t._nw}else if(o){t=t._ne}else if(s){t=t._sw}else if(l){t=t._se}else{n=true}}while(t!==e){var u=t.rectangles;for(var c=u.length-1;c>=0&&u[c].level>i;--c){var d=u[c];if(y(d,r)){i=d.level}}t=t.parent}return i}function w(e,t,r){if(!t){return}var i;var n=false;for(i=0;i<r.length;++i){n=n||m(t.extent,r[i])}if(!n){return}var a=t.rectangles;for(i=0;i<a.length;++i){var o=a[i];if(!e[o.level]){e[o.level]=r}e[o.level]=C(e[o.level],o)}w(e,t._nw,r);w(e,t._ne,r);w(e,t._sw,r);w(e,t._se,r)}function C(e,t){var r=[];for(var i=0;i<e.length;++i){var n=e[i];if(!m(n,t)){r.push(n)}else{if(n.west<t.west){r.push(new a(n.west,n.south,t.west,n.north))}if(n.east>t.east){r.push(new a(t.east,n.south,n.east,n.north))}if(n.south<t.south){r.push(new a(Math.max(t.west,n.west),n.south,Math.min(t.east,n.east),t.south))}if(n.north>t.north){r.push(new a(Math.max(t.west,n.west),t.north,Math.min(t.east,n.east),n.north))}}}return r}return o});define("Core/formatError",["./defined"],function(e){"use strict";function t(t){var r;var i=t.name;var n=t.message;if(e(i)&&e(n)){r=i+": "+n}else{r=t.toString()}var a=t.stack;if(e(a)){r+="\n"+a}return r}return t});define("Core/TileProviderError",["./defaultValue","./defined","./formatError"],function(e,t,r){"use strict";function i(t,r,i,n,a,o,s){this.provider=t;this.message=r;this.x=i;this.y=n;this.level=a;this.timesRetried=e(o,0);this.retry=false;this.error=s}i.handleError=function(e,n,a,o,s,l,u,c,d){var f=e;if(!t(e)){f=new i(n,o,s,l,u,0,d)}else{f.provider=n;f.message=o;f.x=s;f.y=l;f.level=u;f.retry=false;f.error=d;++f.timesRetried}if(a.numberOfListeners>0){a.raiseEvent(f)}else{console.log('An error occurred in "'+n.constructor.name+'": '+r(o))}if(f.retry&&t(c)){c()}return f};i.handleSuccess=function(e){if(t(e)){e.timesRetried=-1}};return i});define("Core/CesiumTerrainProvider",["../ThirdParty/Uri","../ThirdParty/when","./BoundingSphere","./Cartesian3","./Credit","./defaultValue","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./Event","./GeographicTilingScheme","./HeightmapTerrainData","./IndexDatatype","./joinUrls","./loadArrayBuffer","./loadJson","./Math","./OrientedBoundingBox","./QuantizedMeshTerrainData","./Request","./RequestType","./TerrainProvider","./TileAvailability","./TileProviderError"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T){"use strict";function E(r){if(!o(r)||!o(r.url)){throw new u("options.url is required.")}this._url=r.url;this._proxy=r.proxy;this._tilingScheme=new d({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:r.ellipsoid});this._heightmapWidth=65;this._levelZeroMaximumGeometricError=C.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._heightmapWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0));this._heightmapStructure=undefined;this._hasWaterMask=false;this._hasVertexNormals=false;this._requestVertexNormals=a(r.requestVertexNormals,false);this._littleEndianExtensionSize=true;this._requestWaterMask=a(r.requestWaterMask,false);this._errorEvent=new c;this._availability=undefined;var i=r.credit;if(typeof i==="string"){i=new n(i)}this._credit=i;this._ready=false;this._readyPromise=t.defer();var s=p(this._url,"layer.json");if(o(this._proxy)){s=this._proxy.getURL(s)}var l=this;var f;function h(t){var r;if(!t.format){r="The tile format is not specified in the layer.json file.";f=T.handleError(f,l,l._errorEvent,r,undefined,undefined,undefined,g);return}if(!t.tiles||t.tiles.length===0){r="The layer.json file does not specify any tile URL templates.";f=T.handleError(f,l,l._errorEvent,r,undefined,undefined,undefined,g);return}if(t.format==="heightmap-1.0"){l._heightmapStructure={heightScale:1/5,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:false,lowestEncodedHeight:0,highestEncodedHeight:256*256-1};l._hasWaterMask=true;l._requestWaterMask=true}else if(t.format.indexOf("quantized-mesh-1.")!==0){r='The tile format "'+t.format+'" is invalid or not supported.';f=T.handleError(f,l,l._errorEvent,r,undefined,undefined,undefined,g);return}l._tileUrlTemplates=t.tiles;for(var i=0;i<l._tileUrlTemplates.length;++i){var a=new e(l._tileUrlTemplates[i]);var s=new e(l._url);if(a.authority&&!s.authority){s.authority=a.authority;s.scheme=a.scheme}l._tileUrlTemplates[i]=p(s,a).toString().replace("{version}",t.version)}var u=t.available;if(o(u)){l._availability=new S(l._tilingScheme,u.length);for(var c=0;c<u.length;++c){var d=u[c];var h=l._tilingScheme.getNumberOfYTilesAtLevel(c);for(var m=0;m<d.length;++m){var v=d[m];l._availability.addAvailableTileRange(c,v.startX,h-v.endY-1,v.endX,h-v.startY-1)}}}if(!o(l._credit)&&o(t.attribution)&&t.attribution!==null){l._credit=new n(t.attribution)}if(o(t.extensions)&&t.extensions.indexOf("octvertexnormals")!==-1){l._hasVertexNormals=true}else if(o(t.extensions)&&t.extensions.indexOf("vertexnormals")!==-1){l._hasVertexNormals=true;l._littleEndianExtensionSize=false}if(o(t.extensions)&&t.extensions.indexOf("watermask")!==-1){l._hasWaterMask=true}l._ready=true;l._readyPromise.resolve(true)}function m(e){if(o(e)&&e.statusCode===404){h({tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]});return}var t="An error occurred while accessing "+s+".";f=T.handleError(f,l,l._errorEvent,t,undefined,undefined,undefined,g)}function g(){var e=v(s);t(e,h,m)}g()}var x={OCT_VERTEX_NORMALS:1,WATER_MASK:2};function P(e){if(!o(e)||e.length===0){return{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"}}var t=e.join("-");return{Accept:"application/vnd.quantized-mesh;extensions="+t+",application/octet-stream;q=0.9,*/*;q=0.01"}}function A(e,t,r,i,n,a){var o=new Uint16Array(t,0,e._heightmapWidth*e._heightmapWidth);return new f({buffer:o,childTileMask:new Uint8Array(t,o.byteLength,1)[0],waterMask:new Uint8Array(t,o.byteLength+1,t.byteLength-o.byteLength-1),width:e._heightmapWidth,height:e._heightmapWidth,structure:e._heightmapStructure})}function O(e,t,n,a,o,s){var l=0;var u=3;var c=u+1;var d=Float64Array.BYTES_PER_ELEMENT*u;var f=Float64Array.BYTES_PER_ELEMENT*c;var p=3;var m=Uint16Array.BYTES_PER_ELEMENT*p;var v=3;var b=Uint16Array.BYTES_PER_ELEMENT;var w=b*v;var C=new DataView(t);var S=new i(C.getFloat64(l,true),C.getFloat64(l+8,true),C.getFloat64(l+16,true));l+=d;var T=C.getFloat32(l,true);l+=Float32Array.BYTES_PER_ELEMENT;var E=C.getFloat32(l,true);l+=Float32Array.BYTES_PER_ELEMENT;var P=new r(new i(C.getFloat64(l,true),C.getFloat64(l+8,true),C.getFloat64(l+16,true)),C.getFloat64(l+d,true));l+=f;var A=new i(C.getFloat64(l,true),C.getFloat64(l+8,true),C.getFloat64(l+16,true));l+=d;var O=C.getUint32(l,true);l+=Uint32Array.BYTES_PER_ELEMENT;var D=new Uint16Array(t,l,O*3);l+=O*m;if(O>64*1024){b=Uint32Array.BYTES_PER_ELEMENT;w=b*v}var I=D.subarray(0,O);var M=D.subarray(O,2*O);var R=D.subarray(O*2,3*O);var L;var N=0;var k=0;var F=0;function B(e){return e>>1^-(e&1)}for(L=0;L<O;++L){N+=B(I[L]);k+=B(M[L]);F+=B(R[L]);I[L]=N;M[L]=k;R[L]=F}if(l%b!==0){l+=b-l%b}var U=C.getUint32(l,true);l+=Uint32Array.BYTES_PER_ELEMENT;var V=h.createTypedArrayFromArrayBuffer(O,t,l,U*v);l+=U*w;var z=0;for(L=0;L<V.length;++L){var q=V[L];V[L]=z-q;if(q===0){++z}}var G=C.getUint32(l,true);l+=Uint32Array.BYTES_PER_ELEMENT;var H=h.createTypedArrayFromArrayBuffer(O,t,l,G);l+=G*b;var j=C.getUint32(l,true);l+=Uint32Array.BYTES_PER_ELEMENT;var W=h.createTypedArrayFromArrayBuffer(O,t,l,j);l+=j*b;var Y=C.getUint32(l,true);l+=Uint32Array.BYTES_PER_ELEMENT;var X=h.createTypedArrayFromArrayBuffer(O,t,l,Y);l+=Y*b;var Q=C.getUint32(l,true);l+=Uint32Array.BYTES_PER_ELEMENT;var Z=h.createTypedArrayFromArrayBuffer(O,t,l,Q);l+=Q*b;var K;var J;while(l<C.byteLength){var $=C.getUint8(l,true);l+=Uint8Array.BYTES_PER_ELEMENT;var ee=C.getUint32(l,e._littleEndianExtensionSize);l+=Uint32Array.BYTES_PER_ELEMENT;if($===x.OCT_VERTEX_NORMALS&&e._requestVertexNormals){K=new Uint8Array(t,l,O*2)}else if($===x.WATER_MASK&&e._requestWaterMask){J=new Uint8Array(t,l,ee)}l+=ee}var te=e.getLevelMaximumGeometricError(n)*5;var re=e._tilingScheme.tileXYToRectangle(a,o,n);var ie;if(re.width<g.PI_OVER_TWO+g.EPSILON5){ie=_.fromRectangle(re,T,E,e._tilingScheme.ellipsoid)}return new y({center:S,minimumHeight:T,maximumHeight:E,boundingSphere:P,orientedBoundingBox:ie,horizonOcclusionPoint:A,quantizedVertices:D,encodedNormals:K,indices:V,westIndices:H,southIndices:W,eastIndices:X,northIndices:Z,westSkirtHeight:te,southSkirtHeight:te,eastSkirtHeight:te,northSkirtHeight:te,childTileMask:e.availability.computeChildMaskForTile(n,a,o),waterMask:J})}E.prototype.requestTileGeometry=function(e,r,i,n){if(!this._ready){throw new u("requestTileGeometry must not be called before the terrain provider is ready.")}var a=this._tileUrlTemplates;if(a.length===0){return undefined}var s=this._tilingScheme.getNumberOfYTilesAtLevel(i);var c=s-r-1;var d=a[(e+c+i)%a.length].replace("{z}",i).replace("{x}",e).replace("{y}",c);var f=this._proxy;if(o(f)){d=f.getURL(d)}var h=[];if(this._requestVertexNormals&&this._hasVertexNormals){h.push(this._littleEndianExtensionSize?"octvertexnormals":"vertexnormals")}if(this._requestWaterMask&&this._hasWaterMask){h.push("watermask")}if(typeof n==="boolean"){l("throttleRequests","The throttleRequest parameter for requestTileGeometry was deprecated in Cesium 1.35.  It will be removed in 1.37.");n=new b({throttle:n,throttleByServer:n,type:w.TERRAIN})}var p=m(d,P(h),n);if(!o(p)){return undefined}var v=this;return t(p,function(t){if(o(v._heightmapStructure)){return A(v,t,i,e,r,c)}return O(v,t,i,e,r,c)})};s(E.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){if(!this._ready){throw new u("credit must not be called before the terrain provider is ready.")}return this._credit}},tilingScheme:{get:function(){if(!this._ready){throw new u("tilingScheme must not be called before the terrain provider is ready.")}return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){if(!this._ready){throw new u("hasWaterMask must not be called before the terrain provider is ready.")}return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){if(!this._ready){throw new u("hasVertexNormals must not be called before the terrain provider is ready.")}return this._hasVertexNormals&&this._requestVertexNormals}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},availability:{get:function(){if(!this._ready){throw new u("availability must not be called before the terrain provider is ready.")}return this._availability}}});E.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};E.prototype.getTileDataAvailable=function(e,t,r){if(!o(this.availability)){return undefined}return this.availability.isTileAvailable(r,e,t)};return E});define("Core/EllipseGeometryLibrary",["./Cartesian3","./Math","./Matrix3","./Quaternion"],function(e,t,r,i){"use strict";var n={};var a=new e;var o=new e;var s=new i;var l=new r;function u(t,n,u,c,d,f,h,p,m,v){var g=t+n;e.multiplyByScalar(c,Math.cos(g),a);e.multiplyByScalar(u,Math.sin(g),o);e.add(a,o,a);var _=Math.cos(t);_=_*_;var y=Math.sin(t);y=y*y;var b=f/Math.sqrt(h*_+d*y);var w=b/p;i.fromAxisAngle(a,w,s);r.fromQuaternion(s,l);r.multiplyByVector(l,m,v);e.normalize(v,v);e.multiplyByScalar(v,p,v);return v}var c=new e;var d=new e;var f=new e;var h=new e;n.raisePositionsToHeight=function(t,r,i){var n=r.ellipsoid;var a=r.height;var o=r.extrudedHeight;var s=i?t.length/3*2:t.length/3;var l=new Float64Array(s*3);var u=t.length;var p=i?u:0;for(var m=0;m<u;m+=3){var v=m+1;var g=m+2;var _=e.fromArray(t,m,c);n.scaleToGeodeticSurface(_,_);var y=e.clone(_,d);var b=n.geodeticSurfaceNormal(_,h);var w=e.multiplyByScalar(b,a,f);e.add(_,w,_);if(i){e.multiplyByScalar(b,o,w);e.add(y,w,y);l[m+p]=y.x;l[v+p]=y.y;l[g+p]=y.z}l[m]=_.x;l[v]=_.y;l[g]=_.z}return l};var p=new e;var m=new e;var v=new e;n.computeEllipsePositions=function(r,i,n){var a=r.semiMinorAxis;var o=r.semiMajorAxis;var s=r.rotation;var l=r.center;var h=r.granularity*8;var g=a*a;var _=o*o;var y=o*a;var b=e.magnitude(l);var w=e.normalize(l,p);var C=e.cross(e.UNIT_Z,l,m);C=e.normalize(C,C);var S=e.cross(w,C,v);var T=1+Math.ceil(t.PI_OVER_TWO/h);var E=t.PI_OVER_TWO/(T-1);var x=t.PI_OVER_TWO-T*E;if(x<0){T-=Math.ceil(Math.abs(x)/E)}var P=2*(T*(T+2));var A=i?new Array(P*3):undefined;var O=0;var D=c;var I=d;var M=T*4*3;var R=M-1;var L=0;var N=n?new Array(M):undefined;var k;var F;var B;var U;var V;x=t.PI_OVER_TWO;D=u(x,s,S,C,g,y,_,b,w,D);if(i){A[O++]=D.x;A[O++]=D.y;A[O++]=D.z}if(n){N[R--]=D.z;N[R--]=D.y;N[R--]=D.x}x=t.PI_OVER_TWO-E;for(k=1;k<T+1;++k){D=u(x,s,S,C,g,y,_,b,w,D);I=u(Math.PI-x,s,S,C,g,y,_,b,w,I);if(i){A[O++]=D.x;A[O++]=D.y;A[O++]=D.z;B=2*k+2;for(F=1;F<B-1;++F){U=F/(B-1);V=e.lerp(D,I,U,f);A[O++]=V.x;A[O++]=V.y;A[O++]=V.z}A[O++]=I.x;A[O++]=I.y;A[O++]=I.z}if(n){N[R--]=D.z;N[R--]=D.y;N[R--]=D.x;N[L++]=I.x;N[L++]=I.y;N[L++]=I.z}x=t.PI_OVER_TWO-(k+1)*E}for(k=T;k>1;--k){x=t.PI_OVER_TWO-(k-1)*E;D=u(-x,s,S,C,g,y,_,b,w,D);I=u(x+Math.PI,s,S,C,g,y,_,b,w,I);if(i){A[O++]=D.x;A[O++]=D.y;A[O++]=D.z;B=2*(k-1)+2;for(F=1;F<B-1;++F){U=F/(B-1);V=e.lerp(D,I,U,f);A[O++]=V.x;A[O++]=V.y;A[O++]=V.z}A[O++]=I.x;A[O++]=I.y;A[O++]=I.z}if(n){N[R--]=D.z;N[R--]=D.y;N[R--]=D.x;N[L++]=I.x;N[L++]=I.y;N[L++]=I.z}}x=t.PI_OVER_TWO;D=u(-x,s,S,C,g,y,_,b,w,D);var z={};if(i){A[O++]=D.x;A[O++]=D.y;A[O++]=D.z;z.positions=A;z.numPts=T}if(n){N[R--]=D.z;N[R--]=D.y;N[R--]=D.x;z.outerPositions=N}return z};return n});define("Core/GeometryInstance",["./defaultValue","./defined","./DeveloperError","./Matrix4"],function(e,t,r,i){"use strict";function n(n){n=e(n,e.EMPTY_OBJECT);if(!t(n.geometry)){throw new r("options.geometry is required.")}this.geometry=n.geometry;this.modelMatrix=i.clone(e(n.modelMatrix,i.IDENTITY));this.id=n.id;this.pickPrimitive=n.pickPrimitive;this.attributes=e(n.attributes,{});this.westHemisphereGeometry=undefined;this.eastHemisphereGeometry=undefined}return n});define("Core/EncodedCartesian3",["./Cartesian3","./Check","./defined"],function(e,t,r){"use strict";function i(){this.high=e.clone(e.ZERO);this.low=e.clone(e.ZERO)}i.encode=function(e,i){t.typeOf.number("value",e);if(!r(i)){i={high:0,low:0}}var n;if(e>=0){n=Math.floor(e/65536)*65536;i.high=n;i.low=e-n}else{n=Math.floor(-e/65536)*65536;i.high=-n;i.low=e+n}return i};var n={high:0,low:0};i.fromCartesian=function(e,a){t.typeOf.object("cartesian",e);if(!r(a)){a=new i}var o=a.high;var s=a.low;i.encode(e.x,n);o.x=n.high;s.x=n.low;i.encode(e.y,n);o.y=n.high;s.y=n.low;i.encode(e.z,n);o.z=n.high;s.z=n.low;return a};var a=new i;i.writeElements=function(e,r,n){t.defined("cartesianArray",r);t.typeOf.number("index",n);t.typeOf.number.greaterThanOrEquals("index",n,0);i.fromCartesian(e,a);var o=a.high;var s=a.low;r[n]=o.x;r[n+1]=o.y;r[n+2]=o.z;r[n+3]=s.x;r[n+4]=s.y;r[n+5]=s.z};return i});define("Core/Tipsify",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";var i={};i.calculateACMR=function(i){i=e(i,e.EMPTY_OBJECT);var n=i.indices;var a=i.maximumIndex;var o=e(i.cacheSize,24);if(!t(n)){throw new r("indices is required.")}var s=n.length;if(s<3||s%3!==0){throw new r("indices length must be a multiple of three.")}if(a<=0){throw new r("maximumIndex must be greater than zero.")}if(o<3){throw new r("cacheSize must be greater than two.")}if(!t(a)){a=0;var l=0;var u=n[l];while(l<s){if(u>a){a=u}++l;u=n[l]}}var c=[];for(var d=0;d<a+1;d++){c[d]=0}var f=o+1;for(var h=0;h<s;++h){if(f-c[n[h]]>o){c[n[h]]=f;++f}}return(f-o+1)/(s/3)};i.tipsify=function(i){i=e(i,e.EMPTY_OBJECT);var n=i.indices;var a=i.maximumIndex;var o=e(i.cacheSize,24);var s;function l(e,t,r,i){while(t.length>=1){var n=t[t.length-1];t.splice(t.length-1,1);if(e[n].numLiveTriangles>0){return n}}while(s<i){if(e[s].numLiveTriangles>0){++s;return s-1}++s}return-1}function u(e,t,r,i,n,a,o){var s=-1;var u;var c=-1;var d=0;while(d<r.length){var f=r[d];if(i[f].numLiveTriangles){u=0;if(n-i[f].timeStamp+2*i[f].numLiveTriangles<=t){u=n-i[f].timeStamp}if(u>c||c===-1){c=u;s=f}}++d}if(s===-1){return l(i,a,e,o)}return s}if(!t(n)){throw new r("indices is required.")}var c=n.length;if(c<3||c%3!==0){throw new r("indices length must be a multiple of three.")}if(a<=0){throw new r("maximumIndex must be greater than zero.")}if(o<3){throw new r("cacheSize must be greater than two.")}var d=0;var f=0;var h=n[f];var p=c;if(t(a)){d=a+1}else{while(f<p){if(h>d){d=h}++f;h=n[f]}if(d===-1){return 0}++d}var m=[];var v;for(v=0;v<d;v++){m[v]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]}}f=0;var g=0;while(f<p){m[n[f]].vertexTriangles.push(g);++m[n[f]].numLiveTriangles;m[n[f+1]].vertexTriangles.push(g);++m[n[f+1]].numLiveTriangles;m[n[f+2]].vertexTriangles.push(g);++m[n[f+2]].numLiveTriangles;++g;f+=3}var _=0;var y=o+1;s=1;var b=[];var w=[];var C;var S;var T=0;var E=[];var x=c/3;var P=[];for(v=0;v<x;v++){P[v]=false}var A;var O;while(_!==-1){b=[];S=m[_];O=S.vertexTriangles.length;for(var D=0;D<O;++D){g=S.vertexTriangles[D];if(!P[g]){P[g]=true;f=g+g+g;for(var I=0;I<3;++I){A=n[f];b.push(A);w.push(A);E[T]=A;++T;C=m[A];--C.numLiveTriangles;if(y-C.timeStamp>o){C.timeStamp=y;++y}++f}}}_=u(n,o,b,m,y,w,d)}return E};return i});define("Core/GeometryPipeline",["./AttributeCompression","./barycentricCoordinates","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EncodedCartesian3","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryType","./IndexDatatype","./Intersect","./IntersectionTests","./Math","./Matrix3","./Matrix4","./Plane","./PrimitiveType","./Tipsify"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T){"use strict";var E={};function x(e,t,r,i,n){e[t++]=r;e[t++]=i;e[t++]=i;e[t++]=n;e[t++]=n;e[t]=r}function P(e){var t=e.length;var r=t/3*6;var i=v.createTypedArray(t,r);var n=0;for(var a=0;a<t;a+=3,n+=6){x(i,n,e[a],e[a+1],e[a+2])}return i}function A(e){var t=e.length;if(t>=3){var r=(t-2)*6;var i=v.createTypedArray(t,r);x(i,0,e[0],e[1],e[2]);var n=6;for(var a=3;a<t;++a,n+=6){x(i,n,e[a-1],e[a],e[a-2])}return i}return new Uint16Array}function O(e){if(e.length>0){var t=e.length-1;var r=(t-1)*6;var i=v.createTypedArray(t,r);var n=e[0];var a=0;for(var o=1;o<t;++o,a+=6){x(i,a,n,e[o],e[o+1])}return i}return new Uint16Array}E.toWireframe=function(e){if(!u(e)){throw new c("geometry is required.")}var t=e.indices;if(u(t)){switch(e.primitiveType){case S.TRIANGLES:e.indices=P(t);break;case S.TRIANGLE_STRIP:e.indices=A(t);break;case S.TRIANGLE_FAN:e.indices=O(t);break;default:throw new c("geometry.primitiveType must be TRIANGLES, TRIANGLE_STRIP, or TRIANGLE_FAN.")}e.primitiveType=S.LINES}return e};E.createLineSegmentsForVectors=function(e,t,i){t=l(t,"normal");if(!u(e)){throw new c("geometry is required.")}if(!u(e.attributes.position)){throw new c("geometry.attributes.position is required.")}if(!u(e.attributes[t])){throw new c("geometry.attributes must have an attribute with the same name as the attributeName parameter, "+t+".")}i=l(i,1e4);var n=e.attributes.position.values;var a=e.attributes[t].values;var o=n.length;var d=new Float64Array(2*o);var f=0;for(var m=0;m<o;m+=3){d[f++]=n[m];d[f++]=n[m+1];d[f++]=n[m+2];d[f++]=n[m]+a[m]*i;d[f++]=n[m+1]+a[m+1]*i;d[f++]=n[m+2]+a[m+2]*i}var v;var g=e.boundingSphere;if(u(g)){v=new r(g.center,g.radius+i)}return new h({attributes:{position:new p({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:d})},primitiveType:S.LINES,boundingSphere:v})};E.createAttributeLocations=function(e){if(!u(e)){throw new c("geometry is required.")}var t=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"];var r=e.attributes;var i={};var n=0;var a;var o=t.length;for(a=0;a<o;++a){var s=t[a];if(u(r[s])){i[s]=n++}}for(var l in r){if(r.hasOwnProperty(l)&&!u(i[l])){i[l]=n++}}return i};E.reorderForPreVertexCache=function(e){if(!u(e)){throw new c("geometry is required.")}var t=h.computeNumberOfVertices(e);var r=e.indices;if(u(r)){var i=new Int32Array(t);for(var n=0;n<t;n++){i[n]=-1}var a=r;var o=a.length;var l=v.createTypedArray(t,o);var d=0;var f=0;var p=0;var m;while(d<o){m=i[a[d]];if(m!==-1){l[f]=m}else{m=a[d];i[m]=p;l[f]=p;++p}++d;++f}e.indices=l;var g=e.attributes;for(var _ in g){if(g.hasOwnProperty(_)&&u(g[_])&&u(g[_].values)){var y=g[_];var b=y.values;var w=0;var C=y.componentsPerAttribute;var S=s.createTypedArray(y.componentDatatype,p*C);while(w<t){var T=i[w];if(T!==-1){for(var E=0;E<C;E++){S[C*T+E]=b[C*w+E]}}++w}y.values=S}}}return e};E.reorderForPostVertexCache=function(e,t){if(!u(e)){throw new c("geometry is required.")}var r=e.indices;if(e.primitiveType===S.TRIANGLES&&u(r)){var i=r.length;var n=0;for(var a=0;a<i;a++){if(r[a]>n){n=r[a]}}e.indices=T.tipsify({indices:r,maximumIndex:n,cacheSize:t})}return e};function D(e){var t={};for(var r in e){if(e.hasOwnProperty(r)&&u(e[r])&&u(e[r].values)){var i=e[r];t[r]=new p({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}}return t}function I(e,t,r){for(var i in t){if(t.hasOwnProperty(i)&&u(t[i])&&u(t[i].values)){var n=t[i];for(var a=0;a<n.componentsPerAttribute;++a){e[i].values.push(n.values[r*n.componentsPerAttribute+a])}}}}E.fitToUnsignedShortIndices=function(e){if(!u(e)){throw new c("geometry is required.")}if(u(e.indices)&&(e.primitiveType!==S.TRIANGLES&&e.primitiveType!==S.LINES&&e.primitiveType!==S.POINTS)){throw new c("geometry.primitiveType must equal to PrimitiveType.TRIANGLES, PrimitiveType.LINES, or PrimitiveType.POINTS.")}var t=[];var r=h.computeNumberOfVertices(e);if(u(e.indices)&&r>=y.SIXTY_FOUR_KILOBYTES){var i=[];var n=[];var a=0;var o=D(e.attributes);var s=e.indices;var l=s.length;var d;if(e.primitiveType===S.TRIANGLES){d=3}else if(e.primitiveType===S.LINES){d=2}else if(e.primitiveType===S.POINTS){d=1}for(var f=0;f<l;f+=d){for(var p=0;p<d;++p){var m=s[f+p];var v=i[m];if(!u(v)){v=a++;i[m]=v;I(o,e.attributes,m)}n.push(v)}if(a+d>=y.SIXTY_FOUR_KILOBYTES){t.push(new h({attributes:o,indices:n,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}));i=[];n=[];a=0;o=D(e.attributes)}}if(n.length!==0){t.push(new h({attributes:o,indices:n,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}}else{t.push(e)}return t};var M=new n;var R=new o;E.projectTo2D=function(e,t,r,i,a){if(!u(e)){throw new c("geometry is required.")}if(!u(t)){throw new c("attributeName is required.")}if(!u(r)){throw new c("attributeName3D is required.")}if(!u(i)){throw new c("attributeName2D is required.")}if(!u(e.attributes[t])){throw new c("geometry must have attribute matching the attributeName argument: "+t+".")}if(e.attributes[t].componentDatatype!==s.DOUBLE){throw new c("The attribute componentDatatype must be ComponentDatatype.DOUBLE.")}var o=e.attributes[t];a=u(a)?a:new f;var l=a.ellipsoid;var d=o.values;var h=new Float64Array(d.length);var m=0;for(var v=0;v<d.length;v+=3){var g=n.fromArray(d,v,M);var _=l.cartesianToCartographic(g,R);if(!u(_)){throw new c("Could not project point ("+g.x+", "+g.y+", "+g.z+") to 2D.")}var y=a.project(_,M);h[m++]=y.x;h[m++]=y.y;h[m++]=y.z}e.attributes[r]=o;e.attributes[i]=new p({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:h});delete e.attributes[t];return e};var L={high:0,low:0};E.encodeAttribute=function(e,t,r,i){if(!u(e)){throw new c("geometry is required.")}if(!u(t)){throw new c("attributeName is required.")}if(!u(r)){throw new c("attributeHighName is required.")}if(!u(i)){throw new c("attributeLowName is required.")}if(!u(e.attributes[t])){throw new c("geometry must have attribute matching the attributeName argument: "+t+".")}if(e.attributes[t].componentDatatype!==s.DOUBLE){throw new c("The attribute componentDatatype must be ComponentDatatype.DOUBLE.")}var n=e.attributes[t];var a=n.values;var o=a.length;var l=new Float32Array(o);var f=new Float32Array(o);for(var h=0;h<o;++h){d.encode(a[h],L);l[h]=L.high;f[h]=L.low}var m=n.componentsPerAttribute;e.attributes[r]=new p({componentDatatype:s.FLOAT,componentsPerAttribute:m,values:l});e.attributes[i]=new p({componentDatatype:s.FLOAT,componentsPerAttribute:m,values:f});delete e.attributes[t];return e};var N=new n;function k(e,t){if(u(t)){var r=t.values;var i=r.length;for(var a=0;a<i;a+=3){n.unpack(r,a,N);w.multiplyByPoint(e,N,N);n.pack(N,r,a)}}}function F(e,t){if(u(t)){var r=t.values;var i=r.length;for(var a=0;a<i;a+=3){n.unpack(r,a,N);b.multiplyByVector(e,N,N);N=n.normalize(N,N);n.pack(N,r,a)}}}var B=new w;var U=new b;E.transformToWorldCoordinates=function(e){if(!u(e)){throw new c("instance is required.")}var t=e.modelMatrix;if(w.equals(t,w.IDENTITY)){return e}var i=e.geometry.attributes;k(t,i.position);k(t,i.prevPosition);k(t,i.nextPosition);if(u(i.normal)||u(i.tangent)||u(i.bitangent)){w.inverse(t,B);w.transpose(B,B);w.getRotation(B,U);F(U,i.normal);F(U,i.tangent);F(U,i.bitangent)}var n=e.geometry.boundingSphere;if(u(n)){e.geometry.boundingSphere=r.transform(n,t,n)}e.modelMatrix=w.clone(w.IDENTITY);return e};function V(e,t){var r=e.length;var i={};var n=e[0][t].attributes;var a;for(a in n){if(n.hasOwnProperty(a)&&u(n[a])&&u(n[a].values)){var o=n[a];var l=o.values.length;var c=true;for(var d=1;d<r;++d){var f=e[d][t].attributes[a];if(!u(f)||o.componentDatatype!==f.componentDatatype||o.componentsPerAttribute!==f.componentsPerAttribute||o.normalize!==f.normalize){c=false;break}l+=f.values.length}if(c){i[a]=new p({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:s.createTypedArray(o.componentDatatype,l)})}}}return i}var z=new n;function q(e,t){var i=e.length;var a;var o;var s;var l;var d=e[0].modelMatrix;var f=u(e[0][t].indices);var p=e[0][t].primitiveType;for(o=1;o<i;++o){if(!w.equals(e[o].modelMatrix,d)){throw new c("All instances must have the same modelMatrix.")}if(u(e[o][t].indices)!==f){throw new c("All instance geometries must have an indices or not have one.")}if(e[o][t].primitiveType!==p){throw new c("All instance geometries must have the same primitiveType.")}}var m=V(e,t);var g;var _;var y;for(a in m){if(m.hasOwnProperty(a)){g=m[a].values;l=0;for(o=0;o<i;++o){_=e[o][t].attributes[a].values;y=_.length;for(s=0;s<y;++s){g[l++]=_[s]}}}}var b;if(f){var C=0;for(o=0;o<i;++o){C+=e[o][t].indices.length}var T=h.computeNumberOfVertices(new h({attributes:m,primitiveType:S.POINTS}));var E=v.createTypedArray(T,C);var x=0;var P=0;for(o=0;o<i;++o){var A=e[o][t].indices;var O=A.length;for(l=0;l<O;++l){E[x++]=P+A[l]}P+=h.computeNumberOfVertices(e[o][t])}b=E}var D=new n;var I=0;var M;for(o=0;o<i;++o){M=e[o][t].boundingSphere;if(!u(M)){D=undefined;break}n.add(M.center,D,D)}if(u(D)){n.divideByScalar(D,i,D);for(o=0;o<i;++o){M=e[o][t].boundingSphere;var R=n.magnitude(n.subtract(M.center,D,z))+M.radius;if(R>I){I=R}}}return new h({attributes:m,indices:b,primitiveType:p,boundingSphere:u(D)?new r(D,I):undefined})}E.combineInstances=function(e){if(!u(e)||e.length<1){throw new c("instances is required and must have length greater than zero.")}var t=[];var r=[];var i=e.length;for(var n=0;n<i;++n){var a=e[n];if(u(a.geometry)){t.push(a)}else if(u(a.westHemisphereGeometry)&&u(a.eastHemisphereGeometry)){r.push(a)}}var o=[];if(t.length>0){o.push(q(t,"geometry"))}if(r.length>0){o.push(q(r,"westHemisphereGeometry"));o.push(q(r,"eastHemisphereGeometry"))}return o};var G=new n;var H=new n;var j=new n;var W=new n;E.computeNormal=function(e){if(!u(e)){throw new c("geometry is required.")}if(!u(e.attributes.position)||!u(e.attributes.position.values)){throw new c("geometry.attributes.position.values is required.")}if(!u(e.indices)){throw new c("geometry.indices is required.")}if(e.indices.length<2||e.indices.length%3!==0){throw new c("geometry.indices length must be greater than 0 and be a multiple of 3.")}if(e.primitiveType!==S.TRIANGLES){throw new c("geometry.primitiveType must be PrimitiveType.TRIANGLES.")}var t=e.indices;var r=e.attributes;var i=r.position.values;var a=r.position.values.length/3;var o=t.length;var l=new Array(a);var d=new Array(o/3);var f=new Array(o);var h;for(h=0;h<a;h++){l[h]={indexOffset:0,count:0,currentCount:0}}var m=0;for(h=0;h<o;h+=3){var v=t[h];var g=t[h+1];var _=t[h+2];var b=v*3;var w=g*3;var C=_*3;H.x=i[b];H.y=i[b+1];H.z=i[b+2];j.x=i[w];j.y=i[w+1];j.z=i[w+2];W.x=i[C];W.y=i[C+1];W.z=i[C+2];l[v].count++;l[g].count++;l[_].count++;n.subtract(j,H,j);n.subtract(W,H,W);d[m]=n.cross(j,W,new n);m++}var T=0;for(h=0;h<a;h++){l[h].indexOffset+=T;T+=l[h].count}m=0;var E;for(h=0;h<o;h+=3){E=l[t[h]];var x=E.indexOffset+E.currentCount;f[x]=m;E.currentCount++;E=l[t[h+1]];x=E.indexOffset+E.currentCount;f[x]=m;E.currentCount++;E=l[t[h+2]];x=E.indexOffset+E.currentCount;f[x]=m;E.currentCount++;m++}var P=new Float32Array(a*3);for(h=0;h<a;h++){var A=h*3;E=l[h];n.clone(n.ZERO,G);if(E.count>0){for(m=0;m<E.count;m++){n.add(G,d[f[E.indexOffset+m]],G)}if(n.equalsEpsilon(n.ZERO,G,y.EPSILON10)){n.clone(d[f[E.indexOffset]],G)}}if(n.equalsEpsilon(n.ZERO,G,y.EPSILON10)){G.z=1}n.normalize(G,G);P[A]=G.x;P[A+1]=G.y;P[A+2]=G.z}e.attributes.normal=new p({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:P});return e};var Y=new n;var X=new n;var Q=new n;E.computeTangentAndBitangent=function(e){if(!u(e)){throw new c("geometry is required.")}var t=e.attributes;var r=e.indices;if(!u(t.position)||!u(t.position.values)){throw new c("geometry.attributes.position.values is required.")}if(!u(t.normal)||!u(t.normal.values)){throw new c("geometry.attributes.normal.values is required.")}if(!u(t.st)||!u(t.st.values)){throw new c("geometry.attributes.st.values is required.")}if(!u(r)){throw new c("geometry.indices is required.")}if(r.length<2||r.length%3!==0){throw new c("geometry.indices length must be greater than 0 and be a multiple of 3.")}if(e.primitiveType!==S.TRIANGLES){throw new c("geometry.primitiveType must be PrimitiveType.TRIANGLES.")}var i=e.attributes.position.values;var a=e.attributes.normal.values;var o=e.attributes.st.values;var l=e.attributes.position.values.length/3;var d=r.length;var f=new Array(l*3);var h;for(h=0;h<f.length;h++){f[h]=0}var m;var v;var g;for(h=0;h<d;h+=3){var _=r[h];var y=r[h+1];var b=r[h+2];m=_*3;v=y*3;g=b*3;var w=_*2;var C=y*2;var T=b*2;var E=i[m];var x=i[m+1];var P=i[m+2];var A=o[w];var O=o[w+1];var D=o[C+1]-O;var I=o[T+1]-O;var M=1/((o[C]-A)*I-(o[T]-A)*D);var R=(I*(i[v]-E)-D*(i[g]-E))*M;var L=(I*(i[v+1]-x)-D*(i[g+1]-x))*M;var N=(I*(i[v+2]-P)-D*(i[g+2]-P))*M;f[m]+=R;f[m+1]+=L;f[m+2]+=N;f[v]+=R;f[v+1]+=L;f[v+2]+=N;f[g]+=R;f[g+1]+=L;f[g+2]+=N}var k=new Float32Array(l*3);var F=new Float32Array(l*3);for(h=0;h<l;h++){m=h*3;v=m+1;g=m+2;var B=n.fromArray(a,m,Y);var U=n.fromArray(f,m,Q);var V=n.dot(B,U);n.multiplyByScalar(B,V,X);n.normalize(n.subtract(U,X,U),U);k[m]=U.x;k[v]=U.y;k[g]=U.z;n.normalize(n.cross(B,U,U),U);F[m]=U.x;F[v]=U.y;F[g]=U.z}e.attributes.tangent=new p({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:k});e.attributes.bitangent=new p({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:F});return e};var Z=new i;var K=new n;var J=new n;var $=new n;var ee=new i;E.compressVertices=function(t){if(!u(t)){throw new c("geometry is required.")}var r=t.attributes.extrudeDirection;var a;var o;if(u(r)){var l=r.values;o=l.length/3;var d=new Float32Array(o*2);var f=0;for(a=0;a<o;++a){n.fromArray(l,a*3,K);if(n.equals(K,n.ZERO)){f+=2;continue}ee=e.octEncodeInRange(K,65535,ee);d[f++]=ee.x;d[f++]=ee.y}t.attributes.compressedAttributes=new p({componentDatatype:s.FLOAT,componentsPerAttribute:2,values:d});delete t.attributes.extrudeDirection;return t}var h=t.attributes.normal;var m=t.attributes.st;var v=u(h);var g=u(m);if(!v&&!g){return t}var _=t.attributes.tangent;var y=t.attributes.bitangent;var b=u(_);var w=u(y);var C;var S;var T;var E;if(v){C=h.values}if(g){S=m.values}if(b){T=_.values}if(w){E=y.values}var x=v?C.length:S.length;var P=v?3:2;o=x/P;var A=o;var O=g&&v?2:1;O+=b||w?1:0;A*=O;var D=new Float32Array(A);var I=0;for(a=0;a<o;++a){if(g){i.fromArray(S,a*2,Z);D[I++]=e.compressTextureCoordinates(Z)}var M=a*3;if(v&&u(T)&&u(E)){n.fromArray(C,M,K);n.fromArray(T,M,J);n.fromArray(E,M,$);e.octPack(K,J,$,Z);D[I++]=Z.x;D[I++]=Z.y}else{if(v){n.fromArray(C,M,K);D[I++]=e.octEncodeFloat(K)}if(b){n.fromArray(T,M,K);D[I++]=e.octEncodeFloat(K)}if(w){n.fromArray(E,M,K);D[I++]=e.octEncodeFloat(K)}}}t.attributes.compressedAttributes=new p({componentDatatype:s.FLOAT,componentsPerAttribute:O,values:D});if(v){delete t.attributes.normal}if(g){delete t.attributes.st}if(w){delete t.attributes.bitangent}if(b){delete t.attributes.tangent}return t};function te(e){if(u(e.indices)){return e}var t=h.computeNumberOfVertices(e);if(t<3){throw new c("The number of vertices must be at least three.")}if(t%3!==0){throw new c("The number of vertices must be a multiple of three.")}var r=v.createTypedArray(t,t);for(var i=0;i<t;++i){r[i]=i}e.indices=r;return e}function re(e){var t=h.computeNumberOfVertices(e);if(t<3){throw new c("The number of vertices must be at least three.")}var r=v.createTypedArray(t,(t-2)*3);r[0]=1;r[1]=0;r[2]=2;var i=3;for(var n=3;n<t;++n){r[i++]=n-1;r[i++]=0;r[i++]=n}e.indices=r;e.primitiveType=S.TRIANGLES;return e}function ie(e){var t=h.computeNumberOfVertices(e);if(t<3){throw new c("The number of vertices must be at least 3.")}var r=v.createTypedArray(t,(t-2)*3);r[0]=0;r[1]=1;r[2]=2;if(t>3){r[3]=0;r[4]=2;r[5]=3}var i=6;for(var n=3;n<t-1;n+=2){r[i++]=n;r[i++]=n-1;r[i++]=n+1;if(n+2<t){r[i++]=n;r[i++]=n+1;r[i++]=n+2}}e.indices=r;e.primitiveType=S.TRIANGLES;return e}function ne(e){if(u(e.indices)){return e}var t=h.computeNumberOfVertices(e);if(t<2){throw new c("The number of vertices must be at least two.")}if(t%2!==0){throw new c("The number of vertices must be a multiple of 2.")}var r=v.createTypedArray(t,t);for(var i=0;i<t;++i){r[i]=i}e.indices=r;return e}function ae(e){var t=h.computeNumberOfVertices(e);if(t<2){throw new c("The number of vertices must be at least two.")}var r=v.createTypedArray(t,(t-1)*2);r[0]=0;r[1]=1;var i=2;for(var n=2;n<t;++n){r[i++]=n-1;r[i++]=n}e.indices=r;e.primitiveType=S.LINES;return e}function oe(e){var t=h.computeNumberOfVertices(e);if(t<2){throw new c("The number of vertices must be at least two.")}var r=v.createTypedArray(t,t*2);r[0]=0;r[1]=1;var i=2;for(var n=2;n<t;++n){r[i++]=n-1;r[i++]=n}r[i++]=t-1;r[i]=0;e.indices=r;e.primitiveType=S.LINES;return e}function se(e){switch(e.primitiveType){case S.TRIANGLE_FAN:return re(e);case S.TRIANGLE_STRIP:return ie(e);case S.TRIANGLES:return te(e);case S.LINE_STRIP:return ae(e);case S.LINE_LOOP:return oe(e);case S.LINES:return ne(e)}return e}function le(e,t){if(Math.abs(e.y)<y.EPSILON6){if(t){e.y=-y.EPSILON6}else{e.y=y.EPSILON6}}}function ue(e,t,r){if(e.y!==0&&t.y!==0&&r.y!==0){le(e,e.y<0);le(t,t.y<0);le(r,r.y<0);return}var i=Math.abs(e.y);var n=Math.abs(t.y);var a=Math.abs(r.y);var o;if(i>n){if(i>a){o=y.sign(e.y)}else{o=y.sign(r.y)}}else if(n>a){o=y.sign(t.y)}else{o=y.sign(r.y)}var s=o<0;le(e,s);le(t,s);le(r,s)}var ce=new n;function de(e,t,r,i){n.add(e,n.multiplyByScalar(n.subtract(t,e,ce),e.y/(e.y-t.y),ce),r);n.clone(r,i);le(r,true);le(i,false)}var fe=new n;var he=new n;var pe=new n;var me=new n;var ve={positions:new Array(7),indices:new Array(3*3)};function ge(e,t,r){if(e.x>=0||t.x>=0||r.x>=0){return undefined}ue(e,t,r);var i=e.y<0;var n=t.y<0;var a=r.y<0;var o=0;o+=i?1:0;o+=n?1:0;o+=a?1:0;var s=ve.indices;if(o===1){s[1]=3;s[2]=4;s[5]=6;s[7]=6;s[8]=5;if(i){de(e,t,fe,pe);de(e,r,he,me);s[0]=0;s[3]=1;s[4]=2;s[6]=1}else if(n){de(t,r,fe,pe);de(t,e,he,me);s[0]=1;s[3]=2;s[4]=0;s[6]=2}else if(a){de(r,e,fe,pe);de(r,t,he,me);s[0]=2;s[3]=0;s[4]=1;s[6]=0}}else if(o===2){s[2]=4;s[4]=4;s[5]=3;s[7]=5;s[8]=6;if(!i){de(e,t,fe,pe);de(e,r,he,me);s[0]=1;s[1]=2;s[3]=1;s[6]=0}else if(!n){de(t,r,fe,pe);de(t,e,he,me);s[0]=2;s[1]=0;s[3]=2;s[6]=1}else if(!a){de(r,e,fe,pe);de(r,t,he,me);s[0]=0;s[1]=1;s[3]=0;s[6]=2}}var l=ve.positions;l[0]=e;l[1]=t;l[2]=r;l.length=3;if(o===1||o===2){l[3]=fe;l[4]=he;l[5]=pe;l[6]=me;l.length=7}return ve}function _e(e,t){var i=e.attributes;if(i.position.values.length===0){return undefined}for(var n in i){if(i.hasOwnProperty(n)&&u(i[n])&&u(i[n].values)){var a=i[n];a.values=s.createTypedArray(a.componentDatatype,a.values)}}var o=h.computeNumberOfVertices(e);e.indices=v.createTypedArray(o,e.indices);if(t){e.boundingSphere=r.fromVertices(i.position.values)}return e}function ye(e){var t=e.attributes;var r={};for(var i in t){if(t.hasOwnProperty(i)&&u(t[i])&&u(t[i].values)){var n=t[i];r[i]=new p({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]})}}return new h({attributes:r,indices:[],primitiveType:e.primitiveType})}function be(e,t,r){var i=u(e.geometry.boundingSphere);t=_e(t,i);r=_e(r,i);if(u(r)&&!u(t)){e.geometry=r}else if(!u(r)&&u(t)){e.geometry=t}else{e.westHemisphereGeometry=t;e.eastHemisphereGeometry=r;e.geometry=undefined}}var we=new n;var Ce=new n;var Se=new n;var Te=new n;var Ee=new i;var xe=new i;var Pe=new i;function Ae(e,r,a,o,s,l,c,d,f,h,p,m){if(!u(l)&&!u(c)&&!u(d)&&!u(f)&&!u(h)){return}var v=n.fromArray(s,e*3,we);var g=n.fromArray(s,r*3,Ce);var _=n.fromArray(s,a*3,Se);var y=t(o,v,g,_,Te);if(u(l)){var b=n.fromArray(l,e*3,we);var w=n.fromArray(l,r*3,Ce);var C=n.fromArray(l,a*3,Se);n.multiplyByScalar(b,y.x,b);n.multiplyByScalar(w,y.y,w);n.multiplyByScalar(C,y.z,C);var S=n.add(b,w,b);n.add(S,C,S);n.normalize(S,S);n.pack(S,p.normal.values,m*3)}if(u(h)){var T=n.fromArray(h,e*3,we);var E=n.fromArray(h,r*3,Ce);var x=n.fromArray(h,a*3,Se);n.multiplyByScalar(T,y.x,T);n.multiplyByScalar(E,y.y,E);n.multiplyByScalar(x,y.z,x);var P;if(!n.equals(T,n.ZERO)||!n.equals(E,n.ZERO)||!n.equals(x,n.ZERO)){P=n.add(T,E,T);n.add(P,x,P);n.normalize(P,P)}else{P=we;P.x=0;P.y=0;P.z=0}n.pack(P,p.extrudeDirection.values,m*3)}if(u(c)){var A=n.fromArray(c,e*3,we);var O=n.fromArray(c,r*3,Ce);var D=n.fromArray(c,a*3,Se);n.multiplyByScalar(A,y.x,A);n.multiplyByScalar(O,y.y,O);n.multiplyByScalar(D,y.z,D);var I=n.add(A,O,A);n.add(I,D,I);n.normalize(I,I);n.pack(I,p.tangent.values,m*3)}if(u(d)){var M=n.fromArray(d,e*3,we);var R=n.fromArray(d,r*3,Ce);var L=n.fromArray(d,a*3,Se);n.multiplyByScalar(M,y.x,M);n.multiplyByScalar(R,y.y,R);n.multiplyByScalar(L,y.z,L);var N=n.add(M,R,M);n.add(N,L,N);n.normalize(N,N);n.pack(N,p.bitangent.values,m*3)}if(u(f)){var k=i.fromArray(f,e*2,Ee);var F=i.fromArray(f,r*2,xe);var B=i.fromArray(f,a*2,Pe);i.multiplyByScalar(k,y.x,k);i.multiplyByScalar(F,y.y,F);i.multiplyByScalar(B,y.z,B);var U=i.add(k,F,k);i.add(U,B,U);i.pack(U,p.st.values,m*2)}}function Oe(e,t,r,i,n,a){var o=e.position.values.length/3;if(n!==-1){var s=i[n];var l=r[s];if(l===-1){r[s]=o;e.position.values.push(a.x,a.y,a.z);t.push(o);return o}t.push(l);return l}e.position.values.push(a.x,a.y,a.z);t.push(o);return o}function De(e){var t=e.geometry;var r=t.attributes;var i=r.position.values;var a=u(r.normal)?r.normal.values:undefined;var o=u(r.bitangent)?r.bitangent.values:undefined;var s=u(r.tangent)?r.tangent.values:undefined;var l=u(r.st)?r.st.values:undefined;var c=u(r.extrudeDirection)?r.extrudeDirection.values:undefined;var d=t.indices;var f=ye(t);var h=ye(t);var p;var m;var v;var g;var _;var y=[];y.length=i.length/3;var b=[];b.length=i.length/3;for(_=0;_<y.length;++_){y[_]=-1;b[_]=-1}var w=d.length;for(_=0;_<w;_+=3){var C=d[_];var S=d[_+1];var T=d[_+2];var E=n.fromArray(i,C*3);var x=n.fromArray(i,S*3);var P=n.fromArray(i,T*3);var A=ge(E,x,P);if(u(A)&&A.positions.length>3){var O=A.positions;var D=A.indices;var I=D.length;for(var M=0;M<I;++M){var R=D[M];var L=O[R];if(L.y<0){p=h.attributes;m=h.indices;v=y}else{p=f.attributes;m=f.indices;v=b}g=Oe(p,m,v,d,R<3?_+R:-1,L);Ae(C,S,T,L,i,a,s,o,l,c,p,g)}}else{if(u(A)){E=A.positions[0];x=A.positions[1];P=A.positions[2]}if(E.y<0){p=h.attributes;m=h.indices;v=y}else{p=f.attributes;m=f.indices;v=b}g=Oe(p,m,v,d,_,E);Ae(C,S,T,E,i,a,s,o,l,c,p,g);g=Oe(p,m,v,d,_+1,x);Ae(C,S,T,x,i,a,s,o,l,c,p,g);g=Oe(p,m,v,d,_+2,P);Ae(C,S,T,P,i,a,s,o,l,c,p,g)}}be(e,h,f)}var Ie=C.fromPointNormal(n.ZERO,n.UNIT_Y);var Me=new n;var Re=new n;function Le(e){var t=e.geometry;var r=t.attributes;var i=r.position.values;var a=t.indices;var o=ye(t);var s=ye(t);var l;var c=a.length;var d=[];d.length=i.length/3;var f=[];f.length=i.length/3;for(l=0;l<d.length;++l){d[l]=-1;f[l]=-1}for(l=0;l<c;l+=2){var h=a[l];var p=a[l+1];var m=n.fromArray(i,h*3,we);var v=n.fromArray(i,p*3,Ce);if(Math.abs(m.y)<y.EPSILON6){if(m.y<0){m.y=-y.EPSILON6}else{m.y=y.EPSILON6}}if(Math.abs(v.y)<y.EPSILON6){if(v.y<0){v.y=-y.EPSILON6}else{v.y=y.EPSILON6}}var g=o.attributes;var b=o.indices;var w=f;var C=s.attributes;var S=s.indices;var T=d;var E=_.lineSegmentPlane(m,v,Ie,Se);if(u(E)){var x=n.multiplyByScalar(n.UNIT_Y,5*y.EPSILON9,Me);if(m.y<0){n.negate(x,x);g=s.attributes;b=s.indices;w=d;C=o.attributes;S=o.indices;T=f}var P=n.add(E,x,Re);Oe(g,b,w,a,l,m);Oe(g,b,w,a,-1,P);n.negate(x,x);n.add(E,x,P);Oe(C,S,T,a,-1,P);Oe(C,S,T,a,l+1,v)}else{var A;var O;var D;if(m.y<0){A=s.attributes;O=s.indices;D=d}else{A=o.attributes;O=o.indices;D=f}Oe(A,O,D,a,l,m);Oe(A,O,D,a,l+1,v)}}be(e,s,o)}var Ne=new i;var ke=new i;var Fe=new n;var Be=new n;var Ue=new n;var Ve=new n;var ze=new n;var qe=new n;var Ge=new a;function He(e){var t=e.attributes;var r=t.position.values;var i=t.prevPosition.values;var a=t.nextPosition.values;var o=r.length;for(var s=0;s<o;s+=3){var l=n.unpack(r,s,Fe);if(l.x>0){continue}var u=n.unpack(i,s,Be);if(l.y<0&&u.y>0||l.y>0&&u.y<0){if(s-3>0){i[s]=r[s-3];i[s+1]=r[s-2];i[s+2]=r[s-1]}else{n.pack(l,i,s)}}var c=n.unpack(a,s,Ue);if(l.y<0&&c.y>0||l.y>0&&c.y<0){if(s+3<o){a[s]=r[s+3];a[s+1]=r[s+4];a[s+2]=r[s+5]}else{n.pack(l,a,s)}}}}var je=5*y.EPSILON9;var We=y.EPSILON6;function Ye(e){var t=e.geometry;var r=t.attributes;var o=r.position.values;var s=r.prevPosition.values;var l=r.nextPosition.values;var c=r.expandAndWidth.values;var d=u(r.st)?r.st.values:undefined;var f=u(r.color)?r.color.values:undefined;var h=ye(t);var p=ye(t);var m;var v;var g;var b=false;var w=o.length/3;for(m=0;m<w;m+=4){var C=m;var S=m+2;var T=n.fromArray(o,C*3,Fe);var E=n.fromArray(o,S*3,Be);if(Math.abs(T.y)<We){T.y=We*(E.y<0?-1:1);o[m*3+1]=T.y;o[(m+1)*3+1]=T.y;for(v=C*3;v<C*3+4*3;v+=3){s[v]=o[m*3];s[v+1]=o[m*3+1];s[v+2]=o[m*3+2]}}if(Math.abs(E.y)<We){E.y=We*(T.y<0?-1:1);o[(m+2)*3+1]=E.y;o[(m+3)*3+1]=E.y;for(v=C*3;v<C*3+4*3;v+=3){l[v]=o[(m+2)*3];l[v+1]=o[(m+2)*3+1];l[v+2]=o[(m+2)*3+2]}}var x=h.attributes;var P=h.indices;var A=p.attributes;var O=p.indices;var D=_.lineSegmentPlane(T,E,Ie,Ve);if(u(D)){b=true;var I=n.multiplyByScalar(n.UNIT_Y,je,ze);if(T.y<0){n.negate(I,I);x=p.attributes;P=p.indices;A=h.attributes;O=h.indices}var M=n.add(D,I,qe);x.position.values.push(T.x,T.y,T.z,T.x,T.y,T.z);x.position.values.push(M.x,M.y,M.z);x.position.values.push(M.x,M.y,M.z);x.prevPosition.values.push(s[C*3],s[C*3+1],s[C*3+2]);x.prevPosition.values.push(s[C*3+3],s[C*3+4],s[C*3+5]);x.prevPosition.values.push(T.x,T.y,T.z,T.x,T.y,T.z);x.nextPosition.values.push(M.x,M.y,M.z);x.nextPosition.values.push(M.x,M.y,M.z);x.nextPosition.values.push(M.x,M.y,M.z);x.nextPosition.values.push(M.x,M.y,M.z);n.negate(I,I);n.add(D,I,M);A.position.values.push(M.x,M.y,M.z);A.position.values.push(M.x,M.y,M.z);A.position.values.push(E.x,E.y,E.z,E.x,E.y,E.z);A.prevPosition.values.push(M.x,M.y,M.z);A.prevPosition.values.push(M.x,M.y,M.z);A.prevPosition.values.push(M.x,M.y,M.z);A.prevPosition.values.push(M.x,M.y,M.z);A.nextPosition.values.push(E.x,E.y,E.z,E.x,E.y,E.z);A.nextPosition.values.push(l[S*3],l[S*3+1],l[S*3+2]);A.nextPosition.values.push(l[S*3+3],l[S*3+4],l[S*3+5]);var R=i.fromArray(c,C*2,Ne);var L=Math.abs(R.y);x.expandAndWidth.values.push(-1,L,1,L);x.expandAndWidth.values.push(-1,-L,1,-L);A.expandAndWidth.values.push(-1,L,1,L);A.expandAndWidth.values.push(-1,-L,1,-L);var N=n.magnitudeSquared(n.subtract(D,T,Ue));N/=n.magnitudeSquared(n.subtract(E,T,Ue));if(u(f)){var k=a.fromArray(f,C*4,Ge);var F=a.fromArray(f,S*4,Ge);var B=y.lerp(k.x,F.x,N);var U=y.lerp(k.y,F.y,N);var V=y.lerp(k.z,F.z,N);var z=y.lerp(k.w,F.w,N);for(v=C*4;v<C*4+2*4;++v){x.color.values.push(f[v])}x.color.values.push(B,U,V,z);x.color.values.push(B,U,V,z);A.color.values.push(B,U,V,z);A.color.values.push(B,U,V,z);for(v=S*4;v<S*4+2*4;++v){A.color.values.push(f[v])}}if(u(d)){var q=i.fromArray(d,C*2,Ne);var G=i.fromArray(d,(m+3)*2,ke);var H=y.lerp(q.x,G.x,N);for(v=C*2;v<C*2+2*2;++v){x.st.values.push(d[v])}x.st.values.push(H,q.y);x.st.values.push(H,G.y);A.st.values.push(H,q.y);A.st.values.push(H,G.y);for(v=S*2;v<S*2+2*2;++v){A.st.values.push(d[v])}}g=x.position.values.length/3-4;P.push(g,g+2,g+1);P.push(g+1,g+2,g+3);g=A.position.values.length/3-4;O.push(g,g+2,g+1);O.push(g+1,g+2,g+3)}else{var j;var W;if(T.y<0){j=p.attributes;W=p.indices}else{j=h.attributes;W=h.indices}j.position.values.push(T.x,T.y,T.z);j.position.values.push(T.x,T.y,T.z);j.position.values.push(E.x,E.y,E.z);j.position.values.push(E.x,E.y,E.z);for(v=m*3;v<m*3+4*3;++v){j.prevPosition.values.push(s[v]);j.nextPosition.values.push(l[v])}for(v=m*2;v<m*2+4*2;++v){j.expandAndWidth.values.push(c[v]);if(u(d)){j.st.values.push(d[v])}}if(u(f)){for(v=m*4;v<m*4+4*4;++v){j.color.values.push(f[v])}}g=j.position.values.length/3-4;W.push(g,g+2,g+1);W.push(g+1,g+2,g+3)}}if(b){He(p);He(h)}be(e,p,h)}E.splitLongitude=function(e){if(!u(e)){throw new c("instance is required.")}var t=e.geometry;var i=t.boundingSphere;if(u(i)){var n=i.center.x-i.radius;if(n>0||r.intersectPlane(i,C.ORIGIN_ZX_PLANE)!==g.INTERSECTING){return e}}if(t.geometryType!==m.NONE){switch(t.geometryType){case m.POLYLINES:Ye(e);break;case m.TRIANGLES:De(e);break;case m.LINES:Le(e);break}}else{se(t);if(t.primitiveType===S.TRIANGLES){De(e)}else if(t.primitiveType===S.LINES){Le(e)}}return e};return E});define("Core/EllipseGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./EllipseGeometryLibrary","./Ellipsoid","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./Matrix4","./PrimitiveType","./Quaternion","./Rectangle","./Transforms","./VertexFormat"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E){"use strict";var x=new r;var P=new r;var A=new r;var O=new r;var D=new t;var I=new y;var M=new C;var R=new r;var L=new r;var N=new r;var k=new i;var F=new r;var B=new t;var U=new t;function V(e,i,a){var o=i.vertexFormat;var s=i.center;var l=i.semiMajorAxis;var c=i.semiMinorAxis;var f=i.ellipsoid;var m=i.stRotation;var v=a?e.length/3*2:e.length/3;var g=i.shadowVolume;var _=o.st?new Float32Array(v*2):undefined;var b=o.normal?new Float32Array(v*3):undefined;var w=o.tangent?new Float32Array(v*3):undefined;var S=o.bitangent?new Float32Array(v*3):undefined;var T=g?new Float32Array(v*3):undefined;var E=0;var O=R;var V=L;var z=N;var q=new d(f);var G=q.project(f.cartesianToCartographic(s,k),F);var H=f.scaleToGeodeticSurface(s,x);f.geodeticSurfaceNormal(H,H);var j=C.fromAxisAngle(H,m,M);var W=y.fromQuaternion(j,I);var Y=t.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,B);var X=t.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,U);var Q=e.length;var Z=a?Q:0;var K=Z/3*2;for(var J=0;J<Q;J+=3){var $=J+1;var ee=J+2;var te=r.fromArray(e,J,x);if(o.st){var re=y.multiplyByVector(W,te,P);var ie=q.project(f.cartesianToCartographic(re,k),A);r.subtract(ie,G,ie);D.x=(ie.x+l)/(2*l);D.y=(ie.y+c)/(2*c);Y.x=Math.min(D.x,Y.x);Y.y=Math.min(D.y,Y.y);X.x=Math.max(D.x,X.x);X.y=Math.max(D.y,X.y);if(a){_[E+K]=D.x;_[E+1+K]=D.y}_[E++]=D.x;_[E++]=D.y}if(o.normal||o.tangent||o.bitangent||g){O=f.geodeticSurfaceNormal(te,O);if(g){T[J+Z]=-O.x;T[$+Z]=-O.y;T[ee+Z]=-O.z}if(o.normal||o.tangent||o.bitangent){if(o.tangent||o.bitangent){V=r.normalize(r.cross(r.UNIT_Z,O,V),V);y.multiplyByVector(W,V,V)}if(o.normal){b[J]=O.x;b[$]=O.y;b[ee]=O.z;if(a){b[J+Z]=-O.x;b[$+Z]=-O.y;b[ee+Z]=-O.z}}if(o.tangent){w[J]=V.x;w[$]=V.y;w[ee]=V.z;if(a){w[J+Z]=-V.x;w[$+Z]=-V.y;w[ee+Z]=-V.z}}if(o.bitangent){z=r.normalize(r.cross(O,V,z),z);S[J]=z.x;S[$]=z.y;S[ee]=z.z;if(a){S[J+Z]=z.x;S[$+Z]=z.y;S[ee+Z]=z.z}}}}}if(o.st){Q=_.length;for(var ne=0;ne<Q;ne+=2){_[ne]=(_[ne]-Y.x)/(X.x-Y.x);_[ne+1]=(_[ne+1]-Y.y)/(X.y-Y.y)}}var ae=new p;if(o.position){var oe=u.raisePositionsToHeight(e,i,a);ae.position=new h({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:oe})}if(o.st){ae.st=new h({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:_})}if(o.normal){ae.normal=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:b})}if(o.tangent){ae.tangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:w})}if(o.bitangent){ae.bitangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:S})}if(g){ae.extrudeDirection=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:T})}return ae}function z(e){var t=new Array(12*(e*(e+1))-6);var r=0;var i;var n;var a;var o;var s;i=0;a=1;for(o=0;o<3;o++){t[r++]=a++;t[r++]=i;t[r++]=a}for(o=2;o<e+1;++o){a=o*(o+1)-1;i=(o-1)*o-1;t[r++]=a++;t[r++]=i;t[r++]=a;n=2*o;for(s=0;s<n-1;++s){t[r++]=a;t[r++]=i++;t[r++]=i;t[r++]=a++;t[r++]=i;t[r++]=a}t[r++]=a++;t[r++]=i;t[r++]=a}n=e*2;++a;++i;for(o=0;o<n-1;++o){t[r++]=a;t[r++]=i++;t[r++]=i;t[r++]=a++;t[r++]=i;t[r++]=a}t[r++]=a;t[r++]=i++;t[r++]=i;t[r++]=a++;t[r++]=i++;t[r++]=i;++i;for(o=e-1;o>1;--o){t[r++]=i++;t[r++]=i;t[r++]=a;n=2*o;for(s=0;s<n-1;++s){t[r++]=a;t[r++]=i++;t[r++]=i;t[r++]=a++;t[r++]=i;t[r++]=a}t[r++]=i++;t[r++]=i++;t[r++]=a++}for(o=0;o<3;o++){t[r++]=i++;t[r++]=i;t[r++]=a}return t}var q=new r;function G(t){var i=t.center;q=r.multiplyByScalar(t.ellipsoid.geodeticSurfaceNormal(i,q),t.height,q);q=r.add(i,q,q);var n=new e(q,t.semiMajorAxis);var a=u.computeEllipsePositions(t,true,false);var o=a.positions;var s=a.numPts;var l=V(o,t,false);var c=z(s);c=g.createTypedArray(o.length/3,c);return{boundingSphere:n,attributes:l,indices:c}}function H(e,i){var a=i.vertexFormat;var o=i.center;var s=i.semiMajorAxis;var l=i.semiMinorAxis;var u=i.ellipsoid;var c=i.height;var f=i.extrudedHeight;var m=i.stRotation;var v=e.length/3*2;var g=new Float64Array(v*3);var _=a.st?new Float32Array(v*2):undefined;var b=a.normal?new Float32Array(v*3):undefined;var w=a.tangent?new Float32Array(v*3):undefined;var S=a.bitangent?new Float32Array(v*3):undefined;var T=i.shadowVolume;var E=T?new Float32Array(v*3):undefined;var V=0;var z=R;var q=L;var G=N;var H=new d(u);var j=H.project(u.cartesianToCartographic(o,k),F);var W=u.scaleToGeodeticSurface(o,x);u.geodeticSurfaceNormal(W,W);var Y=C.fromAxisAngle(W,m,M);var X=y.fromQuaternion(Y,I);var Q=t.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,B);var Z=t.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,U);var K=e.length;var J=K/3*2;for(var $=0;$<K;$+=3){var ee=$+1;var te=$+2;var re=r.fromArray(e,$,x);var ie;if(a.st){var ne=y.multiplyByVector(X,re,P);var ae=H.project(u.cartesianToCartographic(ne,k),A);r.subtract(ae,j,ae);D.x=(ae.x+s)/(2*s);D.y=(ae.y+l)/(2*l);Q.x=Math.min(D.x,Q.x);Q.y=Math.min(D.y,Q.y);Z.x=Math.max(D.x,Z.x);Z.y=Math.max(D.y,Z.y);_[V+J]=D.x;_[V+1+J]=D.y;_[V++]=D.x;_[V++]=D.y}re=u.scaleToGeodeticSurface(re,re);ie=r.clone(re,P);z=u.geodeticSurfaceNormal(re,z);if(T){E[$+K]=-z.x;E[ee+K]=-z.y;E[te+K]=-z.z}var oe=r.multiplyByScalar(z,c,O);re=r.add(re,oe,re);oe=r.multiplyByScalar(z,f,oe);ie=r.add(ie,oe,ie);if(a.position){g[$+K]=ie.x;g[ee+K]=ie.y;g[te+K]=ie.z;g[$]=re.x;g[ee]=re.y;g[te]=re.z}if(a.normal||a.tangent||a.bitangent){G=r.clone(z,G);var se=r.fromArray(e,($+3)%K,O);r.subtract(se,re,se);var le=r.subtract(ie,re,A);z=r.normalize(r.cross(le,se,z),z);if(a.normal){b[$]=z.x;b[ee]=z.y;b[te]=z.z;b[$+K]=z.x;b[ee+K]=z.y;b[te+K]=z.z}if(a.tangent){q=r.normalize(r.cross(G,z,q),q);w[$]=q.x;w[ee]=q.y;w[te]=q.z;w[$+K]=q.x;w[$+1+K]=q.y;w[$+2+K]=q.z}if(a.bitangent){S[$]=G.x;S[ee]=G.y;S[te]=G.z;S[$+K]=G.x;S[ee+K]=G.y;S[te+K]=G.z}}}if(a.st){K=_.length;for(var ue=0;ue<K;ue+=2){_[ue]=(_[ue]-Q.x)/(Z.x-Q.x);_[ue+1]=(_[ue+1]-Q.y)/(Z.y-Q.y)}}var ce=new p;if(a.position){ce.position=new h({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:g})}if(a.st){ce.st=new h({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:_})}if(a.normal){ce.normal=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:b})}if(a.tangent){ce.tangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:w})}if(a.bitangent){ce.bitangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:S})}if(T){ce.extrudeDirection=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:E})}return ce}function j(e){var t=e.length/3;var r=g.createTypedArray(t,t*6);var i=0;for(var n=0;n<t;n++){var a=n;var o=n+t;var s=(a+1)%t;var l=s+t;r[i++]=a;r[i++]=o;r[i++]=s;r[i++]=s;r[i++]=o;r[i++]=l}return r}var W=new e;var Y=new e;function X(t){var i=t.center;var n=t.ellipsoid;var a=t.semiMajorAxis;var o=r.multiplyByScalar(n.geodeticSurfaceNormal(i,x),t.height,x);W.center=r.add(i,o,W.center);W.radius=a;o=r.multiplyByScalar(n.geodeticSurfaceNormal(i,o),t.extrudedHeight,o);Y.center=r.add(i,o,Y.center);Y.radius=a;var s=u.computeEllipsePositions(t,true,true);var l=s.positions;var c=s.numPts;var d=s.outerPositions;var h=e.union(W,Y);var p=V(l,t,true);var _=z(c);var y=_.length;_.length=y*2;var b=l.length/3;for(var C=0;C<y;C+=3){_[C+y]=_[C+2]+b;_[C+1+y]=_[C+1]+b;_[C+2+y]=_[C]+b}var S=g.createTypedArray(b*2/3,_);var T=new f({attributes:p,indices:S,primitiveType:w.TRIANGLES});var E=H(d,t);_=j(d);var P=g.createTypedArray(d.length*2/3,_);var A=new f({attributes:E,indices:P,primitiveType:w.TRIANGLES});var O=v.combineInstances([new m({geometry:T}),new m({geometry:A})]);return{boundingSphere:h,attributes:O[0].attributes,indices:O[0].indices}}var Q=new b;var Z=new b;var K=new y;var J=[new r,new r,new r,new r];var $=[new i,new i,new i,new i];function ee(e,t,i,n,a){T.eastNorthUpToFixedFrame(e,t,Q);b.inverseTransformation(Q,Z);var o;for(o=0;o<4;++o){r.clone(r.ZERO,J[o])}J[0].x+=i;J[1].x-=i;J[2].y+=n;J[3].y-=n;y.fromRotationZ(a,K);for(o=0;o<4;++o){y.multiplyByVector(K,J[o],J[o]);b.multiplyByPoint(Q,J[o],J[o]);t.cartesianToCartographic(J[o],$[o])}return S.fromCartographicArray($)}function te(e){e=a(e,a.EMPTY_OBJECT);var t=e.center;var i=a(e.ellipsoid,c.WGS84);var n=e.semiMajorAxis;var s=e.semiMinorAxis;var u=a(e.granularity,_.RADIANS_PER_DEGREE);var d=a(e.height,0);var f=e.extrudedHeight;var h=o(f)&&Math.abs(d-f)>1;var p=a(e.vertexFormat,E.DEFAULT);if(!o(t)){throw new l("center is required.")}if(!o(n)){throw new l("semiMajorAxis is required.")}if(!o(s)){throw new l("semiMinorAxis is required.")}if(n<s){throw new l("semiMajorAxis must be greater than or equal to the semiMinorAxis.")}if(u<=0){throw new l("granularity must be greater than zero.")}this._center=r.clone(t);this._semiMajorAxis=n;this._semiMinorAxis=s;this._ellipsoid=c.clone(i);this._rotation=a(e.rotation,0);this._stRotation=a(e.stRotation,0);this._height=d;this._granularity=u;this._vertexFormat=E.clone(p);this._extrudedHeight=a(f,d);this._extrude=h;this._shadowVolume=a(e.shadowVolume,false);this._workerName="createEllipseGeometry";this._rectangle=ee(this._center,this._ellipsoid,n,s,this._rotation)}te.packedLength=r.packedLength+c.packedLength+E.packedLength+S.packedLength+9;te.pack=function(e,t,i){if(!o(e)){throw new l("value is required")}if(!o(t)){throw new l("array is required")}i=a(i,0);r.pack(e._center,t,i);i+=r.packedLength;c.pack(e._ellipsoid,t,i);i+=c.packedLength;E.pack(e._vertexFormat,t,i);i+=E.packedLength;S.pack(e._rectangle,t,i);i+=S.packedLength;t[i++]=e._semiMajorAxis;t[i++]=e._semiMinorAxis;t[i++]=e._rotation;t[i++]=e._stRotation;t[i++]=e._height;t[i++]=e._granularity;t[i++]=e._extrudedHeight;t[i++]=e._extrude?1:0;t[i]=e._shadowVolume?1:0;return t};var re=new r;var ie=new c;var ne=new E;var ae=new S;var oe={center:re,ellipsoid:ie,vertexFormat:ne,semiMajorAxis:undefined,semiMinorAxis:undefined,rotation:undefined,stRotation:undefined,height:undefined,granularity:undefined,extrudedHeight:undefined,shadowVolume:undefined};te.unpack=function(e,t,i){if(!o(e)){throw new l("array is required")}t=a(t,0);var n=r.unpack(e,t,re);t+=r.packedLength;var s=c.unpack(e,t,ie);t+=c.packedLength;var u=E.unpack(e,t,ne);t+=E.packedLength;var d=S.unpack(e,t,ae);t+=S.packedLength;var f=e[t++];var h=e[t++];var p=e[t++];var m=e[t++];var v=e[t++];var g=e[t++];var _=e[t++];var y=e[t++]===1;var b=e[t]===1;if(!o(i)){oe.height=v;oe.extrudedHeight=_;oe.granularity=g;oe.stRotation=m;oe.rotation=p;oe.semiMajorAxis=f;oe.semiMinorAxis=h;oe.shadowVolume=b;return new te(oe)}i._center=r.clone(n,i._center);i._ellipsoid=c.clone(s,i._ellipsoid);i._vertexFormat=E.clone(u,i._vertexFormat);i._semiMajorAxis=f;i._semiMinorAxis=h;i._rotation=p;i._stRotation=m;i._height=v;i._granularity=g;i._extrudedHeight=_;i._extrude=y;i._shadowVolume=b;i._rectangle=S.clone(d);return i};te.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0){return}e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var t={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:e._height,extrudedHeight:e._extrudedHeight,granularity:e._granularity,vertexFormat:e._vertexFormat,stRotation:e._stRotation};var r;if(e._extrude){t.extrudedHeight=Math.min(e._extrudedHeight,e._height);t.height=Math.max(e._extrudedHeight,e._height);t.shadowVolume=e._shadowVolume;r=X(t)}else{r=G(t)}return new f({attributes:r.attributes,indices:r.indices,primitiveType:w.TRIANGLES,boundingSphere:r.boundingSphere})};te.createShadowVolume=function(e,t,r){var i=e._granularity;var n=e._ellipsoid;var a=t(i,n);var o=r(i,n);return new te({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:n,rotation:e._rotation,stRotation:e._stRotation,granularity:i,extrudedHeight:a,height:o,vertexFormat:E.POSITION_ONLY,shadowVolume:true})};s(te.prototype,{rectangle:{get:function(){return this._rectangle}}});return te});define("Core/CircleGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./EllipseGeometry","./Ellipsoid","./VertexFormat"],function(e,t,r,i,n,a,o,s){"use strict";function l(e){e=r(e,r.EMPTY_OBJECT);var i=e.radius;t.typeOf.number("radius",i);var n={center:e.center,semiMajorAxis:i,semiMinorAxis:i,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,vertexFormat:e.vertexFormat,stRotation:e.stRotation,shadowVolume:e.shadowVolume};this._ellipseGeometry=new a(n);this._workerName="createCircleGeometry"}l.packedLength=a.packedLength;l.pack=function(e,r,i){t.typeOf.object("value",e);return a.pack(e._ellipseGeometry,r,i)};var u=new a({center:new e,semiMajorAxis:1,semiMinorAxis:1});var c={center:new e,radius:undefined,ellipsoid:o.clone(o.UNIT_SPHERE),height:undefined,extrudedHeight:undefined,granularity:undefined,vertexFormat:new s,stRotation:undefined,semiMajorAxis:undefined,semiMinorAxis:undefined,shadowVolume:undefined};l.unpack=function(t,r,n){var d=a.unpack(t,r,u);c.center=e.clone(d._center,c.center);c.ellipsoid=o.clone(d._ellipsoid,c.ellipsoid);c.height=d._height;c.extrudedHeight=d._extrudedHeight;c.granularity=d._granularity;c.vertexFormat=s.clone(d._vertexFormat,c.vertexFormat);c.stRotation=d._stRotation;c.shadowVolume=d._shadowVolume;if(!i(n)){c.radius=d._semiMajorAxis;return new l(c)}c.semiMajorAxis=d._semiMajorAxis;c.semiMinorAxis=d._semiMinorAxis;n._ellipseGeometry=new a(c);return n};l.createGeometry=function(e){return a.createGeometry(e._ellipseGeometry)};l.createShadowVolume=function(e,t,r){var i=e._ellipseGeometry._granularity;var n=e._ellipseGeometry._ellipsoid;var a=t(i,n);var o=r(i,n);return new l({center:e._ellipseGeometry._center,radius:e._ellipseGeometry._semiMajorAxis,ellipsoid:n,stRotation:e._ellipseGeometry._stRotation,granularity:i,extrudedHeight:a,height:o,vertexFormat:s.POSITION_ONLY,shadowVolume:true})};n(l.prototype,{rectangle:{get:function(){return this._ellipseGeometry.rectangle}}});return l});define("Core/EllipseOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EllipseGeometryLibrary","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";var p=new t;var m=new t;function v(i){var n=i.center;m=t.multiplyByScalar(i.ellipsoid.geodeticSurfaceNormal(n,m),i.height,m);m=t.add(n,m,m);var a=new e(m,i.semiMajorAxis);var s=o.computeEllipsePositions(i,false,true).outerPositions;var l=new c({position:new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:o.raisePositionsToHeight(s,i,false)})});var f=s.length/3;var h=d.createTypedArray(f,f*2);var p=0;for(var v=0;v<f;++v){h[p++]=v;h[p++]=(v+1)%f}return{boundingSphere:a,attributes:l,indices:h}}var g=new e;var _=new e;function y(n){var a=n.center;var s=n.ellipsoid;var l=n.semiMajorAxis;var h=t.multiplyByScalar(s.geodeticSurfaceNormal(a,p),n.height,p);g.center=t.add(a,h,g.center);g.radius=l;h=t.multiplyByScalar(s.geodeticSurfaceNormal(a,h),n.extrudedHeight,h);_.center=t.add(a,h,_.center);_.radius=l;var m=o.computeEllipsePositions(n,false,true).outerPositions;var v=new c({position:new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:o.raisePositionsToHeight(m,n,true)})});m=v.position.values;var y=e.union(g,_);var b=m.length/3;var w=i(n.numberOfVerticalLines,16);w=f.clamp(w,0,b/2);var C=d.createTypedArray(b,b*2+w*2);b/=2;var S=0;var T;for(T=0;T<b;++T){C[S++]=T;C[S++]=(T+1)%b;C[S++]=T+b;C[S++]=(T+1)%b+b}var E;if(w>0){var x=Math.min(w,b);E=Math.round(b/x);var P=Math.min(E*w,b);for(T=0;T<P;T+=E){C[S++]=T;C[S++]=T+b}}return{boundingSphere:y,attributes:v,indices:C}}function b(e){e=i(e,i.EMPTY_OBJECT);var r=e.center;var o=i(e.ellipsoid,s.WGS84);var l=e.semiMajorAxis;var u=e.semiMinorAxis;var c=i(e.granularity,f.RADIANS_PER_DEGREE);var d=i(e.height,0);var h=e.extrudedHeight;var p=n(h)&&Math.abs(d-h)>1;if(!n(r)){throw new a("center is required.")}if(!n(l)){throw new a("semiMajorAxis is required.")}if(!n(u)){throw new a("semiMinorAxis is required.")}if(l<u){throw new a("semiMajorAxis must be greater than or equal to the semiMinorAxis.")}if(c<=0){throw new a("granularity must be greater than zero.")}this._center=t.clone(r);this._semiMajorAxis=l;this._semiMinorAxis=u;this._ellipsoid=s.clone(o);this._rotation=i(e.rotation,0);this._height=d;this._granularity=c;this._extrudedHeight=h;this._extrude=p;this._numberOfVerticalLines=Math.max(i(e.numberOfVerticalLines,16),0);this._workerName="createEllipseOutlineGeometry"}b.packedLength=t.packedLength+s.packedLength+9;b.pack=function(e,r,o){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}o=i(o,0);t.pack(e._center,r,o);o+=t.packedLength;s.pack(e._ellipsoid,r,o);o+=s.packedLength;r[o++]=e._semiMajorAxis;r[o++]=e._semiMinorAxis;r[o++]=e._rotation;r[o++]=e._height;r[o++]=e._granularity;r[o++]=n(e._extrudedHeight)?1:0;r[o++]=i(e._extrudedHeight,0);r[o++]=e._extrude?1:0;r[o]=e._numberOfVerticalLines;return r};var w=new t;var C=new s;var S={center:w,ellipsoid:C,semiMajorAxis:undefined,semiMinorAxis:undefined,rotation:undefined,height:undefined,granularity:undefined,extrudedHeight:undefined,numberOfVerticalLines:undefined};b.unpack=function(e,r,o){if(!n(e)){throw new a("array is required")}r=i(r,0);var l=t.unpack(e,r,w);r+=t.packedLength;var u=s.unpack(e,r,C);r+=s.packedLength;var c=e[r++];var d=e[r++];var f=e[r++];var h=e[r++];var p=e[r++];var m=e[r++];var v=e[r++];var g=e[r++]===1;var _=e[r];if(!n(o)){S.height=h;S.extrudedHeight=m?v:undefined;S.granularity=p;S.rotation=f;S.semiMajorAxis=c;S.semiMinorAxis=d;S.numberOfVerticalLines=_;return new b(S)}o._center=t.clone(l,o._center);o._ellipsoid=s.clone(u,o._ellipsoid);o._semiMajorAxis=c;o._semiMinorAxis=d;o._rotation=f;o._height=h;o._granularity=p;o._extrudedHeight=m?v:undefined;o._extrude=g;o._numberOfVerticalLines=_;return o};b.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0){return}e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var t={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:e._height,extrudedHeight:e._extrudedHeight,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines};var r;if(e._extrude){t.extrudedHeight=Math.min(e._extrudedHeight,e._height);t.height=Math.max(e._extrudedHeight,e._height);r=y(t)}else{r=v(t)}return new l({attributes:r.attributes,indices:r.indices,primitiveType:h.LINES,boundingSphere:r.boundingSphere})};return b});define("Core/CircleOutlineGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./EllipseOutlineGeometry","./Ellipsoid"],function(e,t,r,i,n,a){"use strict";function o(e){e=r(e,r.EMPTY_OBJECT);var i=e.radius;t.typeOf.number("radius",i);var a={center:e.center,semiMajorAxis:i,semiMinorAxis:i,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,numberOfVerticalLines:e.numberOfVerticalLines};this._ellipseGeometry=new n(a);this._workerName="createCircleOutlineGeometry"}o.packedLength=n.packedLength;o.pack=function(e,r,i){t.typeOf.object("value",e);return n.pack(e._ellipseGeometry,r,i)};var s=new n({center:new e,semiMajorAxis:1,semiMinorAxis:1});var l={center:new e,radius:undefined,ellipsoid:a.clone(a.UNIT_SPHERE),height:undefined,extrudedHeight:undefined,granularity:undefined,numberOfVerticalLines:undefined,semiMajorAxis:undefined,semiMinorAxis:undefined};o.unpack=function(t,r,u){var c=n.unpack(t,r,s);l.center=e.clone(c._center,l.center);l.ellipsoid=a.clone(c._ellipsoid,l.ellipsoid);l.height=c._height;l.extrudedHeight=c._extrudedHeight;l.granularity=c._granularity;l.numberOfVerticalLines=c._numberOfVerticalLines;if(!i(u)){l.radius=c._semiMajorAxis;return new o(l)}l.semiMajorAxis=c._semiMajorAxis;l.semiMinorAxis=c._semiMinorAxis;u._ellipseGeometry=new n(l);return u};o.createGeometry=function(e){return n.createGeometry(e._ellipseGeometry)};return o});define("Core/ClockRange",["./freezeObject"],function(e){"use strict";var t={UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2};return e(t)});define("Core/ClockStep",["./freezeObject"],function(e){"use strict";var t={TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2};return e(t)});define("Core/getTimestamp",["./defined"],function(e){"use strict";var t;if(typeof performance!=="undefined"&&e(performance.now)){t=function(){return performance.now()}}else{t=function(){return Date.now()}}return t});define("Core/Clock",["./ClockRange","./ClockStep","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./getTimestamp","./JulianDate"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(n){n=r(n,r.EMPTY_OBJECT);var u=n.currentTime;var c=n.startTime;var d=n.stopTime;if(!i(u)){if(i(c)){u=l.clone(c)}else if(i(d)){u=l.addDays(d,-1,new l)}else{u=l.now()}}else{u=l.clone(u)}if(!i(c)){c=l.clone(u)}else{c=l.clone(c)}if(!i(d)){d=l.addDays(c,1,new l)}else{d=l.clone(d)}if(l.greaterThan(c,d)){throw new a("startTime must come before stopTime.")}this.startTime=c;this.stopTime=d;this.clockRange=r(n.clockRange,e.UNBOUNDED);this.canAnimate=r(n.canAnimate,true);this.onTick=new o;this._currentTime=undefined;this._multiplier=undefined;this._clockStep=undefined;this._shouldAnimate=undefined;this._lastSystemTime=s();this.currentTime=u;this.multiplier=r(n.multiplier,1);this.clockStep=r(n.clockStep,t.SYSTEM_CLOCK_MULTIPLIER);this.shouldAnimate=r(n.shouldAnimate,true)}n(u.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){if(l.equals(this._currentTime,e)){return}if(this._clockStep===t.SYSTEM_CLOCK){this._clockStep=t.SYSTEM_CLOCK_MULTIPLIER}this._currentTime=e}},multiplier:{get:function(){return this._multiplier},set:function(e){if(this._multiplier===e){return}if(this._clockStep===t.SYSTEM_CLOCK){this._clockStep=t.SYSTEM_CLOCK_MULTIPLIER}this._multiplier=e}},clockStep:{get:function(){return this._clockStep},set:function(e){if(e===t.SYSTEM_CLOCK){this._multiplier=1;this._shouldAnimate=true;this._currentTime=l.now()}this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){if(this._shouldAnimate===e){return}if(this._clockStep===t.SYSTEM_CLOCK){this._clockStep=t.SYSTEM_CLOCK_MULTIPLIER}this._shouldAnimate=e}}});u.prototype.tick=function(){var r=s();var i=l.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){var n=this._clockStep;if(n===t.SYSTEM_CLOCK){i=l.now(i)}else{var a=this._multiplier;if(n===t.TICK_DEPENDENT){i=l.addSeconds(i,a,i)}else{var o=r-this._lastSystemTime;i=l.addSeconds(i,a*(o/1e3),i)}var u=this.clockRange;var c=this.startTime;var d=this.stopTime;if(u===e.CLAMPED){if(l.lessThan(i,c)){i=l.clone(c,i)}else if(l.greaterThan(i,d)){i=l.clone(d,i)}}else if(u===e.LOOP_STOP){if(l.lessThan(i,c)){i=l.clone(c,i)}while(l.greaterThan(i,d)){i=l.addSeconds(c,l.secondsDifference(i,d),i)}}}}this._currentTime=i;this._lastSystemTime=r;this.onTick.raiseEvent(this);return i};return u});define("Core/Color",["./Check","./defaultValue","./defined","./FeatureDetection","./freezeObject","./Math"],function(e,t,r,i,n,a){"use strict";function o(e,t,r){if(r<0){r+=1}if(r>1){r-=1}if(r*6<1){return e+(t-e)*6*r}if(r*2<1){return t}if(r*3<2){return e+(t-e)*(2/3-r)*6}return e}function s(e,r,i,n){this.red=t(e,1);this.green=t(r,1);this.blue=t(i,1);this.alpha=t(n,1)}s.fromCartesian4=function(t,i){e.typeOf.object("cartesian",t);if(!r(i)){return new s(t.x,t.y,t.z,t.w)}i.red=t.x;i.green=t.y;i.blue=t.z;i.alpha=t.w;return i};s.fromBytes=function(e,i,n,a,o){e=s.byteToFloat(t(e,255));i=s.byteToFloat(t(i,255));n=s.byteToFloat(t(n,255));a=s.byteToFloat(t(a,255));if(!r(o)){return new s(e,i,n,a)}o.red=e;o.green=i;o.blue=n;o.alpha=a;return o};s.fromAlpha=function(t,i,n){e.typeOf.object("color",t);e.typeOf.number("alpha",i);if(!r(n)){return new s(t.red,t.green,t.blue,i)}n.red=t.red;n.green=t.green;n.blue=t.blue;n.alpha=i;return n};var l;var u;var c;if(i.supportsTypedArrays()){l=new ArrayBuffer(4);u=new Uint32Array(l);c=new Uint8Array(l)}s.fromRgba=function(e,t){u[0]=e;return s.fromBytes(c[0],c[1],c[2],c[3],t)};s.fromHsl=function(e,i,n,a,l){e=t(e,0)%1;i=t(i,0);n=t(n,0);a=t(a,1);var u=n;var c=n;var d=n;if(i!==0){var f;if(n<.5){f=n*(1+i)}else{f=n+i-n*i}var h=2*n-f;u=o(h,f,e+1/3);c=o(h,f,e);d=o(h,f,e-1/3)}if(!r(l)){return new s(u,c,d,a)}l.red=u;l.green=c;l.blue=d;l.alpha=a;return l};s.fromRandom=function(i,n){i=t(i,t.EMPTY_OBJECT);var o=i.red;if(!r(o)){var l=t(i.minimumRed,0);var u=t(i.maximumRed,1);e.typeOf.number.lessThanOrEquals("minimumRed",l,u);o=l+a.nextRandomNumber()*(u-l)}var c=i.green;if(!r(c)){var d=t(i.minimumGreen,0);var f=t(i.maximumGreen,1);e.typeOf.number.lessThanOrEquals("minimumGreen",d,f);c=d+a.nextRandomNumber()*(f-d)}var h=i.blue;if(!r(h)){var p=t(i.minimumBlue,0);var m=t(i.maximumBlue,1);e.typeOf.number.lessThanOrEquals("minimumBlue",p,m);h=p+a.nextRandomNumber()*(m-p)}var v=i.alpha;if(!r(v)){var g=t(i.minimumAlpha,0);var _=t(i.maximumAlpha,1);e.typeOf.number.lessThanOrEquals("minumumAlpha",g,_);v=g+a.nextRandomNumber()*(_-g)}if(!r(n)){return new s(o,c,h,v)}n.red=o;n.green=c;n.blue=h;n.alpha=v;return n};var d=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i;var f=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i;var h=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i;var p=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;s.fromCssColorString=function(i,n){e.typeOf.string("color",i);if(!r(n)){n=new s}var a=s[i.toUpperCase()];if(r(a)){s.clone(a,n);return n}var o=d.exec(i);if(o!==null){n.red=parseInt(o[1],16)/15;n.green=parseInt(o[2],16)/15;n.blue=parseInt(o[3],16)/15;n.alpha=1;return n}o=f.exec(i);if(o!==null){n.red=parseInt(o[1],16)/255;n.green=parseInt(o[2],16)/255;n.blue=parseInt(o[3],16)/255;n.alpha=1;return n}o=h.exec(i);if(o!==null){n.red=parseFloat(o[1])/("%"===o[1].substr(-1)?100:255);n.green=parseFloat(o[2])/("%"===o[2].substr(-1)?100:255);n.blue=parseFloat(o[3])/("%"===o[3].substr(-1)?100:255);n.alpha=parseFloat(t(o[4],"1.0"));return n}o=p.exec(i);if(o!==null){return s.fromHsl(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,parseFloat(t(o[4],"1.0")),n)}n=undefined;return n};s.packedLength=4;s.pack=function(r,i,n){e.typeOf.object("value",r);e.defined("array",i);n=t(n,0);i[n++]=r.red;i[n++]=r.green;i[n++]=r.blue;i[n]=r.alpha;return i};s.unpack=function(i,n,a){e.defined("array",i);n=t(n,0);if(!r(a)){a=new s}a.red=i[n++];a.green=i[n++];a.blue=i[n++];a.alpha=i[n];return a};s.byteToFloat=function(e){return e/255};s.floatToByte=function(e){return e===1?255:e*256|0};s.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new s(e.red,e.green,e.blue,e.alpha)}t.red=e.red;t.green=e.green;t.blue=e.blue;t.alpha=e.alpha;return t};s.equals=function(e,t){return e===t||r(e)&&r(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha};s.equalsArray=function(e,t,r){return e.red===t[r]&&e.green===t[r+1]&&e.blue===t[r+2]&&e.alpha===t[r+3]};s.prototype.clone=function(e){return s.clone(this,e)};s.prototype.equals=function(e){return s.equals(this,e)};s.prototype.equalsEpsilon=function(e,t){return this===e||r(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t};s.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"};s.prototype.toCssColorString=function(){var e=s.floatToByte(this.red);var t=s.floatToByte(this.green);var r=s.floatToByte(this.blue);if(this.alpha===1){return"rgb("+e+","+t+","+r+")"}return"rgba("+e+","+t+","+r+","+this.alpha+")"};s.prototype.toBytes=function(e){var t=s.floatToByte(this.red);var i=s.floatToByte(this.green);var n=s.floatToByte(this.blue);var a=s.floatToByte(this.alpha);if(!r(e)){return[t,i,n,a]}e[0]=t;e[1]=i;e[2]=n;e[3]=a;return e};s.prototype.toRgba=function(){c[0]=s.floatToByte(this.red);c[1]=s.floatToByte(this.green);c[2]=s.floatToByte(this.blue);c[3]=s.floatToByte(this.alpha);return u[0]};s.prototype.brighten=function(t,r){e.typeOf.number("magnitude",t);e.typeOf.number.greaterThanOrEquals("magnitude",t,0);e.typeOf.object("result",r);t=1-t;r.red=1-(1-this.red)*t;r.green=1-(1-this.green)*t;r.blue=1-(1-this.blue)*t;r.alpha=this.alpha;return r};s.prototype.darken=function(t,r){e.typeOf.number("magnitude",t);e.typeOf.number.greaterThanOrEquals("magnitude",t,0);e.typeOf.object("result",r);t=1-t;r.red=this.red*t;r.green=this.green*t;r.blue=this.blue*t;r.alpha=this.alpha;return r};s.prototype.withAlpha=function(e,t){return s.fromAlpha(this,e,t)};s.add=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.red=t.red+r.red;i.green=t.green+r.green;i.blue=t.blue+r.blue;i.alpha=t.alpha+r.alpha;return i};s.subtract=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.red=t.red-r.red;i.green=t.green-r.green;i.blue=t.blue-r.blue;i.alpha=t.alpha-r.alpha;return i};s.multiply=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.red=t.red*r.red;i.green=t.green*r.green;i.blue=t.blue*r.blue;i.alpha=t.alpha*r.alpha;return i};s.divide=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.red=t.red/r.red;i.green=t.green/r.green;i.blue=t.blue/r.blue;i.alpha=t.alpha/r.alpha;return i};s.mod=function(t,r,i){e.typeOf.object("left",t);e.typeOf.object("right",r);e.typeOf.object("result",i);i.red=t.red%r.red;i.green=t.green%r.green;i.blue=t.blue%r.blue;i.alpha=t.alpha%r.alpha;return i};s.multiplyByScalar=function(t,r,i){e.typeOf.object("color",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.red=t.red*r;i.green=t.green*r;i.blue=t.blue*r;i.alpha=t.alpha*r;return i};s.divideByScalar=function(t,r,i){e.typeOf.object("color",t);e.typeOf.number("scalar",r);e.typeOf.object("result",i);i.red=t.red/r;i.green=t.green/r;i.blue=t.blue/r;i.alpha=t.alpha/r;return i};s.ALICEBLUE=n(s.fromCssColorString("#F0F8FF"));s.ANTIQUEWHITE=n(s.fromCssColorString("#FAEBD7"));s.AQUA=n(s.fromCssColorString("#00FFFF"));s.AQUAMARINE=n(s.fromCssColorString("#7FFFD4"));s.AZURE=n(s.fromCssColorString("#F0FFFF"));s.BEIGE=n(s.fromCssColorString("#F5F5DC"));s.BISQUE=n(s.fromCssColorString("#FFE4C4"));s.BLACK=n(s.fromCssColorString("#000000"));s.BLANCHEDALMOND=n(s.fromCssColorString("#FFEBCD"));s.BLUE=n(s.fromCssColorString("#0000FF"));s.BLUEVIOLET=n(s.fromCssColorString("#8A2BE2"));s.BROWN=n(s.fromCssColorString("#A52A2A"));s.BURLYWOOD=n(s.fromCssColorString("#DEB887"));s.CADETBLUE=n(s.fromCssColorString("#5F9EA0"));s.CHARTREUSE=n(s.fromCssColorString("#7FFF00"));s.CHOCOLATE=n(s.fromCssColorString("#D2691E"));s.CORAL=n(s.fromCssColorString("#FF7F50"));s.CORNFLOWERBLUE=n(s.fromCssColorString("#6495ED"));s.CORNSILK=n(s.fromCssColorString("#FFF8DC"));s.CRIMSON=n(s.fromCssColorString("#DC143C"));s.CYAN=n(s.fromCssColorString("#00FFFF"));s.DARKBLUE=n(s.fromCssColorString("#00008B"));s.DARKCYAN=n(s.fromCssColorString("#008B8B"));s.DARKGOLDENROD=n(s.fromCssColorString("#B8860B"));s.DARKGRAY=n(s.fromCssColorString("#A9A9A9"));s.DARKGREEN=n(s.fromCssColorString("#006400"));s.DARKGREY=s.DARKGRAY;s.DARKKHAKI=n(s.fromCssColorString("#BDB76B"));s.DARKMAGENTA=n(s.fromCssColorString("#8B008B"));s.DARKOLIVEGREEN=n(s.fromCssColorString("#556B2F"));s.DARKORANGE=n(s.fromCssColorString("#FF8C00"));s.DARKORCHID=n(s.fromCssColorString("#9932CC"));s.DARKRED=n(s.fromCssColorString("#8B0000"));s.DARKSALMON=n(s.fromCssColorString("#E9967A"));s.DARKSEAGREEN=n(s.fromCssColorString("#8FBC8F"));s.DARKSLATEBLUE=n(s.fromCssColorString("#483D8B"));s.DARKSLATEGRAY=n(s.fromCssColorString("#2F4F4F"));s.DARKSLATEGREY=s.DARKSLATEGRAY;s.DARKTURQUOISE=n(s.fromCssColorString("#00CED1"));s.DARKVIOLET=n(s.fromCssColorString("#9400D3"));s.DEEPPINK=n(s.fromCssColorString("#FF1493"));s.DEEPSKYBLUE=n(s.fromCssColorString("#00BFFF"));s.DIMGRAY=n(s.fromCssColorString("#696969"));s.DIMGREY=s.DIMGRAY;s.DODGERBLUE=n(s.fromCssColorString("#1E90FF"));s.FIREBRICK=n(s.fromCssColorString("#B22222"));s.FLORALWHITE=n(s.fromCssColorString("#FFFAF0"));s.FORESTGREEN=n(s.fromCssColorString("#228B22"));s.FUCHSIA=n(s.fromCssColorString("#FF00FF"));s.GAINSBORO=n(s.fromCssColorString("#DCDCDC"));s.GHOSTWHITE=n(s.fromCssColorString("#F8F8FF"));s.GOLD=n(s.fromCssColorString("#FFD700"));s.GOLDENROD=n(s.fromCssColorString("#DAA520"));s.GRAY=n(s.fromCssColorString("#808080"));s.GREEN=n(s.fromCssColorString("#008000"));s.GREENYELLOW=n(s.fromCssColorString("#ADFF2F"));s.GREY=s.GRAY;s.HONEYDEW=n(s.fromCssColorString("#F0FFF0"));s.HOTPINK=n(s.fromCssColorString("#FF69B4"));s.INDIANRED=n(s.fromCssColorString("#CD5C5C"));s.INDIGO=n(s.fromCssColorString("#4B0082"));s.IVORY=n(s.fromCssColorString("#FFFFF0"));s.KHAKI=n(s.fromCssColorString("#F0E68C"));s.LAVENDER=n(s.fromCssColorString("#E6E6FA"));s.LAVENDAR_BLUSH=n(s.fromCssColorString("#FFF0F5"));s.LAWNGREEN=n(s.fromCssColorString("#7CFC00"));s.LEMONCHIFFON=n(s.fromCssColorString("#FFFACD"));s.LIGHTBLUE=n(s.fromCssColorString("#ADD8E6"));s.LIGHTCORAL=n(s.fromCssColorString("#F08080"));s.LIGHTCYAN=n(s.fromCssColorString("#E0FFFF"));s.LIGHTGOLDENRODYELLOW=n(s.fromCssColorString("#FAFAD2"));s.LIGHTGRAY=n(s.fromCssColorString("#D3D3D3"));s.LIGHTGREEN=n(s.fromCssColorString("#90EE90"));s.LIGHTGREY=s.LIGHTGRAY;s.LIGHTPINK=n(s.fromCssColorString("#FFB6C1"));s.LIGHTSEAGREEN=n(s.fromCssColorString("#20B2AA"));s.LIGHTSKYBLUE=n(s.fromCssColorString("#87CEFA"));s.LIGHTSLATEGRAY=n(s.fromCssColorString("#778899"));s.LIGHTSLATEGREY=s.LIGHTSLATEGRAY;s.LIGHTSTEELBLUE=n(s.fromCssColorString("#B0C4DE"));s.LIGHTYELLOW=n(s.fromCssColorString("#FFFFE0"));s.LIME=n(s.fromCssColorString("#00FF00"));s.LIMEGREEN=n(s.fromCssColorString("#32CD32"));s.LINEN=n(s.fromCssColorString("#FAF0E6"));s.MAGENTA=n(s.fromCssColorString("#FF00FF"));s.MAROON=n(s.fromCssColorString("#800000"));s.MEDIUMAQUAMARINE=n(s.fromCssColorString("#66CDAA"));s.MEDIUMBLUE=n(s.fromCssColorString("#0000CD"));s.MEDIUMORCHID=n(s.fromCssColorString("#BA55D3"));s.MEDIUMPURPLE=n(s.fromCssColorString("#9370DB"));s.MEDIUMSEAGREEN=n(s.fromCssColorString("#3CB371"));s.MEDIUMSLATEBLUE=n(s.fromCssColorString("#7B68EE"));s.MEDIUMSPRINGGREEN=n(s.fromCssColorString("#00FA9A"));s.MEDIUMTURQUOISE=n(s.fromCssColorString("#48D1CC"));s.MEDIUMVIOLETRED=n(s.fromCssColorString("#C71585"));s.MIDNIGHTBLUE=n(s.fromCssColorString("#191970"));s.MINTCREAM=n(s.fromCssColorString("#F5FFFA"));s.MISTYROSE=n(s.fromCssColorString("#FFE4E1"));s.MOCCASIN=n(s.fromCssColorString("#FFE4B5"));s.NAVAJOWHITE=n(s.fromCssColorString("#FFDEAD"));s.NAVY=n(s.fromCssColorString("#000080"));s.OLDLACE=n(s.fromCssColorString("#FDF5E6"));s.OLIVE=n(s.fromCssColorString("#808000"));s.OLIVEDRAB=n(s.fromCssColorString("#6B8E23"));s.ORANGE=n(s.fromCssColorString("#FFA500"));s.ORANGERED=n(s.fromCssColorString("#FF4500"));s.ORCHID=n(s.fromCssColorString("#DA70D6"));s.PALEGOLDENROD=n(s.fromCssColorString("#EEE8AA"));s.PALEGREEN=n(s.fromCssColorString("#98FB98"));s.PALETURQUOISE=n(s.fromCssColorString("#AFEEEE"));s.PALEVIOLETRED=n(s.fromCssColorString("#DB7093"));s.PAPAYAWHIP=n(s.fromCssColorString("#FFEFD5"));s.PEACHPUFF=n(s.fromCssColorString("#FFDAB9"));s.PERU=n(s.fromCssColorString("#CD853F"));s.PINK=n(s.fromCssColorString("#FFC0CB"));s.PLUM=n(s.fromCssColorString("#DDA0DD"));s.POWDERBLUE=n(s.fromCssColorString("#B0E0E6"));s.PURPLE=n(s.fromCssColorString("#800080"));s.RED=n(s.fromCssColorString("#FF0000"));s.ROSYBROWN=n(s.fromCssColorString("#BC8F8F"));s.ROYALBLUE=n(s.fromCssColorString("#4169E1"));s.SADDLEBROWN=n(s.fromCssColorString("#8B4513"));s.SALMON=n(s.fromCssColorString("#FA8072"));s.SANDYBROWN=n(s.fromCssColorString("#F4A460"));s.SEAGREEN=n(s.fromCssColorString("#2E8B57"));s.SEASHELL=n(s.fromCssColorString("#FFF5EE"));s.SIENNA=n(s.fromCssColorString("#A0522D"));s.SILVER=n(s.fromCssColorString("#C0C0C0"));s.SKYBLUE=n(s.fromCssColorString("#87CEEB"));s.SLATEBLUE=n(s.fromCssColorString("#6A5ACD"));s.SLATEGRAY=n(s.fromCssColorString("#708090"));s.SLATEGREY=s.SLATEGRAY;s.SNOW=n(s.fromCssColorString("#FFFAFA"));s.SPRINGGREEN=n(s.fromCssColorString("#00FF7F"));s.STEELBLUE=n(s.fromCssColorString("#4682B4"));s.TAN=n(s.fromCssColorString("#D2B48C"));s.TEAL=n(s.fromCssColorString("#008080"));s.THISTLE=n(s.fromCssColorString("#D8BFD8"));s.TOMATO=n(s.fromCssColorString("#FF6347"));s.TURQUOISE=n(s.fromCssColorString("#40E0D0"));s.VIOLET=n(s.fromCssColorString("#EE82EE"));s.WHEAT=n(s.fromCssColorString("#F5DEB3"));s.WHITE=n(s.fromCssColorString("#FFFFFF"));s.WHITESMOKE=n(s.fromCssColorString("#F5F5F5"));s.YELLOW=n(s.fromCssColorString("#FFFF00"));s.YELLOWGREEN=n(s.fromCssColorString("#9ACD32"));s.TRANSPARENT=n(new s(0,0,0,0));return s});define("Core/ColorGeometryInstanceAttribute",["./Color","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,r,i,n,a){"use strict";function o(t,i,n,a){t=r(t,1);i=r(i,1);n=r(n,1);a=r(a,1);this.value=new Uint8Array([e.floatToByte(t),e.floatToByte(i),e.floatToByte(n),e.floatToByte(a)])}n(o.prototype,{componentDatatype:{get:function(){return t.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return true}}});o.fromColor=function(e){if(!i(e)){throw new a("color is required.")}return new o(e.red,e.green,e.blue,e.alpha)};o.toValue=function(e,t){if(!i(e)){throw new a("color is required.")}if(!i(t)){return new Uint8Array(e.toBytes())}return e.toBytes(t)};o.equals=function(e,t){return e===t||i(e)&&i(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]};return o});define("Core/CompressedTextureBuffer",["./defined","./defineProperties"],function(e,t){"use strict";function r(e,t,r,i){this._format=e;this._width=t;this._height=r;this._buffer=i}t(r.prototype,{internalFormat:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}});r.clone=function(t){if(!e(t)){return undefined}return new r(t._format,t._width,t._height,t._buffer)};r.prototype.clone=function(){return r.clone(this)};return r});define("Core/CornerType",["./freezeObject"],function(e){"use strict";var t={ROUNDED:0,MITERED:1,BEVELED:2};return e(t)});define("Core/EllipsoidGeodesic",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Math"],function(e,t,r,i,n,a,o,s){"use strict";function l(e){var t=e._uSquared;var r=e._ellipsoid.maximumRadius;var i=e._ellipsoid.minimumRadius;var n=(r-i)/r;var a=Math.cos(e._startHeading);var o=Math.sin(e._startHeading);var s=(1-n)*Math.tan(e._start.latitude);var l=1/Math.sqrt(1+s*s);var u=l*s;var c=Math.atan2(s,a);var d=l*o;var f=d*d;var h=1-f;var p=Math.sqrt(h);var m=t/4;var v=m*m;var g=v*m;var _=v*v;var y=1+m-3*v/4+5*g/4-175*_/64;var b=1-m+15*v/8-35*g/8;var w=1-3*m+35*v/4;var C=1-5*m;var S=y*c-b*Math.sin(2*c)*m/2-w*Math.sin(4*c)*v/16-C*Math.sin(6*c)*g/48-Math.sin(8*c)*5*_/512;var T=e._constants;T.a=r;T.b=i;T.f=n;T.cosineHeading=a;T.sineHeading=o;T.tanU=s;T.cosineU=l;T.sineU=u;T.sigma=c;T.sineAlpha=d;T.sineSquaredAlpha=f;T.cosineSquaredAlpha=h;T.cosineAlpha=p;T.u2Over4=m;T.u4Over16=v;T.u6Over64=g;T.u8Over256=_;T.a0=y;T.a1=b;T.a2=w;T.a3=C;T.distanceRatio=S}function u(e,t){return e*t*(4+e*(4-3*t))/16}function c(e,t,r,i,n,a,o){var s=u(e,r);return(1-s)*e*t*(i+s*n*(o+s*a*(2*o*o-1)))}function d(e,t,r,i,n,a,o){var l=(t-r)/t;var u=a-i;var d=Math.atan((1-l)*Math.tan(n));var f=Math.atan((1-l)*Math.tan(o));var h=Math.cos(d);var p=Math.sin(d);var m=Math.cos(f);var v=Math.sin(f);var g=h*m;var _=h*v;var y=p*v;var b=p*m;var w=u;var C=s.TWO_PI;var S=Math.cos(w);var T=Math.sin(w);var E;var x;var P;var A;var O;do{S=Math.cos(w);T=Math.sin(w);var D=_-b*S;P=Math.sqrt(m*m*T*T+D*D);x=y+g*S;E=Math.atan2(P,x);var I;if(P===0){I=0;A=1}else{I=g*T/P;A=1-I*I}C=w;O=x-2*y/A;if(isNaN(O)){O=0}w=u+c(l,I,A,E,P,x,O)}while(Math.abs(w-C)>s.EPSILON12);var M=A*(t*t-r*r)/(r*r);var R=1+M*(4096+M*(M*(320-175*M)-768))/16384;var L=M*(256+M*(M*(74-47*M)-128))/1024;var N=O*O;var k=L*P*(O+L*(x*(2*N-1)-L*O*(4*P*P-3)*(4*N-3)/6)/4);var F=r*R*(E-k);var B=Math.atan2(m*T,_-b*S);var U=Math.atan2(h*T,_*S-b);e._distance=F;e._startHeading=B;e._endHeading=U;e._uSquared=M}var f=new e;var h=new e;function p(i,n,a,o){var s=e.normalize(o.cartographicToCartesian(n,h),f);var u=e.normalize(o.cartographicToCartesian(a,h),h);r.typeOf.number.greaterThanOrEquals("value",Math.abs(Math.abs(e.angleBetween(s,u))-Math.PI),.0125);d(i,o.maximumRadius,o.minimumRadius,n.longitude,n.latitude,a.longitude,a.latitude);i._start=t.clone(n,i._start);i._end=t.clone(a,i._end);i._start.height=0;i._end.height=0;l(i)}function m(e,r,a){var s=i(a,o.WGS84);this._ellipsoid=s;this._start=new t;this._end=new t;this._constants={};this._startHeading=undefined;this._endHeading=undefined;this._distance=undefined;this._uSquared=undefined;if(n(e)&&n(r)){p(this,e,r,s)}}a(m.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){r.defined("distance",this._distance);return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){r.defined("distance",this._distance);return this._startHeading}},endHeading:{get:function(){r.defined("distance",this._distance);return this._endHeading}}});m.prototype.setEndPoints=function(e,t){r.defined("start",e);r.defined("end",t);p(this,e,t,this._ellipsoid)};m.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)};m.prototype.interpolateUsingSurfaceDistance=function(e,i){r.defined("distance",this._distance);var a=this._constants;var o=a.distanceRatio+e/a.b;var s=Math.cos(2*o);var l=Math.cos(4*o);var u=Math.cos(6*o);var d=Math.sin(2*o);var f=Math.sin(4*o);var h=Math.sin(6*o);var p=Math.sin(8*o);var m=o*o;var v=o*m;var g=a.u8Over256;var _=a.u2Over4;var y=a.u6Over64;var b=a.u4Over16;var w=2*v*g*s/3+o*(1-_+7*b/4-15*y/4+579*g/64-(b-15*y/4+187*g/16)*s-(5*y/4-115*g/16)*l-29*g*u/16)+(_/2-b+71*y/32-85*g/16)*d+(5*b/16-5*y/4+383*g/96)*f-m*((y-11*g/2)*d+5*g*f/2)+(29*y/96-29*g/16)*h+539*g*p/1536;var C=Math.asin(Math.sin(w)*a.cosineAlpha);var S=Math.atan(a.a/a.b*Math.tan(C));w=w-a.sigma;var T=Math.cos(2*a.sigma+w);var E=Math.sin(w);var x=Math.cos(w);var P=a.cosineU*x;var A=a.sineU*E;var O=Math.atan2(E*a.sineHeading,P-A*a.cosineHeading);var D=O-c(a.f,a.sineAlpha,a.cosineSquaredAlpha,w,E,x,T);if(n(i)){i.longitude=this._start.longitude+D;i.latitude=S;i.height=0;return i}return new t(this._start.longitude+D,S,0)};return m});define("Core/PolylinePipeline",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidGeodesic","./IntersectionTests","./isArray","./Math","./Matrix4","./Plane"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";var f={};f.numberOfPoints=function(t,r,i){var n=e.distance(t,r);return Math.ceil(n/i)};var h=new t;f.extractHeights=function(e,t){var r=e.length;var i=new Array(r);for(var n=0;n<r;n++){var a=e[n];i[n]=t.cartesianToCartographic(a,h).height}return i};var p=new c;var m=new e;var v=new e;var g=new d(e.UNIT_X,0);var _=new e;var y=new d(e.UNIT_X,0);var b=new e;var w=new e;var C=[];function S(e,t,r){var i=C;i.length=e;var n;if(t===r){for(n=0;n<e;n++){i[n]=t}return i}var a=r-t;var o=a/e;for(n=0;n<e;n++){var s=t+n*o;i[n]=s}return i}var T=new t;var E=new t;var x=new e;var P=new e;var A=new e;var O=new o;function D(t,r,i,n,a,o,s,l){var u=n.scaleToGeodeticSurface(t,P);var c=n.scaleToGeodeticSurface(r,A);var d=f.numberOfPoints(t,r,i);var h=n.cartesianToCartographic(u,T);var p=n.cartesianToCartographic(c,E);var m=S(d,a,o);O.setEndPoints(h,p);var v=O.surfaceDistance/d;var g=l;h.height=a;var _=n.cartographicToCartesian(h,x);e.pack(_,s,g);g+=3;for(var y=1;y<d;y++){var b=O.interpolateUsingSurfaceDistance(y*v,E);b.height=m[y];_=n.cartographicToCartesian(b,x);e.pack(_,s,g);g+=3}return g}f.wrapLongitude=function(t,n){var a=[];var o=[];if(i(t)&&t.length>0){n=r(n,c.IDENTITY);var l=c.inverseTransformation(n,p);var u=c.multiplyByPoint(l,e.ZERO,m);var f=e.normalize(c.multiplyByPointAsVector(l,e.UNIT_Y,v),v);var h=d.fromPointNormal(u,f,g);var C=e.normalize(c.multiplyByPointAsVector(l,e.UNIT_X,_),_);var S=d.fromPointNormal(u,C,y);var T=1;a.push(e.clone(t[0]));var E=a[0];var x=t.length;for(var P=1;P<x;++P){var A=t[P];if(d.getPointDistance(S,E)<0||d.getPointDistance(S,A)<0){var O=s.lineSegmentPlane(E,A,h,b);if(i(O)){var D=e.multiplyByScalar(f,5e-9,w);if(d.getPointDistance(h,E)<0){e.negate(D,D)}a.push(e.add(O,D,new e));o.push(T+1);e.negate(D,D);a.push(e.add(O,D,new e));T=1}}a.push(e.clone(t[P]));T++;E=A}o.push(T)}return{positions:a,lengths:o}};f.generateArc=function(t){if(!i(t)){t={}}var o=t.positions;if(!i(o)){throw new n("options.positions is required.")}var s=o.length;var c=r(t.ellipsoid,a.WGS84);var d=r(t.height,0);var h=l(d);if(s<1){return[]}else if(s===1){var p=c.scaleToGeodeticSurface(o[0],P);d=h?d[0]:d;if(d!==0){var m=c.geodeticSurfaceNormal(p,x);e.multiplyByScalar(m,d,m);e.add(p,m,p)}return[p.x,p.y,p.z]}var v=t.minDistance;if(!i(v)){var g=r(t.granularity,u.RADIANS_PER_DEGREE);v=u.chordLength(g,c.maximumRadius)}var _=0;var y;for(y=0;y<s-1;y++){_+=f.numberOfPoints(o[y],o[y+1],v)}var b=(_+1)*3;var w=new Array(b);var S=0;for(y=0;y<s-1;y++){var E=o[y];var A=o[y+1];var O=h?d[y]:d;var I=h?d[y+1]:d;S=D(E,A,v,c,O,I,w,S)}C.length=0;var M=o[s-1];var R=c.cartesianToCartographic(M,T);R.height=h?d[s-1]:d;var L=c.cartographicToCartesian(R,x);e.pack(L,w,b-3);return w};f.generateCartesianArc=function(t){var r=f.generateArc(t);var i=r.length/3;var n=new Array(i);for(var a=0;a<i;a++){n[a]=e.unpack(r,a*3)}return n};return f});define("Core/PolylineVolumeGeometryLibrary",["./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./CornerType","./EllipsoidTangentPlane","./Math","./Matrix3","./Matrix4","./PolylinePipeline","./Quaternion","./Transforms"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";var f=[new t,new t];var h=new t;var p=new t;var m=new t;var v=new t;var g=new t;var _=new t;var y=new t;var b=new t;var w=new t;var C=new t;var S=new t;var T={};var E=new i;function x(e,t){var r=new Array(e.length);for(var i=0;i<e.length;i++){var n=e[i];E=t.cartesianToCartographic(n,E);r[i]=E.height;e[i]=t.scaleToGeodeticSurface(n,n)}return r}function P(e,r,i,n){var a=e[0];var o=e[1];var s=t.angleBetween(a,o);var l=Math.ceil(s/n);var u=new Array(l);var c;if(r===i){for(c=0;c<l;c++){u[c]=r}u.push(i);return u}var d=i-r;var f=d/l;for(c=1;c<l;c++){var h=r+c*f;u[c]=h}u[0]=r;u.push(i);return u}var A=new t;var O=new t;function D(r,i,n,o){var s=new a(n,o);var l=s.projectPointOntoPlane(t.add(n,r,A),A);var u=s.projectPointOntoPlane(t.add(n,i,O),O);var c=e.angleBetween(l,u);return u.x*l.y-u.y*l.x>=0?-c:c}var I=new t(-1,0,0);var M=new l;var R=new l;var L=new s;var N=s.IDENTITY.clone();var k=new t;var F=new r;var B=new t;function U(e,r,i,n,a,o,u,c){var f=k;var h=F;M=d.eastNorthUpToFixedFrame(e,a,M);f=l.multiplyByPointAsVector(M,I,f);f=t.normalize(f,f);var p=D(f,r,e,a);L=s.fromRotationZ(p,L);B.z=o;M=l.multiplyTransformation(M,l.fromRotationTranslation(L,B,R),M);var m=N;m[0]=u;for(var v=0;v<c;v++){for(var g=0;g<i.length;g+=3){h=t.fromArray(i,g,h);h=s.multiplyByVector(m,h,h);h=l.multiplyByPoint(M,h,h);n.push(h.x,h.y,h.z)}}return n}var V=new t;function z(e,r,i,n,a,o,s){for(var l=0;l<e.length;l+=3){var u=t.fromArray(e,l,V);n=U(u,r,i,n,a,o[l/3],s,1)}return n}function q(e,t){var r=e.length;var i=new Array(r*6);var n=0;var a=t.x+t.width/2;var o=t.y+t.height/2;var s=e[0];i[n++]=s.x-a;i[n++]=0;i[n++]=s.y-o;for(var l=1;l<r;l++){s=e[l];var u=s.x-a;var c=s.y-o;i[n++]=u;i[n++]=0;i[n++]=c;i[n++]=u;i[n++]=0;i[n++]=c}s=e[0];i[n++]=s.x-a;i[n++]=0;i[n++]=s.y-o;return i}function G(e,t){var r=e.length;var i=new Array(r*3);var n=0;var a=t.x+t.width/2;var o=t.y+t.height/2;for(var s=0;s<r;s++){i[n++]=e[s].x-a;i[n++]=0;i[n++]=e[s].y-o}return i}var H=new c;var j=new t;var W=new s;function Y(e,r,i,a,l,u,d,f,h,p){var m=t.angleBetween(t.subtract(r,e,C),t.subtract(i,e,S));var v=a===n.BEVELED?0:Math.ceil(m/o.toRadians(5));var g;if(l){g=s.fromQuaternion(c.fromAxisAngle(t.negate(e,C),m/(v+1),H),W)}else{g=s.fromQuaternion(c.fromAxisAngle(e,m/(v+1),H),W)}var _;var y;r=t.clone(r,j);if(v>0){var b=p?2:1;for(var w=0;w<v;w++){r=s.multiplyByVector(g,r,r);_=t.subtract(r,e,C);_=t.normalize(_,_);if(!l){_=t.negate(_,_)}y=u.scaleToGeodeticSurface(r,S);d=U(y,_,f,d,u,h,1,b)}}else{_=t.subtract(r,e,C);_=t.normalize(_,_);if(!l){_=t.negate(_,_)}y=u.scaleToGeodeticSurface(r,S);d=U(y,_,f,d,u,h,1,1);i=t.clone(i,j);_=t.subtract(i,e,C);_=t.normalize(_,_);if(!l){_=t.negate(_,_)}y=u.scaleToGeodeticSurface(i,S);d=U(y,_,f,d,u,h,1,1)}return d}T.removeDuplicatesFromShape=function(t){var r=t.length;var i=[];for(var n=r-1,a=0;a<r;n=a++){var o=t[n];var s=t[a];if(!e.equals(o,s)){i.push(s)}}return i};T.angleIsGreaterThanPi=function(e,r,i,n){var o=new a(i,n);var s=o.projectPointOntoPlane(t.add(i,e,A),A);var l=o.projectPointOntoPlane(t.add(i,r,O),O);return l.x*s.y-l.y*s.x>=0};var X=new t;var Q=new t;T.computePositions=function(e,r,i,a,s){var l=a._ellipsoid;var c=x(e,l);var d=a._granularity;var S=a._cornerType;var E=s?q(r,i):G(r,i);var A=s?G(r,i):undefined;var O=i.height/2;var D=i.width/2;var I=e.length;var M=[];var R=s?[]:undefined;var L=h;var N=p;var k=m;var F=v;var B=g;var V=_;var H=y;var j=b;var W=w;var Z=e[0];var K=e[1];F=l.geodeticSurfaceNormal(Z,F);L=t.subtract(K,Z,L);L=t.normalize(L,L);j=t.cross(F,L,j);j=t.normalize(j,j);var J=c[0];var $=c[1];if(s){R=U(Z,j,A,R,l,J+O,1,1)}W=t.clone(Z,W);Z=K;N=t.negate(L,N);var ee;var te;for(var re=1;re<I-1;re++){var ie=s?2:1;K=e[re+1];L=t.subtract(K,Z,L);L=t.normalize(L,L);k=t.add(L,N,k);k=t.normalize(k,k);F=l.geodeticSurfaceNormal(Z,F);var ne=t.multiplyByScalar(F,t.dot(L,F),X);t.subtract(L,ne,ne);t.normalize(ne,ne);var ae=t.multiplyByScalar(F,t.dot(N,F),Q);t.subtract(N,ae,ae);t.normalize(ae,ae);var oe=!o.equalsEpsilon(Math.abs(t.dot(ne,ae)),1,o.EPSILON7);if(oe){k=t.cross(k,F,k);k=t.cross(F,k,k);k=t.normalize(k,k);var se=1/Math.max(.25,t.magnitude(t.cross(k,N,C)));var le=T.angleIsGreaterThanPi(L,N,Z,l);if(le){B=t.add(Z,t.multiplyByScalar(k,se*D,k),B);V=t.add(B,t.multiplyByScalar(j,D,V),V);f[0]=t.clone(W,f[0]);f[1]=t.clone(V,f[1]);ee=P(f,J+O,$+O,d);te=u.generateArc({positions:f,granularity:d,ellipsoid:l});M=z(te,j,E,M,l,ee,1);j=t.cross(F,L,j);j=t.normalize(j,j);H=t.add(B,t.multiplyByScalar(j,D,H),H);if(S===n.ROUNDED||S===n.BEVELED){Y(B,V,H,S,le,l,M,E,$+O,s)}else{k=t.negate(k,k);M=U(Z,k,E,M,l,$+O,se,ie)}W=t.clone(H,W)}else{B=t.add(Z,t.multiplyByScalar(k,se*D,k),B);V=t.add(B,t.multiplyByScalar(j,-D,V),V);f[0]=t.clone(W,f[0]);f[1]=t.clone(V,f[1]);ee=P(f,J+O,$+O,d);te=u.generateArc({positions:f,granularity:d,ellipsoid:l});M=z(te,j,E,M,l,ee,1);j=t.cross(F,L,j);j=t.normalize(j,j);H=t.add(B,t.multiplyByScalar(j,-D,H),H);if(S===n.ROUNDED||S===n.BEVELED){Y(B,V,H,S,le,l,M,E,$+O,s)}else{M=U(Z,k,E,M,l,$+O,se,ie)}W=t.clone(H,W)}N=t.negate(L,N)}else{M=U(W,j,E,M,l,J+O,1,1);W=Z}J=$;$=c[re+1];Z=K}f[0]=t.clone(W,f[0]);f[1]=t.clone(Z,f[1]);ee=P(f,J+O,$+O,d);te=u.generateArc({positions:f,granularity:d,ellipsoid:l});M=z(te,j,E,M,l,ee,1);if(s){R=U(Z,j,A,R,l,$+O,1,1)}I=M.length;var ue=s?I+R.length:I;var ce=new Float64Array(ue);ce.set(M);if(s){ce.set(R,I)}return ce};return T});define("Core/CorridorGeometryLibrary",["./Cartesian3","./CornerType","./defined","./Math","./Matrix3","./PolylinePipeline","./PolylineVolumeGeometryLibrary","./Quaternion"],function(e,t,r,i,n,a,o,s){"use strict";var l={};var u=new e;var c=new e;var d=new e;var f=new e;var h=[new e,new e];var p=new e;var m=new e;var v=new e;var g=new e;var _=new e;var y=new e;var b=new e;var w=new e;var C=new e;var S=new e;var T=new s;var E=new n;function x(r,a,o,l,d){var f=e.angleBetween(e.subtract(a,r,u),e.subtract(o,r,c));var h=l===t.BEVELED?1:Math.ceil(f/i.toRadians(5))+1;var p=h*3;var m=new Array(p);m[p-3]=o.x;m[p-2]=o.y;m[p-1]=o.z;var v;if(d){v=n.fromQuaternion(s.fromAxisAngle(e.negate(r,u),f/h,T),E)}else{v=n.fromQuaternion(s.fromAxisAngle(r,f/h,T),E)}var g=0;a=e.clone(a,u);for(var _=0;_<h;_++){a=n.multiplyByVector(v,a,a);m[g++]=a.x;m[g++]=a.y;m[g++]=a.z}return m}function P(r){var i=p;var n=m;var a=v;var o=r[1];n=e.fromArray(r[1],o.length-3,n);a=e.fromArray(r[0],0,a);i=e.multiplyByScalar(e.add(n,a,i),.5,i);var s=x(i,n,a,t.ROUNDED,false);var l=r.length-1;var u=r[l-1];o=r[l];n=e.fromArray(u,u.length-3,n);a=e.fromArray(o,0,a);i=e.multiplyByScalar(e.add(n,a,i),.5,i);var c=x(i,n,a,t.ROUNDED,false);return[s,c]}function A(t,r,i,n){var a=u;if(n){a=e.add(t,r,a)}else{r=e.negate(r,r);a=e.add(t,r,a)}return[a.x,a.y,a.z,i.x,i.y,i.z]}function O(t,r,i,n){var a=new Array(t.length);var o=new Array(t.length);var s=e.multiplyByScalar(r,i,u);var l=e.negate(s,c);var h=0;var p=t.length-1;for(var m=0;m<t.length;m+=3){var v=e.fromArray(t,m,d);var g=e.add(v,l,f);a[h++]=g.x;a[h++]=g.y;a[h++]=g.z;var _=e.add(v,s,f);o[p--]=_.z;o[p--]=_.y;o[p--]=_.x}n.push(a,o);return n}l.addAttribute=function(e,t,i,n){var a=t.x;var o=t.y;var s=t.z;if(r(i)){e[i]=a;e[i+1]=o;e[i+2]=s}if(r(n)){e[n]=s;e[n-1]=o;e[n-2]=a}};var D=new e;var I=new e;l.computePositions=function(r){var n=r.granularity;var s=r.positions;var l=r.ellipsoid;var c=r.width/2;var d=r.cornerType;var f=r.saveAttributes;var T=p;var E=m;var M=v;var R=g;var L=_;var N=y;var k=b;var F=w;var B=C;var U=S;var V=[];var z=f?[]:undefined;var q=f?[]:undefined;var G=s[0];var H=s[1];E=e.normalize(e.subtract(H,G,E),E);T=l.geodeticSurfaceNormal(G,T);R=e.normalize(e.cross(T,E,R),R);if(f){z.push(R.x,R.y,R.z);q.push(T.x,T.y,T.z)}k=e.clone(G,k);G=H;M=e.negate(E,M);var j;var W=[];var Y;var X=s.length;for(Y=1;Y<X-1;Y++){T=l.geodeticSurfaceNormal(G,T);H=s[Y+1];E=e.normalize(e.subtract(H,G,E),E);L=e.normalize(e.add(E,M,L),L);var Q=e.multiplyByScalar(T,e.dot(E,T),D);e.subtract(E,Q,Q);e.normalize(Q,Q);var Z=e.multiplyByScalar(T,e.dot(M,T),I);e.subtract(M,Z,Z);e.normalize(Z,Z);var K=!i.equalsEpsilon(Math.abs(e.dot(Q,Z)),1,i.EPSILON7);if(K){L=e.cross(L,T,L);L=e.cross(T,L,L);L=e.normalize(L,L);var J=c/Math.max(.25,e.magnitude(e.cross(L,M,u)));var $=o.angleIsGreaterThanPi(E,M,G,l);L=e.multiplyByScalar(L,J,L);if($){F=e.add(G,L,F);U=e.add(F,e.multiplyByScalar(R,c,U),U);B=e.add(F,e.multiplyByScalar(R,c*2,B),B);h[0]=e.clone(k,h[0]);h[1]=e.clone(U,h[1]);j=a.generateArc({positions:h,granularity:n,ellipsoid:l});V=O(j,R,c,V);if(f){z.push(R.x,R.y,R.z);q.push(T.x,T.y,T.z)}N=e.clone(B,N);R=e.normalize(e.cross(T,E,R),R);B=e.add(F,e.multiplyByScalar(R,c*2,B),B);k=e.add(F,e.multiplyByScalar(R,c,k),k);if(d===t.ROUNDED||d===t.BEVELED){W.push({leftPositions:x(F,N,B,d,$)})}else{W.push({leftPositions:A(G,e.negate(L,L),B,$)})}}else{B=e.add(G,L,B);U=e.add(B,e.negate(e.multiplyByScalar(R,c,U),U),U);F=e.add(B,e.negate(e.multiplyByScalar(R,c*2,F),F),F);h[0]=e.clone(k,h[0]);h[1]=e.clone(U,h[1]);j=a.generateArc({positions:h,granularity:n,ellipsoid:l});V=O(j,R,c,V);if(f){z.push(R.x,R.y,R.z);q.push(T.x,T.y,T.z)}N=e.clone(F,N);R=e.normalize(e.cross(T,E,R),R);F=e.add(B,e.negate(e.multiplyByScalar(R,c*2,F),F),F);k=e.add(B,e.negate(e.multiplyByScalar(R,c,k),k),k);if(d===t.ROUNDED||d===t.BEVELED){W.push({rightPositions:x(B,N,F,d,$)})}else{W.push({rightPositions:A(G,L,F,$)})}}M=e.negate(E,M)}G=H}T=l.geodeticSurfaceNormal(G,T);h[0]=e.clone(k,h[0]);h[1]=e.clone(G,h[1]);j=a.generateArc({positions:h,granularity:n,ellipsoid:l});V=O(j,R,c,V);if(f){z.push(R.x,R.y,R.z);q.push(T.x,T.y,T.z)}var ee;if(d===t.ROUNDED){ee=P(V)}return{positions:V,corners:W,lefts:z,normals:q,endPositions:ee}};return l});define("ThirdParty/earcut-2.1.1",[],function(){"use strict";function e(e,r,n){n=n||2;var a=r&&r.length,o=a?r[0]*n:e.length,s=t(e,0,o,n,true),u=[];if(!s)return u;var c,d,f,h,p,m,v;if(a)s=l(e,r,s,n);if(e.length>80*n){c=f=e[0];d=h=e[1];for(var g=n;g<o;g+=n){p=e[g];m=e[g+1];if(p<c)c=p;if(m<d)d=m;if(p>f)f=p;if(m>h)h=m}v=Math.max(f-c,h-d)}i(s,u,n,c,d,v);return u}function t(e,t,r,i,n){var a,o;if(n===A(e,t,r,i)>0){for(a=t;a<r;a+=i)o=E(a,e[a],e[a+1],o)}else{for(a=r-i;a>=t;a-=i)o=E(a,e[a],e[a+1],o)}if(o&&y(o,o.next)){x(o);o=o.next}return o}function r(e,t){if(!e)return e;if(!t)t=e;var r=e,i;do{i=false;if(!r.steiner&&(y(r,r.next)||_(r.prev,r,r.next)===0)){x(r);r=t=r.prev;if(r===r.next)return null;i=true}else{r=r.next}}while(i||r!==t);return t}function i(e,t,l,u,c,d,h){if(!e)return;if(!h&&d)f(e,u,c,d);var p=e,m,v;while(e.prev!==e.next){m=e.prev;v=e.next;if(d?a(e,u,c,d):n(e)){t.push(m.i/l);t.push(e.i/l);t.push(v.i/l);x(e);e=v.next;p=v.next;continue}e=v;if(e===p){if(!h){i(r(e),t,l,u,c,d,1)}else if(h===1){e=o(e,t,l);i(e,t,l,u,c,d,2)}else if(h===2){s(e,t,l,u,c,d)}break}}}function n(e){var t=e.prev,r=e,i=e.next;if(_(t,r,i)>=0)return false;var n=e.next.next;while(n!==e.prev){if(v(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&_(n.prev,n,n.next)>=0)return false;n=n.next}return true}function a(e,t,r,i){var n=e.prev,a=e,o=e.next;if(_(n,a,o)>=0)return false;var s=n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,l=n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,u=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,c=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y;var d=p(s,l,t,r,i),f=p(u,c,t,r,i);var h=e.nextZ;while(h&&h.z<=f){if(h!==e.prev&&h!==e.next&&v(n.x,n.y,a.x,a.y,o.x,o.y,h.x,h.y)&&_(h.prev,h,h.next)>=0)return false;h=h.nextZ}h=e.prevZ;while(h&&h.z>=d){if(h!==e.prev&&h!==e.next&&v(n.x,n.y,a.x,a.y,o.x,o.y,h.x,h.y)&&_(h.prev,h,h.next)>=0)return false;h=h.prevZ}return true}function o(e,t,r){var i=e;do{var n=i.prev,a=i.next.next;if(!y(n,a)&&b(n,i,i.next,a)&&C(n,a)&&C(a,n)){t.push(n.i/r);t.push(i.i/r);t.push(a.i/r);x(i);x(i.next);i=e=a}i=i.next}while(i!==e);return i}function s(e,t,n,a,o,s){var l=e;do{var u=l.next.next;while(u!==l.prev){if(l.i!==u.i&&g(l,u)){var c=T(l,u);l=r(l,l.next);c=r(c,c.next);i(l,t,n,a,o,s);i(c,t,n,a,o,s);return}u=u.next}l=l.next}while(l!==e)}function l(e,i,n,a){var o=[],s,l,d,f,h;for(s=0,l=i.length;s<l;s++){d=i[s]*a;f=s<l-1?i[s+1]*a:e.length;h=t(e,d,f,a,false);if(h===h.next)h.steiner=true;o.push(m(h))}o.sort(u);for(s=0;s<o.length;s++){c(o[s],n);n=r(n,n.next)}return n}function u(e,t){return e.x-t.x}function c(e,t){t=d(e,t);if(t){var i=T(t,e);r(i,i.next)}}function d(e,t){var r=t,i=e.x,n=e.y,a=-Infinity,o;do{if(n<=r.y&&n>=r.next.y){var s=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){a=s;if(s===i){if(n===r.y)return r;if(n===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o)return null;if(i===a)return o.prev;var l=o,u=o.x,c=o.y,d=Infinity,f;r=o.next;while(r!==l){if(i>=r.x&&r.x>=u&&v(n<c?i:a,n,u,c,n<c?a:i,n,r.x,r.y)){f=Math.abs(n-r.y)/(i-r.x);if((f<d||f===d&&r.x>o.x)&&C(r,e)){o=r;d=f}}r=r.next}return o}function f(e,t,r,i){var n=e;do{if(n.z===null)n.z=p(n.x,n.y,t,r,i);n.prevZ=n.prev;n.nextZ=n.next;n=n.next}while(n!==e);n.prevZ.nextZ=null;n.prevZ=null;h(n)}function h(e){var t,r,i,n,a,o,s,l,u=1;do{r=e;e=null;a=null;o=0;while(r){o++;i=r;s=0;for(t=0;t<u;t++){s++;i=i.nextZ;if(!i)break}l=u;while(s>0||l>0&&i){if(s===0){n=i;i=i.nextZ;l--}else if(l===0||!i){n=r;r=r.nextZ;s--}else if(r.z<=i.z){n=r;r=r.nextZ;s--}else{n=i;i=i.nextZ;l--}if(a)a.nextZ=n;else e=n;n.prevZ=a;a=n}r=i}a.nextZ=null;u*=2}while(o>1);return e}function p(e,t,r,i,n){e=32767*(e-r)/n;t=32767*(t-i)/n;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1}function m(e){var t=e,r=e;do{if(t.x<r.x)r=t;t=t.next}while(t!==e);return r}function v(e,t,r,i,n,a,o,s){return(n-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(i-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(n-o)*(i-s)>=0}function g(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!w(e,t)&&C(e,t)&&C(t,e)&&S(e,t)}function _(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function b(e,t,r,i){if(y(e,t)&&y(r,i)||y(e,i)&&y(r,t))return true;return _(e,t,r)>0!==_(e,t,i)>0&&_(r,i,e)>0!==_(r,i,t)>0}function w(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&b(r,r.next,e,t))return true;r=r.next}while(r!==e);return false}function C(e,t){return _(e.prev,e,e.next)<0?_(e,t,e.next)>=0&&_(e,e.prev,t)>=0:_(e,t,e.prev)<0||_(e,e.next,t)<0}function S(e,t){var r=e,i=false,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{if(r.y>a!==r.next.y>a&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x)i=!i;r=r.next}while(r!==e);return i}function T(e,t){var r=new P(e.i,e.x,e.y),i=new P(t.i,t.x,t.y),n=e.next,a=t.prev;e.next=t;t.prev=e;r.next=n;n.prev=r;i.next=r;r.prev=i;a.next=i;i.prev=a;return i}function E(e,t,r,i){var n=new P(e,t,r);if(!i){n.prev=n;n.next=n}else{n.next=i.next;n.prev=i;i.next.prev=n;i.next=n}return n}function x(e){e.next.prev=e.prev;e.prev.next=e.next;if(e.prevZ)e.prevZ.nextZ=e.nextZ;if(e.nextZ)e.nextZ.prevZ=e.prevZ}function P(e,t,r){this.i=e;this.x=t;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}e.deviation=function(e,t,r,i){var n=t&&t.length;var a=n?t[0]*r:e.length;var o=Math.abs(A(e,0,a,r));if(n){for(var s=0,l=t.length;s<l;s++){var u=t[s]*r;var c=s<l-1?t[s+1]*r:e.length;o-=Math.abs(A(e,u,c,r))}}var d=0;for(s=0;s<i.length;s+=3){var f=i[s]*r;var h=i[s+1]*r;var p=i[s+2]*r;d+=Math.abs((e[f]-e[p])*(e[h+1]-e[f+1])-(e[f]-e[h])*(e[p+1]-e[f+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function A(e,t,r,i){var n=0;for(var a=t,o=r-i;a<r;a+=i){n+=(e[o]-e[a])*(e[a+1]+e[o+1]);o=a}return n}e.flatten=function(e){var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0;for(var n=0;n<e.length;n++){for(var a=0;a<e[n].length;a++){for(var o=0;o<t;o++)r.vertices.push(e[n][a][o])}if(n>0){i+=e[n-1].length;r.holes.push(i)}}return r};return e});define("Core/WindingOrder",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var r={CLOCKWISE:t.CW,COUNTER_CLOCKWISE:t.CCW,validate:function(e){return e===r.CLOCKWISE||e===r.COUNTER_CLOCKWISE}};return e(r)});define("Core/PolygonPipeline",["../ThirdParty/earcut-2.1.1","./Cartesian2","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./Ellipsoid","./Geometry","./GeometryAttribute","./Math","./PrimitiveType","./WindingOrder"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";var h=new r;var p=new r;var m={};m.computeArea2D=function(e){i.defined("positions",e);i.typeOf.number.greaterThanOrEquals("positions.length",e.length,3);var t=e.length;var r=0;for(var n=t-1,a=0;a<t;n=a++){var o=e[n];var s=e[a];r+=o.x*s.y-s.x*o.y}return r*.5};m.computeWindingOrder2D=function(e){var t=m.computeArea2D(e);return t>0?f.COUNTER_CLOCKWISE:f.CLOCKWISE};m.triangulate=function(r,n){i.defined("positions",r);var a=t.packArray(r);return e(a,n,2)};var v=new r;var g=new r;var _=new r;var y=new r;var b=new r;var w=new r;var C=new r;m.computeSubdivision=function(e,t,s,f){f=a(f,c.RADIANS_PER_DEGREE);i.typeOf.object("ellipsoid",e);i.defined("positions",t);i.defined("indices",s);i.typeOf.number.greaterThanOrEquals("indices.length",s.length,3);i.typeOf.number.equals("indices.length % 3","0",s.length%3,0);i.typeOf.number.greaterThan("granularity",f,0);var h=s.slice(0);var p;var m=t.length;var S=new Array(m*3);var T=0;for(p=0;p<m;p++){var E=t[p];S[T++]=E.x;S[T++]=E.y;S[T++]=E.z}var x=[];var P={};var A=e.maximumRadius;var O=c.chordLength(f,A);var D=O*O;while(h.length>0){var I=h.pop();var M=h.pop();var R=h.pop();var L=r.fromArray(S,R*3,v);var N=r.fromArray(S,M*3,g);var k=r.fromArray(S,I*3,_);var F=r.multiplyByScalar(r.normalize(L,y),A,y);var B=r.multiplyByScalar(r.normalize(N,b),A,b);var U=r.multiplyByScalar(r.normalize(k,w),A,w);var V=r.magnitudeSquared(r.subtract(F,B,C));var z=r.magnitudeSquared(r.subtract(B,U,C));var q=r.magnitudeSquared(r.subtract(U,F,C));var G=Math.max(V,z,q);var H;var j;if(G>D){if(V===G){H=Math.min(R,M)+" "+Math.max(R,M);p=P[H];if(!o(p)){j=r.add(L,N,C);r.multiplyByScalar(j,.5,j);S.push(j.x,j.y,j.z);p=S.length/3-1;P[H]=p}h.push(R,p,I);h.push(p,M,I)}else if(z===G){H=Math.min(M,I)+" "+Math.max(M,I);p=P[H];if(!o(p)){j=r.add(N,k,C);r.multiplyByScalar(j,.5,j);S.push(j.x,j.y,j.z);p=S.length/3-1;P[H]=p}h.push(M,p,R);h.push(p,I,R)}else if(q===G){H=Math.min(I,R)+" "+Math.max(I,R);p=P[H];if(!o(p)){j=r.add(k,L,C);r.multiplyByScalar(j,.5,j);S.push(j.x,j.y,j.z);p=S.length/3-1;P[H]=p}h.push(I,p,M);h.push(p,R,M)}}else{x.push(R);x.push(M);x.push(I)}}return new l({attributes:{position:new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:S})},indices:x,primitiveType:d.TRIANGLES})};m.scaleToGeodeticHeight=function(e,t,i,n){i=a(i,s.WGS84);var l=h;var u=p;t=a(t,0);n=a(n,true);if(o(e)){var c=e.length;for(var d=0;d<c;d+=3){r.fromArray(e,d,u);if(n){u=i.scaleToGeodeticSurface(u,u)}if(t!==0){l=i.geodeticSurfaceNormal(u,l);r.multiplyByScalar(l,t,l);r.add(u,l,u)}e[d]=u.x;e[d+1]=u.y;e[d+2]=u.z}}return e};return m});define("Core/CorridorGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Cartographic","./ComponentDatatype","./CornerType","./CorridorGeometryLibrary","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Rectangle","./VertexFormat"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b){"use strict";var w=new r;var C=new r;var S=new r;var T=new r;var E=new r;var x=new r;var P=new r;var A=new r;function O(e,t){for(var r=0;r<e.length;r++){e[r]=t.scaleToGeodeticSurface(e[r],e[r])}return e}function D(e,t,i,n,a,s){var l=e.normals;var u=e.tangents;var c=e.bitangents;var d=r.normalize(r.cross(i,t,P),P);if(s.normal){o.addAttribute(l,t,n,a)}if(s.tangent){o.addAttribute(u,d,n,a)}if(s.bitangent){o.addAttribute(c,i,n,a)}}function I(e,t,i){var a=e.positions;var s=e.corners;var u=e.endPositions;var c=e.lefts;var d=e.normals;var f=new p;var g;var _=0;var y=0;var b;var E=0;var O;for(b=0;b<a.length;b+=2){O=a[b].length-3;_+=O;E+=O*2;y+=a[b+1].length-3}_+=3;y+=3;for(b=0;b<s.length;b++){g=s[b];var I=s[b].leftPositions;if(l(I)){O=I.length;_+=O;E+=O}else{O=s[b].rightPositions.length;y+=O;E+=O}}var M=l(u);var R;if(M){R=u[0].length-3;_+=R;y+=R;R/=3;E+=R*6}var L=_+y;var N=new Float64Array(L);var k=t.normal?new Float32Array(L):undefined;var F=t.tangent?new Float32Array(L):undefined;var B=t.bitangent?new Float32Array(L):undefined;var U={normals:k,tangents:F,bitangents:B};var V=0;var z=L-1;var q,G,H,j;var W=w;var Y=C;var X,Q;var Z=R/2;var K=m.createTypedArray(L/3,E);var J=0;if(M){Q=S;X=T;var $=u[0];W=r.fromArray(d,0,W);Y=r.fromArray(c,0,Y);for(b=0;b<Z;b++){Q=r.fromArray($,(Z-1-b)*3,Q);X=r.fromArray($,(Z+b)*3,X);o.addAttribute(N,X,V);o.addAttribute(N,Q,undefined,z);D(U,W,Y,V,z,t);G=V/3;j=G+1;q=(z-2)/3;H=q-1;K[J++]=q;K[J++]=G;K[J++]=H;K[J++]=H;K[J++]=G;K[J++]=j;V+=3;z-=3}}var ee=0;var te=0;var re=a[ee++];var ie=a[ee++];N.set(re,V);N.set(ie,z-ie.length+1);Y=r.fromArray(c,te,Y);var ne;var ae;O=ie.length-3;for(b=0;b<O;b+=3){ne=i.geodeticSurfaceNormal(r.fromArray(re,b,P),P);ae=i.geodeticSurfaceNormal(r.fromArray(ie,O-b,A),A);W=r.normalize(r.add(ne,ae,W),W);D(U,W,Y,V,z,t);G=V/3;j=G+1;q=(z-2)/3;H=q-1;K[J++]=q;K[J++]=G;K[J++]=H;K[J++]=H;K[J++]=G;K[J++]=j;V+=3;z-=3}ne=i.geodeticSurfaceNormal(r.fromArray(re,O,P),P);ae=i.geodeticSurfaceNormal(r.fromArray(ie,O,A),A);W=r.normalize(r.add(ne,ae,W),W);te+=3;for(b=0;b<s.length;b++){var oe;g=s[b];var se=g.leftPositions;var le=g.rightPositions;var ue;var ce;var de=x;var fe=S;var he=T;W=r.fromArray(d,te,W);if(l(se)){D(U,W,Y,undefined,z,t);z-=3;ue=j;ce=H;for(oe=0;oe<se.length/3;oe++){de=r.fromArray(se,oe*3,de);K[J++]=ue;K[J++]=ce-oe-1;K[J++]=ce-oe;o.addAttribute(N,de,undefined,z);fe=r.fromArray(N,(ce-oe-1)*3,fe);he=r.fromArray(N,ue*3,he);Y=r.normalize(r.subtract(fe,he,Y),Y);D(U,W,Y,undefined,z,t);z-=3}de=r.fromArray(N,ue*3,de);fe=r.subtract(r.fromArray(N,ce*3,fe),de,fe);he=r.subtract(r.fromArray(N,(ce-oe)*3,he),de,he);Y=r.normalize(r.add(fe,he,Y),Y);D(U,W,Y,V,undefined,t);V+=3}else{D(U,W,Y,V,undefined,t);V+=3;ue=H;ce=j;for(oe=0;oe<le.length/3;oe++){de=r.fromArray(le,oe*3,de);K[J++]=ue;K[J++]=ce+oe;K[J++]=ce+oe+1;o.addAttribute(N,de,V);fe=r.fromArray(N,ue*3,fe);he=r.fromArray(N,(ce+oe)*3,he);Y=r.normalize(r.subtract(fe,he,Y),Y);D(U,W,Y,V,undefined,t);V+=3}de=r.fromArray(N,ue*3,de);fe=r.subtract(r.fromArray(N,(ce+oe)*3,fe),de,fe);he=r.subtract(r.fromArray(N,ce*3,he),de,he);Y=r.normalize(r.negate(r.add(he,fe,Y),Y),Y);D(U,W,Y,undefined,z,t);z-=3}re=a[ee++];ie=a[ee++];re.splice(0,3);ie.splice(ie.length-3,3);N.set(re,V);N.set(ie,z-ie.length+1);O=ie.length-3;te+=3;Y=r.fromArray(c,te,Y);for(oe=0;oe<ie.length;oe+=3){ne=i.geodeticSurfaceNormal(r.fromArray(re,oe,P),P);ae=i.geodeticSurfaceNormal(r.fromArray(ie,O-oe,A),A);W=r.normalize(r.add(ne,ae,W),W);D(U,W,Y,V,z,t);j=V/3;G=j-1;H=(z-2)/3;q=H+1;K[J++]=q;K[J++]=G;K[J++]=H;K[J++]=H;K[J++]=G;K[J++]=j;V+=3;z-=3}V-=3;z+=3}W=r.fromArray(d,d.length-3,W);D(U,W,Y,V,z,t);if(M){V+=3;z-=3;Q=S;X=T;var pe=u[1];for(b=0;b<Z;b++){Q=r.fromArray(pe,(R-b-1)*3,Q);X=r.fromArray(pe,b*3,X);o.addAttribute(N,Q,undefined,z);o.addAttribute(N,X,V);D(U,W,Y,V,z,t);j=V/3;G=j-1;H=(z-2)/3;q=H+1;K[J++]=q;K[J++]=G;K[J++]=H;K[J++]=H;K[J++]=G;K[J++]=j;V+=3;z-=3}}f.position=new h({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:N});if(t.st){var me=new Float32Array(L/3*2);var ve;var ge;var _e=0;if(M){_/=3;y/=3;var ye=Math.PI/(R+1);ge=1/(_-R+1);ve=1/(y-R+1);var be;var we=R/2;for(b=we+1;b<R+1;b++){be=v.PI_OVER_TWO+ye*b;me[_e++]=ve*(1+Math.cos(be));me[_e++]=.5*(1+Math.sin(be))}for(b=1;b<y-R+1;b++){me[_e++]=b*ve;me[_e++]=0}for(b=R;b>we;b--){be=v.PI_OVER_TWO-b*ye;me[_e++]=1-ve*(1+Math.cos(be));me[_e++]=.5*(1+Math.sin(be))}for(b=we;b>0;b--){be=v.PI_OVER_TWO-ye*b;me[_e++]=1-ge*(1+Math.cos(be));me[_e++]=.5*(1+Math.sin(be))}for(b=_-R;b>0;b--){me[_e++]=b*ge;me[_e++]=1}for(b=1;b<we+1;b++){be=v.PI_OVER_TWO+ye*b;me[_e++]=ge*(1+Math.cos(be));me[_e++]=.5*(1+Math.sin(be))}}else{_/=3;y/=3;ge=1/(_-1);ve=1/(y-1);for(b=0;b<y;b++){me[_e++]=b*ve;me[_e++]=0}for(b=_;b>0;b--){me[_e++]=(b-1)*ge;me[_e++]=1}}f.st=new h({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:me})}if(t.normal){f.normal=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:U.normals})}if(t.tangent){f.tangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:U.tangents})}if(t.bitangent){f.bitangent=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:U.bitangents})}return{attributes:f,indices:K}}function M(e,t){if(!t.normal&&!t.tangent&&!t.bitangent&&!t.st){return e}var i=e.position.values;var n;var a;if(t.normal||t.bitangent){n=e.normal.values;a=e.bitangent.values}var s=e.position.values.length/18;var l=s*3;var u=s*2;var c=l*2;var d;if(t.normal||t.bitangent||t.tangent){var f=t.normal?new Float32Array(l*6):undefined;var h=t.tangent?new Float32Array(l*6):undefined;var p=t.bitangent?new Float32Array(l*6):undefined;var m=w;var v=C;var g=S;var _=T;var y=E;var b=x;var P=c;for(d=0;d<l;d+=3){var A=P+c;m=r.fromArray(i,d,m);v=r.fromArray(i,d+l,v);g=r.fromArray(i,(d+3)%l,g);v=r.subtract(v,m,v);g=r.subtract(g,m,g);_=r.normalize(r.cross(v,g,_),_);if(t.normal){o.addAttribute(f,_,A);o.addAttribute(f,_,A+3);o.addAttribute(f,_,P);o.addAttribute(f,_,P+3)}if(t.tangent||t.bitangent){b=r.fromArray(n,d,b);if(t.bitangent){o.addAttribute(p,b,A);o.addAttribute(p,b,A+3);o.addAttribute(p,b,P);o.addAttribute(p,b,P+3)}if(t.tangent){y=r.normalize(r.cross(b,_,y),y);o.addAttribute(h,y,A);o.addAttribute(h,y,A+3);o.addAttribute(h,y,P);o.addAttribute(h,y,P+3)}}P+=6}if(t.normal){f.set(n);for(d=0;d<l;d+=3){f[d+l]=-n[d];f[d+l+1]=-n[d+1];f[d+l+2]=-n[d+2]}e.normal.values=f}else{e.normal=undefined}if(t.bitangent){p.set(a);p.set(a,l);e.bitangent.values=p}else{e.bitangent=undefined}if(t.tangent){var O=e.tangent.values;h.set(O);h.set(O,l);e.tangent.values=h}}if(t.st){var D=e.st.values;var I=new Float32Array(u*6);I.set(D);I.set(D,u);var M=u*2;for(var R=0;R<2;R++){I[M++]=D[0];I[M++]=D[1];for(d=2;d<u;d+=2){var L=D[d];var N=D[d+1];I[M++]=L;I[M++]=N;I[M++]=L;I[M++]=N}I[M++]=D[0];I[M++]=D[1]}e.st.values=I}return e}function R(e,t,r){r[t++]=e[0];r[t++]=e[1];r[t++]=e[2];for(var i=3;i<e.length;i+=3){var n=e[i];var a=e[i+1];var o=e[i+2];r[t++]=n;r[t++]=a;r[t++]=o;r[t++]=n;r[t++]=a;r[t++]=o}r[t++]=e[0];r[t++]=e[1];r[t++]=e[2];return r}function L(e,t){var r=new b({position:t.position,normal:t.normal||t.bitangent||e.shadowVolume,tangent:t.tangent,bitangent:t.normal||t.bitangent,st:t.st});var i=e.ellipsoid;var a=o.computePositions(e);var s=I(a,r,i);var l=e.height;var u=e.extrudedHeight;var c=s.attributes;var d=s.indices;var f=c.position.values;var p=f.length;var v=new Float64Array(p*6);var _=new Float64Array(p);_.set(f);var y=new Float64Array(p*4);f=g.scaleToGeodeticHeight(f,l,i);y=R(f,0,y);_=g.scaleToGeodeticHeight(_,u,i);y=R(_,p*2,y);v.set(f);v.set(_,p);v.set(y,p*2);c.position.values=v;c=M(c,t);var w;var C=p/3;if(e.shadowVolume){var S=c.normal.values;p=S.length;var T=new Float32Array(p*6);for(w=0;w<p;w++){S[w]=-S[w]}T.set(S,p);T=R(S,p*4,T);c.extrudeDirection=new h({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:T});if(!t.normal){c.normal=undefined}}var E=d.length;var x=C+C;var P=m.createTypedArray(v.length/3,E*2+x*3);P.set(d);var A=E;for(w=0;w<E;w+=3){var O=d[w];var D=d[w+1];var L=d[w+2];P[A++]=L+C;P[A++]=D+C;P[A++]=O+C}var N,k,F,B;for(w=0;w<x;w+=2){N=w+x;k=N+x;F=N+1;B=k+1;P[A++]=N;P[A++]=k;P[A++]=F;P[A++]=F;P[A++]=k;P[A++]=B}return{attributes:c,indices:P}}var N=new r;var k=new r;var F=new i;function B(e,t,i,n,a,o){var s=r.subtract(t,e,N);r.normalize(s,s);var l=i.geodeticSurfaceNormal(e,k);var u=r.cross(s,l,N);r.multiplyByScalar(u,n,u);var c=a.latitude;var d=a.longitude;var f=o.latitude;var h=o.longitude;r.add(e,u,k);i.cartesianToCartographic(k,F);var p=F.latitude;var m=F.longitude;c=Math.min(c,p);d=Math.min(d,m);f=Math.max(f,p);h=Math.max(h,m);r.subtract(e,u,k);i.cartesianToCartographic(k,F);p=F.latitude;m=F.longitude;c=Math.min(c,p);d=Math.min(d,m);f=Math.max(f,p);h=Math.max(h,m);a.latitude=c;a.longitude=d;o.latitude=f;o.longitude=h}var U=new r;var V=new r;var z=new i;var q=new i;function G(t,i,n,o){t=O(t,i);var s=e(t,r.equalsEpsilon);var l=s.length;if(l<2||n<=0){return new y}var u=n*.5;z.latitude=Number.POSITIVE_INFINITY;z.longitude=Number.POSITIVE_INFINITY;q.latitude=Number.NEGATIVE_INFINITY;q.longitude=Number.NEGATIVE_INFINITY;var c,d;if(o===a.ROUNDED){var f=s[0];r.subtract(f,s[1],U);r.normalize(U,U);r.multiplyByScalar(U,u,U);r.add(f,U,V);i.cartesianToCartographic(V,F);c=F.latitude;d=F.longitude;z.latitude=Math.min(z.latitude,c);z.longitude=Math.min(z.longitude,d);q.latitude=Math.max(q.latitude,c);q.longitude=Math.max(q.longitude,d)}for(var h=0;h<l-1;++h){B(s[h],s[h+1],i,u,z,q)}var p=s[l-1];r.subtract(p,s[l-2],U);r.normalize(U,U);r.multiplyByScalar(U,u,U);r.add(p,U,V);B(p,V,i,u,z,q);if(o===a.ROUNDED){i.cartesianToCartographic(V,F);c=F.latitude;d=F.longitude;z.latitude=Math.min(z.latitude,c);z.longitude=Math.min(z.longitude,d);q.latitude=Math.max(q.latitude,c);q.longitude=Math.max(q.longitude,d)}var m=new y;m.north=q.latitude;m.south=z.latitude;m.east=q.longitude;m.west=z.longitude;return m}function H(e){e=s(e,s.EMPTY_OBJECT);var t=e.positions;var i=e.width;if(!l(t)){throw new c("options.positions is required.")}if(!l(i)){throw new c("options.width is required.")}this._positions=t;this._ellipsoid=d.clone(s(e.ellipsoid,d.WGS84));this._vertexFormat=b.clone(s(e.vertexFormat,b.DEFAULT));this._width=i;this._height=s(e.height,0);this._extrudedHeight=s(e.extrudedHeight,this._height);this._cornerType=s(e.cornerType,a.ROUNDED);this._granularity=s(e.granularity,v.RADIANS_PER_DEGREE);this._shadowVolume=s(e.shadowVolume,false);this._workerName="createCorridorGeometry";this._rectangle=G(t,this._ellipsoid,i,this._cornerType);this.packedLength=1+t.length*r.packedLength+d.packedLength+b.packedLength+y.packedLength+6}H.pack=function(e,t,i){if(!l(e)){throw new c("value is required")}if(!l(t)){throw new c("array is required")}i=s(i,0);var n=e._positions;var a=n.length;t[i++]=a;for(var o=0;o<a;++o,i+=r.packedLength){r.pack(n[o],t,i)}d.pack(e._ellipsoid,t,i);i+=d.packedLength;b.pack(e._vertexFormat,t,i);i+=b.packedLength;y.pack(e._rectangle,t,i);i+=y.packedLength;t[i++]=e._width;t[i++]=e._height;t[i++]=e._extrudedHeight;t[i++]=e._cornerType;t[i++]=e._granularity;t[i]=e._shadowVolume?1:0;return t};var j=d.clone(d.UNIT_SPHERE);var W=new b;var Y=new y;var X={positions:undefined,ellipsoid:j,vertexFormat:W,width:undefined,height:undefined,extrudedHeight:undefined,cornerType:undefined,granularity:undefined,shadowVolume:undefined};H.unpack=function(e,t,i){if(!l(e)){throw new c("array is required")}t=s(t,0);var n=e[t++];var a=new Array(n);for(var o=0;o<n;++o,t+=r.packedLength){a[o]=r.unpack(e,t)}var u=d.unpack(e,t,j);t+=d.packedLength;var f=b.unpack(e,t,W);t+=b.packedLength;var h=y.unpack(e,t,Y);t+=y.packedLength;var p=e[t++];var m=e[t++];var v=e[t++];var g=e[t++];var _=e[t++];var w=e[t]===1;if(!l(i)){X.positions=a;X.width=p;X.height=m;X.extrudedHeight=v;X.cornerType=g;X.granularity=_;X.shadowVolume=w;return new H(X)}i._positions=a;i._ellipsoid=d.clone(u,i._ellipsoid);i._vertexFormat=b.clone(f,i._vertexFormat);i._width=p;i._height=m;i._extrudedHeight=v;i._cornerType=g;i._granularity=_;i._rectangle=y.clone(h);i._shadowVolume=w;return i};H.createGeometry=function(i){var n=i._positions;var a=i._height;var s=i._width;var l=i._extrudedHeight;var u=a!==l;var c=i._ellipsoid;n=O(n,c);var d=e(n,r.equalsEpsilon);if(d.length<2||s<=0){return}var h=i._vertexFormat;var p={ellipsoid:c,positions:d,width:s,cornerType:i._cornerType,granularity:i._granularity,saveAttributes:true};var m;if(u){var v=Math.max(a,l);l=Math.min(a,l);a=v;p.height=a;p.extrudedHeight=l;p.shadowVolume=i._shadowVolume;m=L(p,h)}else{var y=o.computePositions(p);m=I(y,h,c);m.attributes.position.values=g.scaleToGeodeticHeight(m.attributes.position.values,a,c)}var b=m.attributes;var w=t.fromVertices(b.position.values,undefined,3);if(!h.position){m.attributes.position.values=undefined}return new f({attributes:b,indices:m.indices,primitiveType:_.TRIANGLES,boundingSphere:w})};H.createShadowVolume=function(e,t,r){var i=e._granularity;var n=e._ellipsoid;var a=t(i,n);var o=r(i,n);return new H({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:n,granularity:i,extrudedHeight:a,height:o,vertexFormat:b.POSITION_ONLY,shadowVolume:true})};u(H.prototype,{rectangle:{get:function(){return this._rectangle}}});return H});define("Core/CorridorOutlineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./CornerType","./CorridorGeometryLibrary","./defaultValue","./defined","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";var g=new r;var _=new r;var y=new r;function b(e,t){for(var r=0;r<e.length;r++){e[r]=t.scaleToGeodeticSurface(e[r],e[r])}return e}function w(e,t){var i=[];var s=e.positions;var u=e.corners;var c=e.endPositions;var p=new f;var m;var v=0;var b=0;var w;var C=0;var S;for(w=0;w<s.length;w+=2){S=s[w].length-3;v+=S;C+=S/3*4;b+=s[w+1].length-3}v+=3;b+=3;for(w=0;w<u.length;w++){m=u[w];var T=u[w].leftPositions;if(l(T)){S=T.length;v+=S;C+=S/3*2}else{S=u[w].rightPositions.length;b+=S;C+=S/3*2}}var E=l(c);var x;if(E){x=c[0].length-3;v+=x;b+=x;x/=3;C+=x*4}var P=v+b;var A=new Float64Array(P);var O=0;var D=P-1;var I,M,R,L;var N,k;var F=x/2;var B=h.createTypedArray(P/3,C+4);var U=0;B[U++]=O/3;B[U++]=(D-2)/3;if(E){i.push(O/3);k=g;N=_;var V=c[0];for(w=0;w<F;w++){k=r.fromArray(V,(F-1-w)*3,k);N=r.fromArray(V,(F+w)*3,N);o.addAttribute(A,N,O);o.addAttribute(A,k,undefined,D);M=O/3;L=M+1;I=(D-2)/3;R=I-1;B[U++]=I;B[U++]=R;B[U++]=M;B[U++]=L;O+=3;D-=3}}var z=0;var q=s[z++];var G=s[z++];A.set(q,O);A.set(G,D-G.length+1);S=G.length-3;i.push(O/3,(D-2)/3);for(w=0;w<S;w+=3){M=O/3;L=M+1;I=(D-2)/3;R=I-1;B[U++]=I;B[U++]=R;B[U++]=M;B[U++]=L;O+=3;D-=3}for(w=0;w<u.length;w++){var H;m=u[w];var j=m.leftPositions;var W=m.rightPositions;var Y;var X=y;if(l(j)){D-=3;Y=R;i.push(L);for(H=0;H<j.length/3;H++){X=r.fromArray(j,H*3,X);B[U++]=Y-H-1;B[U++]=Y-H;o.addAttribute(A,X,undefined,D);D-=3}i.push(Y-Math.floor(j.length/6));if(t===a.BEVELED){i.push((D-2)/3+1)}O+=3}else{O+=3;Y=L;i.push(R);for(H=0;H<W.length/3;H++){X=r.fromArray(W,H*3,X);B[U++]=Y+H;B[U++]=Y+H+1;o.addAttribute(A,X,O);O+=3}i.push(Y+Math.floor(W.length/6));if(t===a.BEVELED){i.push(O/3-1)}D-=3}q=s[z++];G=s[z++];q.splice(0,3);G.splice(G.length-3,3);A.set(q,O);A.set(G,D-G.length+1);S=G.length-3;for(H=0;H<G.length;H+=3){L=O/3;M=L-1;R=(D-2)/3;I=R+1;B[U++]=I;B[U++]=R;B[U++]=M;B[U++]=L;O+=3;D-=3}O-=3;D+=3;i.push(O/3,(D-2)/3)}if(E){O+=3;D-=3;k=g;N=_;var Q=c[1];for(w=0;w<F;w++){k=r.fromArray(Q,(x-w-1)*3,k);N=r.fromArray(Q,w*3,N);o.addAttribute(A,k,undefined,D);o.addAttribute(A,N,O);L=O/3;M=L-1;R=(D-2)/3;I=R+1;B[U++]=I;B[U++]=R;B[U++]=M;B[U++]=L;O+=3;D-=3}i.push(O/3)}else{i.push(O/3,(D-2)/3)}B[U++]=O/3;B[U++]=(D-2)/3;p.position=new d({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:A});return{attributes:p,indices:B,wallIndices:i}}function C(e){var t=e.ellipsoid;var r=o.computePositions(e);var i=w(r,e.cornerType);var n=i.wallIndices;var a=e.height;var s=e.extrudedHeight;var l=i.attributes;var u=i.indices;var c=l.position.values;var d=c.length;var f=new Float64Array(d);f.set(c);var p=new Float64Array(d*2);c=m.scaleToGeodeticHeight(c,a,t);f=m.scaleToGeodeticHeight(f,s,t);p.set(c);p.set(f,d);l.position.values=p;d/=3;var v;var g=u.length;var _=h.createTypedArray(p.length/3,(g+n.length)*2);_.set(u);var y=g;for(v=0;v<g;v+=2){var b=u[v];var C=u[v+1];_[y++]=b+d;_[y++]=C+d}var S,T;for(v=0;v<n.length;v++){S=n[v];T=S+d;_[y++]=S;_[y++]=T}return{attributes:l,indices:_}}function S(e){e=s(e,s.EMPTY_OBJECT);var t=e.positions;var n=e.width;i.typeOf.object("options.positions",t);i.typeOf.number("options.width",n);this._positions=t;this._ellipsoid=u.clone(s(e.ellipsoid,u.WGS84));this._width=n;this._height=s(e.height,0);this._extrudedHeight=s(e.extrudedHeight,this._height);this._cornerType=s(e.cornerType,a.ROUNDED);this._granularity=s(e.granularity,p.RADIANS_PER_DEGREE);this._workerName="createCorridorOutlineGeometry";this.packedLength=1+t.length*r.packedLength+u.packedLength+5}S.pack=function(e,t,n){i.typeOf.object("value",e);i.typeOf.object("array",t);n=s(n,0);var a=e._positions;var o=a.length;t[n++]=o;for(var l=0;l<o;++l,n+=r.packedLength){r.pack(a[l],t,n)}u.pack(e._ellipsoid,t,n);n+=u.packedLength;t[n++]=e._width;t[n++]=e._height;t[n++]=e._extrudedHeight;t[n++]=e._cornerType;t[n]=e._granularity;return t};var T=u.clone(u.UNIT_SPHERE);var E={positions:undefined,ellipsoid:T,width:undefined,height:undefined,extrudedHeight:undefined,cornerType:undefined,granularity:undefined};S.unpack=function(e,t,n){i.typeOf.object("array",e);t=s(t,0);var a=e[t++];var o=new Array(a);for(var c=0;c<a;++c,t+=r.packedLength){o[c]=r.unpack(e,t)}var d=u.unpack(e,t,T);t+=u.packedLength;var f=e[t++];var h=e[t++];var p=e[t++];var m=e[t++];var v=e[t];if(!l(n)){E.positions=o;E.width=f;E.height=h;E.extrudedHeight=p;E.cornerType=m;E.granularity=v;return new S(E)}n._positions=o;n._ellipsoid=u.clone(d,n._ellipsoid);n._width=f;n._height=h;n._extrudedHeight=p;n._cornerType=m;n._granularity=v;return n};S.createGeometry=function(i){var n=i._positions;var a=i._height;var s=i._width;var l=i._extrudedHeight;var u=a!==l;var d=i._ellipsoid;n=b(n,d);var f=e(n,r.equalsEpsilon);if(f.length<2||s<=0){return}var h={ellipsoid:d,positions:f,width:s,cornerType:i._cornerType,granularity:i._granularity,saveAttributes:false};var p;if(u){var g=Math.max(a,l);l=Math.min(a,l);a=g;h.height=a;h.extrudedHeight=l;p=C(h)}else{var _=o.computePositions(h);p=w(_,h.cornerType);p.attributes.position.values=m.scaleToGeodeticHeight(p.attributes.position.values,a,d)}var y=p.attributes;var S=t.fromVertices(y.position.values,undefined,3);return new c({attributes:y,indices:p.indices,primitiveType:v.LINES,boundingSphere:S})};return S});define("Core/createGuid",[],function(){"use strict";function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0;var r=e==="x"?t:t&3|8;return r.toString(16)})}return e});define("Core/CullingVolume",["./Cartesian3","./Cartesian4","./defaultValue","./defined","./DeveloperError","./Intersect","./Plane"],function(e,t,r,i,n,a,o){"use strict";function s(e){this.planes=r(e,[])}var l=[new e,new e,new e];e.clone(e.UNIT_X,l[0]);e.clone(e.UNIT_Y,l[1]);e.clone(e.UNIT_Z,l[2]);var u=new e;var c=new e;var d=new o(new e(1,0,0),0);s.fromBoundingSphere=function(r,a){if(!i(r)){throw new n("boundingSphere is required.")}if(!i(a)){a=new s}var o=l.length;var d=a.planes;d.length=2*o;var f=r.center;var h=r.radius;var p=0;for(var m=0;m<o;++m){var v=l[m];var g=d[p];var _=d[p+1];if(!i(g)){g=d[p]=new t}if(!i(_)){_=d[p+1]=new t}e.multiplyByScalar(v,-h,u);e.add(f,u,u);g.x=v.x;g.y=v.y;g.z=v.z;g.w=-e.dot(v,u);e.multiplyByScalar(v,h,u);e.add(f,u,u);_.x=-v.x;_.y=-v.y;_.z=-v.z;_.w=-e.dot(e.negate(v,c),u);p+=2}return a};s.prototype.computeVisibility=function(e){if(!i(e)){throw new n("boundingVolume is required.")}var t=this.planes;var r=false;for(var s=0,l=t.length;s<l;++s){var u=e.intersectPlane(o.fromCartesian4(t[s],d));if(u===a.OUTSIDE){return a.OUTSIDE}else if(u===a.INTERSECTING){r=true}}return r?a.INTERSECTING:a.INSIDE};s.prototype.computeVisibilityWithPlaneMask=function(e,t){if(!i(e)){throw new n("boundingVolume is required.")}if(!i(t)){throw new n("parentPlaneMask is required.")}if(t===s.MASK_OUTSIDE||t===s.MASK_INSIDE){return t}var r=s.MASK_INSIDE;var l=this.planes;for(var u=0,c=l.length;u<c;++u){var f=u<31?1<<u:0;if(u<31&&(t&f)===0){continue}var h=e.intersectPlane(o.fromCartesian4(l[u],d));if(h===a.OUTSIDE){return s.MASK_OUTSIDE}else if(h===a.INTERSECTING){r|=f}}return r};s.MASK_OUTSIDE=4294967295;s.MASK_INSIDE=0;s.MASK_INDETERMINATE=2147483647;return s});define("Core/CylinderGeometryLibrary",["./Math"],function(e){"use strict";var t={};t.computePositions=function(t,r,i,n,a){var o=t*.5;var s=-o;var l=n+n;var u=a?2*l:l;var c=new Float64Array(u*3);var d;var f=0;var h=0;var p=a?l*3:0;var m=a?(l+n)*3:n*3;for(d=0;d<n;d++){var v=d/n*e.TWO_PI;var g=Math.cos(v);var _=Math.sin(v);var y=g*i;var b=_*i;var w=g*r;var C=_*r;c[h+p]=y;c[h+p+1]=b;c[h+p+2]=s;c[h+m]=w;c[h+m+1]=C;c[h+m+2]=o;h+=3;if(a){c[f++]=y;c[f++]=b;c[f++]=s;c[f++]=w;c[f++]=C;c[f++]=o}}return c};return t});define("Core/CylinderGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CylinderGeometryLibrary","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";var m=new t;var v=new r;var g=new r;var _=new r;var y=new r;function b(e){e=a(e,a.EMPTY_OBJECT);var t=e.length;var r=e.topRadius;var i=e.bottomRadius;var n=a(e.vertexFormat,p.DEFAULT);var l=a(e.slices,128);if(!o(t)){throw new s("options.length must be defined.")}if(!o(r)){throw new s("options.topRadius must be defined.")}if(!o(i)){throw new s("options.bottomRadius must be defined.")}if(l<3){throw new s("options.slices must be greater than or equal to 3.")}this._length=t;this._topRadius=r;this._bottomRadius=i;this._vertexFormat=p.clone(n);this._slices=l;this._workerName="createCylinderGeometry"}b.packedLength=p.packedLength+4;b.pack=function(e,t,r){if(!o(e)){throw new s("value is required")}if(!o(t)){throw new s("array is required")}r=a(r,0);p.pack(e._vertexFormat,t,r);r+=p.packedLength;t[r++]=e._length;t[r++]=e._topRadius;t[r++]=e._bottomRadius;t[r]=e._slices;return t};var w=new p;var C={vertexFormat:w,length:undefined,topRadius:undefined,bottomRadius:undefined,slices:undefined};b.unpack=function(e,t,r){if(!o(e)){throw new s("array is required")}t=a(t,0);var i=p.unpack(e,t,w);t+=p.packedLength;var n=e[t++];var l=e[t++];var u=e[t++];var c=e[t];if(!o(r)){C.length=n;C.topRadius=l;C.bottomRadius=u;C.slices=c;return new b(C)}r._vertexFormat=p.clone(i,r._vertexFormat);r._length=n;r._topRadius=l;r._bottomRadius=u;r._slices=c;return r};b.createGeometry=function(a){var o=a._length;var s=a._topRadius;var p=a._bottomRadius;var b=a._vertexFormat;var w=a._slices;if(o<=0||s<0||p<0||s===0&&p===0){return}var C=w+w;var S=w+C;var T=C+C;var E=n.computePositions(o,s,p,w,true);var x=b.st?new Float32Array(T*2):undefined;var P=b.normal?new Float32Array(T*3):undefined;var A=b.tangent?new Float32Array(T*3):undefined;var O=b.bitangent?new Float32Array(T*3):undefined;var D;var I=b.normal||b.tangent||b.bitangent;if(I){var M=b.tangent||b.bitangent;var R=0;var L=0;var N=0;var k=v;k.z=0;var F=_;var B=g;for(D=0;D<w;D++){var U=D/w*f.TWO_PI;var V=Math.cos(U);var z=Math.sin(U);if(I){k.x=V;k.y=z;if(M){F=r.normalize(r.cross(r.UNIT_Z,k,F),F)}if(b.normal){P[R++]=V;P[R++]=z;P[R++]=0;P[R++]=V;P[R++]=z;P[R++]=0}if(b.tangent){A[L++]=F.x;A[L++]=F.y;A[L++]=F.z;A[L++]=F.x;A[L++]=F.y;A[L++]=F.z}if(b.bitangent){B=r.normalize(r.cross(k,F,B),B);O[N++]=B.x;O[N++]=B.y;O[N++]=B.z;O[N++]=B.x;O[N++]=B.y;O[N++]=B.z}}}for(D=0;D<w;D++){if(b.normal){P[R++]=0;P[R++]=0;P[R++]=-1}if(b.tangent){A[L++]=1;A[L++]=0;A[L++]=0}if(b.bitangent){O[N++]=0;O[N++]=-1;O[N++]=0}}for(D=0;D<w;D++){if(b.normal){P[R++]=0;P[R++]=0;P[R++]=1}if(b.tangent){A[L++]=1;A[L++]=0;A[L++]=0}if(b.bitangent){O[N++]=0;O[N++]=1;O[N++]=0}}}var q=12*w-12;var G=d.createTypedArray(T,q);var H=0;var j=0;for(D=0;D<w-1;D++){G[H++]=j;G[H++]=j+2;G[H++]=j+3;G[H++]=j;G[H++]=j+3;G[H++]=j+1;j+=2}G[H++]=C-2;G[H++]=0;G[H++]=1;G[H++]=C-2;G[H++]=1;G[H++]=C-1;for(D=1;D<w-1;D++){G[H++]=C+D+1;G[H++]=C+D;G[H++]=C}for(D=1;D<w-1;D++){G[H++]=S;G[H++]=S+D;G[H++]=S+D+1}var W=0;if(b.st){var Y=Math.max(s,p);for(D=0;D<T;D++){var X=r.fromArray(E,D*3,y);x[W++]=(X.x+Y)/(2*Y);x[W++]=(X.y+Y)/(2*Y)}}var Q=new c;if(b.position){Q.position=new u({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:E})}if(b.normal){Q.normal=new u({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:P})}if(b.tangent){Q.tangent=new u({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:A})}if(b.bitangent){Q.bitangent=new u({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:O})}if(b.st){Q.st=new u({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:x})}m.x=o*.5;m.y=Math.max(p,s);var Z=new e(r.ZERO,t.magnitude(m));return new l({attributes:Q,indices:G,primitiveType:h.TRIANGLES,boundingSphere:Z})};return b});define("Core/CylinderOutlineGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Check","./ComponentDatatype","./CylinderGeometryLibrary","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./PrimitiveType"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";var h=new t;function p(e){e=o(e,o.EMPTY_OBJECT);var t=e.length;var r=e.topRadius;var n=e.bottomRadius;var a=o(e.slices,128);var s=Math.max(o(e.numberOfVerticalLines,16),0);i.typeOf.number("options.positions",t);i.typeOf.number("options.topRadius",r);i.typeOf.number("options.bottomRadius",n);i.typeOf.number.greaterThanOrEquals("options.slices",a,3);this._length=t;this._topRadius=r;this._bottomRadius=n;this._slices=a;this._numberOfVerticalLines=s;this._workerName="createCylinderOutlineGeometry"}p.packedLength=5;p.pack=function(e,t,r){i.typeOf.object("value",e);i.defined("array",t);r=o(r,0);t[r++]=e._length;t[r++]=e._topRadius;t[r++]=e._bottomRadius;t[r++]=e._slices;t[r]=e._numberOfVerticalLines;return t};var m={length:undefined,topRadius:undefined,bottomRadius:undefined,slices:undefined,numberOfVerticalLines:undefined};p.unpack=function(e,t,r){i.defined("array",e);t=o(t,0);var n=e[t++];var a=e[t++];var l=e[t++];var u=e[t++];var c=e[t];if(!s(r)){m.length=n;m.topRadius=a;m.bottomRadius=l;m.slices=u;m.numberOfVerticalLines=c;return new p(m)}r._length=n;r._topRadius=a;r._bottomRadius=l;r._slices=u;r._numberOfVerticalLines=c;return r};p.createGeometry=function(i){var o=i._length;var s=i._topRadius;var p=i._bottomRadius;var m=i._slices;var v=i._numberOfVerticalLines;if(o<=0||s<0||p<0||s===0&&p===0){return}var g=m*2;var _=a.computePositions(o,s,p,m,false);var y=m*2;var b;if(v>0){var w=Math.min(v,m);b=Math.round(m/w);y+=w}var C=d.createTypedArray(g,y*2);var S=0;var T;for(T=0;T<m-1;T++){C[S++]=T;C[S++]=T+1;C[S++]=T+m;C[S++]=T+1+m}C[S++]=m-1;C[S++]=0;C[S++]=m+m-1;C[S++]=m;if(v>0){for(T=0;T<m;T+=b){C[S++]=T;C[S++]=T+m}}var E=new c;E.position=new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:_});h.x=o*.5;h.y=Math.max(p,s);var x=new e(r.ZERO,t.magnitude(h));return new l({attributes:E,indices:C,primitiveType:f.LINES,boundingSphere:x})};return p});define("Core/decodeGoogleEarthEnterpriseData",["./Check","./defined","./RuntimeError"],function(e,t,r){"use strict";var i=1953029805;var n=2917034100;function a(t,o){if(a.passThroughDataForTesting){return o}e.typeOf.object("key",t);e.typeOf.object("data",o);var s=t.byteLength;if(s===0||s%4!==0){throw new r("The length of key must be greater than 0 and a multiple of 4.")}var l=new DataView(o);var u=l.getUint32(0,true);if(u===i||u===n){return o}var c=new DataView(t);var d=0;var f=o.byteLength;var h=f-f%8;var p=s;var m;var v=8;while(d<h){v=(v+8)%24;m=v;while(d<h&&m<p){l.setUint32(d,l.getUint32(d,true)^c.getUint32(m,true),true);l.setUint32(d+4,l.getUint32(d+4,true)^c.getUint32(m+4,true),true);d+=8;m+=24}}if(d<f){if(m>=p){v=(v+8)%24;m=v}while(d<f){l.setUint8(d,l.getUint8(d)^c.getUint8(m));d++;m++}}}a.passThroughDataForTesting=false;return a});define("Core/DefaultProxy",[],function(){"use strict";function e(e){this.proxy=e}e.prototype.getURL=function(e){var t=this.proxy.indexOf("?")===-1?"?":"";return this.proxy+t+encodeURIComponent(e)};return e});define("Core/DistanceDisplayCondition",["./defaultValue","./defined","./defineProperties"],function(e,t,r){"use strict";function i(t,r){t=e(t,0);this._near=t;r=e(r,Number.MAX_VALUE);this._far=r}r(i.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}});i.equals=function(e,r){return e===r||t(e)&&t(r)&&e.near===r.near&&e.far===r.far};i.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){r=new i}r.near=e.near;r.far=e.far;return r};i.prototype.clone=function(e){return i.clone(this,e)};i.prototype.equals=function(e){return i.equals(this,e)};return i});define("Core/DistanceDisplayConditionGeometryInstanceAttribute",["./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,r,i,n){"use strict";function a(e,r){e=t(e,0);r=t(r,Number.MAX_VALUE);if(r<=e){throw new n("far distance must be greater than near distance.")}this.value=new Float32Array([e,r])}i(a.prototype,{componentDatatype:{get:function(){return e.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return false}}});a.fromDistanceDisplayCondition=function(e){if(!r(e)){throw new n("distanceDisplayCondition is required.")}if(e.far<=e.near){throw new n("distanceDisplayCondition.far distance must be greater than distanceDisplayCondition.near distance.")}return new a(e.near,e.far)};a.toValue=function(e,t){if(!r(e)){throw new n("distanceDisplayCondition is required.")}if(!r(t)){return new Float32Array([e.near,e.far])}t[0]=e.near;t[1]=e.far;return t};return a});define("Core/DoublyLinkedList",["../Core/defined","../Core/defineProperties"],function(e,t){"use strict";function r(){this.head=undefined;this.tail=undefined;this._length=0}t(r.prototype,{length:{get:function(){return this._length}}});function i(e,t,r){this.item=e;this.previous=t;this.next=r}r.prototype.add=function(t){var r=new i(t,this.tail,undefined);if(e(this.tail)){this.tail.next=r;this.tail=r}else{this.head=r;this.tail=r}++this._length;return r};function n(t,r){if(e(r.previous)&&e(r.next)){r.previous.next=r.next;r.next.previous=r.previous}else if(e(r.previous)){r.previous.next=undefined;t.tail=r.previous}else if(e(r.next)){r.next.previous=undefined;t.head=r.next}else{t.head=undefined;t.tail=undefined}r.next=undefined;r.previous=undefined}r.prototype.remove=function(t){if(!e(t)){return}n(this,t);--this._length};r.prototype.splice=function(e,t){if(e===t){return}n(this,t);var r=e.next;e.next=t;if(this.tail===e){this.tail=t}else{r.previous=t}t.next=r;t.previous=e};return r});define("ThirdParty/Tween",[],function(){if(Date.now===undefined){Date.now=function(){return(new Date).valueOf()}}var e=e||function(){var e=[];return{REVISION:"13",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var r=e.indexOf(t);if(r!==-1){e.splice(r,1)}},update:function(t){if(e.length===0)return false;var r=0;t=t!==undefined?t:typeof window!=="undefined"&&window.performance!==undefined&&window.performance.now!==undefined?window.performance.now():Date.now();while(r<e.length){if(e[r].update(t)){r++}else{e.splice(r,1)}}return true}}}();e.Tween=function(t){var r=t;var i={};var n={};var a={};var o=1e3;var s=0;var l=false;var u=false;var c=false;var d=0;var f=null;var h=e.Easing.Linear.None;var p=e.Interpolation.Linear;var m=[];var v=null;var g=false;var _=null;var y=null;var b=null;for(var w in t){i[w]=parseFloat(t[w],10)}this.to=function(e,t){if(t!==undefined){o=t}n=e;return this};this.start=function(t){e.add(this);u=true;g=false;f=t!==undefined?t:typeof window!=="undefined"&&window.performance!==undefined&&window.performance.now!==undefined?window.performance.now():Date.now();f+=d;for(var o in n){if(n[o]instanceof Array){if(n[o].length===0){continue}n[o]=[r[o]].concat(n[o])}i[o]=r[o];if(i[o]instanceof Array===false){i[o]*=1}a[o]=i[o]||0}return this};this.stop=function(){if(!u){return this}e.remove(this);u=false;if(b!==null){b.call(r)}this.stopChainedTweens();return this};this.stopChainedTweens=function(){for(var e=0,t=m.length;e<t;e++){m[e].stop()}};this.delay=function(e){d=e;return this};this.repeat=function(e){s=e;return this};this.yoyo=function(e){l=e;return this};this.easing=function(e){h=e;return this};this.interpolation=function(e){p=e;return this};this.chain=function(){m=arguments;return this};this.onStart=function(e){v=e;return this};this.onUpdate=function(e){_=e;return this};this.onComplete=function(e){y=e;return this};this.onStop=function(e){b=e;return this};this.update=function(e){var t;if(e<f){return true}if(g===false){if(v!==null){v.call(r)}g=true}var u=(e-f)/o;u=u>1?1:u;var b=h(u);for(t in n){var w=i[t]||0;var C=n[t];if(C instanceof Array){r[t]=p(C,b)}else{if(typeof C==="string"){C=w+parseFloat(C,10)}if(typeof C==="number"){r[t]=w+(C-w)*b}}}if(_!==null){_.call(r,b)}if(u==1){if(s>0){if(isFinite(s)){s--}for(t in a){if(typeof n[t]==="string"){a[t]=a[t]+parseFloat(n[t],10)}if(l){var S=a[t];a[t]=n[t];n[t]=S}i[t]=a[t]}if(l){c=!c}f=e+d;return true}else{if(y!==null){y.call(r)}for(var T=0,E=m.length;T<E;T++){m[T].start(e)}return false}}return true}};e.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){if((e*=2)<1)return.5*e*e;return-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){if((e*=2)<1)return.5*e*e*e;return.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){if((e*=2)<1)return.5*e*e*e*e;return-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){if((e*=2)<1)return.5*e*e*e*e*e;return.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){if(e===0)return 0;if(e===1)return 1;if((e*=2)<1)return.5*Math.pow(1024,e-1);return.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){if((e*=2)<1)return-.5*(Math.sqrt(1-e*e)-1);return.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,r=.1,i=.4;if(e===0)return 0;if(e===1)return 1;if(!r||r<1){r=1;t=i/4}else t=i*Math.asin(1/r)/(2*Math.PI);return-(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i))},Out:function(e){var t,r=.1,i=.4;if(e===0)return 0;if(e===1)return 1;if(!r||r<1){r=1;t=i/4}else t=i*Math.asin(1/r)/(2*Math.PI);return r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/i)+1},InOut:function(e){var t,r=.1,i=.4;if(e===0)return 0;if(e===1)return 1;if(!r||r<1){r=1;t=i/4}else t=i*Math.asin(1/r)/(2*Math.PI);if((e*=2)<1)return-.5*(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i));return r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/i)*.5+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=1.70158*1.525;if((e*=2)<1)return.5*(e*e*((t+1)*e-t));return.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(t){return 1-e.Easing.Bounce.Out(1-t)},Out:function(e){if(e<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}},InOut:function(t){if(t<.5)return e.Easing.Bounce.In(t*2)*.5;return e.Easing.Bounce.Out(t*2-1)*.5+.5}}};e.Interpolation={Linear:function(t,r){var i=t.length-1,n=i*r,a=Math.floor(n),o=e.Interpolation.Utils.Linear;if(r<0)return o(t[0],t[1],n);if(r>1)return o(t[i],t[i-1],i-n);return o(t[a],t[a+1>i?i:a+1],n-a)},Bezier:function(t,r){var i=0,n=t.length-1,a=Math.pow,o=e.Interpolation.Utils.Bernstein,s;for(s=0;s<=n;s++){i+=a(1-r,n-s)*a(r,s)*t[s]*o(n,s)}return i},CatmullRom:function(t,r){var i=t.length-1,n=i*r,a=Math.floor(n),o=e.Interpolation.Utils.CatmullRom;if(t[0]===t[i]){if(r<0)a=Math.floor(n=i*(1+r));return o(t[(a-1+i)%i],t[a],t[(a+1)%i],t[(a+2)%i],n-a)}else{if(r<0)return t[0]-(o(t[0],t[0],t[1],t[1],-n)-t[0]);if(r>1)return t[i]-(o(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]);return o(t[a?a-1:0],t[a],t[i<a+1?i:a+1],t[i<a+2?i:a+2],n-a)}},Utils:{Linear:function(e,t,r){return(t-e)*r+e},Bernstein:function(t,r){var i=e.Interpolation.Utils.Factorial;return i(t)/i(r)/i(t-r)},Factorial:function(){var e=[1];return function(t){var r=1,i;if(e[t])return e[t];for(i=t;i>1;i--)r*=i;return e[t]=r}}(),CatmullRom:function(e,t,r,i,n){var a=(r-e)*.5,o=(i-t)*.5,s=n*n,l=n*s;return(2*t-2*r+a+o)*l+(-3*t+3*r-2*a-o)*s+a*n+t}}};return e});define("Core/EasingFunction",["../ThirdParty/Tween","./freezeObject"],function(e,t){"use strict";var r={LINEAR_NONE:e.Easing.Linear.None,QUADRACTIC_IN:e.Easing.Quadratic.In,QUADRACTIC_OUT:e.Easing.Quadratic.Out,QUADRACTIC_IN_OUT:e.Easing.Quadratic.InOut,CUBIC_IN:e.Easing.Cubic.In,CUBIC_OUT:e.Easing.Cubic.Out,CUBIC_IN_OUT:e.Easing.Cubic.InOut,QUARTIC_IN:e.Easing.Quartic.In,QUARTIC_OUT:e.Easing.Quartic.Out,QUARTIC_IN_OUT:e.Easing.Quartic.InOut,QUINTIC_IN:e.Easing.Quintic.In,QUINTIC_OUT:e.Easing.Quintic.Out,QUINTIC_IN_OUT:e.Easing.Quintic.InOut,SINUSOIDAL_IN:e.Easing.Sinusoidal.In,SINUSOIDAL_OUT:e.Easing.Sinusoidal.Out,SINUSOIDAL_IN_OUT:e.Easing.Sinusoidal.InOut,EXPONENTIAL_IN:e.Easing.Exponential.In,EXPONENTIAL_OUT:e.Easing.Exponential.Out,EXPONENTIAL_IN_OUT:e.Easing.Exponential.InOut,CIRCULAR_IN:e.Easing.Circular.In,CIRCULAR_OUT:e.Easing.Circular.Out,CIRCULAR_IN_OUT:e.Easing.Circular.InOut,ELASTIC_IN:e.Easing.Elastic.In,ELASTIC_OUT:e.Easing.Elastic.Out,ELASTIC_IN_OUT:e.Easing.Elastic.InOut,BACK_IN:e.Easing.Back.In,BACK_OUT:e.Easing.Back.Out,BACK_IN_OUT:e.Easing.Back.InOut,BOUNCE_IN:e.Easing.Bounce.In,BOUNCE_OUT:e.Easing.Bounce.Out,BOUNCE_IN_OUT:e.Easing.Bounce.InOut};return t(r)});define("Core/EllipsoidGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";var m=new r;var v=new r;var g=new r;var _=new r;var y=new r;var b=new r(1,1,1);var w=Math.cos;var C=Math.sin;function S(e){e=n(e,n.EMPTY_OBJECT);var t=n(e.radii,b);var i=Math.round(n(e.stackPartitions,64));var a=Math.round(n(e.slicePartitions,64));var s=n(e.vertexFormat,p.DEFAULT);if(a<3){throw new o("options.slicePartitions cannot be less than three.")}if(i<3){throw new o("options.stackPartitions cannot be less than three.")}this._radii=r.clone(t);this._stackPartitions=i;this._slicePartitions=a;this._vertexFormat=p.clone(s);this._workerName="createEllipsoidGeometry"}S.packedLength=r.packedLength+p.packedLength+2;S.pack=function(e,t,i){if(!a(e)){throw new o("value is required")}if(!a(t)){throw new o("array is required")}i=n(i,0);r.pack(e._radii,t,i);i+=r.packedLength;p.pack(e._vertexFormat,t,i);i+=p.packedLength;t[i++]=e._stackPartitions;t[i]=e._slicePartitions;return t};var T=new r;var E=new p;var x={radii:T,vertexFormat:E,stackPartitions:undefined,slicePartitions:undefined};S.unpack=function(e,t,i){if(!a(e)){throw new o("array is required")}t=n(t,0);var s=r.unpack(e,t,T);t+=r.packedLength;var l=p.unpack(e,t,E);t+=p.packedLength;var u=e[t++];var c=e[t];if(!a(i)){x.stackPartitions=u;x.slicePartitions=c;return new S(x)}i._radii=r.clone(s,i._radii);i._vertexFormat=p.clone(l,i._vertexFormat);i._stackPartitions=u;i._slicePartitions=c;return i};S.createGeometry=function(n){var a=n._radii;if(a.x<=0||a.y<=0||a.z<=0){return}var o=s.fromCartesian3(a);var p=n._vertexFormat;var b=n._slicePartitions+1;var S=n._stackPartitions+1;var T=S*b;var E=new Float64Array(T*3);var x=6*(b-1)*(S-2);var P=d.createTypedArray(T,x);var A=p.normal?new Float32Array(T*3):undefined;var O=p.tangent?new Float32Array(T*3):undefined;var D=p.bitangent?new Float32Array(T*3):undefined;var I=p.st?new Float32Array(T*2):undefined;var M=new Array(b);var R=new Array(b);var L;var N;var k=0;for(L=0;L<b;L++){var F=f.TWO_PI*L/(b-1);M[L]=w(F);R[L]=C(F);E[k++]=0;E[k++]=0;E[k++]=a.z}for(L=1;L<S-1;L++){var B=Math.PI*L/(S-1);var U=C(B);var V=a.x*U;var z=a.y*U;var q=a.z*w(B);for(N=0;N<b;N++){E[k++]=M[N]*V;E[k++]=R[N]*z;E[k++]=q}}for(L=0;L<b;L++){E[k++]=0;E[k++]=0;E[k++]=-a.z}var G=new c;if(p.position){G.position=new u({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:E})}var H=0;var j=0;var W=0;var Y=0;if(p.st||p.normal||p.tangent||p.bitangent){for(L=0;L<T;L++){var X=r.fromArray(E,L*3,m);var Q=o.geodeticSurfaceNormal(X,v);if(p.st){var Z=t.negate(Q,y);if(t.magnitude(Z)<f.EPSILON6){k=(L+b*Math.floor(S*.5))*3;if(k>E.length){k=(L-b*Math.floor(S*.5))*3}r.fromArray(E,k,Z);o.geodeticSurfaceNormal(Z,Z);t.negate(Z,Z)}I[H++]=Math.atan2(Z.y,Z.x)/f.TWO_PI+.5;I[H++]=Math.asin(Q.z)/Math.PI+.5}if(p.normal){A[j++]=Q.x;A[j++]=Q.y;A[j++]=Q.z}if(p.tangent||p.bitangent){var K=g;if(L<b||L>T-b-1){r.cross(r.UNIT_X,Q,K);r.normalize(K,K)}else{r.cross(r.UNIT_Z,Q,K);r.normalize(K,K)}if(p.tangent){O[W++]=K.x;O[W++]=K.y;O[W++]=K.z}if(p.bitangent){var J=r.cross(Q,K,_);r.normalize(J,J);D[Y++]=J.x;D[Y++]=J.y;D[Y++]=J.z}}}if(p.st){G.st=new u({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:I})}if(p.normal){G.normal=new u({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:A})}if(p.tangent){G.tangent=new u({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:O})}if(p.bitangent){G.bitangent=new u({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:D})}}k=0;for(N=0;N<b-1;N++){P[k++]=b+N;P[k++]=b+N+1;P[k++]=N+1}var $;var ee;for(L=1;L<S-2;L++){$=L*b;ee=(L+1)*b;for(N=0;N<b-1;N++){P[k++]=ee+N;P[k++]=ee+N+1;P[k++]=$+N+1;P[k++]=ee+N;P[k++]=$+N+1;P[k++]=$+N}}L=S-2;$=L*b;ee=(L+1)*b;for(N=0;N<b-1;N++){P[k++]=ee+N;P[k++]=$+N+1;P[k++]=$+N}return new l({attributes:G,indices:P,primitiveType:h.TRIANGLES,boundingSphere:e.fromEllipsoid(o)})};return S});define("Core/EllipsoidOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";var h=new t(1,1,1);var p=Math.cos;var m=Math.sin;function v(e){e=i(e,i.EMPTY_OBJECT);var r=i(e.radii,h);var n=Math.round(i(e.stackPartitions,10));var o=Math.round(i(e.slicePartitions,8));var s=Math.round(i(e.subdivisions,128));if(n<1){throw new a("options.stackPartitions cannot be less than 1")}if(o<0){throw new a("options.slicePartitions cannot be less than 0")}if(s<0){throw new a("options.subdivisions must be greater than or equal to zero.")}this._radii=t.clone(r);this._stackPartitions=n;this._slicePartitions=o;this._subdivisions=s;this._workerName="createEllipsoidOutlineGeometry"}v.packedLength=t.packedLength+3;v.pack=function(e,r,o){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}o=i(o,0);t.pack(e._radii,r,o);o+=t.packedLength;r[o++]=e._stackPartitions;r[o++]=e._slicePartitions;r[o]=e._subdivisions;return r};var g=new t;var _={radii:g,stackPartitions:undefined,slicePartitions:undefined,subdivisions:undefined};v.unpack=function(e,r,o){if(!n(e)){throw new a("array is required")}r=i(r,0);var s=t.unpack(e,r,g);r+=t.packedLength;var l=e[r++];var u=e[r++];var c=e[r++];if(!n(o)){_.stackPartitions=l;_.slicePartitions=u;_.subdivisions=c;return new v(_)}o._radii=t.clone(s,o._radii);o._stackPartitions=l;o._slicePartitions=u;o._subdivisions=c;return o};v.createGeometry=function(t){var i=t._radii;if(i.x<=0||i.y<=0||i.z<=0){return}var n=o.fromCartesian3(i);var a=t._stackPartitions;var h=t._slicePartitions;var v=t._subdivisions;var g=v*(a+h-1);var _=g-h+2;var y=new Float64Array(_*3);var b=c.createTypedArray(_,g*2);var w;var C;var S;var T;var E;var x;var P=0;var A=new Array(v);var O=new Array(v);for(w=0;w<v;w++){S=d.TWO_PI*w/v;A[w]=p(S);O[w]=m(S)}for(w=1;w<a;w++){T=Math.PI*w/a;E=p(T);x=m(T);for(C=0;C<v;C++){y[P++]=i.x*A[C]*x;y[P++]=i.y*O[C]*x;y[P++]=i.z*E}}A.length=h;O.length=h;for(w=0;w<h;w++){S=d.TWO_PI*w/h;A[w]=p(S);O[w]=m(S)}y[P++]=0;y[P++]=0;y[P++]=i.z;for(w=1;w<v;w++){T=Math.PI*w/v;E=p(T);x=m(T);for(C=0;C<h;C++){y[P++]=i.x*A[C]*x;y[P++]=i.y*O[C]*x;y[P++]=i.z*E}}y[P++]=0;y[P++]=0;y[P++]=-i.z;P=0;for(w=0;w<a-1;++w){var D=w*v;for(C=0;C<v-1;++C){b[P++]=D+C;b[P++]=D+C+1}b[P++]=D+v-1;b[P++]=D}var I=v*(a-1);for(C=1;C<h+1;++C){b[P++]=I;b[P++]=I+C}for(w=0;w<v-2;++w){var M=w*h+1+I;var R=(w+1)*h+1+I;for(C=0;C<h-1;++C){b[P++]=R+C;b[P++]=M+C}b[P++]=R+h-1;b[P++]=M+h-1}var L=y.length/3-1;for(C=L-1;C>L-h-1;--C){b[P++]=L;b[P++]=C}var N=new u({position:new l({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:y})});return new s({attributes:N,indices:b,primitiveType:f.LINES,boundingSphere:e.fromEllipsoid(n)})};return v});define("Core/EllipsoidTerrainProvider",["../ThirdParty/when","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Event","./GeographicTilingScheme","./HeightmapTerrainData","./TerrainProvider"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(i){i=t(i,{});this._tilingScheme=i.tilingScheme;if(!r(this._tilingScheme)){this._tilingScheme=new o({ellipsoid:t(i.ellipsoid,n.WGS84)})}this._levelZeroMaximumGeometricError=l.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,64,this._tilingScheme.getNumberOfXTilesAtLevel(0));this._errorEvent=new a;this._readyPromise=e.resolve(true)}i(u.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return undefined}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return true}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return false}},hasVertexNormals:{get:function(){return false}}});u.prototype.requestTileGeometry=function(e,t,r,i){var n=16;var a=16;return new s({buffer:new Uint8Array(n*a),width:n,height:a})};u.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};u.prototype.getTileDataAvailable=function(e,t,r){return undefined};return u});define("Core/EventHelper",["./defined","./DeveloperError"],function(e,t){"use strict";function r(){this._removalFunctions=[]}r.prototype.add=function(r,i,n){if(!e(r)){throw new t("event is required")}var a=r.addEventListener(i,n);this._removalFunctions.push(a);var o=this;return function(){a();var e=o._removalFunctions;e.splice(e.indexOf(a),1)}};r.prototype.removeAll=function(){var e=this._removalFunctions;for(var t=0,r=e.length;t<r;++t){e[t]()}e.length=0};return r});define("Core/ExtrapolationType",["./freezeObject"],function(e){"use strict";var t={NONE:0,HOLD:1,EXTRAPOLATE:2};return e(t)});define("Core/OrthographicOffCenterFrustum",["./Cartesian3","./Cartesian4","./CullingVolume","./defaultValue","./defined","./defineProperties","./DeveloperError","./Matrix4"],function(e,t,r,i,n,a,o,s){"use strict";function l(e){e=i(e,i.EMPTY_OBJECT);this.left=e.left;this._left=undefined;this.right=e.right;this._right=undefined;this.top=e.top;this._top=undefined;this.bottom=e.bottom;this._bottom=undefined;this.near=i(e.near,1);this._near=this.near;this.far=i(e.far,5e8);this._far=this.far;this._cullingVolume=new r;this._orthographicMatrix=new s}function u(e){if(!n(e.right)||!n(e.left)||!n(e.top)||!n(e.bottom)||!n(e.near)||!n(e.far)){throw new o("right, left, top, bottom, near, or far parameters are not set.")}if(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far){if(e.left>e.right){throw new o("right must be greater than left.")}if(e.bottom>e.top){throw new o("top must be greater than bottom.")}if(e.near<=0||e.near>e.far){throw new o("near must be greater than zero and less than far.")}e._left=e.left;e._right=e.right;e._top=e.top;e._bottom=e.bottom;e._near=e.near;e._far=e.far;e._orthographicMatrix=s.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix)}}a(l.prototype,{projectionMatrix:{get:function(){u(this);return this._orthographicMatrix}}});var c=new e;var d=new e;var f=new e;var h=new e;l.prototype.computeCullingVolume=function(r,i,a){if(!n(r)){throw new o("position is required.")}if(!n(i)){throw new o("direction is required.")}if(!n(a)){throw new o("up is required.")}var s=this._cullingVolume.planes;var l=this.top;var u=this.bottom;var p=this.right;var m=this.left;var v=this.near;var g=this.far;var _=e.cross(i,a,c);e.normalize(_,_);var y=d;e.multiplyByScalar(i,v,y);e.add(r,y,y);var b=f;e.multiplyByScalar(_,m,b);e.add(y,b,b);var w=s[0];if(!n(w)){w=s[0]=new t}w.x=_.x;w.y=_.y;w.z=_.z;w.w=-e.dot(_,b);e.multiplyByScalar(_,p,b);e.add(y,b,b);w=s[1];if(!n(w)){w=s[1]=new t}w.x=-_.x;w.y=-_.y;w.z=-_.z;w.w=-e.dot(e.negate(_,h),b);e.multiplyByScalar(a,u,b);e.add(y,b,b);w=s[2];if(!n(w)){w=s[2]=new t}w.x=a.x;w.y=a.y;w.z=a.z;w.w=-e.dot(a,b);e.multiplyByScalar(a,l,b);e.add(y,b,b);w=s[3];if(!n(w)){w=s[3]=new t}w.x=-a.x;w.y=-a.y;w.z=-a.z;w.w=-e.dot(e.negate(a,h),b);w=s[4];if(!n(w)){w=s[4]=new t}w.x=i.x;w.y=i.y;w.z=i.z;w.w=-e.dot(i,y);e.multiplyByScalar(i,g,b);e.add(r,b,b);w=s[5];if(!n(w)){w=s[5]=new t}w.x=-i.x;w.y=-i.y;w.z=-i.z;w.w=-e.dot(e.negate(i,h),b);return this._cullingVolume};l.prototype.getPixelDimensions=function(e,t,r,i){u(this);if(!n(e)||!n(t)){throw new o("Both drawingBufferWidth and drawingBufferHeight are required.")}if(e<=0){throw new o("drawingBufferWidth must be greater than zero.")}if(t<=0){throw new o("drawingBufferHeight must be greater than zero.")}if(!n(r)){throw new o("distance is required.")}if(!n(i)){throw new o("A result object is required.")}var a=this.right-this.left;var s=this.top-this.bottom;var l=a/e;var c=s/t;i.x=l;i.y=c;return i};l.prototype.clone=function(e){if(!n(e)){e=new l}e.left=this.left;e.right=this.right;e.top=this.top;e.bottom=this.bottom;e.near=this.near;e.far=this.far;e._left=undefined;e._right=undefined;e._top=undefined;e._bottom=undefined;e._near=undefined;e._far=undefined;return e};l.prototype.equals=function(e){return n(e)&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};return l});define("Core/OrthographicFrustum",["./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./OrthographicOffCenterFrustum"],function(e,t,r,i,n,a){"use strict";function o(e){e=t(e,t.EMPTY_OBJECT);this._offCenterFrustum=new a;this.width=e.width;this._width=undefined;this.aspectRatio=e.aspectRatio;this._aspectRatio=undefined;this.near=t(e.near,1);this._near=this.near;this.far=t(e.far,5e8);this._far=this.far}o.packedLength=4;o.pack=function(r,i,n){e.typeOf.object("value",r);e.defined("array",i);n=t(n,0);i[n++]=r.width;i[n++]=r.aspectRatio;i[n++]=r.near;i[n]=r.far;return i};o.unpack=function(i,n,a){e.defined("array",i);n=t(n,0);if(!r(a)){a=new o}a.width=i[n++];a.aspectRatio=i[n++];a.near=i[n++];a.far=i[n];return a};function s(e){if(!r(e.width)||!r(e.aspectRatio)||!r(e.near)||!r(e.far)){throw new n("width, aspectRatio, near, or far parameters are not set.")}var t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){if(e.aspectRatio<0){throw new n("aspectRatio must be positive.")}if(e.near<0||e.near>e.far){throw new n("near must be greater than zero and less than far.")}e._aspectRatio=e.aspectRatio;e._width=e.width;e._near=e.near;e._far=e.far;var i=1/e.aspectRatio;t.right=e.width*.5;t.left=-t.right;t.top=i*t.right;t.bottom=-t.top;t.near=e.near;t.far=e.far}}i(o.prototype,{projectionMatrix:{get:function(){s(this);return this._offCenterFrustum.projectionMatrix}}});o.prototype.computeCullingVolume=function(e,t,r){s(this);return this._offCenterFrustum.computeCullingVolume(e,t,r)};o.prototype.getPixelDimensions=function(e,t,r,i){s(this);return this._offCenterFrustum.getPixelDimensions(e,t,r,i)};o.prototype.clone=function(e){if(!r(e)){e=new o}e.aspectRatio=this.aspectRatio;e.width=this.width;e.near=this.near;e.far=this.far;e._aspectRatio=undefined;e._width=undefined;e._near=undefined;e._far=undefined;this._offCenterFrustum.clone(e._offCenterFrustum);return e};o.prototype.equals=function(e){if(!r(e)){return false}s(this);s(e);return this.width===e.width&&this.aspectRatio===e.aspectRatio&&this.near===e.near&&this.far===e.far&&this._offCenterFrustum.equals(e._offCenterFrustum)};return o});define("Core/PerspectiveOffCenterFrustum",["./Cartesian3","./Cartesian4","./CullingVolume","./defaultValue","./defined","./defineProperties","./DeveloperError","./Matrix4"],function(e,t,r,i,n,a,o,s){"use strict";function l(e){e=i(e,i.EMPTY_OBJECT);this.left=e.left;this._left=undefined;this.right=e.right;this._right=undefined;this.top=e.top;this._top=undefined;this.bottom=e.bottom;this._bottom=undefined;this.near=i(e.near,1);this._near=this.near;this.far=i(e.far,5e8);this._far=this.far;this._cullingVolume=new r;this._perspectiveMatrix=new s;this._infinitePerspective=new s}function u(e){if(!n(e.right)||!n(e.left)||!n(e.top)||!n(e.bottom)||!n(e.near)||!n(e.far)){throw new o("right, left, top, bottom, near, or far parameters are not set.")}var t=e.top;var r=e.bottom;var i=e.right;var a=e.left;var l=e.near;var u=e.far;if(t!==e._top||r!==e._bottom||a!==e._left||i!==e._right||l!==e._near||u!==e._far){if(e.near<=0||e.near>e.far){throw new o("near must be greater than zero and less than far.")}e._left=a;e._right=i;e._top=t;e._bottom=r;e._near=l;e._far=u;e._perspectiveMatrix=s.computePerspectiveOffCenter(a,i,r,t,l,u,e._perspectiveMatrix);e._infinitePerspective=s.computeInfinitePerspectiveOffCenter(a,i,r,t,l,e._infinitePerspective)}}a(l.prototype,{projectionMatrix:{get:function(){u(this);return this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){u(this);return this._infinitePerspective}}});var c=new e;var d=new e;var f=new e;var h=new e;l.prototype.computeCullingVolume=function(r,i,a){if(!n(r)){throw new o("position is required.")}if(!n(i)){throw new o("direction is required.")}if(!n(a)){throw new o("up is required.")}var s=this._cullingVolume.planes;var l=this.top;var u=this.bottom;var p=this.right;var m=this.left;var v=this.near;var g=this.far;var _=e.cross(i,a,c);var y=d;e.multiplyByScalar(i,v,y);e.add(r,y,y);var b=f;e.multiplyByScalar(i,g,b);e.add(r,b,b);var w=h;e.multiplyByScalar(_,m,w);e.add(y,w,w);e.subtract(w,r,w);e.normalize(w,w);e.cross(w,a,w);e.normalize(w,w);var C=s[0];if(!n(C)){C=s[0]=new t}C.x=w.x;C.y=w.y;C.z=w.z;C.w=-e.dot(w,r);e.multiplyByScalar(_,p,w);e.add(y,w,w);e.subtract(w,r,w);e.cross(a,w,w);e.normalize(w,w);C=s[1];if(!n(C)){C=s[1]=new t}C.x=w.x;C.y=w.y;C.z=w.z;C.w=-e.dot(w,r);e.multiplyByScalar(a,u,w);e.add(y,w,w);e.subtract(w,r,w);e.cross(_,w,w);e.normalize(w,w);C=s[2];if(!n(C)){C=s[2]=new t}C.x=w.x;C.y=w.y;C.z=w.z;C.w=-e.dot(w,r);e.multiplyByScalar(a,l,w);e.add(y,w,w);e.subtract(w,r,w);e.cross(w,_,w);e.normalize(w,w);C=s[3];if(!n(C)){C=s[3]=new t}C.x=w.x;C.y=w.y;C.z=w.z;C.w=-e.dot(w,r);C=s[4];if(!n(C)){C=s[4]=new t}C.x=i.x;C.y=i.y;C.z=i.z;C.w=-e.dot(i,y);e.negate(i,w);C=s[5];if(!n(C)){C=s[5]=new t}C.x=w.x;C.y=w.y;C.z=w.z;C.w=-e.dot(w,b);return this._cullingVolume};l.prototype.getPixelDimensions=function(e,t,r,i){u(this);if(!n(e)||!n(t)){throw new o("Both drawingBufferWidth and drawingBufferHeight are required.")}if(e<=0){throw new o("drawingBufferWidth must be greater than zero.")}if(t<=0){throw new o("drawingBufferHeight must be greater than zero.")}if(!n(r)){throw new o("distance is required.")}if(!n(i)){throw new o("A result object is required.")}var a=1/this.near;var s=this.top*a;var l=2*r*s/t;s=this.right*a;var c=2*r*s/e;i.x=c;i.y=l;return i};l.prototype.clone=function(e){if(!n(e)){e=new l}e.right=this.right;e.left=this.left;e.top=this.top;e.bottom=this.bottom;e.near=this.near;e.far=this.far;e._left=undefined;e._right=undefined;e._top=undefined;e._bottom=undefined;e._near=undefined;e._far=undefined;return e};l.prototype.equals=function(e){return n(e)&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};return l});define("Core/PerspectiveFrustum",["./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./PerspectiveOffCenterFrustum"],function(e,t,r,i,n,a){"use strict";function o(e){e=t(e,t.EMPTY_OBJECT);this._offCenterFrustum=new a;this.fov=e.fov;this._fov=undefined;this._fovy=undefined;this._sseDenominator=undefined;this.aspectRatio=e.aspectRatio;this._aspectRatio=undefined;this.near=t(e.near,1);this._near=this.near;this.far=t(e.far,5e8);this._far=this.far;this.xOffset=t(e.xOffset,0);this._xOffset=this.xOffset;this.yOffset=t(e.yOffset,0);this._yOffset=this.yOffset}o.packedLength=6;o.pack=function(r,i,n){e.typeOf.object("value",r);e.defined("array",i);n=t(n,0);i[n++]=r.fov;i[n++]=r.aspectRatio;i[n++]=r.near;i[n++]=r.far;i[n++]=r.xOffset;i[n]=r.yOffset;return i};o.unpack=function(i,n,a){e.defined("array",i);n=t(n,0);if(!r(a)){a=new o}a.fov=i[n++];a.aspectRatio=i[n++];a.near=i[n++];a.far=i[n++];a.xOffset=i[n++];a.yOffset=i[n];return a};function s(e){if(!r(e.fov)||!r(e.aspectRatio)||!r(e.near)||!r(e.far)){throw new n("fov, aspectRatio, near, or far parameters are not set.")}var t=e._offCenterFrustum;if(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset){if(e.fov<0||e.fov>=Math.PI){throw new n("fov must be in the range [0, PI).")}if(e.aspectRatio<0){throw new n("aspectRatio must be positive.")}if(e.near<0||e.near>e.far){throw new n("near must be greater than zero and less than far.")}e._aspectRatio=e.aspectRatio;e._fov=e.fov;e._fovy=e.aspectRatio<=1?e.fov:Math.atan(Math.tan(e.fov*.5)/e.aspectRatio)*2;e._near=e.near;e._far=e.far;e._sseDenominator=2*Math.tan(.5*e._fovy);e._xOffset=e.xOffset;e._yOffset=e.yOffset;t.top=e.near*Math.tan(.5*e._fovy);t.bottom=-t.top;t.right=e.aspectRatio*t.top;t.left=-t.right;t.near=e.near;t.far=e.far;t.right+=e.xOffset;t.left+=e.xOffset;t.top+=e.yOffset;t.bottom+=e.yOffset}}i(o.prototype,{projectionMatrix:{get:function(){s(this);return this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){s(this);return this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){s(this);return this._fovy}},sseDenominator:{get:function(){s(this);return this._sseDenominator}}});o.prototype.computeCullingVolume=function(e,t,r){s(this);return this._offCenterFrustum.computeCullingVolume(e,t,r)};o.prototype.getPixelDimensions=function(e,t,r,i){s(this);return this._offCenterFrustum.getPixelDimensions(e,t,r,i)};o.prototype.clone=function(e){if(!r(e)){e=new o}e.aspectRatio=this.aspectRatio;e.fov=this.fov;e.near=this.near;e.far=this.far;e._aspectRatio=undefined;e._fov=undefined;e._near=undefined;e._far=undefined;this._offCenterFrustum.clone(e._offCenterFrustum);return e};o.prototype.equals=function(e){if(!r(e)){return false}s(this);s(e);return this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this.near===e.near&&this.far===e.far&&this._offCenterFrustum.equals(e._offCenterFrustum)};return o});define("Core/FrustumGeometry",["./BoundingSphere","./Cartesian3","./Cartesian4","./Check","./ComponentDatatype","./defaultValue","./defined","./Geometry","./GeometryAttribute","./GeometryAttributes","./Matrix3","./Matrix4","./OrthographicFrustum","./PerspectiveFrustum","./PrimitiveType","./Quaternion","./VertexFormat"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";var g=0;var _=1;function y(e){i.typeOf.object("options",e);i.typeOf.object("options.frustum",e.frustum);i.typeOf.object("options.origin",e.origin);i.typeOf.object("options.orientation",e.orientation);var r=e.frustum;var n=e.orientation;var o=e.origin;var s=a(e.vertexFormat,v.DEFAULT);var l=a(e._drawNearPlane,true);var u;var c;if(r instanceof h){u=g;c=h.packedLength}else if(r instanceof f){u=_;c=f.packedLength}this._frustumType=u;this._frustum=r.clone();this._origin=t.clone(o);this._orientation=m.clone(n);this._drawNearPlane=l;this._vertexFormat=s;this._workerName="createFrustumGeometry";this.packedLength=2+c+t.packedLength+m.packedLength+v.packedLength}y.pack=function(e,r,n){i.typeOf.object("value",e);i.defined("array",r);n=a(n,0);var o=e._frustumType;var s=e._frustum;r[n++]=o;if(o===g){h.pack(s,r,n);n+=h.packedLength}else{f.pack(s,r,n);n+=f.packedLength}t.pack(e._origin,r,n);n+=t.packedLength;m.pack(e._orientation,r,n);n+=m.packedLength;v.pack(e._vertexFormat,r,n);n+=v.packedLength;r[n]=e._drawNearPlane?1:0;return r};var b=new h;var w=new f;var C=new m;var S=new t;var T=new v;y.unpack=function(e,r,n){i.defined("array",e);r=a(r,0);var s=e[r++];var l;if(s===g){l=h.unpack(e,r,b);r+=h.packedLength}else{l=f.unpack(e,r,w);r+=f.packedLength}var u=t.unpack(e,r,S);r+=t.packedLength;var c=m.unpack(e,r,C);r+=m.packedLength;var d=v.unpack(e,r,T);r+=v.packedLength;var p=e[r]===1;if(!o(n)){return new y({frustum:l,origin:u,orientation:c,vertexFormat:d,_drawNearPlane:p})}var _=s===n._frustumType?n._frustum:undefined;n._frustum=l.clone(_);n._frustumType=s;n._origin=t.clone(u,n._origin);n._orientation=m.clone(c,n._orientation);n._vertexFormat=v.clone(d,n._vertexFormat);n._drawNearPlane=p;return n};function E(e,t,r,i,n,a,s,l){var u=e/3*2;for(var c=0;c<4;++c){if(o(t)){t[e]=a.x;t[e+1]=a.y;t[e+2]=a.z}if(o(r)){r[e]=s.x;r[e+1]=s.y;r[e+2]=s.z}if(o(i)){i[e]=l.x;i[e+1]=l.y;i[e+2]=l.z}e+=3}n[u]=0;n[u+1]=0;n[u+2]=1;n[u+3]=0;n[u+4]=1;n[u+5]=1;n[u+6]=0;n[u+7]=1}var x=new c;var P=new d;var A=new d;var O=new t;var D=new t;var I=new t;var M=new t;var R=new t;var L=new t;var N=new Array(3);var k=new Array(4);k[0]=new r(-1,-1,1,1);k[1]=new r(1,-1,1,1);k[2]=new r(1,1,1,1);k[3]=new r(-1,1,1,1);var F=new Array(4);for(var B=0;B<4;++B){F[B]=new r}y._computeNearFarPlanes=function(e,i,n,s,l,u,f,h){var p=c.fromQuaternion(i,x);var m=a(u,O);var v=a(f,D);var _=a(h,I);m=c.getColumn(p,0,m);v=c.getColumn(p,1,v);_=c.getColumn(p,2,_);t.normalize(m,m);t.normalize(v,v);t.normalize(_,_);t.negate(m,m);var y=d.computeView(e,_,v,m,P);var b;var w;if(n===g){var C=s.projectionMatrix;var S=d.multiply(C,y,A);w=d.inverse(S,A)}else{b=d.inverseTransformation(y,A)}if(o(w)){N[0]=s.near;N[1]=s.far}else{N[0]=0;N[1]=s.near;N[2]=s.far}for(var T=0;T<2;++T){for(var E=0;E<4;++E){var M=r.clone(k[E],F[E]);if(!o(w)){if(o(s._offCenterFrustum)){s=s._offCenterFrustum}var R=N[T];var L=N[T+1];M.x=(M.x*(s.right-s.left)+s.left+s.right)*.5;M.y=(M.y*(s.top-s.bottom)+s.bottom+s.top)*.5;M.z=(M.z*(R-L)-R-L)*.5;M.w=1;d.multiplyByVector(b,M,M)}else{M=d.multiplyByVector(w,M,M);var B=1/M.w;t.multiplyByScalar(M,B,M);t.subtract(M,e,M);t.normalize(M,M);var U=t.dot(_,M);t.multiplyByScalar(M,N[T]/U,M);t.add(M,e,M)}l[12*T+E*3]=M.x;l[12*T+E*3+1]=M.y;l[12*T+E*3+2]=M.z}}};y.createGeometry=function(r){var i=r._frustumType;var a=r._frustum;var c=r._origin;var d=r._orientation;var f=r._drawNearPlane;var h=r._vertexFormat;var m=f?6:5;var v=new Float64Array(3*4*6);y._computeNearFarPlanes(c,d,i,a,v);var g=3*4*2;v[g]=v[3*4];v[g+1]=v[3*4+1];v[g+2]=v[3*4+2];v[g+3]=v[0];v[g+4]=v[1];v[g+5]=v[2];v[g+6]=v[3*3];v[g+7]=v[3*3+1];v[g+8]=v[3*3+2];v[g+9]=v[3*7];v[g+10]=v[3*7+1];v[g+11]=v[3*7+2];g+=3*4;v[g]=v[3*5];v[g+1]=v[3*5+1];v[g+2]=v[3*5+2];v[g+3]=v[3];v[g+4]=v[3+1];v[g+5]=v[3+2];v[g+6]=v[0];v[g+7]=v[1];v[g+8]=v[2];v[g+9]=v[3*4];v[g+10]=v[3*4+1];v[g+11]=v[3*4+2];g+=3*4;v[g]=v[3];v[g+1]=v[3+1];v[g+2]=v[3+2];v[g+3]=v[3*5];v[g+4]=v[3*5+1];v[g+5]=v[3*5+2];v[g+6]=v[3*6];v[g+7]=v[3*6+1];v[g+8]=v[3*6+2];v[g+9]=v[3*2];v[g+10]=v[3*2+1];v[g+11]=v[3*2+2];g+=3*4;v[g]=v[3*2];v[g+1]=v[3*2+1];v[g+2]=v[3*2+2];v[g+3]=v[3*6];v[g+4]=v[3*6+1];v[g+5]=v[3*6+2];v[g+6]=v[3*7];v[g+7]=v[3*7+1];v[g+8]=v[3*7+2];v[g+9]=v[3*3];v[g+10]=v[3*3+1];v[g+11]=v[3*3+2];if(!f){v=v.subarray(3*4)}var _=new u({position:new l({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:v})});if(o(h.normal)||o(h.tangent)||o(h.bitangent)||o(h.st)){var b=o(h.normal)?new Float32Array(3*4*m):undefined;var w=o(h.tangent)?new Float32Array(3*4*m):undefined;var C=o(h.bitangent)?new Float32Array(3*4*m):undefined;var S=o(h.st)?new Float32Array(2*4*m):undefined;var T=O;var x=D;var P=I;var A=t.negate(T,M);var N=t.negate(x,R);var k=t.negate(P,L);g=0;if(f){E(g,b,w,C,S,k,T,x);g+=3*4}E(g,b,w,C,S,P,A,x);g+=3*4;E(g,b,w,C,S,A,k,x);g+=3*4;E(g,b,w,C,S,N,k,A);g+=3*4;E(g,b,w,C,S,T,P,x);g+=3*4;E(g,b,w,C,S,x,P,A);if(o(b)){_.normal=new l({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:b})}if(o(w)){_.tangent=new l({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:w})}if(o(C)){_.bitangent=new l({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:C})}if(o(S)){_.st=new l({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:S})}}var F=new Uint16Array(6*m);for(var B=0;B<m;++B){var U=B*6;var V=B*4;F[U]=V;F[U+1]=V+1;F[U+2]=V+2;F[U+3]=V;F[U+4]=V+2;F[U+5]=V+3}return new s({attributes:_,indices:F,primitiveType:p.TRIANGLES,boundingSphere:e.fromVertices(v)})};return y});define("Core/FrustumOutlineGeometry",["./BoundingSphere","./Cartesian3","./Cartesian4","./Check","./ComponentDatatype","./defaultValue","./defined","./FrustumGeometry","./Geometry","./GeometryAttribute","./GeometryAttributes","./Matrix3","./Matrix4","./OrthographicFrustum","./PerspectiveFrustum","./PrimitiveType","./Quaternion"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";var g=0;var _=1;function y(e){i.typeOf.object("options",e);i.typeOf.object("options.frustum",e.frustum);i.typeOf.object("options.origin",e.origin);i.typeOf.object("options.orientation",e.orientation);var r=e.frustum;var n=e.orientation;var o=e.origin;var s=a(e._drawNearPlane,true);var l;var u;if(r instanceof p){l=g;u=p.packedLength}else if(r instanceof h){l=_;u=h.packedLength}this._frustumType=l;this._frustum=r.clone();this._origin=t.clone(o);this._orientation=v.clone(n);this._drawNearPlane=s;this._workerName="createFrustumOutlineGeometry";this.packedLength=2+u+t.packedLength+v.packedLength}y.pack=function(e,r,n){i.typeOf.object("value",e);i.defined("array",r);n=a(n,0);var o=e._frustumType;var s=e._frustum;r[n++]=o;if(o===g){p.pack(s,r,n);n+=p.packedLength}else{h.pack(s,r,n);n+=h.packedLength}t.pack(e._origin,r,n);n+=t.packedLength;v.pack(e._orientation,r,n);n+=v.packedLength;r[n]=e._drawNearPlane?1:0;return r};var b=new p;var w=new h;var C=new v;var S=new t;y.unpack=function(e,r,n){i.defined("array",e);r=a(r,0);var s=e[r++];var l;if(s===g){l=p.unpack(e,r,b);r+=p.packedLength}else{l=h.unpack(e,r,w);r+=h.packedLength}var u=t.unpack(e,r,S);r+=t.packedLength;var c=v.unpack(e,r,C);r+=v.packedLength;var d=e[r]===1;if(!o(n)){return new y({frustum:l,origin:u,orientation:c,_drawNearPlane:d})}var f=s===n._frustumType?n._frustum:undefined;n._frustum=l.clone(f);n._frustumType=s;n._origin=t.clone(u,n._origin);n._orientation=v.clone(c,n._orientation);n._drawNearPlane=d;return n};y.createGeometry=function(t){var r=t._frustumType;var i=t._frustum;var a=t._origin;var o=t._orientation;var d=t._drawNearPlane;var f=new Float64Array(3*4*2);s._computeNearFarPlanes(a,o,r,i,f);var h=new c({position:new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:f})});var p;var v;var g=d?2:1;var _=new Uint16Array(8*(g+1));var y=d?0:1;for(;y<2;++y){p=d?y*8:0;v=y*4;_[p]=v;_[p+1]=v+1;_[p+2]=v+1;_[p+3]=v+2;_[p+4]=v+2;_[p+5]=v+3;_[p+6]=v+3;_[p+7]=v}for(y=0;y<2;++y){p=(g+y)*8;v=y*4;_[p]=v;_[p+1]=v+4;_[p+2]=v+1;_[p+3]=v+5;_[p+4]=v+2;_[p+5]=v+6;_[p+6]=v+3;_[p+7]=v+7}return new l({attributes:h,indices:_,primitiveType:m.LINES,boundingSphere:e.fromVertices(f)})};return y});define("Core/GeocoderService",["./DeveloperError"],function(e){"use strict";function t(){}t.prototype.geocode=e.throwInstantiationError;return t});define("Core/GeometryInstanceAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i){i=e(i,e.EMPTY_OBJECT);if(!t(i.componentDatatype)){throw new r("options.componentDatatype is required.")}if(!t(i.componentsPerAttribute)){throw new r("options.componentsPerAttribute is required.")}if(i.componentsPerAttribute<1||i.componentsPerAttribute>4){throw new r("options.componentsPerAttribute must be between 1 and 4.")}if(!t(i.value)){throw new r("options.value is required.")}this.componentDatatype=i.componentDatatype;this.componentsPerAttribute=i.componentsPerAttribute;this.normalize=e(i.normalize,false);this.value=i.value}return i});define("Core/getBaseUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i,n){if(!t(i)){throw new r("uri is required.")}var a="";var o=i.lastIndexOf("/");if(o!==-1){a=i.substring(0,o+1)}if(!n){return a}i=new e(i);if(t(i.query)){a+="?"+i.query}if(t(i.fragment)){a+="#"+i.fragment}return a}return i});define("Core/getExtensionFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i){if(!t(i)){throw new r("uri is required.")}var n=new e(i);n.normalize();var a=n.path;var o=a.lastIndexOf("/");if(o!==-1){a=a.substr(o+1)}o=a.lastIndexOf(".");if(o===-1){a=""}else{a=a.substr(o+1)}return a}return i});define("Core/getFilenameFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(i){if(!t(i)){throw new r("uri is required.")}var n=new e(i);n.normalize();var a=n.path;var o=a.lastIndexOf("/");if(o!==-1){a=a.substr(o+1)}return a}return i});define("Core/getImagePixels",["./defined"],function(e){"use strict";var t={};function r(r,i,n){if(!e(i)){i=r.width}if(!e(n)){n=r.height}var a=t[i];if(!e(a)){a={};t[i]=a}var o=a[n];if(!e(o)){var s=document.createElement("canvas");s.width=i;s.height=n;o=s.getContext("2d");o.globalCompositeOperation="copy";a[n]=o}o.drawImage(r,0,0,i,n);return o.getImageData(0,0,i,n).data}return r});define("Core/getStringFromTypedArray",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(n,a,o){if(!t(n)){throw new r("uint8Array is required.")}if(a<0){throw new r("byteOffset cannot be negative.")}if(o<0){throw new r("byteLength cannot be negative.")}if(a+o>n.byteLength){throw new r("sub-region exceeds array bounds.")}a=e(a,0);o=e(o,n.byteLength-a);n=n.subarray(a,a+o);return i.decode(n)}i.decodeWithTextDecoder=function(e){var t=new TextDecoder("utf-8");return t.decode(e)};i.decodeWithFromCharCode=function(e){var t="";var r=e.length;for(var i=0;i<r;++i){t+=String.fromCharCode(e[i])}return t};if(typeof TextDecoder!=="undefined"){i.decode=i.decodeWithTextDecoder}else{i.decode=i.decodeWithFromCharCode}return i});define("Core/getMagic",["./defaultValue","./getStringFromTypedArray"],function(e,t){"use strict";function r(r,i){i=e(i,0);return t(r,i,Math.min(4,r.length))}return r});(function(global,undefined){"use strict";(function e(t,r,i){function n(e){var i=r[e];if(!i)t[e][0].call(i=r[e]={exports:{}},n,i,i.exports);return i.exports}var a=global.protobuf=n(i[0]);if(typeof define==="function"&&define.amd)define("ThirdParty/protobuf-minimal",[],function(){a.configure();return a});if(typeof module==="object"&&module&&module.exports)module.exports=a})({1:[function(e,t,r){"use strict";t.exports=i;function i(e,t){var r=[];for(var i=2;i<arguments.length;)r.push(arguments[i++]);var n=true;return new Promise(function i(a,o){r.push(function e(t){if(n){n=false;if(t)o(t);else{var r=[];for(var i=1;i<arguments.length;)r.push(arguments[i++]);a.apply(null,r)}}});try{e.apply(t||this,r)}catch(e){if(n){n=false;o(e)}}})}},{}],2:[function(e,t,r){"use strict";var i=r;i.length=function e(t){var r=t.length;if(!r)return 0;var i=0;while(--r%4>1&&t.charAt(r)==="=")++i;return Math.ceil(t.length*3)/4-i};var n=new Array(64);var a=new Array(123);for(var o=0;o<64;)a[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;i.encode=function e(t,r,i){var a=[];var o=0,s=0,l;while(r<i){var u=t[r++];switch(s){case 0:a[o++]=n[u>>2];l=(u&3)<<4;s=1;break;case 1:a[o++]=n[l|u>>4];l=(u&15)<<2;s=2;break;case 2:a[o++]=n[l|u>>6];a[o++]=n[u&63];s=0;break}}if(s){a[o++]=n[l];a[o]=61;if(s===1)a[o+1]=61}return String.fromCharCode.apply(String,a)};var s="invalid encoding";i.decode=function e(t,r,i){var n=i;var o=0,l;for(var u=0;u<t.length;){var c=t.charCodeAt(u++);if(c===61&&o>1)break;if((c=a[c])===undefined)throw Error(s);switch(o){case 0:l=c;o=1;break;case 1:r[i++]=l<<2|(c&48)>>4;l=c;o=2;break;case 2:r[i++]=(l&15)<<4|(c&60)>>2;l=c;o=3;break;case 3:r[i++]=(l&3)<<6|c;o=0;break}}if(o===1)throw Error(s);return i-n};i.test=function e(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},{}],3:[function(e,t,r){"use strict";t.exports=i;function i(){this._listeners={}}i.prototype.on=function e(t,r,i){(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:i||this});return this};i.prototype.off=function e(t,r){if(t===undefined)this._listeners={};else{if(r===undefined)this._listeners[t]=[];else{var i=this._listeners[t];for(var n=0;n<i.length;)if(i[n].fn===r)i.splice(n,1);else++n}}return this};i.prototype.emit=function e(t){var r=this._listeners[t];if(r){var i=[],n=1;for(;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,i)}return this}},{}],4:[function(require,module,exports){"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}},{}],5:[function(e,t,r){"use strict";t.exports=i;function i(e,t,r){var i=r||8192;var n=i>>>1;var a=null;var o=i;return function r(s){if(s<1||s>n)return e(s);if(o+s>i){a=e(i);o=0}var l=t.call(a,o,o+=s);if(o&7)o=(o|7)+1;return l}}},{}],6:[function(e,t,r){"use strict";var i=r;i.length=function e(t){var r=0,i=0;for(var n=0;n<t.length;++n){i=t.charCodeAt(n);if(i<128)r+=1;else if(i<2048)r+=2;else if((i&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320){++n;r+=4}else r+=3}return r};i.read=function e(t,r,i){var n=i-r;if(n<1)return"";var a=null,o=[],s=0,l;while(r<i){l=t[r++];if(l<128)o[s++]=l;else if(l>191&&l<224)o[s++]=(l&31)<<6|t[r++]&63;else if(l>239&&l<365){l=((l&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536;o[s++]=55296+(l>>10);o[s++]=56320+(l&1023)}else o[s++]=(l&15)<<12|(t[r++]&63)<<6|t[r++]&63;if(s>8191){(a||(a=[])).push(String.fromCharCode.apply(String,o));s=0}}if(a){if(s)a.push(String.fromCharCode.apply(String,o.slice(0,s)));return a.join("")}return String.fromCharCode.apply(String,o.slice(0,s))};i.write=function e(t,r,i){var n=i,a,o;for(var s=0;s<t.length;++s){a=t.charCodeAt(s);if(a<128){r[i++]=a}else if(a<2048){r[i++]=a>>6|192;r[i++]=a&63|128}else if((a&64512)===55296&&((o=t.charCodeAt(s+1))&64512)===56320){a=65536+((a&1023)<<10)+(o&1023);++s;r[i++]=a>>18|240;r[i++]=a>>12&63|128;r[i++]=a>>6&63|128;r[i++]=a&63|128}else{r[i++]=a>>12|224;r[i++]=a>>6&63|128;r[i++]=a&63|128}}return i-n}},{}],7:[function(e,t,r){"use strict";var i=r;i.build="minimal";i.roots={};i.Writer=e(14);i.BufferWriter=e(15);i.Reader=e(8);i.BufferReader=e(9);i.util=e(13);i.rpc=e(10);i.configure=n;function n(){i.Reader._configure(i.BufferReader);i.util._configure()}i.Writer._configure(i.BufferWriter);n()},{10:10,13:13,14:14,15:15,8:8,9:9}],8:[function(e,t,r){"use strict";t.exports=l;var i=e(13);var n;var a=i.LongBits,o=i.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e;this.pos=0;this.len=e.length}var u=typeof Uint8Array!=="undefined"?function e(t){if(t instanceof Uint8Array||Array.isArray(t))return new l(t);throw Error("illegal buffer")}:function e(t){if(Array.isArray(t))return new l(t);throw Error("illegal buffer")};l.create=i.Buffer?function e(t){return(l.create=function e(t){return i.Buffer.isBuffer(t)?new n(t):u(t)})(t)}:u;l.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice;l.prototype.uint32=function e(){var t=4294967295;return function e(){t=(this.buf[this.pos]&127)>>>0;if(this.buf[this.pos++]<128)return t;t=(t|(this.buf[this.pos]&127)<<7)>>>0;if(this.buf[this.pos++]<128)return t;t=(t|(this.buf[this.pos]&127)<<14)>>>0;if(this.buf[this.pos++]<128)return t;t=(t|(this.buf[this.pos]&127)<<21)>>>0;if(this.buf[this.pos++]<128)return t;t=(t|(this.buf[this.pos]&15)<<28)>>>0;if(this.buf[this.pos++]<128)return t;if((this.pos+=5)>this.len){this.pos=this.len;throw s(this,10)}return t}}();l.prototype.int32=function e(){return this.uint32()|0};l.prototype.sint32=function e(){var t=this.uint32();return t>>>1^-(t&1)|0};function c(){var e=new a(0,0);var t=0;if(this.len-this.pos>4){for(;t<4;++t){e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0;if(this.buf[this.pos++]<128)return e}e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0;e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0;if(this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw s(this);e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0;if(this.buf[this.pos++]<128)return e}e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0;return e}if(this.len-this.pos>4){for(;t<5;++t){e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0;if(this.buf[this.pos++]<128)return e}}else{for(;t<5;++t){if(this.pos>=this.len)throw s(this);e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0;if(this.buf[this.pos++]<128)return e}}throw Error("invalid varint encoding")}l.prototype.bool=function e(){return this.uint32()!==0};function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}l.prototype.fixed32=function e(){if(this.pos+4>this.len)throw s(this,4);return d(this.buf,this.pos+=4)};l.prototype.sfixed32=function e(){if(this.pos+4>this.len)throw s(this,4);return d(this.buf,this.pos+=4)|0};function f(){if(this.pos+8>this.len)throw s(this,8);return new a(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}var h=typeof Float32Array!=="undefined"?function(){var e=new Float32Array(1),t=new Uint8Array(e.buffer);e[0]=-0;return t[3]?function r(i,n){t[0]=i[n];t[1]=i[n+1];t[2]=i[n+2];t[3]=i[n+3];return e[0]}:function r(i,n){t[0]=i[n+3];t[1]=i[n+2];t[2]=i[n+1];t[3]=i[n];return e[0]}}():function e(t,r){var i=d(t,r+4),n=(i>>31)*2+1,a=i>>>23&255,o=i&8388607;return a===255?o?NaN:n*Infinity:a===0?n*1.401298464324817e-45*o:n*Math.pow(2,a-150)*(o+8388608)};l.prototype.float=function e(){if(this.pos+4>this.len)throw s(this,4);var t=h(this.buf,this.pos);this.pos+=4;return t};var p=typeof Float64Array!=="undefined"?function(){var e=new Float64Array(1),t=new Uint8Array(e.buffer);e[0]=-0;return t[7]?function r(i,n){t[0]=i[n];t[1]=i[n+1];t[2]=i[n+2];t[3]=i[n+3];t[4]=i[n+4];t[5]=i[n+5];t[6]=i[n+6];t[7]=i[n+7];return e[0]}:function r(i,n){t[0]=i[n+7];t[1]=i[n+6];t[2]=i[n+5];t[3]=i[n+4];t[4]=i[n+3];t[5]=i[n+2];t[6]=i[n+1];t[7]=i[n];return e[0]}}():function e(t,r){var i=d(t,r+4),n=d(t,r+8);var a=(n>>31)*2+1,o=n>>>20&2047,s=4294967296*(n&1048575)+i;return o===2047?s?NaN:a*Infinity:o===0?a*5e-324*s:a*Math.pow(2,o-1075)*(s+4503599627370496)};l.prototype.double=function e(){if(this.pos+8>this.len)throw s(this,4);var t=p(this.buf,this.pos);this.pos+=8;return t};l.prototype.bytes=function e(){var t=this.uint32(),r=this.pos,i=this.pos+t;if(i>this.len)throw s(this,t);this.pos+=t;return r===i?new this.buf.constructor(0):this._slice.call(this.buf,r,i)};l.prototype.string=function e(){var t=this.bytes();return o.read(t,0,t.length)};l.prototype.skip=function e(t){if(typeof t==="number"){if(this.pos+t>this.len)throw s(this,t);this.pos+=t}else{do{if(this.pos>=this.len)throw s(this)}while(this.buf[this.pos++]&128)}return this};l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:do{if((e=this.uint32()&7)===4)break;this.skipType(e)}while(true);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};l._configure=function(e){n=e;var t=i.Long?"toLong":"toNumber";i.merge(l.prototype,{int64:function e(){return c.call(this)[t](false)},uint64:function e(){return c.call(this)[t](true)},sint64:function e(){return c.call(this).zzDecode()[t](false)},fixed64:function e(){return f.call(this)[t](true)},sfixed64:function e(){return f.call(this)[t](false)}})}},{13:13}],9:[function(e,t,r){"use strict";t.exports=a;var i=e(8);(a.prototype=Object.create(i.prototype)).constructor=a;var n=e(13);function a(e){i.call(this,e)}if(n.Buffer)a.prototype._slice=n.Buffer.prototype.slice;a.prototype.string=function e(){var t=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len))}},{13:13,8:8}],10:[function(e,t,r){"use strict";var i=r;i.Service=e(11)},{11:11}],11:[function(e,t,r){"use strict";t.exports=n;var i=e(13);(n.prototype=Object.create(i.EventEmitter.prototype)).constructor=n;function n(e,t,r){if(typeof e!=="function")throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this);this.rpcImpl=e;this.requestDelimited=Boolean(t);this.responseDelimited=Boolean(r)}n.prototype.rpcCall=function e(t,r,n,a,o){if(!a)throw TypeError("request must be specified");var s=this;if(!o)return i.asPromise(e,s,t,r,n,a);if(!s.rpcImpl){setTimeout(function(){o(Error("already ended"))},0);return undefined}try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](a).finish(),function e(r,i){if(r){s.emit("error",r,t);return o(r)}if(i===null){s.end(true);return undefined}if(!(i instanceof n)){try{i=n[s.responseDelimited?"decodeDelimited":"decode"](i)}catch(r){s.emit("error",r,t);return o(r)}}s.emit("data",i,t);return o(null,i)})}catch(e){s.emit("error",e,t);setTimeout(function(){o(e)},0);return undefined}};n.prototype.end=function e(t){if(this.rpcImpl){if(!t)this.rpcImpl(null,null,null);this.rpcImpl=null;this.emit("end").off()}return this}},{13:13}],12:[function(e,t,r){"use strict";t.exports=n;var i=e(13);function n(e,t){this.lo=e>>>0;this.hi=t>>>0}var a=n.zero=new n(0,0);a.toNumber=function(){return 0};a.zzEncode=a.zzDecode=function(){return this};a.length=function(){return 1};var o=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function e(t){if(t===0)return a;var r=t<0;if(r)t=-t;var i=t>>>0,o=(t-i)/4294967296>>>0;if(r){o=~o>>>0;i=~i>>>0;if(++i>4294967295){i=0;if(++o>4294967295)o=0}}return new n(i,o)};n.from=function e(t){if(typeof t==="number")return n.fromNumber(t);if(i.isString(t)){if(i.Long)t=i.Long.fromString(t);else return n.fromNumber(parseInt(t,10))}return t.low||t.high?new n(t.low>>>0,t.high>>>0):a};n.prototype.toNumber=function e(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,i=~this.hi>>>0;if(!r)i=i+1>>>0;return-(r+i*4294967296)}return this.lo+this.hi*4294967296};n.prototype.toLong=function e(t){return i.Long?new i.Long(this.lo|0,this.hi|0,Boolean(t)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(t)}};var s=String.prototype.charCodeAt;n.fromHash=function e(t){if(t===o)return a;return new n((s.call(t,0)|s.call(t,1)<<8|s.call(t,2)<<16|s.call(t,3)<<24)>>>0,(s.call(t,4)|s.call(t,5)<<8|s.call(t,6)<<16|s.call(t,7)<<24)>>>0)};n.prototype.toHash=function e(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};n.prototype.zzEncode=function e(){var t=this.hi>>31;this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0;this.lo=(this.lo<<1^t)>>>0;return this};n.prototype.zzDecode=function e(){var t=-(this.lo&1);this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0;this.hi=(this.hi>>>1^t)>>>0;return this};n.prototype.length=function e(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:i<128?9:10}},{13:13}],13:[function(e,t,r){"use strict";var i=r;i.asPromise=e(1);i.base64=e(2);i.EventEmitter=e(3);i.inquire=e(4);i.utf8=e(6);i.pool=e(5);i.LongBits=e(12);i.emptyArray=Object.freeze?Object.freeze([]):[];i.emptyObject=Object.freeze?Object.freeze({}):{};i.isNode=Boolean(global.process&&global.process.versions&&global.process.versions.node);i.isInteger=Number.isInteger||function e(t){return typeof t==="number"&&isFinite(t)&&Math.floor(t)===t};i.isString=function e(t){return typeof t==="string"||t instanceof String};i.isObject=function e(t){return t&&typeof t==="object"};i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}();i._Buffer_from=null;i._Buffer_allocUnsafe=null;i.newBuffer=function e(t){return typeof t==="number"?i.Buffer?i._Buffer_allocUnsafe(t):new i.Array(t):i.Buffer?i._Buffer_from(t):typeof Uint8Array==="undefined"?t:new Uint8Array(t)};i.Array=typeof Uint8Array!=="undefined"?Uint8Array:Array;i.Long=global.dcodeIO&&global.dcodeIO.Long||i.inquire("long");i.key2Re=/^true|false|0|1$/;i.key32Re=/^-?(?:0|[1-9][0-9]*)$/;i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;i.longToHash=function e(t){return t?i.LongBits.from(t).toHash():i.LongBits.zeroHash};i.longFromHash=function e(t,r){var n=i.LongBits.fromHash(t);if(i.Long)return i.Long.fromBits(n.lo,n.hi,r);return n.toNumber(Boolean(r))};function n(e,t,r){for(var i=Object.keys(t),n=0;n<i.length;++n)if(e[i[n]]===undefined||!r)e[i[n]]=t[i[n]];return e}i.merge=n;i.lcFirst=function e(t){return t.charAt(0).toLowerCase()+t.substring(1)};function a(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}});if(Error.captureStackTrace)Error.captureStackTrace(this,t);else Object.defineProperty(this,"stack",{value:(new Error).stack||""});if(r)n(this,r)}(t.prototype=Object.create(Error.prototype)).constructor=t;Object.defineProperty(t.prototype,"name",{get:function(){return e}});t.prototype.toString=function e(){return this.name+": "+this.message};return t}i.newError=a;i.ProtocolError=a("ProtocolError");i.oneOfGetter=function e(t){var r={};for(var i=0;i<t.length;++i)r[t[i]]=1;return function(){for(var e=Object.keys(this),t=e.length-1;t>-1;--t)if(r[e[t]]===1&&this[e[t]]!==undefined&&this[e[t]]!==null)return e[t]}};i.oneOfSetter=function e(t){return function(e){for(var r=0;r<t.length;++r)if(t[r]!==e)delete this[t[r]]}};i.lazyResolve=function e(t,r){for(var i=0;i<r.length;++i){for(var n=Object.keys(r[i]),a=0;a<n.length;++a){var o=r[i][n[a]].split("."),s=t;while(o.length)s=s[o.shift()];r[i][n[a]]=s}}};i.toJSONOptions={longs:String,enums:String,bytes:String};i._configure=function(){var e=i.Buffer;if(!e){i._Buffer_from=i._Buffer_allocUnsafe=null;return}i._Buffer_from=e.from!==Uint8Array.from&&e.from||function t(r,i){return new e(r,i)};i._Buffer_allocUnsafe=e.allocUnsafe||function t(r){return new e(r)}}},{1:1,12:12,2:2,3:3,4:4,5:5,6:6}],14:[function(e,t,r){"use strict";t.exports=d;var i=e(13);var n;var a=i.LongBits,o=i.base64,s=i.utf8;function l(e,t,r){this.fn=e;this.len=t;this.next=undefined;this.val=r}function u(){}function c(e){this.head=e.head;this.tail=e.tail;this.len=e.len;this.next=e.states}function d(){this.len=0;this.head=new l(u,0,0);this.tail=this.head;this.states=null}d.create=i.Buffer?function e(){return(d.create=function e(){return new n})()}:function e(){return new d};d.alloc=function e(t){return new i.Array(t)};if(i.Array!==Array)d.alloc=i.pool(d.alloc,i.Array.prototype.subarray);d.prototype.push=function e(t,r,i){this.tail=this.tail.next=new l(t,r,i);this.len+=r;return this};function f(e,t,r){t[r]=e&255}function h(e,t,r){while(e>127){t[r++]=e&127|128;e>>>=7}t[r]=e}function p(e,t){this.len=e;this.next=undefined;this.val=t}p.prototype=Object.create(l.prototype);p.prototype.fn=h;d.prototype.uint32=function e(t){this.len+=(this.tail=this.tail.next=new p((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len;return this};d.prototype.int32=function e(t){return t<0?this.push(m,10,a.fromNumber(t)):this.uint32(t)};d.prototype.sint32=function e(t){return this.uint32((t<<1^t>>31)>>>0)};function m(e,t,r){while(e.hi){t[r++]=e.lo&127|128;e.lo=(e.lo>>>7|e.hi<<25)>>>0;e.hi>>>=7}while(e.lo>127){t[r++]=e.lo&127|128;e.lo=e.lo>>>7}t[r++]=e.lo}d.prototype.uint64=function e(t){var r=a.from(t);return this.push(m,r.length(),r)};d.prototype.int64=d.prototype.uint64;d.prototype.sint64=function e(t){var r=a.from(t).zzEncode();return this.push(m,r.length(),r)};d.prototype.bool=function e(t){return this.push(f,1,t?1:0)};function v(e,t,r){t[r++]=e&255;t[r++]=e>>>8&255;t[r++]=e>>>16&255;t[r]=e>>>24}d.prototype.fixed32=function e(t){return this.push(v,4,t>>>0)};d.prototype.sfixed32=d.prototype.fixed32;d.prototype.fixed64=function e(t){var r=a.from(t);return this.push(v,4,r.lo).push(v,4,r.hi)};d.prototype.sfixed64=d.prototype.fixed64;var g=typeof Float32Array!=="undefined"?function(){var e=new Float32Array(1),t=new Uint8Array(e.buffer);e[0]=-0;return t[3]?function r(i,n,a){e[0]=i;n[a++]=t[0];n[a++]=t[1];n[a++]=t[2];n[a]=t[3]}:function r(i,n,a){e[0]=i;n[a++]=t[3];n[a++]=t[2];n[a++]=t[1];n[a]=t[0]}}():function e(t,r,i){var n=t<0?1:0;if(n)t=-t;if(t===0)v(1/t>0?0:2147483648,r,i);else if(isNaN(t))v(2147483647,r,i);else if(t>3.4028234663852886e38)v((n<<31|2139095040)>>>0,r,i);else if(t<1.1754943508222875e-38)v((n<<31|Math.round(t/1.401298464324817e-45))>>>0,r,i);else{var a=Math.floor(Math.log(t)/Math.LN2),o=Math.round(t*Math.pow(2,-a)*8388608)&8388607;v((n<<31|a+127<<23|o)>>>0,r,i)}};d.prototype.float=function e(t){return this.push(g,4,t)};var _=typeof Float64Array!=="undefined"?function(){var e=new Float64Array(1),t=new Uint8Array(e.buffer);e[0]=-0;return t[7]?function r(i,n,a){e[0]=i;n[a++]=t[0];n[a++]=t[1];n[a++]=t[2];n[a++]=t[3];n[a++]=t[4];n[a++]=t[5];n[a++]=t[6];n[a]=t[7]}:function r(i,n,a){e[0]=i;n[a++]=t[7];n[a++]=t[6];n[a++]=t[5];n[a++]=t[4];n[a++]=t[3];n[a++]=t[2];n[a++]=t[1];n[a]=t[0]}}():function e(t,r,i){var n=t<0?1:0;if(n)t=-t;if(t===0){v(0,r,i);v(1/t>0?0:2147483648,r,i+4)}else if(isNaN(t)){v(4294967295,r,i);v(2147483647,r,i+4)}else if(t>1.7976931348623157e308){v(0,r,i);v((n<<31|2146435072)>>>0,r,i+4)}else{var a;if(t<2.2250738585072014e-308){a=t/5e-324;v(a>>>0,r,i);v((n<<31|a/4294967296)>>>0,r,i+4)}else{var o=Math.floor(Math.log(t)/Math.LN2);if(o===1024)o=1023;a=t*Math.pow(2,-o);v(a*4503599627370496>>>0,r,i);v((n<<31|o+1023<<20|a*1048576&1048575)>>>0,r,i+4)}}};d.prototype.double=function e(t){return this.push(_,8,t)};var y=i.Array.prototype.set?function e(t,r,i){r.set(t,i)}:function e(t,r,i){for(var n=0;n<t.length;++n)r[i+n]=t[n]};d.prototype.bytes=function e(t){var r=t.length>>>0;if(!r)return this.push(f,1,0);if(i.isString(t)){var n=d.alloc(r=o.length(t));o.decode(t,n,0);t=n}return this.uint32(r).push(y,r,t)};d.prototype.string=function e(t){var r=s.length(t);return r?this.uint32(r).push(s.write,r,t):this.push(f,1,0)};d.prototype.fork=function e(){this.states=new c(this);this.head=this.tail=new l(u,0,0);this.len=0;return this};d.prototype.reset=function e(){if(this.states){this.head=this.states.head;this.tail=this.states.tail;this.len=this.states.len;this.states=this.states.next}else{this.head=this.tail=new l(u,0,0);this.len=0}return this};d.prototype.ldelim=function e(){var t=this.head,r=this.tail,i=this.len;this.reset().uint32(i);if(i){this.tail.next=t.next;this.tail=r;this.len+=i}return this};d.prototype.finish=function e(){var t=this.head.next,r=this.constructor.alloc(this.len),i=0;while(t){t.fn(t.val,r,i);i+=t.len;t=t.next}return r};d._configure=function(e){n=e}},{13:13}],15:[function(e,t,r){"use strict";t.exports=o;var i=e(14);(o.prototype=Object.create(i.prototype)).constructor=o;var n=e(13);var a=n.Buffer;function o(){i.call(this)}o.alloc=function e(t){return(o.alloc=n._Buffer_allocUnsafe)(t)};var s=a&&a.prototype instanceof Uint8Array&&a.prototype.set.name==="set"?function e(t,r,i){r.set(t,i)}:function e(t,r,i){if(t.copy)t.copy(r,i,0,t.length);else for(var n=0;n<t.length;)r[i++]=t[n++]};o.prototype.bytes=function e(t){if(n.isString(t))t=n._Buffer_from(t,"base64");var r=t.length>>>0;this.uint32(r);if(r)this.push(s,r,t);return this};function l(e,t,r){if(e.length<40)n.utf8.write(e,t,r);else t.utf8Write(e,r)}o.prototype.string=function e(t){var r=a.byteLength(t);this.uint32(r);if(r)this.push(l,r,t);return this}},{13:13,14:14}]},{},[7])})(typeof window==="object"&&window||typeof self==="object"&&self||this);define("ThirdParty/google-earth-dbroot-parser",["./protobuf-minimal"],function(e){"use strict";var t=e.Reader,r=e.Writer,i=e.util;var n=[];var a=e.roots["default"]||(e.roots["default"]={});a.keyhole=function(){var r={};r.dbroot=function(){var r={};r.StringEntryProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.stringId=0;r.prototype.stringValue="";r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.StringEntryProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.stringId=r.fixed32();break;case 2:o.stringValue=r.string();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isInteger(t.stringId))return"stringId: integer expected";if(!i.isString(t.stringValue))return"stringValue: string expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.StringEntryProto)return t;var r=new a.keyhole.dbroot.StringEntryProto;if(t.stringId!==undefined&&t.stringId!==null)r.stringId=t.stringId>>>0;if(t.stringValue!==undefined&&t.stringValue!==null)r.stringValue=String(t.stringValue);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.stringId=0;i.stringValue=""}if(t.stringId!==undefined&&t.stringId!==null&&t.hasOwnProperty("stringId"))i.stringId=t.stringId;if(t.stringValue!==undefined&&t.stringValue!==null&&t.hasOwnProperty("stringValue"))i.stringValue=t.stringValue;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.StringIdOrValueProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.stringId=0;r.prototype.value="";r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.StringIdOrValueProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.stringId=r.fixed32();break;case 2:o.value=r.string();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.stringId!==undefined)if(!i.isInteger(t.stringId))return"stringId: integer expected";if(t.value!==undefined)if(!i.isString(t.value))return"value: string expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.StringIdOrValueProto)return t;var r=new a.keyhole.dbroot.StringIdOrValueProto;if(t.stringId!==undefined&&t.stringId!==null)r.stringId=t.stringId>>>0;if(t.value!==undefined&&t.value!==null)r.value=String(t.value);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.stringId=0;i.value=""}if(t.stringId!==undefined&&t.stringId!==null&&t.hasOwnProperty("stringId"))i.stringId=t.stringId;if(t.value!==undefined&&t.value!==null&&t.hasOwnProperty("value"))i.value=t.value;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.PlanetModelProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.radius=6378.137;r.prototype.flattening=.00335281066474748;r.prototype.elevationBias=0;r.prototype.negativeAltitudeExponentBias=0;r.prototype.compressedNegativeAltitudeThreshold=0;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.PlanetModelProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.radius=r.double();break;case 2:o.flattening=r.double();break;case 4:o.elevationBias=r.double();break;case 5:o.negativeAltitudeExponentBias=r.int32();break;case 6:o.compressedNegativeAltitudeThreshold=r.double();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.radius!==undefined)if(typeof t.radius!=="number")return"radius: number expected";if(t.flattening!==undefined)if(typeof t.flattening!=="number")return"flattening: number expected";if(t.elevationBias!==undefined)if(typeof t.elevationBias!=="number")return"elevationBias: number expected";if(t.negativeAltitudeExponentBias!==undefined)if(!i.isInteger(t.negativeAltitudeExponentBias))return"negativeAltitudeExponentBias: integer expected";if(t.compressedNegativeAltitudeThreshold!==undefined)if(typeof t.compressedNegativeAltitudeThreshold!=="number")return"compressedNegativeAltitudeThreshold: number expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.PlanetModelProto)return t;var r=new a.keyhole.dbroot.PlanetModelProto;if(t.radius!==undefined&&t.radius!==null)r.radius=Number(t.radius);if(t.flattening!==undefined&&t.flattening!==null)r.flattening=Number(t.flattening);if(t.elevationBias!==undefined&&t.elevationBias!==null)r.elevationBias=Number(t.elevationBias);if(t.negativeAltitudeExponentBias!==undefined&&t.negativeAltitudeExponentBias!==null)r.negativeAltitudeExponentBias=t.negativeAltitudeExponentBias|0;if(t.compressedNegativeAltitudeThreshold!==undefined&&t.compressedNegativeAltitudeThreshold!==null)r.compressedNegativeAltitudeThreshold=Number(t.compressedNegativeAltitudeThreshold);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.radius=6378.137;i.flattening=.00335281066474748;i.elevationBias=0;i.negativeAltitudeExponentBias=0;i.compressedNegativeAltitudeThreshold=0}if(t.radius!==undefined&&t.radius!==null&&t.hasOwnProperty("radius"))i.radius=t.radius;if(t.flattening!==undefined&&t.flattening!==null&&t.hasOwnProperty("flattening"))i.flattening=t.flattening;if(t.elevationBias!==undefined&&t.elevationBias!==null&&t.hasOwnProperty("elevationBias"))i.elevationBias=t.elevationBias;if(t.negativeAltitudeExponentBias!==undefined&&t.negativeAltitudeExponentBias!==null&&t.hasOwnProperty("negativeAltitudeExponentBias"))i.negativeAltitudeExponentBias=t.negativeAltitudeExponentBias;if(t.compressedNegativeAltitudeThreshold!==undefined&&t.compressedNegativeAltitudeThreshold!==null&&t.hasOwnProperty("compressedNegativeAltitudeThreshold"))i.compressedNegativeAltitudeThreshold=t.compressedNegativeAltitudeThreshold;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.ProviderInfoProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.providerId=0;r.prototype.copyrightString=null;r.prototype.verticalPixelOffset=-1;var o={1:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.ProviderInfoProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.providerId=r.int32();break;case 2:s.copyrightString=o[1].decode(r,r.uint32());break;case 3:s.verticalPixelOffset=r.int32();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isInteger(t.providerId))return"providerId: integer expected";if(t.copyrightString!==undefined&&t.copyrightString!==null){var r=o[1].verify(t.copyrightString);if(r)return"copyrightString."+r}if(t.verticalPixelOffset!==undefined)if(!i.isInteger(t.verticalPixelOffset))return"verticalPixelOffset: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.ProviderInfoProto)return t;var r=new a.keyhole.dbroot.ProviderInfoProto;if(t.providerId!==undefined&&t.providerId!==null)r.providerId=t.providerId|0;if(t.copyrightString!==undefined&&t.copyrightString!==null){if(typeof t.copyrightString!=="object")throw TypeError(".keyhole.dbroot.ProviderInfoProto.copyrightString: object expected");r.copyrightString=o[1].fromObject(t.copyrightString)}if(t.verticalPixelOffset!==undefined&&t.verticalPixelOffset!==null)r.verticalPixelOffset=t.verticalPixelOffset|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.providerId=0;i.copyrightString=null;i.verticalPixelOffset=-1}if(t.providerId!==undefined&&t.providerId!==null&&t.hasOwnProperty("providerId"))i.providerId=t.providerId;if(t.copyrightString!==undefined&&t.copyrightString!==null&&t.hasOwnProperty("copyrightString"))i.copyrightString=o[1].toObject(t.copyrightString,r);if(t.verticalPixelOffset!==undefined&&t.verticalPixelOffset!==null&&t.hasOwnProperty("verticalPixelOffset"))i.verticalPixelOffset=t.verticalPixelOffset;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.PopUpProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.isBalloonStyle=false;r.prototype.text=null;r.prototype.backgroundColorAbgr=4294967295;r.prototype.textColorAbgr=4278190080;var o={1:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.PopUpProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.isBalloonStyle=r.bool();break;case 2:s.text=o[1].decode(r,r.uint32());break;case 3:s.backgroundColorAbgr=r.fixed32();break;case 4:s.textColorAbgr=r.fixed32();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.isBalloonStyle!==undefined)if(typeof t.isBalloonStyle!=="boolean")return"isBalloonStyle: boolean expected";if(t.text!==undefined&&t.text!==null){var r=o[1].verify(t.text);if(r)return"text."+r}if(t.backgroundColorAbgr!==undefined)if(!i.isInteger(t.backgroundColorAbgr))return"backgroundColorAbgr: integer expected";if(t.textColorAbgr!==undefined)if(!i.isInteger(t.textColorAbgr))return"textColorAbgr: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.PopUpProto)return t;var r=new a.keyhole.dbroot.PopUpProto;if(t.isBalloonStyle!==undefined&&t.isBalloonStyle!==null)r.isBalloonStyle=Boolean(t.isBalloonStyle);if(t.text!==undefined&&t.text!==null){if(typeof t.text!=="object")throw TypeError(".keyhole.dbroot.PopUpProto.text: object expected");r.text=o[1].fromObject(t.text)}if(t.backgroundColorAbgr!==undefined&&t.backgroundColorAbgr!==null)r.backgroundColorAbgr=t.backgroundColorAbgr>>>0;if(t.textColorAbgr!==undefined&&t.textColorAbgr!==null)r.textColorAbgr=t.textColorAbgr>>>0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.isBalloonStyle=false;i.text=null;i.backgroundColorAbgr=4294967295;i.textColorAbgr=4278190080}if(t.isBalloonStyle!==undefined&&t.isBalloonStyle!==null&&t.hasOwnProperty("isBalloonStyle"))i.isBalloonStyle=t.isBalloonStyle;if(t.text!==undefined&&t.text!==null&&t.hasOwnProperty("text"))i.text=o[1].toObject(t.text,r);if(t.backgroundColorAbgr!==undefined&&t.backgroundColorAbgr!==null&&t.hasOwnProperty("backgroundColorAbgr"))i.backgroundColorAbgr=t.backgroundColorAbgr;if(t.textColorAbgr!==undefined&&t.textColorAbgr!==null&&t.hasOwnProperty("textColorAbgr"))i.textColorAbgr=t.textColorAbgr;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.StyleAttributeProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.styleId="";r.prototype.providerId=0;r.prototype.polyColorAbgr=4294967295;r.prototype.lineColorAbgr=4294967295;r.prototype.lineWidth=1;r.prototype.labelColorAbgr=4294967295;r.prototype.labelScale=1;r.prototype.placemarkIconColorAbgr=4294967295;r.prototype.placemarkIconScale=1;r.prototype.placemarkIconPath=null;r.prototype.placemarkIconX=0;r.prototype.placemarkIconY=0;r.prototype.placemarkIconWidth=32;r.prototype.placemarkIconHeight=32;r.prototype.popUp=null;r.prototype.drawFlag=i.emptyArray;var o={9:"keyhole.dbroot.StringIdOrValueProto",14:"keyhole.dbroot.PopUpProto",15:"keyhole.dbroot.DrawFlagProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.StyleAttributeProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.styleId=r.string();break;case 3:s.providerId=r.int32();break;case 4:s.polyColorAbgr=r.fixed32();break;case 5:s.lineColorAbgr=r.fixed32();break;case 6:s.lineWidth=r.float();break;case 7:s.labelColorAbgr=r.fixed32();break;case 8:s.labelScale=r.float();break;case 9:s.placemarkIconColorAbgr=r.fixed32();break;case 10:s.placemarkIconScale=r.float();break;case 11:s.placemarkIconPath=o[9].decode(r,r.uint32());break;case 12:s.placemarkIconX=r.int32();break;case 13:s.placemarkIconY=r.int32();break;case 14:s.placemarkIconWidth=r.int32();break;case 15:s.placemarkIconHeight=r.int32();break;case 16:s.popUp=o[14].decode(r,r.uint32());break;case 17:if(!(s.drawFlag&&s.drawFlag.length))s.drawFlag=[];s.drawFlag.push(o[15].decode(r,r.uint32()));break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isString(t.styleId))return"styleId: string expected";if(t.providerId!==undefined)if(!i.isInteger(t.providerId))return"providerId: integer expected";if(t.polyColorAbgr!==undefined)if(!i.isInteger(t.polyColorAbgr))return"polyColorAbgr: integer expected";if(t.lineColorAbgr!==undefined)if(!i.isInteger(t.lineColorAbgr))return"lineColorAbgr: integer expected";if(t.lineWidth!==undefined)if(typeof t.lineWidth!=="number")return"lineWidth: number expected";if(t.labelColorAbgr!==undefined)if(!i.isInteger(t.labelColorAbgr))return"labelColorAbgr: integer expected";if(t.labelScale!==undefined)if(typeof t.labelScale!=="number")return"labelScale: number expected";if(t.placemarkIconColorAbgr!==undefined)if(!i.isInteger(t.placemarkIconColorAbgr))return"placemarkIconColorAbgr: integer expected";if(t.placemarkIconScale!==undefined)if(typeof t.placemarkIconScale!=="number")return"placemarkIconScale: number expected";if(t.placemarkIconPath!==undefined&&t.placemarkIconPath!==null){var r=o[9].verify(t.placemarkIconPath);if(r)return"placemarkIconPath."+r}if(t.placemarkIconX!==undefined)if(!i.isInteger(t.placemarkIconX))return"placemarkIconX: integer expected";if(t.placemarkIconY!==undefined)if(!i.isInteger(t.placemarkIconY))return"placemarkIconY: integer expected";if(t.placemarkIconWidth!==undefined)if(!i.isInteger(t.placemarkIconWidth))return"placemarkIconWidth: integer expected";if(t.placemarkIconHeight!==undefined)if(!i.isInteger(t.placemarkIconHeight))return"placemarkIconHeight: integer expected";if(t.popUp!==undefined&&t.popUp!==null){var r=o[14].verify(t.popUp);if(r)return"popUp."+r}if(t.drawFlag!==undefined){if(!Array.isArray(t.drawFlag))return"drawFlag: array expected";for(var n=0;n<t.drawFlag.length;++n){var r=o[15].verify(t.drawFlag[n]);if(r)return"drawFlag."+r}}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.StyleAttributeProto)return t;var r=new a.keyhole.dbroot.StyleAttributeProto;if(t.styleId!==undefined&&t.styleId!==null)r.styleId=String(t.styleId);if(t.providerId!==undefined&&t.providerId!==null)r.providerId=t.providerId|0;if(t.polyColorAbgr!==undefined&&t.polyColorAbgr!==null)r.polyColorAbgr=t.polyColorAbgr>>>0;if(t.lineColorAbgr!==undefined&&t.lineColorAbgr!==null)r.lineColorAbgr=t.lineColorAbgr>>>0;if(t.lineWidth!==undefined&&t.lineWidth!==null)r.lineWidth=Number(t.lineWidth);if(t.labelColorAbgr!==undefined&&t.labelColorAbgr!==null)r.labelColorAbgr=t.labelColorAbgr>>>0;if(t.labelScale!==undefined&&t.labelScale!==null)r.labelScale=Number(t.labelScale);if(t.placemarkIconColorAbgr!==undefined&&t.placemarkIconColorAbgr!==null)r.placemarkIconColorAbgr=t.placemarkIconColorAbgr>>>0;if(t.placemarkIconScale!==undefined&&t.placemarkIconScale!==null)r.placemarkIconScale=Number(t.placemarkIconScale);if(t.placemarkIconPath!==undefined&&t.placemarkIconPath!==null){if(typeof t.placemarkIconPath!=="object")throw TypeError(".keyhole.dbroot.StyleAttributeProto.placemarkIconPath: object expected");r.placemarkIconPath=o[9].fromObject(t.placemarkIconPath)}if(t.placemarkIconX!==undefined&&t.placemarkIconX!==null)r.placemarkIconX=t.placemarkIconX|0;if(t.placemarkIconY!==undefined&&t.placemarkIconY!==null)r.placemarkIconY=t.placemarkIconY|0;if(t.placemarkIconWidth!==undefined&&t.placemarkIconWidth!==null)r.placemarkIconWidth=t.placemarkIconWidth|0;if(t.placemarkIconHeight!==undefined&&t.placemarkIconHeight!==null)r.placemarkIconHeight=t.placemarkIconHeight|0;if(t.popUp!==undefined&&t.popUp!==null){if(typeof t.popUp!=="object")throw TypeError(".keyhole.dbroot.StyleAttributeProto.popUp: object expected");r.popUp=o[14].fromObject(t.popUp)}if(t.drawFlag){if(!Array.isArray(t.drawFlag))throw TypeError(".keyhole.dbroot.StyleAttributeProto.drawFlag: array expected");r.drawFlag=[];for(var i=0;i<t.drawFlag.length;++i){if(typeof t.drawFlag[i]!=="object")throw TypeError(".keyhole.dbroot.StyleAttributeProto.drawFlag: object expected");r.drawFlag[i]=o[15].fromObject(t.drawFlag[i])}}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults)i.drawFlag=[];if(r.defaults){i.styleId="";i.providerId=0;i.polyColorAbgr=4294967295;i.lineColorAbgr=4294967295;i.lineWidth=1;i.labelColorAbgr=4294967295;i.labelScale=1;i.placemarkIconColorAbgr=4294967295;i.placemarkIconScale=1;i.placemarkIconPath=null;i.placemarkIconX=0;i.placemarkIconY=0;i.placemarkIconWidth=32;i.placemarkIconHeight=32;i.popUp=null}if(t.styleId!==undefined&&t.styleId!==null&&t.hasOwnProperty("styleId"))i.styleId=t.styleId;if(t.providerId!==undefined&&t.providerId!==null&&t.hasOwnProperty("providerId"))i.providerId=t.providerId;if(t.polyColorAbgr!==undefined&&t.polyColorAbgr!==null&&t.hasOwnProperty("polyColorAbgr"))i.polyColorAbgr=t.polyColorAbgr;if(t.lineColorAbgr!==undefined&&t.lineColorAbgr!==null&&t.hasOwnProperty("lineColorAbgr"))i.lineColorAbgr=t.lineColorAbgr;if(t.lineWidth!==undefined&&t.lineWidth!==null&&t.hasOwnProperty("lineWidth"))i.lineWidth=t.lineWidth;if(t.labelColorAbgr!==undefined&&t.labelColorAbgr!==null&&t.hasOwnProperty("labelColorAbgr"))i.labelColorAbgr=t.labelColorAbgr;if(t.labelScale!==undefined&&t.labelScale!==null&&t.hasOwnProperty("labelScale"))i.labelScale=t.labelScale;if(t.placemarkIconColorAbgr!==undefined&&t.placemarkIconColorAbgr!==null&&t.hasOwnProperty("placemarkIconColorAbgr"))i.placemarkIconColorAbgr=t.placemarkIconColorAbgr;if(t.placemarkIconScale!==undefined&&t.placemarkIconScale!==null&&t.hasOwnProperty("placemarkIconScale"))i.placemarkIconScale=t.placemarkIconScale;if(t.placemarkIconPath!==undefined&&t.placemarkIconPath!==null&&t.hasOwnProperty("placemarkIconPath"))i.placemarkIconPath=o[9].toObject(t.placemarkIconPath,r);if(t.placemarkIconX!==undefined&&t.placemarkIconX!==null&&t.hasOwnProperty("placemarkIconX"))i.placemarkIconX=t.placemarkIconX;if(t.placemarkIconY!==undefined&&t.placemarkIconY!==null&&t.hasOwnProperty("placemarkIconY"))i.placemarkIconY=t.placemarkIconY;if(t.placemarkIconWidth!==undefined&&t.placemarkIconWidth!==null&&t.hasOwnProperty("placemarkIconWidth"))i.placemarkIconWidth=t.placemarkIconWidth;if(t.placemarkIconHeight!==undefined&&t.placemarkIconHeight!==null&&t.hasOwnProperty("placemarkIconHeight"))i.placemarkIconHeight=t.placemarkIconHeight;if(t.popUp!==undefined&&t.popUp!==null&&t.hasOwnProperty("popUp"))i.popUp=o[14].toObject(t.popUp,r);if(t.drawFlag!==undefined&&t.drawFlag!==null&&t.hasOwnProperty("drawFlag")){i.drawFlag=[];for(var n=0;n<t.drawFlag.length;++n)i.drawFlag[n]=o[15].toObject(t.drawFlag[n],r)}return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.StyleMapProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.styleMapId=0;r.prototype.channelId=i.emptyArray;r.prototype.normalStyleAttribute=0;r.prototype.highlightStyleAttribute=0;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.StyleMapProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.styleMapId=r.int32();break;case 2:if(!(o.channelId&&o.channelId.length))o.channelId=[];if((s&7)===2){var l=r.uint32()+r.pos;while(r.pos<l)o.channelId.push(r.int32())}else o.channelId.push(r.int32());break;case 3:o.normalStyleAttribute=r.int32();break;case 4:o.highlightStyleAttribute=r.int32();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isInteger(t.styleMapId))return"styleMapId: integer expected";if(t.channelId!==undefined){if(!Array.isArray(t.channelId))return"channelId: array expected";for(var r=0;r<t.channelId.length;++r)if(!i.isInteger(t.channelId[r]))return"channelId: integer[] expected"}if(t.normalStyleAttribute!==undefined)if(!i.isInteger(t.normalStyleAttribute))return"normalStyleAttribute: integer expected";if(t.highlightStyleAttribute!==undefined)if(!i.isInteger(t.highlightStyleAttribute))return"highlightStyleAttribute: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.StyleMapProto)return t;var r=new a.keyhole.dbroot.StyleMapProto;if(t.styleMapId!==undefined&&t.styleMapId!==null)r.styleMapId=t.styleMapId|0;if(t.channelId){if(!Array.isArray(t.channelId))throw TypeError(".keyhole.dbroot.StyleMapProto.channelId: array expected");r.channelId=[];for(var i=0;i<t.channelId.length;++i)r.channelId[i]=t.channelId[i]|0}if(t.normalStyleAttribute!==undefined&&t.normalStyleAttribute!==null)r.normalStyleAttribute=t.normalStyleAttribute|0;if(t.highlightStyleAttribute!==undefined&&t.highlightStyleAttribute!==null)r.highlightStyleAttribute=t.highlightStyleAttribute|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults)i.channelId=[];if(r.defaults){i.styleMapId=0;i.normalStyleAttribute=0;i.highlightStyleAttribute=0}if(t.styleMapId!==undefined&&t.styleMapId!==null&&t.hasOwnProperty("styleMapId"))i.styleMapId=t.styleMapId;if(t.channelId!==undefined&&t.channelId!==null&&t.hasOwnProperty("channelId")){i.channelId=[];for(var n=0;n<t.channelId.length;++n)i.channelId[n]=t.channelId[n]}if(t.normalStyleAttribute!==undefined&&t.normalStyleAttribute!==null&&t.hasOwnProperty("normalStyleAttribute"))i.normalStyleAttribute=t.normalStyleAttribute;if(t.highlightStyleAttribute!==undefined&&t.highlightStyleAttribute!==null&&t.hasOwnProperty("highlightStyleAttribute"))i.highlightStyleAttribute=t.highlightStyleAttribute;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.ZoomRangeProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.minZoom=0;r.prototype.maxZoom=0;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.ZoomRangeProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.minZoom=r.int32();break;case 2:o.maxZoom=r.int32();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isInteger(t.minZoom))return"minZoom: integer expected";if(!i.isInteger(t.maxZoom))return"maxZoom: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.ZoomRangeProto)return t;var r=new a.keyhole.dbroot.ZoomRangeProto;if(t.minZoom!==undefined&&t.minZoom!==null)r.minZoom=t.minZoom|0;if(t.maxZoom!==undefined&&t.maxZoom!==null)r.maxZoom=t.maxZoom|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.minZoom=0;i.maxZoom=0}if(t.minZoom!==undefined&&t.minZoom!==null&&t.hasOwnProperty("minZoom"))i.minZoom=t.minZoom;if(t.maxZoom!==undefined&&t.maxZoom!==null&&t.hasOwnProperty("maxZoom"))i.maxZoom=t.maxZoom;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.DrawFlagProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.drawFlagType=1;var i={0:"keyhole.dbroot.DrawFlagProto.DrawFlagType"};n.push(i);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.DrawFlagProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.drawFlagType=r.uint32();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";switch(t.drawFlagType){default:return"drawFlagType: enum value expected";case 1:case 2:case 3:case 4:case 5:break}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.DrawFlagProto)return t;var r=new a.keyhole.dbroot.DrawFlagProto;switch(t.drawFlagType){case"TYPE_FILL_ONLY":case 1:r.drawFlagType=1;break;case"TYPE_OUTLINE_ONLY":case 2:r.drawFlagType=2;break;case"TYPE_FILL_AND_OUTLINE":case 3:r.drawFlagType=3;break;case"TYPE_ANTIALIASING":case 4:r.drawFlagType=4;break;case"TYPE_CENTER_LABEL":case 5:r.drawFlagType=5;break}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var n={};if(r.defaults)n.drawFlagType=r.enums===String?"TYPE_FILL_ONLY":1;if(t.drawFlagType!==undefined&&t.drawFlagType!==null&&t.hasOwnProperty("drawFlagType"))n.drawFlagType=r.enums===String?i[0][t.drawFlagType]:t.drawFlagType;return n};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.DrawFlagType=function(){var e={},t=Object.create(e);t["TYPE_FILL_ONLY"]=1;t["TYPE_OUTLINE_ONLY"]=2;t["TYPE_FILL_AND_OUTLINE"]=3;t["TYPE_ANTIALIASING"]=4;t["TYPE_CENTER_LABEL"]=5;return t}();return r}();r.LayerProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.zoomRange=i.emptyArray;r.prototype.preserveTextLevel=30;r.prototype.lodBeginTransition=false;r.prototype.lodEndTransition=false;var o={0:"keyhole.dbroot.ZoomRangeProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.LayerProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:if(!(s.zoomRange&&s.zoomRange.length))s.zoomRange=[];s.zoomRange.push(o[0].decode(r,r.uint32()));break;case 2:s.preserveTextLevel=r.int32();break;case 4:s.lodBeginTransition=r.bool();break;case 5:s.lodEndTransition=r.bool();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.zoomRange!==undefined){if(!Array.isArray(t.zoomRange))return"zoomRange: array expected";for(var r=0;r<t.zoomRange.length;++r){var n=o[0].verify(t.zoomRange[r]);if(n)return"zoomRange."+n}}if(t.preserveTextLevel!==undefined)if(!i.isInteger(t.preserveTextLevel))return"preserveTextLevel: integer expected";if(t.lodBeginTransition!==undefined)if(typeof t.lodBeginTransition!=="boolean")return"lodBeginTransition: boolean expected";if(t.lodEndTransition!==undefined)if(typeof t.lodEndTransition!=="boolean")return"lodEndTransition: boolean expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.LayerProto)return t;var r=new a.keyhole.dbroot.LayerProto;if(t.zoomRange){if(!Array.isArray(t.zoomRange))throw TypeError(".keyhole.dbroot.LayerProto.zoomRange: array expected");r.zoomRange=[];for(var i=0;i<t.zoomRange.length;++i){if(typeof t.zoomRange[i]!=="object")throw TypeError(".keyhole.dbroot.LayerProto.zoomRange: object expected");r.zoomRange[i]=o[0].fromObject(t.zoomRange[i])}}if(t.preserveTextLevel!==undefined&&t.preserveTextLevel!==null)r.preserveTextLevel=t.preserveTextLevel|0;if(t.lodBeginTransition!==undefined&&t.lodBeginTransition!==null)r.lodBeginTransition=Boolean(t.lodBeginTransition);if(t.lodEndTransition!==undefined&&t.lodEndTransition!==null)r.lodEndTransition=Boolean(t.lodEndTransition);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults)i.zoomRange=[];if(r.defaults){i.preserveTextLevel=30;i.lodBeginTransition=false;i.lodEndTransition=false}if(t.zoomRange!==undefined&&t.zoomRange!==null&&t.hasOwnProperty("zoomRange")){i.zoomRange=[];for(var n=0;n<t.zoomRange.length;++n)i.zoomRange[n]=o[0].toObject(t.zoomRange[n],r)}if(t.preserveTextLevel!==undefined&&t.preserveTextLevel!==null&&t.hasOwnProperty("preserveTextLevel"))i.preserveTextLevel=t.preserveTextLevel;if(t.lodBeginTransition!==undefined&&t.lodBeginTransition!==null&&t.hasOwnProperty("lodBeginTransition"))i.lodBeginTransition=t.lodBeginTransition;if(t.lodEndTransition!==undefined&&t.lodEndTransition!==null&&t.hasOwnProperty("lodEndTransition"))i.lodEndTransition=t.lodEndTransition;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.FolderProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.isExpandable=true;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.FolderProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.isExpandable=r.bool();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.isExpandable!==undefined)if(typeof t.isExpandable!=="boolean")return"isExpandable: boolean expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.FolderProto)return t;var r=new a.keyhole.dbroot.FolderProto;if(t.isExpandable!==undefined&&t.isExpandable!==null)r.isExpandable=Boolean(t.isExpandable);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults)i.isExpandable=true;if(t.isExpandable!==undefined&&t.isExpandable!==null&&t.hasOwnProperty("isExpandable"))i.isExpandable=t.isExpandable;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.RequirementProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.requiredVram="";r.prototype.requiredClientVer="";r.prototype.probability="";r.prototype.requiredUserAgent="";r.prototype.requiredClientCapabilities="";r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.RequirementProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 3:o.requiredVram=r.string();break;case 4:o.requiredClientVer=r.string();break;case 5:o.probability=r.string();break;case 6:o.requiredUserAgent=r.string();break;case 7:o.requiredClientCapabilities=r.string();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.requiredVram!==undefined)if(!i.isString(t.requiredVram))return"requiredVram: string expected";if(t.requiredClientVer!==undefined)if(!i.isString(t.requiredClientVer))return"requiredClientVer: string expected";if(t.probability!==undefined)if(!i.isString(t.probability))return"probability: string expected";if(t.requiredUserAgent!==undefined)if(!i.isString(t.requiredUserAgent))return"requiredUserAgent: string expected";if(t.requiredClientCapabilities!==undefined)if(!i.isString(t.requiredClientCapabilities))return"requiredClientCapabilities: string expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.RequirementProto)return t;var r=new a.keyhole.dbroot.RequirementProto;if(t.requiredVram!==undefined&&t.requiredVram!==null)r.requiredVram=String(t.requiredVram);if(t.requiredClientVer!==undefined&&t.requiredClientVer!==null)r.requiredClientVer=String(t.requiredClientVer);if(t.probability!==undefined&&t.probability!==null)r.probability=String(t.probability);if(t.requiredUserAgent!==undefined&&t.requiredUserAgent!==null)r.requiredUserAgent=String(t.requiredUserAgent);if(t.requiredClientCapabilities!==undefined&&t.requiredClientCapabilities!==null)r.requiredClientCapabilities=String(t.requiredClientCapabilities);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.requiredVram="";i.requiredClientVer="";i.probability="";i.requiredUserAgent="";i.requiredClientCapabilities=""}if(t.requiredVram!==undefined&&t.requiredVram!==null&&t.hasOwnProperty("requiredVram"))i.requiredVram=t.requiredVram;if(t.requiredClientVer!==undefined&&t.requiredClientVer!==null&&t.hasOwnProperty("requiredClientVer"))i.requiredClientVer=t.requiredClientVer;if(t.probability!==undefined&&t.probability!==null&&t.hasOwnProperty("probability"))i.probability=t.probability;if(t.requiredUserAgent!==undefined&&t.requiredUserAgent!==null&&t.hasOwnProperty("requiredUserAgent"))i.requiredUserAgent=t.requiredUserAgent;if(t.requiredClientCapabilities!==undefined&&t.requiredClientCapabilities!==null&&t.hasOwnProperty("requiredClientCapabilities"))i.requiredClientCapabilities=t.requiredClientCapabilities;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.LookAtProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.longitude=0;r.prototype.latitude=0;r.prototype.range=0;r.prototype.tilt=0;r.prototype.heading=0;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.LookAtProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.longitude=r.float();break;case 2:o.latitude=r.float();break;case 3:o.range=r.float();break;case 4:o.tilt=r.float();break;case 5:o.heading=r.float();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(typeof t.longitude!=="number")return"longitude: number expected";if(typeof t.latitude!=="number")return"latitude: number expected";if(t.range!==undefined)if(typeof t.range!=="number")return"range: number expected";if(t.tilt!==undefined)if(typeof t.tilt!=="number")return"tilt: number expected";if(t.heading!==undefined)if(typeof t.heading!=="number")return"heading: number expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.LookAtProto)return t;var r=new a.keyhole.dbroot.LookAtProto;if(t.longitude!==undefined&&t.longitude!==null)r.longitude=Number(t.longitude);if(t.latitude!==undefined&&t.latitude!==null)r.latitude=Number(t.latitude);if(t.range!==undefined&&t.range!==null)r.range=Number(t.range);if(t.tilt!==undefined&&t.tilt!==null)r.tilt=Number(t.tilt);if(t.heading!==undefined&&t.heading!==null)r.heading=Number(t.heading);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.longitude=0;i.latitude=0;i.range=0;i.tilt=0;i.heading=0}if(t.longitude!==undefined&&t.longitude!==null&&t.hasOwnProperty("longitude"))i.longitude=t.longitude;if(t.latitude!==undefined&&t.latitude!==null&&t.hasOwnProperty("latitude"))i.latitude=t.latitude;if(t.range!==undefined&&t.range!==null&&t.hasOwnProperty("range"))i.range=t.range;if(t.tilt!==undefined&&t.tilt!==null&&t.hasOwnProperty("tilt"))i.tilt=t.tilt;if(t.heading!==undefined&&t.heading!==null&&t.hasOwnProperty("heading"))i.heading=t.heading;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.NestedFeatureProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.featureType=1;r.prototype.kmlUrl=null;r.prototype.databaseUrl="";r.prototype.layer=null;r.prototype.folder=null;r.prototype.requirement=null;r.prototype.channelId=0;r.prototype.displayName=null;r.prototype.isVisible=true;r.prototype.isEnabled=true;r.prototype.isChecked=false;r.prototype.layerMenuIconPath="icons/773_l.png";r.prototype.description=null;r.prototype.lookAt=null;r.prototype.assetUuid="";r.prototype.isSaveLocked=true;r.prototype.children=i.emptyArray;r.prototype.clientConfigScriptName="";r.prototype.dioramaDataChannelBase=-1;r.prototype.replicaDataChannelBase=-1;var o={0:"keyhole.dbroot.NestedFeatureProto.FeatureType",1:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.LayerProto",4:"keyhole.dbroot.FolderProto",5:"keyhole.dbroot.RequirementProto",7:"keyhole.dbroot.StringIdOrValueProto",12:"keyhole.dbroot.StringIdOrValueProto",13:"keyhole.dbroot.LookAtProto",16:"keyhole.dbroot.NestedFeatureProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.NestedFeatureProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.featureType=r.uint32();break;case 2:s.kmlUrl=o[1].decode(r,r.uint32());break;case 21:s.databaseUrl=r.string();break;case 3:s.layer=o[3].decode(r,r.uint32());break;case 4:s.folder=o[4].decode(r,r.uint32());break;case 5:s.requirement=o[5].decode(r,r.uint32());break;case 6:s.channelId=r.int32();break;case 7:s.displayName=o[7].decode(r,r.uint32());break;case 8:s.isVisible=r.bool();break;case 9:s.isEnabled=r.bool();break;case 10:s.isChecked=r.bool();break;case 11:s.layerMenuIconPath=r.string();break;case 12:s.description=o[12].decode(r,r.uint32());break;case 13:s.lookAt=o[13].decode(r,r.uint32());break;case 15:s.assetUuid=r.string();break;case 16:s.isSaveLocked=r.bool();break;case 17:if(!(s.children&&s.children.length))s.children=[];s.children.push(o[16].decode(r,r.uint32()));break;case 18:s.clientConfigScriptName=r.string();break;case 19:s.dioramaDataChannelBase=r.int32();break;case 20:s.replicaDataChannelBase=r.int32();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.featureType!==undefined)switch(t.featureType){default:return"featureType: enum value expected";case 1:case 2:case 3:case 4:break}if(t.kmlUrl!==undefined&&t.kmlUrl!==null){var r=o[1].verify(t.kmlUrl);if(r)return"kmlUrl."+r}if(t.databaseUrl!==undefined)if(!i.isString(t.databaseUrl))return"databaseUrl: string expected";if(t.layer!==undefined&&t.layer!==null){var r=o[3].verify(t.layer);if(r)return"layer."+r}if(t.folder!==undefined&&t.folder!==null){var r=o[4].verify(t.folder);if(r)return"folder."+r}if(t.requirement!==undefined&&t.requirement!==null){var r=o[5].verify(t.requirement);if(r)return"requirement."+r}if(!i.isInteger(t.channelId))return"channelId: integer expected";if(t.displayName!==undefined&&t.displayName!==null){var r=o[7].verify(t.displayName);if(r)return"displayName."+r}if(t.isVisible!==undefined)if(typeof t.isVisible!=="boolean")return"isVisible: boolean expected";if(t.isEnabled!==undefined)if(typeof t.isEnabled!=="boolean")return"isEnabled: boolean expected";if(t.isChecked!==undefined)if(typeof t.isChecked!=="boolean")return"isChecked: boolean expected";if(t.layerMenuIconPath!==undefined)if(!i.isString(t.layerMenuIconPath))return"layerMenuIconPath: string expected";if(t.description!==undefined&&t.description!==null){var r=o[12].verify(t.description);if(r)return"description."+r}if(t.lookAt!==undefined&&t.lookAt!==null){var r=o[13].verify(t.lookAt);if(r)return"lookAt."+r}if(t.assetUuid!==undefined)if(!i.isString(t.assetUuid))return"assetUuid: string expected";if(t.isSaveLocked!==undefined)if(typeof t.isSaveLocked!=="boolean")return"isSaveLocked: boolean expected";if(t.children!==undefined){if(!Array.isArray(t.children))return"children: array expected";for(var n=0;n<t.children.length;++n){var r=o[16].verify(t.children[n]);if(r)return"children."+r}}if(t.clientConfigScriptName!==undefined)if(!i.isString(t.clientConfigScriptName))return"clientConfigScriptName: string expected";if(t.dioramaDataChannelBase!==undefined)if(!i.isInteger(t.dioramaDataChannelBase))return"dioramaDataChannelBase: integer expected";if(t.replicaDataChannelBase!==undefined)if(!i.isInteger(t.replicaDataChannelBase))return"replicaDataChannelBase: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.NestedFeatureProto)return t;var r=new a.keyhole.dbroot.NestedFeatureProto;switch(t.featureType){case"TYPE_POINT_Z":case 1:r.featureType=1;break;case"TYPE_POLYGON_Z":case 2:r.featureType=2;break;case"TYPE_LINE_Z":case 3:r.featureType=3;break;case"TYPE_TERRAIN":case 4:r.featureType=4;break}if(t.kmlUrl!==undefined&&t.kmlUrl!==null){if(typeof t.kmlUrl!=="object")throw TypeError(".keyhole.dbroot.NestedFeatureProto.kmlUrl: object expected");r.kmlUrl=o[1].fromObject(t.kmlUrl)}if(t.databaseUrl!==undefined&&t.databaseUrl!==null)r.databaseUrl=String(t.databaseUrl);if(t.layer!==undefined&&t.layer!==null){if(typeof t.layer!=="object")throw TypeError(".keyhole.dbroot.NestedFeatureProto.layer: object expected");r.layer=o[3].fromObject(t.layer)}if(t.folder!==undefined&&t.folder!==null){if(typeof t.folder!=="object")throw TypeError(".keyhole.dbroot.NestedFeatureProto.folder: object expected");r.folder=o[4].fromObject(t.folder)}if(t.requirement!==undefined&&t.requirement!==null){if(typeof t.requirement!=="object")throw TypeError(".keyhole.dbroot.NestedFeatureProto.requirement: object expected");r.requirement=o[5].fromObject(t.requirement)}if(t.channelId!==undefined&&t.channelId!==null)r.channelId=t.channelId|0;if(t.displayName!==undefined&&t.displayName!==null){if(typeof t.displayName!=="object")throw TypeError(".keyhole.dbroot.NestedFeatureProto.displayName: object expected");r.displayName=o[7].fromObject(t.displayName)}if(t.isVisible!==undefined&&t.isVisible!==null)r.isVisible=Boolean(t.isVisible);if(t.isEnabled!==undefined&&t.isEnabled!==null)r.isEnabled=Boolean(t.isEnabled);if(t.isChecked!==undefined&&t.isChecked!==null)r.isChecked=Boolean(t.isChecked);if(t.layerMenuIconPath!==undefined&&t.layerMenuIconPath!==null)r.layerMenuIconPath=String(t.layerMenuIconPath);if(t.description!==undefined&&t.description!==null){if(typeof t.description!=="object")throw TypeError(".keyhole.dbroot.NestedFeatureProto.description: object expected");r.description=o[12].fromObject(t.description)}if(t.lookAt!==undefined&&t.lookAt!==null){if(typeof t.lookAt!=="object")throw TypeError(".keyhole.dbroot.NestedFeatureProto.lookAt: object expected");r.lookAt=o[13].fromObject(t.lookAt)}if(t.assetUuid!==undefined&&t.assetUuid!==null)r.assetUuid=String(t.assetUuid);if(t.isSaveLocked!==undefined&&t.isSaveLocked!==null)r.isSaveLocked=Boolean(t.isSaveLocked);if(t.children){if(!Array.isArray(t.children))throw TypeError(".keyhole.dbroot.NestedFeatureProto.children: array expected");r.children=[];for(var i=0;i<t.children.length;++i){if(typeof t.children[i]!=="object")throw TypeError(".keyhole.dbroot.NestedFeatureProto.children: object expected");r.children[i]=o[16].fromObject(t.children[i])}}if(t.clientConfigScriptName!==undefined&&t.clientConfigScriptName!==null)r.clientConfigScriptName=String(t.clientConfigScriptName);if(t.dioramaDataChannelBase!==undefined&&t.dioramaDataChannelBase!==null)r.dioramaDataChannelBase=t.dioramaDataChannelBase|0;if(t.replicaDataChannelBase!==undefined&&t.replicaDataChannelBase!==null)r.replicaDataChannelBase=t.replicaDataChannelBase|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults)i.children=[];if(r.defaults){i.featureType=r.enums===String?"TYPE_POINT_Z":1;i.kmlUrl=null;i.databaseUrl="";i.layer=null;i.folder=null;i.requirement=null;i.channelId=0;i.displayName=null;i.isVisible=true;i.isEnabled=true;i.isChecked=false;i.layerMenuIconPath="icons/773_l.png";i.description=null;i.lookAt=null;i.assetUuid="";i.isSaveLocked=true;i.clientConfigScriptName="";i.dioramaDataChannelBase=-1;i.replicaDataChannelBase=-1}if(t.featureType!==undefined&&t.featureType!==null&&t.hasOwnProperty("featureType"))i.featureType=r.enums===String?o[0][t.featureType]:t.featureType;if(t.kmlUrl!==undefined&&t.kmlUrl!==null&&t.hasOwnProperty("kmlUrl"))i.kmlUrl=o[1].toObject(t.kmlUrl,r);if(t.databaseUrl!==undefined&&t.databaseUrl!==null&&t.hasOwnProperty("databaseUrl"))i.databaseUrl=t.databaseUrl;if(t.layer!==undefined&&t.layer!==null&&t.hasOwnProperty("layer"))i.layer=o[3].toObject(t.layer,r);if(t.folder!==undefined&&t.folder!==null&&t.hasOwnProperty("folder"))i.folder=o[4].toObject(t.folder,r);if(t.requirement!==undefined&&t.requirement!==null&&t.hasOwnProperty("requirement"))i.requirement=o[5].toObject(t.requirement,r);if(t.channelId!==undefined&&t.channelId!==null&&t.hasOwnProperty("channelId"))i.channelId=t.channelId;if(t.displayName!==undefined&&t.displayName!==null&&t.hasOwnProperty("displayName"))i.displayName=o[7].toObject(t.displayName,r);if(t.isVisible!==undefined&&t.isVisible!==null&&t.hasOwnProperty("isVisible"))i.isVisible=t.isVisible;if(t.isEnabled!==undefined&&t.isEnabled!==null&&t.hasOwnProperty("isEnabled"))i.isEnabled=t.isEnabled;if(t.isChecked!==undefined&&t.isChecked!==null&&t.hasOwnProperty("isChecked"))i.isChecked=t.isChecked;if(t.layerMenuIconPath!==undefined&&t.layerMenuIconPath!==null&&t.hasOwnProperty("layerMenuIconPath"))i.layerMenuIconPath=t.layerMenuIconPath;if(t.description!==undefined&&t.description!==null&&t.hasOwnProperty("description"))i.description=o[12].toObject(t.description,r);if(t.lookAt!==undefined&&t.lookAt!==null&&t.hasOwnProperty("lookAt"))i.lookAt=o[13].toObject(t.lookAt,r);if(t.assetUuid!==undefined&&t.assetUuid!==null&&t.hasOwnProperty("assetUuid"))i.assetUuid=t.assetUuid;if(t.isSaveLocked!==undefined&&t.isSaveLocked!==null&&t.hasOwnProperty("isSaveLocked"))i.isSaveLocked=t.isSaveLocked;if(t.children!==undefined&&t.children!==null&&t.hasOwnProperty("children")){i.children=[];for(var n=0;n<t.children.length;++n)i.children[n]=o[16].toObject(t.children[n],r)}if(t.clientConfigScriptName!==undefined&&t.clientConfigScriptName!==null&&t.hasOwnProperty("clientConfigScriptName"))i.clientConfigScriptName=t.clientConfigScriptName;if(t.dioramaDataChannelBase!==undefined&&t.dioramaDataChannelBase!==null&&t.hasOwnProperty("dioramaDataChannelBase"))i.dioramaDataChannelBase=t.dioramaDataChannelBase;if(t.replicaDataChannelBase!==undefined&&t.replicaDataChannelBase!==null&&t.hasOwnProperty("replicaDataChannelBase"))i.replicaDataChannelBase=t.replicaDataChannelBase;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.FeatureType=function(){var e={},t=Object.create(e);t["TYPE_POINT_Z"]=1;t["TYPE_POLYGON_Z"]=2;t["TYPE_LINE_Z"]=3;t["TYPE_TERRAIN"]=4;return t}();return r}();r.MfeDomainFeaturesProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.countryCode="";r.prototype.domainName="";r.prototype.supportedFeatures=i.emptyArray;var o={2:"keyhole.dbroot.MfeDomainFeaturesProto.SupportedFeature"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.MfeDomainFeaturesProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.countryCode=r.string();break;case 2:o.domainName=r.string();break;case 3:if(!(o.supportedFeatures&&o.supportedFeatures.length))o.supportedFeatures=[];if((s&7)===2){var l=r.uint32()+r.pos;while(r.pos<l)o.supportedFeatures.push(r.uint32())}else o.supportedFeatures.push(r.uint32());break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isString(t.countryCode))return"countryCode: string expected";if(!i.isString(t.domainName))return"domainName: string expected";if(t.supportedFeatures!==undefined){if(!Array.isArray(t.supportedFeatures))return"supportedFeatures: array expected";for(var r=0;r<t.supportedFeatures.length;++r)switch(t.supportedFeatures[r]){default:return"supportedFeatures: enum value[] expected";case 0:case 1:case 2:break}}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.MfeDomainFeaturesProto)return t;var r=new a.keyhole.dbroot.MfeDomainFeaturesProto;if(t.countryCode!==undefined&&t.countryCode!==null)r.countryCode=String(t.countryCode);if(t.domainName!==undefined&&t.domainName!==null)r.domainName=String(t.domainName);if(t.supportedFeatures){if(!Array.isArray(t.supportedFeatures))throw TypeError(".keyhole.dbroot.MfeDomainFeaturesProto.supportedFeatures: array expected");r.supportedFeatures=[];for(var i=0;i<t.supportedFeatures.length;++i)switch(t.supportedFeatures[i]){default:case"GEOCODING":case 0:r.supportedFeatures[i]=0;break;case"LOCAL_SEARCH":case 1:r.supportedFeatures[i]=1;break;case"DRIVING_DIRECTIONS":case 2:r.supportedFeatures[i]=2;break}}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults)i.supportedFeatures=[];if(r.defaults){i.countryCode="";i.domainName=""}if(t.countryCode!==undefined&&t.countryCode!==null&&t.hasOwnProperty("countryCode"))i.countryCode=t.countryCode;if(t.domainName!==undefined&&t.domainName!==null&&t.hasOwnProperty("domainName"))i.domainName=t.domainName;if(t.supportedFeatures!==undefined&&t.supportedFeatures!==null&&t.hasOwnProperty("supportedFeatures")){i.supportedFeatures=[];for(var n=0;n<t.supportedFeatures.length;++n)i.supportedFeatures[n]=r.enums===String?o[2][t.supportedFeatures[n]]:t.supportedFeatures[n]}return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.SupportedFeature=function(){var e={},t=Object.create(e);t["GEOCODING"]=0;t["LOCAL_SEARCH"]=1;t["DRIVING_DIRECTIONS"]=2;return t}();return r}();r.ClientOptionsProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.disableDiskCache=false;r.prototype.disableEmbeddedBrowserVista=false;r.prototype.drawAtmosphere=true;r.prototype.drawStars=true;r.prototype.shaderFilePrefix="";r.prototype.useProtobufQuadtreePackets=false;r.prototype.useExtendedCopyrightIds=true;r.prototype.precipitationsOptions=null;r.prototype.captureOptions=null;r.prototype.show_2dMapsIcon=true;r.prototype.disableInternalBrowser=false;r.prototype.internalBrowserBlacklist="";r.prototype.internalBrowserOriginWhitelist="*";r.prototype.polarTileMergingLevel=0;r.prototype.jsBridgeRequestWhitelist="http://*.google.com/*";r.prototype.mapsOptions=null;var o={7:"keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions",8:"keyhole.dbroot.ClientOptionsProto.CaptureOptions",15:"keyhole.dbroot.ClientOptionsProto.MapsOptions"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.ClientOptionsProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.disableDiskCache=r.bool();break;case 2:s.disableEmbeddedBrowserVista=r.bool();break;case 3:s.drawAtmosphere=r.bool();break;case 4:s.drawStars=r.bool();break;case 5:s.shaderFilePrefix=r.string();break;case 6:s.useProtobufQuadtreePackets=r.bool();break;case 7:s.useExtendedCopyrightIds=r.bool();break;case 8:s.precipitationsOptions=o[7].decode(r,r.uint32());break;case 9:s.captureOptions=o[8].decode(r,r.uint32());break;case 10:s.show_2dMapsIcon=r.bool();break;case 11:s.disableInternalBrowser=r.bool();break;case 12:s.internalBrowserBlacklist=r.string();break;case 13:s.internalBrowserOriginWhitelist=r.string();break;case 14:s.polarTileMergingLevel=r.int32();break;case 15:s.jsBridgeRequestWhitelist=r.string();break;case 16:s.mapsOptions=o[15].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.disableDiskCache!==undefined)if(typeof t.disableDiskCache!=="boolean")return"disableDiskCache: boolean expected";if(t.disableEmbeddedBrowserVista!==undefined)if(typeof t.disableEmbeddedBrowserVista!=="boolean")return"disableEmbeddedBrowserVista: boolean expected";if(t.drawAtmosphere!==undefined)if(typeof t.drawAtmosphere!=="boolean")return"drawAtmosphere: boolean expected";if(t.drawStars!==undefined)if(typeof t.drawStars!=="boolean")return"drawStars: boolean expected";if(t.shaderFilePrefix!==undefined)if(!i.isString(t.shaderFilePrefix))return"shaderFilePrefix: string expected";if(t.useProtobufQuadtreePackets!==undefined)if(typeof t.useProtobufQuadtreePackets!=="boolean")return"useProtobufQuadtreePackets: boolean expected";if(t.useExtendedCopyrightIds!==undefined)if(typeof t.useExtendedCopyrightIds!=="boolean")return"useExtendedCopyrightIds: boolean expected";if(t.precipitationsOptions!==undefined&&t.precipitationsOptions!==null){var r=o[7].verify(t.precipitationsOptions);if(r)return"precipitationsOptions."+r}if(t.captureOptions!==undefined&&t.captureOptions!==null){var r=o[8].verify(t.captureOptions);if(r)return"captureOptions."+r}if(t.show_2dMapsIcon!==undefined)if(typeof t.show_2dMapsIcon!=="boolean")return"show_2dMapsIcon: boolean expected";if(t.disableInternalBrowser!==undefined)if(typeof t.disableInternalBrowser!=="boolean")return"disableInternalBrowser: boolean expected";if(t.internalBrowserBlacklist!==undefined)if(!i.isString(t.internalBrowserBlacklist))return"internalBrowserBlacklist: string expected";if(t.internalBrowserOriginWhitelist!==undefined)if(!i.isString(t.internalBrowserOriginWhitelist))return"internalBrowserOriginWhitelist: string expected";if(t.polarTileMergingLevel!==undefined)if(!i.isInteger(t.polarTileMergingLevel))return"polarTileMergingLevel: integer expected";if(t.jsBridgeRequestWhitelist!==undefined)if(!i.isString(t.jsBridgeRequestWhitelist))return"jsBridgeRequestWhitelist: string expected";if(t.mapsOptions!==undefined&&t.mapsOptions!==null){var r=o[15].verify(t.mapsOptions);if(r)return"mapsOptions."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.ClientOptionsProto)return t;var r=new a.keyhole.dbroot.ClientOptionsProto;if(t.disableDiskCache!==undefined&&t.disableDiskCache!==null)r.disableDiskCache=Boolean(t.disableDiskCache);if(t.disableEmbeddedBrowserVista!==undefined&&t.disableEmbeddedBrowserVista!==null)r.disableEmbeddedBrowserVista=Boolean(t.disableEmbeddedBrowserVista);if(t.drawAtmosphere!==undefined&&t.drawAtmosphere!==null)r.drawAtmosphere=Boolean(t.drawAtmosphere);if(t.drawStars!==undefined&&t.drawStars!==null)r.drawStars=Boolean(t.drawStars);if(t.shaderFilePrefix!==undefined&&t.shaderFilePrefix!==null)r.shaderFilePrefix=String(t.shaderFilePrefix);if(t.useProtobufQuadtreePackets!==undefined&&t.useProtobufQuadtreePackets!==null)r.useProtobufQuadtreePackets=Boolean(t.useProtobufQuadtreePackets);if(t.useExtendedCopyrightIds!==undefined&&t.useExtendedCopyrightIds!==null)r.useExtendedCopyrightIds=Boolean(t.useExtendedCopyrightIds);if(t.precipitationsOptions!==undefined&&t.precipitationsOptions!==null){if(typeof t.precipitationsOptions!=="object")throw TypeError(".keyhole.dbroot.ClientOptionsProto.precipitationsOptions: object expected");r.precipitationsOptions=o[7].fromObject(t.precipitationsOptions)}if(t.captureOptions!==undefined&&t.captureOptions!==null){if(typeof t.captureOptions!=="object")throw TypeError(".keyhole.dbroot.ClientOptionsProto.captureOptions: object expected");r.captureOptions=o[8].fromObject(t.captureOptions)}if(t.show_2dMapsIcon!==undefined&&t.show_2dMapsIcon!==null)r.show_2dMapsIcon=Boolean(t.show_2dMapsIcon);if(t.disableInternalBrowser!==undefined&&t.disableInternalBrowser!==null)r.disableInternalBrowser=Boolean(t.disableInternalBrowser);if(t.internalBrowserBlacklist!==undefined&&t.internalBrowserBlacklist!==null)r.internalBrowserBlacklist=String(t.internalBrowserBlacklist);if(t.internalBrowserOriginWhitelist!==undefined&&t.internalBrowserOriginWhitelist!==null)r.internalBrowserOriginWhitelist=String(t.internalBrowserOriginWhitelist);if(t.polarTileMergingLevel!==undefined&&t.polarTileMergingLevel!==null)r.polarTileMergingLevel=t.polarTileMergingLevel|0;if(t.jsBridgeRequestWhitelist!==undefined&&t.jsBridgeRequestWhitelist!==null)r.jsBridgeRequestWhitelist=String(t.jsBridgeRequestWhitelist);if(t.mapsOptions!==undefined&&t.mapsOptions!==null){if(typeof t.mapsOptions!=="object")throw TypeError(".keyhole.dbroot.ClientOptionsProto.mapsOptions: object expected");r.mapsOptions=o[15].fromObject(t.mapsOptions)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.disableDiskCache=false;i.disableEmbeddedBrowserVista=false;i.drawAtmosphere=true;i.drawStars=true;i.shaderFilePrefix="";i.useProtobufQuadtreePackets=false;i.useExtendedCopyrightIds=true;i.precipitationsOptions=null;i.captureOptions=null;i.show_2dMapsIcon=true;i.disableInternalBrowser=false;i.internalBrowserBlacklist="";i.internalBrowserOriginWhitelist="*";i.polarTileMergingLevel=0;i.jsBridgeRequestWhitelist="http://*.google.com/*";i.mapsOptions=null}if(t.disableDiskCache!==undefined&&t.disableDiskCache!==null&&t.hasOwnProperty("disableDiskCache"))i.disableDiskCache=t.disableDiskCache;if(t.disableEmbeddedBrowserVista!==undefined&&t.disableEmbeddedBrowserVista!==null&&t.hasOwnProperty("disableEmbeddedBrowserVista"))i.disableEmbeddedBrowserVista=t.disableEmbeddedBrowserVista;if(t.drawAtmosphere!==undefined&&t.drawAtmosphere!==null&&t.hasOwnProperty("drawAtmosphere"))i.drawAtmosphere=t.drawAtmosphere;if(t.drawStars!==undefined&&t.drawStars!==null&&t.hasOwnProperty("drawStars"))i.drawStars=t.drawStars;if(t.shaderFilePrefix!==undefined&&t.shaderFilePrefix!==null&&t.hasOwnProperty("shaderFilePrefix"))i.shaderFilePrefix=t.shaderFilePrefix;if(t.useProtobufQuadtreePackets!==undefined&&t.useProtobufQuadtreePackets!==null&&t.hasOwnProperty("useProtobufQuadtreePackets"))i.useProtobufQuadtreePackets=t.useProtobufQuadtreePackets;if(t.useExtendedCopyrightIds!==undefined&&t.useExtendedCopyrightIds!==null&&t.hasOwnProperty("useExtendedCopyrightIds"))i.useExtendedCopyrightIds=t.useExtendedCopyrightIds;if(t.precipitationsOptions!==undefined&&t.precipitationsOptions!==null&&t.hasOwnProperty("precipitationsOptions"))i.precipitationsOptions=o[7].toObject(t.precipitationsOptions,r);if(t.captureOptions!==undefined&&t.captureOptions!==null&&t.hasOwnProperty("captureOptions"))i.captureOptions=o[8].toObject(t.captureOptions,r);if(t.show_2dMapsIcon!==undefined&&t.show_2dMapsIcon!==null&&t.hasOwnProperty("show_2dMapsIcon"))i.show_2dMapsIcon=t.show_2dMapsIcon;if(t.disableInternalBrowser!==undefined&&t.disableInternalBrowser!==null&&t.hasOwnProperty("disableInternalBrowser"))i.disableInternalBrowser=t.disableInternalBrowser;if(t.internalBrowserBlacklist!==undefined&&t.internalBrowserBlacklist!==null&&t.hasOwnProperty("internalBrowserBlacklist"))i.internalBrowserBlacklist=t.internalBrowserBlacklist;if(t.internalBrowserOriginWhitelist!==undefined&&t.internalBrowserOriginWhitelist!==null&&t.hasOwnProperty("internalBrowserOriginWhitelist"))i.internalBrowserOriginWhitelist=t.internalBrowserOriginWhitelist;if(t.polarTileMergingLevel!==undefined&&t.polarTileMergingLevel!==null&&t.hasOwnProperty("polarTileMergingLevel"))i.polarTileMergingLevel=t.polarTileMergingLevel;if(t.jsBridgeRequestWhitelist!==undefined&&t.jsBridgeRequestWhitelist!==null&&t.hasOwnProperty("jsBridgeRequestWhitelist"))i.jsBridgeRequestWhitelist=t.jsBridgeRequestWhitelist;if(t.mapsOptions!==undefined&&t.mapsOptions!==null&&t.hasOwnProperty("mapsOptions"))i.mapsOptions=o[15].toObject(t.mapsOptions,r);return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.PrecipitationsOptions=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.imageUrl="";r.prototype.imageExpireTime=900;r.prototype.maxColorDistance=20;r.prototype.imageLevel=5;r.prototype.weatherMapping=i.emptyArray;r.prototype.cloudsLayerUrl="";r.prototype.animationDecelerationDelay=20;var o={4:"keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.imageUrl=r.string();break;case 2:s.imageExpireTime=r.int32();break;case 3:s.maxColorDistance=r.int32();break;case 4:s.imageLevel=r.int32();break;case 5:if(!(s.weatherMapping&&s.weatherMapping.length))s.weatherMapping=[];s.weatherMapping.push(o[4].decode(r,r.uint32()));break;case 6:s.cloudsLayerUrl=r.string();break;case 7:s.animationDecelerationDelay=r.float();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.imageUrl!==undefined)if(!i.isString(t.imageUrl))return"imageUrl: string expected";if(t.imageExpireTime!==undefined)if(!i.isInteger(t.imageExpireTime))return"imageExpireTime: integer expected";if(t.maxColorDistance!==undefined)if(!i.isInteger(t.maxColorDistance))return"maxColorDistance: integer expected";if(t.imageLevel!==undefined)if(!i.isInteger(t.imageLevel))return"imageLevel: integer expected";if(t.weatherMapping!==undefined){if(!Array.isArray(t.weatherMapping))return"weatherMapping: array expected";for(var r=0;r<t.weatherMapping.length;++r){var n=o[4].verify(t.weatherMapping[r]);if(n)return"weatherMapping."+n}}if(t.cloudsLayerUrl!==undefined)if(!i.isString(t.cloudsLayerUrl))return"cloudsLayerUrl: string expected";if(t.animationDecelerationDelay!==undefined)if(typeof t.animationDecelerationDelay!=="number")return"animationDecelerationDelay: number expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions)return t;var r=new a.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions;if(t.imageUrl!==undefined&&t.imageUrl!==null)r.imageUrl=String(t.imageUrl);if(t.imageExpireTime!==undefined&&t.imageExpireTime!==null)r.imageExpireTime=t.imageExpireTime|0;if(t.maxColorDistance!==undefined&&t.maxColorDistance!==null)r.maxColorDistance=t.maxColorDistance|0;if(t.imageLevel!==undefined&&t.imageLevel!==null)r.imageLevel=t.imageLevel|0;if(t.weatherMapping){if(!Array.isArray(t.weatherMapping))throw TypeError(".keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.weatherMapping: array expected");r.weatherMapping=[];for(var i=0;i<t.weatherMapping.length;++i){if(typeof t.weatherMapping[i]!=="object")throw TypeError(".keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.weatherMapping: object expected");r.weatherMapping[i]=o[4].fromObject(t.weatherMapping[i])}}if(t.cloudsLayerUrl!==undefined&&t.cloudsLayerUrl!==null)r.cloudsLayerUrl=String(t.cloudsLayerUrl);if(t.animationDecelerationDelay!==undefined&&t.animationDecelerationDelay!==null)r.animationDecelerationDelay=Number(t.animationDecelerationDelay);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults)i.weatherMapping=[];if(r.defaults){i.imageUrl="";i.imageExpireTime=900;i.maxColorDistance=20;i.imageLevel=5;i.cloudsLayerUrl="";i.animationDecelerationDelay=20}if(t.imageUrl!==undefined&&t.imageUrl!==null&&t.hasOwnProperty("imageUrl"))i.imageUrl=t.imageUrl;if(t.imageExpireTime!==undefined&&t.imageExpireTime!==null&&t.hasOwnProperty("imageExpireTime"))i.imageExpireTime=t.imageExpireTime;if(t.maxColorDistance!==undefined&&t.maxColorDistance!==null&&t.hasOwnProperty("maxColorDistance"))i.maxColorDistance=t.maxColorDistance;if(t.imageLevel!==undefined&&t.imageLevel!==null&&t.hasOwnProperty("imageLevel"))i.imageLevel=t.imageLevel;if(t.weatherMapping!==undefined&&t.weatherMapping!==null&&t.hasOwnProperty("weatherMapping")){i.weatherMapping=[];for(var n=0;n<t.weatherMapping.length;++n)i.weatherMapping[n]=o[4].toObject(t.weatherMapping[n],r)}if(t.cloudsLayerUrl!==undefined&&t.cloudsLayerUrl!==null&&t.hasOwnProperty("cloudsLayerUrl"))i.cloudsLayerUrl=t.cloudsLayerUrl;if(t.animationDecelerationDelay!==undefined&&t.animationDecelerationDelay!==null&&t.hasOwnProperty("animationDecelerationDelay"))i.animationDecelerationDelay=t.animationDecelerationDelay;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.WeatherMapping=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.colorAbgr=0;r.prototype.weatherType=0;r.prototype.elongation=1;r.prototype.opacity=0;r.prototype.fogDensity=0;r.prototype.speed0=0;r.prototype.speed1=0;r.prototype.speed2=0;r.prototype.speed3=0;var o={1:"keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping.WeatherType"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.colorAbgr=r.uint32();break;case 2:o.weatherType=r.uint32();break;case 3:o.elongation=r.float();break;case 4:o.opacity=r.float();break;case 5:o.fogDensity=r.float();break;case 6:o.speed0=r.float();break;case 7:o.speed1=r.float();break;case 8:o.speed2=r.float();break;case 9:o.speed3=r.float();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isInteger(t.colorAbgr))return"colorAbgr: integer expected";switch(t.weatherType){default:return"weatherType: enum value expected";case 0:case 1:case 2:break}if(t.elongation!==undefined)if(typeof t.elongation!=="number")return"elongation: number expected";if(t.opacity!==undefined)if(typeof t.opacity!=="number")return"opacity: number expected";if(t.fogDensity!==undefined)if(typeof t.fogDensity!=="number")return"fogDensity: number expected";if(t.speed0!==undefined)if(typeof t.speed0!=="number")return"speed0: number expected";if(t.speed1!==undefined)if(typeof t.speed1!=="number")return"speed1: number expected";if(t.speed2!==undefined)if(typeof t.speed2!=="number")return"speed2: number expected";if(t.speed3!==undefined)if(typeof t.speed3!=="number")return"speed3: number expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping)return t;var r=new a.keyhole.dbroot.ClientOptionsProto.PrecipitationsOptions.WeatherMapping;if(t.colorAbgr!==undefined&&t.colorAbgr!==null)r.colorAbgr=t.colorAbgr>>>0;switch(t.weatherType){case"NO_PRECIPITATION":case 0:r.weatherType=0;break;case"RAIN":case 1:r.weatherType=1;break;case"SNOW":case 2:r.weatherType=2;break}if(t.elongation!==undefined&&t.elongation!==null)r.elongation=Number(t.elongation);if(t.opacity!==undefined&&t.opacity!==null)r.opacity=Number(t.opacity);if(t.fogDensity!==undefined&&t.fogDensity!==null)r.fogDensity=Number(t.fogDensity);if(t.speed0!==undefined&&t.speed0!==null)r.speed0=Number(t.speed0);if(t.speed1!==undefined&&t.speed1!==null)r.speed1=Number(t.speed1);if(t.speed2!==undefined&&t.speed2!==null)r.speed2=Number(t.speed2);if(t.speed3!==undefined&&t.speed3!==null)r.speed3=Number(t.speed3);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.colorAbgr=0;i.weatherType=r.enums===String?"NO_PRECIPITATION":0;i.elongation=1;i.opacity=0;i.fogDensity=0;i.speed0=0;i.speed1=0;i.speed2=0;i.speed3=0}if(t.colorAbgr!==undefined&&t.colorAbgr!==null&&t.hasOwnProperty("colorAbgr"))i.colorAbgr=t.colorAbgr;if(t.weatherType!==undefined&&t.weatherType!==null&&t.hasOwnProperty("weatherType"))i.weatherType=r.enums===String?o[1][t.weatherType]:t.weatherType;if(t.elongation!==undefined&&t.elongation!==null&&t.hasOwnProperty("elongation"))i.elongation=t.elongation;if(t.opacity!==undefined&&t.opacity!==null&&t.hasOwnProperty("opacity"))i.opacity=t.opacity;if(t.fogDensity!==undefined&&t.fogDensity!==null&&t.hasOwnProperty("fogDensity"))i.fogDensity=t.fogDensity;if(t.speed0!==undefined&&t.speed0!==null&&t.hasOwnProperty("speed0"))i.speed0=t.speed0;if(t.speed1!==undefined&&t.speed1!==null&&t.hasOwnProperty("speed1"))i.speed1=t.speed1;if(t.speed2!==undefined&&t.speed2!==null&&t.hasOwnProperty("speed2"))i.speed2=t.speed2;if(t.speed3!==undefined&&t.speed3!==null&&t.hasOwnProperty("speed3"))i.speed3=t.speed3;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.WeatherType=function(){var e={},t=Object.create(e);t["NO_PRECIPITATION"]=0;t["RAIN"]=1;t["SNOW"]=2;return t}();return r}();return r}();r.CaptureOptions=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.allowSaveAsImage=true;r.prototype.maxFreeCaptureRes=2400;r.prototype.maxPremiumCaptureRes=4800;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.ClientOptionsProto.CaptureOptions;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.allowSaveAsImage=r.bool();break;case 2:o.maxFreeCaptureRes=r.int32();break;case 3:o.maxPremiumCaptureRes=r.int32();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.allowSaveAsImage!==undefined)if(typeof t.allowSaveAsImage!=="boolean")return"allowSaveAsImage: boolean expected";if(t.maxFreeCaptureRes!==undefined)if(!i.isInteger(t.maxFreeCaptureRes))return"maxFreeCaptureRes: integer expected";if(t.maxPremiumCaptureRes!==undefined)if(!i.isInteger(t.maxPremiumCaptureRes))return"maxPremiumCaptureRes: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.ClientOptionsProto.CaptureOptions)return t;var r=new a.keyhole.dbroot.ClientOptionsProto.CaptureOptions;if(t.allowSaveAsImage!==undefined&&t.allowSaveAsImage!==null)r.allowSaveAsImage=Boolean(t.allowSaveAsImage);if(t.maxFreeCaptureRes!==undefined&&t.maxFreeCaptureRes!==null)r.maxFreeCaptureRes=t.maxFreeCaptureRes|0;if(t.maxPremiumCaptureRes!==undefined&&t.maxPremiumCaptureRes!==null)r.maxPremiumCaptureRes=t.maxPremiumCaptureRes|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.allowSaveAsImage=true;i.maxFreeCaptureRes=2400;i.maxPremiumCaptureRes=4800}if(t.allowSaveAsImage!==undefined&&t.allowSaveAsImage!==null&&t.hasOwnProperty("allowSaveAsImage"))i.allowSaveAsImage=t.allowSaveAsImage;if(t.maxFreeCaptureRes!==undefined&&t.maxFreeCaptureRes!==null&&t.hasOwnProperty("maxFreeCaptureRes"))i.maxFreeCaptureRes=t.maxFreeCaptureRes;if(t.maxPremiumCaptureRes!==undefined&&t.maxPremiumCaptureRes!==null&&t.hasOwnProperty("maxPremiumCaptureRes"))i.maxPremiumCaptureRes=t.maxPremiumCaptureRes;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.MapsOptions=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.enableMaps=false;r.prototype.docsAutoDownloadEnabled=false;r.prototype.docsAutoDownloadInterval=0;r.prototype.docsAutoUploadEnabled=false;r.prototype.docsAutoUploadDelay=0;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.ClientOptionsProto.MapsOptions;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.enableMaps=r.bool();break;case 2:o.docsAutoDownloadEnabled=r.bool();break;case 3:o.docsAutoDownloadInterval=r.int32();break;case 4:o.docsAutoUploadEnabled=r.bool();break;case 5:o.docsAutoUploadDelay=r.int32();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.enableMaps!==undefined)if(typeof t.enableMaps!=="boolean")return"enableMaps: boolean expected";if(t.docsAutoDownloadEnabled!==undefined)if(typeof t.docsAutoDownloadEnabled!=="boolean")return"docsAutoDownloadEnabled: boolean expected";if(t.docsAutoDownloadInterval!==undefined)if(!i.isInteger(t.docsAutoDownloadInterval))return"docsAutoDownloadInterval: integer expected";if(t.docsAutoUploadEnabled!==undefined)if(typeof t.docsAutoUploadEnabled!=="boolean")return"docsAutoUploadEnabled: boolean expected";if(t.docsAutoUploadDelay!==undefined)if(!i.isInteger(t.docsAutoUploadDelay))return"docsAutoUploadDelay: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.ClientOptionsProto.MapsOptions)return t;var r=new a.keyhole.dbroot.ClientOptionsProto.MapsOptions;if(t.enableMaps!==undefined&&t.enableMaps!==null)r.enableMaps=Boolean(t.enableMaps);if(t.docsAutoDownloadEnabled!==undefined&&t.docsAutoDownloadEnabled!==null)r.docsAutoDownloadEnabled=Boolean(t.docsAutoDownloadEnabled);if(t.docsAutoDownloadInterval!==undefined&&t.docsAutoDownloadInterval!==null)r.docsAutoDownloadInterval=t.docsAutoDownloadInterval|0;if(t.docsAutoUploadEnabled!==undefined&&t.docsAutoUploadEnabled!==null)r.docsAutoUploadEnabled=Boolean(t.docsAutoUploadEnabled);if(t.docsAutoUploadDelay!==undefined&&t.docsAutoUploadDelay!==null)r.docsAutoUploadDelay=t.docsAutoUploadDelay|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.enableMaps=false;i.docsAutoDownloadEnabled=false;i.docsAutoDownloadInterval=0;i.docsAutoUploadEnabled=false;i.docsAutoUploadDelay=0}if(t.enableMaps!==undefined&&t.enableMaps!==null&&t.hasOwnProperty("enableMaps"))i.enableMaps=t.enableMaps;if(t.docsAutoDownloadEnabled!==undefined&&t.docsAutoDownloadEnabled!==null&&t.hasOwnProperty("docsAutoDownloadEnabled"))i.docsAutoDownloadEnabled=t.docsAutoDownloadEnabled;if(t.docsAutoDownloadInterval!==undefined&&t.docsAutoDownloadInterval!==null&&t.hasOwnProperty("docsAutoDownloadInterval"))i.docsAutoDownloadInterval=t.docsAutoDownloadInterval;if(t.docsAutoUploadEnabled!==undefined&&t.docsAutoUploadEnabled!==null&&t.hasOwnProperty("docsAutoUploadEnabled"))i.docsAutoUploadEnabled=t.docsAutoUploadEnabled;if(t.docsAutoUploadDelay!==undefined&&t.docsAutoUploadDelay!==null&&t.hasOwnProperty("docsAutoUploadDelay"))i.docsAutoUploadDelay=t.docsAutoUploadDelay;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();return r}();r.FetchingOptionsProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.maxRequestsPerQuery=1;r.prototype.forceMaxRequestsPerQuery=false;r.prototype.sortBatches=false;r.prototype.maxDrawable=2;r.prototype.maxImagery=2;r.prototype.maxTerrain=5;r.prototype.maxQuadtree=5;r.prototype.maxDioramaMetadata=1;r.prototype.maxDioramaData=0;r.prototype.maxConsumerFetchRatio=1;r.prototype.maxProEcFetchRatio=0;r.prototype.safeOverallQps=0;r.prototype.safeImageryQps=0;r.prototype.domainsForHttps="google.com gstatic.com";r.prototype.hostsForHttp="";r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.FetchingOptionsProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.maxRequestsPerQuery=r.int32();break;case 12:o.forceMaxRequestsPerQuery=r.bool();break;case 13:o.sortBatches=r.bool();break;case 2:o.maxDrawable=r.int32();break;case 3:o.maxImagery=r.int32();break;case 4:o.maxTerrain=r.int32();break;case 5:o.maxQuadtree=r.int32();break;case 6:o.maxDioramaMetadata=r.int32();break;case 7:o.maxDioramaData=r.int32();break;case 8:o.maxConsumerFetchRatio=r.float();break;case 9:o.maxProEcFetchRatio=r.float();break;case 10:o.safeOverallQps=r.float();break;case 11:o.safeImageryQps=r.float();break;case 14:o.domainsForHttps=r.string();break;case 15:o.hostsForHttp=r.string();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.maxRequestsPerQuery!==undefined)if(!i.isInteger(t.maxRequestsPerQuery))return"maxRequestsPerQuery: integer expected";if(t.forceMaxRequestsPerQuery!==undefined)if(typeof t.forceMaxRequestsPerQuery!=="boolean")return"forceMaxRequestsPerQuery: boolean expected";if(t.sortBatches!==undefined)if(typeof t.sortBatches!=="boolean")return"sortBatches: boolean expected";if(t.maxDrawable!==undefined)if(!i.isInteger(t.maxDrawable))return"maxDrawable: integer expected";if(t.maxImagery!==undefined)if(!i.isInteger(t.maxImagery))return"maxImagery: integer expected";if(t.maxTerrain!==undefined)if(!i.isInteger(t.maxTerrain))return"maxTerrain: integer expected";if(t.maxQuadtree!==undefined)if(!i.isInteger(t.maxQuadtree))return"maxQuadtree: integer expected";if(t.maxDioramaMetadata!==undefined)if(!i.isInteger(t.maxDioramaMetadata))return"maxDioramaMetadata: integer expected";if(t.maxDioramaData!==undefined)if(!i.isInteger(t.maxDioramaData))return"maxDioramaData: integer expected";if(t.maxConsumerFetchRatio!==undefined)if(typeof t.maxConsumerFetchRatio!=="number")return"maxConsumerFetchRatio: number expected";if(t.maxProEcFetchRatio!==undefined)if(typeof t.maxProEcFetchRatio!=="number")return"maxProEcFetchRatio: number expected";if(t.safeOverallQps!==undefined)if(typeof t.safeOverallQps!=="number")return"safeOverallQps: number expected";if(t.safeImageryQps!==undefined)if(typeof t.safeImageryQps!=="number")return"safeImageryQps: number expected";if(t.domainsForHttps!==undefined)if(!i.isString(t.domainsForHttps))return"domainsForHttps: string expected";if(t.hostsForHttp!==undefined)if(!i.isString(t.hostsForHttp))return"hostsForHttp: string expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.FetchingOptionsProto)return t;var r=new a.keyhole.dbroot.FetchingOptionsProto;if(t.maxRequestsPerQuery!==undefined&&t.maxRequestsPerQuery!==null)r.maxRequestsPerQuery=t.maxRequestsPerQuery|0;if(t.forceMaxRequestsPerQuery!==undefined&&t.forceMaxRequestsPerQuery!==null)r.forceMaxRequestsPerQuery=Boolean(t.forceMaxRequestsPerQuery);if(t.sortBatches!==undefined&&t.sortBatches!==null)r.sortBatches=Boolean(t.sortBatches);if(t.maxDrawable!==undefined&&t.maxDrawable!==null)r.maxDrawable=t.maxDrawable|0;if(t.maxImagery!==undefined&&t.maxImagery!==null)r.maxImagery=t.maxImagery|0;if(t.maxTerrain!==undefined&&t.maxTerrain!==null)r.maxTerrain=t.maxTerrain|0;if(t.maxQuadtree!==undefined&&t.maxQuadtree!==null)r.maxQuadtree=t.maxQuadtree|0;if(t.maxDioramaMetadata!==undefined&&t.maxDioramaMetadata!==null)r.maxDioramaMetadata=t.maxDioramaMetadata|0;if(t.maxDioramaData!==undefined&&t.maxDioramaData!==null)r.maxDioramaData=t.maxDioramaData|0;if(t.maxConsumerFetchRatio!==undefined&&t.maxConsumerFetchRatio!==null)r.maxConsumerFetchRatio=Number(t.maxConsumerFetchRatio);if(t.maxProEcFetchRatio!==undefined&&t.maxProEcFetchRatio!==null)r.maxProEcFetchRatio=Number(t.maxProEcFetchRatio);if(t.safeOverallQps!==undefined&&t.safeOverallQps!==null)r.safeOverallQps=Number(t.safeOverallQps);if(t.safeImageryQps!==undefined&&t.safeImageryQps!==null)r.safeImageryQps=Number(t.safeImageryQps);if(t.domainsForHttps!==undefined&&t.domainsForHttps!==null)r.domainsForHttps=String(t.domainsForHttps);if(t.hostsForHttp!==undefined&&t.hostsForHttp!==null)r.hostsForHttp=String(t.hostsForHttp);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.maxRequestsPerQuery=1;i.forceMaxRequestsPerQuery=false;i.sortBatches=false;i.maxDrawable=2;i.maxImagery=2;i.maxTerrain=5;i.maxQuadtree=5;i.maxDioramaMetadata=1;i.maxDioramaData=0;i.maxConsumerFetchRatio=1;i.maxProEcFetchRatio=0;i.safeOverallQps=0;i.safeImageryQps=0;i.domainsForHttps="google.com gstatic.com";i.hostsForHttp=""}if(t.maxRequestsPerQuery!==undefined&&t.maxRequestsPerQuery!==null&&t.hasOwnProperty("maxRequestsPerQuery"))i.maxRequestsPerQuery=t.maxRequestsPerQuery;if(t.forceMaxRequestsPerQuery!==undefined&&t.forceMaxRequestsPerQuery!==null&&t.hasOwnProperty("forceMaxRequestsPerQuery"))i.forceMaxRequestsPerQuery=t.forceMaxRequestsPerQuery;if(t.sortBatches!==undefined&&t.sortBatches!==null&&t.hasOwnProperty("sortBatches"))i.sortBatches=t.sortBatches;if(t.maxDrawable!==undefined&&t.maxDrawable!==null&&t.hasOwnProperty("maxDrawable"))i.maxDrawable=t.maxDrawable;if(t.maxImagery!==undefined&&t.maxImagery!==null&&t.hasOwnProperty("maxImagery"))i.maxImagery=t.maxImagery;if(t.maxTerrain!==undefined&&t.maxTerrain!==null&&t.hasOwnProperty("maxTerrain"))i.maxTerrain=t.maxTerrain;if(t.maxQuadtree!==undefined&&t.maxQuadtree!==null&&t.hasOwnProperty("maxQuadtree"))i.maxQuadtree=t.maxQuadtree;if(t.maxDioramaMetadata!==undefined&&t.maxDioramaMetadata!==null&&t.hasOwnProperty("maxDioramaMetadata"))i.maxDioramaMetadata=t.maxDioramaMetadata;if(t.maxDioramaData!==undefined&&t.maxDioramaData!==null&&t.hasOwnProperty("maxDioramaData"))i.maxDioramaData=t.maxDioramaData;if(t.maxConsumerFetchRatio!==undefined&&t.maxConsumerFetchRatio!==null&&t.hasOwnProperty("maxConsumerFetchRatio"))i.maxConsumerFetchRatio=t.maxConsumerFetchRatio;if(t.maxProEcFetchRatio!==undefined&&t.maxProEcFetchRatio!==null&&t.hasOwnProperty("maxProEcFetchRatio"))i.maxProEcFetchRatio=t.maxProEcFetchRatio;if(t.safeOverallQps!==undefined&&t.safeOverallQps!==null&&t.hasOwnProperty("safeOverallQps"))i.safeOverallQps=t.safeOverallQps;if(t.safeImageryQps!==undefined&&t.safeImageryQps!==null&&t.hasOwnProperty("safeImageryQps"))i.safeImageryQps=t.safeImageryQps;if(t.domainsForHttps!==undefined&&t.domainsForHttps!==null&&t.hasOwnProperty("domainsForHttps"))i.domainsForHttps=t.domainsForHttps;if(t.hostsForHttp!==undefined&&t.hostsForHttp!==null&&t.hasOwnProperty("hostsForHttp"))i.hostsForHttp=t.hostsForHttp;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.TimeMachineOptionsProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.serverUrl="";r.prototype.isTimemachine=false;r.prototype.dwellTimeMs=500;r.prototype.discoverabilityAltitudeMeters=15e3;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.TimeMachineOptionsProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.serverUrl=r.string();break;case 2:o.isTimemachine=r.bool();break;case 3:o.dwellTimeMs=r.int32();break;case 4:o.discoverabilityAltitudeMeters=r.int32();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.serverUrl!==undefined)if(!i.isString(t.serverUrl))return"serverUrl: string expected";if(t.isTimemachine!==undefined)if(typeof t.isTimemachine!=="boolean")return"isTimemachine: boolean expected";if(t.dwellTimeMs!==undefined)if(!i.isInteger(t.dwellTimeMs))return"dwellTimeMs: integer expected";if(t.discoverabilityAltitudeMeters!==undefined)if(!i.isInteger(t.discoverabilityAltitudeMeters))return"discoverabilityAltitudeMeters: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.TimeMachineOptionsProto)return t;var r=new a.keyhole.dbroot.TimeMachineOptionsProto;if(t.serverUrl!==undefined&&t.serverUrl!==null)r.serverUrl=String(t.serverUrl);if(t.isTimemachine!==undefined&&t.isTimemachine!==null)r.isTimemachine=Boolean(t.isTimemachine);if(t.dwellTimeMs!==undefined&&t.dwellTimeMs!==null)r.dwellTimeMs=t.dwellTimeMs|0;if(t.discoverabilityAltitudeMeters!==undefined&&t.discoverabilityAltitudeMeters!==null)r.discoverabilityAltitudeMeters=t.discoverabilityAltitudeMeters|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.serverUrl="";i.isTimemachine=false;i.dwellTimeMs=500;i.discoverabilityAltitudeMeters=15e3}if(t.serverUrl!==undefined&&t.serverUrl!==null&&t.hasOwnProperty("serverUrl"))i.serverUrl=t.serverUrl;if(t.isTimemachine!==undefined&&t.isTimemachine!==null&&t.hasOwnProperty("isTimemachine"))i.isTimemachine=t.isTimemachine;if(t.dwellTimeMs!==undefined&&t.dwellTimeMs!==null&&t.hasOwnProperty("dwellTimeMs"))i.dwellTimeMs=t.dwellTimeMs;if(t.discoverabilityAltitudeMeters!==undefined&&t.discoverabilityAltitudeMeters!==null&&t.hasOwnProperty("discoverabilityAltitudeMeters"))i.discoverabilityAltitudeMeters=t.discoverabilityAltitudeMeters;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.AutopiaOptionsProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.metadataServerUrl="http://cbk0.google.com/cbk";r.prototype.depthmapServerUrl="http://cbk0.google.com/cbk";r.prototype.coverageOverlayUrl="";r.prototype.maxImageryQps=0;r.prototype.maxMetadataDepthmapQps=0;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.AutopiaOptionsProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.metadataServerUrl=r.string();break;case 2:o.depthmapServerUrl=r.string();break;case 3:o.coverageOverlayUrl=r.string();break;case 4:o.maxImageryQps=r.float();break;case 5:o.maxMetadataDepthmapQps=r.float();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.metadataServerUrl!==undefined)if(!i.isString(t.metadataServerUrl))return"metadataServerUrl: string expected";if(t.depthmapServerUrl!==undefined)if(!i.isString(t.depthmapServerUrl))return"depthmapServerUrl: string expected";if(t.coverageOverlayUrl!==undefined)if(!i.isString(t.coverageOverlayUrl))return"coverageOverlayUrl: string expected";if(t.maxImageryQps!==undefined)if(typeof t.maxImageryQps!=="number")return"maxImageryQps: number expected";if(t.maxMetadataDepthmapQps!==undefined)if(typeof t.maxMetadataDepthmapQps!=="number")return"maxMetadataDepthmapQps: number expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.AutopiaOptionsProto)return t;var r=new a.keyhole.dbroot.AutopiaOptionsProto;if(t.metadataServerUrl!==undefined&&t.metadataServerUrl!==null)r.metadataServerUrl=String(t.metadataServerUrl);if(t.depthmapServerUrl!==undefined&&t.depthmapServerUrl!==null)r.depthmapServerUrl=String(t.depthmapServerUrl);if(t.coverageOverlayUrl!==undefined&&t.coverageOverlayUrl!==null)r.coverageOverlayUrl=String(t.coverageOverlayUrl);if(t.maxImageryQps!==undefined&&t.maxImageryQps!==null)r.maxImageryQps=Number(t.maxImageryQps);if(t.maxMetadataDepthmapQps!==undefined&&t.maxMetadataDepthmapQps!==null)r.maxMetadataDepthmapQps=Number(t.maxMetadataDepthmapQps);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.metadataServerUrl="http://cbk0.google.com/cbk";i.depthmapServerUrl="http://cbk0.google.com/cbk";i.coverageOverlayUrl="";i.maxImageryQps=0;i.maxMetadataDepthmapQps=0}if(t.metadataServerUrl!==undefined&&t.metadataServerUrl!==null&&t.hasOwnProperty("metadataServerUrl"))i.metadataServerUrl=t.metadataServerUrl;if(t.depthmapServerUrl!==undefined&&t.depthmapServerUrl!==null&&t.hasOwnProperty("depthmapServerUrl"))i.depthmapServerUrl=t.depthmapServerUrl;if(t.coverageOverlayUrl!==undefined&&t.coverageOverlayUrl!==null&&t.hasOwnProperty("coverageOverlayUrl"))i.coverageOverlayUrl=t.coverageOverlayUrl;if(t.maxImageryQps!==undefined&&t.maxImageryQps!==null&&t.hasOwnProperty("maxImageryQps"))i.maxImageryQps=t.maxImageryQps;if(t.maxMetadataDepthmapQps!==undefined&&t.maxMetadataDepthmapQps!==null&&t.hasOwnProperty("maxMetadataDepthmapQps"))i.maxMetadataDepthmapQps=t.maxMetadataDepthmapQps;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.CSIOptionsProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.samplingPercentage=0;r.prototype.experimentId="";r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.CSIOptionsProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.samplingPercentage=r.int32();break;case 2:o.experimentId=r.string();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.samplingPercentage!==undefined)if(!i.isInteger(t.samplingPercentage))return"samplingPercentage: integer expected";if(t.experimentId!==undefined)if(!i.isString(t.experimentId))return"experimentId: string expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.CSIOptionsProto)return t;var r=new a.keyhole.dbroot.CSIOptionsProto;if(t.samplingPercentage!==undefined&&t.samplingPercentage!==null)r.samplingPercentage=t.samplingPercentage|0;if(t.experimentId!==undefined&&t.experimentId!==null)r.experimentId=String(t.experimentId);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.samplingPercentage=0;i.experimentId=""}if(t.samplingPercentage!==undefined&&t.samplingPercentage!==null&&t.hasOwnProperty("samplingPercentage"))i.samplingPercentage=t.samplingPercentage;if(t.experimentId!==undefined&&t.experimentId!==null&&t.hasOwnProperty("experimentId"))i.experimentId=t.experimentId;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.SearchTabProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.isVisible=false;r.prototype.tabLabel=null;r.prototype.baseUrl="";r.prototype.viewportPrefix="";r.prototype.inputBox=i.emptyArray;r.prototype.requirement=null;var o={1:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.SearchTabProto.InputBoxInfo",5:"keyhole.dbroot.RequirementProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.SearchTabProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.isVisible=r.bool();break;case 2:s.tabLabel=o[1].decode(r,r.uint32());break;case 3:s.baseUrl=r.string();break;case 4:s.viewportPrefix=r.string();break;case 5:if(!(s.inputBox&&s.inputBox.length))s.inputBox=[];s.inputBox.push(o[4].decode(r,r.uint32()));break;case 6:s.requirement=o[5].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(typeof t.isVisible!=="boolean")return"isVisible: boolean expected";if(t.tabLabel!==undefined&&t.tabLabel!==null){var r=o[1].verify(t.tabLabel);if(r)return"tabLabel."+r}if(t.baseUrl!==undefined)if(!i.isString(t.baseUrl))return"baseUrl: string expected";if(t.viewportPrefix!==undefined)if(!i.isString(t.viewportPrefix))return"viewportPrefix: string expected";if(t.inputBox!==undefined){if(!Array.isArray(t.inputBox))return"inputBox: array expected";for(var n=0;n<t.inputBox.length;++n){var r=o[4].verify(t.inputBox[n]);if(r)return"inputBox."+r}}if(t.requirement!==undefined&&t.requirement!==null){var r=o[5].verify(t.requirement);if(r)return"requirement."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.SearchTabProto)return t;var r=new a.keyhole.dbroot.SearchTabProto;if(t.isVisible!==undefined&&t.isVisible!==null)r.isVisible=Boolean(t.isVisible);if(t.tabLabel!==undefined&&t.tabLabel!==null){if(typeof t.tabLabel!=="object")throw TypeError(".keyhole.dbroot.SearchTabProto.tabLabel: object expected");r.tabLabel=o[1].fromObject(t.tabLabel)}if(t.baseUrl!==undefined&&t.baseUrl!==null)r.baseUrl=String(t.baseUrl);if(t.viewportPrefix!==undefined&&t.viewportPrefix!==null)r.viewportPrefix=String(t.viewportPrefix);if(t.inputBox){if(!Array.isArray(t.inputBox))throw TypeError(".keyhole.dbroot.SearchTabProto.inputBox: array expected");r.inputBox=[];for(var i=0;i<t.inputBox.length;++i){if(typeof t.inputBox[i]!=="object")throw TypeError(".keyhole.dbroot.SearchTabProto.inputBox: object expected");r.inputBox[i]=o[4].fromObject(t.inputBox[i])}}if(t.requirement!==undefined&&t.requirement!==null){if(typeof t.requirement!=="object")throw TypeError(".keyhole.dbroot.SearchTabProto.requirement: object expected");r.requirement=o[5].fromObject(t.requirement)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults)i.inputBox=[];if(r.defaults){i.isVisible=false;i.tabLabel=null;i.baseUrl="";i.viewportPrefix="";i.requirement=null}if(t.isVisible!==undefined&&t.isVisible!==null&&t.hasOwnProperty("isVisible"))i.isVisible=t.isVisible;if(t.tabLabel!==undefined&&t.tabLabel!==null&&t.hasOwnProperty("tabLabel"))i.tabLabel=o[1].toObject(t.tabLabel,r);if(t.baseUrl!==undefined&&t.baseUrl!==null&&t.hasOwnProperty("baseUrl"))i.baseUrl=t.baseUrl;if(t.viewportPrefix!==undefined&&t.viewportPrefix!==null&&t.hasOwnProperty("viewportPrefix"))i.viewportPrefix=t.viewportPrefix;if(t.inputBox!==undefined&&t.inputBox!==null&&t.hasOwnProperty("inputBox")){i.inputBox=[];for(var n=0;n<t.inputBox.length;++n)i.inputBox[n]=o[4].toObject(t.inputBox[n],r)}if(t.requirement!==undefined&&t.requirement!==null&&t.hasOwnProperty("requirement"))i.requirement=o[5].toObject(t.requirement,r);return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.InputBoxInfo=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.label=null;r.prototype.queryVerb="";r.prototype.queryPrepend="";var o={0:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.SearchTabProto.InputBoxInfo;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.label=o[0].decode(r,r.uint32());break;case 2:s.queryVerb=r.string();break;case 3:s.queryPrepend=r.string();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";var r=o[0].verify(t.label);if(r)return"label."+r;if(!i.isString(t.queryVerb))return"queryVerb: string expected";if(t.queryPrepend!==undefined)if(!i.isString(t.queryPrepend))return"queryPrepend: string expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.SearchTabProto.InputBoxInfo)return t;var r=new a.keyhole.dbroot.SearchTabProto.InputBoxInfo;if(t.label!==undefined&&t.label!==null){if(typeof t.label!=="object")throw TypeError(".keyhole.dbroot.SearchTabProto.InputBoxInfo.label: object expected");r.label=o[0].fromObject(t.label)}if(t.queryVerb!==undefined&&t.queryVerb!==null)r.queryVerb=String(t.queryVerb);if(t.queryPrepend!==undefined&&t.queryPrepend!==null)r.queryPrepend=String(t.queryPrepend);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.label=null;i.queryVerb="";i.queryPrepend=""}if(t.label!==undefined&&t.label!==null&&t.hasOwnProperty("label"))i.label=o[0].toObject(t.label,r);if(t.queryVerb!==undefined&&t.queryVerb!==null&&t.hasOwnProperty("queryVerb"))i.queryVerb=t.queryVerb;if(t.queryPrepend!==undefined&&t.queryPrepend!==null&&t.hasOwnProperty("queryPrepend"))i.queryPrepend=t.queryPrepend;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();return r}();r.CobrandProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.logoUrl="";r.prototype.xCoord=null;r.prototype.yCoord=null;r.prototype.tiePoint=6;r.prototype.screenSize=0;var o={1:"keyhole.dbroot.CobrandProto.Coord",2:"keyhole.dbroot.CobrandProto.Coord",3:"keyhole.dbroot.CobrandProto.TiePoint"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.CobrandProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.logoUrl=r.string();break;case 2:s.xCoord=o[1].decode(r,r.uint32());break;case 3:s.yCoord=o[2].decode(r,r.uint32());break;case 4:s.tiePoint=r.uint32();break;case 5:s.screenSize=r.double();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isString(t.logoUrl))return"logoUrl: string expected";if(t.xCoord!==undefined&&t.xCoord!==null){var r=o[1].verify(t.xCoord);if(r)return"xCoord."+r}if(t.yCoord!==undefined&&t.yCoord!==null){var r=o[2].verify(t.yCoord);if(r)return"yCoord."+r}if(t.tiePoint!==undefined)switch(t.tiePoint){default:return"tiePoint: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}if(t.screenSize!==undefined)if(typeof t.screenSize!=="number")return"screenSize: number expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.CobrandProto)return t;var r=new a.keyhole.dbroot.CobrandProto;if(t.logoUrl!==undefined&&t.logoUrl!==null)r.logoUrl=String(t.logoUrl);if(t.xCoord!==undefined&&t.xCoord!==null){if(typeof t.xCoord!=="object")throw TypeError(".keyhole.dbroot.CobrandProto.xCoord: object expected");r.xCoord=o[1].fromObject(t.xCoord)}if(t.yCoord!==undefined&&t.yCoord!==null){if(typeof t.yCoord!=="object")throw TypeError(".keyhole.dbroot.CobrandProto.yCoord: object expected");r.yCoord=o[2].fromObject(t.yCoord)}switch(t.tiePoint){case"TOP_LEFT":case 0:r.tiePoint=0;break;case"TOP_CENTER":case 1:r.tiePoint=1;break;case"TOP_RIGHT":case 2:r.tiePoint=2;break;case"MID_LEFT":case 3:r.tiePoint=3;break;case"MID_CENTER":case 4:r.tiePoint=4;break;case"MID_RIGHT":case 5:r.tiePoint=5;break;case"BOTTOM_LEFT":case 6:r.tiePoint=6;break;case"BOTTOM_CENTER":case 7:r.tiePoint=7;break;case"BOTTOM_RIGHT":case 8:r.tiePoint=8;break}if(t.screenSize!==undefined&&t.screenSize!==null)r.screenSize=Number(t.screenSize);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.logoUrl="";i.xCoord=null;i.yCoord=null;i.tiePoint=r.enums===String?"BOTTOM_LEFT":6;i.screenSize=0}if(t.logoUrl!==undefined&&t.logoUrl!==null&&t.hasOwnProperty("logoUrl"))i.logoUrl=t.logoUrl;if(t.xCoord!==undefined&&t.xCoord!==null&&t.hasOwnProperty("xCoord"))i.xCoord=o[1].toObject(t.xCoord,r);if(t.yCoord!==undefined&&t.yCoord!==null&&t.hasOwnProperty("yCoord"))i.yCoord=o[2].toObject(t.yCoord,r);if(t.tiePoint!==undefined&&t.tiePoint!==null&&t.hasOwnProperty("tiePoint"))i.tiePoint=r.enums===String?o[3][t.tiePoint]:t.tiePoint;if(t.screenSize!==undefined&&t.screenSize!==null&&t.hasOwnProperty("screenSize"))i.screenSize=t.screenSize;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.Coord=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.value=0;r.prototype.isRelative=false;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.CobrandProto.Coord;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.value=r.double();break;case 2:o.isRelative=r.bool();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(typeof t.value!=="number")return"value: number expected";if(t.isRelative!==undefined)if(typeof t.isRelative!=="boolean")return"isRelative: boolean expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.CobrandProto.Coord)return t;var r=new a.keyhole.dbroot.CobrandProto.Coord;if(t.value!==undefined&&t.value!==null)r.value=Number(t.value);if(t.isRelative!==undefined&&t.isRelative!==null)r.isRelative=Boolean(t.isRelative);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.value=0;i.isRelative=false}if(t.value!==undefined&&t.value!==null&&t.hasOwnProperty("value"))i.value=t.value;if(t.isRelative!==undefined&&t.isRelative!==null&&t.hasOwnProperty("isRelative"))i.isRelative=t.isRelative;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.TiePoint=function(){var e={},t=Object.create(e);t["TOP_LEFT"]=0;t["TOP_CENTER"]=1;t["TOP_RIGHT"]=2;t["MID_LEFT"]=3;t["MID_CENTER"]=4;t["MID_RIGHT"]=5;t["BOTTOM_LEFT"]=6;t["BOTTOM_CENTER"]=7;t["BOTTOM_RIGHT"]=8;return t}();return r}();r.DatabaseDescriptionProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.databaseName=null;r.prototype.databaseUrl="";var o={0:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.DatabaseDescriptionProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.databaseName=o[0].decode(r,r.uint32());break;case 2:s.databaseUrl=r.string();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.databaseName!==undefined&&t.databaseName!==null){var r=o[0].verify(t.databaseName);if(r)return"databaseName."+r}if(!i.isString(t.databaseUrl))return"databaseUrl: string expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.DatabaseDescriptionProto)return t;var r=new a.keyhole.dbroot.DatabaseDescriptionProto;if(t.databaseName!==undefined&&t.databaseName!==null){if(typeof t.databaseName!=="object")throw TypeError(".keyhole.dbroot.DatabaseDescriptionProto.databaseName: object expected");r.databaseName=o[0].fromObject(t.databaseName)}if(t.databaseUrl!==undefined&&t.databaseUrl!==null)r.databaseUrl=String(t.databaseUrl);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.databaseName=null;i.databaseUrl=""}if(t.databaseName!==undefined&&t.databaseName!==null&&t.hasOwnProperty("databaseName"))i.databaseName=o[0].toObject(t.databaseName,r);if(t.databaseUrl!==undefined&&t.databaseUrl!==null&&t.hasOwnProperty("databaseUrl"))i.databaseUrl=t.databaseUrl;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.ConfigScriptProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.scriptName="";r.prototype.scriptData="";r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.ConfigScriptProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.scriptName=r.string();break;case 2:o.scriptData=r.string();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isString(t.scriptName))return"scriptName: string expected";if(!i.isString(t.scriptData))return"scriptData: string expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.ConfigScriptProto)return t;var r=new a.keyhole.dbroot.ConfigScriptProto;if(t.scriptName!==undefined&&t.scriptName!==null)r.scriptName=String(t.scriptName);if(t.scriptData!==undefined&&t.scriptData!==null)r.scriptData=String(t.scriptData);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.scriptName="";i.scriptData=""}if(t.scriptName!==undefined&&t.scriptName!==null&&t.hasOwnProperty("scriptName"))i.scriptName=t.scriptName;if(t.scriptData!==undefined&&t.scriptData!==null&&t.hasOwnProperty("scriptData"))i.scriptData=t.scriptData;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.SwoopParamsProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.startDistInMeters=0;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.SwoopParamsProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.startDistInMeters=r.double();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.startDistInMeters!==undefined)if(typeof t.startDistInMeters!=="number")return"startDistInMeters: number expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.SwoopParamsProto)return t;var r=new a.keyhole.dbroot.SwoopParamsProto;if(t.startDistInMeters!==undefined&&t.startDistInMeters!==null)r.startDistInMeters=Number(t.startDistInMeters);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults)i.startDistInMeters=0;if(t.startDistInMeters!==undefined&&t.startDistInMeters!==null&&t.hasOwnProperty("startDistInMeters"))i.startDistInMeters=t.startDistInMeters;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.PostingServerProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.name=null;r.prototype.baseUrl=null;r.prototype.postWizardPath=null;r.prototype.fileSubmitPath=null;var i={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto",2:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.StringIdOrValueProto"};n.push(i);r.decode=function e(r,n){if(!(r instanceof t))r=t.create(r);var o=n===undefined?r.len:r.pos+n,s=new a.keyhole.dbroot.PostingServerProto;while(r.pos<o){var l=r.uint32();switch(l>>>3){case 1:s.name=i[0].decode(r,r.uint32());break;case 2:s.baseUrl=i[1].decode(r,r.uint32());break;case 3:s.postWizardPath=i[2].decode(r,r.uint32());break;case 4:s.fileSubmitPath=i[3].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.name!==undefined&&t.name!==null){var r=i[0].verify(t.name);if(r)return"name."+r}if(t.baseUrl!==undefined&&t.baseUrl!==null){var r=i[1].verify(t.baseUrl);if(r)return"baseUrl."+r}if(t.postWizardPath!==undefined&&t.postWizardPath!==null){var r=i[2].verify(t.postWizardPath);if(r)return"postWizardPath."+r}if(t.fileSubmitPath!==undefined&&t.fileSubmitPath!==null){var r=i[3].verify(t.fileSubmitPath);if(r)return"fileSubmitPath."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.PostingServerProto)return t;var r=new a.keyhole.dbroot.PostingServerProto;if(t.name!==undefined&&t.name!==null){if(typeof t.name!=="object")throw TypeError(".keyhole.dbroot.PostingServerProto.name: object expected");r.name=i[0].fromObject(t.name)}if(t.baseUrl!==undefined&&t.baseUrl!==null){if(typeof t.baseUrl!=="object")throw TypeError(".keyhole.dbroot.PostingServerProto.baseUrl: object expected");r.baseUrl=i[1].fromObject(t.baseUrl)}if(t.postWizardPath!==undefined&&t.postWizardPath!==null){if(typeof t.postWizardPath!=="object")throw TypeError(".keyhole.dbroot.PostingServerProto.postWizardPath: object expected");r.postWizardPath=i[2].fromObject(t.postWizardPath)}if(t.fileSubmitPath!==undefined&&t.fileSubmitPath!==null){if(typeof t.fileSubmitPath!=="object")throw TypeError(".keyhole.dbroot.PostingServerProto.fileSubmitPath: object expected");r.fileSubmitPath=i[3].fromObject(t.fileSubmitPath)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var n={};if(r.defaults){n.name=null;n.baseUrl=null;n.postWizardPath=null;n.fileSubmitPath=null}if(t.name!==undefined&&t.name!==null&&t.hasOwnProperty("name"))n.name=i[0].toObject(t.name,r);if(t.baseUrl!==undefined&&t.baseUrl!==null&&t.hasOwnProperty("baseUrl"))n.baseUrl=i[1].toObject(t.baseUrl,r);if(t.postWizardPath!==undefined&&t.postWizardPath!==null&&t.hasOwnProperty("postWizardPath"))n.postWizardPath=i[2].toObject(t.postWizardPath,r);if(t.fileSubmitPath!==undefined&&t.fileSubmitPath!==null&&t.hasOwnProperty("fileSubmitPath"))n.fileSubmitPath=i[3].toObject(t.fileSubmitPath,r);return n};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.PlanetaryDatabaseProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.url=null;r.prototype.name=null;var i={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto"};n.push(i);r.decode=function e(r,n){if(!(r instanceof t))r=t.create(r);var o=n===undefined?r.len:r.pos+n,s=new a.keyhole.dbroot.PlanetaryDatabaseProto;while(r.pos<o){var l=r.uint32();switch(l>>>3){case 1:s.url=i[0].decode(r,r.uint32());break;case 2:s.name=i[1].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";var r=i[0].verify(t.url);if(r)return"url."+r;var r=i[1].verify(t.name);if(r)return"name."+r;return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.PlanetaryDatabaseProto)return t;var r=new a.keyhole.dbroot.PlanetaryDatabaseProto;if(t.url!==undefined&&t.url!==null){if(typeof t.url!=="object")throw TypeError(".keyhole.dbroot.PlanetaryDatabaseProto.url: object expected");r.url=i[0].fromObject(t.url)}if(t.name!==undefined&&t.name!==null){if(typeof t.name!=="object")throw TypeError(".keyhole.dbroot.PlanetaryDatabaseProto.name: object expected");r.name=i[1].fromObject(t.name)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var n={};if(r.defaults){n.url=null;n.name=null}if(t.url!==undefined&&t.url!==null&&t.hasOwnProperty("url"))n.url=i[0].toObject(t.url,r);if(t.name!==undefined&&t.name!==null&&t.hasOwnProperty("name"))n.name=i[1].toObject(t.name,r);return n};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.LogServerProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.url=null;r.prototype.enable=false;r.prototype.throttlingFactor=1;var o={0:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.LogServerProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.url=o[0].decode(r,r.uint32());break;case 2:s.enable=r.bool();break;case 3:s.throttlingFactor=r.int32();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.url!==undefined&&t.url!==null){var r=o[0].verify(t.url);if(r)return"url."+r}if(t.enable!==undefined)if(typeof t.enable!=="boolean")return"enable: boolean expected";if(t.throttlingFactor!==undefined)if(!i.isInteger(t.throttlingFactor))return"throttlingFactor: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.LogServerProto)return t;var r=new a.keyhole.dbroot.LogServerProto;if(t.url!==undefined&&t.url!==null){if(typeof t.url!=="object")throw TypeError(".keyhole.dbroot.LogServerProto.url: object expected");r.url=o[0].fromObject(t.url)}if(t.enable!==undefined&&t.enable!==null)r.enable=Boolean(t.enable);if(t.throttlingFactor!==undefined&&t.throttlingFactor!==null)r.throttlingFactor=t.throttlingFactor|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.url=null;i.enable=false;i.throttlingFactor=1}if(t.url!==undefined&&t.url!==null&&t.hasOwnProperty("url"))i.url=o[0].toObject(t.url,r);if(t.enable!==undefined&&t.enable!==null&&t.hasOwnProperty("enable"))i.enable=t.enable;if(t.throttlingFactor!==undefined&&t.throttlingFactor!==null&&t.hasOwnProperty("throttlingFactor"))i.throttlingFactor=t.throttlingFactor;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.EndSnippetProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.model=null;r.prototype.authServerUrl=null;r.prototype.disableAuthentication=false;r.prototype.mfeDomains=i.emptyArray;r.prototype.mfeLangParam="hl=$5Bhl5D";r.prototype.adsUrlPatterns="";r.prototype.reverseGeocoderUrl=null;r.prototype.reverseGeocoderProtocolVersion=3;r.prototype.skyDatabaseIsAvailable=true;r.prototype.skyDatabaseUrl=null;r.prototype.defaultWebPageIntlUrl=null;r.prototype.numStartUpTips=17;r.prototype.startUpTipsUrl=null;r.prototype.numProStartUpTips=0;r.prototype.proStartUpTipsUrl=null;r.prototype.startupTipsIntlUrl=null;r.prototype.userGuideIntlUrl=null;r.prototype.supportCenterIntlUrl=null;r.prototype.businessListingIntlUrl=null;r.prototype.supportAnswerIntlUrl=null;r.prototype.supportTopicIntlUrl=null;r.prototype.supportRequestIntlUrl=null;r.prototype.earthIntlUrl=null;r.prototype.addContentUrl=null;r.prototype.sketchupNotInstalledUrl=null;r.prototype.sketchupErrorUrl=null;r.prototype.freeLicenseUrl=null;r.prototype.proLicenseUrl=null;r.prototype.tutorialUrl=null;r.prototype.keyboardShortcutsUrl=null;r.prototype.releaseNotesUrl=null;r.prototype.hideUserData=false;r.prototype.useGeLogo=true;r.prototype.dioramaDescriptionUrlBase=null;r.prototype.dioramaDefaultColor=4291281607;r.prototype.dioramaBlacklistUrl=null;r.prototype.clientOptions=null;r.prototype.fetchingOptions=null;r.prototype.timeMachineOptions=null;r.prototype.csiOptions=null;r.prototype.searchTab=i.emptyArray;r.prototype.cobrandInfo=i.emptyArray;r.prototype.validDatabase=i.emptyArray;r.prototype.configScript=i.emptyArray;r.prototype.deauthServerUrl=null;r.prototype.swoopParameters=null;r.prototype.bbsServerInfo=null;r.prototype.dataErrorServerInfo=null;r.prototype.planetaryDatabase=i.emptyArray;r.prototype.logServer=null;r.prototype.autopiaOptions=null;r.prototype.searchConfig=null;r.prototype.searchInfo=null;r.prototype.elevationServiceBaseUrl="http://maps.google.com/maps/api/elevation/";r.prototype.elevationProfileQueryDelay=500;r.prototype.proUpgradeUrl=null;r.prototype.earthCommunityUrl=null;r.prototype.googleMapsUrl=null;r.prototype.sharingUrl=null;r.prototype.privacyPolicyUrl=null;r.prototype.doGplusUserCheck=false;r.prototype.rocktreeDataProto=null;r.prototype.filmstripConfig=i.emptyArray;r.prototype.showSigninButton=false;r.prototype.proMeasureUpsellUrl=null;r.prototype.proPrintUpsellUrl=null;r.prototype.starDataProto=null;r.prototype.feedbackUrl=null;r.prototype.oauth2LoginUrl=null;var o={0:"keyhole.dbroot.PlanetModelProto",1:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.MfeDomainFeaturesProto",6:"keyhole.dbroot.StringIdOrValueProto",9:"keyhole.dbroot.StringIdOrValueProto",10:"keyhole.dbroot.StringIdOrValueProto",12:"keyhole.dbroot.StringIdOrValueProto",14:"keyhole.dbroot.StringIdOrValueProto",15:"keyhole.dbroot.StringIdOrValueProto",16:"keyhole.dbroot.StringIdOrValueProto",17:"keyhole.dbroot.StringIdOrValueProto",18:"keyhole.dbroot.StringIdOrValueProto",19:"keyhole.dbroot.StringIdOrValueProto",20:"keyhole.dbroot.StringIdOrValueProto",21:"keyhole.dbroot.StringIdOrValueProto",22:"keyhole.dbroot.StringIdOrValueProto",23:"keyhole.dbroot.StringIdOrValueProto",24:"keyhole.dbroot.StringIdOrValueProto",25:"keyhole.dbroot.StringIdOrValueProto",26:"keyhole.dbroot.StringIdOrValueProto",27:"keyhole.dbroot.StringIdOrValueProto",28:"keyhole.dbroot.StringIdOrValueProto",29:"keyhole.dbroot.StringIdOrValueProto",30:"keyhole.dbroot.StringIdOrValueProto",33:"keyhole.dbroot.StringIdOrValueProto",35:"keyhole.dbroot.StringIdOrValueProto",36:"keyhole.dbroot.ClientOptionsProto",37:"keyhole.dbroot.FetchingOptionsProto",38:"keyhole.dbroot.TimeMachineOptionsProto",39:"keyhole.dbroot.CSIOptionsProto",40:"keyhole.dbroot.SearchTabProto",41:"keyhole.dbroot.CobrandProto",42:"keyhole.dbroot.DatabaseDescriptionProto",43:"keyhole.dbroot.ConfigScriptProto",44:"keyhole.dbroot.StringIdOrValueProto",45:"keyhole.dbroot.SwoopParamsProto",46:"keyhole.dbroot.PostingServerProto",47:"keyhole.dbroot.PostingServerProto",48:"keyhole.dbroot.PlanetaryDatabaseProto",49:"keyhole.dbroot.LogServerProto",50:"keyhole.dbroot.AutopiaOptionsProto",51:"keyhole.dbroot.EndSnippetProto.SearchConfigProto",52:"keyhole.dbroot.EndSnippetProto.SearchInfoProto",55:"keyhole.dbroot.StringIdOrValueProto",56:"keyhole.dbroot.StringIdOrValueProto",57:"keyhole.dbroot.StringIdOrValueProto",58:"keyhole.dbroot.StringIdOrValueProto",59:"keyhole.dbroot.StringIdOrValueProto",61:"keyhole.dbroot.EndSnippetProto.RockTreeDataProto",62:"keyhole.dbroot.EndSnippetProto.FilmstripConfigProto",64:"keyhole.dbroot.StringIdOrValueProto",65:"keyhole.dbroot.StringIdOrValueProto",66:"keyhole.dbroot.EndSnippetProto.StarDataProto",67:"keyhole.dbroot.StringIdOrValueProto",68:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.EndSnippetProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.model=o[0].decode(r,r.uint32());break;case 2:s.authServerUrl=o[1].decode(r,r.uint32());break;case 3:s.disableAuthentication=r.bool();break;case 4:if(!(s.mfeDomains&&s.mfeDomains.length))s.mfeDomains=[];s.mfeDomains.push(o[3].decode(r,r.uint32()));break;case 5:s.mfeLangParam=r.string();break;case 6:s.adsUrlPatterns=r.string();break;case 7:s.reverseGeocoderUrl=o[6].decode(r,r.uint32());break;case 8:s.reverseGeocoderProtocolVersion=r.int32();break;case 9:s.skyDatabaseIsAvailable=r.bool();break;case 10:s.skyDatabaseUrl=o[9].decode(r,r.uint32());break;case 11:s.defaultWebPageIntlUrl=o[10].decode(r,r.uint32());break;case 12:s.numStartUpTips=r.int32();break;case 13:s.startUpTipsUrl=o[12].decode(r,r.uint32());break;case 51:s.numProStartUpTips=r.int32();break;case 52:s.proStartUpTipsUrl=o[14].decode(r,r.uint32());break;case 64:s.startupTipsIntlUrl=o[15].decode(r,r.uint32());break;case 14:s.userGuideIntlUrl=o[16].decode(r,r.uint32());break;case 15:s.supportCenterIntlUrl=o[17].decode(r,r.uint32());break;case 16:s.businessListingIntlUrl=o[18].decode(r,r.uint32());break;case 17:s.supportAnswerIntlUrl=o[19].decode(r,r.uint32());break;case 18:s.supportTopicIntlUrl=o[20].decode(r,r.uint32());break;case 19:s.supportRequestIntlUrl=o[21].decode(r,r.uint32());break;case 20:s.earthIntlUrl=o[22].decode(r,r.uint32());break;case 21:s.addContentUrl=o[23].decode(r,r.uint32());break;case 22:s.sketchupNotInstalledUrl=o[24].decode(r,r.uint32());break;case 23:s.sketchupErrorUrl=o[25].decode(r,r.uint32());break;case 24:s.freeLicenseUrl=o[26].decode(r,r.uint32());break;case 25:s.proLicenseUrl=o[27].decode(r,r.uint32());break;case 48:s.tutorialUrl=o[28].decode(r,r.uint32());break;case 49:s.keyboardShortcutsUrl=o[29].decode(r,r.uint32());break;case 50:s.releaseNotesUrl=o[30].decode(r,r.uint32());break;case 26:s.hideUserData=r.bool();break;case 27:s.useGeLogo=r.bool();break;case 28:s.dioramaDescriptionUrlBase=o[33].decode(r,r.uint32());break;case 29:s.dioramaDefaultColor=r.uint32();break;case 53:s.dioramaBlacklistUrl=o[35].decode(r,r.uint32());break;case 30:s.clientOptions=o[36].decode(r,r.uint32());break;case 31:s.fetchingOptions=o[37].decode(r,r.uint32());break;case 32:s.timeMachineOptions=o[38].decode(r,r.uint32());break;case 33:s.csiOptions=o[39].decode(r,r.uint32());break;case 34:if(!(s.searchTab&&s.searchTab.length))s.searchTab=[];s.searchTab.push(o[40].decode(r,r.uint32()));break;case 35:if(!(s.cobrandInfo&&s.cobrandInfo.length))s.cobrandInfo=[];s.cobrandInfo.push(o[41].decode(r,r.uint32()));break;case 36:if(!(s.validDatabase&&s.validDatabase.length))s.validDatabase=[];s.validDatabase.push(o[42].decode(r,r.uint32()));break;case 37:if(!(s.configScript&&s.configScript.length))s.configScript=[];s.configScript.push(o[43].decode(r,r.uint32()));break;case 38:s.deauthServerUrl=o[44].decode(r,r.uint32());break;case 39:s.swoopParameters=o[45].decode(r,r.uint32());break;case 40:s.bbsServerInfo=o[46].decode(r,r.uint32());break;case 41:s.dataErrorServerInfo=o[47].decode(r,r.uint32());break;case 42:if(!(s.planetaryDatabase&&s.planetaryDatabase.length))s.planetaryDatabase=[];s.planetaryDatabase.push(o[48].decode(r,r.uint32()));break;case 43:s.logServer=o[49].decode(r,r.uint32());break;case 44:s.autopiaOptions=o[50].decode(r,r.uint32());break;case 54:s.searchConfig=o[51].decode(r,r.uint32());break;case 45:s.searchInfo=o[52].decode(r,r.uint32());break;case 46:s.elevationServiceBaseUrl=r.string();break;case 47:s.elevationProfileQueryDelay=r.int32();break;case 55:s.proUpgradeUrl=o[55].decode(r,r.uint32());break;case 56:s.earthCommunityUrl=o[56].decode(r,r.uint32());break;case 57:s.googleMapsUrl=o[57].decode(r,r.uint32());break;case 58:s.sharingUrl=o[58].decode(r,r.uint32());break;case 59:s.privacyPolicyUrl=o[59].decode(r,r.uint32());break;case 60:s.doGplusUserCheck=r.bool();break;case 61:s.rocktreeDataProto=o[61].decode(r,r.uint32());break;case 62:if(!(s.filmstripConfig&&s.filmstripConfig.length))s.filmstripConfig=[];s.filmstripConfig.push(o[62].decode(r,r.uint32()));break;case 63:s.showSigninButton=r.bool();break;case 65:s.proMeasureUpsellUrl=o[64].decode(r,r.uint32());break;case 66:s.proPrintUpsellUrl=o[65].decode(r,r.uint32());break;case 67:s.starDataProto=o[66].decode(r,r.uint32());break;case 68:s.feedbackUrl=o[67].decode(r,r.uint32());break;case 69:s.oauth2LoginUrl=o[68].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.model!==undefined&&t.model!==null){var r=o[0].verify(t.model);if(r)return"model."+r}if(t.authServerUrl!==undefined&&t.authServerUrl!==null){var r=o[1].verify(t.authServerUrl);if(r)return"authServerUrl."+r}if(t.disableAuthentication!==undefined)if(typeof t.disableAuthentication!=="boolean")return"disableAuthentication: boolean expected";if(t.mfeDomains!==undefined){if(!Array.isArray(t.mfeDomains))return"mfeDomains: array expected";for(var n=0;n<t.mfeDomains.length;++n){var r=o[3].verify(t.mfeDomains[n]);if(r)return"mfeDomains."+r}}if(t.mfeLangParam!==undefined)if(!i.isString(t.mfeLangParam))return"mfeLangParam: string expected";if(t.adsUrlPatterns!==undefined)if(!i.isString(t.adsUrlPatterns))return"adsUrlPatterns: string expected";if(t.reverseGeocoderUrl!==undefined&&t.reverseGeocoderUrl!==null){var r=o[6].verify(t.reverseGeocoderUrl);if(r)return"reverseGeocoderUrl."+r}if(t.reverseGeocoderProtocolVersion!==undefined)if(!i.isInteger(t.reverseGeocoderProtocolVersion))return"reverseGeocoderProtocolVersion: integer expected";if(t.skyDatabaseIsAvailable!==undefined)if(typeof t.skyDatabaseIsAvailable!=="boolean")return"skyDatabaseIsAvailable: boolean expected";if(t.skyDatabaseUrl!==undefined&&t.skyDatabaseUrl!==null){var r=o[9].verify(t.skyDatabaseUrl);if(r)return"skyDatabaseUrl."+r}if(t.defaultWebPageIntlUrl!==undefined&&t.defaultWebPageIntlUrl!==null){var r=o[10].verify(t.defaultWebPageIntlUrl);if(r)return"defaultWebPageIntlUrl."+r}if(t.numStartUpTips!==undefined)if(!i.isInteger(t.numStartUpTips))return"numStartUpTips: integer expected";if(t.startUpTipsUrl!==undefined&&t.startUpTipsUrl!==null){var r=o[12].verify(t.startUpTipsUrl);if(r)return"startUpTipsUrl."+r}if(t.numProStartUpTips!==undefined)if(!i.isInteger(t.numProStartUpTips))return"numProStartUpTips: integer expected";if(t.proStartUpTipsUrl!==undefined&&t.proStartUpTipsUrl!==null){var r=o[14].verify(t.proStartUpTipsUrl);if(r)return"proStartUpTipsUrl."+r}if(t.startupTipsIntlUrl!==undefined&&t.startupTipsIntlUrl!==null){var r=o[15].verify(t.startupTipsIntlUrl);if(r)return"startupTipsIntlUrl."+r}if(t.userGuideIntlUrl!==undefined&&t.userGuideIntlUrl!==null){var r=o[16].verify(t.userGuideIntlUrl);if(r)return"userGuideIntlUrl."+r}if(t.supportCenterIntlUrl!==undefined&&t.supportCenterIntlUrl!==null){var r=o[17].verify(t.supportCenterIntlUrl);if(r)return"supportCenterIntlUrl."+r}if(t.businessListingIntlUrl!==undefined&&t.businessListingIntlUrl!==null){var r=o[18].verify(t.businessListingIntlUrl);if(r)return"businessListingIntlUrl."+r}if(t.supportAnswerIntlUrl!==undefined&&t.supportAnswerIntlUrl!==null){var r=o[19].verify(t.supportAnswerIntlUrl);if(r)return"supportAnswerIntlUrl."+r}if(t.supportTopicIntlUrl!==undefined&&t.supportTopicIntlUrl!==null){var r=o[20].verify(t.supportTopicIntlUrl);if(r)return"supportTopicIntlUrl."+r}if(t.supportRequestIntlUrl!==undefined&&t.supportRequestIntlUrl!==null){var r=o[21].verify(t.supportRequestIntlUrl);if(r)return"supportRequestIntlUrl."+r}if(t.earthIntlUrl!==undefined&&t.earthIntlUrl!==null){var r=o[22].verify(t.earthIntlUrl);if(r)return"earthIntlUrl."+r}if(t.addContentUrl!==undefined&&t.addContentUrl!==null){var r=o[23].verify(t.addContentUrl);if(r)return"addContentUrl."+r}if(t.sketchupNotInstalledUrl!==undefined&&t.sketchupNotInstalledUrl!==null){var r=o[24].verify(t.sketchupNotInstalledUrl);if(r)return"sketchupNotInstalledUrl."+r}if(t.sketchupErrorUrl!==undefined&&t.sketchupErrorUrl!==null){var r=o[25].verify(t.sketchupErrorUrl);if(r)return"sketchupErrorUrl."+r}if(t.freeLicenseUrl!==undefined&&t.freeLicenseUrl!==null){var r=o[26].verify(t.freeLicenseUrl);if(r)return"freeLicenseUrl."+r}if(t.proLicenseUrl!==undefined&&t.proLicenseUrl!==null){var r=o[27].verify(t.proLicenseUrl);if(r)return"proLicenseUrl."+r}if(t.tutorialUrl!==undefined&&t.tutorialUrl!==null){var r=o[28].verify(t.tutorialUrl);if(r)return"tutorialUrl."+r}if(t.keyboardShortcutsUrl!==undefined&&t.keyboardShortcutsUrl!==null){var r=o[29].verify(t.keyboardShortcutsUrl);if(r)return"keyboardShortcutsUrl."+r}if(t.releaseNotesUrl!==undefined&&t.releaseNotesUrl!==null){var r=o[30].verify(t.releaseNotesUrl);if(r)return"releaseNotesUrl."+r}if(t.hideUserData!==undefined)if(typeof t.hideUserData!=="boolean")return"hideUserData: boolean expected";if(t.useGeLogo!==undefined)if(typeof t.useGeLogo!=="boolean")return"useGeLogo: boolean expected";if(t.dioramaDescriptionUrlBase!==undefined&&t.dioramaDescriptionUrlBase!==null){var r=o[33].verify(t.dioramaDescriptionUrlBase);if(r)return"dioramaDescriptionUrlBase."+r}if(t.dioramaDefaultColor!==undefined)if(!i.isInteger(t.dioramaDefaultColor))return"dioramaDefaultColor: integer expected";if(t.dioramaBlacklistUrl!==undefined&&t.dioramaBlacklistUrl!==null){var r=o[35].verify(t.dioramaBlacklistUrl);if(r)return"dioramaBlacklistUrl."+r}if(t.clientOptions!==undefined&&t.clientOptions!==null){var r=o[36].verify(t.clientOptions);if(r)return"clientOptions."+r}if(t.fetchingOptions!==undefined&&t.fetchingOptions!==null){var r=o[37].verify(t.fetchingOptions);if(r)return"fetchingOptions."+r}if(t.timeMachineOptions!==undefined&&t.timeMachineOptions!==null){var r=o[38].verify(t.timeMachineOptions);if(r)return"timeMachineOptions."+r}if(t.csiOptions!==undefined&&t.csiOptions!==null){var r=o[39].verify(t.csiOptions);if(r)return"csiOptions."+r}if(t.searchTab!==undefined){if(!Array.isArray(t.searchTab))return"searchTab: array expected";for(var n=0;n<t.searchTab.length;++n){var r=o[40].verify(t.searchTab[n]);if(r)return"searchTab."+r}}if(t.cobrandInfo!==undefined){if(!Array.isArray(t.cobrandInfo))return"cobrandInfo: array expected";for(var n=0;n<t.cobrandInfo.length;++n){var r=o[41].verify(t.cobrandInfo[n]);if(r)return"cobrandInfo."+r}}if(t.validDatabase!==undefined){if(!Array.isArray(t.validDatabase))return"validDatabase: array expected";for(var n=0;n<t.validDatabase.length;++n){var r=o[42].verify(t.validDatabase[n]);if(r)return"validDatabase."+r}}if(t.configScript!==undefined){if(!Array.isArray(t.configScript))return"configScript: array expected";for(var n=0;n<t.configScript.length;++n){var r=o[43].verify(t.configScript[n]);if(r)return"configScript."+r}}if(t.deauthServerUrl!==undefined&&t.deauthServerUrl!==null){var r=o[44].verify(t.deauthServerUrl);if(r)return"deauthServerUrl."+r}if(t.swoopParameters!==undefined&&t.swoopParameters!==null){var r=o[45].verify(t.swoopParameters);if(r)return"swoopParameters."+r}if(t.bbsServerInfo!==undefined&&t.bbsServerInfo!==null){var r=o[46].verify(t.bbsServerInfo);if(r)return"bbsServerInfo."+r}if(t.dataErrorServerInfo!==undefined&&t.dataErrorServerInfo!==null){var r=o[47].verify(t.dataErrorServerInfo);if(r)return"dataErrorServerInfo."+r}if(t.planetaryDatabase!==undefined){if(!Array.isArray(t.planetaryDatabase))return"planetaryDatabase: array expected";for(var n=0;n<t.planetaryDatabase.length;++n){var r=o[48].verify(t.planetaryDatabase[n]);if(r)return"planetaryDatabase."+r}}if(t.logServer!==undefined&&t.logServer!==null){var r=o[49].verify(t.logServer);if(r)return"logServer."+r}if(t.autopiaOptions!==undefined&&t.autopiaOptions!==null){var r=o[50].verify(t.autopiaOptions);if(r)return"autopiaOptions."+r}if(t.searchConfig!==undefined&&t.searchConfig!==null){var r=o[51].verify(t.searchConfig);if(r)return"searchConfig."+r}if(t.searchInfo!==undefined&&t.searchInfo!==null){var r=o[52].verify(t.searchInfo);if(r)return"searchInfo."+r}if(t.elevationServiceBaseUrl!==undefined)if(!i.isString(t.elevationServiceBaseUrl))return"elevationServiceBaseUrl: string expected";if(t.elevationProfileQueryDelay!==undefined)if(!i.isInteger(t.elevationProfileQueryDelay))return"elevationProfileQueryDelay: integer expected";if(t.proUpgradeUrl!==undefined&&t.proUpgradeUrl!==null){var r=o[55].verify(t.proUpgradeUrl);if(r)return"proUpgradeUrl."+r}if(t.earthCommunityUrl!==undefined&&t.earthCommunityUrl!==null){var r=o[56].verify(t.earthCommunityUrl);if(r)return"earthCommunityUrl."+r}if(t.googleMapsUrl!==undefined&&t.googleMapsUrl!==null){var r=o[57].verify(t.googleMapsUrl);if(r)return"googleMapsUrl."+r}if(t.sharingUrl!==undefined&&t.sharingUrl!==null){var r=o[58].verify(t.sharingUrl);if(r)return"sharingUrl."+r}if(t.privacyPolicyUrl!==undefined&&t.privacyPolicyUrl!==null){var r=o[59].verify(t.privacyPolicyUrl);if(r)return"privacyPolicyUrl."+r}if(t.doGplusUserCheck!==undefined)if(typeof t.doGplusUserCheck!=="boolean")return"doGplusUserCheck: boolean expected";if(t.rocktreeDataProto!==undefined&&t.rocktreeDataProto!==null){var r=o[61].verify(t.rocktreeDataProto);if(r)return"rocktreeDataProto."+r}if(t.filmstripConfig!==undefined){if(!Array.isArray(t.filmstripConfig))return"filmstripConfig: array expected";for(var n=0;n<t.filmstripConfig.length;++n){var r=o[62].verify(t.filmstripConfig[n]);if(r)return"filmstripConfig."+r}}if(t.showSigninButton!==undefined)if(typeof t.showSigninButton!=="boolean")return"showSigninButton: boolean expected";if(t.proMeasureUpsellUrl!==undefined&&t.proMeasureUpsellUrl!==null){var r=o[64].verify(t.proMeasureUpsellUrl);if(r)return"proMeasureUpsellUrl."+r}if(t.proPrintUpsellUrl!==undefined&&t.proPrintUpsellUrl!==null){var r=o[65].verify(t.proPrintUpsellUrl);if(r)return"proPrintUpsellUrl."+r}if(t.starDataProto!==undefined&&t.starDataProto!==null){var r=o[66].verify(t.starDataProto);if(r)return"starDataProto."+r}if(t.feedbackUrl!==undefined&&t.feedbackUrl!==null){var r=o[67].verify(t.feedbackUrl);if(r)return"feedbackUrl."+r}if(t.oauth2LoginUrl!==undefined&&t.oauth2LoginUrl!==null){var r=o[68].verify(t.oauth2LoginUrl);if(r)return"oauth2LoginUrl."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto)return t;var r=new a.keyhole.dbroot.EndSnippetProto;if(t.model!==undefined&&t.model!==null){if(typeof t.model!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.model: object expected");r.model=o[0].fromObject(t.model)}if(t.authServerUrl!==undefined&&t.authServerUrl!==null){if(typeof t.authServerUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.authServerUrl: object expected");r.authServerUrl=o[1].fromObject(t.authServerUrl)}if(t.disableAuthentication!==undefined&&t.disableAuthentication!==null)r.disableAuthentication=Boolean(t.disableAuthentication);if(t.mfeDomains){if(!Array.isArray(t.mfeDomains))throw TypeError(".keyhole.dbroot.EndSnippetProto.mfeDomains: array expected");r.mfeDomains=[];for(var i=0;i<t.mfeDomains.length;++i){if(typeof t.mfeDomains[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.mfeDomains: object expected");r.mfeDomains[i]=o[3].fromObject(t.mfeDomains[i])}}if(t.mfeLangParam!==undefined&&t.mfeLangParam!==null)r.mfeLangParam=String(t.mfeLangParam);if(t.adsUrlPatterns!==undefined&&t.adsUrlPatterns!==null)r.adsUrlPatterns=String(t.adsUrlPatterns);if(t.reverseGeocoderUrl!==undefined&&t.reverseGeocoderUrl!==null){if(typeof t.reverseGeocoderUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.reverseGeocoderUrl: object expected");r.reverseGeocoderUrl=o[6].fromObject(t.reverseGeocoderUrl)}if(t.reverseGeocoderProtocolVersion!==undefined&&t.reverseGeocoderProtocolVersion!==null)r.reverseGeocoderProtocolVersion=t.reverseGeocoderProtocolVersion|0;if(t.skyDatabaseIsAvailable!==undefined&&t.skyDatabaseIsAvailable!==null)r.skyDatabaseIsAvailable=Boolean(t.skyDatabaseIsAvailable);if(t.skyDatabaseUrl!==undefined&&t.skyDatabaseUrl!==null){if(typeof t.skyDatabaseUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.skyDatabaseUrl: object expected");r.skyDatabaseUrl=o[9].fromObject(t.skyDatabaseUrl)}if(t.defaultWebPageIntlUrl!==undefined&&t.defaultWebPageIntlUrl!==null){if(typeof t.defaultWebPageIntlUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.defaultWebPageIntlUrl: object expected");r.defaultWebPageIntlUrl=o[10].fromObject(t.defaultWebPageIntlUrl)}if(t.numStartUpTips!==undefined&&t.numStartUpTips!==null)r.numStartUpTips=t.numStartUpTips|0;if(t.startUpTipsUrl!==undefined&&t.startUpTipsUrl!==null){if(typeof t.startUpTipsUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.startUpTipsUrl: object expected");r.startUpTipsUrl=o[12].fromObject(t.startUpTipsUrl)}if(t.numProStartUpTips!==undefined&&t.numProStartUpTips!==null)r.numProStartUpTips=t.numProStartUpTips|0;if(t.proStartUpTipsUrl!==undefined&&t.proStartUpTipsUrl!==null){if(typeof t.proStartUpTipsUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.proStartUpTipsUrl: object expected");r.proStartUpTipsUrl=o[14].fromObject(t.proStartUpTipsUrl)}if(t.startupTipsIntlUrl!==undefined&&t.startupTipsIntlUrl!==null){if(typeof t.startupTipsIntlUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.startupTipsIntlUrl: object expected");r.startupTipsIntlUrl=o[15].fromObject(t.startupTipsIntlUrl)}if(t.userGuideIntlUrl!==undefined&&t.userGuideIntlUrl!==null){if(typeof t.userGuideIntlUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.userGuideIntlUrl: object expected");r.userGuideIntlUrl=o[16].fromObject(t.userGuideIntlUrl)}if(t.supportCenterIntlUrl!==undefined&&t.supportCenterIntlUrl!==null){if(typeof t.supportCenterIntlUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.supportCenterIntlUrl: object expected");r.supportCenterIntlUrl=o[17].fromObject(t.supportCenterIntlUrl)}if(t.businessListingIntlUrl!==undefined&&t.businessListingIntlUrl!==null){if(typeof t.businessListingIntlUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.businessListingIntlUrl: object expected");r.businessListingIntlUrl=o[18].fromObject(t.businessListingIntlUrl)}if(t.supportAnswerIntlUrl!==undefined&&t.supportAnswerIntlUrl!==null){if(typeof t.supportAnswerIntlUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.supportAnswerIntlUrl: object expected");r.supportAnswerIntlUrl=o[19].fromObject(t.supportAnswerIntlUrl)}if(t.supportTopicIntlUrl!==undefined&&t.supportTopicIntlUrl!==null){if(typeof t.supportTopicIntlUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.supportTopicIntlUrl: object expected");r.supportTopicIntlUrl=o[20].fromObject(t.supportTopicIntlUrl)}if(t.supportRequestIntlUrl!==undefined&&t.supportRequestIntlUrl!==null){if(typeof t.supportRequestIntlUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.supportRequestIntlUrl: object expected");r.supportRequestIntlUrl=o[21].fromObject(t.supportRequestIntlUrl)}if(t.earthIntlUrl!==undefined&&t.earthIntlUrl!==null){if(typeof t.earthIntlUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.earthIntlUrl: object expected");r.earthIntlUrl=o[22].fromObject(t.earthIntlUrl)}if(t.addContentUrl!==undefined&&t.addContentUrl!==null){if(typeof t.addContentUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.addContentUrl: object expected");r.addContentUrl=o[23].fromObject(t.addContentUrl)}if(t.sketchupNotInstalledUrl!==undefined&&t.sketchupNotInstalledUrl!==null){if(typeof t.sketchupNotInstalledUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.sketchupNotInstalledUrl: object expected");r.sketchupNotInstalledUrl=o[24].fromObject(t.sketchupNotInstalledUrl)}if(t.sketchupErrorUrl!==undefined&&t.sketchupErrorUrl!==null){if(typeof t.sketchupErrorUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.sketchupErrorUrl: object expected");r.sketchupErrorUrl=o[25].fromObject(t.sketchupErrorUrl)}if(t.freeLicenseUrl!==undefined&&t.freeLicenseUrl!==null){if(typeof t.freeLicenseUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.freeLicenseUrl: object expected");r.freeLicenseUrl=o[26].fromObject(t.freeLicenseUrl)}if(t.proLicenseUrl!==undefined&&t.proLicenseUrl!==null){if(typeof t.proLicenseUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.proLicenseUrl: object expected");r.proLicenseUrl=o[27].fromObject(t.proLicenseUrl)}if(t.tutorialUrl!==undefined&&t.tutorialUrl!==null){if(typeof t.tutorialUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.tutorialUrl: object expected");r.tutorialUrl=o[28].fromObject(t.tutorialUrl)}if(t.keyboardShortcutsUrl!==undefined&&t.keyboardShortcutsUrl!==null){if(typeof t.keyboardShortcutsUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.keyboardShortcutsUrl: object expected");r.keyboardShortcutsUrl=o[29].fromObject(t.keyboardShortcutsUrl)}if(t.releaseNotesUrl!==undefined&&t.releaseNotesUrl!==null){if(typeof t.releaseNotesUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.releaseNotesUrl: object expected");r.releaseNotesUrl=o[30].fromObject(t.releaseNotesUrl)}if(t.hideUserData!==undefined&&t.hideUserData!==null)r.hideUserData=Boolean(t.hideUserData);if(t.useGeLogo!==undefined&&t.useGeLogo!==null)r.useGeLogo=Boolean(t.useGeLogo);if(t.dioramaDescriptionUrlBase!==undefined&&t.dioramaDescriptionUrlBase!==null){if(typeof t.dioramaDescriptionUrlBase!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.dioramaDescriptionUrlBase: object expected");r.dioramaDescriptionUrlBase=o[33].fromObject(t.dioramaDescriptionUrlBase)}if(t.dioramaDefaultColor!==undefined&&t.dioramaDefaultColor!==null)r.dioramaDefaultColor=t.dioramaDefaultColor>>>0;if(t.dioramaBlacklistUrl!==undefined&&t.dioramaBlacklistUrl!==null){if(typeof t.dioramaBlacklistUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.dioramaBlacklistUrl: object expected");r.dioramaBlacklistUrl=o[35].fromObject(t.dioramaBlacklistUrl)}if(t.clientOptions!==undefined&&t.clientOptions!==null){if(typeof t.clientOptions!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.clientOptions: object expected");r.clientOptions=o[36].fromObject(t.clientOptions)}if(t.fetchingOptions!==undefined&&t.fetchingOptions!==null){if(typeof t.fetchingOptions!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.fetchingOptions: object expected");r.fetchingOptions=o[37].fromObject(t.fetchingOptions)}if(t.timeMachineOptions!==undefined&&t.timeMachineOptions!==null){if(typeof t.timeMachineOptions!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.timeMachineOptions: object expected");r.timeMachineOptions=o[38].fromObject(t.timeMachineOptions)}if(t.csiOptions!==undefined&&t.csiOptions!==null){if(typeof t.csiOptions!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.csiOptions: object expected");r.csiOptions=o[39].fromObject(t.csiOptions)}if(t.searchTab){if(!Array.isArray(t.searchTab))throw TypeError(".keyhole.dbroot.EndSnippetProto.searchTab: array expected");r.searchTab=[];for(var i=0;i<t.searchTab.length;++i){if(typeof t.searchTab[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.searchTab: object expected");r.searchTab[i]=o[40].fromObject(t.searchTab[i])}}if(t.cobrandInfo){if(!Array.isArray(t.cobrandInfo))throw TypeError(".keyhole.dbroot.EndSnippetProto.cobrandInfo: array expected");r.cobrandInfo=[];for(var i=0;i<t.cobrandInfo.length;++i){if(typeof t.cobrandInfo[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.cobrandInfo: object expected");r.cobrandInfo[i]=o[41].fromObject(t.cobrandInfo[i])}}if(t.validDatabase){if(!Array.isArray(t.validDatabase))throw TypeError(".keyhole.dbroot.EndSnippetProto.validDatabase: array expected");r.validDatabase=[];for(var i=0;i<t.validDatabase.length;++i){if(typeof t.validDatabase[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.validDatabase: object expected");r.validDatabase[i]=o[42].fromObject(t.validDatabase[i])}}if(t.configScript){if(!Array.isArray(t.configScript))throw TypeError(".keyhole.dbroot.EndSnippetProto.configScript: array expected");r.configScript=[];for(var i=0;i<t.configScript.length;++i){if(typeof t.configScript[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.configScript: object expected");r.configScript[i]=o[43].fromObject(t.configScript[i])}}if(t.deauthServerUrl!==undefined&&t.deauthServerUrl!==null){if(typeof t.deauthServerUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.deauthServerUrl: object expected");r.deauthServerUrl=o[44].fromObject(t.deauthServerUrl)}if(t.swoopParameters!==undefined&&t.swoopParameters!==null){if(typeof t.swoopParameters!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.swoopParameters: object expected");r.swoopParameters=o[45].fromObject(t.swoopParameters)}if(t.bbsServerInfo!==undefined&&t.bbsServerInfo!==null){if(typeof t.bbsServerInfo!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.bbsServerInfo: object expected");r.bbsServerInfo=o[46].fromObject(t.bbsServerInfo)}if(t.dataErrorServerInfo!==undefined&&t.dataErrorServerInfo!==null){if(typeof t.dataErrorServerInfo!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.dataErrorServerInfo: object expected");r.dataErrorServerInfo=o[47].fromObject(t.dataErrorServerInfo)}if(t.planetaryDatabase){if(!Array.isArray(t.planetaryDatabase))throw TypeError(".keyhole.dbroot.EndSnippetProto.planetaryDatabase: array expected");r.planetaryDatabase=[];for(var i=0;i<t.planetaryDatabase.length;++i){if(typeof t.planetaryDatabase[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.planetaryDatabase: object expected");r.planetaryDatabase[i]=o[48].fromObject(t.planetaryDatabase[i])}}if(t.logServer!==undefined&&t.logServer!==null){if(typeof t.logServer!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.logServer: object expected");r.logServer=o[49].fromObject(t.logServer)}if(t.autopiaOptions!==undefined&&t.autopiaOptions!==null){if(typeof t.autopiaOptions!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.autopiaOptions: object expected");r.autopiaOptions=o[50].fromObject(t.autopiaOptions)}if(t.searchConfig!==undefined&&t.searchConfig!==null){if(typeof t.searchConfig!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.searchConfig: object expected");r.searchConfig=o[51].fromObject(t.searchConfig)}if(t.searchInfo!==undefined&&t.searchInfo!==null){if(typeof t.searchInfo!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.searchInfo: object expected");r.searchInfo=o[52].fromObject(t.searchInfo)}if(t.elevationServiceBaseUrl!==undefined&&t.elevationServiceBaseUrl!==null)r.elevationServiceBaseUrl=String(t.elevationServiceBaseUrl);if(t.elevationProfileQueryDelay!==undefined&&t.elevationProfileQueryDelay!==null)r.elevationProfileQueryDelay=t.elevationProfileQueryDelay|0;if(t.proUpgradeUrl!==undefined&&t.proUpgradeUrl!==null){if(typeof t.proUpgradeUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.proUpgradeUrl: object expected");r.proUpgradeUrl=o[55].fromObject(t.proUpgradeUrl)}if(t.earthCommunityUrl!==undefined&&t.earthCommunityUrl!==null){if(typeof t.earthCommunityUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.earthCommunityUrl: object expected");r.earthCommunityUrl=o[56].fromObject(t.earthCommunityUrl)}if(t.googleMapsUrl!==undefined&&t.googleMapsUrl!==null){if(typeof t.googleMapsUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.googleMapsUrl: object expected");r.googleMapsUrl=o[57].fromObject(t.googleMapsUrl)}if(t.sharingUrl!==undefined&&t.sharingUrl!==null){if(typeof t.sharingUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.sharingUrl: object expected");r.sharingUrl=o[58].fromObject(t.sharingUrl)}if(t.privacyPolicyUrl!==undefined&&t.privacyPolicyUrl!==null){if(typeof t.privacyPolicyUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.privacyPolicyUrl: object expected");r.privacyPolicyUrl=o[59].fromObject(t.privacyPolicyUrl)}if(t.doGplusUserCheck!==undefined&&t.doGplusUserCheck!==null)r.doGplusUserCheck=Boolean(t.doGplusUserCheck);if(t.rocktreeDataProto!==undefined&&t.rocktreeDataProto!==null){if(typeof t.rocktreeDataProto!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.rocktreeDataProto: object expected");r.rocktreeDataProto=o[61].fromObject(t.rocktreeDataProto)}if(t.filmstripConfig){if(!Array.isArray(t.filmstripConfig))throw TypeError(".keyhole.dbroot.EndSnippetProto.filmstripConfig: array expected");r.filmstripConfig=[];for(var i=0;i<t.filmstripConfig.length;++i){if(typeof t.filmstripConfig[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.filmstripConfig: object expected");r.filmstripConfig[i]=o[62].fromObject(t.filmstripConfig[i])}}if(t.showSigninButton!==undefined&&t.showSigninButton!==null)r.showSigninButton=Boolean(t.showSigninButton);if(t.proMeasureUpsellUrl!==undefined&&t.proMeasureUpsellUrl!==null){if(typeof t.proMeasureUpsellUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.proMeasureUpsellUrl: object expected");r.proMeasureUpsellUrl=o[64].fromObject(t.proMeasureUpsellUrl)}if(t.proPrintUpsellUrl!==undefined&&t.proPrintUpsellUrl!==null){if(typeof t.proPrintUpsellUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.proPrintUpsellUrl: object expected");r.proPrintUpsellUrl=o[65].fromObject(t.proPrintUpsellUrl)}if(t.starDataProto!==undefined&&t.starDataProto!==null){if(typeof t.starDataProto!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.starDataProto: object expected");r.starDataProto=o[66].fromObject(t.starDataProto)}if(t.feedbackUrl!==undefined&&t.feedbackUrl!==null){if(typeof t.feedbackUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.feedbackUrl: object expected");r.feedbackUrl=o[67].fromObject(t.feedbackUrl)}if(t.oauth2LoginUrl!==undefined&&t.oauth2LoginUrl!==null){if(typeof t.oauth2LoginUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.oauth2LoginUrl: object expected");r.oauth2LoginUrl=o[68].fromObject(t.oauth2LoginUrl)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults){i.mfeDomains=[];i.searchTab=[];i.cobrandInfo=[];i.validDatabase=[];i.configScript=[];i.planetaryDatabase=[];i.filmstripConfig=[]}if(r.defaults){i.model=null;i.authServerUrl=null;i.disableAuthentication=false;i.mfeLangParam="hl=$5Bhl5D";i.adsUrlPatterns="";i.reverseGeocoderUrl=null;i.reverseGeocoderProtocolVersion=3;i.skyDatabaseIsAvailable=true;i.skyDatabaseUrl=null;i.defaultWebPageIntlUrl=null;i.numStartUpTips=17;i.startUpTipsUrl=null;i.numProStartUpTips=0;i.proStartUpTipsUrl=null;i.startupTipsIntlUrl=null;i.userGuideIntlUrl=null;i.supportCenterIntlUrl=null;i.businessListingIntlUrl=null;i.supportAnswerIntlUrl=null;i.supportTopicIntlUrl=null;i.supportRequestIntlUrl=null;i.earthIntlUrl=null;i.addContentUrl=null;i.sketchupNotInstalledUrl=null;i.sketchupErrorUrl=null;i.freeLicenseUrl=null;i.proLicenseUrl=null;i.tutorialUrl=null;i.keyboardShortcutsUrl=null;i.releaseNotesUrl=null;i.hideUserData=false;i.useGeLogo=true;i.dioramaDescriptionUrlBase=null;i.dioramaDefaultColor=4291281607;i.dioramaBlacklistUrl=null;i.clientOptions=null;i.fetchingOptions=null;i.timeMachineOptions=null;i.csiOptions=null;i.deauthServerUrl=null;i.swoopParameters=null;i.bbsServerInfo=null;i.dataErrorServerInfo=null;i.logServer=null;i.autopiaOptions=null;i.searchConfig=null;i.searchInfo=null;i.elevationServiceBaseUrl="http://maps.google.com/maps/api/elevation/";i.elevationProfileQueryDelay=500;i.proUpgradeUrl=null;i.earthCommunityUrl=null;i.googleMapsUrl=null;i.sharingUrl=null;i.privacyPolicyUrl=null;i.doGplusUserCheck=false;i.rocktreeDataProto=null;i.showSigninButton=false;i.proMeasureUpsellUrl=null;i.proPrintUpsellUrl=null;i.starDataProto=null;i.feedbackUrl=null;i.oauth2LoginUrl=null}if(t.model!==undefined&&t.model!==null&&t.hasOwnProperty("model"))i.model=o[0].toObject(t.model,r);if(t.authServerUrl!==undefined&&t.authServerUrl!==null&&t.hasOwnProperty("authServerUrl"))i.authServerUrl=o[1].toObject(t.authServerUrl,r);if(t.disableAuthentication!==undefined&&t.disableAuthentication!==null&&t.hasOwnProperty("disableAuthentication"))i.disableAuthentication=t.disableAuthentication;if(t.mfeDomains!==undefined&&t.mfeDomains!==null&&t.hasOwnProperty("mfeDomains")){i.mfeDomains=[];for(var n=0;n<t.mfeDomains.length;++n)i.mfeDomains[n]=o[3].toObject(t.mfeDomains[n],r)}if(t.mfeLangParam!==undefined&&t.mfeLangParam!==null&&t.hasOwnProperty("mfeLangParam"))i.mfeLangParam=t.mfeLangParam;if(t.adsUrlPatterns!==undefined&&t.adsUrlPatterns!==null&&t.hasOwnProperty("adsUrlPatterns"))i.adsUrlPatterns=t.adsUrlPatterns;if(t.reverseGeocoderUrl!==undefined&&t.reverseGeocoderUrl!==null&&t.hasOwnProperty("reverseGeocoderUrl"))i.reverseGeocoderUrl=o[6].toObject(t.reverseGeocoderUrl,r);if(t.reverseGeocoderProtocolVersion!==undefined&&t.reverseGeocoderProtocolVersion!==null&&t.hasOwnProperty("reverseGeocoderProtocolVersion"))i.reverseGeocoderProtocolVersion=t.reverseGeocoderProtocolVersion;if(t.skyDatabaseIsAvailable!==undefined&&t.skyDatabaseIsAvailable!==null&&t.hasOwnProperty("skyDatabaseIsAvailable"))i.skyDatabaseIsAvailable=t.skyDatabaseIsAvailable;if(t.skyDatabaseUrl!==undefined&&t.skyDatabaseUrl!==null&&t.hasOwnProperty("skyDatabaseUrl"))i.skyDatabaseUrl=o[9].toObject(t.skyDatabaseUrl,r);if(t.defaultWebPageIntlUrl!==undefined&&t.defaultWebPageIntlUrl!==null&&t.hasOwnProperty("defaultWebPageIntlUrl"))i.defaultWebPageIntlUrl=o[10].toObject(t.defaultWebPageIntlUrl,r);if(t.numStartUpTips!==undefined&&t.numStartUpTips!==null&&t.hasOwnProperty("numStartUpTips"))i.numStartUpTips=t.numStartUpTips;if(t.startUpTipsUrl!==undefined&&t.startUpTipsUrl!==null&&t.hasOwnProperty("startUpTipsUrl"))i.startUpTipsUrl=o[12].toObject(t.startUpTipsUrl,r);if(t.numProStartUpTips!==undefined&&t.numProStartUpTips!==null&&t.hasOwnProperty("numProStartUpTips"))i.numProStartUpTips=t.numProStartUpTips;if(t.proStartUpTipsUrl!==undefined&&t.proStartUpTipsUrl!==null&&t.hasOwnProperty("proStartUpTipsUrl"))i.proStartUpTipsUrl=o[14].toObject(t.proStartUpTipsUrl,r);if(t.startupTipsIntlUrl!==undefined&&t.startupTipsIntlUrl!==null&&t.hasOwnProperty("startupTipsIntlUrl"))i.startupTipsIntlUrl=o[15].toObject(t.startupTipsIntlUrl,r);if(t.userGuideIntlUrl!==undefined&&t.userGuideIntlUrl!==null&&t.hasOwnProperty("userGuideIntlUrl"))i.userGuideIntlUrl=o[16].toObject(t.userGuideIntlUrl,r);if(t.supportCenterIntlUrl!==undefined&&t.supportCenterIntlUrl!==null&&t.hasOwnProperty("supportCenterIntlUrl"))i.supportCenterIntlUrl=o[17].toObject(t.supportCenterIntlUrl,r);if(t.businessListingIntlUrl!==undefined&&t.businessListingIntlUrl!==null&&t.hasOwnProperty("businessListingIntlUrl"))i.businessListingIntlUrl=o[18].toObject(t.businessListingIntlUrl,r);if(t.supportAnswerIntlUrl!==undefined&&t.supportAnswerIntlUrl!==null&&t.hasOwnProperty("supportAnswerIntlUrl"))i.supportAnswerIntlUrl=o[19].toObject(t.supportAnswerIntlUrl,r);if(t.supportTopicIntlUrl!==undefined&&t.supportTopicIntlUrl!==null&&t.hasOwnProperty("supportTopicIntlUrl"))i.supportTopicIntlUrl=o[20].toObject(t.supportTopicIntlUrl,r);if(t.supportRequestIntlUrl!==undefined&&t.supportRequestIntlUrl!==null&&t.hasOwnProperty("supportRequestIntlUrl"))i.supportRequestIntlUrl=o[21].toObject(t.supportRequestIntlUrl,r);if(t.earthIntlUrl!==undefined&&t.earthIntlUrl!==null&&t.hasOwnProperty("earthIntlUrl"))i.earthIntlUrl=o[22].toObject(t.earthIntlUrl,r);if(t.addContentUrl!==undefined&&t.addContentUrl!==null&&t.hasOwnProperty("addContentUrl"))i.addContentUrl=o[23].toObject(t.addContentUrl,r);if(t.sketchupNotInstalledUrl!==undefined&&t.sketchupNotInstalledUrl!==null&&t.hasOwnProperty("sketchupNotInstalledUrl"))i.sketchupNotInstalledUrl=o[24].toObject(t.sketchupNotInstalledUrl,r);if(t.sketchupErrorUrl!==undefined&&t.sketchupErrorUrl!==null&&t.hasOwnProperty("sketchupErrorUrl"))i.sketchupErrorUrl=o[25].toObject(t.sketchupErrorUrl,r);if(t.freeLicenseUrl!==undefined&&t.freeLicenseUrl!==null&&t.hasOwnProperty("freeLicenseUrl"))i.freeLicenseUrl=o[26].toObject(t.freeLicenseUrl,r);if(t.proLicenseUrl!==undefined&&t.proLicenseUrl!==null&&t.hasOwnProperty("proLicenseUrl"))i.proLicenseUrl=o[27].toObject(t.proLicenseUrl,r);if(t.tutorialUrl!==undefined&&t.tutorialUrl!==null&&t.hasOwnProperty("tutorialUrl"))i.tutorialUrl=o[28].toObject(t.tutorialUrl,r);if(t.keyboardShortcutsUrl!==undefined&&t.keyboardShortcutsUrl!==null&&t.hasOwnProperty("keyboardShortcutsUrl"))i.keyboardShortcutsUrl=o[29].toObject(t.keyboardShortcutsUrl,r);if(t.releaseNotesUrl!==undefined&&t.releaseNotesUrl!==null&&t.hasOwnProperty("releaseNotesUrl"))i.releaseNotesUrl=o[30].toObject(t.releaseNotesUrl,r);if(t.hideUserData!==undefined&&t.hideUserData!==null&&t.hasOwnProperty("hideUserData"))i.hideUserData=t.hideUserData;if(t.useGeLogo!==undefined&&t.useGeLogo!==null&&t.hasOwnProperty("useGeLogo"))i.useGeLogo=t.useGeLogo;if(t.dioramaDescriptionUrlBase!==undefined&&t.dioramaDescriptionUrlBase!==null&&t.hasOwnProperty("dioramaDescriptionUrlBase"))i.dioramaDescriptionUrlBase=o[33].toObject(t.dioramaDescriptionUrlBase,r);if(t.dioramaDefaultColor!==undefined&&t.dioramaDefaultColor!==null&&t.hasOwnProperty("dioramaDefaultColor"))i.dioramaDefaultColor=t.dioramaDefaultColor;if(t.dioramaBlacklistUrl!==undefined&&t.dioramaBlacklistUrl!==null&&t.hasOwnProperty("dioramaBlacklistUrl"))i.dioramaBlacklistUrl=o[35].toObject(t.dioramaBlacklistUrl,r);if(t.clientOptions!==undefined&&t.clientOptions!==null&&t.hasOwnProperty("clientOptions"))i.clientOptions=o[36].toObject(t.clientOptions,r);if(t.fetchingOptions!==undefined&&t.fetchingOptions!==null&&t.hasOwnProperty("fetchingOptions"))i.fetchingOptions=o[37].toObject(t.fetchingOptions,r);if(t.timeMachineOptions!==undefined&&t.timeMachineOptions!==null&&t.hasOwnProperty("timeMachineOptions"))i.timeMachineOptions=o[38].toObject(t.timeMachineOptions,r);if(t.csiOptions!==undefined&&t.csiOptions!==null&&t.hasOwnProperty("csiOptions"))i.csiOptions=o[39].toObject(t.csiOptions,r);if(t.searchTab!==undefined&&t.searchTab!==null&&t.hasOwnProperty("searchTab")){i.searchTab=[];for(var n=0;n<t.searchTab.length;++n)i.searchTab[n]=o[40].toObject(t.searchTab[n],r)}if(t.cobrandInfo!==undefined&&t.cobrandInfo!==null&&t.hasOwnProperty("cobrandInfo")){i.cobrandInfo=[];for(var n=0;n<t.cobrandInfo.length;++n)i.cobrandInfo[n]=o[41].toObject(t.cobrandInfo[n],r)}if(t.validDatabase!==undefined&&t.validDatabase!==null&&t.hasOwnProperty("validDatabase")){i.validDatabase=[];for(var n=0;n<t.validDatabase.length;++n)i.validDatabase[n]=o[42].toObject(t.validDatabase[n],r)}if(t.configScript!==undefined&&t.configScript!==null&&t.hasOwnProperty("configScript")){i.configScript=[];for(var n=0;n<t.configScript.length;++n)i.configScript[n]=o[43].toObject(t.configScript[n],r)}if(t.deauthServerUrl!==undefined&&t.deauthServerUrl!==null&&t.hasOwnProperty("deauthServerUrl"))i.deauthServerUrl=o[44].toObject(t.deauthServerUrl,r);if(t.swoopParameters!==undefined&&t.swoopParameters!==null&&t.hasOwnProperty("swoopParameters"))i.swoopParameters=o[45].toObject(t.swoopParameters,r);if(t.bbsServerInfo!==undefined&&t.bbsServerInfo!==null&&t.hasOwnProperty("bbsServerInfo"))i.bbsServerInfo=o[46].toObject(t.bbsServerInfo,r);if(t.dataErrorServerInfo!==undefined&&t.dataErrorServerInfo!==null&&t.hasOwnProperty("dataErrorServerInfo"))i.dataErrorServerInfo=o[47].toObject(t.dataErrorServerInfo,r);if(t.planetaryDatabase!==undefined&&t.planetaryDatabase!==null&&t.hasOwnProperty("planetaryDatabase")){i.planetaryDatabase=[];for(var n=0;n<t.planetaryDatabase.length;++n)i.planetaryDatabase[n]=o[48].toObject(t.planetaryDatabase[n],r)}if(t.logServer!==undefined&&t.logServer!==null&&t.hasOwnProperty("logServer"))i.logServer=o[49].toObject(t.logServer,r);if(t.autopiaOptions!==undefined&&t.autopiaOptions!==null&&t.hasOwnProperty("autopiaOptions"))i.autopiaOptions=o[50].toObject(t.autopiaOptions,r);if(t.searchConfig!==undefined&&t.searchConfig!==null&&t.hasOwnProperty("searchConfig"))i.searchConfig=o[51].toObject(t.searchConfig,r);if(t.searchInfo!==undefined&&t.searchInfo!==null&&t.hasOwnProperty("searchInfo"))i.searchInfo=o[52].toObject(t.searchInfo,r);if(t.elevationServiceBaseUrl!==undefined&&t.elevationServiceBaseUrl!==null&&t.hasOwnProperty("elevationServiceBaseUrl"))i.elevationServiceBaseUrl=t.elevationServiceBaseUrl;if(t.elevationProfileQueryDelay!==undefined&&t.elevationProfileQueryDelay!==null&&t.hasOwnProperty("elevationProfileQueryDelay"))i.elevationProfileQueryDelay=t.elevationProfileQueryDelay;if(t.proUpgradeUrl!==undefined&&t.proUpgradeUrl!==null&&t.hasOwnProperty("proUpgradeUrl"))i.proUpgradeUrl=o[55].toObject(t.proUpgradeUrl,r);if(t.earthCommunityUrl!==undefined&&t.earthCommunityUrl!==null&&t.hasOwnProperty("earthCommunityUrl"))i.earthCommunityUrl=o[56].toObject(t.earthCommunityUrl,r);if(t.googleMapsUrl!==undefined&&t.googleMapsUrl!==null&&t.hasOwnProperty("googleMapsUrl"))i.googleMapsUrl=o[57].toObject(t.googleMapsUrl,r);if(t.sharingUrl!==undefined&&t.sharingUrl!==null&&t.hasOwnProperty("sharingUrl"))i.sharingUrl=o[58].toObject(t.sharingUrl,r);if(t.privacyPolicyUrl!==undefined&&t.privacyPolicyUrl!==null&&t.hasOwnProperty("privacyPolicyUrl"))i.privacyPolicyUrl=o[59].toObject(t.privacyPolicyUrl,r);if(t.doGplusUserCheck!==undefined&&t.doGplusUserCheck!==null&&t.hasOwnProperty("doGplusUserCheck"))i.doGplusUserCheck=t.doGplusUserCheck;if(t.rocktreeDataProto!==undefined&&t.rocktreeDataProto!==null&&t.hasOwnProperty("rocktreeDataProto"))i.rocktreeDataProto=o[61].toObject(t.rocktreeDataProto,r);if(t.filmstripConfig!==undefined&&t.filmstripConfig!==null&&t.hasOwnProperty("filmstripConfig")){i.filmstripConfig=[];for(var n=0;n<t.filmstripConfig.length;++n)i.filmstripConfig[n]=o[62].toObject(t.filmstripConfig[n],r)}if(t.showSigninButton!==undefined&&t.showSigninButton!==null&&t.hasOwnProperty("showSigninButton"))i.showSigninButton=t.showSigninButton;if(t.proMeasureUpsellUrl!==undefined&&t.proMeasureUpsellUrl!==null&&t.hasOwnProperty("proMeasureUpsellUrl"))i.proMeasureUpsellUrl=o[64].toObject(t.proMeasureUpsellUrl,r);if(t.proPrintUpsellUrl!==undefined&&t.proPrintUpsellUrl!==null&&t.hasOwnProperty("proPrintUpsellUrl"))i.proPrintUpsellUrl=o[65].toObject(t.proPrintUpsellUrl,r);if(t.starDataProto!==undefined&&t.starDataProto!==null&&t.hasOwnProperty("starDataProto"))i.starDataProto=o[66].toObject(t.starDataProto,r);if(t.feedbackUrl!==undefined&&t.feedbackUrl!==null&&t.hasOwnProperty("feedbackUrl"))i.feedbackUrl=o[67].toObject(t.feedbackUrl,r);if(t.oauth2LoginUrl!==undefined&&t.oauth2LoginUrl!==null&&t.hasOwnProperty("oauth2LoginUrl"))i.oauth2LoginUrl=o[68].toObject(t.oauth2LoginUrl,r);return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.SearchConfigProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.searchServer=i.emptyArray;r.prototype.oneboxService=i.emptyArray;r.prototype.kmlSearchUrl=null;r.prototype.kmlRenderUrl=null;r.prototype.searchHistoryUrl=null;r.prototype.errorPageUrl=null;var o={0:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer",1:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto",2:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.StringIdOrValueProto",5:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:if(!(s.searchServer&&s.searchServer.length))s.searchServer=[];s.searchServer.push(o[0].decode(r,r.uint32()));break;case 2:if(!(s.oneboxService&&s.oneboxService.length))s.oneboxService=[];s.oneboxService.push(o[1].decode(r,r.uint32()));break;case 3:s.kmlSearchUrl=o[2].decode(r,r.uint32());break;case 4:s.kmlRenderUrl=o[3].decode(r,r.uint32());break;case 6:s.searchHistoryUrl=o[4].decode(r,r.uint32());break;case 5:s.errorPageUrl=o[5].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.searchServer!==undefined){if(!Array.isArray(t.searchServer))return"searchServer: array expected";for(var r=0;r<t.searchServer.length;++r){var i=o[0].verify(t.searchServer[r]);if(i)return"searchServer."+i}}if(t.oneboxService!==undefined){if(!Array.isArray(t.oneboxService))return"oneboxService: array expected";for(var r=0;r<t.oneboxService.length;++r){var i=o[1].verify(t.oneboxService[r]);if(i)return"oneboxService."+i}}if(t.kmlSearchUrl!==undefined&&t.kmlSearchUrl!==null){var i=o[2].verify(t.kmlSearchUrl);if(i)return"kmlSearchUrl."+i}if(t.kmlRenderUrl!==undefined&&t.kmlRenderUrl!==null){var i=o[3].verify(t.kmlRenderUrl);if(i)return"kmlRenderUrl."+i}if(t.searchHistoryUrl!==undefined&&t.searchHistoryUrl!==null){var i=o[4].verify(t.searchHistoryUrl);if(i)return"searchHistoryUrl."+i}if(t.errorPageUrl!==undefined&&t.errorPageUrl!==null){var i=o[5].verify(t.errorPageUrl);if(i)return"errorPageUrl."+i}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.SearchConfigProto)return t;var r=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto;if(t.searchServer){if(!Array.isArray(t.searchServer))throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.searchServer: array expected");r.searchServer=[];for(var i=0;i<t.searchServer.length;++i){if(typeof t.searchServer[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.searchServer: object expected");r.searchServer[i]=o[0].fromObject(t.searchServer[i])}}if(t.oneboxService){if(!Array.isArray(t.oneboxService))throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.oneboxService: array expected");r.oneboxService=[];for(var i=0;i<t.oneboxService.length;++i){if(typeof t.oneboxService[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.oneboxService: object expected");r.oneboxService[i]=o[1].fromObject(t.oneboxService[i])}}if(t.kmlSearchUrl!==undefined&&t.kmlSearchUrl!==null){if(typeof t.kmlSearchUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.kmlSearchUrl: object expected");r.kmlSearchUrl=o[2].fromObject(t.kmlSearchUrl)}if(t.kmlRenderUrl!==undefined&&t.kmlRenderUrl!==null){if(typeof t.kmlRenderUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.kmlRenderUrl: object expected");r.kmlRenderUrl=o[3].fromObject(t.kmlRenderUrl)}if(t.searchHistoryUrl!==undefined&&t.searchHistoryUrl!==null){if(typeof t.searchHistoryUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.searchHistoryUrl: object expected");r.searchHistoryUrl=o[4].fromObject(t.searchHistoryUrl)}if(t.errorPageUrl!==undefined&&t.errorPageUrl!==null){if(typeof t.errorPageUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.errorPageUrl: object expected");r.errorPageUrl=o[5].fromObject(t.errorPageUrl)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults){i.searchServer=[];i.oneboxService=[]}if(r.defaults){i.kmlSearchUrl=null;i.kmlRenderUrl=null;i.searchHistoryUrl=null;i.errorPageUrl=null}if(t.searchServer!==undefined&&t.searchServer!==null&&t.hasOwnProperty("searchServer")){i.searchServer=[];for(var n=0;n<t.searchServer.length;++n)i.searchServer[n]=o[0].toObject(t.searchServer[n],r)}if(t.oneboxService!==undefined&&t.oneboxService!==null&&t.hasOwnProperty("oneboxService")){i.oneboxService=[];for(var n=0;n<t.oneboxService.length;++n)i.oneboxService[n]=o[1].toObject(t.oneboxService[n],r)}if(t.kmlSearchUrl!==undefined&&t.kmlSearchUrl!==null&&t.hasOwnProperty("kmlSearchUrl"))i.kmlSearchUrl=o[2].toObject(t.kmlSearchUrl,r);if(t.kmlRenderUrl!==undefined&&t.kmlRenderUrl!==null&&t.hasOwnProperty("kmlRenderUrl"))i.kmlRenderUrl=o[3].toObject(t.kmlRenderUrl,r);if(t.searchHistoryUrl!==undefined&&t.searchHistoryUrl!==null&&t.hasOwnProperty("searchHistoryUrl"))i.searchHistoryUrl=o[4].toObject(t.searchHistoryUrl,r);if(t.errorPageUrl!==undefined&&t.errorPageUrl!==null&&t.hasOwnProperty("errorPageUrl"))i.errorPageUrl=o[5].toObject(t.errorPageUrl,r);return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.SearchServer=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.name=null;r.prototype.url=null;r.prototype.type=0;r.prototype.htmlTransformUrl=null;r.prototype.kmlTransformUrl=null;r.prototype.supplementalUi=null;r.prototype.suggestion=i.emptyArray;r.prototype.searchlet=i.emptyArray;r.prototype.requirements=null;r.prototype.suggestServer=null;var o={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto",2:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.ResultType",3:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.StringIdOrValueProto",5:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi",6:"keyhole.dbroot.StringIdOrValueProto",7:"keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto",8:"keyhole.dbroot.RequirementProto",9:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.name=o[0].decode(r,r.uint32());break;case 2:s.url=o[1].decode(r,r.uint32());break;case 3:s.type=r.uint32();break;case 4:s.htmlTransformUrl=o[3].decode(r,r.uint32());break;case 5:s.kmlTransformUrl=o[4].decode(r,r.uint32());break;case 6:s.supplementalUi=o[5].decode(r,r.uint32());break;case 9:if(!(s.suggestion&&s.suggestion.length))s.suggestion=[];s.suggestion.push(o[6].decode(r,r.uint32()));break;case 7:if(!(s.searchlet&&s.searchlet.length))s.searchlet=[];s.searchlet.push(o[7].decode(r,r.uint32()));break;case 8:s.requirements=o[8].decode(r,r.uint32());break;case 10:s.suggestServer=o[9].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.name!==undefined&&t.name!==null){var r=o[0].verify(t.name);if(r)return"name."+r}if(t.url!==undefined&&t.url!==null){var r=o[1].verify(t.url);if(r)return"url."+r}if(t.type!==undefined)switch(t.type){default:return"type: enum value expected";case 0:case 1:break}if(t.htmlTransformUrl!==undefined&&t.htmlTransformUrl!==null){var r=o[3].verify(t.htmlTransformUrl);if(r)return"htmlTransformUrl."+r}if(t.kmlTransformUrl!==undefined&&t.kmlTransformUrl!==null){var r=o[4].verify(t.kmlTransformUrl);if(r)return"kmlTransformUrl."+r}if(t.supplementalUi!==undefined&&t.supplementalUi!==null){var r=o[5].verify(t.supplementalUi);if(r)return"supplementalUi."+r}if(t.suggestion!==undefined){if(!Array.isArray(t.suggestion))return"suggestion: array expected";for(var i=0;i<t.suggestion.length;++i){var r=o[6].verify(t.suggestion[i]);if(r)return"suggestion."+r}}if(t.searchlet!==undefined){if(!Array.isArray(t.searchlet))return"searchlet: array expected";for(var i=0;i<t.searchlet.length;++i){var r=o[7].verify(t.searchlet[i]);if(r)return"searchlet."+r}}if(t.requirements!==undefined&&t.requirements!==null){var r=o[8].verify(t.requirements);if(r)return"requirements."+r}if(t.suggestServer!==undefined&&t.suggestServer!==null){var r=o[9].verify(t.suggestServer);if(r)return"suggestServer."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer)return t;var r=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer;if(t.name!==undefined&&t.name!==null){if(typeof t.name!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.name: object expected");r.name=o[0].fromObject(t.name)}if(t.url!==undefined&&t.url!==null){if(typeof t.url!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.url: object expected");r.url=o[1].fromObject(t.url)}switch(t.type){case"RESULT_TYPE_KML":case 0:r.type=0;break;case"RESULT_TYPE_XML":case 1:r.type=1;break}if(t.htmlTransformUrl!==undefined&&t.htmlTransformUrl!==null){if(typeof t.htmlTransformUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.htmlTransformUrl: object expected");r.htmlTransformUrl=o[3].fromObject(t.htmlTransformUrl)}if(t.kmlTransformUrl!==undefined&&t.kmlTransformUrl!==null){if(typeof t.kmlTransformUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.kmlTransformUrl: object expected");r.kmlTransformUrl=o[4].fromObject(t.kmlTransformUrl)}if(t.supplementalUi!==undefined&&t.supplementalUi!==null){if(typeof t.supplementalUi!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.supplementalUi: object expected");r.supplementalUi=o[5].fromObject(t.supplementalUi)}if(t.suggestion){if(!Array.isArray(t.suggestion))throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.suggestion: array expected");r.suggestion=[];for(var i=0;i<t.suggestion.length;++i){if(typeof t.suggestion[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.suggestion: object expected");r.suggestion[i]=o[6].fromObject(t.suggestion[i])}}if(t.searchlet){if(!Array.isArray(t.searchlet))throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.searchlet: array expected");r.searchlet=[];for(var i=0;i<t.searchlet.length;++i){if(typeof t.searchlet[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.searchlet: object expected");r.searchlet[i]=o[7].fromObject(t.searchlet[i])}}if(t.requirements!==undefined&&t.requirements!==null){if(typeof t.requirements!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.requirements: object expected");r.requirements=o[8].fromObject(t.requirements)}if(t.suggestServer!==undefined&&t.suggestServer!==null){if(typeof t.suggestServer!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.suggestServer: object expected");r.suggestServer=o[9].fromObject(t.suggestServer)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults){i.suggestion=[];i.searchlet=[]}if(r.defaults){i.name=null;i.url=null;i.type=r.enums===String?"RESULT_TYPE_KML":0;i.htmlTransformUrl=null;i.kmlTransformUrl=null;i.supplementalUi=null;i.requirements=null;i.suggestServer=null}if(t.name!==undefined&&t.name!==null&&t.hasOwnProperty("name"))i.name=o[0].toObject(t.name,r);if(t.url!==undefined&&t.url!==null&&t.hasOwnProperty("url"))i.url=o[1].toObject(t.url,r);if(t.type!==undefined&&t.type!==null&&t.hasOwnProperty("type"))i.type=r.enums===String?o[2][t.type]:t.type;if(t.htmlTransformUrl!==undefined&&t.htmlTransformUrl!==null&&t.hasOwnProperty("htmlTransformUrl"))i.htmlTransformUrl=o[3].toObject(t.htmlTransformUrl,r);if(t.kmlTransformUrl!==undefined&&t.kmlTransformUrl!==null&&t.hasOwnProperty("kmlTransformUrl"))i.kmlTransformUrl=o[4].toObject(t.kmlTransformUrl,r);if(t.supplementalUi!==undefined&&t.supplementalUi!==null&&t.hasOwnProperty("supplementalUi"))i.supplementalUi=o[5].toObject(t.supplementalUi,r);if(t.suggestion!==undefined&&t.suggestion!==null&&t.hasOwnProperty("suggestion")){i.suggestion=[];for(var n=0;n<t.suggestion.length;++n)i.suggestion[n]=o[6].toObject(t.suggestion[n],r)}if(t.searchlet!==undefined&&t.searchlet!==null&&t.hasOwnProperty("searchlet")){i.searchlet=[];for(var n=0;n<t.searchlet.length;++n)i.searchlet[n]=o[7].toObject(t.searchlet[n],r)}if(t.requirements!==undefined&&t.requirements!==null&&t.hasOwnProperty("requirements"))i.requirements=o[8].toObject(t.requirements,r);if(t.suggestServer!==undefined&&t.suggestServer!==null&&t.hasOwnProperty("suggestServer"))i.suggestServer=o[9].toObject(t.suggestServer,r);return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.ResultType=function(){var e={},t=Object.create(e);t["RESULT_TYPE_KML"]=0;t["RESULT_TYPE_XML"]=1;return t}();r.SupplementalUi=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.url=null;r.prototype.label=null;r.prototype.height=160;var o={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.url=o[0].decode(r,r.uint32());break;case 2:s.label=o[1].decode(r,r.uint32());break;case 3:s.height=r.int32();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.url!==undefined&&t.url!==null){var r=o[0].verify(t.url);if(r)return"url."+r}if(t.label!==undefined&&t.label!==null){var r=o[1].verify(t.label);if(r)return"label."+r}if(t.height!==undefined)if(!i.isInteger(t.height))return"height: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi)return t;var r=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi;if(t.url!==undefined&&t.url!==null){if(typeof t.url!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi.url: object expected");r.url=o[0].fromObject(t.url)}if(t.label!==undefined&&t.label!==null){if(typeof t.label!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SupplementalUi.label: object expected");r.label=o[1].fromObject(t.label)}if(t.height!==undefined&&t.height!==null)r.height=t.height|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.url=null;i.label=null;i.height=160}if(t.url!==undefined&&t.url!==null&&t.hasOwnProperty("url"))i.url=o[0].toObject(t.url,r);if(t.label!==undefined&&t.label!==null&&t.hasOwnProperty("label"))i.label=o[1].toObject(t.label,r);if(t.height!==undefined&&t.height!==null&&t.hasOwnProperty("height"))i.height=t.height;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.SearchletProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.url=null;r.prototype.name=null;r.prototype.requirements=null;var i={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.StringIdOrValueProto",2:"keyhole.dbroot.RequirementProto"};n.push(i);r.decode=function e(r,n){if(!(r instanceof t))r=t.create(r);var o=n===undefined?r.len:r.pos+n,s=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto;while(r.pos<o){var l=r.uint32();switch(l>>>3){case 1:s.url=i[0].decode(r,r.uint32());break;case 2:s.name=i[1].decode(r,r.uint32());break;case 3:s.requirements=i[2].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.url!==undefined&&t.url!==null){var r=i[0].verify(t.url);if(r)return"url."+r}if(t.name!==undefined&&t.name!==null){var r=i[1].verify(t.name);if(r)return"name."+r}if(t.requirements!==undefined&&t.requirements!==null){var r=i[2].verify(t.requirements);if(r)return"requirements."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto)return t;var r=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto;if(t.url!==undefined&&t.url!==null){if(typeof t.url!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto.url: object expected");r.url=i[0].fromObject(t.url)}if(t.name!==undefined&&t.name!==null){if(typeof t.name!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto.name: object expected");r.name=i[1].fromObject(t.name)}if(t.requirements!==undefined&&t.requirements!==null){if(typeof t.requirements!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.SearchServer.SearchletProto.requirements: object expected");r.requirements=i[2].fromObject(t.requirements)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var n={};if(r.defaults){n.url=null;n.name=null;n.requirements=null}if(t.url!==undefined&&t.url!==null&&t.hasOwnProperty("url"))n.url=i[0].toObject(t.url,r);if(t.name!==undefined&&t.name!==null&&t.hasOwnProperty("name"))n.name=i[1].toObject(t.name,r);if(t.requirements!==undefined&&t.requirements!==null&&t.hasOwnProperty("requirements"))n.requirements=i[2].toObject(t.requirements,r);return n};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();return r}();r.OneboxServiceProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.serviceUrl=null;r.prototype.requirements=null;var i={0:"keyhole.dbroot.StringIdOrValueProto",1:"keyhole.dbroot.RequirementProto"};n.push(i);r.decode=function e(r,n){if(!(r instanceof t))r=t.create(r);var o=n===undefined?r.len:r.pos+n,s=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto;while(r.pos<o){var l=r.uint32();switch(l>>>3){case 1:s.serviceUrl=i[0].decode(r,r.uint32());break;case 2:s.requirements=i[1].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.serviceUrl!==undefined&&t.serviceUrl!==null){var r=i[0].verify(t.serviceUrl);if(r)return"serviceUrl."+r}if(t.requirements!==undefined&&t.requirements!==null){var r=i[1].verify(t.requirements);if(r)return"requirements."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto)return t;var r=new a.keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto;if(t.serviceUrl!==undefined&&t.serviceUrl!==null){if(typeof t.serviceUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto.serviceUrl: object expected");r.serviceUrl=i[0].fromObject(t.serviceUrl)}if(t.requirements!==undefined&&t.requirements!==null){if(typeof t.requirements!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.SearchConfigProto.OneboxServiceProto.requirements: object expected");r.requirements=i[1].fromObject(t.requirements)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var n={};if(r.defaults){n.serviceUrl=null;n.requirements=null}if(t.serviceUrl!==undefined&&t.serviceUrl!==null&&t.hasOwnProperty("serviceUrl"))n.serviceUrl=i[0].toObject(t.serviceUrl,r);if(t.requirements!==undefined&&t.requirements!==null&&t.hasOwnProperty("requirements"))n.requirements=i[1].toObject(t.requirements,r);return n};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();return r}();r.SearchInfoProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.defaultUrl="http://maps.google.com/maps";r.prototype.geocodeParam="q";r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.EndSnippetProto.SearchInfoProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.defaultUrl=r.string();break;case 2:o.geocodeParam=r.string();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.defaultUrl!==undefined)if(!i.isString(t.defaultUrl))return"defaultUrl: string expected";if(t.geocodeParam!==undefined)if(!i.isString(t.geocodeParam))return"geocodeParam: string expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.SearchInfoProto)return t;var r=new a.keyhole.dbroot.EndSnippetProto.SearchInfoProto;if(t.defaultUrl!==undefined&&t.defaultUrl!==null)r.defaultUrl=String(t.defaultUrl);if(t.geocodeParam!==undefined&&t.geocodeParam!==null)r.geocodeParam=String(t.geocodeParam);return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.defaultUrl="http://maps.google.com/maps";i.geocodeParam="q"}if(t.defaultUrl!==undefined&&t.defaultUrl!==null&&t.hasOwnProperty("defaultUrl"))i.defaultUrl=t.defaultUrl;if(t.geocodeParam!==undefined&&t.geocodeParam!==null&&t.hasOwnProperty("geocodeParam"))i.geocodeParam=t.geocodeParam;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.RockTreeDataProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.url=null;var i={0:"keyhole.dbroot.StringIdOrValueProto"};n.push(i);r.decode=function e(r,n){if(!(r instanceof t))r=t.create(r);var o=n===undefined?r.len:r.pos+n,s=new a.keyhole.dbroot.EndSnippetProto.RockTreeDataProto;while(r.pos<o){var l=r.uint32();switch(l>>>3){case 1:s.url=i[0].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.url!==undefined&&t.url!==null){var r=i[0].verify(t.url);if(r)return"url."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.RockTreeDataProto)return t;var r=new a.keyhole.dbroot.EndSnippetProto.RockTreeDataProto;if(t.url!==undefined&&t.url!==null){if(typeof t.url!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.RockTreeDataProto.url: object expected");r.url=i[0].fromObject(t.url)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var n={};if(r.defaults)n.url=null;if(t.url!==undefined&&t.url!==null&&t.hasOwnProperty("url"))n.url=i[0].toObject(t.url,r);return n};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.FilmstripConfigProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.requirements=null;r.prototype.alleycatUrlTemplate=null;r.prototype.fallbackAlleycatUrlTemplate=null;r.prototype.metadataUrlTemplate=null;r.prototype.thumbnailUrlTemplate=null;r.prototype.kmlUrlTemplate=null;r.prototype.featuredToursUrl=null;r.prototype.enableViewportFallback=false;r.prototype.viewportFallbackDistance=0;r.prototype.imageryType=i.emptyArray;var o={0:"keyhole.dbroot.RequirementProto",1:"keyhole.dbroot.StringIdOrValueProto",2:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.StringIdOrValueProto",5:"keyhole.dbroot.StringIdOrValueProto",6:"keyhole.dbroot.StringIdOrValueProto",9:"keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.requirements=o[0].decode(r,r.uint32());break;case 2:s.alleycatUrlTemplate=o[1].decode(r,r.uint32());break;case 9:s.fallbackAlleycatUrlTemplate=o[2].decode(r,r.uint32());break;case 3:s.metadataUrlTemplate=o[3].decode(r,r.uint32());break;case 4:s.thumbnailUrlTemplate=o[4].decode(r,r.uint32());break;case 5:s.kmlUrlTemplate=o[5].decode(r,r.uint32());break;case 6:s.featuredToursUrl=o[6].decode(r,r.uint32());break;case 7:s.enableViewportFallback=r.bool();break;case 8:s.viewportFallbackDistance=r.uint32();break;case 10:if(!(s.imageryType&&s.imageryType.length))s.imageryType=[];s.imageryType.push(o[9].decode(r,r.uint32()));break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.requirements!==undefined&&t.requirements!==null){var r=o[0].verify(t.requirements);if(r)return"requirements."+r}if(t.alleycatUrlTemplate!==undefined&&t.alleycatUrlTemplate!==null){var r=o[1].verify(t.alleycatUrlTemplate);if(r)return"alleycatUrlTemplate."+r}if(t.fallbackAlleycatUrlTemplate!==undefined&&t.fallbackAlleycatUrlTemplate!==null){var r=o[2].verify(t.fallbackAlleycatUrlTemplate);if(r)return"fallbackAlleycatUrlTemplate."+r}if(t.metadataUrlTemplate!==undefined&&t.metadataUrlTemplate!==null){var r=o[3].verify(t.metadataUrlTemplate);if(r)return"metadataUrlTemplate."+r}if(t.thumbnailUrlTemplate!==undefined&&t.thumbnailUrlTemplate!==null){var r=o[4].verify(t.thumbnailUrlTemplate);if(r)return"thumbnailUrlTemplate."+r}if(t.kmlUrlTemplate!==undefined&&t.kmlUrlTemplate!==null){var r=o[5].verify(t.kmlUrlTemplate);if(r)return"kmlUrlTemplate."+r}if(t.featuredToursUrl!==undefined&&t.featuredToursUrl!==null){var r=o[6].verify(t.featuredToursUrl);if(r)return"featuredToursUrl."+r}if(t.enableViewportFallback!==undefined)if(typeof t.enableViewportFallback!=="boolean")return"enableViewportFallback: boolean expected";if(t.viewportFallbackDistance!==undefined)if(!i.isInteger(t.viewportFallbackDistance))return"viewportFallbackDistance: integer expected";if(t.imageryType!==undefined){if(!Array.isArray(t.imageryType))return"imageryType: array expected";for(var n=0;n<t.imageryType.length;++n){var r=o[9].verify(t.imageryType[n]);if(r)return"imageryType."+r}}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto)return t;var r=new a.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto;if(t.requirements!==undefined&&t.requirements!==null){if(typeof t.requirements!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.requirements: object expected");r.requirements=o[0].fromObject(t.requirements)}if(t.alleycatUrlTemplate!==undefined&&t.alleycatUrlTemplate!==null){if(typeof t.alleycatUrlTemplate!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.alleycatUrlTemplate: object expected");r.alleycatUrlTemplate=o[1].fromObject(t.alleycatUrlTemplate)}if(t.fallbackAlleycatUrlTemplate!==undefined&&t.fallbackAlleycatUrlTemplate!==null){if(typeof t.fallbackAlleycatUrlTemplate!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.fallbackAlleycatUrlTemplate: object expected");r.fallbackAlleycatUrlTemplate=o[2].fromObject(t.fallbackAlleycatUrlTemplate)}if(t.metadataUrlTemplate!==undefined&&t.metadataUrlTemplate!==null){if(typeof t.metadataUrlTemplate!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.metadataUrlTemplate: object expected");r.metadataUrlTemplate=o[3].fromObject(t.metadataUrlTemplate)}if(t.thumbnailUrlTemplate!==undefined&&t.thumbnailUrlTemplate!==null){if(typeof t.thumbnailUrlTemplate!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.thumbnailUrlTemplate: object expected");r.thumbnailUrlTemplate=o[4].fromObject(t.thumbnailUrlTemplate)}if(t.kmlUrlTemplate!==undefined&&t.kmlUrlTemplate!==null){if(typeof t.kmlUrlTemplate!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.kmlUrlTemplate: object expected");r.kmlUrlTemplate=o[5].fromObject(t.kmlUrlTemplate)}if(t.featuredToursUrl!==undefined&&t.featuredToursUrl!==null){if(typeof t.featuredToursUrl!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.featuredToursUrl: object expected");r.featuredToursUrl=o[6].fromObject(t.featuredToursUrl)}if(t.enableViewportFallback!==undefined&&t.enableViewportFallback!==null)r.enableViewportFallback=Boolean(t.enableViewportFallback);if(t.viewportFallbackDistance!==undefined&&t.viewportFallbackDistance!==null)r.viewportFallbackDistance=t.viewportFallbackDistance>>>0;if(t.imageryType){if(!Array.isArray(t.imageryType))throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.imageryType: array expected");r.imageryType=[];for(var i=0;i<t.imageryType.length;++i){if(typeof t.imageryType[i]!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.imageryType: object expected");r.imageryType[i]=o[9].fromObject(t.imageryType[i])}}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults)i.imageryType=[];if(r.defaults){i.requirements=null;i.alleycatUrlTemplate=null;i.fallbackAlleycatUrlTemplate=null;i.metadataUrlTemplate=null;i.thumbnailUrlTemplate=null;i.kmlUrlTemplate=null;i.featuredToursUrl=null;i.enableViewportFallback=false;i.viewportFallbackDistance=0}if(t.requirements!==undefined&&t.requirements!==null&&t.hasOwnProperty("requirements"))i.requirements=o[0].toObject(t.requirements,r);if(t.alleycatUrlTemplate!==undefined&&t.alleycatUrlTemplate!==null&&t.hasOwnProperty("alleycatUrlTemplate"))i.alleycatUrlTemplate=o[1].toObject(t.alleycatUrlTemplate,r);if(t.fallbackAlleycatUrlTemplate!==undefined&&t.fallbackAlleycatUrlTemplate!==null&&t.hasOwnProperty("fallbackAlleycatUrlTemplate"))i.fallbackAlleycatUrlTemplate=o[2].toObject(t.fallbackAlleycatUrlTemplate,r);if(t.metadataUrlTemplate!==undefined&&t.metadataUrlTemplate!==null&&t.hasOwnProperty("metadataUrlTemplate"))i.metadataUrlTemplate=o[3].toObject(t.metadataUrlTemplate,r);if(t.thumbnailUrlTemplate!==undefined&&t.thumbnailUrlTemplate!==null&&t.hasOwnProperty("thumbnailUrlTemplate"))i.thumbnailUrlTemplate=o[4].toObject(t.thumbnailUrlTemplate,r);if(t.kmlUrlTemplate!==undefined&&t.kmlUrlTemplate!==null&&t.hasOwnProperty("kmlUrlTemplate"))i.kmlUrlTemplate=o[5].toObject(t.kmlUrlTemplate,r);if(t.featuredToursUrl!==undefined&&t.featuredToursUrl!==null&&t.hasOwnProperty("featuredToursUrl"))i.featuredToursUrl=o[6].toObject(t.featuredToursUrl,r);if(t.enableViewportFallback!==undefined&&t.enableViewportFallback!==null&&t.hasOwnProperty("enableViewportFallback"))i.enableViewportFallback=t.enableViewportFallback;if(t.viewportFallbackDistance!==undefined&&t.viewportFallbackDistance!==null&&t.hasOwnProperty("viewportFallbackDistance"))i.viewportFallbackDistance=t.viewportFallbackDistance;if(t.imageryType!==undefined&&t.imageryType!==null&&t.hasOwnProperty("imageryType")){i.imageryType=[];for(var n=0;n<t.imageryType.length;++n)i.imageryType[n]=o[9].toObject(t.imageryType[n],r)}return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.AlleycatImageryTypeProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.imageryTypeId=0;r.prototype.imageryTypeLabel="";r.prototype.metadataUrlTemplate=null;r.prototype.thumbnailUrlTemplate=null;r.prototype.kmlUrlTemplate=null;var o={2:"keyhole.dbroot.StringIdOrValueProto",3:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.StringIdOrValueProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 1:s.imageryTypeId=r.int32();break;case 2:s.imageryTypeLabel=r.string();break;case 3:s.metadataUrlTemplate=o[2].decode(r,r.uint32());break;case 4:s.thumbnailUrlTemplate=o[3].decode(r,r.uint32());break;case 5:s.kmlUrlTemplate=o[4].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.imageryTypeId!==undefined)if(!i.isInteger(t.imageryTypeId))return"imageryTypeId: integer expected";if(t.imageryTypeLabel!==undefined)if(!i.isString(t.imageryTypeLabel))return"imageryTypeLabel: string expected";if(t.metadataUrlTemplate!==undefined&&t.metadataUrlTemplate!==null){var r=o[2].verify(t.metadataUrlTemplate);if(r)return"metadataUrlTemplate."+r}if(t.thumbnailUrlTemplate!==undefined&&t.thumbnailUrlTemplate!==null){var r=o[3].verify(t.thumbnailUrlTemplate);if(r)return"thumbnailUrlTemplate."+r}if(t.kmlUrlTemplate!==undefined&&t.kmlUrlTemplate!==null){var r=o[4].verify(t.kmlUrlTemplate);if(r)return"kmlUrlTemplate."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto)return t;var r=new a.keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto;if(t.imageryTypeId!==undefined&&t.imageryTypeId!==null)r.imageryTypeId=t.imageryTypeId|0;if(t.imageryTypeLabel!==undefined&&t.imageryTypeLabel!==null)r.imageryTypeLabel=String(t.imageryTypeLabel);if(t.metadataUrlTemplate!==undefined&&t.metadataUrlTemplate!==null){if(typeof t.metadataUrlTemplate!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto.metadataUrlTemplate: object expected");r.metadataUrlTemplate=o[2].fromObject(t.metadataUrlTemplate)}if(t.thumbnailUrlTemplate!==undefined&&t.thumbnailUrlTemplate!==null){if(typeof t.thumbnailUrlTemplate!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto.thumbnailUrlTemplate: object expected");r.thumbnailUrlTemplate=o[3].fromObject(t.thumbnailUrlTemplate)}if(t.kmlUrlTemplate!==undefined&&t.kmlUrlTemplate!==null){if(typeof t.kmlUrlTemplate!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.FilmstripConfigProto.AlleycatImageryTypeProto.kmlUrlTemplate: object expected");r.kmlUrlTemplate=o[4].fromObject(t.kmlUrlTemplate)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.imageryTypeId=0;i.imageryTypeLabel="";i.metadataUrlTemplate=null;i.thumbnailUrlTemplate=null;i.kmlUrlTemplate=null}if(t.imageryTypeId!==undefined&&t.imageryTypeId!==null&&t.hasOwnProperty("imageryTypeId"))i.imageryTypeId=t.imageryTypeId;if(t.imageryTypeLabel!==undefined&&t.imageryTypeLabel!==null&&t.hasOwnProperty("imageryTypeLabel"))i.imageryTypeLabel=t.imageryTypeLabel;if(t.metadataUrlTemplate!==undefined&&t.metadataUrlTemplate!==null&&t.hasOwnProperty("metadataUrlTemplate"))i.metadataUrlTemplate=o[2].toObject(t.metadataUrlTemplate,r);if(t.thumbnailUrlTemplate!==undefined&&t.thumbnailUrlTemplate!==null&&t.hasOwnProperty("thumbnailUrlTemplate"))i.thumbnailUrlTemplate=o[3].toObject(t.thumbnailUrlTemplate,r);if(t.kmlUrlTemplate!==undefined&&t.kmlUrlTemplate!==null&&t.hasOwnProperty("kmlUrlTemplate"))i.kmlUrlTemplate=o[4].toObject(t.kmlUrlTemplate,r);return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();return r}();r.StarDataProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.url=null;var i={0:"keyhole.dbroot.StringIdOrValueProto"};n.push(i);r.decode=function e(r,n){if(!(r instanceof t))r=t.create(r);var o=n===undefined?r.len:r.pos+n,s=new a.keyhole.dbroot.EndSnippetProto.StarDataProto;while(r.pos<o){var l=r.uint32();switch(l>>>3){case 1:s.url=i[0].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.url!==undefined&&t.url!==null){var r=i[0].verify(t.url);if(r)return"url."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EndSnippetProto.StarDataProto)return t;var r=new a.keyhole.dbroot.EndSnippetProto.StarDataProto;if(t.url!==undefined&&t.url!==null){if(typeof t.url!=="object")throw TypeError(".keyhole.dbroot.EndSnippetProto.StarDataProto.url: object expected");r.url=i[0].fromObject(t.url)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var n={};if(r.defaults)n.url=null;if(t.url!==undefined&&t.url!==null&&t.hasOwnProperty("url"))n.url=i[0].toObject(t.url,r);return n};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();return r}();r.DbRootRefProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.url="";r.prototype.isCritical=false;r.prototype.requirements=null;var o={2:"keyhole.dbroot.RequirementProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.DbRootRefProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 2:s.url=r.string();break;case 1:s.isCritical=r.bool();break;case 3:s.requirements=o[2].decode(r,r.uint32());break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isString(t.url))return"url: string expected";if(t.isCritical!==undefined)if(typeof t.isCritical!=="boolean")return"isCritical: boolean expected";if(t.requirements!==undefined&&t.requirements!==null){var r=o[2].verify(t.requirements);if(r)return"requirements."+r}return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.DbRootRefProto)return t;var r=new a.keyhole.dbroot.DbRootRefProto;if(t.url!==undefined&&t.url!==null)r.url=String(t.url);if(t.isCritical!==undefined&&t.isCritical!==null)r.isCritical=Boolean(t.isCritical);if(t.requirements!==undefined&&t.requirements!==null){if(typeof t.requirements!=="object")throw TypeError(".keyhole.dbroot.DbRootRefProto.requirements: object expected");r.requirements=o[2].fromObject(t.requirements)}return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults){i.url="";i.isCritical=false;i.requirements=null}if(t.url!==undefined&&t.url!==null&&t.hasOwnProperty("url"))i.url=t.url;if(t.isCritical!==undefined&&t.isCritical!==null&&t.hasOwnProperty("isCritical"))i.isCritical=t.isCritical;if(t.requirements!==undefined&&t.requirements!==null&&t.hasOwnProperty("requirements"))i.requirements=o[2].toObject(t.requirements,r);return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.DatabaseVersionProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.quadtreeVersion=0;r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.DatabaseVersionProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.quadtreeVersion=r.uint32();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(!i.isInteger(t.quadtreeVersion))return"quadtreeVersion: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.DatabaseVersionProto)return t;var r=new a.keyhole.dbroot.DatabaseVersionProto;if(t.quadtreeVersion!==undefined&&t.quadtreeVersion!==null)r.quadtreeVersion=t.quadtreeVersion>>>0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.defaults)i.quadtreeVersion=0;if(t.quadtreeVersion!==undefined&&t.quadtreeVersion!==null&&t.hasOwnProperty("quadtreeVersion"))i.quadtreeVersion=t.quadtreeVersion;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.DbRootProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.databaseName=null;r.prototype.imageryPresent=true;r.prototype.protoImagery=false;r.prototype.terrainPresent=false;r.prototype.providerInfo=i.emptyArray;r.prototype.nestedFeature=i.emptyArray;r.prototype.styleAttribute=i.emptyArray;r.prototype.styleMap=i.emptyArray;r.prototype.endSnippet=null;r.prototype.translationEntry=i.emptyArray;r.prototype.language="en";r.prototype.version=5;r.prototype.dbrootReference=i.emptyArray;r.prototype.databaseVersion=null;r.prototype.refreshTimeout=0;var o={0:"keyhole.dbroot.StringIdOrValueProto",4:"keyhole.dbroot.ProviderInfoProto",5:"keyhole.dbroot.NestedFeatureProto",6:"keyhole.dbroot.StyleAttributeProto",7:"keyhole.dbroot.StyleMapProto",8:"keyhole.dbroot.EndSnippetProto",9:"keyhole.dbroot.StringEntryProto",12:"keyhole.dbroot.DbRootRefProto",13:"keyhole.dbroot.DatabaseVersionProto"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,s=new a.keyhole.dbroot.DbRootProto;while(r.pos<n){var l=r.uint32();switch(l>>>3){case 15:s.databaseName=o[0].decode(r,r.uint32());break;case 1:s.imageryPresent=r.bool();break;case 14:s.protoImagery=r.bool();break;case 2:s.terrainPresent=r.bool();break;case 3:if(!(s.providerInfo&&s.providerInfo.length))s.providerInfo=[];s.providerInfo.push(o[4].decode(r,r.uint32()));break;case 4:if(!(s.nestedFeature&&s.nestedFeature.length))s.nestedFeature=[];s.nestedFeature.push(o[5].decode(r,r.uint32()));break;case 5:if(!(s.styleAttribute&&s.styleAttribute.length))s.styleAttribute=[];s.styleAttribute.push(o[6].decode(r,r.uint32()));break;case 6:if(!(s.styleMap&&s.styleMap.length))s.styleMap=[];s.styleMap.push(o[7].decode(r,r.uint32()));break;case 7:s.endSnippet=o[8].decode(r,r.uint32());break;case 8:if(!(s.translationEntry&&s.translationEntry.length))s.translationEntry=[];s.translationEntry.push(o[9].decode(r,r.uint32()));break;case 9:s.language=r.string();break;case 10:s.version=r.int32();break;case 11:if(!(s.dbrootReference&&s.dbrootReference.length))s.dbrootReference=[];s.dbrootReference.push(o[12].decode(r,r.uint32()));break;case 13:s.databaseVersion=o[13].decode(r,r.uint32());break;case 16:s.refreshTimeout=r.int32();break;default:r.skipType(l&7);break}}return s};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.databaseName!==undefined&&t.databaseName!==null){var r=o[0].verify(t.databaseName);if(r)return"databaseName."+r}if(t.imageryPresent!==undefined)if(typeof t.imageryPresent!=="boolean")return"imageryPresent: boolean expected";if(t.protoImagery!==undefined)if(typeof t.protoImagery!=="boolean")return"protoImagery: boolean expected";if(t.terrainPresent!==undefined)if(typeof t.terrainPresent!=="boolean")return"terrainPresent: boolean expected";if(t.providerInfo!==undefined){if(!Array.isArray(t.providerInfo))return"providerInfo: array expected";for(var n=0;n<t.providerInfo.length;++n){var r=o[4].verify(t.providerInfo[n]);if(r)return"providerInfo."+r}}if(t.nestedFeature!==undefined){if(!Array.isArray(t.nestedFeature))return"nestedFeature: array expected";for(var n=0;n<t.nestedFeature.length;++n){var r=o[5].verify(t.nestedFeature[n]);if(r)return"nestedFeature."+r}}if(t.styleAttribute!==undefined){if(!Array.isArray(t.styleAttribute))return"styleAttribute: array expected";for(var n=0;n<t.styleAttribute.length;++n){var r=o[6].verify(t.styleAttribute[n]);if(r)return"styleAttribute."+r}}if(t.styleMap!==undefined){if(!Array.isArray(t.styleMap))return"styleMap: array expected";for(var n=0;n<t.styleMap.length;++n){var r=o[7].verify(t.styleMap[n]);if(r)return"styleMap."+r}}if(t.endSnippet!==undefined&&t.endSnippet!==null){var r=o[8].verify(t.endSnippet);if(r)return"endSnippet."+r}if(t.translationEntry!==undefined){if(!Array.isArray(t.translationEntry))return"translationEntry: array expected";for(var n=0;n<t.translationEntry.length;++n){var r=o[9].verify(t.translationEntry[n]);if(r)return"translationEntry."+r}}if(t.language!==undefined)if(!i.isString(t.language))return"language: string expected";if(t.version!==undefined)if(!i.isInteger(t.version))return"version: integer expected";if(t.dbrootReference!==undefined){if(!Array.isArray(t.dbrootReference))return"dbrootReference: array expected";for(var n=0;n<t.dbrootReference.length;++n){var r=o[12].verify(t.dbrootReference[n]);if(r)return"dbrootReference."+r}}if(t.databaseVersion!==undefined&&t.databaseVersion!==null){var r=o[13].verify(t.databaseVersion);if(r)return"databaseVersion."+r}if(t.refreshTimeout!==undefined)if(!i.isInteger(t.refreshTimeout))return"refreshTimeout: integer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.DbRootProto)return t;var r=new a.keyhole.dbroot.DbRootProto;if(t.databaseName!==undefined&&t.databaseName!==null){if(typeof t.databaseName!=="object")throw TypeError(".keyhole.dbroot.DbRootProto.databaseName: object expected");r.databaseName=o[0].fromObject(t.databaseName)}if(t.imageryPresent!==undefined&&t.imageryPresent!==null)r.imageryPresent=Boolean(t.imageryPresent);if(t.protoImagery!==undefined&&t.protoImagery!==null)r.protoImagery=Boolean(t.protoImagery);if(t.terrainPresent!==undefined&&t.terrainPresent!==null)r.terrainPresent=Boolean(t.terrainPresent);if(t.providerInfo){if(!Array.isArray(t.providerInfo))throw TypeError(".keyhole.dbroot.DbRootProto.providerInfo: array expected");r.providerInfo=[];for(var i=0;i<t.providerInfo.length;++i){if(typeof t.providerInfo[i]!=="object")throw TypeError(".keyhole.dbroot.DbRootProto.providerInfo: object expected");r.providerInfo[i]=o[4].fromObject(t.providerInfo[i])}}if(t.nestedFeature){if(!Array.isArray(t.nestedFeature))throw TypeError(".keyhole.dbroot.DbRootProto.nestedFeature: array expected");r.nestedFeature=[];for(var i=0;i<t.nestedFeature.length;++i){if(typeof t.nestedFeature[i]!=="object")throw TypeError(".keyhole.dbroot.DbRootProto.nestedFeature: object expected");r.nestedFeature[i]=o[5].fromObject(t.nestedFeature[i])}}if(t.styleAttribute){if(!Array.isArray(t.styleAttribute))throw TypeError(".keyhole.dbroot.DbRootProto.styleAttribute: array expected");r.styleAttribute=[];for(var i=0;i<t.styleAttribute.length;++i){if(typeof t.styleAttribute[i]!=="object")throw TypeError(".keyhole.dbroot.DbRootProto.styleAttribute: object expected");r.styleAttribute[i]=o[6].fromObject(t.styleAttribute[i])}}if(t.styleMap){if(!Array.isArray(t.styleMap))throw TypeError(".keyhole.dbroot.DbRootProto.styleMap: array expected");r.styleMap=[];for(var i=0;i<t.styleMap.length;++i){if(typeof t.styleMap[i]!=="object")throw TypeError(".keyhole.dbroot.DbRootProto.styleMap: object expected");r.styleMap[i]=o[7].fromObject(t.styleMap[i])}}if(t.endSnippet!==undefined&&t.endSnippet!==null){if(typeof t.endSnippet!=="object")throw TypeError(".keyhole.dbroot.DbRootProto.endSnippet: object expected");r.endSnippet=o[8].fromObject(t.endSnippet)}if(t.translationEntry){if(!Array.isArray(t.translationEntry))throw TypeError(".keyhole.dbroot.DbRootProto.translationEntry: array expected");r.translationEntry=[];for(var i=0;i<t.translationEntry.length;++i){if(typeof t.translationEntry[i]!=="object")throw TypeError(".keyhole.dbroot.DbRootProto.translationEntry: object expected");r.translationEntry[i]=o[9].fromObject(t.translationEntry[i])}}if(t.language!==undefined&&t.language!==null)r.language=String(t.language);if(t.version!==undefined&&t.version!==null)r.version=t.version|0;if(t.dbrootReference){if(!Array.isArray(t.dbrootReference))throw TypeError(".keyhole.dbroot.DbRootProto.dbrootReference: array expected");r.dbrootReference=[];for(var i=0;i<t.dbrootReference.length;++i){if(typeof t.dbrootReference[i]!=="object")throw TypeError(".keyhole.dbroot.DbRootProto.dbrootReference: object expected");r.dbrootReference[i]=o[12].fromObject(t.dbrootReference[i])}}if(t.databaseVersion!==undefined&&t.databaseVersion!==null){if(typeof t.databaseVersion!=="object")throw TypeError(".keyhole.dbroot.DbRootProto.databaseVersion: object expected");r.databaseVersion=o[13].fromObject(t.databaseVersion)}if(t.refreshTimeout!==undefined&&t.refreshTimeout!==null)r.refreshTimeout=t.refreshTimeout|0;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var i={};if(r.arrays||r.defaults){i.providerInfo=[];i.nestedFeature=[];i.styleAttribute=[];i.styleMap=[];i.translationEntry=[];i.dbrootReference=[]}if(r.defaults){i.databaseName=null;i.imageryPresent=true;i.protoImagery=false;i.terrainPresent=false;i.endSnippet=null;i.language="en";i.version=5;i.databaseVersion=null;i.refreshTimeout=0}if(t.databaseName!==undefined&&t.databaseName!==null&&t.hasOwnProperty("databaseName"))i.databaseName=o[0].toObject(t.databaseName,r);if(t.imageryPresent!==undefined&&t.imageryPresent!==null&&t.hasOwnProperty("imageryPresent"))i.imageryPresent=t.imageryPresent;if(t.protoImagery!==undefined&&t.protoImagery!==null&&t.hasOwnProperty("protoImagery"))i.protoImagery=t.protoImagery;if(t.terrainPresent!==undefined&&t.terrainPresent!==null&&t.hasOwnProperty("terrainPresent"))i.terrainPresent=t.terrainPresent;if(t.providerInfo!==undefined&&t.providerInfo!==null&&t.hasOwnProperty("providerInfo")){i.providerInfo=[];for(var n=0;n<t.providerInfo.length;++n)i.providerInfo[n]=o[4].toObject(t.providerInfo[n],r)}if(t.nestedFeature!==undefined&&t.nestedFeature!==null&&t.hasOwnProperty("nestedFeature")){i.nestedFeature=[];for(var n=0;n<t.nestedFeature.length;++n)i.nestedFeature[n]=o[5].toObject(t.nestedFeature[n],r)}if(t.styleAttribute!==undefined&&t.styleAttribute!==null&&t.hasOwnProperty("styleAttribute")){i.styleAttribute=[];for(var n=0;n<t.styleAttribute.length;++n)i.styleAttribute[n]=o[6].toObject(t.styleAttribute[n],r)}if(t.styleMap!==undefined&&t.styleMap!==null&&t.hasOwnProperty("styleMap")){i.styleMap=[];for(var n=0;n<t.styleMap.length;++n)i.styleMap[n]=o[7].toObject(t.styleMap[n],r)}if(t.endSnippet!==undefined&&t.endSnippet!==null&&t.hasOwnProperty("endSnippet"))i.endSnippet=o[8].toObject(t.endSnippet,r);if(t.translationEntry!==undefined&&t.translationEntry!==null&&t.hasOwnProperty("translationEntry")){i.translationEntry=[];for(var n=0;n<t.translationEntry.length;++n)i.translationEntry[n]=o[9].toObject(t.translationEntry[n],r)}if(t.language!==undefined&&t.language!==null&&t.hasOwnProperty("language"))i.language=t.language;if(t.version!==undefined&&t.version!==null&&t.hasOwnProperty("version"))i.version=t.version;if(t.dbrootReference!==undefined&&t.dbrootReference!==null&&t.hasOwnProperty("dbrootReference")){i.dbrootReference=[];for(var n=0;n<t.dbrootReference.length;++n)i.dbrootReference[n]=o[12].toObject(t.dbrootReference[n],r)}if(t.databaseVersion!==undefined&&t.databaseVersion!==null&&t.hasOwnProperty("databaseVersion"))i.databaseVersion=o[13].toObject(t.databaseVersion,r);if(t.refreshTimeout!==undefined&&t.refreshTimeout!==null&&t.hasOwnProperty("refreshTimeout"))i.refreshTimeout=t.refreshTimeout;return i};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};return r}();r.EncryptedDbRootProto=function(){function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}r.prototype.encryptionType=0;r.prototype.encryptionData=i.newBuffer([]);r.prototype.dbrootData=i.newBuffer([]);var o={0:"keyhole.dbroot.EncryptedDbRootProto.EncryptionType"};n.push(o);r.decode=function e(r,i){if(!(r instanceof t))r=t.create(r);var n=i===undefined?r.len:r.pos+i,o=new a.keyhole.dbroot.EncryptedDbRootProto;while(r.pos<n){var s=r.uint32();switch(s>>>3){case 1:o.encryptionType=r.uint32();break;case 2:o.encryptionData=r.bytes();break;case 3:o.dbrootData=r.bytes();break;default:r.skipType(s&7);break}}return o};r.verify=function e(t){if(typeof t!=="object"||t===null)return"object expected";if(t.encryptionType!==undefined)switch(t.encryptionType){default:return"encryptionType: enum value expected";case 0:break}if(t.encryptionData!==undefined)if(!(t.encryptionData&&typeof t.encryptionData.length==="number"||i.isString(t.encryptionData)))return"encryptionData: buffer expected";if(t.dbrootData!==undefined)if(!(t.dbrootData&&typeof t.dbrootData.length==="number"||i.isString(t.dbrootData)))return"dbrootData: buffer expected";return null};r.fromObject=function e(t){if(t instanceof a.keyhole.dbroot.EncryptedDbRootProto)return t;var r=new a.keyhole.dbroot.EncryptedDbRootProto;switch(t.encryptionType){case"ENCRYPTION_XOR":case 0:r.encryptionType=0;break}if(t.encryptionData!==undefined&&t.encryptionData!==null)if(typeof t.encryptionData==="string")i.base64.decode(t.encryptionData,r.encryptionData=i.newBuffer(i.base64.length(t.encryptionData)),0);else if(t.encryptionData.length)r.encryptionData=t.encryptionData;if(t.dbrootData!==undefined&&t.dbrootData!==null)if(typeof t.dbrootData==="string")i.base64.decode(t.dbrootData,r.dbrootData=i.newBuffer(i.base64.length(t.dbrootData)),0);else if(t.dbrootData.length)r.dbrootData=t.dbrootData;return r};r.from=r.fromObject;r.toObject=function e(t,r){if(!r)r={};var n={};if(r.defaults){n.encryptionType=r.enums===String?"ENCRYPTION_XOR":0;n.encryptionData=r.bytes===String?"":[];n.dbrootData=r.bytes===String?"":[]}if(t.encryptionType!==undefined&&t.encryptionType!==null&&t.hasOwnProperty("encryptionType"))n.encryptionType=r.enums===String?o[0][t.encryptionType]:t.encryptionType;if(t.encryptionData!==undefined&&t.encryptionData!==null&&t.hasOwnProperty("encryptionData"))n.encryptionData=r.bytes===String?i.base64.encode(t.encryptionData,0,t.encryptionData.length):r.bytes===Array?Array.prototype.slice.call(t.encryptionData):t.encryptionData;if(t.dbrootData!==undefined&&t.dbrootData!==null&&t.hasOwnProperty("dbrootData"))n.dbrootData=r.bytes===String?i.base64.encode(t.dbrootData,0,t.dbrootData.length):r.bytes===Array?Array.prototype.slice.call(t.dbrootData):t.dbrootData;return n};r.prototype.toObject=function e(t){return this.constructor.toObject(this,t)};r.prototype.toJSON=function t(){return this.constructor.toObject(this,e.util.toJSONOptions)};r.EncryptionType=function(){var e={},t=Object.create(e);t["ENCRYPTION_XOR"]=0;return t}();return r}();return r}();return r}();i.lazyResolve(a,n);return a.keyhole.dbroot});define("Core/isBitSet",[],function(){"use strict";function e(e,t){return(e&t)!==0}return e});define("Core/GoogleEarthEnterpriseTileInformation",["./defined","./isBitSet"],function(e,t){"use strict";var r=[1,2,4,8];var i=15;var n=16;var a=64;var o=128;function s(e,t,r,i,n,a){this._bits=e;this.cnodeVersion=t;this.imageryVersion=r;this.terrainVersion=i;this.imageryProvider=n;this.terrainProvider=a;this.ancestorHasTerrain=false;this.terrainState=undefined}s.clone=function(t,r){if(!e(r)){r=new s(t._bits,t.cnodeVersion,t.imageryVersion,t.terrainVersion,t.imageryProvider,t.terrainProvider)}else{r._bits=t._bits;r.cnodeVersion=t.cnodeVersion;r.imageryVersion=t.imageryVersion;r.terrainVersion=t.terrainVersion;r.imageryProvider=t.imageryProvider;r.terrainProvider=t.terrainProvider}r.ancestorHasTerrain=t.ancestorHasTerrain;r.terrainState=t.terrainState;return r};s.prototype.setParent=function(e){this.ancestorHasTerrain=e.ancestorHasTerrain||this.hasTerrain()};s.prototype.hasSubtree=function(){return t(this._bits,n)};s.prototype.hasImagery=function(){return t(this._bits,a)};s.prototype.hasTerrain=function(){return t(this._bits,o)};s.prototype.hasChildren=function(){return t(this._bits,i)};s.prototype.hasChild=function(e){return t(this._bits,r[e])};s.prototype.getChildBitmask=function(){return this._bits&i};return s});define("Core/GoogleEarthEnterpriseMetadata",["../ThirdParty/google-earth-dbroot-parser","../ThirdParty/when","./appendForwardSlash","./Check","./Credit","./defaultValue","./defined","./defineProperties","./GoogleEarthEnterpriseTileInformation","./isBitSet","./joinUrls","./loadArrayBuffer","./Math","./Request","./RequestType","./RuntimeError","./TaskProcessor"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";function g(e){var t=e.length;var r=new ArrayBuffer(t);var i=new Uint8Array(r);for(var n=0;n<t;++n){i[n]=e.charCodeAt(n)}return r}var _=g('Eô½\vyâjE",ÍqøIFgQ\0B%Æèa,f)\bÆ4Üjb%y\nwmiÖðk¡½NuàA[ß@V\fÙ»r|3SîOlÔq°{ÀEVZ­wUe\v3*¬l5Å0sø3>mF8J´Ýð.ÝuÚDt"úa"\f3"So¯9D\v9Ù9L¹¿«\\P_"uxéqh;ÁÄð<VqH\'UfYNeu£aF}a?A\0×´4MÎF°Õ¸\'{Ü+»Mg0ÈÑö\\Pú[/Fn5/\'C.ë\n\f^¥se4ål.jC\'c#U©?q{gC}:¯ÍâTUýKÆâ/(íË\\Æ-f§;/*"N°k.Ý\r}}GºC²²+>Mª>}æÎIÆæx\fa1-¤O¥~q ì\r1èN\v\0nPh}=\b\r¦n£h$[kó#ó¶s³\r\v@ÀØQ]ú".jßI\0¹ wUÆïj¿{GLîÜÜF©­S+S4ÿYä8è1N¹XFkË-#p\x005"Ï1²&/çÃu-6,rt°#G·ÓÑ&7râ\0DÏÚ3-Þ`i#i*|ÍKQ\rT9w.)ê¦P¢joP\\>TûïP[\vEm(w7ÛJfJo åpâ¹q~\fmI-zþrÇòY0»]såÉ êxì ðB|G`°½&·q¶ÇÑ3=Ó«îcÈ+S D\\qÆÌD2O<ÊÀ)=RÓaX©}e´ÜÏ\rô=ñ\b©BÚ#\tØ¿^PIøMÀËGLO÷{+ØÅ1;µoÜl\rÑÛ?âéÚ_ÔâFaZÞUÏ¤\0¾ýÎgñJiæ HØ]~®q N®ÀV©<rçvì)IÖ]-ãÛ6©;fjÕ¶=P^R¹KÇsWxÉô.YoÐKW>\'\'Ç`Û;íSD>?mw¢\në?R¨ÆU^1I7ôÅ&-©¿\'TÚÃj å*x°Öprªh½÷_H±~ÀXL?fù>áeÀp§Ï8i¯ðVldI\'­xtOÂÞV9\0Úw\vË-û5Oõ\bQ`Á\nZGM&30xÚÀFGâ[y`In7gS\n>éìF9²ñ4\rÆSuná\fYÙÞ){II¥wy¾IV.6ç\v:»Ob{ÒM1/½8{¨O!áìFpv})"x\nÝ\\ÚÞQÏðüYRe|3ßóHÚ»*uÛ`²Ôüíì5¨ÿ(1-ÈÜF|["');function y(e){e=a(e,a.EMPTY_OBJECT);i.typeOf.string("options.url",e.url);this.imageryPresent=true;this.protoImagery=undefined;this.terrainPresent=true;this.negativeAltitudeExponentBias=32;this.negativeAltitudeThreshold=f.EPSILON12;this.providers={};this.key=undefined;this._quadPacketVersion=1;this._url=r(e.url);this._proxy=e.proxy;this._tileInfo={};this._subtreePromises={};var n=this;this._readyPromise=S(this).then(function(){return n.getQuadTreePacket("",n._quadPacketVersion)}).then(function(){return true}).otherwise(function(e){var r="An error occurred while accessing "+C(n,"",1)+".";return t.reject(new m(r))})}s(y.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},readyPromise:{get:function(){return this._readyPromise}}});y.tileXYToQuadKey=function(e,t,r){var i="";for(var n=r;n>=0;--n){var a=1<<n;var o=0;if(!u(t,a)){o|=2;if(!u(e,a)){o|=1}}else if(u(e,a)){o|=1}i+=o}return i};y.quadKeyToTileXY=function(e){var t=0;var r=0;var i=e.length-1;for(var n=i;n>=0;--n){var a=1<<n;var o=+e[i-n];if(u(o,2)){if(!u(o,1)){t|=a}}else{r|=a;if(u(o,1)){t|=a}}}return{x:t,y:r,level:i}};y.prototype.isValid=function(e){var t=this.getTileInformationFromQuadKey(e);if(o(t)){return t!==null}var r=true;var i=e;var n;while(i.length>1){n=i.substring(i.length-1);i=i.substring(0,i.length-1);t=this.getTileInformationFromQuadKey(i);if(o(t)){if(!t.hasSubtree()&&!t.hasChild(parseInt(n))){r=false}break}else if(t===null){r=false;break}}return r};var b=new v("decodeGoogleEarthEnterprisePacket",Number.POSITIVE_INFINITY);y.prototype.getQuadTreePacket=function(e,t,r){t=a(t,1);e=a(e,"");var i=C(this,e,t);var n=this._proxy;if(o(n)){i=n.getURL(i)}var s=d(i,undefined,r);if(!o(s)){return undefined}var u=this._tileInfo;var c=this.key;return s.then(function(t){var r=b.scheduleTask({buffer:t,quadKey:e,type:"Metadata",key:c},[t]);return r.then(function(t){var r;var i=-1;if(e!==""){i=e.length+1;var n=t[e];r=u[e];r._bits|=n._bits;delete t[e]}var a=Object.keys(t);a.sort(function(e,t){return e.length-t.length});var o=a.length;for(var s=0;s<o;++s){var c=a[s];var d=t[c];if(d!==null){var f=l.clone(t[c]);var h=c.length;if(h===i){f.setParent(r)}else if(h>1){var p=u[c.substring(0,c.length-1)];f.setParent(p)}u[c]=f}else{u[c]=null}}})})};y.prototype.populateSubtree=function(e,t,r,i){var n=y.tileXYToQuadKey(e,t,r);return w(this,n,i)};function w(e,r,i){var n=e._tileInfo;var a=r;var s=n[a];if(o(s)&&(!s.hasSubtree()||s.hasChildren())){return s}while(s===undefined&&a.length>1){a=a.substring(0,a.length-1);s=n[a]}var l;var u=e._subtreePromises;var c=u[a];if(o(c)){return c.then(function(){l=new h({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction});return w(e,r,l)})}if(!o(s)||!s.hasSubtree()){return t.reject(new m("Couldn't load metadata for tile "+r))}c=e.getQuadTreePacket(a,s.cnodeVersion,i);if(!o(c)){return undefined}u[a]=c;return c.then(function(){l=new h({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction});return w(e,r,l)}).always(function(){delete u[a]})}y.prototype.getTileInformation=function(e,t,r){var i=y.tileXYToQuadKey(e,t,r);return this._tileInfo[i]};y.prototype.getTileInformationFromQuadKey=function(e){return this._tileInfo[e]};function C(e,t,r){return c(e._url,"flatfile?q2-0"+t+"-q."+r.toString())}function S(t){var r=c(t._url,"dbRoot.v5?output=proto");var i=t._proxy;if(o(i)){r=i.getURL(r)}var s=d(r).then(function(r){var i=e.EncryptedDbRootProto.decode(new Uint8Array(r));var n=i.encryptionData;var a=n.byteOffset;var o=a+n.byteLength;var s=t.key=n.buffer.slice(a,o);n=i.dbrootData;a=n.byteOffset;o=a+n.byteLength;var l=n.buffer.slice(a,o);return b.scheduleTask({buffer:l,type:"DbRoot",key:s},[l])}).then(function(r){var i=e.DbRootProto.decode(new Uint8Array(r.buffer));t.imageryPresent=a(i.imageryPresent,t.imageryPresent);t.protoImagery=i.protoImagery;t.terrainPresent=a(i.terrainPresent,t.terrainPresent);if(o(i.endSnippet)&&o(i.endSnippet.model)){var s=i.endSnippet.model;t.negativeAltitudeExponentBias=a(s.negativeAltitudeExponentBias,t.negativeAltitudeExponentBias);t.negativeAltitudeThreshold=a(s.compressedNegativeAltitudeThreshold,t.negativeAltitudeThreshold)}if(o(i.databaseVersion)){t._quadPacketVersion=a(i.databaseVersion.quadtreeVersion,t._quadPacketVersion)}var l=t.providers;var u=a(i.providerInfo,[]);var c=u.length;for(var d=0;d<c;++d){var f=u[d];var h=f.copyrightString;if(o(h)){l[f.providerId]=new n(h.value)}}}).otherwise(function(){console.log("Failed to retrieve "+r+". Using defaults.");t.key=_});return s}return y});define("Core/GoogleEarthEnterpriseTerrainData",["./BoundingSphere","./Cartesian2","./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./IndexDatatype","./Intersections2D","./Math","./OrientedBoundingBox","./QuantizedMeshTerrainData","./Rectangle","./TaskProcessor","./TerrainEncoding","./TerrainMesh"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";function g(e){e=n(e,n.EMPTY_OBJECT);i.typeOf.object("options.buffer",e.buffer);i.typeOf.number("options.negativeAltitudeExponentBias",e.negativeAltitudeExponentBias);i.typeOf.number("options.negativeElevationThreshold",e.negativeElevationThreshold);this._buffer=e.buffer;this._credits=e.credits;this._negativeAltitudeExponentBias=e.negativeAltitudeExponentBias;this._negativeElevationThreshold=e.negativeElevationThreshold;var t=n(e.childTileMask,15);var r=t&3;r|=t&4?8:0;r|=t&8?4:0;this._childTileMask=r;this._createdByUpsampling=n(e.createdByUpsampling,false);this._skirtHeight=undefined;this._bufferType=this._buffer.constructor;this._mesh=undefined;this._minimumHeight=undefined;this._maximumHeight=undefined;this._vertexCountWithoutSkirts=undefined;this._skirtIndex=undefined}o(g.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){return undefined}}});var _=new p("createVerticesFromGoogleEarthEnterpriseBuffer");var y=new h;var b=new h;g.prototype.createMesh=function(e,t,r,o,s){i.typeOf.object("tilingScheme",e);i.typeOf.number("x",t);i.typeOf.number("y",r);i.typeOf.number("level",o);var l=e.ellipsoid;e.tileXYToNativeRectangle(t,r,o,y);e.tileXYToRectangle(t,r,o,b);s=n(s,1);var u=l.cartographicToCartesian(h.center(b));var c=40075.16;var d=c/(1<<o);this._skirtHeight=Math.min(d*8,1e3);var f=_.scheduleTask({buffer:this._buffer,nativeRectangle:y,rectangle:b,relativeToCenter:u,ellipsoid:l,skirtHeight:this._skirtHeight,exaggeration:s,includeWebMercatorT:true,negativeAltitudeExponentBias:this._negativeAltitudeExponentBias,negativeElevationThreshold:this._negativeElevationThreshold});if(!a(f)){return undefined}var p=this;return f.then(function(e){p._mesh=new v(u,new Float32Array(e.vertices),new Uint16Array(e.indices),e.minimumHeight,e.maximumHeight,e.boundingSphere3D,e.occludeePointInScaledSpace,e.numberOfAttributes,e.orientedBoundingBox,m.clone(e.encoding),s);p._vertexCountWithoutSkirts=e.vertexCountWithoutSkirts;p._skirtIndex=e.skirtIndex;p._minimumHeight=e.minimumHeight;p._maximumHeight=e.maximumHeight;p._buffer=undefined;return p._mesh})};g.prototype.interpolateHeight=function(e,t,r){var i=c.clamp((t-e.west)/e.width,0,1);var n=c.clamp((r-e.south)/e.height,0,1);if(!a(this._mesh)){return M(this,i,n,e)}return x(this,i,n)};var w=new p("upsampleQuantizedTerrainMesh");g.prototype.upsample=function(t,n,o,u,c,h,p){i.typeOf.object("tilingScheme",t);i.typeOf.number("thisX",n);i.typeOf.number("thisY",o);i.typeOf.number("thisLevel",u);i.typeOf.number("descendantX",c);i.typeOf.number("descendantY",h);i.typeOf.number("descendantLevel",p);var m=p-u;if(m>1){throw new s("Upsampling through more than one level at a time is not currently supported.")}var v=this._mesh;if(!a(this._mesh)){return undefined}var g=n*2!==c;var _=o*2===h;var y=t.ellipsoid;var b=t.tileXYToRectangle(c,h,p);var C=w.scheduleTask({vertices:v.vertices,vertexCountWithoutSkirts:this._vertexCountWithoutSkirts,indices:v.indices,skirtIndex:this._skirtIndex,encoding:v.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:g,isNorthChild:_,childRectangle:b,ellipsoid:y,exaggeration:v.exaggeration});if(!a(C)){return undefined}var S=this;return C.then(function(t){var i=new Uint16Array(t.vertices);var n=l.createTypedArray(i.length/3,t.indices);var a=S._skirtHeight;return new f({quantizedVertices:i,indices:n,minimumHeight:t.minimumHeight,maximumHeight:t.maximumHeight,boundingSphere:e.clone(t.boundingSphere),orientedBoundingBox:d.clone(t.orientedBoundingBox),horizonOcclusionPoint:r.clone(t.horizonOcclusionPoint),westIndices:t.westIndices,southIndices:t.southIndices,eastIndices:t.eastIndices,northIndices:t.northIndices,westSkirtHeight:a,southSkirtHeight:a,eastSkirtHeight:a,northSkirtHeight:a,childTileMask:0,createdByUpsampling:true,credits:S._credits})})};g.prototype.isChildAvailable=function(e,t,r,n){i.typeOf.number("thisX",e);i.typeOf.number("thisY",t);i.typeOf.number("childX",r);i.typeOf.number("childY",n);var a=2;if(r!==e*2){++a}if(n!==t*2){a-=2}return(this._childTileMask&1<<a)!==0};g.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var C=new t;var S=new t;var T=new t;var E=new r;function x(e,t,r){var i=e._mesh;var n=i.vertices;var a=i.encoding;var o=i.indices;for(var s=0,l=o.length;s<l;s+=3){var c=o[s];var d=o[s+1];var f=o[s+2];var h=a.decodeTextureCoordinates(n,c,C);var p=a.decodeTextureCoordinates(n,d,S);var m=a.decodeTextureCoordinates(n,f,T);var v=u.computeBarycentricCoordinates(t,r,h.x,h.y,p.x,p.y,m.x,m.y,E);if(v.x>=-1e-15&&v.y>=-1e-15&&v.z>=-1e-15){var g=a.decodeHeight(n,c);var _=a.decodeHeight(n,d);var y=a.decodeHeight(n,f);return v.x*g+v.y*_+v.z*y}}return undefined}var P=Uint16Array.BYTES_PER_ELEMENT;var A=Uint32Array.BYTES_PER_ELEMENT;var O=Int32Array.BYTES_PER_ELEMENT;var D=Float32Array.BYTES_PER_ELEMENT;var I=Float64Array.BYTES_PER_ELEMENT;function M(e,t,r,i){var n=e._buffer;var a=0;var o=0;var s=0;if(r>.5){if(t>.5){a=2;o=.5}else{a=3}s=.5}else if(t>.5){a=1;o=.5}var l=new DataView(n);var d=0;for(var f=0;f<a;++f){d+=l.getUint32(d,true);d+=A}d+=A;d+=2*I;var h=c.toRadians(l.getFloat64(d,true)*180);d+=I;var p=c.toRadians(l.getFloat64(d,true)*180);d+=I;var m=i.width/h/2;var v=i.height/p/2;var g=l.getInt32(d,true);d+=O;var _=l.getInt32(d,true)*3;d+=O;d+=O;var y=new Array(g);var b=new Array(g);var w=new Array(g);var C;for(C=0;C<g;++C){y[C]=o+l.getUint8(d++)*m;b[C]=s+l.getUint8(d++)*v;w[C]=l.getFloat32(d,true)*6371010;d+=D}var S=new Array(_);for(C=0;C<_;++C){S[C]=l.getUint16(d,true);d+=P}for(C=0;C<_;C+=3){var T=S[C];var x=S[C+1];var M=S[C+2];var R=y[T];var L=y[x];var N=y[M];var k=b[T];var F=b[x];var B=b[M];var U=u.computeBarycentricCoordinates(t,r,R,k,L,F,N,B,E);if(U.x>=-1e-15&&U.y>=-1e-15&&U.z>=-1e-15){return U.x*w[T]+U.y*w[x]+U.z*w[M]}}return undefined}return g});define("Core/GoogleEarthEnterpriseTerrainProvider",["../ThirdParty/when","./Credit","./defaultValue","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./Event","./GeographicTilingScheme","./GoogleEarthEnterpriseMetadata","./GoogleEarthEnterpriseTerrainData","./HeightmapTerrainData","./JulianDate","./loadArrayBuffer","./Math","./Rectangle","./Request","./RequestState","./RequestType","./RuntimeError","./TaskProcessor","./TileProviderError"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w){"use strict";var C={UNKNOWN:0,NONE:1,SELF:2,PARENT:3};var S=new f;function T(){this._terrainCache={};this._lastTidy=f.now()}T.prototype.add=function(e,t){this._terrainCache[e]={buffer:t,timestamp:f.now()}};T.prototype.get=function(e){var t=this._terrainCache;var r=t[e];if(i(r)){delete this._terrainCache[e];return r.buffer}};T.prototype.tidy=function(){f.now(S);if(f.secondsDifference(S,this._lastTidy)>10){var e=this._terrainCache;var t=Object.keys(e);var r=t.length;for(var i=0;i<r;++i){var n=t[i];var a=e[n];if(f.secondsDifference(S,a.timestamp)>10){delete e[n]}}f.clone(S,this._lastTidy)}};function E(n){n=r(n,{});if(!(i(n.url)||i(n.metadata))){throw new o("options.url or options.metadata is required.")}var a;if(i(n.metadata)){a=this._metadata=n.metadata}else{a=this._metadata=new u({url:n.url,proxy:n.proxy})}this._proxy=r(n.proxy,this._metadata.proxy);this._tilingScheme=new l({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new m(-p.PI,-p.PI,p.PI,p.PI),ellipsoid:n.ellipsoid});var c=n.credit;if(typeof c==="string"){c=new t(c)}this._credit=c;this._levelZeroMaximumGeometricError=40075.16;this._terrainCache=new T;this._terrainPromises={};this._terrainRequests={};this._errorEvent=new s;this._ready=false;var d=this;var f;this._readyPromise=a.readyPromise.then(function(t){if(!a.terrainPresent){var r=new y("The server "+a.url+" doesn't have terrain");f=w.handleError(f,d,d._errorEvent,r.message,undefined,undefined,undefined,r);return e.reject(r)}w.handleSuccess(f);d._ready=t;return t}).otherwise(function(t){f=w.handleError(f,d,d._errorEvent,t.message,undefined,undefined,undefined,t);return e.reject(t)})}n(E.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._proxy}},tilingScheme:{get:function(){if(!this._ready){throw new o("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasWaterMask:{get:function(){return false}},hasVertexNormals:{get:function(){return false}},availability:{get:function(){return undefined}}});var x=new b("decodeGoogleEarthEnterprisePacket",Number.POSITIVE_INFINITY);function P(e,t,r){var n=t.getChildBitmask();if(t.terrainState===C.PARENT){n=0;for(var a=0;a<4;++a){var o=r.getTileInformationFromQuadKey(e+a.toString());if(i(o)&&o.hasTerrain()){n|=1<<a}}}return n}E.prototype.requestTileGeometry=function(t,r,n,s){if(!this._ready){throw new o("requestTileGeometry must not be called before the terrain provider is ready.")}var l=u.tileXYToQuadKey(t,r,n);var f=this._terrainCache;var p=this._metadata;var m=p.getTileInformationFromQuadKey(l);if(!i(m)){return e.reject(new y("Terrain tile doesn't exist"))}var b=m.terrainState;if(!i(b)){b=m.terrainState=C.UNKNOWN}var w=f.get(l);if(i(w)){var S=p.providers[m.terrainProvider];return new c({buffer:w,childTileMask:P(l,m,p),credits:i(S)?[S]:undefined,negativeAltitudeExponentBias:p.negativeAltitudeExponentBias,negativeElevationThreshold:p.negativeAltitudeThreshold})}f.tidy();if(!m.ancestorHasTerrain){return new d({buffer:new Uint8Array(16*16),width:16,height:16})}else if(b===C.NONE){return e.reject(new y("Terrain tile doesn't exist"))}var T;var E=l;var O=-1;switch(b){case C.SELF:O=m.terrainVersion;break;case C.PARENT:E=E.substring(0,E.length-1);T=p.getTileInformationFromQuadKey(E);O=T.terrainVersion;break;case C.UNKNOWN:if(m.hasTerrain()){O=m.terrainVersion}else{E=E.substring(0,E.length-1);T=p.getTileInformationFromQuadKey(E);if(i(T)&&T.hasTerrain()){O=T.terrainVersion}}break}if(O<0){return e.reject(new y("Terrain tile doesn't exist"))}var D=this._terrainPromises;var I=this._terrainRequests;var M=A(this,E,O);var R;var L;if(i(D[E])){R=D[E];L=I[E]}else{if(typeof s==="boolean"){a("throttleRequests","The throttleRequest parameter for requestTileGeometry was deprecated in Cesium 1.35.  It will be removed in 1.37.");s=new v({throttle:s,throttleByServer:s,type:_.TERRAIN})}L=s;var N=h(M,undefined,L);if(!i(N)){return undefined}R=N.then(function(t){if(i(t)){return x.scheduleTask({buffer:t,type:"Terrain",key:p.key},[t]).then(function(e){var t=p.getTileInformationFromQuadKey(E);t.terrainState=C.SELF;f.add(E,e[0]);var r=t.terrainProvider;var n=e.length-1;for(var a=0;a<n;++a){var o=E+a.toString();var s=p.getTileInformationFromQuadKey(o);if(i(s)){f.add(o,e[a+1]);s.terrainState=C.PARENT;if(s.terrainProvider===0){s.terrainProvider=r}}}})}return e.reject(new y("Failed to load terrain."))});D[E]=R;I[E]=L;R=R.always(function(){delete D[E];delete I[E]})}return R.then(function(){var t=f.get(l);if(i(t)){var r=p.providers[m.terrainProvider];return new c({buffer:t,childTileMask:P(l,m,p),credits:i(r)?[r]:undefined,negativeAltitudeExponentBias:p.negativeAltitudeExponentBias,negativeElevationThreshold:p.negativeAltitudeThreshold})}return e.reject(new y("Failed to load terrain."))}).otherwise(function(t){if(L.state===g.CANCELLED){s.state=L.state;return e.reject(t)}m.terrainState=C.NONE;return e.reject(t)})};E.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};E.prototype.getTileDataAvailable=function(e,t,r){var n=this._metadata;var a=u.tileXYToQuadKey(e,t,r);var o=n.getTileInformation(e,t,r);if(o===null){return false}if(i(o)){if(!o.ancestorHasTerrain){return true}var s=o.terrainState;if(s===C.NONE){return false}if(!i(s)||s===C.UNKNOWN){o.terrainState=C.UNKNOWN;if(!o.hasTerrain()){a=a.substring(0,a.length-1);var l=n.getTileInformationFromQuadKey(a);if(!i(l)||!l.hasTerrain()){return false}}}return true}if(n.isValid(a)){var c=new v({throttle:true,throttleByServer:true,type:_.TERRAIN});n.populateSubtree(e,t,r,c)}return false};function A(e,t,r){r=i(r)&&r>0?r:1;var n=e.url+"flatfile?f1c-0"+t+"-t."+r.toString();var a=e._proxy;if(i(a)){n=a.getURL(n)}return n}return E});define("Core/HeadingPitchRange",["./defaultValue","./defined"],function(e,t){"use strict";function r(t,r,i){this.heading=e(t,0);this.pitch=e(r,0);this.range=e(i,0)}r.clone=function(e,i){if(!t(e)){return undefined}if(!t(i)){i=new r}i.heading=e.heading;i.pitch=e.pitch;i.range=e.range;return i};return r});define("Core/HermitePolynomialApproximation",["./defaultValue","./defined","./DeveloperError","./Math"],function(e,t,r,i){"use strict";var n=i.factorial;function a(e,t,r,i,n,o){var s=0;var l;var u;var c;if(i>0){for(u=0;u<n;u++){l=false;for(c=0;c<o.length&&!l;c++){if(u===o[c]){l=true}}if(!l){o.push(u);s+=a(e,t,r,i-1,n,o);o.splice(o.length-1,1)}}return s}s=1;for(u=0;u<n;u++){l=false;for(c=0;c<o.length&&!l;c++){if(u===o[c]){l=true}}if(!l){s*=e-r[t[u]]}}return s}var o={type:"Hermite"};o.getRequiredDataPoints=function(i,n){n=e(n,0);if(!t(i)){throw new r("degree is required.")}if(i<0){throw new r("degree must be 0 or greater.")}if(n<0){throw new r("inputOrder must be 0 or greater.")}return Math.max(Math.floor((i+1)/(n+1)),2)};o.interpolateOrderZero=function(e,r,i,o,s){if(!t(s)){s=new Array(o)}var l;var u;var c;var d;var f;var h;var p=r.length;var m=new Array(o);for(l=0;l<o;l++){s[l]=0;var v=new Array(p);m[l]=v;for(u=0;u<p;u++){v[u]=[]}}var g=p,_=new Array(g);for(l=0;l<g;l++){_[l]=l}var y=p-1;for(d=0;d<o;d++){for(u=0;u<g;u++){h=_[u]*o+d;m[d][0].push(i[h])}for(l=1;l<g;l++){var b=false;for(u=0;u<g-l;u++){var w=r[_[u]];var C=r[_[u+l]];var S;if(C-w<=0){h=_[u]*o+o*l+d;S=i[h];m[d][l].push(S/n(l))}else{S=m[d][l-1][u+1]-m[d][l-1][u];m[d][l].push(S/(C-w))}b=b||S!==0}if(!b){y=l-1}}}for(c=0,f=0;c<=f;c++){for(l=c;l<=y;l++){var T=a(e,_,r,c,l,[]);for(d=0;d<o;d++){var E=m[d][l][0];s[d+c*o]+=E*T}}}return s};var s=[];o.interpolate=function(e,r,i,n,o,u,c){var d=n*(u+1);if(!t(c)){c=new Array(d)}for(var f=0;f<d;f++){c[f]=0}var h=r.length;var p=new Array(h*(o+1));var m;for(m=0;m<h;m++){for(var v=0;v<o+1;v++){p[m*(o+1)+v]=m}}var g=p.length;var _=s;var y=l(_,p,r,i,n,o);var b=[];var w=g*(g+1)/2;var C=Math.min(y,u);for(var S=0;S<=C;S++){for(m=S;m<=y;m++){b.length=0;var T=a(e,p,r,S,m,b);var E=Math.floor(m*(1-m)/2)+g*m;for(var x=0;x<n;x++){var P=Math.floor(x*w);var A=_[P+E];c[x+S*n]+=A*T}}}return c};function l(e,t,r,n,a,o){var s;var l;var u=-1;var c=t.length;var d=c*(c+1)/2;for(var f=0;f<a;f++){var h=Math.floor(f*d);for(s=0;s<c;s++){l=t[s]*a*(o+1)+f;e[h+s]=n[l]}for(var p=1;p<c;p++){var m=0;var v=Math.floor(p*(1-p)/2)+c*p;var g=false;for(s=0;s<c-p;s++){var _=r[t[s]];var y=r[t[s+p]];var b;var w;if(y-_<=0){l=t[s]*a*(o+1)+a*p+f;b=n[l];w=b/i.factorial(p);e[h+v+m]=w;m++}else{var C=Math.floor((p-1)*(2-p)/2)+c*(p-1);b=e[h+C+s+1]-e[h+C+s];w=b/(y-_);e[h+v+m]=w;m++}g=g||b!==0}if(g){u=Math.max(u,p)}}}return u}return o});define("Core/IauOrientationParameters",[],function(){"use strict";function e(e,t,r,i){this.rightAscension=e;this.declination=t;this.rotation=r;this.rotationRate=i}return e});define("Core/Iau2000Orientation",["./defined","./IauOrientationParameters","./JulianDate","./Math","./TimeConstants"],function(e,t,r,i,n){"use strict";var a={};var o=32.184;var s=2451545;var l=-.0529921;var u=-.1059842;var c=13.0120009;var d=13.3407154;var f=.9856003;var h=26.4057084;var p=13.064993;var m=.3287146;var v=1.7484877;var g=-.1589763;var _=.0036096;var y=.1643573;var b=12.9590088;var w=new r;a.ComputeMoon=function(a,C){if(!e(a)){a=r.now()}w=r.addSeconds(a,o,w);var S=r.totalDays(w)-s;var T=S/n.DAYS_PER_JULIAN_CENTURY;var E=(125.045+l*S)*i.RADIANS_PER_DEGREE;var x=(250.089+u*S)*i.RADIANS_PER_DEGREE;var P=(260.008+c*S)*i.RADIANS_PER_DEGREE;var A=(176.625+d*S)*i.RADIANS_PER_DEGREE;var O=(357.529+f*S)*i.RADIANS_PER_DEGREE;var D=(311.589+h*S)*i.RADIANS_PER_DEGREE;var I=(134.963+p*S)*i.RADIANS_PER_DEGREE;var M=(276.617+m*S)*i.RADIANS_PER_DEGREE;var R=(34.226+v*S)*i.RADIANS_PER_DEGREE;var L=(15.134+g*S)*i.RADIANS_PER_DEGREE;var N=(119.743+_*S)*i.RADIANS_PER_DEGREE;var k=(239.961+y*S)*i.RADIANS_PER_DEGREE;var F=(25.053+b*S)*i.RADIANS_PER_DEGREE;var B=Math.sin(E);var U=Math.sin(x);var V=Math.sin(P);var z=Math.sin(A);var q=Math.sin(O);var G=Math.sin(D);var H=Math.sin(I);var j=Math.sin(M);var W=Math.sin(R);var Y=Math.sin(L);var X=Math.sin(N);var Q=Math.sin(k);var Z=Math.sin(F);var K=Math.cos(E);var J=Math.cos(x);var $=Math.cos(P);var ee=Math.cos(A);var te=Math.cos(O);var re=Math.cos(D);var ie=Math.cos(I);var ne=Math.cos(M);var ae=Math.cos(R);var oe=Math.cos(L);var se=Math.cos(N);var le=Math.cos(k);var ue=Math.cos(F);var ce=(269.9949+.0031*T-3.8787*B-.1204*U+.07*V-.0172*z+.0072*G-.0052*Y+.0043*Z)*i.RADIANS_PER_DEGREE;var de=(66.5392+.013*T+1.5419*K+.0239*J-.0278*$+.0068*ee-.0029*re+9e-4*ie+8e-4*oe-9e-4*ue)*i.RADIANS_PER_DEGREE;var fe=(38.3213+13.17635815*S-1.4e-12*S*S+3.561*B+.1208*U-.0642*V+.0158*z+.0252*q-.0066*G-.0047*H-.0046*j+.0028*W+.0052*Y+.004*X+.0019*Q-.0044*Z)*i.RADIANS_PER_DEGREE;var he=(13.17635815-1.4e-12*(2*S)+3.561*K*l+.1208*J*u-.0642*$*c+.0158*ee*d+.0252*te*f-.0066*re*h-.0047*ie*p-.0046*ne*m+.0028*ae*v+.0052*oe*g+.004*se*_+.0019*le*y-.0044*ue*b)/86400*i.RADIANS_PER_DEGREE;if(!e(C)){C=new t}C.rightAscension=ce;C.declination=de;C.rotation=fe;C.rotationRate=he;return C};return a});define("Core/IauOrientationAxes",["./Cartesian3","./defined","./Iau2000Orientation","./JulianDate","./Math","./Matrix3","./Quaternion"],function(e,t,r,i,n,a,o){"use strict";function s(e){if(!t(e)||typeof e!=="function"){e=r.ComputeMoon}this._computeFunction=e}var l=new e;var u=new e;var c=new e;function d(r,i,o){var s=l;s.x=Math.cos(r+n.PI_OVER_TWO);s.y=Math.sin(r+n.PI_OVER_TWO);s.z=0;var d=Math.cos(i);var f=c;f.x=d*Math.cos(r);f.y=d*Math.sin(r);f.z=Math.sin(i);var h=e.cross(f,s,u);if(!t(o)){o=new a}o[0]=s.x;o[1]=h.x;o[2]=f.x;o[3]=s.y;o[4]=h.y;o[5]=f.y;o[6]=s.z;o[7]=h.z;o[8]=f.z;return o}var f=new a;var h=new o;s.prototype.evaluate=function(r,s){if(!t(r)){r=i.now()}var l=this._computeFunction(r);var u=d(l.rightAscension,l.declination,s);var c=n.zeroToTwoPi(l.rotation);var p=o.fromAxisAngle(e.UNIT_Z,c,h);var m=a.fromQuaternion(o.conjugate(p,p),f);var v=a.multiply(m,u,u);return v};return s});define("Core/InterpolationAlgorithm",["./DeveloperError"],function(e){"use strict";var t={};t.type=undefined;t.getRequiredDataPoints=e.throwInstantiationError;t.interpolateOrderZero=e.throwInstantiationError;t.interpolate=e.throwInstantiationError;return t});define("Core/TimeInterval",["./Check","./defaultValue","./defined","./defineProperties","./freezeObject","./JulianDate"],function(e,t,r,i,n,a){"use strict";function o(e){e=t(e,t.EMPTY_OBJECT);this.start=r(e.start)?a.clone(e.start):new a;this.stop=r(e.stop)?a.clone(e.stop):new a;this.data=e.data;this.isStartIncluded=t(e.isStartIncluded,true);this.isStopIncluded=t(e.isStopIncluded,true)}i(o.prototype,{isEmpty:{get:function(){var e=a.compare(this.stop,this.start);return e<0||e===0&&(!this.isStartIncluded||!this.isStopIncluded)}}});var s={start:undefined,stop:undefined,isStartIncluded:undefined,isStopIncluded:undefined,data:undefined};o.fromIso8601=function(i,n){e.typeOf.object("options",i);e.typeOf.string("options.iso8601",i.iso8601);var l=i.iso8601.split("/");var u=a.fromIso8601(l[0]);var c=a.fromIso8601(l[1]);var d=t(i.isStartIncluded,true);var f=t(i.isStopIncluded,true);var h=i.data;if(!r(n)){s.start=u;s.stop=c;s.isStartIncluded=d;s.isStopIncluded=f;s.data=h;return new o(s)}n.start=u;n.stop=c;n.isStartIncluded=d;n.isStopIncluded=f;n.data=h;return n};o.toIso8601=function(t,r){e.typeOf.object("timeInterval",t);return a.toIso8601(t.start,r)+"/"+a.toIso8601(t.stop,r)};o.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new o(e)}t.start=e.start;t.stop=e.stop;t.isStartIncluded=e.isStartIncluded;t.isStopIncluded=e.isStopIncluded;t.data=e.data;return t};o.equals=function(e,t,i){return e===t||r(e)&&r(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&a.equals(e.start,t.start)&&a.equals(e.stop,t.stop)&&(e.data===t.data||r(i)&&i(e.data,t.data)))};o.equalsEpsilon=function(t,i,n,o){e.typeOf.number("epsilon",n);return t===i||r(t)&&r(i)&&(t.isEmpty&&i.isEmpty||t.isStartIncluded===i.isStartIncluded&&t.isStopIncluded===i.isStopIncluded&&a.equalsEpsilon(t.start,i.start,n)&&a.equalsEpsilon(t.stop,i.stop,n)&&(t.data===i.data||r(o)&&o(t.data,i.data)))};o.intersect=function(t,i,n,s){e.typeOf.object("left",t);e.typeOf.object("result",n);if(!r(i)){return o.clone(o.EMPTY,n)}var l=t.start;var u=t.stop;var c=i.start;var d=i.stop;var f=a.greaterThanOrEquals(c,l)&&a.greaterThanOrEquals(u,c);var h=!f&&a.lessThanOrEquals(c,l)&&a.lessThanOrEquals(l,d);if(!f&&!h){return o.clone(o.EMPTY,n)}var p=t.isStartIncluded;var m=t.isStopIncluded;var v=i.isStartIncluded;var g=i.isStopIncluded;var _=a.lessThan(u,d);n.start=f?c:l;n.isStartIncluded=p&&v||!a.equals(c,l)&&(f&&v||h&&p);n.stop=_?u:d;n.isStopIncluded=_?m:m&&g||!a.equals(d,u)&&g;n.data=r(s)?s(t.data,i.data):t.data;return n};o.contains=function(t,r){e.typeOf.object("timeInterval",t);e.typeOf.object("julianDate",r);if(t.isEmpty){return false}var i=a.compare(t.start,r);if(i===0){return t.isStartIncluded}var n=a.compare(r,t.stop);if(n===0){return t.isStopIncluded}return i<0&&n<0};o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e,t){return o.equals(this,e,t)};o.prototype.equalsEpsilon=function(e,t,r){return o.equalsEpsilon(this,e,t,r)};o.prototype.toString=function(){return o.toIso8601(this)};o.EMPTY=n(new o({start:new a,stop:new a,isStartIncluded:false,isStopIncluded:false}));return o});define("Core/Iso8601",["./freezeObject","./JulianDate","./TimeInterval"],function(e,t,r){"use strict";var i=e(t.fromIso8601("0000-01-01T00:00:00Z"));var n=e(t.fromIso8601("9999-12-31T24:00:00Z"));var a=e(new r({start:i,stop:n}));var o={MINIMUM_VALUE:i,MAXIMUM_VALUE:n,MAXIMUM_INTERVAL:a};return o});define("Core/KeyboardEventModifier",["./freezeObject"],function(e){"use strict";var t={SHIFT:0,CTRL:1,ALT:2};return e(t)});define("Core/LagrangePolynomialApproximation",["./defined"],function(e){"use strict";var t={type:"Lagrange"};t.getRequiredDataPoints=function(e){return Math.max(e+1,2)};t.interpolateOrderZero=function(t,r,i,n,a){if(!e(a)){a=new Array(n)}var o;var s;var l=r.length;for(o=0;o<n;o++){a[o]=0}for(o=0;o<l;o++){var u=1;for(s=0;s<l;s++){if(s!==o){var c=r[o]-r[s];u*=(t-r[s])/c}}for(s=0;s<n;s++){a[s]+=u*i[o*n+s]}}return a};return t});define("Core/LinearApproximation",["./defined","./DeveloperError"],function(e,t){"use strict";var r={type:"Linear"};r.getRequiredDataPoints=function(e){return 2};r.interpolateOrderZero=function(r,i,n,a,o){if(i.length!==2){throw new t("The xTable provided to the linear interpolator must have exactly two elements.")}else if(a<=0){throw new t("There must be at least 1 dependent variable for each independent variable.")}if(!e(o)){o=new Array(a)}var s;var l;var u;var c=i[0];var d=i[1];if(c===d){throw new t("Divide by zero error: xTable[0] and xTable[1] are equal")}for(s=0;s<a;s++){l=n[s];u=n[s+a];o[s]=((u-l)*r+d*l-c*u)/(d-c)}return o};return r});define("Core/loadBlob",["./loadWithXhr"],function(e){"use strict";function t(t,r,i){return e({url:t,responseType:"blob",headers:r,request:i})}return t});define("Core/loadCRN",["../ThirdParty/when","./CompressedTextureBuffer","./defined","./DeveloperError","./loadArrayBuffer","./TaskProcessor"],function(e,t,r,i,n,a){"use strict";var o=new a("transcodeCRNToDXT",Number.POSITIVE_INFINITY);function s(a,s,l){if(!r(a)){throw new i("urlOrBuffer is required.")}var u;if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)){u=e.resolve(a)}else{u=n(a,s,l)}if(!r(u)){return undefined}return u.then(function(e){var t=[];if(e instanceof ArrayBuffer){t.push(e)}else if(e.byteOffset===0&&e.byteLength===e.buffer.byteLength){t.push(e.buffer)}else{e=e.slice(0,e.length);t.push(e.buffer)}return o.scheduleTask(e,t)}).then(function(e){return t.clone(e)})}return s});define("Core/loadImage",["../ThirdParty/when","./Check","./defaultValue","./defined","./deprecationWarning","./DeveloperError","./isCrossOriginUrl","./isDataUri","./Request","./RequestScheduler","./TrustedServers"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";function d(e,i,a){t.defined("url",e);i=r(i,true);if(typeof e!=="string"){n("url promise","url as a Promise is deprecated and will be removed in 1.37");return e.then(function(e){return f(e,i,a)})}return f(e,i,a)}function f(t,r,n){n=i(n)?n:new l;n.url=t;n.requestFunction=function(){var i;if(s(t)||!r){i=false}else{i=o(t)}var n=e.defer();d.createImage(t,i,n);return n.promise};return u.request(n)}d.createImage=function(e,t,r){var i=new Image;i.onload=function(){r.resolve(i)};i.onerror=function(e){r.reject(e)};if(t){if(c.contains(e)){i.crossOrigin="use-credentials"}else{i.crossOrigin=""}}i.src=e};d.defaultCreateImage=d.createImage;return d});define("Core/loadImageFromTypedArray",["../ThirdParty/when","./Check","./defined","./DeveloperError","./loadImage"],function(e,t,r,i,n){"use strict";function a(r,i,a){t.typeOf.object("uint8Array",r);t.typeOf.string("format",i);var o=new Blob([r],{type:i});var s=window.URL.createObjectURL(o);return n(s,false,a).then(function(e){window.URL.revokeObjectURL(s);return e},function(t){window.URL.revokeObjectURL(s);return e.reject(t)})}return a});define("Core/loadImageViaBlob",["../ThirdParty/when","./defined","./isDataUri","./loadBlob","./loadImage"],function(e,t,r,i,n){"use strict";var a=function(){try{var e=new XMLHttpRequest;e.open("GET","#",true);e.responseType="blob";return e.responseType==="blob"}catch(e){return false}}();function o(o,s){if(!a||r(o)){return n(o,undefined,s)}var l=i(o,undefined,s);if(!t(l)){return undefined}return l.then(function(t){var r=window.URL.createObjectURL(t);return n(r,false).then(function(e){e.blob=t;window.URL.revokeObjectURL(r);return e},function(t){window.URL.revokeObjectURL(r);return e.reject(t)})})}return o});define("Renderer/PixelDatatype",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={UNSIGNED_BYTE:t.UNSIGNED_BYTE,UNSIGNED_SHORT:t.UNSIGNED_SHORT,UNSIGNED_INT:t.UNSIGNED_INT,FLOAT:t.FLOAT,UNSIGNED_INT_24_8:t.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:t.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:t.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:t.UNSIGNED_SHORT_5_6_5,isPacked:function(e){return e===r.UNSIGNED_INT_24_8||e===r.UNSIGNED_SHORT_4_4_4_4||e===r.UNSIGNED_SHORT_5_5_5_1||e===r.UNSIGNED_SHORT_5_6_5},sizeInBytes:function(e){switch(e){case r.UNSIGNED_BYTE:return 1;case r.UNSIGNED_SHORT:case r.UNSIGNED_SHORT_4_4_4_4:case r.UNSIGNED_SHORT_5_5_5_1:case r.UNSIGNED_SHORT_5_6_5:return 2;case r.UNSIGNED_INT:case r.FLOAT:case r.UNSIGNED_INT_24_8:return 4}},validate:function(e){return e===r.UNSIGNED_BYTE||e===r.UNSIGNED_SHORT||e===r.UNSIGNED_INT||e===r.FLOAT||e===r.UNSIGNED_INT_24_8||e===r.UNSIGNED_SHORT_4_4_4_4||e===r.UNSIGNED_SHORT_5_5_5_1||e===r.UNSIGNED_SHORT_5_6_5}};return e(r)});define("Core/PixelFormat",["../Renderer/PixelDatatype","./freezeObject","./WebGLConstants"],function(e,t,r){"use strict";var i={DEPTH_COMPONENT:r.DEPTH_COMPONENT,DEPTH_STENCIL:r.DEPTH_STENCIL,ALPHA:r.ALPHA,RGB:r.RGB,RGBA:r.RGBA,LUMINANCE:r.LUMINANCE,LUMINANCE_ALPHA:r.LUMINANCE_ALPHA,RGB_DXT1:r.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:r.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:r.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:r.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGB_ETC1:r.COMPRESSED_RGB_ETC1_WEBGL,componentsLength:function(e){switch(e){case i.RGB:case i.RGBA:return 4;case i.LUMINANCE_ALPHA:return 2;case i.ALPHA:case i.LUMINANCE:return 1;default:return 1}},validate:function(e){return e===i.DEPTH_COMPONENT||e===i.DEPTH_STENCIL||e===i.ALPHA||e===i.RGB||e===i.RGBA||e===i.LUMINANCE||e===i.LUMINANCE_ALPHA||e===i.RGB_DXT1||e===i.RGBA_DXT1||e===i.RGBA_DXT3||e===i.RGBA_DXT5||e===i.RGB_PVRTC_4BPPV1||e===i.RGB_PVRTC_2BPPV1||e===i.RGBA_PVRTC_4BPPV1||e===i.RGBA_PVRTC_2BPPV1||e===i.RGB_ETC1},isColorFormat:function(e){return e===i.ALPHA||e===i.RGB||e===i.RGBA||e===i.LUMINANCE||e===i.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===i.DEPTH_COMPONENT||e===i.DEPTH_STENCIL},isCompressedFormat:function(e){return e===i.RGB_DXT1||e===i.RGBA_DXT1||e===i.RGBA_DXT3||e===i.RGBA_DXT5||e===i.RGB_PVRTC_4BPPV1||e===i.RGB_PVRTC_2BPPV1||e===i.RGBA_PVRTC_4BPPV1||e===i.RGBA_PVRTC_2BPPV1||e===i.RGB_ETC1},isDXTFormat:function(e){return e===i.RGB_DXT1||e===i.RGBA_DXT1||e===i.RGBA_DXT3||e===i.RGBA_DXT5},isPVRTCFormat:function(e){return e===i.RGB_PVRTC_4BPPV1||e===i.RGB_PVRTC_2BPPV1||e===i.RGBA_PVRTC_4BPPV1||e===i.RGBA_PVRTC_2BPPV1},isETC1Format:function(e){return e===i.RGB_ETC1},compressedTextureSizeInBytes:function(e,t,r){switch(e){case i.RGB_DXT1:case i.RGBA_DXT1:case i.RGB_ETC1:return Math.floor((t+3)/4)*Math.floor((r+3)/4)*8;case i.RGBA_DXT3:case i.RGBA_DXT5:return Math.floor((t+3)/4)*Math.floor((r+3)/4)*16;case i.RGB_PVRTC_4BPPV1:case i.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(r,8)*4+7)/8);case i.RGB_PVRTC_2BPPV1:case i.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(r,8)*2+7)/8);default:return 0}},textureSizeInBytes:function(t,r,n,a){var o=i.componentsLength(t);if(e.isPacked(r)){o=1}return o*e.sizeInBytes(r)*n*a}};return t(i)});define("Core/loadKTX",["../ThirdParty/when","./Check","./CompressedTextureBuffer","./defined","./loadArrayBuffer","./PixelFormat","./RuntimeError"],function(e,t,r,i,n,a,o){"use strict";function s(r,a,o){t.defined("urlOrBuffer",r);var s;if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)){s=e.resolve(r)}else{s=n(r,a,o)}if(!i(s)){return undefined}return s.then(function(e){return d(e)})}var l=[171,75,84,88,32,49,49,187,13,10,26,10];var u=67305985;var c=4;function d(e){var t=new Uint8Array(e);var n=true;for(var s=0;s<l.length;++s){if(l[s]!==t[s]){n=false;break}}if(!n){throw new o("Invalid KTX file.")}var d;var f;if(i(e.buffer)){d=new DataView(e.buffer);f=e.byteOffset}else{d=new DataView(e);f=0}f+=12;var h=d.getUint32(f,true);f+=c;if(h!==u){throw new o("File is the wrong endianness.")}var p=d.getUint32(f,true);f+=c;var m=d.getUint32(f,true);f+=c;var v=d.getUint32(f,true);f+=c;var g=d.getUint32(f,true);f+=c;var _=d.getUint32(f,true);f+=c;var y=d.getUint32(f,true);f+=c;var b=d.getUint32(f,true);f+=c;var w=d.getUint32(f,true);f+=c;var C=d.getUint32(f,true);f+=c;var S=d.getUint32(f,true);f+=c;var T=d.getUint32(f,true);f+=c;var E=d.getUint32(f,true);f+=c;f+=E;var x=d.getUint32(f,true);f+=c;var P;if(i(e.buffer)){P=new Uint8Array(e.buffer,f,x)}else{P=new Uint8Array(e,f,x)}if(g===32849){g=a.RGB}else if(g===32856){g=a.RGBA}if(!a.validate(g)){throw new o("glInternalFormat is not a valid format.")}if(a.isCompressedFormat(g)){if(p!==0){throw new o("glType must be zero when the texture is compressed.")}if(m!==1){throw new o("The type size for compressed textures must be 1.")}if(v!==0){throw new o("glFormat must be zero when the texture is compressed.")}}else if(_!==v){throw new o("The base internal format must be the same as the format for uncompressed textures.")}if(w!==0){throw new o("3D textures are unsupported.")}if(C!==0){throw new o("Texture arrays are unsupported.")}if(S!==1){throw new o("Cubemaps are unsupported.")}if(T>1){var A=a.isCompressedFormat(g)?a.compressedTextureSizeInBytes(g,y,b):a.textureSizeInBytes(g,y,b);P=new Uint8Array(P.buffer,P.byteOffset,A)}return new r(g,y,b,P)}return s});define("Core/loadXML",["./loadWithXhr"],function(e){"use strict";function t(t,r,i){return e({url:t,responseType:"document",headers:r,overrideMimeType:"text/xml",request:i})}return t});define("Core/ManagedArray",["./Check","./defaultValue","./defineProperties"],function(e,t,r){"use strict";function i(e){e=t(e,0);this._array=new Array(e);this._length=e}r(i.prototype,{length:{get:function(){return this._length},set:function(e){this._length=e;if(e>this._array.length){this._array.length=e}}},values:{get:function(){return this._array}}});i.prototype.get=function(t){e.typeOf.number.lessThan("index",t,this._array.length);return this._array[t]};i.prototype.set=function(t,r){e.typeOf.number("index",t);if(t>=this.length){this.length=t+1}this._array[t]=r};i.prototype.push=function(e){var t=this.length++;this._array[t]=e};i.prototype.pop=function(){return this._array[--this.length]};i.prototype.reserve=function(t){e.typeOf.number.greaterThanOrEquals("length",t,0);if(t>this._array.length){this._array.length=t}};i.prototype.resize=function(t){e.typeOf.number.greaterThanOrEquals("length",t,0);this.length=t};i.prototype.trim=function(e){e=t(e,this.length);this._array.length=e};return i});define("Core/MapboxApi",["./Credit","./defined"],function(e,t){"use strict";var r={};r.defaultAccessToken=undefined;var i=false;var n;var a="This application is using Cesium's default Mapbox access token.  Please create a new access token for the application as soon as possible and prior to deployment by visiting https://www.mapbox.com/account/apps/, and provide your token to Cesium by setting the Cesium.MapboxApi.defaultAccessToken property before constructing the CesiumWidget or any other object that uses the Mapbox API.";r.getAccessToken=function(e){if(t(e)){return e}if(!t(r.defaultAccessToken)){if(!i){console.log(a);i=true}return"pk.eyJ1IjoiYW5hbHl0aWNhbGdyYXBoaWNzIiwiYSI6ImNpd204Zm4wejAwNzYyeW5uNjYyZmFwdWEifQ.7i-VIZZWX8pd1bTfxIVj9g"}return r.defaultAccessToken};r.getErrorCredit=function(i){if(t(i)||t(r.defaultAccessToken)){return undefined}if(!t(n)){n=new e(a)}return n};return r});define("Core/MapProjection",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}e(r.prototype,{ellipsoid:{get:t.throwInstantiationError}});r.prototype.project=t.throwInstantiationError;r.prototype.unproject=t.throwInstantiationError;return r});define("Core/Matrix2",["./Cartesian2","./Check","./defaultValue","./defined","./defineProperties","./freezeObject"],function(e,t,r,i,n,a){"use strict";function o(e,t,i,n){this[0]=r(e,0);this[1]=r(i,0);this[2]=r(t,0);this[3]=r(n,0)}o.packedLength=4;o.pack=function(e,i,n){t.typeOf.object("value",e);t.defined("array",i);n=r(n,0);i[n++]=e[0];i[n++]=e[1];i[n++]=e[2];i[n++]=e[3];return i};o.unpack=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new o}a[0]=e[n++];a[1]=e[n++];a[2]=e[n++];a[3]=e[n++];return a};o.clone=function(e,t){if(!i(e)){return undefined}if(!i(t)){return new o(e[0],e[2],e[1],e[3])}t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t};o.fromArray=function(e,n,a){t.defined("array",e);n=r(n,0);if(!i(a)){a=new o}a[0]=e[n];a[1]=e[n+1];a[2]=e[n+2];a[3]=e[n+3];return a};o.fromColumnMajorArray=function(e,r){t.defined("values",e);return o.clone(e,r)};o.fromRowMajorArray=function(e,r){t.defined("values",e);if(!i(r)){return new o(e[0],e[1],e[2],e[3])}r[0]=e[0];r[1]=e[2];r[2]=e[1];r[3]=e[3];return r};o.fromScale=function(e,r){t.typeOf.object("scale",e);if(!i(r)){return new o(e.x,0,0,e.y)}r[0]=e.x;r[1]=0;r[2]=0;r[3]=e.y;return r};o.fromUniformScale=function(e,r){t.typeOf.number("scale",e);if(!i(r)){return new o(e,0,0,e)}r[0]=e;r[1]=0;r[2]=0;r[3]=e;return r};o.fromRotation=function(e,r){t.typeOf.number("angle",e);var n=Math.cos(e);var a=Math.sin(e);if(!i(r)){return new o(n,-a,a,n)}r[0]=n;r[1]=a;r[2]=-a;r[3]=n;return r};o.toArray=function(e,r){t.typeOf.object("matrix",e);if(!i(r)){return[e[0],e[1],e[2],e[3]]}r[0]=e[0];r[1]=e[1];r[2]=e[2];r[3]=e[3];return r};o.getElementIndex=function(e,r){t.typeOf.number.greaterThanOrEquals("row",r,0);t.typeOf.number.lessThanOrEquals("row",r,1);t.typeOf.number.greaterThanOrEquals("column",e,0);t.typeOf.number.lessThanOrEquals("column",e,1);return e*2+r};o.getColumn=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,1);t.typeOf.object("result",i);var n=r*2;var a=e[n];var o=e[n+1];i.x=a;i.y=o;return i};o.setColumn=function(e,r,i,n){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,1);t.typeOf.object("cartesian",i);t.typeOf.object("result",n);n=o.clone(e,n);var a=r*2;n[a]=i.x;n[a+1]=i.y;return n};o.getRow=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,1);t.typeOf.object("result",i);var n=e[r];var a=e[r+2];i.x=n;i.y=a;return i};o.setRow=function(e,r,i,n){t.typeOf.object("matrix",e);t.typeOf.number.greaterThanOrEquals("index",r,0);t.typeOf.number.lessThanOrEquals("index",r,1);t.typeOf.object("cartesian",i);t.typeOf.object("result",n);n=o.clone(e,n);n[r]=i.x;n[r+2]=i.y;return n};var s=new e;o.getScale=function(r,i){t.typeOf.object("matrix",r);t.typeOf.object("result",i);i.x=e.magnitude(e.fromElements(r[0],r[1],s));i.y=e.magnitude(e.fromElements(r[2],r[3],s));return i};var l=new e;o.getMaximumScale=function(t){o.getScale(t,l);return e.maximumComponent(l)};o.multiply=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);var n=e[0]*r[0]+e[2]*r[1];var a=e[0]*r[2]+e[2]*r[3];var o=e[1]*r[0]+e[3]*r[1];var s=e[1]*r[2]+e[3]*r[3];i[0]=n;i[1]=o;i[2]=a;i[3]=s;return i};o.add=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i[0]=e[0]+r[0];i[1]=e[1]+r[1];i[2]=e[2]+r[2];i[3]=e[3]+r[3];return i};o.subtract=function(e,r,i){t.typeOf.object("left",e);t.typeOf.object("right",r);t.typeOf.object("result",i);i[0]=e[0]-r[0];i[1]=e[1]-r[1];i[2]=e[2]-r[2];i[3]=e[3]-r[3];return i};o.multiplyByVector=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.object("cartesian",r);t.typeOf.object("result",i);var n=e[0]*r.x+e[2]*r.y;var a=e[1]*r.x+e[3]*r.y;i.x=n;i.y=a;return i};o.multiplyByScalar=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.number("scalar",r);t.typeOf.object("result",i);i[0]=e[0]*r;i[1]=e[1]*r;i[2]=e[2]*r;i[3]=e[3]*r;return i};o.multiplyByScale=function(e,r,i){t.typeOf.object("matrix",e);t.typeOf.object("scale",r);t.typeOf.object("result",i);i[0]=e[0]*r.x;i[1]=e[1]*r.x;i[2]=e[2]*r.y;i[3]=e[3]*r.y;return i};o.negate=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);r[0]=-e[0];r[1]=-e[1];r[2]=-e[2];r[3]=-e[3];return r};o.transpose=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);var i=e[0];var n=e[2];var a=e[1];var o=e[3];r[0]=i;r[1]=n;r[2]=a;r[3]=o;return r};o.abs=function(e,r){t.typeOf.object("matrix",e);t.typeOf.object("result",r);r[0]=Math.abs(e[0]);r[1]=Math.abs(e[1]);r[2]=Math.abs(e[2]);r[3]=Math.abs(e[3]);return r};o.equals=function(e,t){return e===t||i(e)&&i(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]};o.equalsArray=function(e,t,r){return e[0]===t[r]&&e[1]===t[r+1]&&e[2]===t[r+2]&&e[3]===t[r+3]};o.equalsEpsilon=function(e,r,n){t.typeOf.number("epsilon",n);return e===r||i(e)&&i(r)&&Math.abs(e[0]-r[0])<=n&&Math.abs(e[1]-r[1])<=n&&Math.abs(e[2]-r[2])<=n&&Math.abs(e[3]-r[3])<=n};o.IDENTITY=a(new o(1,0,0,1));o.ZERO=a(new o(0,0,0,0));o.COLUMN0ROW0=0;o.COLUMN0ROW1=1;o.COLUMN1ROW0=2;o.COLUMN1ROW1=3;n(o.prototype,{length:{get:function(){return o.packedLength}}});o.prototype.clone=function(e){return o.clone(this,e)};o.prototype.equals=function(e){return o.equals(this,e)};o.prototype.equalsEpsilon=function(e,t){return o.equalsEpsilon(this,e,t)};o.prototype.toString=function(){return"("+this[0]+", "+this[2]+")\n"+"("+this[1]+", "+this[3]+")"};return o});define("Core/mergeSort",["./defined","./DeveloperError"],function(e,t){"use strict";var r=[];var i=[];function n(e,t,n,a,o,s){var l=o-a+1;var u=s-o;var c=r;var d=i;var f;var h;for(f=0;f<l;++f){c[f]=e[a+f]}for(h=0;h<u;++h){d[h]=e[o+h+1]}f=0;h=0;for(var p=a;p<=s;++p){var m=c[f];var v=d[h];if(f<l&&(h>=u||t(m,v,n)<=0)){e[p]=m;++f}else if(h<u){e[p]=v;++h}}}function a(e,t,r,i,o){if(i>=o){return}var s=Math.floor((i+o)*.5);a(e,t,r,i,s);a(e,t,r,s+1,o);n(e,t,r,i,s,o)}function o(n,o,s){if(!e(n)){throw new t("array is required.")}if(!e(o)){throw new t("comparator is required.")}var l=n.length;var u=Math.ceil(l*.5);r.length=u;i.length=u;a(n,o,s,0,l-1);r.length=0;i.length=0}return o});define("Core/NearFarScalar",["./defaultValue","./defined","./DeveloperError"],function(e,t,r){"use strict";function i(t,r,i,n){this.near=e(t,0);this.nearValue=e(r,0);this.far=e(i,1);this.farValue=e(n,0)}i.clone=function(e,r){if(!t(e)){return undefined}if(!t(r)){return new i(e.near,e.nearValue,e.far,e.farValue)}r.near=e.near;r.nearValue=e.nearValue;r.far=e.far;r.farValue=e.farValue;return r};i.packedLength=4;i.pack=function(i,n,a){if(!t(i)){throw new r("value is required")}if(!t(n)){throw new r("array is required")}a=e(a,0);n[a++]=i.near;n[a++]=i.nearValue;n[a++]=i.far;n[a]=i.farValue;return n};i.unpack=function(n,a,o){if(!t(n)){throw new r("array is required")}a=e(a,0);if(!t(o)){o=new i}o.near=n[a++];o.nearValue=n[a++];o.far=n[a++];o.farValue=n[a];return o};i.equals=function(e,r){return e===r||t(e)&&t(r)&&e.near===r.near&&e.nearValue===r.nearValue&&e.far===r.far&&e.farValue===r.farValue};i.prototype.clone=function(e){return i.clone(this,e)};i.prototype.equals=function(e){return i.equals(this,e)};return i});define("Core/Visibility",["./freezeObject"],function(e){"use strict";var t={NONE:-1,PARTIAL:0,FULL:1};return e(t)});define("Core/Occluder",["./BoundingSphere","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math","./Rectangle","./Visibility"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e,r){if(!i(e)){throw new a("occluderBoundingSphere is required.")}if(!i(r)){throw new a("camera position is required.")}this._occluderPosition=t.clone(e.center);this._occluderRadius=e.radius;this._horizonDistance=0;this._horizonPlaneNormal=undefined;this._horizonPlanePosition=undefined;this._cameraPosition=undefined;this.cameraPosition=r}var d=new t;n(c.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){if(!i(e)){throw new a("cameraPosition is required.")}e=t.clone(e,this._cameraPosition);var r=t.subtract(this._occluderPosition,e,d);var n=t.magnitudeSquared(r);var o=this._occluderRadius*this._occluderRadius;var s;var l;var u;if(n>o){s=Math.sqrt(n-o);n=1/Math.sqrt(n);l=t.multiplyByScalar(r,n,d);var c=s*s*n;u=t.add(e,t.multiplyByScalar(l,c,d),d)}else{s=Number.MAX_VALUE}this._horizonDistance=s;this._horizonPlaneNormal=l;this._horizonPlanePosition=u;this._cameraPosition=e}}});c.fromBoundingSphere=function(e,r,n){if(!i(e)){throw new a("occluderBoundingSphere is required.")}if(!i(r)){throw new a("camera position is required.")}if(!i(n)){return new c(e,r)}t.clone(e.center,n._occluderPosition);n._occluderRadius=e.radius;n.cameraPosition=r;return n};var f=new t;c.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){var r=t.subtract(e,this._occluderPosition,f);var i=this._occluderRadius;i=t.magnitudeSquared(r)-i*i;if(i>0){i=Math.sqrt(i)+this._horizonDistance;r=t.subtract(e,this._cameraPosition,r);return i*i>t.magnitudeSquared(r)}}return false};var h=new t;c.prototype.isBoundingSphereVisible=function(e){var r=t.clone(e.center,h);var i=e.radius;if(this._horizonDistance!==Number.MAX_VALUE){var n=t.subtract(r,this._occluderPosition,f);var a=this._occluderRadius-i;a=t.magnitudeSquared(n)-a*a;if(i<this._occluderRadius){if(a>0){a=Math.sqrt(a)+this._horizonDistance;n=t.subtract(r,this._cameraPosition,n);return a*a+i*i>t.magnitudeSquared(n)}return false}if(a>0){n=t.subtract(r,this._cameraPosition,n);var o=t.magnitudeSquared(n);var s=this._occluderRadius*this._occluderRadius;var l=i*i;if((this._horizonDistance*this._horizonDistance+s)*l>o*s){return true}a=Math.sqrt(a)+this._horizonDistance;return a*a+l>o}return true}return false};var p=new t;c.prototype.computeVisibility=function(e){if(!i(e)){throw new a("occludeeBS is required.")}var r=t.clone(e.center);var n=e.radius;if(n>this._occluderRadius){return u.FULL}if(this._horizonDistance!==Number.MAX_VALUE){var o=t.subtract(r,this._occluderPosition,p);var s=this._occluderRadius-n;var l=t.magnitudeSquared(o);s=l-s*s;if(s>0){s=Math.sqrt(s)+this._horizonDistance;o=t.subtract(r,this._cameraPosition,o);var c=t.magnitudeSquared(o);if(s*s+n*n<c){return u.NONE}s=this._occluderRadius+n;s=l-s*s;if(s>0){s=Math.sqrt(s)+this._horizonDistance;return c<s*s+n*n?u.FULL:u.PARTIAL}o=t.subtract(r,this._horizonPlanePosition,o);return t.dot(o,this._horizonPlaneNormal)>-n?u.PARTIAL:u.FULL}}return u.NONE};var m=new t;c.computeOccludeePoint=function(e,r,n){if(!i(e)){throw new a("occluderBoundingSphere is required.")}if(!i(n)){throw new a("positions is required.")}if(n.length===0){throw new a("positions must contain at least one element")}var o=t.clone(r);var s=t.clone(e.center);var l=e.radius;var u=n.length;if(t.equals(s,r)){throw new a("occludeePosition must be different than occluderBoundingSphere.center")}var d=t.normalize(t.subtract(o,s,m),m);var f=-t.dot(d,s);var h=c._anyRotationVector(s,d,f);var p=c._horizonToPlaneNormalDotProduct(e,d,f,h,n[0]);if(!p){return undefined}var v;for(var g=1;g<u;++g){v=c._horizonToPlaneNormalDotProduct(e,d,f,h,n[g]);if(!v){return undefined}if(v<p){p=v}}if(p<.0017453283658983088){return undefined}var _=l/p;return t.add(s,t.multiplyByScalar(d,_,m),m)};var v=[];c.computeOccludeePointFromRectangle=function(n,s){if(!i(n)){throw new a("rectangle is required.")}s=r(s,o.WGS84);var u=l.subsample(n,s,0,v);var d=e.fromPoints(u);var f=t.ZERO;if(!t.equals(f,d.center)){return c.computeOccludeePoint(new e(f,s.minimumRadius),d.center,u)}return undefined};var g=new t;c._anyRotationVector=function(e,r,i){var n=t.abs(r,g);var a=n.x>n.y?0:1;if(a===0&&n.z>n.x||a===1&&n.z>n.y){a=2}var o=new t;var s;if(a===0){n.x=e.x;n.y=e.y+1;n.z=e.z+1;s=t.UNIT_X}else if(a===1){n.x=e.x+1;n.y=e.y;n.z=e.z+1;s=t.UNIT_Y}else{n.x=e.x+1;n.y=e.y+1;n.z=e.z;s=t.UNIT_Z}var l=(t.dot(r,n)+i)/-t.dot(r,s);return t.normalize(t.subtract(t.add(n,t.multiplyByScalar(s,l,o),n),e,n),n)};var _=new t;c._rotationVector=function(e,r,i,n,a){var o=t.subtract(n,e,_);o=t.normalize(o,o);if(t.dot(r,o)<.9999999847691291){var l=t.cross(r,o,o);var u=t.magnitude(l);if(u>s.EPSILON13){return t.normalize(l,new t)}}return a};var y=new t;var b=new t;var w=new t;var C=new t;c._horizonToPlaneNormalDotProduct=function(e,r,i,n,a){var o=t.clone(a,y);var s=t.clone(e.center,b);var l=e.radius;var u=t.subtract(s,o,w);var c=t.magnitudeSquared(u);var d=l*l;if(c<d){return false}var f=c-d;var h=Math.sqrt(f);var p=Math.sqrt(c);var m=1/p;var v=h*m;var g=v*h;u=t.normalize(u,u);var _=t.add(o,t.multiplyByScalar(u,g,C),C);var S=Math.sqrt(f-g*g);var T=this._rotationVector(s,r,i,o,n);var E=t.fromElements(T.x*T.x*u.x+(T.x*T.y-T.z)*u.y+(T.x*T.z+T.y)*u.z,(T.x*T.y+T.z)*u.x+T.y*T.y*u.y+(T.y*T.z-T.x)*u.z,(T.x*T.z-T.y)*u.x+(T.y*T.z+T.x)*u.y+T.z*T.z*u.z,y);E=t.normalize(E,E);var x=t.multiplyByScalar(E,S,y);T=t.normalize(t.subtract(t.add(_,x,w),s,w),w);var P=t.dot(r,T);T=t.normalize(t.subtract(t.subtract(_,x,T),s,T),T);var A=t.dot(r,T);return P<A?P:A};return c});define("Core/Packable",["./DeveloperError"],function(e){"use strict";var t={packedLength:undefined,pack:e.throwInstantiationError,unpack:e.throwInstantiationError};return t});define("Core/PackableForInterpolation",["./DeveloperError"],function(e){"use strict";var t={packedInterpolationLength:undefined,convertPackedArrayForInterpolation:e.throwInstantiationError,unpackInterpolationResult:e.throwInstantiationError};return t});define("ThirdParty/measureText",[],function(){var e=function(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)};var t=function(t,r,i,n){var a=t.measureText(r),o=e(t.canvas,"font-family"),s=e(t.canvas,"font-size").replace("px",""),l=e(t.canvas,"font-style"),u=e(t.canvas,"font-weight"),c=!/\S/.test(r);a.fontsize=s;var d=document.createElement("div");d.style.position="absolute";d.style.opacity=0;d.style.font=l+" "+u+" "+s+"px "+o;d.innerHTML=r+"<br/>"+r;document.body.appendChild(d);a.leading=1.2*s;var f=e(d,"height");f=f.replace("px","");if(f>=s*2){a.leading=f/2|0}document.body.removeChild(d);if(!c){var h=document.createElement("canvas");var p=100;h.width=a.width+p;h.height=3*s;h.style.opacity=1;h.style.fontFamily=o;h.style.fontSize=s;h.style.fontStyle=l;h.style.fontWeight=u;var m=h.getContext("2d");m.font=l+" "+u+" "+s+"px "+o;var v=h.width,g=h.height,_=g/2;m.fillStyle="white";m.fillRect(-1,-1,v+2,g+2);if(i){m.strokeStyle="black";m.lineWidth=t.lineWidth;m.strokeText(r,p/2,_)}if(n){m.fillStyle="black";m.fillText(r,p/2,_)}var y=m.getImageData(0,0,v,g).data;var b=0,w=v*4,C=y.length;while(++b<C&&y[b]===255){}var S=b/w|0;b=C-1;while(--b>0&&y[b]===255){}var T=b/w|0;for(b=0;b<C&&y[b]===255;){b+=w;if(b>=C){b=b-C+4}}var E=b%w/4|0;var x=1;for(b=C-3;b>=0&&y[b]===255;){b-=w;if(b<0){b=C-3-x++*4}}var P=b%w/4+1|0;a.ascent=_-S;a.descent=T-_;a.bounds={minx:E-p/2,maxx:P-p/2,miny:0,maxy:T-S};a.height=1+(T-S)}else{a.ascent=0;a.descent=0;a.bounds={minx:0,maxx:a.width,miny:0,maxy:0};a.height=0}return a};return t});define("Core/writeTextToCanvas",["../ThirdParty/measureText","./Color","./defaultValue","./defined","./DeveloperError"],function(e,t,r,i,n){"use strict";var a;function o(o,s){if(!i(o)){throw new n("text is required.")}if(o===""){return undefined}s=r(s,r.EMPTY_OBJECT);var l=r(s.font,"10px sans-serif");var u=r(s.stroke,false);var c=r(s.fill,true);var d=r(s.strokeWidth,1);var f=r(s.backgroundColor,t.TRANSPARENT);var h=r(s.padding,0);var p=h*2;var m=document.createElement("canvas");m.width=1;m.height=1;m.style.font=l;var v=m.getContext("2d");if(!i(a)){if(i(v.imageSmoothingEnabled)){a="imageSmoothingEnabled"}else if(i(v.mozImageSmoothingEnabled)){a="mozImageSmoothingEnabled"}else if(i(v.webkitImageSmoothingEnabled)){a="webkitImageSmoothingEnabled"}else if(i(v.msImageSmoothingEnabled)){a="msImageSmoothingEnabled"}}v.font=l;v.lineJoin="round";v.lineWidth=d;v[a]=false;v.textBaseline=r(s.textBaseline,"bottom");m.style.visibility="hidden";document.body.appendChild(m);var g=e(v,o,u,c);m.dimensions=g;document.body.removeChild(m);m.style.visibility="";var _=-g.bounds.minx;var y=Math.ceil(g.width)+_+p;var b=g.height+p;var w=b-g.ascent+p;var C=b-w+p;m.width=y;m.height=b;v.font=l;v.lineJoin="round";v.lineWidth=d;v[a]=false;if(f!==t.TRANSPARENT){v.fillStyle=f.toCssColorString();v.fillRect(0,0,m.width,m.height)}if(u){var S=r(s.strokeColor,t.BLACK);v.strokeStyle=S.toCssColorString();v.strokeText(o,_+h,C)}if(c){var T=r(s.fillColor,t.WHITE);v.fillStyle=T.toCssColorString();v.fillText(o,_+h,C)}return m}return o});define("Core/PinBuilder",["./buildModuleUrl","./Color","./defined","./DeveloperError","./loadImage","./writeTextToCanvas"],function(e,t,r,i,n,a){"use strict";function o(){this._cache={}}o.prototype.fromColor=function(e,t){if(!r(e)){throw new i("color is required")}if(!r(t)){throw new i("size is required")}return d(undefined,undefined,e,t,this._cache)};o.prototype.fromUrl=function(e,t,n){if(!r(e)){throw new i("url is required")}if(!r(t)){throw new i("color is required")}if(!r(n)){throw new i("size is required")}return d(e,undefined,t,n,this._cache)};o.prototype.fromMakiIconId=function(t,n,a){if(!r(t)){throw new i("id is required")}if(!r(n)){throw new i("color is required")}if(!r(a)){throw new i("size is required")}return d(e("Assets/Textures/maki/"+encodeURIComponent(t)+".png"),undefined,n,a,this._cache)};o.prototype.fromText=function(e,t,n){if(!r(e)){throw new i("text is required")}if(!r(t)){throw new i("color is required")}if(!r(n)){throw new i("size is required")}return d(undefined,e,t,n,this._cache)};var s=new t;function l(e,t,r){e.save();e.scale(r/24,r/24);e.fillStyle=t.toCssColorString();e.strokeStyle=t.brighten(.6,s).toCssColorString();e.lineWidth=.846;e.beginPath();e.moveTo(6.72,.422);e.lineTo(17.28,.422);e.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415);e.lineTo(19.577,10.973);e.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966);e.lineTo(14.386,14.008);e.lineTo(11.826,23.578);e.lineTo(9.614,14.008);e.lineTo(6.719,13.965);e.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972);e.lineTo(4.422,3.416);e.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423);e.closePath();e.fill();e.stroke();e.restore()}function u(e,r,i){var n=i/2.5;var a=n;var o=n;if(r.width>r.height){o=n*(r.height/r.width)}else if(r.width<r.height){a=n*(r.width/r.height)}var s=Math.round((i-a)/2);var l=Math.round(7/24*i-o/2);e.globalCompositeOperation="destination-out";e.drawImage(r,s-1,l,a,o);e.drawImage(r,s,l-1,a,o);e.drawImage(r,s+1,l,a,o);e.drawImage(r,s,l+1,a,o);e.globalCompositeOperation="destination-over";e.fillStyle=t.BLACK.toCssColorString();e.fillRect(s-1,l-1,a+2,o+2);e.globalCompositeOperation="destination-out";e.drawImage(r,s,l,a,o);e.globalCompositeOperation="destination-over";e.fillStyle=t.WHITE.toCssColorString();e.fillRect(s-1,l-2,a+2,o+2)}var c=new Array(4);function d(e,t,i,o,s){c[0]=e;c[1]=t;c[2]=i;c[3]=o;var d=JSON.stringify(c);var f=s[d];if(r(f)){return f}var h=document.createElement("canvas");h.width=o;h.height=o;var p=h.getContext("2d");l(p,i,o);if(r(e)){var m=n(e).then(function(e){u(p,e,o);s[d]=h;return h});s[d]=m;return m}else if(r(t)){var v=a(t,{font:"bold "+o+"px sans-serif"});u(p,v,o)}s[d]=h;return h}return o});define("Core/pointInsideTriangle",["./barycentricCoordinates","./Cartesian3"],function(e,t){"use strict";var r=new t;function i(t,i,n,a){e(t,i,n,a,r);return r.x>0&&r.y>0&&r.z>0}return i});define("Core/Queue",["./defineProperties"],function(e){"use strict";function t(){this._array=[];this._offset=0;this._length=0}e(t.prototype,{length:{get:function(){return this._length}}});t.prototype.enqueue=function(e){this._array.push(e);this._length++};t.prototype.dequeue=function(){if(this._length===0){return undefined}var e=this._array;var t=this._offset;var r=e[t];e[t]=undefined;t++;if(t>10&&t*2>e.length){this._array=e.slice(t);t=0}this._offset=t;this._length--;return r};t.prototype.peek=function(){if(this._length===0){return undefined}return this._array[this._offset]};t.prototype.contains=function(e){return this._array.indexOf(e)!==-1};t.prototype.clear=function(){this._array.length=this._offset=this._length=0};t.prototype.sort=function(e){if(this._offset>0){this._array=this._array.slice(this._offset);this._offset=0}this._array.sort(e)};return t});define("Core/PolygonGeometryLibrary",["./arrayRemoveDuplicates","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryPipeline","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Queue","./WindingOrder"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m){"use strict";var v={};v.computeHierarchyPackedLength=function(e){var r=0;var i=[e];while(i.length>0){var a=i.pop();if(!n(a)){continue}r+=2;var o=a.positions;var s=a.holes;if(n(o)){r+=o.length*t.packedLength}if(n(s)){var l=s.length;for(var u=0;u<l;++u){i.push(s[u])}}}return r};v.packPolygonHierarchy=function(e,r,i){var a=[e];while(a.length>0){var o=a.pop();if(!n(o)){continue}var s=o.positions;var l=o.holes;r[i++]=n(s)?s.length:0;r[i++]=n(l)?l.length:0;if(n(s)){var u=s.length;for(var c=0;c<u;++c,i+=3){t.pack(s[c],r,i)}}if(n(l)){var d=l.length;for(var f=0;f<d;++f){a.push(l[f])}}}return i};v.unpackPolygonHierarchy=function(e,r){var i=e[r++];var n=e[r++];var a=new Array(i);var o=n>0?new Array(n):undefined;for(var s=0;s<i;++s,r+=t.packedLength){a[s]=t.unpack(e,r)}for(var l=0;l<n;++l){o[l]=v.unpackPolygonHierarchy(e,r);r=o[l].startingIndex;delete o[l].startingIndex}return{positions:a,holes:o,startingIndex:r}};var g=new t;function _(e,r,i,n){t.subtract(r,e,g);t.multiplyByScalar(g,i/n,g);t.add(e,g,g);return[g.x,g.y,g.z]}v.subdivideLineCount=function(e,r,i){var n=t.distance(e,r);var a=n/i;var o=Math.max(0,Math.ceil(Math.log(a)/Math.log(2)));return Math.pow(2,o)};v.subdivideLine=function(e,r,i,a){var o=v.subdivideLineCount(e,r,i);var s=t.distance(e,r);var l=s/o;if(!n(a)){a=[]}var u=a;u.length=o*3;var c=0;for(var d=0;d<o;d++){var f=_(e,r,d*l,s);u[c++]=f[0];u[c++]=f[1];u[c++]=f[2]}return u};var y=new t;var b=new t;var w=new t;var C=new t;v.scaleToGeodeticHeightExtruded=function(e,r,o,s,l){s=i(s,a.WGS84);var u=y;var c=b;var d=w;var f=C;if(n(e)&&n(e.attributes)&&n(e.attributes.position)){var h=e.attributes.position.values;var p=h.length/2;for(var m=0;m<p;m+=3){t.fromArray(h,m,d);s.geodeticSurfaceNormal(d,u);f=s.scaleToGeodeticSurface(d,f);c=t.multiplyByScalar(u,o,c);c=t.add(f,c,c);h[m+p]=c.x;h[m+1+p]=c.y;h[m+2+p]=c.z;if(l){f=t.clone(d,f)}c=t.multiplyByScalar(u,r,c);c=t.add(f,c,c);h[m]=c.x;h[m+1]=c.y;h[m+2]=c.z}}return e};v.polygonsFromHierarchy=function(r,i,a,o){var s=[];var l=[];var u=new p;u.enqueue(r);while(u.length!==0){var c=u.dequeue();var d=c.positions;var h=c.holes;d=e(d,t.equalsEpsilon,true);if(d.length<3){continue}var v=a.projectPointsOntoPlane(d);var g=[];var _=f.computeWindingOrder2D(v);if(_===m.CLOCKWISE){v.reverse();d=d.slice().reverse()}var y=d.slice();var b=n(h)?h.length:0;var w=[];var C;var S;for(C=0;C<b;C++){var T=h[C];var E=e(T.positions,t.equalsEpsilon,true);if(E.length<3){continue}var x=a.projectPointsOntoPlane(E);_=f.computeWindingOrder2D(x);if(_===m.CLOCKWISE){x.reverse();E=E.slice().reverse()}w.push(E);g.push(y.length);y=y.concat(E);v=v.concat(x);var P=0;if(n(T.holes)){P=T.holes.length}for(S=0;S<P;S++){u.enqueue(T.holes[S])}}if(!i){for(C=0;C<d.length;C++){o.scaleToGeodeticSurface(d[C],d[C])}for(C=0;C<w.length;C++){var A=w[C];for(S=0;S<A.length;++S){o.scaleToGeodeticSurface(A[S],A[S])}}}s.push({outerRing:d,holes:w});l.push({positions:y,positions2D:v,holes:g})}return{hierarchy:s,polygons:l}};v.createGeometryFromPositions=function(e,t,i,n,a){var l=f.triangulate(t.positions2D,t.holes);if(l.length<3){l=[0,1,2]}var c=t.positions;if(n){var d=c.length;var p=new Array(d*3);var m=0;for(var v=0;v<d;v++){var g=c[v];p[m++]=g.x;p[m++]=g.y;p[m++]=g.z}var _=new o({attributes:{position:new s({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:p})},indices:l,primitiveType:h.TRIANGLES});if(a.normal){return u.computeNormal(_)}return _}return f.computeSubdivision(e,c,l,i)};var S=[];var T=new t;var E=new t;v.computeWallGeometry=function(e,i,n,a){var u;var f;var p;var m;var g;var _=e.length;var y=0;if(!a){var b=d.chordLength(n,i.maximumRadius);var w=0;for(p=0;p<_;p++){w+=v.subdivideLineCount(e[p],e[(p+1)%_],b)}f=(w+_)*3;u=new Array(f*2);for(p=0;p<_;p++){m=e[p];g=e[(p+1)%_];var C=v.subdivideLine(m,g,b,S);var x=C.length;for(var P=0;P<x;++P,++y){u[y]=C[P];u[y+f]=C[P]}u[y]=g.x;u[y+f]=g.x;++y;u[y]=g.y;u[y+f]=g.y;++y;u[y]=g.z;u[y+f]=g.z;++y}}else{f=_*3*2;u=new Array(f*2);for(p=0;p<_;p++){m=e[p];g=e[(p+1)%_];u[y]=u[y+f]=m.x;++y;u[y]=u[y+f]=m.y;++y;u[y]=u[y+f]=m.z;++y;u[y]=u[y+f]=g.x;++y;u[y]=u[y+f]=g.y;++y;u[y]=u[y+f]=g.z;++y}}_=u.length;var A=c.createTypedArray(_/3,_-e.length*6);var O=0;_/=6;for(p=0;p<_;p++){var D=p;var I=D+1;var M=D+_;var R=M+1;m=t.fromArray(u,D*3,T);g=t.fromArray(u,I*3,E);if(t.equalsEpsilon(m,g,d.EPSILON14)){continue}A[O++]=D;A[O++]=M;A[O++]=I;A[O++]=I;A[O++]=M;A[O++]=R}return new o({attributes:new l({position:new s({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:u})}),indices:A,primitiveType:h.TRIANGLES})};return v});define("Core/PolygonGeometry",["./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./Check","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./PolygonGeometryLibrary","./PolygonPipeline","./Quaternion","./Rectangle","./VertexFormat","./WindingOrder"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E){"use strict";var x=new r;var P=new i;var A=new C;var O=new y;function D(e,t,r,n){var a=C.fromAxisAngle(e._plane.normal,r,A);var o=y.fromQuaternion(a,O);var s=Number.POSITIVE_INFINITY;var u=Number.NEGATIVE_INFINITY;var c=Number.POSITIVE_INFINITY;var d=Number.NEGATIVE_INFINITY;var f=t.length;for(var h=0;h<f;++h){var p=i.clone(t[h],P);y.multiplyByVector(o,p,p);var m=e.projectPointOntoPlane(p,x);if(l(m)){s=Math.min(s,m.x);u=Math.max(u,m.x);c=Math.min(c,m.y);d=Math.max(d,m.y)}}n.x=s;n.y=c;n.width=u-s;n.height=d-c;return n}var I=new n;var M=new n;function R(e,t,r,i){var n=i.cartesianToCartographic(e,I);var a=n.height;var o=i.cartesianToCartographic(t,M);o.height=a;i.cartographicToCartesian(o,t);var s=i.cartesianToCartographic(r,M);s.height=a-100;i.cartographicToCartesian(s,r)}var L=new e;var N=new i;var k=new i;var F=new i;var B=new i;var U=new i;var V=new i;var z=new i;var q=new i;var G=new i;var H=new r;var j=new r;var W=new i;var Y=new C;var X=new y;function Q(e){var t=e.vertexFormat;var n=e.geometry;var a=e.shadowVolume;if(t.st||t.normal||t.tangent||t.bitangent||a){var s=e.boundingRectangle;var l=e.tangentPlane;var u=e.ellipsoid;var c=e.stRotation;var d=e.wall;var f=e.top||d;var h=e.bottom||d;var m=e.perPositionHeight;var v=H;v.x=s.x;v.y=s.y;var g=n.attributes.position.values;var b=g.length;var w=t.st?new Float32Array(2*(b/3)):undefined;var S;if(t.normal){if(m&&f&&!d){S=n.attributes.normal.values}else{S=new Float32Array(b)}}var T=t.tangent?new Float32Array(b):undefined;var E=t.bitangent?new Float32Array(b):undefined;var x=a?new Float32Array(b):undefined;var P=0;var A=0;var O=k;var D=F;var I=B;var M=true;var L=C.fromAxisAngle(l._plane.normal,c,Y);var Q=y.fromQuaternion(L,X);var Z=0;var K=0;if(f&&h){Z=b/2;K=b/3;b/=2}for(var J=0;J<b;J+=3){var $=i.fromArray(g,J,W);if(t.st){var ee=y.multiplyByVector(Q,$,N);ee=u.scaleToGeodeticSurface(ee,ee);var te=l.projectPointOntoPlane(ee,j);r.subtract(te,v,te);var re=_.clamp(te.x/s.width,0,1);var ie=_.clamp(te.y/s.height,0,1);if(h){w[P+K]=re;w[P+1+K]=ie}if(f){w[P]=re;w[P+1]=ie}P+=2}if(t.normal||t.tangent||t.bitangent||a){var ne=A+1;var ae=A+2;if(d){if(J+3<b){var oe=i.fromArray(g,J+3,U);if(M){var se=i.fromArray(g,J+b,V);if(m){R($,oe,se,u)}i.subtract(oe,$,oe);i.subtract(se,$,se);O=i.normalize(i.cross(se,oe,O),O);M=false}if(i.equalsEpsilon(oe,$,_.EPSILON10)){M=true}}if(t.tangent||t.bitangent){I=u.geodeticSurfaceNormal($,I);if(t.tangent){D=i.normalize(i.cross(I,O,D),D)}}}else{O=u.geodeticSurfaceNormal($,O);if(t.tangent||t.bitangent){if(m){z=i.fromArray(S,A,z);q=i.cross(i.UNIT_Z,z,q);q=i.normalize(y.multiplyByVector(Q,q,q),q);if(t.bitangent){G=i.normalize(i.cross(z,q,G),G)}}D=i.cross(i.UNIT_Z,O,D);D=i.normalize(y.multiplyByVector(Q,D,D),D);if(t.bitangent){I=i.normalize(i.cross(O,D,I),I)}}}if(t.normal){if(e.wall){S[A+Z]=O.x;S[ne+Z]=O.y;S[ae+Z]=O.z}else if(h){S[A+Z]=-O.x;S[ne+Z]=-O.y;S[ae+Z]=-O.z}if(f&&!m||d){S[A]=O.x;S[ne]=O.y;S[ae]=O.z}}if(a){if(d){O=u.geodeticSurfaceNormal($,O)}x[A+Z]=-O.x;x[ne+Z]=-O.y;x[ae+Z]=-O.z}if(t.tangent){if(e.wall){T[A+Z]=D.x;T[ne+Z]=D.y;T[ae+Z]=D.z}else if(h){T[A+Z]=-D.x;T[ne+Z]=-D.y;T[ae+Z]=-D.z}if(f){if(m){T[A]=q.x;T[ne]=q.y;T[ae]=q.z}else{T[A]=D.x;T[ne]=D.y;T[ae]=D.z}}}if(t.bitangent){if(h){E[A+Z]=I.x;E[ne+Z]=I.y;E[ae+Z]=I.z}if(f){if(m){E[A]=G.x;E[ne]=G.y;E[ae]=G.z}else{E[A]=I.x;E[ne]=I.y;E[ae]=I.z}}}A+=3}}if(t.st){n.attributes.st=new p({componentDatatype:o.FLOAT,componentsPerAttribute:2,values:w})}if(t.normal){n.attributes.normal=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:S})}if(t.tangent){n.attributes.tangent=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:T})}if(t.bitangent){n.attributes.bitangent=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:E})}if(a){n.attributes.extrudeDirection=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:x})}}return n}var Z=[];function K(e,t,r,i,n,a,o,s){var l={walls:[]};var u;if(a||o){var c=b.createGeometryFromPositions(e,t,r,n,s);var d=c.attributes.position.values;var h=c.indices;var p;var v;if(a&&o){var _=d.concat(d);p=_.length/3;v=g.createTypedArray(p,h.length*2);v.set(h);var y=h.length;var C=p/2;for(u=0;u<y;u+=3){var S=v[u]+C;var T=v[u+1]+C;var x=v[u+2]+C;v[u+y]=x;v[u+1+y]=T;v[u+2+y]=S}c.attributes.position.values=_;if(n){var P=c.attributes.normal.values;c.attributes.normal.values=new Float32Array(_.length);c.attributes.normal.values.set(P)}c.indices=v}else if(o){p=d.length/3;v=g.createTypedArray(p,h.length);for(u=0;u<h.length;u+=3){v[u]=h[u+2];v[u+1]=h[u+1];v[u+2]=h[u]}c.indices=v}l.topAndBottom=new m({geometry:c})}var A=i.outerRing;var O=f.fromPoints(A,e);var D=O.projectPointsOntoPlane(A,Z);var I=w.computeWindingOrder2D(D);if(I===E.CLOCKWISE){A=A.slice().reverse()}var M=b.computeWallGeometry(A,e,r,n);l.walls.push(new m({geometry:M}));var R=i.holes;for(u=0;u<R.length;u++){var L=R[u];O=f.fromPoints(L,e);D=O.projectPointsOntoPlane(L,Z);I=w.computeWindingOrder2D(D);if(I===E.COUNTER_CLOCKWISE){L=L.slice().reverse()}M=b.computeWallGeometry(L,e,r);l.walls.push(new m({geometry:M}))}return l}function J(e){a.typeOf.object("options",e);a.typeOf.object("options.polygonHierarchy",e.polygonHierarchy);if(l(e.perPositionHeight)&&e.perPositionHeight&&l(e.height)){throw new c("Cannot use both options.perPositionHeight and options.height")}var t=e.polygonHierarchy;var r=s(e.vertexFormat,T.DEFAULT);var i=s(e.ellipsoid,d.WGS84);var n=s(e.granularity,_.RADIANS_PER_DEGREE);var o=s(e.stRotation,0);var u=s(e.height,0);var f=s(e.perPositionHeight,false);var h=e.extrudedHeight;var p=l(h);if(!f&&p){if(_.equalsEpsilon(u,h,_.EPSILON10)){h=undefined;p=false}else{var m=h;h=Math.min(m,u);u=Math.max(m,u)}}this._vertexFormat=T.clone(r);this._ellipsoid=d.clone(i);this._granularity=n;this._stRotation=o;this._height=u;this._extrudedHeight=s(h,0);this._extrude=p;this._closeTop=s(e.closeTop,true);this._closeBottom=s(e.closeBottom,true);this._polygonHierarchy=t;this._perPositionHeight=f;this._shadowVolume=s(e.shadowVolume,false);this._workerName="createPolygonGeometry";var v=t.positions;if(!l(v)||v.length<3){this._rectangle=new S}else{this._rectangle=S.fromCartesianArray(v,i)}this.packedLength=b.computeHierarchyPackedLength(t)+d.packedLength+T.packedLength+S.packedLength+10}J.fromPositions=function(e){e=s(e,s.EMPTY_OBJECT);a.defined("options.positions",e.positions);var t={polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom};return new J(t)};J.pack=function(e,t,r){a.typeOf.object("value",e);a.defined("array",t);r=s(r,0);r=b.packPolygonHierarchy(e._polygonHierarchy,t,r);d.pack(e._ellipsoid,t,r);r+=d.packedLength;T.pack(e._vertexFormat,t,r);r+=T.packedLength;S.pack(e._rectangle,t,r);r+=S.packedLength;t[r++]=e._height;t[r++]=e._extrudedHeight;t[r++]=e._granularity;t[r++]=e._stRotation;t[r++]=e._extrude?1:0;t[r++]=e._perPositionHeight?1:0;t[r++]=e._closeTop?1:0;t[r++]=e._closeBottom?1:0;t[r++]=e._shadowVolume?1:0;t[r]=e.packedLength;return t};var $=d.clone(d.UNIT_SPHERE);var ee=new T;var te=new S;var re={polygonHierarchy:{}};J.unpack=function(e,t,r){a.defined("array",e);t=s(t,0);var i=b.unpackPolygonHierarchy(e,t);t=i.startingIndex;delete i.startingIndex;var n=d.unpack(e,t,$);t+=d.packedLength;var o=T.unpack(e,t,ee);t+=T.packedLength;var u=S.unpack(e,t,te);t+=S.packedLength;var c=e[t++];var f=e[t++];var h=e[t++];var p=e[t++];var m=e[t++]===1;var v=e[t++]===1;var g=e[t++]===1;var _=e[t++]===1;var y=e[t++]===1;var w=e[t];if(!l(r)){r=new J(re)}r._polygonHierarchy=i;r._ellipsoid=d.clone(n,r._ellipsoid);r._vertexFormat=T.clone(o,r._vertexFormat);r._height=c;r._extrudedHeight=f;r._granularity=h;r._stRotation=p;r._extrude=m;r._perPositionHeight=v;r._closeTop=g;r._closeBottom=_;r._rectangle=S.clone(u);r._shadowVolume=y;r.packedLength=w;return r};J.createGeometry=function(e){var r=e._vertexFormat;var i=e._ellipsoid;var n=e._granularity;var a=e._stRotation;var o=e._height;var s=e._extrudedHeight;var l=e._extrude;var u=e._polygonHierarchy;var c=e._perPositionHeight;var d=e._closeTop;var p=e._closeBottom;var _=u.positions;if(_.length<3){return}var y=f.fromPoints(_,i);var C=b.polygonsFromHierarchy(u,c,y,i);var S=C.hierarchy;var T=C.polygons;if(S.length===0){return}_=S[0].outerRing;var E=D(y,_,a,L);var x;var P=[];var A={perPositionHeight:c,vertexFormat:r,geometry:undefined,tangentPlane:y,boundingRectangle:E,ellipsoid:i,stRotation:a,bottom:false,top:true,wall:false};var O;if(l){A.top=d;A.bottom=p;A.shadowVolume=e._shadowVolume;for(O=0;O<T.length;O++){x=K(i,T[O],n,S[O],c,d,p,r);var I;if(d&&p){I=x.topAndBottom;A.geometry=b.scaleToGeodeticHeightExtruded(I.geometry,o,s,i,c)}else if(d){I=x.topAndBottom;I.geometry.attributes.position.values=w.scaleToGeodeticHeight(I.geometry.attributes.position.values,o,i,!c);A.geometry=I.geometry}else if(p){I=x.topAndBottom;I.geometry.attributes.position.values=w.scaleToGeodeticHeight(I.geometry.attributes.position.values,s,i,true);A.geometry=I.geometry}if(d||p){A.wall=false;I.geometry=Q(A);P.push(I)}var M=x.walls;A.wall=true;for(var R=0;R<M.length;R++){var N=M[R];A.geometry=b.scaleToGeodeticHeightExtruded(N.geometry,o,s,i,c);N.geometry=Q(A);P.push(N)}}}else{for(O=0;O<T.length;O++){x=new m({geometry:b.createGeometryFromPositions(i,T[O],n,c,r)});x.geometry.attributes.position.values=w.scaleToGeodeticHeight(x.geometry.attributes.position.values,o,i,!c);A.geometry=x.geometry;x.geometry=Q(A);P.push(x)}}x=v.combineInstances(P)[0];x.attributes.position.values=new Float64Array(x.attributes.position.values);x.indices=g.createTypedArray(x.attributes.position.values.length/3,x.indices);var k=x.attributes;var F=t.fromVertices(k.position.values);if(!r.position){delete k.position}return new h({attributes:k,indices:x.indices,primitiveType:x.primitiveType,boundingSphere:F})};J.createShadowVolume=function(e,t,r){var i=e._granularity;var n=e._ellipsoid;var a=t(i,n);var o=r(i,n);return new J({polygonHierarchy:e._polygonHierarchy,ellipsoid:n,stRotation:e._stRotation,granularity:i,perPositionHeight:false,extrudedHeight:a,height:o,vertexFormat:T.POSITION_ONLY,shadowVolume:true})};u(J.prototype,{rectangle:{get:function(){return this._rectangle}}});return J});define("Core/PolygonHierarchy",["./defined"],function(e){"use strict";function t(t,r){this.positions=e(t)?t:[];this.holes=e(r)?r:[]}return t});define("Core/PolygonOutlineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Check","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./PolygonGeometryLibrary","./PolygonPipeline","./PrimitiveType","./Queue","./WindingOrder"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w){"use strict";var C=[];var S=[];function T(e,t,r,i){var a=u.fromPoints(t,e);var o=a.projectPointsOntoPlane(t,C);var s=_.computeWindingOrder2D(o);if(s===w.CLOCKWISE){o.reverse();t=t.slice().reverse()}var l;var p;var v=t.length;var b=0;if(!i){var T=0;for(p=0;p<v;p++){T+=g.subdivideLineCount(t[p],t[(p+1)%v],r)}l=new Float64Array(T*3);for(p=0;p<v;p++){var E=g.subdivideLine(t[p],t[(p+1)%v],r,S);var x=E.length;for(var P=0;P<x;++P){l[b++]=E[P]}}}else{l=new Float64Array(v*2*3);for(p=0;p<v;p++){var A=t[p];var O=t[(p+1)%v];l[b++]=A.x;l[b++]=A.y;l[b++]=A.z;l[b++]=O.x;l[b++]=O.y;l[b++]=O.z}}v=l.length/3;var D=v*2;var I=m.createTypedArray(v,D);b=0;for(p=0;p<v-1;p++){I[b++]=p;I[b++]=p+1}I[b++]=v-1;I[b++]=0;return new h({geometry:new c({attributes:new f({position:new d({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:l})}),indices:I,primitiveType:y.LINES})})}function E(e,t,r,i){var a=u.fromPoints(t,e);var o=a.projectPointsOntoPlane(t,C);var s=_.computeWindingOrder2D(o);if(s===w.CLOCKWISE){o.reverse();t=t.slice().reverse()}var l;var p;var v=t.length;var b=new Array(v);var T=0;if(!i){var E=0;for(p=0;p<v;p++){E+=g.subdivideLineCount(t[p],t[(p+1)%v],r)}l=new Float64Array(E*3*2);for(p=0;p<v;++p){b[p]=T/3;var x=g.subdivideLine(t[p],t[(p+1)%v],r,S);var P=x.length;for(var A=0;A<P;++A){l[T++]=x[A]}}}else{l=new Float64Array(v*2*3*2);for(p=0;p<v;++p){b[p]=T/3;var O=t[p];var D=t[(p+1)%v];l[T++]=O.x;l[T++]=O.y;l[T++]=O.z;l[T++]=D.x;l[T++]=D.y;l[T++]=D.z}}v=l.length/(3*2);var I=b.length;var M=(v*2+I)*2;var R=m.createTypedArray(v,M);T=0;for(p=0;p<v;++p){R[T++]=p;R[T++]=(p+1)%v;R[T++]=p+v;R[T++]=(p+1)%v+v}for(p=0;p<I;p++){var L=b[p];R[T++]=L;R[T++]=L+v}return new h({geometry:new c({attributes:new f({position:new d({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:l})}),indices:R,primitiveType:y.LINES})})}function x(e){i.typeOf.object("options",e);i.typeOf.object("options.polygonHierarchy",e.polygonHierarchy);if(o(e.perPositionHeight)&&e.perPositionHeight&&o(e.height)){throw new s("Cannot use both options.perPositionHeight and options.height")}var t=e.polygonHierarchy;var r=a(e.ellipsoid,l.WGS84);var n=a(e.granularity,v.RADIANS_PER_DEGREE);var u=a(e.height,0);var c=a(e.perPositionHeight,false);var d=e.extrudedHeight;var f=o(d);if(f&&!c){var h=d;d=Math.min(h,u);u=Math.max(h,u)}this._ellipsoid=l.clone(r);this._granularity=n;this._height=u;this._extrudedHeight=a(d,0);this._extrude=f;this._polygonHierarchy=t;this._perPositionHeight=c;this._workerName="createPolygonOutlineGeometry";this.packedLength=g.computeHierarchyPackedLength(t)+l.packedLength+6}x.pack=function(e,t,r){i.typeOf.object("value",e);i.defined("array",t);r=a(r,0);r=g.packPolygonHierarchy(e._polygonHierarchy,t,r);l.pack(e._ellipsoid,t,r);r+=l.packedLength;t[r++]=e._height;t[r++]=e._extrudedHeight;t[r++]=e._granularity;t[r++]=e._extrude?1:0;t[r++]=e._perPositionHeight?1:0;t[r++]=e.packedLength;return t};var P=l.clone(l.UNIT_SPHERE);var A={polygonHierarchy:{}};x.unpack=function(e,t,r){i.defined("array",e);t=a(t,0);var n=g.unpackPolygonHierarchy(e,t);t=n.startingIndex;delete n.startingIndex;var s=l.unpack(e,t,P);t+=l.packedLength;var u=e[t++];var c=e[t++];var d=e[t++];var f=e[t++]===1;var h=e[t++]===1;var p=e[t++];if(!o(r)){r=new x(A)}r._polygonHierarchy=n;r._ellipsoid=l.clone(s,r._ellipsoid);r._height=u;r._extrudedHeight=c;r._granularity=d;r._extrude=f;r._perPositionHeight=h;r.packedLength=p;return r};x.fromPositions=function(e){e=a(e,a.EMPTY_OBJECT);i.defined("options.positions",e.positions);var t={polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight};return new x(t)};x.createGeometry=function(i){var n=i._ellipsoid;var a=i._granularity;var s=i._height;var l=i._extrudedHeight;var u=i._extrude;var d=i._polygonHierarchy;var f=i._perPositionHeight;var h=[];var m=new b;m.enqueue(d);var y;while(m.length!==0){var w=m.dequeue();var C=w.positions;C=e(C,r.equalsEpsilon,true);if(C.length<3){continue}var S=w.holes?w.holes.length:0;for(y=0;y<S;y++){var x=w.holes[y];x.positions=e(x.positions,r.equalsEpsilon,true);if(x.positions.length<3){continue}h.push(x.positions);var P=0;if(o(x.holes)){P=x.holes.length}for(var A=0;A<P;A++){m.enqueue(x.holes[A])}}h.push(C)}if(h.length===0){return undefined}var O;var D=[];var I=v.chordLength(a,n.maximumRadius);if(u){for(y=0;y<h.length;y++){O=E(n,h[y],I,f);O.geometry=g.scaleToGeodeticHeightExtruded(O.geometry,s,l,n,f);D.push(O)}}else{for(y=0;y<h.length;y++){O=T(n,h[y],I,f);O.geometry.attributes.position.values=_.scaleToGeodeticHeight(O.geometry.attributes.position.values,s,n,!f);D.push(O)}}O=p.combineInstances(D)[0];var M=t.fromVertices(O.attributes.position.values);return new c({attributes:O.attributes,indices:O.indices,primitiveType:O.primitiveType,boundingSphere:M})};return x});define("Core/PolylineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Color","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryType","./IndexDatatype","./Math","./PolylinePipeline","./PrimitiveType","./VertexFormat"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g){"use strict";var _=[];function y(e,t,r,n,a){var o=_;o.length=a;var s;var l=r.red;var u=r.green;var c=r.blue;var d=r.alpha;var f=n.red;var h=n.green;var p=n.blue;var m=n.alpha;if(i.equals(r,n)){for(s=0;s<a;s++){o[s]=i.clone(r)}return o}var v=(f-l)/a;var g=(h-u)/a;var y=(p-c)/a;var b=(m-d)/a;for(s=0;s<a;s++){o[s]=new i(l+s*v,u+s*g,c+s*y,d+s*b)}return o}function b(e){e=a(e,a.EMPTY_OBJECT);var t=e.positions;var n=e.colors;var u=a(e.width,1);var c=a(e.colorsPerVertex,false);if(!o(t)||t.length<2){throw new s("At least two positions are required.")}if(typeof u!=="number"){throw new s("width must be a number")}if(o(n)&&(c&&n.length<t.length||!c&&n.length<t.length-1)){throw new s("colors has an invalid length.")}this._positions=t;this._colors=n;this._width=u;this._colorsPerVertex=c;this._vertexFormat=g.clone(a(e.vertexFormat,g.DEFAULT));this._followSurface=a(e.followSurface,true);this._granularity=a(e.granularity,p.RADIANS_PER_DEGREE);this._ellipsoid=l.clone(a(e.ellipsoid,l.WGS84));this._workerName="createPolylineGeometry";var d=1+t.length*r.packedLength;d+=o(n)?1+n.length*i.packedLength:1;this.packedLength=d+l.packedLength+g.packedLength+4}b.pack=function(e,t,n){if(!o(e)){throw new s("value is required")}if(!o(t)){throw new s("array is required")}n=a(n,0);var u;var c=e._positions;var d=c.length;t[n++]=d;for(u=0;u<d;++u,n+=r.packedLength){r.pack(c[u],t,n)}var f=e._colors;d=o(f)?f.length:0;t[n++]=d;for(u=0;u<d;++u,n+=i.packedLength){i.pack(f[u],t,n)}l.pack(e._ellipsoid,t,n);n+=l.packedLength;g.pack(e._vertexFormat,t,n);n+=g.packedLength;t[n++]=e._width;t[n++]=e._colorsPerVertex?1:0;t[n++]=e._followSurface?1:0;t[n]=e._granularity;return t};var w=l.clone(l.UNIT_SPHERE);var C=new g;var S={positions:undefined,colors:undefined,ellipsoid:w,vertexFormat:C,width:undefined,colorsPerVertex:undefined,followSurface:undefined,granularity:undefined};b.unpack=function(e,t,n){if(!o(e)){throw new s("array is required")}t=a(t,0);var u;var c=e[t++];var d=new Array(c);for(u=0;u<c;++u,t+=r.packedLength){d[u]=r.unpack(e,t)}c=e[t++];var f=c>0?new Array(c):undefined;for(u=0;u<c;++u,t+=i.packedLength){f[u]=i.unpack(e,t)}var h=l.unpack(e,t,w);t+=l.packedLength;var p=g.unpack(e,t,C);t+=g.packedLength;var m=e[t++];var v=e[t++]===1;var _=e[t++]===1;var y=e[t];if(!o(n)){S.positions=d;S.colors=f;S.width=m;S.colorsPerVertex=v;S.followSurface=_;S.granularity=y;return new b(S)}n._positions=d;n._colors=f;n._ellipsoid=l.clone(h,n._ellipsoid);n._vertexFormat=g.clone(p,n._vertexFormat);n._width=m;n._colorsPerVertex=v;n._followSurface=_;n._granularity=y;return n};var T=new r;var E=new r;var x=new r;var P=new r;b.createGeometry=function(a){var s=a._width;var l=a._vertexFormat;var g=a._colors;var b=a._colorsPerVertex;var w=a._followSurface;var C=a._granularity;var S=a._ellipsoid;var A;var O;var D;var I=e(a._positions,r.equalsEpsilon);var M=I.length;if(M<2||s<=0){return undefined}if(w){var R=m.extractHeights(I,S);var L=p.chordLength(C,S.maximumRadius);if(o(g)){var N=1;for(A=0;A<M-1;++A){N+=m.numberOfPoints(I[A],I[A+1],L)}var k=new Array(N);var F=0;for(A=0;A<M-1;++A){var B=I[A];var U=I[A+1];var V=g[A];var z=m.numberOfPoints(B,U,L);if(b&&A<N){var q=g[A+1];var G=y(B,U,V,q,z);var H=G.length;for(O=0;O<H;++O){k[F++]=G[O]}}else{for(O=0;O<z;++O){k[F++]=i.clone(V)}}}k[F]=i.clone(g[g.length-1]);g=k;_.length=0}I=m.generateCartesianArc({positions:I,minDistance:L,ellipsoid:S,height:R})}M=I.length;var j=M*4-4;var W=new Float64Array(j*3);var Y=new Float64Array(j*3);var X=new Float64Array(j*3);var Q=new Float32Array(j*2);var Z=l.st?new Float32Array(j*2):undefined;var K=o(g)?new Uint8Array(j*4):undefined;var J=0;var $=0;var ee=0;var te=0;var re;for(O=0;O<M;++O){if(O===0){re=T;r.subtract(I[0],I[1],re);r.add(I[0],re,re)}else{re=I[O-1]}r.clone(re,x);r.clone(I[O],E);if(O===M-1){re=T;r.subtract(I[M-1],I[M-2],re);r.add(I[M-1],re,re)}else{re=I[O+1]}r.clone(re,P);var ie,ne;if(o(K)){if(O!==0&&!b){ie=g[O-1]}else{ie=g[O]}if(O!==M-1){ne=g[O]}}var ae=O===0?2:0;var oe=O===M-1?2:4;for(D=ae;D<oe;++D){r.pack(E,W,J);r.pack(x,Y,J);r.pack(P,X,J);J+=3;var se=D-2<0?-1:1;Q[$++]=2*(D%2)-1;Q[$++]=se*s;if(l.st){Z[ee++]=O/(M-1);Z[ee++]=Math.max(Q[$-2],0)}if(o(K)){var le=D<2?ie:ne;K[te++]=i.floatToByte(le.red);K[te++]=i.floatToByte(le.green);K[te++]=i.floatToByte(le.blue);K[te++]=i.floatToByte(le.alpha)}}}var ue=new d;ue.position=new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:W});ue.prevPosition=new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:Y});ue.nextPosition=new c({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:X});ue.expandAndWidth=new c({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:Q});if(l.st){ue.st=new c({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:Z})}if(o(K)){ue.color=new c({componentDatatype:n.UNSIGNED_BYTE,componentsPerAttribute:4,values:K,normalize:true})}var ce=h.createTypedArray(j,M*6-6);var de=0;var fe=0;var he=M-1;for(O=0;O<he;++O){ce[fe++]=de;ce[fe++]=de+2;ce[fe++]=de+1;ce[fe++]=de+1;ce[fe++]=de+2;ce[fe++]=de+3;de+=4}return new u({attributes:ue,indices:ce,primitiveType:v.TRIANGLES,boundingSphere:t.fromPoints(I),geometryType:f.POLYLINES})};return b});define("Core/PolylineVolumeGeometry",["./arrayRemoveDuplicates","./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CornerType","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryPipeline","./IndexDatatype","./Math","./oneTimeWarning","./PolygonPipeline","./PolylineVolumeGeometryLibrary","./PrimitiveType","./VertexFormat","./WindingOrder"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C){"use strict";function S(e,t,i,n){var o=new h;if(n.position){o.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:e})}var s=t.length;var l=e.length/3;var u=(l-s*2)/(s*2);var c=_.triangulate(t);var v=(u-1)*s*6+c.length*2;var y=m.createTypedArray(l,v);var w,C;var S,T,E,x;var P=s*2;var A=0;for(w=0;w<u-1;w++){for(C=0;C<s-1;C++){S=C*2+w*s*2;x=S+P;T=S+1;E=T+P;y[A++]=T;y[A++]=S;y[A++]=E;y[A++]=E;y[A++]=S;y[A++]=x}S=s*2-2+w*s*2;T=S+1;E=T+P;x=S+P;y[A++]=T;y[A++]=S;y[A++]=E;y[A++]=E;y[A++]=S;y[A++]=x}if(n.st||n.tangent||n.bitangent){var O=new Float32Array(l*2);var D=1/(u-1);var I=1/i.height;var M=i.height/2;var R,L;var N=0;for(w=0;w<u;w++){R=w*D;L=I*(t[0].y+M);O[N++]=R;O[N++]=L;for(C=1;C<s;C++){L=I*(t[C].y+M);O[N++]=R;O[N++]=L;O[N++]=R;O[N++]=L}L=I*(t[0].y+M);O[N++]=R;O[N++]=L}for(C=0;C<s;C++){R=0;L=I*(t[C].y+M);O[N++]=R;O[N++]=L}for(C=0;C<s;C++){R=(u-1)*D;L=I*(t[C].y+M);O[N++]=R;O[N++]=L}o.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:new Float32Array(O)})}var k=l-s*2;for(w=0;w<c.length;w+=3){var F=c[w]+k;var B=c[w+1]+k;var U=c[w+2]+k;y[A++]=F;y[A++]=B;y[A++]=U;y[A++]=U+s;y[A++]=B+s;y[A++]=F+s}var V=new d({attributes:o,indices:y,boundingSphere:r.fromVertices(e),primitiveType:b.TRIANGLES});if(n.normal){V=p.computeNormal(V)}if(n.tangent||n.bitangent){try{V=p.computeTangentAndBitangent(V)}catch(e){g("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}if(!n.tangent){V.attributes.tangent=undefined}if(!n.bitangent){V.attributes.bitangent=undefined}if(!n.st){V.attributes.st=undefined}}return V}function T(e){e=s(e,s.EMPTY_OBJECT);var t=e.polylinePositions;var r=e.shapePositions;if(!l(t)){throw new u("options.polylinePositions is required.")}if(!l(r)){throw new u("options.shapePositions is required.")}this._positions=t;this._shape=r;this._ellipsoid=c.clone(s(e.ellipsoid,c.WGS84));this._cornerType=s(e.cornerType,o.ROUNDED);this._vertexFormat=w.clone(s(e.vertexFormat,w.DEFAULT));this._granularity=s(e.granularity,v.RADIANS_PER_DEGREE);this._workerName="createPolylineVolumeGeometry";var a=1+t.length*n.packedLength;a+=1+r.length*i.packedLength;this.packedLength=a+c.packedLength+w.packedLength+2}T.pack=function(e,t,r){if(!l(e)){throw new u("value is required")}if(!l(t)){throw new u("array is required")}r=s(r,0);var a;var o=e._positions;var d=o.length;t[r++]=d;for(a=0;a<d;++a,r+=n.packedLength){n.pack(o[a],t,r)}var f=e._shape;d=f.length;t[r++]=d;for(a=0;a<d;++a,r+=i.packedLength){i.pack(f[a],t,r)}c.pack(e._ellipsoid,t,r);r+=c.packedLength;w.pack(e._vertexFormat,t,r);r+=w.packedLength;t[r++]=e._cornerType;t[r]=e._granularity;return t};var E=c.clone(c.UNIT_SPHERE);var x=new w;var P={polylinePositions:undefined,shapePositions:undefined,ellipsoid:E,vertexFormat:x,cornerType:undefined,granularity:undefined};T.unpack=function(e,t,r){if(!l(e)){throw new u("array is required")}t=s(t,0);var a;var o=e[t++];var d=new Array(o);for(a=0;a<o;++a,t+=n.packedLength){d[a]=n.unpack(e,t)}o=e[t++];var f=new Array(o);for(a=0;a<o;++a,t+=i.packedLength){f[a]=i.unpack(e,t)}var h=c.unpack(e,t,E);t+=c.packedLength;var p=w.unpack(e,t,x);t+=w.packedLength;var m=e[t++];var v=e[t];if(!l(r)){P.polylinePositions=d;P.shapePositions=f;P.cornerType=m;P.granularity=v;return new T(P)}r._positions=d;r._shape=f;r._ellipsoid=c.clone(h,r._ellipsoid);r._vertexFormat=w.clone(p,r._vertexFormat);r._cornerType=m;r._granularity=v;return r};var A=new t;T.createGeometry=function(r){var i=r._positions;var a=e(i,n.equalsEpsilon);var o=r._shape;o=y.removeDuplicatesFromShape(o);if(a.length<2||o.length<3){return undefined}if(_.computeWindingOrder2D(o)===C.CLOCKWISE){o.reverse()}var s=t.fromPoints(o,A);var l=y.computePositions(a,o,s,r,true);return S(l,o,s,r._vertexFormat)};return T});define("Core/PolylineVolumeOutlineGeometry",["./arrayRemoveDuplicates","./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CornerType","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PolylineVolumeGeometryLibrary","./PrimitiveType","./WindingOrder"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y){"use strict";function b(e,t){var i=new h;i.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:e});var n=t.length;var o=i.position.values.length/3;var s=e.length/3;var l=s/n;var u=p.createTypedArray(o,2*n*(l+1));var c,m;var v=0;c=0;var g=c*n;for(m=0;m<n-1;m++){u[v++]=m+g;u[v++]=m+g+1}u[v++]=n-1+g;u[v++]=g;c=l-1;g=c*n;for(m=0;m<n-1;m++){u[v++]=m+g;u[v++]=m+g+1}u[v++]=n-1+g;u[v++]=g;for(c=0;c<l-1;c++){var y=n*c;var b=y+n;for(m=0;m<n;m++){u[v++]=m+y;u[v++]=m+b}}var w=new d({attributes:i,indices:p.createTypedArray(o,u),boundingSphere:r.fromVertices(e),primitiveType:_.LINES});return w}function w(e){e=s(e,s.EMPTY_OBJECT);var t=e.polylinePositions;var r=e.shapePositions;if(!l(t)){throw new u("options.polylinePositions is required.")}if(!l(r)){throw new u("options.shapePositions is required.")}this._positions=t;this._shape=r;this._ellipsoid=c.clone(s(e.ellipsoid,c.WGS84));this._cornerType=s(e.cornerType,o.ROUNDED);this._granularity=s(e.granularity,m.RADIANS_PER_DEGREE);this._workerName="createPolylineVolumeOutlineGeometry";var a=1+t.length*n.packedLength;a+=1+r.length*i.packedLength;this.packedLength=a+c.packedLength+2}w.pack=function(e,t,r){if(!l(e)){throw new u("value is required")}if(!l(t)){throw new u("array is required")}r=s(r,0);var a;var o=e._positions;var d=o.length;t[r++]=d;for(a=0;a<d;++a,r+=n.packedLength){n.pack(o[a],t,r)}var f=e._shape;d=f.length;t[r++]=d;for(a=0;a<d;++a,r+=i.packedLength){i.pack(f[a],t,r)}c.pack(e._ellipsoid,t,r);r+=c.packedLength;t[r++]=e._cornerType;t[r]=e._granularity;return t};var C=c.clone(c.UNIT_SPHERE);var S={polylinePositions:undefined,shapePositions:undefined,ellipsoid:C,height:undefined,cornerType:undefined,granularity:undefined};w.unpack=function(e,t,r){if(!l(e)){throw new u("array is required")}t=s(t,0);var a;var o=e[t++];var d=new Array(o);for(a=0;a<o;++a,t+=n.packedLength){d[a]=n.unpack(e,t)}o=e[t++];var f=new Array(o);for(a=0;a<o;++a,t+=i.packedLength){f[a]=i.unpack(e,t)}var h=c.unpack(e,t,C);t+=c.packedLength;var p=e[t++];var m=e[t];if(!l(r)){S.polylinePositions=d;S.shapePositions=f;S.cornerType=p;S.granularity=m;return new w(S)}r._positions=d;r._shape=f;r._ellipsoid=c.clone(h,r._ellipsoid);r._cornerType=p;r._granularity=m;return r};var T=new t;w.createGeometry=function(r){var i=r._positions;var a=e(i,n.equalsEpsilon);var o=r._shape;o=g.removeDuplicatesFromShape(o);if(a.length<2||o.length<3){return undefined}if(v.computeWindingOrder2D(o)===y.CLOCKWISE){o.reverse()}var s=t.fromPoints(o,T);var l=g.computePositions(a,o,s,r,false);return b(l,o)};return w});define("Core/QuaternionSpline",["./defaultValue","./defined","./defineProperties","./DeveloperError","./Quaternion","./Spline"],function(e,t,r,i,n,a){"use strict";function o(e,r,i){var a=e.length;var o=new Array(a);o[0]=t(r)?r:e[0];o[a-1]=t(i)?i:e[a-1];for(var s=1;s<a-1;++s){o[s]=n.computeInnerQuadrangle(e[s-1],e[s],e[s+1],new n)}return o}function s(e){var r=e.points;var i=e.innerQuadrangles;var a=e.times;if(r.length<3){var o=a[0];var s=1/(a[1]-o);var l=r[0];var u=r[1];return function(e,r){if(!t(r)){r=new n}var i=(e-o)*s;return n.fastSlerp(l,u,i,r)}}return function(o,s){if(!t(s)){s=new n}var l=e._lastTimeIndex=e.findTimeInterval(o,e._lastTimeIndex);var u=(o-a[l])/(a[l+1]-a[l]);var c=r[l];var d=r[l+1];var f=i[l];var h=i[l+1];return n.fastSquad(c,d,f,h,u,s)}}function l(r){r=e(r,e.EMPTY_OBJECT);var n=r.points;var a=r.times;var l=r.firstInnerQuadrangle;var u=r.lastInnerQuadrangle;if(!t(n)||!t(a)){throw new i("points and times are required.")}if(n.length<2){throw new i("points.length must be greater than or equal to 2.")}if(a.length!==n.length){throw new i("times.length must be equal to points.length.")}var c=o(n,l,u);this._times=a;this._points=n;this._innerQuadrangles=c;this._evaluateFunction=s(this);this._lastTimeIndex=0}r(l.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},innerQuadrangles:{get:function(){return this._innerQuadrangles}}});l.prototype.findTimeInterval=a.prototype.findTimeInterval;l.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};return l});define("Core/RectangleGeometryLibrary",["./Cartesian3","./Cartographic","./defined","./DeveloperError","./GeographicProjection","./Math","./Matrix2","./Rectangle"],function(e,t,r,i,n,a,o,s){"use strict";var l=Math.cos;var u=Math.sin;var c=Math.sqrt;var d={};d.computePosition=function(e,t,i,n,a){var o=e.ellipsoid.radiiSquared;var s=e.nwCorner;var d=e.rectangle;var f=s.latitude-e.granYCos*t+i*e.granXSin;var h=l(f);var p=u(f);var m=o.z*p;var v=s.longitude+t*e.granYSin+i*e.granXCos;var g=h*l(v);var _=h*u(v);var y=o.x*g;var b=o.y*_;var w=c(y*g+b*_+m*p);n.x=y/w;n.y=b/w;n.z=m/w;if(r(e.vertexFormat)&&e.vertexFormat.st){var C=e.stNwCorner;if(r(C)){f=C.latitude-e.stGranYCos*t+i*e.stGranXSin;v=C.longitude+t*e.stGranYSin+i*e.stGranXCos;a.x=(v-e.stWest)*e.lonScalar;a.y=(f-e.stSouth)*e.latScalar}else{a.x=(v-d.west)*e.lonScalar;a.y=(f-d.south)*e.latScalar}}};var f=new o;var h=new e;var p=new t;var m=new e;var v=new n;function g(t,r,i,n,a,s,l){var u=Math.cos(r);var c=n*u;var d=i*u;var p=Math.sin(r);var g=n*p;var _=i*p;h=v.project(t,h);h=e.subtract(h,m,h);var y=o.fromRotation(r,f);h=o.multiplyByVector(y,h,h);h=e.add(h,m,h);t=v.unproject(h,t);s-=1;l-=1;var b=t.latitude;var w=b+s*_;var C=b-c*l;var S=b-c*l+s*_;var T=Math.max(b,w,C,S);var E=Math.min(b,w,C,S);var x=t.longitude;var P=x+s*d;var A=x+l*g;var O=x+l*g+s*d;var D=Math.max(x,P,A,O);var I=Math.min(x,P,A,O);return{north:T,south:E,east:D,west:I,granYCos:c,granYSin:g,granXCos:d,granXSin:_,nwCorner:t}}d.computeOptions=function(e,t,r,n){var o=e._granularity;var l=e._ellipsoid;var u=e._surfaceHeight;var c=e._rotation;var d=e._stRotation;var f=e._extrudedHeight;var h=t.east;var _=t.west;var y=t.north;var b=t.south;var w;var C;var S;var T;var E;var x=y-b;if(_>h){E=a.TWO_PI-_+h;w=Math.ceil(E/o)+1;C=Math.ceil(x/o)+1;S=E/(w-1);T=x/(C-1)}else{E=h-_;w=Math.ceil(E/o)+1;C=Math.ceil(x/o)+1;S=E/(w-1);T=x/(C-1)}r=s.northwest(t,r);var P=s.center(t,p);if(c!==0||d!==0){if(P.longitude<r.longitude){P.longitude+=a.TWO_PI}m=v.project(P,m)}var A=T;var O=S;var D=0;var I=0;var M={granYCos:A,granYSin:D,granXCos:O,granXSin:I,ellipsoid:l,surfaceHeight:u,extrudedHeight:f,nwCorner:r,rectangle:t,width:w,height:C};if(c!==0){var R=g(r,c,S,T,P,w,C);y=R.north;b=R.south;h=R.east;_=R.west;if(y<-a.PI_OVER_TWO||y>a.PI_OVER_TWO||b<-a.PI_OVER_TWO||b>a.PI_OVER_TWO){throw new i("Rotated rectangle is invalid.  It crosses over either the north or south pole.")}M.granYCos=R.granYCos;M.granYSin=R.granYSin;M.granXCos=R.granXCos;M.granXSin=R.granXSin;t.north=y;t.south=b;t.east=h;t.west=_}if(d!==0){c=c-d;n=s.northwest(t,n);var L=g(n,c,S,T,P,w,C);M.stGranYCos=L.granYCos;M.stGranXCos=L.granXCos;M.stGranYSin=L.granYSin;M.stGranXSin=L.granXSin;M.stNwCorner=n;M.stWest=L.west;M.stSouth=L.south}return M};return d});define("Core/RectangleGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./Check","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./PolygonPipeline","./PrimitiveType","./Quaternion","./Rectangle","./RectangleGeometryLibrary","./VertexFormat"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T){"use strict";var E=new r;var x=new r;var P=new r;var A=new r;var O=new C;var D=new t;var I=new e;var M=new e;function R(e,t){var r=new d({attributes:new h,primitiveType:b.TRIANGLES});r.attributes.position=new f({componentDatatype:a.DOUBLE,componentsPerAttribute:3,values:t.positions});if(e.normal){r.attributes.normal=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:t.normals})}if(e.tangent){r.attributes.tangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:t.tangents})}if(e.bitangent){r.attributes.bitangent=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:t.bitangents})}return r}function L(e,t,i,n){var a=e.length;var o=t.normal?new Float32Array(a):undefined;var s=t.tangent?new Float32Array(a):undefined;var l=t.bitangent?new Float32Array(a):undefined;var u=0;var c=A;var d=P;var f=x;if(t.normal||t.tangent||t.bitangent){for(var h=0;h<a;h+=3){var p=r.fromArray(e,h,E);var m=u+1;var v=u+2;f=i.geodeticSurfaceNormal(p,f);if(t.tangent||t.bitangent){r.cross(r.UNIT_Z,f,d);_.multiplyByVector(n,d,d);r.normalize(d,d);if(t.bitangent){r.normalize(r.cross(f,d,c),c)}}if(t.normal){o[u]=f.x;o[m]=f.y;o[v]=f.z}if(t.tangent){s[u]=d.x;s[m]=d.y;s[v]=d.z}if(t.bitangent){l[u]=c.x;l[m]=c.y;l[v]=c.z}u+=3}}return R(t,{positions:e,normals:o,tangents:s,bitangents:l})}var N=new r;var k=new r;function F(e,t,i){var n=e.length;var a=t.normal?new Float32Array(n):undefined;var o=t.tangent?new Float32Array(n):undefined;var s=t.bitangent?new Float32Array(n):undefined;var l=0;var u=0;var c=0;var d=true;var f=A;var h=P;var p=x;if(t.normal||t.tangent||t.bitangent){for(var m=0;m<n;m+=6){var v=r.fromArray(e,m,E);var _=r.fromArray(e,(m+6)%n,N);if(d){var y=r.fromArray(e,(m+3)%n,k);r.subtract(_,v,_);r.subtract(y,v,y);p=r.normalize(r.cross(y,_,p),p);d=false}if(r.equalsEpsilon(_,v,g.EPSILON10)){d=true}if(t.tangent||t.bitangent){f=i.geodeticSurfaceNormal(v,f);if(t.tangent){h=r.normalize(r.cross(f,p,h),h)}}if(t.normal){a[l++]=p.x;a[l++]=p.y;a[l++]=p.z;a[l++]=p.x;a[l++]=p.y;a[l++]=p.z}if(t.tangent){o[u++]=h.x;o[u++]=h.y;o[u++]=h.z;o[u++]=h.x;o[u++]=h.y;o[u++]=h.z}if(t.bitangent){s[c++]=f.x;s[c++]=f.y;s[c++]=f.z;s[c++]=f.x;s[c++]=f.y;s[c++]=f.z}}}return R(t,{positions:e,normals:a,tangents:o,bitangents:s})}function B(e){var t=e.vertexFormat;var r=e.ellipsoid;var i=e.size;var n=e.height;var o=e.width;var s=t.position?new Float64Array(i*3):undefined;var l=t.st?new Float32Array(i*2):undefined;var u=0;var c=0;var d=E;var h=D;var p=Number.MAX_VALUE;var m=Number.MAX_VALUE;var g=-Number.MAX_VALUE;var _=-Number.MAX_VALUE;for(var y=0;y<n;++y){for(var b=0;b<o;++b){S.computePosition(e,y,b,d,h);s[u++]=d.x;s[u++]=d.y;s[u++]=d.z;if(t.st){l[c++]=h.x;l[c++]=h.y;p=Math.min(p,h.x);m=Math.min(m,h.y);g=Math.max(g,h.x);_=Math.max(_,h.y)}}}if(t.st&&(p<0||m<0||g>1||_>1)){for(var w=0;w<l.length;w+=2){l[w]=(l[w]-p)/(g-p);l[w+1]=(l[w+1]-m)/(_-m)}}var C=L(s,t,r,e.tangentRotationMatrix);var T=6*(o-1)*(n-1);var x=v.createTypedArray(i,T);var P=0;var A=0;for(var O=0;O<n-1;++O){for(var I=0;I<o-1;++I){var M=P;var R=M+o;var N=R+1;var k=M+1;x[A++]=M;x[A++]=R;x[A++]=k;x[A++]=k;x[A++]=R;x[A++]=N;++P}++P}C.indices=x;if(t.st){C.attributes.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:l})}return C}function U(e,t,r,i,n){e[t++]=i[r];e[t++]=i[r+1];e[t++]=i[r+2];e[t++]=n[r];e[t++]=n[r+1];e[t++]=n[r+2];return e}function V(e,t,r,i){e[t++]=i[r];e[t++]=i[r+1];e[t++]=i[r];e[t++]=i[r+1];return e}var z=new T;function q(e){var t=e.shadowVolume;var i=e.vertexFormat;var n=e.surfaceHeight;var o=e.extrudedHeight;var s=Math.min(o,n);var l=Math.max(o,n);var u=e.height;var c=e.width;var d=e.ellipsoid;var h;if(t){e.vertexFormat=T.clone(i,z);e.vertexFormat.normal=true}var _=B(e);if(g.equalsEpsilon(s,l,g.EPSILON10)){return _}var b=y.scaleToGeodeticHeight(_.attributes.position.values,l,d,false);b=new Float64Array(b);var w=b.length;var C=w*2;var S=new Float64Array(C);S.set(b);var E=y.scaleToGeodeticHeight(_.attributes.position.values,s,d);S.set(E,w);_.attributes.position.values=S;var x=i.normal?new Float32Array(C):undefined;var P=i.tangent?new Float32Array(C):undefined;var A=i.bitangent?new Float32Array(C):undefined;var O=i.st?new Float32Array(C/3*2):undefined;var D;var I;if(i.normal){I=_.attributes.normal.values;x.set(I);for(h=0;h<w;h++){I[h]=-I[h]}x.set(I,w);_.attributes.normal.values=x}if(t){I=_.attributes.normal.values;if(!i.normal){_.attributes.normal=undefined}var M=new Float32Array(C);for(h=0;h<w;h++){I[h]=-I[h]}M.set(I,w);_.attributes.extrudeDirection=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:M})}if(i.tangent){var R=_.attributes.tangent.values;P.set(R);for(h=0;h<w;h++){R[h]=-R[h]}P.set(R,w);_.attributes.tangent.values=P}if(i.bitangent){var L=_.attributes.bitangent.values;A.set(L);A.set(L,w);_.attributes.bitangent.values=A}if(i.st){D=_.attributes.st.values;O.set(D);O.set(D,w/3*2);_.attributes.st.values=O}var q=_.indices;var G=q.length;var H=w/3;var j=v.createTypedArray(C/3,G*2);j.set(q);for(h=0;h<G;h+=3){j[h+G]=q[h+2]+H;j[h+1+G]=q[h+1]+H;j[h+2+G]=q[h]+H}_.indices=j;var W=2*c+2*u-4;var Y=(W+4)*2;var X=new Float64Array(Y*3);var Q=t?new Float32Array(Y*3):undefined;var Z=i.st?new Float32Array(Y*2):undefined;var K=0;var J=0;var $=0;var ee=c*u;var te;for(h=0;h<ee;h+=c){te=h*3;X=U(X,K,te,b,E);K+=6;if(i.st){Z=V(Z,J,h*2,D);J+=4}if(t){$+=3;Q[$++]=I[te];Q[$++]=I[te+1];Q[$++]=I[te+2]}}for(h=ee-c;h<ee;h++){te=h*3;X=U(X,K,te,b,E);K+=6;if(i.st){Z=V(Z,J,h*2,D);J+=4}if(t){$+=3;Q[$++]=I[te];Q[$++]=I[te+1];Q[$++]=I[te+2]}}for(h=ee-1;h>0;h-=c){te=h*3;X=U(X,K,te,b,E);K+=6;if(i.st){Z=V(Z,J,h*2,D);J+=4}if(t){$+=3;Q[$++]=I[te];Q[$++]=I[te+1];Q[$++]=I[te+2]}}for(h=c-1;h>=0;h--){te=h*3;X=U(X,K,te,b,E);K+=6;if(i.st){Z=V(Z,J,h*2,D);J+=4}if(t){$+=3;Q[$++]=I[te];Q[$++]=I[te+1];Q[$++]=I[te+2]}}var re=F(X,i,d);if(i.st){re.attributes.st=new f({componentDatatype:a.FLOAT,componentsPerAttribute:2,values:Z})}if(t){re.attributes.extrudeDirection=new f({componentDatatype:a.FLOAT,componentsPerAttribute:3,values:Q})}var ie=v.createTypedArray(Y,W*6);var ne;var ae;var oe;var se;w=X.length/3;var le=0;for(h=0;h<w-1;h+=2){ne=h;se=(ne+2)%w;var ue=r.fromArray(X,ne*3,N);var ce=r.fromArray(X,se*3,k);if(r.equalsEpsilon(ue,ce,g.EPSILON10)){continue}ae=(ne+1)%w;oe=(ae+2)%w;ie[le++]=ne;ie[le++]=ae;ie[le++]=se;ie[le++]=se;ie[le++]=ae;ie[le++]=oe}re.indices=ie;re=m.combineInstances([new p({geometry:_}),new p({geometry:re})]);return re[0]}var G=new _;var H=new r;var j=new w;var W=[new r,new r,new r,new r];var Y=[new i,new i,new i,new i];function X(e,t,r){if(r===0){return C.clone(e)}C.northeast(e,Y[0]);C.northwest(e,Y[1]);C.southeast(e,Y[2]);C.southwest(e,Y[3]);t.cartographicArrayToCartesianArray(Y,W);var i=t.geodeticSurfaceNormalCartographic(C.center(e,H));w.fromAxisAngle(i,r,j);_.fromQuaternion(j,G);for(var n=0;n<4;++n){_.multiplyByVector(G,W[n],W[n])}t.cartesianArrayToCartographicArray(W,Y);return C.fromCartographicArray(Y)}function Q(e){e=o(e,o.EMPTY_OBJECT);var t=e.rectangle;n.typeOf.object("rectangle",t);C.validate(t);if(t.north<t.south){throw new u("options.rectangle.north must be greater than or equal to options.rectangle.south")}var r=o(e.rotation,0);this._rectangle=t;this._granularity=o(e.granularity,g.RADIANS_PER_DEGREE);this._ellipsoid=c.clone(o(e.ellipsoid,c.WGS84));this._surfaceHeight=o(e.height,0);this._rotation=r;this._stRotation=o(e.stRotation,0);this._vertexFormat=T.clone(o(e.vertexFormat,T.DEFAULT));this._extrudedHeight=o(e.extrudedHeight,0);this._extrude=s(e.extrudedHeight);this._closeTop=o(e.closeTop,true);this._closeBottom=o(e.closeBottom,true);this._shadowVolume=o(e.shadowVolume,false);this._workerName="createRectangleGeometry";this._rotatedRectangle=X(this._rectangle,this._ellipsoid,r)}Q.packedLength=C.packedLength+c.packedLength+T.packedLength+C.packedLength+9;Q.pack=function(e,t,r){n.typeOf.object("value",e);n.defined("array",t);r=o(r,0);C.pack(e._rectangle,t,r);r+=C.packedLength;c.pack(e._ellipsoid,t,r);r+=c.packedLength;T.pack(e._vertexFormat,t,r);r+=T.packedLength;C.pack(e._rotatedRectangle,t,r);r+=C.packedLength;t[r++]=e._granularity;t[r++]=e._surfaceHeight;t[r++]=e._rotation;t[r++]=e._stRotation;t[r++]=e._extrudedHeight;t[r++]=e._extrude?1:0;t[r++]=e._closeTop?1:0;t[r++]=e._closeBottom?1:0;t[r]=e._shadowVolume?1:0;return t};var Z=new C;var K=new C;var J=c.clone(c.UNIT_SPHERE);var $={rectangle:Z,ellipsoid:J,vertexFormat:z,granularity:undefined,height:undefined,rotation:undefined,stRotation:undefined,extrudedHeight:undefined,closeTop:undefined,closeBottom:undefined,shadowVolume:undefined};Q.unpack=function(e,t,r){n.defined("array",e);t=o(t,0);var i=C.unpack(e,t,Z);t+=C.packedLength;var a=c.unpack(e,t,J);t+=c.packedLength;var l=T.unpack(e,t,z);t+=T.packedLength;var u=C.unpack(e,t,K);t+=C.packedLength;var d=e[t++];var f=e[t++];var h=e[t++];var p=e[t++];var m=e[t++];var v=e[t++]===1;var g=e[t++]===1;var _=e[t++]===1;var y=e[t]===1;if(!s(r)){$.granularity=d;$.height=f;$.rotation=h;$.stRotation=p;$.extrudedHeight=v?m:undefined;$.closeTop=g;$.closeBottom=_;$.shadowVolume=y;return new Q($)}r._rectangle=C.clone(i,r._rectangle);r._ellipsoid=c.clone(a,r._ellipsoid);r._vertexFormat=T.clone(l,r._vertexFormat);r._granularity=d;r._surfaceHeight=f;r._rotation=h;r._stRotation=p;r._extrudedHeight=v?m:undefined;r._extrude=v;r._closeTop=g;r._closeBottom=_;r._rotatedRectangle=u;r._shadowVolume=y;return r};var ee=new _;var te=new i;var re=new i;var ie=new w;var ne=new i;Q.createGeometry=function(t){if(g.equalsEpsilon(t._rectangle.north,t._rectangle.south,g.EPSILON10)||g.equalsEpsilon(t._rectangle.east,t._rectangle.west,g.EPSILON10)){return undefined}var r=C.clone(t._rectangle,O);var i=t._ellipsoid;var n=t._surfaceHeight;var a=t._extrude;var o=t._extrudedHeight;var s=t._rotation;var l=t._stRotation;var u=t._vertexFormat;var c=S.computeOptions(t,r,te,re);var f=ee;if(l!==0||s!==0){var h=C.center(r,ne);var p=i.geodeticSurfaceNormalCartographic(h,N);w.fromAxisAngle(p,-l,ie);_.fromQuaternion(ie,f)}else{_.clone(_.IDENTITY,f)}c.lonScalar=1/t._rectangle.width;c.latScalar=1/t._rectangle.height;c.vertexFormat=u;c.rotation=s;c.stRotation=l;c.tangentRotationMatrix=f;c.size=c.width*c.height;var m;var v;r=t._rectangle;if(a){c.shadowVolume=t._shadowVolume;m=q(c);var b=e.fromRectangle3D(r,i,n,M);var T=e.fromRectangle3D(r,i,o,I);v=e.union(b,T)}else{m=B(c);m.attributes.position.values=y.scaleToGeodeticHeight(m.attributes.position.values,n,i,false);v=e.fromRectangle3D(r,i,n)}if(!u.position){delete m.attributes.position}return new d({attributes:m.attributes,indices:m.indices,primitiveType:m.primitiveType,boundingSphere:v})};Q.createShadowVolume=function(e,t,r){var i=e._granularity;var n=e._ellipsoid;var a=t(i,n);var o=r(i,n);return new Q({rectangle:e._rectangle,rotation:e._rotation,ellipsoid:n,stRotation:e._stRotation,granularity:i,extrudedHeight:o,height:a,closeTop:true,closeBottom:true,vertexFormat:T.POSITION_ONLY,shadowVolume:true})};l(Q.prototype,{rectangle:{get:function(){return this._rotatedRectangle}}});return Q});define("Core/RectangleOutlineGeometry",["./BoundingSphere","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Rectangle","./RectangleGeometryLibrary"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";var g=new e;var _=new e;var y=new t;var b=new m;function w(e){var t=e.size;var r=e.height;var n=e.width;var a=new Float64Array(t*3);var o=0;var s=0;var f;var h=y;for(f=0;f<n;f++){v.computePosition(e,s,f,h);a[o++]=h.x;a[o++]=h.y;a[o++]=h.z}f=n-1;for(s=1;s<r;s++){v.computePosition(e,s,f,h);a[o++]=h.x;a[o++]=h.y;a[o++]=h.z}s=r-1;for(f=n-2;f>=0;f--){v.computePosition(e,s,f,h);a[o++]=h.x;a[o++]=h.y;a[o++]=h.z}f=0;for(s=r-2;s>0;s--){v.computePosition(e,s,f,h);a[o++]=h.x;a[o++]=h.y;a[o++]=h.z}var m=a.length/3*2;var g=d.createTypedArray(a.length/3,m);var _=0;for(var b=0;b<a.length/3-1;b++){g[_++]=b;g[_++]=b+1}g[_++]=a.length/3-1;g[_++]=0;var w=new l({attributes:new c,primitiveType:p.LINES});w.attributes.position=new u({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:a});w.indices=g;return w}function C(e){var t=e.surfaceHeight;var r=e.extrudedHeight;var i=e.ellipsoid;var n=Math.min(r,t);var a=Math.max(r,t);var o=w(e);if(f.equalsEpsilon(n,a,f.EPSILON10)){return o}var s=e.height;var l=e.width;var u=h.scaleToGeodeticHeight(o.attributes.position.values,a,i,false);var c=u.length;var p=new Float64Array(c*2);p.set(u);var m=h.scaleToGeodeticHeight(o.attributes.position.values,n,i);p.set(m,c);o.attributes.position.values=p;var v=p.length/3*2+8;var g=d.createTypedArray(p.length/3,v);c=p.length/6;var _=0;for(var y=0;y<c-1;y++){g[_++]=y;g[_++]=y+1;g[_++]=y+c;g[_++]=y+c+1}g[_++]=c-1;g[_++]=0;g[_++]=c+c-1;g[_++]=c;g[_++]=0;g[_++]=c;g[_++]=l-1;g[_++]=c+l-1;g[_++]=l+s-2;g[_++]=l+s-2+c;g[_++]=2*l+s-3;g[_++]=2*l+s-3+c;o.indices=g;return o}function S(e){e=n(e,n.EMPTY_OBJECT);var t=e.rectangle;var r=n(e.granularity,f.RADIANS_PER_DEGREE);var i=n(e.ellipsoid,s.WGS84);var l=n(e.height,0);var u=n(e.rotation,0);var c=e.extrudedHeight;if(!a(t)){throw new o("rectangle is required.")}m.validate(t);if(t.north<t.south){throw new o("options.rectangle.north must be greater than options.rectangle.south")}this._rectangle=t;this._granularity=r;this._ellipsoid=i;this._surfaceHeight=l;this._rotation=u;this._extrudedHeight=c;this._workerName="createRectangleOutlineGeometry"}S.packedLength=m.packedLength+s.packedLength+5;S.pack=function(e,t,r){if(!a(e)){throw new o("value is required")}if(!a(t)){throw new o("array is required")}r=n(r,0);m.pack(e._rectangle,t,r);r+=m.packedLength;s.pack(e._ellipsoid,t,r);r+=s.packedLength;t[r++]=e._granularity;t[r++]=e._surfaceHeight;t[r++]=e._rotation;t[r++]=a(e._extrudedHeight)?1:0;t[r]=n(e._extrudedHeight,0);return t};var T=new m;var E=s.clone(s.UNIT_SPHERE);var x={rectangle:T,ellipsoid:E,granularity:undefined,height:undefined,rotation:undefined,extrudedHeight:undefined};S.unpack=function(e,t,r){if(!a(e)){throw new o("array is required")}t=n(t,0);var i=m.unpack(e,t,T);t+=m.packedLength;var l=s.unpack(e,t,E);t+=s.packedLength;var u=e[t++];var c=e[t++];var d=e[t++];var f=e[t++];var h=e[t];if(!a(r)){x.granularity=u;x.height=c;x.rotation=d;x.extrudedHeight=f?h:undefined;return new S(x)}r._rectangle=m.clone(i,r._rectangle);r._ellipsoid=s.clone(l,r._ellipsoid);r._surfaceHeight=c;r._rotation=d;r._extrudedHeight=f?h:undefined;return r};var P=new r;S.createGeometry=function(t){var r=m.clone(t._rectangle,b);var i=t._ellipsoid;var n=t._surfaceHeight;var o=t._extrudedHeight;var s=v.computeOptions(t,r,P);s.size=2*s.width+2*s.height-4;var u;var c;r=t._rectangle;if(f.equalsEpsilon(r.north,r.south,f.EPSILON10)||f.equalsEpsilon(r.east,r.west,f.EPSILON10)){return undefined}if(a(o)){u=C(s);var d=e.fromRectangle3D(r,i,n,_);var y=e.fromRectangle3D(r,i,o,g);c=e.union(d,y)}else{u=w(s);u.attributes.position.values=h.scaleToGeodeticHeight(u.attributes.position.values,n,i,false);c=e.fromRectangle3D(r,i,n)}return new l({attributes:u.attributes,indices:u.indices,primitiveType:p.LINES,boundingSphere:c})};return S});define("Core/ReferenceFrame",["./freezeObject"],function(e){"use strict";var t={FIXED:0,INERTIAL:1};return e(t)});define("Core/requestAnimationFrame",["./defined","./getTimestamp"],function(e,t){"use strict";if(typeof window==="undefined"){return}var r=window.requestAnimationFrame;(function(){if(!e(r)){var i=["webkit","moz","ms","o"];var n=0;var a=i.length;while(n<a&&!e(r)){r=window[i[n]+"RequestAnimationFrame"];++n}}if(!e(r)){var o=1e3/60;var s=0;r=function(e){var r=t();var i=Math.max(o-(r-s),0);s=r+i;return setTimeout(function(){e(s)},i)}}})();function i(e){return r(e)}return i});define("Core/sampleTerrain",["../ThirdParty/when","./Check"],function(e,t){"use strict";function r(r,n,a){t.typeOf.object("terrainProvider",r);t.typeOf.number("level",n);t.defined("positions",a);var o=e.defer();function s(){if(r.ready){e(i(r,n,a),function(e){o.resolve(e)})}else{setTimeout(s,10)}}s();return o.promise}function i(t,r,i){var o=t.tilingScheme;var s;var l=[];var u={};for(s=0;s<i.length;++s){var c=o.positionToTileXY(i[s],r);var d=c.toString();if(!u.hasOwnProperty(d)){var f={x:c.x,y:c.y,level:r,tilingScheme:o,terrainProvider:t,positions:[]};u[d]=f;l.push(f)}u[d].positions.push(i[s])}var h=[];for(s=0;s<l.length;++s){var p=l[s];var m=p.terrainProvider.requestTileGeometry(p.x,p.y,p.level);var v=e(m,n(p),a(p));h.push(v)}return e.all(h,function(){return i})}function n(e){var t=e.positions;var r=e.tilingScheme.tileXYToRectangle(e.x,e.y,e.level);return function(e){for(var i=0;i<t.length;++i){var n=t[i];n.height=e.interpolateHeight(r,n.longitude,n.latitude)}}}function a(e){var t=e.positions;return function(){for(var e=0;e<t.length;++e){var r=t[e];r.height=undefined}}}return r});define("Core/sampleTerrainMostDetailed",["../ThirdParty/when","./defined","./DeveloperError","./sampleTerrain"],function(e,t,r,i){"use strict";function n(n,a){if(!t(n)){throw new r("terrainProvider is required.")}if(!t(a)){throw new r("positions is required.")}return n.readyPromise.then(function(){var o=[];var s=n.availability;if(!t(s)){throw new r("sampleTerrainMostDetailed requires a terrain provider that has tile availability.")}for(var l=0;l<a.length;++l){var u=a[l];var c=s.computeMaximumLevelAtPosition(u);var d=o[c];if(!t(d)){o[c]=d=[]}d.push(u)}return e.all(o.map(function(e,r){if(t(e)){return i(n,r,e)}})).then(function(){return a})})}return n});define("Core/ScreenSpaceEventType",["./freezeObject"],function(e){"use strict";var t={LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19};return e(t)});define("Core/ScreenSpaceEventHandler",["./AssociativeArray","./Cartesian2","./defaultValue","./defined","./destroyObject","./DeveloperError","./FeatureDetection","./getTimestamp","./KeyboardEventModifier","./ScreenSpaceEventType"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e,t,r){var i=e._element;if(i===document){r.x=t.clientX;r.y=t.clientY;return r}var n=i.getBoundingClientRect();r.x=t.clientX-n.left;r.y=t.clientY-n.top;return r}function d(e,t){var r=e;if(i(t)){r+="+"+t}return r}function f(e){if(e.shiftKey){return l.SHIFT}else if(e.ctrlKey){return l.CTRL}else if(e.altKey){return l.ALT}return undefined}var h={LEFT:0,MIDDLE:1,RIGHT:2};function p(e,t,r,i){function n(t){i(e,t)}r.addEventListener(t,n,false);e._removalFunctions.push(function(){r.removeEventListener(t,n,false)})}function m(e){var t=e._element;var r=!i(t.disableRootEvents)?document:t;if(o.supportsPointerEvents()){p(e,"pointerdown",t,V);p(e,"pointerup",t,z);p(e,"pointermove",t,q);p(e,"pointercancel",t,z)}else{p(e,"mousedown",t,b);p(e,"mouseup",r,S);p(e,"mousemove",r,E);p(e,"touchstart",t,O);p(e,"touchend",r,D);p(e,"touchmove",r,k);p(e,"touchcancel",r,D)}p(e,"dblclick",t,P);var n;if("onwheel"in t){n="wheel"}else if(document.onmousewheel!==undefined){n="mousewheel"}else{n="DOMMouseScroll"}p(e,n,t,A)}function v(e){var t=e._removalFunctions;for(var r=0;r<t.length;++r){t[r]()}}var g={position:new t};function _(e){e._lastSeenTouchEvent=s()}function y(e){return s()-e._lastSeenTouchEvent>G.mouseEmulationIgnoreMilliseconds}function b(e,r){if(!y(e)){return}var n=r.button;e._buttonDown=n;var a;if(n===h.LEFT){a=u.LEFT_DOWN}else if(n===h.MIDDLE){a=u.MIDDLE_DOWN}else if(n===h.RIGHT){a=u.RIGHT_DOWN}else{return}var o=c(e,r,e._primaryPosition);t.clone(o,e._primaryStartPosition);t.clone(o,e._primaryPreviousPosition);var s=f(r);var l=e.getInputAction(a,s);if(i(l)){t.clone(o,g.position);l(g);r.preventDefault()}}var w={position:new t};var C={position:new t};function S(e,r){if(!y(e)){return}var n=r.button;e._buttonDown=undefined;var a;var o;if(n===h.LEFT){a=u.LEFT_UP;o=u.LEFT_CLICK}else if(n===h.MIDDLE){a=u.MIDDLE_UP;o=u.MIDDLE_CLICK}else if(n===h.RIGHT){a=u.RIGHT_UP;o=u.RIGHT_CLICK}else{return}var s=f(r);var l=e.getInputAction(a,s);var d=e.getInputAction(o,s);if(i(l)||i(d)){var p=c(e,r,e._primaryPosition);if(i(l)){t.clone(p,w.position);l(w)}if(i(d)){var m=e._primaryStartPosition;var v=m.x-p.x;var g=m.y-p.y;var _=Math.sqrt(v*v+g*g);if(_<e._clickPixelTolerance){t.clone(p,C.position);d(C)}}}}var T={startPosition:new t,endPosition:new t};function E(e,r){if(!y(e)){return}var n=f(r);var a=c(e,r,e._primaryPosition);var o=e._primaryPreviousPosition;var s=e.getInputAction(u.MOUSE_MOVE,n);if(i(s)){t.clone(o,T.startPosition);t.clone(a,T.endPosition);s(T)}t.clone(a,o);if(i(e._buttonDown)){r.preventDefault()}}var x={position:new t};function P(e,t){var r=t.button;var n;if(r===h.LEFT){n=u.LEFT_DOUBLE_CLICK}else{return}var a=f(t);var o=e.getInputAction(n,a);if(i(o)){c(e,t,x.position);o(x)}}function A(e,t){var r;if(i(t.deltaY)){var n=t.deltaMode;if(n===t.DOM_DELTA_PIXEL){r=-t.deltaY}else if(n===t.DOM_DELTA_LINE){r=-t.deltaY*40}else{r=-t.deltaY*120}}else if(t.detail>0){r=t.detail*-120}else{r=t.wheelDelta}if(!i(r)){return}var a=f(t);var o=e.getInputAction(u.WHEEL,a);if(i(o)){o(r);t.preventDefault()}}function O(e,r){_(e);var i=r.changedTouches;var n;var a=i.length;var o;var s;var l=e._positions;for(n=0;n<a;++n){o=i[n];s=o.identifier;l.set(s,c(e,o,new t))}N(e,r);var u=e._previousPositions;for(n=0;n<a;++n){o=i[n];s=o.identifier;u.set(s,t.clone(l.get(s)))}}function D(e,t){_(e);var r=t.changedTouches;var i;var n=r.length;var a;var o;var s=e._positions;for(i=0;i<n;++i){a=r[i];o=a.identifier;s.remove(o)}N(e,t);var l=e._previousPositions;for(i=0;i<n;++i){a=r[i];o=a.identifier;l.remove(o)}}var I={position:new t};var M={position1:new t,position2:new t};var R={position:new t};var L={position:new t};function N(e,r){var n=f(r);var a=e._positions;var o=e._previousPositions;var s=a.length;var l;var c;if(s!==1&&e._buttonDown===h.LEFT){e._buttonDown=undefined;l=e.getInputAction(u.LEFT_UP,n);if(i(l)){t.clone(e._primaryPosition,R.position);l(R)}if(s===0){c=e.getInputAction(u.LEFT_CLICK,n);if(i(c)){var d=e._primaryStartPosition;var p=o.values[0];var m=d.x-p.x;var v=d.y-p.y;var g=Math.sqrt(m*m+v*v);if(g<e._clickPixelTolerance){t.clone(e._primaryPosition,L.position);c(L)}}}}if(s!==2&&e._isPinching){e._isPinching=false;l=e.getInputAction(u.PINCH_END,n);if(i(l)){l()}}if(s===1){var _=a.values[0];t.clone(_,e._primaryPosition);t.clone(_,e._primaryStartPosition);t.clone(_,e._primaryPreviousPosition);e._buttonDown=h.LEFT;l=e.getInputAction(u.LEFT_DOWN,n);if(i(l)){t.clone(_,I.position);l(I)}r.preventDefault()}if(s===2){e._isPinching=true;l=e.getInputAction(u.PINCH_START,n);if(i(l)){t.clone(a.values[0],M.position1);t.clone(a.values[1],M.position2);l(M);r.preventDefault()}}}function k(e,r){_(e);var n=r.changedTouches;var a;var o=n.length;var s;var l;var u=e._positions;for(a=0;a<o;++a){s=n[a];l=s.identifier;var d=u.get(l);if(i(d)){c(e,s,d)}}U(e,r);var f=e._previousPositions;for(a=0;a<o;++a){s=n[a];l=s.identifier;t.clone(u.get(l),f.get(l))}}var F={startPosition:new t,endPosition:new t};var B={distance:{startPosition:new t,endPosition:new t},angleAndHeight:{startPosition:new t,endPosition:new t}};function U(e,r){var n=f(r);var a=e._positions;var o=e._previousPositions;var s=a.length;var l;if(s===1&&e._buttonDown===h.LEFT){var c=a.values[0];t.clone(c,e._primaryPosition);var d=e._primaryPreviousPosition;l=e.getInputAction(u.MOUSE_MOVE,n);if(i(l)){t.clone(d,F.startPosition);t.clone(c,F.endPosition);l(F)}t.clone(c,d);r.preventDefault()}else if(s===2&&e._isPinching){l=e.getInputAction(u.PINCH_MOVE,n);if(i(l)){var p=a.values[0];var m=a.values[1];var v=o.values[0];var g=o.values[1];var _=m.x-p.x;var y=m.y-p.y;var b=Math.sqrt(_*_+y*y)*.25;var w=g.x-v.x;var C=g.y-v.y;var S=Math.sqrt(w*w+C*C)*.25;var T=(m.y+p.y)*.125;var E=(g.y+v.y)*.125;var x=Math.atan2(y,_);var P=Math.atan2(C,w);t.fromElements(0,S,B.distance.startPosition);t.fromElements(0,b,B.distance.endPosition);t.fromElements(P,E,B.angleAndHeight.startPosition);t.fromElements(x,T,B.angleAndHeight.endPosition);l(B)}}}function V(e,r){r.target.setPointerCapture(r.pointerId);if(r.pointerType==="touch"){var i=e._positions;var n=r.pointerId;i.set(n,c(e,r,new t));N(e,r);var a=e._previousPositions;a.set(n,t.clone(i.get(n)))}else{b(e,r)}}function z(e,t){if(t.pointerType==="touch"){var r=e._positions;var i=t.pointerId;r.remove(i);N(e,t);var n=e._previousPositions;n.remove(i)}else{S(e,t)}}function q(e,r){if(r.pointerType==="touch"){var n=e._positions;var a=r.pointerId;var o=n.get(a);if(!i(o)){return}c(e,r,o);U(e,r);var s=e._previousPositions;t.clone(n.get(a),s.get(a))}else{E(e,r)}}function G(i){this._inputEvents={};this._buttonDown=undefined;this._isPinching=false;this._lastSeenTouchEvent=-G.mouseEmulationIgnoreMilliseconds;this._primaryStartPosition=new t;this._primaryPosition=new t;this._primaryPreviousPosition=new t;this._positions=new e;this._previousPositions=new e;this._removalFunctions=[];this._clickPixelTolerance=5;this._element=r(i,document);m(this)}G.prototype.setInputAction=function(e,t,r){if(!i(e)){throw new a("action is required.")}if(!i(t)){throw new a("type is required.")}var n=d(t,r);this._inputEvents[n]=e};G.prototype.getInputAction=function(e,t){if(!i(e)){throw new a("type is required.")}var r=d(e,t);return this._inputEvents[r]};G.prototype.removeInputAction=function(e,t){if(!i(e)){throw new a("type is required.")}var r=d(e,t);delete this._inputEvents[r]};G.prototype.isDestroyed=function(){return false};G.prototype.destroy=function(){v(this);return n(this)};G.mouseEmulationIgnoreMilliseconds=800;return G});define("Core/ShowGeometryInstanceAttribute",["./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,r,i,n){"use strict";function a(e){e=t(e,true);this.value=a.toValue(e)}i(a.prototype,{componentDatatype:{get:function(){return e.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return false}}});a.toValue=function(e,t){if(!r(e)){throw new n("show is required.")}if(!r(t)){return new Uint8Array([e])}t[0]=e;return t};return a});define("Core/Simon1994PlanetaryPositions",["./Cartesian3","./defined","./DeveloperError","./JulianDate","./Math","./Matrix3","./TimeConstants","./TimeStandard"],function(e,t,r,i,n,a,o,s){"use strict";var l={};function u(e){var t=6.239996+.0172019696544*e;return.001657*Math.sin(t+.01671*Math.sin(t))}var c=32.184;var d=2451545;function f(e,t){t=i.addSeconds(e,c,t);var r=i.totalDays(t)-d;t=i.addSeconds(t,u(r),t);return t}var h=new i(2451545,0,s.TAI);var p=1e3;var m=n.RADIANS_PER_DEGREE;var v=n.RADIANS_PER_ARCSECOND;var g=14959787e4;var _=new a;function y(i,o,s,l,u,c,d){if(s<0){s=-s;u+=n.PI}if(s<0||s>n.PI){throw new r("The inclination is out of range. Inclination must be greater than or equal to zero and less than or equal to Pi radians.")}var f=i*(1-o);var h=l-u;var p=u;var m=w(c-l,o);var v=b(o,0);if(v==="Hyperbolic"&&Math.abs(n.negativePiToPi(m))>=Math.acos(-1/o)){throw new r("The true anomaly of the hyperbolic orbit lies outside of the bounds of the hyperbola.")}x(h,s,p,_);var g=f*(1+o);var y=Math.cos(m);var C=Math.sin(m);var S=1+o*y;if(S<=n.Epsilon10){throw new r("elements cannot be converted to cartesian")}var T=g/S;if(!t(d)){d=new e(T*y,T*C,0)}else{d.x=T*y;d.y=T*C;d.z=0}return a.multiplyByVector(_,d,d)}function b(e,t){if(e<0){throw new r("eccentricity cannot be negative.")}if(e<=t){return"Circular"}else if(e<1-t){return"Elliptical"}else if(e<=1+t){return"Parabolic"}return"Hyperbolic"}function w(e,t){if(t<0||t>=1){throw new r("eccentricity out of range.")}var i=T(e,t);return E(i,t)}var C=50;var S=n.EPSILON8;function T(e,t){if(t<0||t>=1){throw new r("eccentricity out of range.")}var i=Math.floor(e/n.TWO_PI);e-=i*n.TWO_PI;var a=e+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e));var o=Number.MAX_VALUE;var s;for(s=0;s<C&&Math.abs(o-a)>S;++s){o=a;var l=o-t*Math.sin(o)-e;var u=1-t*Math.cos(o);a=o-l/u}if(s>=C){throw new r("Kepler equation did not converge")}o=a+i*n.TWO_PI;return o}function E(e,t){if(t<0||t>=1){throw new r("eccentricity out of range.")}var i=Math.floor(e/n.TWO_PI);e-=i*n.TWO_PI;var a=Math.cos(e)-t;var o=Math.sin(e)*Math.sqrt(1-t*t);var s=Math.atan2(o,a);s=n.zeroToTwoPi(s);if(e<0){s-=n.TWO_PI}s+=i*n.TWO_PI;return s}function x(e,i,o,s){if(i<0||i>n.PI){throw new r("inclination out of range")}var l=Math.cos(e);var u=Math.sin(e);var c=Math.cos(i);var d=Math.sin(i);var f=Math.cos(o);var h=Math.sin(o);if(!t(s)){s=new a(f*l-h*u*c,-f*u-h*l*c,h*d,h*l+f*u*c,-h*u+f*l*c,-f*d,u*d,l*d,c)}else{s[0]=f*l-h*u*c;s[1]=h*l+f*u*c;s[2]=u*d;s[3]=-f*u-h*l*c;s[4]=-h*u+f*l*c;s[5]=l*d;s[6]=h*d;s[7]=-f*d;s[8]=c}return s}var P=1.0000010178*g;var A=100.46645683*m;var O=1295977422.83429*v;var D=16002;var I=21863;var M=32004;var R=10931;var L=14529;var N=16368;var k=15318;var F=32794;var B=64*1e-7*g;var U=-152*1e-7*g;var V=62*1e-7*g;var z=-8*1e-7*g;var q=32*1e-7*g;var G=-41*1e-7*g;var H=19*1e-7*g;var j=-11*1e-7*g;var W=-150*1e-7*g;var Y=-46*1e-7*g;var X=68*1e-7*g;var Q=54*1e-7*g;var Z=14*1e-7*g;var K=24*1e-7*g;var J=-28*1e-7*g;var $=22*1e-7*g;var ee=10;var te=16002;var re=21863;var ie=10931;var ne=1473;var ae=32004;var oe=4387;var se=73;var le=-325*1e-7;var ue=-322*1e-7;var ce=-79*1e-7;var de=232*1e-7;var fe=-52*1e-7;var he=97*1e-7;var pe=55*1e-7;var me=-41*1e-7;var ve=-105*1e-7;var ge=-137*1e-7;var _e=258*1e-7;var ye=35*1e-7;var be=-116*1e-7;var we=-88*1e-7;var Ce=-112*1e-7;var Se=-80*1e-7;var Te=new i(0,0,s.TAI);function Ee(e,t){f(e,Te);var r=Te.dayNumber-h.dayNumber+(Te.secondsOfDay-h.secondsOfDay)/o.SECONDS_PER_DAY;var i=r/(o.DAYS_PER_JULIAN_CENTURY*10);var n=.3595362*i;var a=P+B*Math.cos(D*n)+W*Math.sin(D*n)+U*Math.cos(I*n)+Y*Math.sin(I*n)+V*Math.cos(M*n)+X*Math.sin(M*n)+z*Math.cos(R*n)+Q*Math.sin(R*n)+q*Math.cos(L*n)+Z*Math.sin(L*n)+G*Math.cos(N*n)+K*Math.sin(N*n)+H*Math.cos(k*n)+J*Math.sin(k*n)+j*Math.cos(F*n)+$*Math.sin(F*n);var s=A+O*i+le*Math.cos(ee*n)+ve*Math.sin(ee*n)+ue*Math.cos(te*n)+ge*Math.sin(te*n)+ce*Math.cos(re*n)+_e*Math.sin(re*n)+de*Math.cos(ie*n)+ye*Math.sin(ie*n)+fe*Math.cos(ne*n)+be*Math.sin(ne*n)+he*Math.cos(ae*n)+we*Math.sin(ae*n)+pe*Math.cos(oe*n)+Ce*Math.sin(oe*n)+me*Math.cos(se*n)+Se*Math.sin(se*n);var l=.0167086342-.0004203654*i;var u=102.93734808*m+11612.3529*v*i;var c=469.97289*v*i;var d=174.87317577*m-8679.27034*v*i;return y(a,l,c,u,d,s,t)}function xe(e,t){f(e,Te);var r=Te.dayNumber-h.dayNumber+(Te.secondsOfDay-h.secondsOfDay)/o.SECONDS_PER_DAY;var i=r/o.DAYS_PER_JULIAN_CENTURY;var n=i*i;var a=n*i;var s=a*i;var l=383397.7725+.004*i;var u=.055545526-1.6e-8*i;var c=5.15668983*m;var d=-8e-5*i+.02966*n-42e-6*a-1.3e-7*s;var g=83.35324312*m;var _=14643420.2669*i-38.2702*n-.045047*a+21301e-8*s;var b=125.04455501*m;var w=-6967919.3631*i+6.3602*n+.007625*a-3586e-8*s;var C=218.31664563*m;var S=1732559343.4847*i-6.391*n+.006588*a-3169e-8*s;var T=297.85019547*m+v*(1602961601.209*i-6.3706*n+.006593*a-3169e-8*s);var E=93.27209062*m+v*(1739527262.8478*i-12.7512*n-.001037*a+417e-8*s);var x=134.96340251*m+v*(1717915923.2178*i+31.8792*n+.051635*a-2447e-7*s);var P=357.52910918*m+v*(129596581.0481*i-.5532*n+136e-6*a-1149e-8*s);var A=310.17137918*m-v*(6967051.436*i+6.2068*n+.007618*a-3219e-8*s);var O=2*T;var D=4*T;var I=6*T;var M=2*x;var R=3*x;var L=4*x;var N=2*E;l+=3400.4*Math.cos(O)-635.6*Math.cos(O-x)-235.6*Math.cos(x)+218.1*Math.cos(O-P)+181*Math.cos(O+x);u+=.014216*Math.cos(O-x)+.008551*Math.cos(O-M)-.001383*Math.cos(x)+.001356*Math.cos(O+x)-.001147*Math.cos(D-R)-914e-6*Math.cos(D-M)+869e-6*Math.cos(O-P-x)-627e-6*Math.cos(O)-394e-6*Math.cos(D-L)+282e-6*Math.cos(O-P-M)-279e-6*Math.cos(T-x)-236e-6*Math.cos(M)+231e-6*Math.cos(D)+229e-6*Math.cos(I-L)-201e-6*Math.cos(M-N);d+=486.26*Math.cos(O-N)-40.13*Math.cos(O)+37.51*Math.cos(N)+25.73*Math.cos(M-N)+19.97*Math.cos(O-P-N);_+=-55609*Math.sin(O-x)-34711*Math.sin(O-M)-9792*Math.sin(x)+9385*Math.sin(D-R)+7505*Math.sin(D-M)+5318*Math.sin(O+x)+3484*Math.sin(D-L)-3417*Math.sin(O-P-x)-2530*Math.sin(I-L)-2376*Math.sin(O)-2075*Math.sin(O-R)-1883*Math.sin(M)-1736*Math.sin(I-5*x)+1626*Math.sin(P)-1370*Math.sin(I-R);w+=-5392*Math.sin(O-N)-540*Math.sin(P)-441*Math.sin(O)+423*Math.sin(N)-288*Math.sin(M-N);S+=-3332.9*Math.sin(O)+1197.4*Math.sin(O-x)-662.5*Math.sin(P)+396.3*Math.sin(x)-218*Math.sin(O-P);var k=2*A;var F=3*A;d+=46.997*Math.cos(A)*i-.614*Math.cos(O-N+A)*i+.614*Math.cos(O-N-A)*i-.0297*Math.cos(k)*n-.0335*Math.cos(A)*n+.0012*Math.cos(O-N+k)*n-16e-5*Math.cos(A)*a+4e-5*Math.cos(F)*a+4e-5*Math.cos(k)*a;var B=2.116*Math.sin(A)*i-.111*Math.sin(O-N-A)*i-.0015*Math.sin(A)*n;_+=B;S+=B;w+=-520.77*Math.sin(A)*i+13.66*Math.sin(O-N+A)*i+1.12*Math.sin(O-A)*i-1.06*Math.sin(N-A)*i+.66*Math.sin(k)*n+.371*Math.sin(A)*n-.035*Math.sin(O-N+k)*n-.015*Math.sin(O-N+A)*n+.0014*Math.sin(A)*a-.0011*Math.sin(F)*a-9e-4*Math.sin(k)*a;l*=p;var U=c+d*v;var V=g+_*v;var z=C+S*v;var q=b+w*v;return y(l,u,U,V,q,z,t)}var Pe=.012300034;var Ae=Pe/(Pe+1)*-1;function Oe(t,r){r=xe(t,r);return e.multiplyByScalar(r,Ae,r)}var De=new a(1.0000000000000002,5.619723173785822e-16,4.690511510146299e-19,-5.154129427414611e-16,.9174820620691819,-.39777715593191376,-2.23970096136568e-16,.39777715593191376,.9174820620691819);var Ie=new e;l.computeSunPositionInEarthInertialFrame=function(r,n){if(!t(r)){r=i.now()}if(!t(n)){n=new e}Ie=Ee(r,Ie);n=e.negate(Ie,n);Oe(r,Ie);e.subtract(n,Ie,n);a.multiplyByVector(De,n,n);return n};l.computeMoonPositionInEarthInertialFrame=function(e,r){if(!t(e)){e=i.now()}r=xe(e,r);a.multiplyByVector(De,r,r);return r};return l});define("Core/SimplePolylineGeometry",["./BoundingSphere","./Cartesian3","./Color","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolylinePipeline","./PrimitiveType"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";function m(e,t,i,n,a,o,s){var l=h.numberOfPoints(e,t,a);var u;var c=i.red;var d=i.green;var f=i.blue;var p=i.alpha;var m=n.red;var v=n.green;var g=n.blue;var _=n.alpha;if(r.equals(i,n)){for(u=0;u<l;u++){o[s++]=r.floatToByte(c);o[s++]=r.floatToByte(d);o[s++]=r.floatToByte(f);o[s++]=r.floatToByte(p)}return s}var y=(m-c)/l;var b=(v-d)/l;var w=(g-f)/l;var C=(_-p)/l;var S=s;for(u=0;u<l;u++){o[S++]=r.floatToByte(c+u*y);o[S++]=r.floatToByte(d+u*b);o[S++]=r.floatToByte(f+u*w);o[S++]=r.floatToByte(p+u*C)}return S}function v(e){e=n(e,n.EMPTY_OBJECT);var i=e.positions;var l=e.colors;var u=n(e.colorsPerVertex,false);if(!a(i)||i.length<2){throw new o("At least two positions are required.")}if(a(l)&&(u&&l.length<i.length||!u&&l.length<i.length-1)){throw new o("colors has an invalid length.")}this._positions=i;this._colors=l;this._colorsPerVertex=u;this._followSurface=n(e.followSurface,true);this._granularity=n(e.granularity,f.RADIANS_PER_DEGREE);this._ellipsoid=n(e.ellipsoid,s.WGS84);this._workerName="createSimplePolylineGeometry";var c=1+i.length*t.packedLength;c+=a(l)?1+l.length*r.packedLength:1;this.packedLength=c+s.packedLength+3}v.pack=function(e,i,l){if(!a(e)){throw new o("value is required")}if(!a(i)){throw new o("array is required")}l=n(l,0);var u;var c=e._positions;var d=c.length;i[l++]=d;for(u=0;u<d;++u,l+=t.packedLength){t.pack(c[u],i,l)}var f=e._colors;d=a(f)?f.length:0;i[l++]=d;for(u=0;u<d;++u,l+=r.packedLength){r.pack(f[u],i,l)}s.pack(e._ellipsoid,i,l);l+=s.packedLength;i[l++]=e._colorsPerVertex?1:0;i[l++]=e._followSurface?1:0;i[l]=e._granularity;return i};v.unpack=function(e,i,l){if(!a(e)){throw new o("array is required")}i=n(i,0);var u;var c=e[i++];var d=new Array(c);for(u=0;u<c;++u,i+=t.packedLength){d[u]=t.unpack(e,i)}c=e[i++];var f=c>0?new Array(c):undefined;for(u=0;u<c;++u,i+=r.packedLength){f[u]=r.unpack(e,i)}var h=s.unpack(e,i);i+=s.packedLength;var p=e[i++]===1;var m=e[i++]===1;var g=e[i];if(!a(l)){return new v({positions:d,colors:f,ellipsoid:h,colorsPerVertex:p,followSurface:m,granularity:g})}l._positions=d;l._colors=f;l._ellipsoid=h;l._colorsPerVertex=p;l._followSurface=m;l._granularity=g;return l};var g=new Array(2);var _=new Array(2);var y={positions:g,height:_,ellipsoid:undefined,minDistance:undefined};v.createGeometry=function(n){var o=n._positions;var s=n._colors;var v=n._colorsPerVertex;var b=n._followSurface;var w=n._granularity;var C=n._ellipsoid;var S=f.chordLength(w,C.maximumRadius);var T=a(s)&&!v;var E;var x=o.length;var P;var A;var O;var D;var I=0;if(b){var M=h.extractHeights(o,C);var R=y;R.minDistance=S;R.ellipsoid=C;if(T){var L=0;for(E=0;E<x-1;E++){L+=h.numberOfPoints(o[E],o[E+1],S)+1}P=new Float64Array(L*3);O=new Uint8Array(L*4);R.positions=g;R.height=_;var N=0;for(E=0;E<x-1;++E){g[0]=o[E];g[1]=o[E+1];_[0]=M[E];_[1]=M[E+1];var k=h.generateArc(R);if(a(s)){var F=k.length/3;D=s[E];for(var B=0;B<F;++B){O[N++]=r.floatToByte(D.red);O[N++]=r.floatToByte(D.green);O[N++]=r.floatToByte(D.blue);O[N++]=r.floatToByte(D.alpha)}}P.set(k,I);I+=k.length}}else{R.positions=o;R.height=M;P=new Float64Array(h.generateArc(R));if(a(s)){O=new Uint8Array(P.length/3*4);for(E=0;E<x-1;++E){var U=o[E];var V=o[E+1];var z=s[E];var q=s[E+1];I=m(U,V,z,q,S,O,I)}var G=s[x-1];O[I++]=r.floatToByte(G.red);O[I++]=r.floatToByte(G.green);O[I++]=r.floatToByte(G.blue);O[I++]=r.floatToByte(G.alpha)}}}else{A=T?x*2-2:x;P=new Float64Array(A*3);O=a(s)?new Uint8Array(A*4):undefined;var H=0;var j=0;for(E=0;E<x;++E){var W=o[E];if(T&&E>0){t.pack(W,P,H);H+=3;D=s[E-1];O[j++]=r.floatToByte(D.red);O[j++]=r.floatToByte(D.green);O[j++]=r.floatToByte(D.blue);O[j++]=r.floatToByte(D.alpha)}if(T&&E===x-1){break}t.pack(W,P,H);H+=3;if(a(s)){D=s[E];O[j++]=r.floatToByte(D.red);O[j++]=r.floatToByte(D.green);O[j++]=r.floatToByte(D.blue);O[j++]=r.floatToByte(D.alpha)}}}var Y=new c;Y.position=new u({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:P});if(a(s)){Y.color=new u({componentDatatype:i.UNSIGNED_BYTE,componentsPerAttribute:4,values:O,normalize:true})}A=P.length/3;var X=(A-1)*2;var Q=d.createTypedArray(A,X);var Z=0;for(E=0;E<A-1;++E){Q[Z++]=E;Q[Z++]=E+1}return new l({attributes:Y,indices:Q,primitiveType:p.LINES,boundingSphere:e.fromPoints(o)})};return v});define("Core/SphereGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./EllipsoidGeometry","./VertexFormat"],function(e,t,r,i,n,a){"use strict";function o(t){var i=r(t.radius,1);var a=new e(i,i,i);var o={radii:a,stackPartitions:t.stackPartitions,slicePartitions:t.slicePartitions,vertexFormat:t.vertexFormat};this._ellipsoidGeometry=new n(o);this._workerName="createSphereGeometry"}o.packedLength=n.packedLength;o.pack=function(e,r,i){t.typeOf.object("value",e);return n.pack(e._ellipsoidGeometry,r,i)};var s=new n;var l={radius:undefined,radii:new e,vertexFormat:new a,stackPartitions:undefined,slicePartitions:undefined};o.unpack=function(t,r,u){var c=n.unpack(t,r,s);l.vertexFormat=a.clone(c._vertexFormat,l.vertexFormat);l.stackPartitions=c._stackPartitions;l.slicePartitions=c._slicePartitions;if(!i(u)){l.radius=c._radii.x;return new o(l)}e.clone(c._radii,l.radii);u._ellipsoidGeometry=new n(l);return u};o.createGeometry=function(e){return n.createGeometry(e._ellipsoidGeometry)};return o});define("Core/SphereOutlineGeometry",["./Cartesian3","./Check","./defaultValue","./defined","./EllipsoidOutlineGeometry"],function(e,t,r,i,n){"use strict";function a(t){var i=r(t.radius,1);var a=new e(i,i,i);var o={radii:a,stackPartitions:t.stackPartitions,slicePartitions:t.slicePartitions,subdivisions:t.subdivisions};this._ellipsoidGeometry=new n(o);this._workerName="createSphereOutlineGeometry"}a.packedLength=n.packedLength;a.pack=function(e,r,i){t.typeOf.object("value",e);return n.pack(e._ellipsoidGeometry,r,i)};var o=new n;var s={radius:undefined,radii:new e,stackPartitions:undefined,slicePartitions:undefined,subdivisions:undefined};a.unpack=function(t,r,l){var u=n.unpack(t,r,o);s.stackPartitions=u._stackPartitions;s.slicePartitions=u._slicePartitions;s.subdivisions=u._subdivisions;if(!i(l)){s.radius=u._radii.x;return new a(s)}e.clone(u._radii,s.radii);l._ellipsoidGeometry=new n(s);return l};a.createGeometry=function(e){return n.createGeometry(e._ellipsoidGeometry)};return a});define("Core/Spherical",["./Check","./defaultValue","./defined"],function(e,t,r){"use strict";function i(e,r,i){this.clock=t(e,0);this.cone=t(r,0);this.magnitude=t(i,1)}i.fromCartesian3=function(t,n){e.typeOf.object("cartesian3",t);var a=t.x;var o=t.y;var s=t.z;var l=a*a+o*o;if(!r(n)){n=new i}n.clock=Math.atan2(o,a);n.cone=Math.atan2(Math.sqrt(l),s);n.magnitude=Math.sqrt(l+s*s);return n};i.clone=function(e,t){if(!r(e)){return undefined}if(!r(t)){return new i(e.clock,e.cone,e.magnitude)}t.clock=e.clock;t.cone=e.cone;t.magnitude=e.magnitude;return t};i.normalize=function(t,n){e.typeOf.object("spherical",t);if(!r(n)){return new i(t.clock,t.cone,1)}n.clock=t.clock;n.cone=t.cone;n.magnitude=1;return n};i.equals=function(e,t){return e===t||r(e)&&r(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude};i.equalsEpsilon=function(e,i,n){n=t(n,0);return e===i||r(e)&&r(i)&&Math.abs(e.clock-i.clock)<=n&&Math.abs(e.cone-i.cone)<=n&&Math.abs(e.magnitude-i.magnitude)<=n};i.prototype.equals=function(e){return i.equals(this,e)};i.prototype.clone=function(e){return i.clone(this,e)};i.prototype.equalsEpsilon=function(e,t){return i.equalsEpsilon(this,e,t)};i.prototype.toString=function(){return"("+this.clock+", "+this.cone+", "+this.magnitude+")"};return i});define("Core/subdivideArray",["./defined","./DeveloperError"],function(e,t){"use strict";function r(r,i){if(!e(r)){throw new t("array is required.")}if(!e(i)||i<1){throw new t("numberOfArrays must be greater than 0.")}var n=[];var a=r.length;var o=0;while(o<a){var s=Math.ceil((a-o)/i--);n.push(r.slice(o,o+s));o+=s}return n}return r});define("Core/TerrainData",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}e(r.prototype,{credits:{get:t.throwInstantiationError},waterMask:{get:t.throwInstantiationError}});r.prototype.interpolateHeight=t.throwInstantiationError;r.prototype.isChildAvailable=t.throwInstantiationError;r.prototype.createMesh=t.throwInstantiationError;r.prototype.upsample=t.throwInstantiationError;r.prototype.wasCreatedByUpsampling=t.throwInstantiationError;return r});define("Core/TilingScheme",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function r(e){throw new t("This type should not be instantiated directly.  Instead, use WebMercatorTilingScheme or GeographicTilingScheme.")}e(r.prototype,{ellipsoid:{get:t.throwInstantiationError},rectangle:{get:t.throwInstantiationError},projection:{get:t.throwInstantiationError}});r.prototype.getNumberOfXTilesAtLevel=t.throwInstantiationError;r.prototype.getNumberOfYTilesAtLevel=t.throwInstantiationError;r.prototype.rectangleToNativeRectangle=t.throwInstantiationError;r.prototype.tileXYToNativeRectangle=t.throwInstantiationError;r.prototype.tileXYToRectangle=t.throwInstantiationError;r.prototype.positionToTileXY=t.throwInstantiationError;return r});define("Core/TimeIntervalCollection",["./binarySearch","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./GregorianDate","./isLeapYear","./Iso8601","./JulianDate","./TimeInterval"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";function d(e,t){return u.compare(e.start,t.start)}function f(e){this._intervals=[];this._changedEvent=new a;if(r(e)){var t=e.length;for(var i=0;i<t;i++){this.addInterval(e[i])}}}i(f.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){var e=this._intervals;return e.length===0?undefined:e[0].start}},isStartIncluded:{get:function(){var e=this._intervals;return e.length===0?false:e[0].isStartIncluded}},stop:{get:function(){var e=this._intervals;var t=e.length;return t===0?undefined:e[t-1].stop}},isStopIncluded:{get:function(){var e=this._intervals;var t=e.length;return t===0?false:e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return this._intervals.length===0}}});f.prototype.equals=function(e,t){if(this===e){return true}if(!(e instanceof f)){return false}var r=this._intervals;var i=e._intervals;var n=r.length;if(n!==i.length){return false}for(var a=0;a<n;a++){if(!c.equals(r[a],i[a],t)){return false}}return true};f.prototype.get=function(e){if(!r(e)){throw new n("index is required.")}return this._intervals[e]};f.prototype.removeAll=function(){if(this._intervals.length>0){this._intervals.length=0;this._changedEvent.raiseEvent(this)}};f.prototype.findIntervalContainingDate=function(e){var t=this.indexOf(e);return t>=0?this._intervals[t]:undefined};f.prototype.findDataForIntervalContainingDate=function(e){var t=this.indexOf(e);return t>=0?this._intervals[t].data:undefined};f.prototype.contains=function(e){return this.indexOf(e)>=0};var h=new c;f.prototype.indexOf=function(t){if(!r(t)){throw new n("date is required")}var i=this._intervals;h.start=t;h.stop=t;var a=e(i,h,d);if(a>=0){if(i[a].isStartIncluded){return a}if(a>0&&i[a-1].stop.equals(t)&&i[a-1].isStopIncluded){return a-1}return~a}a=~a;if(a>0&&a-1<i.length&&c.contains(i[a-1],t)){return a-1}return~a};f.prototype.findInterval=function(e){e=t(e,t.EMPTY_OBJECT);var i=e.start;var n=e.stop;var a=e.isStartIncluded;var o=e.isStopIncluded;var s=this._intervals;for(var l=0,u=s.length;l<u;l++){var c=s[l];if((!r(i)||c.start.equals(i))&&(!r(n)||c.stop.equals(n))&&(!r(a)||c.isStartIncluded===a)&&(!r(o)||c.isStopIncluded===o)){return s[l]}}return undefined};f.prototype.addInterval=function(t,i){if(!r(t)){throw new n("interval is required")}if(t.isEmpty){return}var a;var o;var s=this._intervals;if(s.length===0||u.greaterThan(t.start,s[s.length-1].stop)){s.push(t);this._changedEvent.raiseEvent(this);return}o=e(s,t,d);if(o<0){o=~o}else if(o>0&&t.isStartIncluded&&s[o-1].isStartIncluded&&s[o-1].start.equals(t.start)){--o}else if(o<s.length&&!t.isStartIncluded&&s[o].isStartIncluded&&s[o].start.equals(t.start)){++o}if(o>0){a=u.compare(s[o-1].stop,t.start);if(a>0||a===0&&(s[o-1].isStopIncluded||t.isStartIncluded)){if(r(i)?i(s[o-1].data,t.data):s[o-1].data===t.data){if(u.greaterThan(t.stop,s[o-1].stop)){t=new c({start:s[o-1].start,stop:t.stop,isStartIncluded:s[o-1].isStartIncluded,isStopIncluded:t.isStopIncluded,data:t.data})}else{t=new c({start:s[o-1].start,stop:s[o-1].stop,isStartIncluded:s[o-1].isStartIncluded,isStopIncluded:s[o-1].isStopIncluded||t.stop.equals(s[o-1].stop)&&t.isStopIncluded,data:t.data})}s.splice(o-1,1);--o}else{a=u.compare(s[o-1].stop,t.stop);if(a>0||a===0&&s[o-1].isStopIncluded&&!t.isStopIncluded){s.splice(o-1,1,new c({start:s[o-1].start,stop:t.start,isStartIncluded:s[o-1].isStartIncluded,isStopIncluded:!t.isStartIncluded,data:s[o-1].data}),new c({start:t.stop,stop:s[o-1].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:s[o-1].isStopIncluded,data:s[o-1].data}))}else{s[o-1]=new c({start:s[o-1].start,stop:t.start,isStartIncluded:s[o-1].isStartIncluded,isStopIncluded:!t.isStartIncluded,data:s[o-1].data})}}}}while(o<s.length){a=u.compare(t.stop,s[o].start);if(a>0||a===0&&(t.isStopIncluded||s[o].isStartIncluded)){if(r(i)?i(s[o].data,t.data):s[o].data===t.data){t=new c({start:t.start,stop:u.greaterThan(s[o].stop,t.stop)?s[o].stop:t.stop,isStartIncluded:t.isStartIncluded,isStopIncluded:u.greaterThan(s[o].stop,t.stop)?s[o].isStopIncluded:t.isStopIncluded,data:t.data});s.splice(o,1)}else{s[o]=new c({start:t.stop,stop:s[o].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:s[o].isStopIncluded,data:s[o].data});if(s[o].isEmpty){s.splice(o,1)}else{break}}}else{break}}s.splice(o,0,t);this._changedEvent.raiseEvent(this)};f.prototype.removeInterval=function(t){if(!r(t)){throw new n("interval is required")}if(t.isEmpty){return false}var i=false;var a=this._intervals;var o=e(a,t,d);if(o<0){o=~o}var s=t.start;var l=t.stop;var f=t.isStartIncluded;var h=t.isStopIncluded;if(o>0){var p=a[o-1];var m=p.stop;if(u.greaterThan(m,s)||c.equals(m,s)&&p.isStopIncluded&&f){i=true;if(u.greaterThan(m,l)||p.isStopIncluded&&!h&&c.equals(m,l)){a.splice(o,0,new c({start:l,stop:m,isStartIncluded:!h,isStopIncluded:p.isStopIncluded,data:p.data}))}a[o-1]=new c({start:p.start,stop:s,isStartIncluded:p.isStartIncluded,isStopIncluded:!f,data:p.data})}}var v=a[o];if(o<a.length&&!f&&v.isStartIncluded&&s.equals(v.start)){i=true;a.splice(o,0,new c({start:v.start,stop:v.start,isStartIncluded:true,isStopIncluded:true,data:v.data}));++o;v=a[o]}while(o<a.length&&u.greaterThan(l,v.stop)){i=true;a.splice(o,1);v=a[o]}if(o<a.length&&l.equals(v.stop)){i=true;if(!h&&v.isStopIncluded){if(o+1<a.length&&a[o+1].start.equals(l)&&v.data===a[o+1].data){a.splice(o,1);v=new c({start:v.start,stop:v.stop,isStartIncluded:true,isStopIncluded:v.isStopIncluded,data:v.data})}else{v=new c({start:l,stop:l,isStartIncluded:true,isStopIncluded:true,data:v.data})}a[o]=v}else{a.splice(o,1)}}if(o<a.length&&(u.greaterThan(l,v.start)||l.equals(v.start)&&h&&v.isStartIncluded)){i=true;a[o]=new c({start:l,stop:v.stop,isStartIncluded:!h,isStopIncluded:v.isStopIncluded,data:v.data})}if(i){this._changedEvent.raiseEvent(this)}return i};f.prototype.intersect=function(e,t,i){if(!r(e)){throw new n("other is required.")}var a=0;var o=0;var s=new f;var l=this._intervals;var d=e._intervals;while(a<l.length&&o<d.length){var h=l[a];var p=d[o];if(u.lessThan(h.stop,p.start)){++a}else if(u.lessThan(p.stop,h.start)){++o}else{if(r(i)||(r(t)&&t(h.data,p.data)||!r(t)&&p.data===h.data)){var m=c.intersect(h,p,new c,i);if(!m.isEmpty){s.addInterval(m,t)}}if(u.lessThan(h.stop,p.stop)||h.stop.equals(p.stop)&&!h.isStopIncluded&&p.isStopIncluded){++a}else{++o}}}return s};f.fromJulianDateArray=function(e,i){if(!r(e)){throw new n("options is required.")}if(!r(e.julianDates)){throw new n("options.iso8601Array is required.")}if(!r(i)){i=new f}var a=e.julianDates;var o=a.length;var s=e.dataCallback;var u=t(e.isStartIncluded,true);var d=t(e.isStopIncluded,true);var h=t(e.leadingInterval,false);var p=t(e.trailingInterval,false);var m;var v=0;if(h){++v;m=new c({start:l.MINIMUM_VALUE,stop:a[0],isStartIncluded:true,isStopIncluded:!u});m.data=r(s)?s(m,i.length):i.length;i.addInterval(m)}for(var g=0;g<o-1;++g){var _=a[g];var y=a[g+1];m=new c({start:_,stop:y,isStartIncluded:i.length===v?u:true,isStopIncluded:g===o-2?d:false});m.data=r(s)?s(m,i.length):i.length;i.addInterval(m);_=y}if(p){m=new c({start:a[o-1],stop:l.MAXIMUM_VALUE,isStartIncluded:!d,isStopIncluded:true});m.data=r(s)?s(m,i.length):i.length;i.addInterval(m)}return i};var p=new o;var m=[0,31,28,31,30,31,30,31,31,30,31,30,31];function v(e,t,i){if(!r(i)){i=new u}u.toGregorianDate(e,p);var n=p.millisecond+t.millisecond;var a=p.second+t.second;var o=p.minute+t.minute;var l=p.hour+t.hour;var c=p.day+t.day;var d=p.month+t.month;var f=p.year+t.year;if(n>=1e3){a+=Math.floor(n/1e3);n=n%1e3}if(a>=60){o+=Math.floor(a/60);a=a%60}if(o>=60){l+=Math.floor(o/60);o=o%60}if(l>=24){c+=Math.floor(l/24);l=l%24}m[2]=s(f)?29:28;while(c>m[d]||d>=13){if(c>m[d]){c-=m[d];++d}if(d>=13){--d;f+=Math.floor(d/12);d=d%12;++d}m[2]=s(f)?29:28}p.millisecond=n;p.second=a;p.minute=o;p.hour=l;p.day=c;p.month=d;p.year=f;return u.fromGregorianDate(p,i)}var g=new u;var _=/P(?:([\d.,]+)Y)?(?:([\d.,]+)M)?(?:([\d.,]+)W)?(?:([\d.,]+)D)?(?:T(?:([\d.,]+)H)?(?:([\d.,]+)M)?(?:([\d.,]+)S)?)?/;function y(e,t){if(!r(e)||e.length===0){return false}t.year=0;t.month=0;t.day=0;t.hour=0;t.minute=0;t.second=0;t.millisecond=0;if(e[0]==="P"){var i=e.match(_);if(!r(i)){return false}if(r(i[1])){t.year=Number(i[1].replace(",","."))}if(r(i[2])){t.month=Number(i[2].replace(",","."))}if(r(i[3])){t.day=Number(i[3].replace(",","."))*7}if(r(i[4])){t.day+=Number(i[4].replace(",","."))}if(r(i[5])){t.hour=Number(i[5].replace(",","."))}if(r(i[6])){t.minute=Number(i[6].replace(",","."))}if(r(i[7])){var n=Number(i[7].replace(",","."));t.second=Math.floor(n);t.millisecond=n%1*1e3}}else{if(e[e.length-1]!=="Z"){e+="Z"}u.toGregorianDate(u.fromIso8601(e,g),t)}return t.year||t.month||t.day||t.hour||t.minute||t.second||t.millisecond}var b=new o;f.fromIso8601=function(e,t){if(!r(e)){throw new n("options is required.")}if(!r(e.iso8601)){throw new n("options.iso8601 is required.")}var i=e.iso8601.split("/");var a=u.fromIso8601(i[0]);var o=u.fromIso8601(i[1]);var s=[];if(!y(i[2],b)){s.push(a,o)}else{var l=u.clone(a);s.push(l);while(u.compare(l,o)<0){l=v(l,b);var c=u.compare(o,l)<=0;if(c){u.clone(o,l)}s.push(l)}}return f.fromJulianDateArray({julianDates:s,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};f.fromIso8601DateArray=function(e,t){if(!r(e)){throw new n("options is required.")}if(!r(e.iso8601Dates)){throw new n("options.iso8601Dates is required.")}return f.fromJulianDateArray({julianDates:e.iso8601Dates.map(function(e){return u.fromIso8601(e)}),isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};f.fromIso8601DurationArray=function(e,i){if(!r(e)){throw new n("options is required.")}if(!r(e.epoch)){throw new n("options.epoch is required.")}if(!r(e.iso8601Durations)){throw new n("options.iso8601Durations is required.")}var a=e.epoch;var o=e.iso8601Durations;var s=t(e.relativeToPrevious,false);var l=[];var u,c;var d=o.length;for(var h=0;h<d;++h){if(y(o[h],b)||h===0){if(s&&r(c)){u=v(c,b)}else{u=v(a,b)}l.push(u);c=u}}return f.fromJulianDateArray({julianDates:l,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},i)};return f});define("Core/TranslationRotationScale",["./Cartesian3","./defaultValue","./defined","./Quaternion"],function(e,t,r,i){"use strict";var n=new e(1,1,1);var a=e.ZERO;var o=i.IDENTITY;var s=function(r,s,l){this.translation=e.clone(t(r,a));this.rotation=i.clone(t(s,o));this.scale=e.clone(t(l,n))};s.prototype.equals=function(t){return this===t||r(t)&&e.equals(this.translation,t.translation)&&i.equals(this.rotation,t.rotation)&&e.equals(this.scale,t.scale)};return s});define("Core/VideoSynchronizer",["./defaultValue","./defined","./defineProperties","./destroyObject","./Iso8601","./JulianDate"],function(e,t,r,i,n,a){"use strict";function o(t){t=e(t,e.EMPTY_OBJECT);this._clock=undefined;this._element=undefined;this._clockSubscription=undefined;this._seekFunction=undefined;this.clock=t.clock;this.element=t.element;this.epoch=e(t.epoch,n.MINIMUM_VALUE);this.tolerance=e(t.tolerance,1);this._seeking=false;this._seekFunction=undefined;this._firstTickAfterSeek=false}r(o.prototype,{clock:{get:function(){return this._clock},set:function(e){var r=this._clock;if(r===e){return}if(t(r)){this._clockSubscription();this._clockSubscription=undefined}if(t(e)){this._clockSubscription=e.onTick.addEventListener(o.prototype._onTick,this)}this._clock=e}},element:{get:function(){return this._element},set:function(e){var r=this._element;if(r===e){return}if(t(r)){r.removeEventListener("seeked",this._seekFunction,false)}if(t(e)){this._seeking=false;this._seekFunction=s(this);e.addEventListener("seeked",this._seekFunction,false)}this._element=e;this._seeking=false;this._firstTickAfterSeek=false}}});o.prototype.destroy=function(){this.element=undefined;this.clock=undefined;return i(this)};o.prototype.isDestroyed=function(){return false};o.prototype._onTick=function(r){var i=this._element;if(!t(i)||i.readyState<2){return}var o=i.paused;var s=r.shouldAnimate;if(s===o){if(s){i.play()}else{i.pause()}}if(this._seeking||this._firstTickAfterSeek){this._firstTickAfterSeek=false;return}i.playbackRate=r.multiplier;var l=r.currentTime;var u=e(this.epoch,n.MINIMUM_VALUE);var c=a.secondsDifference(l,u);var d=i.duration;var f;var h=i.currentTime;if(i.loop){c=c%d;if(c<0){c=d-c}f=c}else if(c>d){f=d}else if(c<0){f=0}else{f=c}var p=s?e(this.tolerance,1):.001;if(Math.abs(f-h)>p){this._seeking=true;i.currentTime=f}};function s(e){return function(){e._seeking=false;e._firstTickAfterSeek=true}}return o});define("Core/VRTheWorldTerrainProvider",["../ThirdParty/when","./Credit","./defaultValue","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./Ellipsoid","./Event","./GeographicTilingScheme","./getImagePixels","./HeightmapTerrainData","./loadImage","./loadXML","./Math","./Rectangle","./Request","./RequestType","./TerrainProvider","./TileProviderError"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y){"use strict";function b(e,t){this.rectangle=e;this.maxLevel=t}function w(n){n=r(n,r.EMPTY_OBJECT);if(!i(n.url)){throw new o("options.url is required.")}this._url=n.url;if(this._url.length>0&&this._url[this._url.length-1]!=="/"){this._url+="/"}this._errorEvent=new l;this._ready=false;this._readyPromise=e.defer();this._proxy=n.proxy;this._terrainDataStructure={heightScale:1/1e3,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:true,lowestEncodedHeight:0,highestEncodedHeight:256*256*256-1};var a=n.credit;if(typeof a==="string"){a=new t(a)}this._credit=a;this._tilingScheme=undefined;this._rectangles=[];var c=this;var d;var f=r(n.ellipsoid,s.WGS84);function v(e){var t=e.getElementsByTagName("SRS")[0].textContent;if(t==="EPSG:4326"){c._tilingScheme=new u({ellipsoid:f})}else{g("SRS "+t+" is not supported.");return}var r=e.getElementsByTagName("TileFormat")[0];c._heightmapWidth=parseInt(r.getAttribute("width"),10);c._heightmapHeight=parseInt(r.getAttribute("height"),10);c._levelZeroMaximumGeometricError=_.getEstimatedLevelZeroGeometricErrorForAHeightmap(f,Math.min(c._heightmapWidth,c._heightmapHeight),c._tilingScheme.getNumberOfXTilesAtLevel(0));var i=e.getElementsByTagName("DataExtent");for(var n=0;n<i.length;++n){var a=i[n];var o=p.toRadians(parseFloat(a.getAttribute("minx")));var s=p.toRadians(parseFloat(a.getAttribute("miny")));var l=p.toRadians(parseFloat(a.getAttribute("maxx")));var d=p.toRadians(parseFloat(a.getAttribute("maxy")));var h=parseInt(a.getAttribute("maxlevel"),10);c._rectangles.push(new b(new m(o,s,l,d),h))}c._ready=true;c._readyPromise.resolve(true)}function g(e){var t=r(e,"An error occurred while accessing "+c._url+".");d=y.handleError(d,c,c._errorEvent,t,undefined,undefined,undefined,w)}function w(){e(h(c._url),v,g)}w()}n(w.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){if(!this.ready){throw new o("requestTileGeometry must not be called before ready returns true.")}return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){return false}},hasVertexNormals:{get:function(){return false}}});w.prototype.requestTileGeometry=function(t,r,n,s){if(!this.ready){throw new o("requestTileGeometry must not be called before ready returns true.")}var l=this._tilingScheme.getNumberOfYTilesAtLevel(n);var u=this._url+n+"/"+t+"/"+(l-r-1)+".tif?cesium=true";var h=this._proxy;if(i(h)){u=h.getURL(u)}if(typeof s==="boolean"){a("throttleRequests","The throttleRequest parameter for requestTileGeometry was deprecated in Cesium 1.35.  It will be removed in 1.37.");s=new v({throttle:s,throttleByServer:s,type:g.TERRAIN})}var p=f(u,undefined,s);if(!i(p)){return undefined}var m=this;return e(p,function(e){return new d({buffer:c(e),width:m._heightmapWidth,height:m._heightmapHeight,childTileMask:S(m,t,r,n),structure:m._terrainDataStructure})})};w.prototype.getLevelMaximumGeometricError=function(e){if(!this.ready){throw new o("requestTileGeometry must not be called before ready returns true.")}return this._levelZeroMaximumGeometricError/(1<<e)};var C=new m;function S(e,t,r,n){var a=e._tilingScheme;var o=e._rectangles;var s=a.tileXYToRectangle(t,r,n);var l=0;for(var u=0;u<o.length&&l!==15;++u){var c=o[u];if(c.maxLevel<=n){continue}var d=c.rectangle;var f=m.intersection(d,s,C);if(i(f)){if(T(a,d,t*2,r*2,n+1)){l|=4}if(T(a,d,t*2+1,r*2,n+1)){l|=8}if(T(a,d,t*2,r*2+1,n+1)){l|=1}if(T(a,d,t*2+1,r*2+1,n+1)){l|=2}}}return l}function T(e,t,r,n,a){var o=e.tileXYToRectangle(r,n,a);return i(m.intersection(o,t,C))}w.prototype.getTileDataAvailable=function(e,t,r){return undefined};return w});define("Core/WallGeometryLibrary",["./Cartographic","./defined","./EllipsoidTangentPlane","./Math","./PolygonPipeline","./PolylinePipeline","./WindingOrder"],function(e,t,r,i,n,a,o){"use strict";var s={};function l(e,t){return i.equalsEpsilon(e.latitude,t.latitude,i.EPSILON14)&&i.equalsEpsilon(e.longitude,t.longitude,i.EPSILON14)}var u=new e;var c=new e;function d(r,i,n,a){var o=i.length;if(o<2){return}var s=t(a);var d=t(n);var f=true;var h=new Array(o);var p=new Array(o);var m=new Array(o);var v=i[0];h[0]=v;var g=r.cartesianToCartographic(v,u);if(d){g.height=n[0]}f=f&&g.height<=0;p[0]=g.height;if(s){m[0]=a[0]}else{m[0]=0}var _=1;for(var y=1;y<o;++y){var b=i[y];var w=r.cartesianToCartographic(b,c);if(d){w.height=n[y]}f=f&&w.height<=0;if(!l(g,w)){h[_]=b;p[_]=w.height;if(s){m[_]=a[y]}else{m[_]=0}e.clone(w,g);++_}else if(g.height<w.height){p[_-1]=w.height}}if(f||_<2){return}h.length=_;p.length=_;m.length=_;return{positions:h,topHeights:p,bottomHeights:m}}var f=new Array(2);var h=new Array(2);var p={positions:undefined,height:undefined,granularity:undefined,ellipsoid:undefined};s.computePositions=function(e,s,l,u,c,m){var v=d(e,s,l,u);if(!t(v)){return}s=v.positions;l=v.topHeights;u=v.bottomHeights;if(s.length>=3){var g=r.fromPoints(s,e);var _=g.projectPointsOntoPlane(s);if(n.computeWindingOrder2D(_)===o.CLOCKWISE){s.reverse();l.reverse();u.reverse()}}var y=s.length;var b=y-2;var w;var C;var S=i.chordLength(c,e.maximumRadius);var T=p;T.minDistance=S;T.ellipsoid=e;if(m){var E=0;var x;for(x=0;x<y-1;x++){E+=a.numberOfPoints(s[x],s[x+1],S)+1}w=new Float64Array(E*3);C=new Float64Array(E*3);var P=f;var A=h;T.positions=P;T.height=A;var O=0;for(x=0;x<y-1;x++){P[0]=s[x];P[1]=s[x+1];A[0]=l[x];A[1]=l[x+1];var D=a.generateArc(T);w.set(D,O);A[0]=u[x];A[1]=u[x+1];C.set(a.generateArc(T),O);O+=D.length}}else{T.positions=s;T.height=l;w=new Float64Array(a.generateArc(T));T.height=u;C=new Float64Array(a.generateArc(T))}return{bottomPositions:C,topPositions:w,numCorners:b}};return s});define("Core/WallGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat","./WallGeometryLibrary"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";var m=new t;var v=new t;var g=new t;var _=new t;var y=new t;var b=new t;var w=new t;var C=new t;function S(e){e=i(e,i.EMPTY_OBJECT);var r=e.positions;var s=e.maximumHeights;var l=e.minimumHeights;if(!n(r)){throw new a("options.positions is required.")}if(n(s)&&s.length!==r.length){throw new a("options.positions and options.maximumHeights must have the same length.")}if(n(l)&&l.length!==r.length){throw new a("options.positions and options.minimumHeights must have the same length.")}var u=i(e.vertexFormat,h.DEFAULT);var c=i(e.granularity,d.RADIANS_PER_DEGREE);var f=i(e.ellipsoid,o.WGS84);this._positions=r;this._minimumHeights=l;this._maximumHeights=s;this._vertexFormat=h.clone(u);this._granularity=c;this._ellipsoid=o.clone(f);this._workerName="createWallGeometry";var p=1+r.length*t.packedLength+2;if(n(l)){p+=l.length}if(n(s)){p+=s.length}this.packedLength=p+o.packedLength+h.packedLength+1}S.pack=function(e,r,s){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}s=i(s,0);var l;var u=e._positions;var c=u.length;r[s++]=c;for(l=0;l<c;++l,s+=t.packedLength){t.pack(u[l],r,s)}var d=e._minimumHeights;c=n(d)?d.length:0;r[s++]=c;if(n(d)){for(l=0;l<c;++l){r[s++]=d[l]}}var f=e._maximumHeights;c=n(f)?f.length:0;r[s++]=c;if(n(f)){for(l=0;l<c;++l){r[s++]=f[l]}}o.pack(e._ellipsoid,r,s);s+=o.packedLength;h.pack(e._vertexFormat,r,s);s+=h.packedLength;r[s]=e._granularity;return r};var T=o.clone(o.UNIT_SPHERE);var E=new h;var x={positions:undefined,minimumHeights:undefined,maximumHeights:undefined,ellipsoid:T,vertexFormat:E,granularity:undefined};S.unpack=function(e,r,s){if(!n(e)){throw new a("array is required")}r=i(r,0);var l;var u=e[r++];var c=new Array(u);for(l=0;l<u;++l,r+=t.packedLength){c[l]=t.unpack(e,r)}u=e[r++];var d;if(u>0){d=new Array(u);for(l=0;l<u;++l){d[l]=e[r++]}}u=e[r++];var f;if(u>0){f=new Array(u);for(l=0;l<u;++l){f[l]=e[r++]}}var p=o.unpack(e,r,T);r+=o.packedLength;var m=h.unpack(e,r,E);r+=h.packedLength;var v=e[r];if(!n(s)){x.positions=c;x.minimumHeights=d;x.maximumHeights=f;x.granularity=v;return new S(x)}s._positions=c;s._minimumHeights=d;s._maximumHeights=f;s._ellipsoid=o.clone(p,s._ellipsoid);s._vertexFormat=h.clone(m,s._vertexFormat);s._granularity=v;return s};S.fromConstantHeights=function(e){e=i(e,i.EMPTY_OBJECT);var t=e.positions;if(!n(t)){throw new a("options.positions is required.")}var r;var o;var s=e.minimumHeight;var l=e.maximumHeight;var u=n(s);var c=n(l);if(u||c){var d=t.length;r=u?new Array(d):undefined;o=c?new Array(d):undefined;for(var f=0;f<d;++f){if(u){r[f]=s}if(c){o[f]=l}}}var h={positions:t,maximumHeights:o,minimumHeights:r,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat};return new S(h)};S.createGeometry=function(i){var a=i._positions;var o=i._minimumHeights;var h=i._maximumHeights;var S=i._vertexFormat;var T=i._granularity;var E=i._ellipsoid;var x=p.computePositions(E,a,h,o,T,true);if(!n(x)){return}var P=x.bottomPositions;var A=x.topPositions;var O=x.numCorners;var D=A.length;var I=D*2;var M=S.position?new Float64Array(I):undefined;var R=S.normal?new Float32Array(I):undefined;var L=S.tangent?new Float32Array(I):undefined;var N=S.bitangent?new Float32Array(I):undefined;var k=S.st?new Float32Array(I/3*2):undefined;var F=0;var B=0;var U=0;var V=0;var z=0;var q=C;var G=w;var H=b;var j=true;D/=3;var W;var Y=0;var X=1/(D-a.length+1);for(W=0;W<D;++W){var Q=W*3;var Z=t.fromArray(A,Q,m);var K=t.fromArray(P,Q,v);if(S.position){M[F++]=K.x;M[F++]=K.y;M[F++]=K.z;M[F++]=Z.x;M[F++]=Z.y;M[F++]=Z.z}if(S.st){k[z++]=Y;k[z++]=0;k[z++]=Y;k[z++]=1}if(S.normal||S.tangent||S.bitangent){var J;var $=t.clone(t.ZERO,y);var ee=E.scaleToGeodeticSurface(t.fromArray(A,Q,v),v);if(W+1<D){J=E.scaleToGeodeticSurface(t.fromArray(A,Q+3,g),g);$=t.fromArray(A,Q+3,y)}if(j){var te=t.subtract($,Z,_);var re=t.subtract(ee,Z,m);q=t.normalize(t.cross(re,te,q),q);j=false}if(t.equalsEpsilon(J,ee,d.EPSILON10)){j=true}else{Y+=X;if(S.tangent){G=t.normalize(t.subtract(J,ee,G),G)}if(S.bitangent){H=t.normalize(t.cross(q,G,H),H)}}if(S.normal){R[B++]=q.x;R[B++]=q.y;R[B++]=q.z;R[B++]=q.x;R[B++]=q.y;R[B++]=q.z}if(S.tangent){L[V++]=G.x;L[V++]=G.y;L[V++]=G.z;L[V++]=G.x;L[V++]=G.y;L[V++]=G.z}if(S.bitangent){N[U++]=H.x;N[U++]=H.y;N[U++]=H.z;N[U++]=H.x;N[U++]=H.y;N[U++]=H.z}}}var ie=new u;if(S.position){ie.position=new l({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:M})}if(S.normal){ie.normal=new l({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:R})}if(S.tangent){ie.tangent=new l({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:L})}if(S.bitangent){ie.bitangent=new l({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:N})}if(S.st){ie.st=new l({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:k})}var ne=I/3;I-=6*(O+1);var ae=c.createTypedArray(ne,I);var oe=0;for(W=0;W<ne-2;W+=2){var se=W;var le=W+2;var ue=t.fromArray(M,se*3,m);var ce=t.fromArray(M,le*3,v);if(t.equalsEpsilon(ue,ce,d.EPSILON10)){continue}var de=W+1;var fe=W+3;ae[oe++]=de;ae[oe++]=se;ae[oe++]=fe;ae[oe++]=fe;ae[oe++]=se;ae[oe++]=le}return new s({attributes:ie,indices:ae,primitiveType:f.TRIANGLES,boundingSphere:new e.fromVertices(M)})};return S});define("Core/WallOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./WallGeometryLibrary"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";var p=new t;var m=new t;function v(e){e=i(e,i.EMPTY_OBJECT);var r=e.positions;var s=e.maximumHeights;var l=e.minimumHeights;if(!n(r)){throw new a("options.positions is required.")}if(n(s)&&s.length!==r.length){throw new a("options.positions and options.maximumHeights must have the same length.")}if(n(l)&&l.length!==r.length){throw new a("options.positions and options.minimumHeights must have the same length.")}var u=i(e.granularity,d.RADIANS_PER_DEGREE);var c=i(e.ellipsoid,o.WGS84);this._positions=r;this._minimumHeights=l;this._maximumHeights=s;this._granularity=u;this._ellipsoid=o.clone(c);this._workerName="createWallOutlineGeometry";var f=1+r.length*t.packedLength+2;if(n(l)){f+=l.length}if(n(s)){f+=s.length}this.packedLength=f+o.packedLength+1}v.pack=function(e,r,s){if(!n(e)){throw new a("value is required")}if(!n(r)){throw new a("array is required")}s=i(s,0);var l;var u=e._positions;var c=u.length;r[s++]=c;for(l=0;l<c;++l,s+=t.packedLength){t.pack(u[l],r,s)}var d=e._minimumHeights;c=n(d)?d.length:0;r[s++]=c;if(n(d)){for(l=0;l<c;++l){r[s++]=d[l]}}var f=e._maximumHeights;c=n(f)?f.length:0;r[s++]=c;if(n(f)){for(l=0;l<c;++l){r[s++]=f[l]}}o.pack(e._ellipsoid,r,s);s+=o.packedLength;r[s]=e._granularity;return r};var g=o.clone(o.UNIT_SPHERE);var _={positions:undefined,minimumHeights:undefined,maximumHeights:undefined,ellipsoid:g,granularity:undefined};v.unpack=function(e,r,s){if(!n(e)){throw new a("array is required")}r=i(r,0);var l;var u=e[r++];var c=new Array(u);for(l=0;l<u;++l,r+=t.packedLength){c[l]=t.unpack(e,r)}u=e[r++];var d;if(u>0){d=new Array(u);for(l=0;l<u;++l){d[l]=e[r++]}}u=e[r++];var f;if(u>0){f=new Array(u);for(l=0;l<u;++l){f[l]=e[r++]}}var h=o.unpack(e,r,g);r+=o.packedLength;var p=e[r];if(!n(s)){_.positions=c;_.minimumHeights=d;_.maximumHeights=f;_.granularity=p;return new v(_)}s._positions=c;s._minimumHeights=d;s._maximumHeights=f;s._ellipsoid=o.clone(h,s._ellipsoid);s._granularity=p;return s};v.fromConstantHeights=function(e){e=i(e,i.EMPTY_OBJECT);var t=e.positions;if(!n(t)){throw new a("options.positions is required.")}var r;var o;var s=e.minimumHeight;var l=e.maximumHeight;var u=n(s);var c=n(l);if(u||c){var d=t.length;r=u?new Array(d):undefined;o=c?new Array(d):undefined;for(var f=0;f<d;++f){if(u){r[f]=s}if(c){o[f]=l}}}var h={positions:t,maximumHeights:o,minimumHeights:r,ellipsoid:e.ellipsoid};return new v(h)};v.createGeometry=function(i){var a=i._positions;var o=i._minimumHeights;var v=i._maximumHeights;var g=i._granularity;var _=i._ellipsoid;var y=h.computePositions(_,a,v,o,g,false);if(!n(y)){return}var b=y.bottomPositions;var w=y.topPositions;var C=w.length;var S=C*2;var T=new Float64Array(S);var E=0;C/=3;var x;for(x=0;x<C;++x){var P=x*3;var A=t.fromArray(w,P,p);var O=t.fromArray(b,P,m);T[E++]=O.x;T[E++]=O.y;T[E++]=O.z;T[E++]=A.x;T[E++]=A.y;T[E++]=A.z}var D=new u({position:new l({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:T})});var I=S/3;S=2*I-4+I;var M=c.createTypedArray(I,S);var R=0;for(x=0;x<I-2;x+=2){var L=x;var N=x+2;var k=t.fromArray(T,L*3,p);var F=t.fromArray(T,N*3,m);if(t.equalsEpsilon(k,F,d.EPSILON10)){continue}var B=x+1;var U=x+3;M[R++]=B;M[R++]=L;M[R++]=B;M[R++]=U;M[R++]=L;M[R++]=N}M[R++]=I-2;M[R++]=I-1;return new s({attributes:D,indices:M,primitiveType:f.LINES,boundingSphere:new e.fromVertices(T)})};return v});define("Core/WebMercatorTilingScheme",["./Cartesian2","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Rectangle","./WebMercatorProjection"],function(e,t,r,i,n,a,o){"use strict";function s(i){i=t(i,{});this._ellipsoid=t(i.ellipsoid,n.WGS84);this._numberOfLevelZeroTilesX=t(i.numberOfLevelZeroTilesX,1);this._numberOfLevelZeroTilesY=t(i.numberOfLevelZeroTilesY,1);this._projection=new o(this._ellipsoid);if(r(i.rectangleSouthwestInMeters)&&r(i.rectangleNortheastInMeters)){this._rectangleSouthwestInMeters=i.rectangleSouthwestInMeters;this._rectangleNortheastInMeters=i.rectangleNortheastInMeters}else{var s=this._ellipsoid.maximumRadius*Math.PI;this._rectangleSouthwestInMeters=new e(-s,-s);this._rectangleNortheastInMeters=new e(s,s)}var l=this._projection.unproject(this._rectangleSouthwestInMeters);var u=this._projection.unproject(this._rectangleNortheastInMeters);this._rectangle=new a(l.longitude,l.latitude,u.longitude,u.latitude)}i(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});s.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e};s.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e};s.prototype.rectangleToNativeRectangle=function(e,t){var i=this._projection;var n=i.project(a.southwest(e));var o=i.project(a.northeast(e));if(!r(t)){return new a(n.x,n.y,o.x,o.y)}t.west=n.x;t.south=n.y;t.east=o.x;t.north=o.y;return t};s.prototype.tileXYToNativeRectangle=function(e,t,i,n){var o=this.getNumberOfXTilesAtLevel(i);var s=this.getNumberOfYTilesAtLevel(i);var l=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/o;var u=this._rectangleSouthwestInMeters.x+e*l;var c=this._rectangleSouthwestInMeters.x+(e+1)*l;var d=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/s;var f=this._rectangleNortheastInMeters.y-t*d;var h=this._rectangleNortheastInMeters.y-(t+1)*d;if(!r(n)){return new a(u,h,c,f)}n.west=u;n.south=h;n.east=c;n.north=f;return n};s.prototype.tileXYToRectangle=function(t,r,i,n){var a=this.tileXYToNativeRectangle(t,r,i,n);var o=this._projection;var s=o.unproject(new e(a.west,a.south));var l=o.unproject(new e(a.east,a.north));a.west=s.longitude;a.south=s.latitude;a.east=l.longitude;a.north=l.latitude;return a};s.prototype.positionToTileXY=function(t,i,n){var o=this._rectangle;if(!a.contains(o,t)){return undefined}var s=this.getNumberOfXTilesAtLevel(i);var l=this.getNumberOfYTilesAtLevel(i);var u=this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x;var c=u/s;var d=this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y;var f=d/l;var h=this._projection;var p=h.project(t);var m=p.x-this._rectangleSouthwestInMeters.x;var v=this._rectangleNortheastInMeters.y-p.y;var g=m/c|0;if(g>=s){g=s-1}var _=v/f|0;if(_>=l){_=l-1}if(!r(n)){return new e(g,_)}n.x=g;n.y=_;return n};return s});define("Core/WeightSpline",["./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./Spline"],function(e,t,r,i,n,a){"use strict";function o(r){r=t(r,t.EMPTY_OBJECT);var i=r.weights;var a=r.times;e.defined("weights",i);e.defined("times",a);e.typeOf.number.greaterThanOrEquals("weights.length",i.length,3);if(i.length%a.length!==0){throw new n("times.length must be a factor of weights.length.")}this._times=a;this._weights=i;this._count=i.length/a.length;this._lastTimeIndex=0}i(o.prototype,{times:{get:function(){return this._times}},weights:{get:function(){return this._weights}}});o.prototype.findTimeInterval=a.prototype.findTimeInterval;o.prototype.evaluate=function(e,t){var i=this.weights;var n=this.times;var a=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex);var o=(e-n[a])/(n[a+1]-n[a]);if(!r(t)){t=new Array(this._count)}for(var s=0;s<this._count;s++){var l=a*this._count+s;t[s]=i[l]*(1-o)+i[l+this._count]*o}return t};return o});define("Core/wrapFunction",["./DeveloperError"],function(e){"use strict";function t(t,r,i){if(typeof r!=="function"){throw new e("oldFunction is required to be a function.")}if(typeof i!=="function"){throw new e("oldFunction is required to be a function.")}return function(){i.apply(t,arguments);r.apply(t,arguments)}}return t});define("DataSources/ConstantProperty",["../Core/defined","../Core/defineProperties","../Core/Event"],function(e,t,r){"use strict";function i(e){this._value=undefined;this._hasClone=false;this._hasEquals=false;this._definitionChanged=new r;this.setValue(e)}t(i.prototype,{isConstant:{value:true},definitionChanged:{get:function(){return this._definitionChanged}}});i.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value};i.prototype.setValue=function(t){var r=this._value;if(r!==t){var i=e(t);var n=i&&typeof t.clone==="function";var a=i&&typeof t.equals==="function";var o=!a||!t.equals(r);if(o){this._hasClone=n;this._hasEquals=a;this._value=!n?t:t.clone(this._value);this._definitionChanged.raiseEvent(this)}}};i.prototype.equals=function(e){return this===e||e instanceof i&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))};i.prototype.valueOf=function(){return this._value};i.prototype.toString=function(){return String(this._value)};return i});define("DataSources/createPropertyDescriptor",["../Core/defaultValue","../Core/defined","./ConstantProperty"],function(e,t,r){"use strict";function i(e,r,i,n,a){return{configurable:n,get:function(){return this[r]},set:function(n){var o=this[r];var s=this[i];if(t(s)){s();this[i]=undefined}var l=n!==undefined;if(l&&(!t(n)||!t(n.getValue))&&t(a)){n=a(n)}if(o!==n){this[r]=n;this._definitionChanged.raiseEvent(this,e,n,o)}if(t(n)&&t(n.definitionChanged)){this[i]=n.definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this,e,n,n)},this)}}}}function n(e){return new r(e)}function a(t,r,a){return i(t,"_"+t.toString(),"_"+t.toString()+"Subscription",e(r,false),e(a,n))}return a});define("DataSources/BillboardGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(e,t,r,i,n,a){"use strict";function o(t){this._image=undefined;this._imageSubscription=undefined;this._imageSubRegion=undefined;this._imageSubRegionSubscription=undefined;this._width=undefined;this._widthSubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._scale=undefined;this._scaleSubscription=undefined;this._rotation=undefined;this._rotationSubscription=undefined;this._alignedAxis=undefined;this._alignedAxisSubscription=undefined;this._horizontalOrigin=undefined;this._horizontalOriginSubscription=undefined;this._verticalOrigin=undefined;this._verticalOriginSubscription=undefined;this._color=undefined;this._colorSubscription=undefined;this._eyeOffset=undefined;this._eyeOffsetSubscription=undefined;this._heightReference=undefined;this._heightReferenceSubscription=undefined;this._pixelOffset=undefined;this._pixelOffsetSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._scaleByDistance=undefined;this._scaleByDistanceSubscription=undefined;this._translucencyByDistance=undefined;this._translucencyByDistanceSubscription=undefined;this._pixelOffsetScaleByDistance=undefined;this._pixelOffsetScaleByDistanceSubscription=undefined;this._sizeInMeters=undefined;this._sizeInMetersSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._disableDepthTestDistance=undefined;this._disableDepthTestDistanceSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(o.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},image:a("image"),imageSubRegion:a("imageSubRegion"),scale:a("scale"),rotation:a("rotation"),alignedAxis:a("alignedAxis"),horizontalOrigin:a("horizontalOrigin"),verticalOrigin:a("verticalOrigin"),color:a("color"),eyeOffset:a("eyeOffset"),heightReference:a("heightReference"),pixelOffset:a("pixelOffset"),show:a("show"),width:a("width"),height:a("height"),scaleByDistance:a("scaleByDistance"),translucencyByDistance:a("translucencyByDistance"),pixelOffsetScaleByDistance:a("pixelOffsetScaleByDistance"),sizeInMeters:a("sizeInMeters"),distanceDisplayCondition:a("distanceDisplayCondition"),disableDepthTestDistance:a("disableDepthTestDistance")});o.prototype.clone=function(e){if(!t(e)){return new o(this)}e.color=this._color;e.eyeOffset=this._eyeOffset;e.heightReference=this._heightReference;e.horizontalOrigin=this._horizontalOrigin;e.image=this._image;e.imageSubRegion=this._imageSubRegion;e.pixelOffset=this._pixelOffset;e.scale=this._scale;e.rotation=this._rotation;e.alignedAxis=this._alignedAxis;e.show=this._show;e.verticalOrigin=this._verticalOrigin;e.width=this._width;e.height=this._height;e.scaleByDistance=this._scaleByDistance;e.translucencyByDistance=this._translucencyByDistance;e.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance;e.sizeInMeters=this._sizeInMeters;e.distanceDisplayCondition=this._distanceDisplayCondition;e.disableDepthTestDistance=this._disableDepthTestDistance;return e};o.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.color=e(this._color,r.color);this.eyeOffset=e(this._eyeOffset,r.eyeOffset);this.heightReference=e(this._heightReference,r.heightReference);this.horizontalOrigin=e(this._horizontalOrigin,r.horizontalOrigin);this.image=e(this._image,r.image);this.imageSubRegion=e(this._imageSubRegion,r.imageSubRegion);this.pixelOffset=e(this._pixelOffset,r.pixelOffset);this.scale=e(this._scale,r.scale);this.rotation=e(this._rotation,r.rotation);this.alignedAxis=e(this._alignedAxis,r.alignedAxis);this.show=e(this._show,r.show);this.verticalOrigin=e(this._verticalOrigin,r.verticalOrigin);this.width=e(this._width,r.width);this.height=e(this._height,r.height);this.scaleByDistance=e(this._scaleByDistance,r.scaleByDistance);this.translucencyByDistance=e(this._translucencyByDistance,r.translucencyByDistance);this.pixelOffsetScaleByDistance=e(this._pixelOffsetScaleByDistance,r.pixelOffsetScaleByDistance);this.sizeInMeters=e(this._sizeInMeters,r.sizeInMeters);this.distanceDisplayCondition=e(this._distanceDisplayCondition,r.distanceDisplayCondition);this.disableDepthTestDistance=e(this._disableDepthTestDistance,r.disableDepthTestDistance)};return o});define("Scene/HeightReference",["../Core/freezeObject"],function(e){"use strict";var t={NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2};return e(t)});define("Scene/HorizontalOrigin",["../Core/freezeObject"],function(e){"use strict";var t={CENTER:0,LEFT:1,RIGHT:-1};return e(t)});define("Scene/VerticalOrigin",["../Core/freezeObject"],function(e){"use strict";var t={CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1};return e(t)});define("DataSources/BoundingSphereState",["../Core/freezeObject"],function(e){"use strict";var t={DONE:0,PENDING:1,FAILED:2};return e(t)});define("DataSources/Property",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError"],function(e,t,r,i){"use strict";function n(){i.throwInstantiationError()}r(n.prototype,{isConstant:{get:i.throwInstantiationError},definitionChanged:{get:i.throwInstantiationError}});n.prototype.getValue=i.throwInstantiationError;n.prototype.equals=i.throwInstantiationError;n.equals=function(e,r){return e===r||t(e)&&e.equals(r)};n.arrayEquals=function(e,r){if(e===r){return true}if(!t(e)||!t(r)||e.length!==r.length){return false}var i=e.length;for(var a=0;a<i;a++){if(!n.equals(e[a],r[a])){return false}}return true};n.isConstant=function(e){return!t(e)||e.isConstant};n.getValueOrUndefined=function(e,r,i){return t(e)?e.getValue(r,i):undefined};n.getValueOrDefault=function(r,i,n,a){return t(r)?e(r.getValue(i,a),n):n};n.getValueOrClonedDefault=function(e,r,i,n){var a;if(t(e)){a=e.getValue(r,n)}if(!t(a)){a=i.clone(a)}return a};return n});define("DataSources/BillboardVisualizer",["../Core/AssociativeArray","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/VerticalOrigin","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";var m=n.WHITE;var v=i.ZERO;var g=c.NONE;var _=r.ZERO;var y=1;var b=0;var w=i.ZERO;var C=d.CENTER;var S=f.CENTER;var T=false;var E=0;var x=new i;var P=new n;var A=new i;var O=new r;var D=new u;var I=new u;var M=new u;var R=new t;var L=new l;function N(e){this.entity=e;this.billboard=undefined;this.textureValue=undefined}function k(t,r){if(!a(t)){throw new s("entityCluster is required.")}if(!a(r)){throw new s("entityCollection is required.")}r.collectionChanged.addEventListener(k.prototype._onCollectionChanged,this);this._cluster=t;this._entityCollection=r;this._items=new e;this._onCollectionChanged(r,r.values,[],[])}k.prototype.update=function(e){if(!a(e)){throw new s("time is required.")}var t=this._items.values;var r=this._cluster;for(var i=0,n=t.length;i<n;i++){var o=t[i];var l=o.entity;var u=l._billboard;var c;var d=o.billboard;var f=l.isShowing&&l.isAvailable(e)&&p.getValueOrDefault(u._show,e,true);if(f){x=p.getValueOrUndefined(l._position,e,x);c=p.getValueOrUndefined(u._image,e);f=a(x)&&a(c)}if(!f){F(o,l,r);continue}if(!p.isConstant(l._position)){r._clusterDirty=true}if(!a(d)){d=r.getBillboard(l);d.id=l;d.image=undefined;o.billboard=d}d.show=f;if(!a(d.image)||o.textureValue!==c){d.image=c;o.textureValue=c}d.position=x;d.color=p.getValueOrDefault(u._color,e,m,P);d.eyeOffset=p.getValueOrDefault(u._eyeOffset,e,v,A);d.heightReference=p.getValueOrDefault(u._heightReference,e,g);d.pixelOffset=p.getValueOrDefault(u._pixelOffset,e,_,O);d.scale=p.getValueOrDefault(u._scale,e,y);d.rotation=p.getValueOrDefault(u._rotation,e,b);d.alignedAxis=p.getValueOrDefault(u._alignedAxis,e,w);d.horizontalOrigin=p.getValueOrDefault(u._horizontalOrigin,e,C);d.verticalOrigin=p.getValueOrDefault(u._verticalOrigin,e,S);d.width=p.getValueOrUndefined(u._width,e);d.height=p.getValueOrUndefined(u._height,e);d.scaleByDistance=p.getValueOrUndefined(u._scaleByDistance,e,D);d.translucencyByDistance=p.getValueOrUndefined(u._translucencyByDistance,e,I);d.pixelOffsetScaleByDistance=p.getValueOrUndefined(u._pixelOffsetScaleByDistance,e,M);d.sizeInMeters=p.getValueOrDefault(u._sizeInMeters,e,T);d.distanceDisplayCondition=p.getValueOrUndefined(u._distanceDisplayCondition,e,L);d.disableDepthTestDistance=p.getValueOrDefault(u._disableDepthTestDistance,e,E);var h=p.getValueOrUndefined(u._imageSubRegion,e,R);if(a(h)){d.setImageSubRegion(d._imageId,h)}}return true};k.prototype.getBoundingSphere=function(e,t){if(!a(e)){throw new s("entity is required.")}if(!a(t)){throw new s("result is required.")}var r=this._items.get(e.id);if(!a(r)||!a(r.billboard)){return h.FAILED}var n=r.billboard;if(n.heightReference===c.NONE){t.center=i.clone(n.position,t.center)}else{if(!a(n._clampedPosition)){return h.PENDING}t.center=i.clone(n._clampedPosition,t.center)}t.radius=0;return h.DONE};k.prototype.isDestroyed=function(){return false};k.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(k.prototype._onCollectionChanged,this);var e=this._entityCollection.values;for(var t=0;t<e.length;t++){this._cluster.removeBillboard(e[t])}return o(this)};k.prototype._onCollectionChanged=function(e,t,r,i){var n;var o;var s=this._items;var l=this._cluster;for(n=t.length-1;n>-1;n--){o=t[n];if(a(o._billboard)&&a(o._position)){s.set(o.id,new N(o))}}for(n=i.length-1;n>-1;n--){o=i[n];if(a(o._billboard)&&a(o._position)){if(!s.contains(o.id)){s.set(o.id,new N(o))}}else{F(s.get(o.id),o,l);s.remove(o.id)}}for(n=r.length-1;n>-1;n--){o=r[n];F(s.get(o.id),o,l);s.remove(o.id)}};function F(e,t,r){if(a(e)){e.billboard=undefined;r.removeBillboard(t)}}return k});define("Shaders/Appearances/AllMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n    mat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = tangentToEyeMatrix;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"});define("Shaders/Appearances/AllMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec3 tangent;\nattribute vec3 bitangent;\nattribute vec2 st;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_tangentEC = czm_normal * tangent;                       // tangent in eye coordinates\n    v_bitangentEC = czm_normal * bitangent;                   // bitangent in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Shaders/Appearances/BasicMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC; \n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n    \n#ifdef FLAT    \n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"});define("Shaders/Appearances/BasicMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main() \n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    \n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Shaders/Appearances/TexturedMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC; \n\n    vec3 normalEC = normalize(v_normalEC);;\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n    \n#ifdef FLAT    \n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"});define("Shaders/Appearances/TexturedMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec2 st;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\n\nvoid main() \n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_st = st;\n    \n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Scene/BlendEquation",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={ADD:t.FUNC_ADD,SUBTRACT:t.FUNC_SUBTRACT,REVERSE_SUBTRACT:t.FUNC_REVERSE_SUBTRACT,MIN:t.MIN,MAX:t.MAX};return e(r)});define("Scene/BlendFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={ZERO:t.ZERO,ONE:t.ONE,SOURCE_COLOR:t.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:t.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:t.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:t.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:t.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:t.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:t.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:t.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:t.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:t.ONE_MINUS_CONSTANT_ALPHA,CONSTANT_ALPHA:t.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:t.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:t.SRC_ALPHA_SATURATE};return e(r)});define("Scene/BlendingState",["../Core/freezeObject","./BlendEquation","./BlendFunction"],function(e,t,r){"use strict";var i={DISABLED:e({enabled:false}),ALPHA_BLEND:e({enabled:true,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:r.SOURCE_ALPHA,functionSourceAlpha:r.SOURCE_ALPHA,functionDestinationRgb:r.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:r.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:e({enabled:true,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:r.ONE,functionSourceAlpha:r.ONE,functionDestinationRgb:r.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:r.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:e({enabled:true,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:r.SOURCE_ALPHA,functionSourceAlpha:r.SOURCE_ALPHA,functionDestinationRgb:r.ONE,functionDestinationAlpha:r.ONE})};return e(i)});define("Scene/CullFace",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={FRONT:t.FRONT,BACK:t.BACK,FRONT_AND_BACK:t.FRONT_AND_BACK};return e(r)});define("Scene/Appearance",["../Core/clone","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","./BlendingState","./CullFace"],function(e,t,r,i,n,a,o){"use strict";function s(e){e=r(e,r.EMPTY_OBJECT);this.material=e.material;this.translucent=r(e.translucent,true);this._vertexShaderSource=e.vertexShaderSource;this._fragmentShaderSource=e.fragmentShaderSource;this._renderState=e.renderState;this._closed=r(e.closed,false)}n(s.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}});s.prototype.getFragmentShaderSource=function(){var e=[];if(this.flat){e.push("#define FLAT")}if(this.faceForward){e.push("#define FACE_FORWARD")}if(i(this.material)){e.push(this.material.shaderSource)}e.push(this.fragmentShaderSource);return e.join("\n")};s.prototype.isTranslucent=function(){return i(this.material)&&this.material.isTranslucent()||!i(this.material)&&this.translucent};s.prototype.getRenderState=function(){var t=this.isTranslucent();var r=e(this.renderState,false);if(t){r.depthMask=false;r.blending=a.ALPHA_BLEND}else{r.depthMask=true}return r};s.getDefaultRenderState=function(e,r,n){var s={depthTest:{enabled:true}};if(e){s.depthMask=false;s.blending=a.ALPHA_BLEND}if(r){s.cull={enabled:true,face:o.BACK}}if(i(n)){s=t(n,s,true)}return s};return s});define("Renderer/ContextLimits",["../Core/defineProperties"],function(e){"use strict";var t={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_highpFloatSupported:false,_highpIntSupported:false};e(t,{maximumCombinedTextureImageUnits:{get:function(){return t._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return t._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return t._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return t._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return t._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return t._maximumTextureSize}},maximumVaryingVectors:{get:function(){return t._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return t._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return t._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return t._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return t._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return t._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return t._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return t._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return t._maximumViewportWidth}},maximumViewportHeight:{get:function(){return t._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return t._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return t._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return t._maximumColorAttachments}},highpFloatSupported:{get:function(){return t._highpFloatSupported}},highpIntSupported:{get:function(){return t._highpIntSupported}}});return t});define("Renderer/CubeMapFace",["../Core/defaultValue","../Core/defineProperties","../Core/DeveloperError","./PixelDatatype"],function(e,t,r,i){"use strict";function n(e,t,r,i,n,a,o,s,l){this._gl=e;this._texture=t;this._textureTarget=r;this._targetFace=i;this._pixelFormat=n;this._pixelDatatype=a;this._size=o;this._preMultiplyAlpha=s;this._flipY=l}t(n.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}});n.prototype.copyFrom=function(t,i,n){i=e(i,0);n=e(n,0);if(!t){throw new r("source is required.")}if(i<0){throw new r("xOffset must be greater than or equal to zero.")}if(n<0){throw new r("yOffset must be greater than or equal to zero.")}if(i+t.width>this._size){throw new r("xOffset + source.width must be less than or equal to width.")}if(n+t.height>this._size){throw new r("yOffset + source.height must be less than or equal to height.")}var a=this._gl;var o=this._textureTarget;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._preMultiplyAlpha);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,this._flipY);a.activeTexture(a.TEXTURE0);a.bindTexture(o,this._texture);if(t.arrayBufferView){a.texSubImage2D(this._targetFace,0,i,n,t.width,t.height,this._pixelFormat,this._pixelDatatype,t.arrayBufferView)}else{a.texSubImage2D(this._targetFace,0,i,n,this._pixelFormat,this._pixelDatatype,t)}a.bindTexture(o,null)};n.prototype.copyFromFramebuffer=function(t,n,a,o,s,l){t=e(t,0);n=e(n,0);a=e(a,0);o=e(o,0);s=e(s,this._size);l=e(l,this._size);if(t<0){throw new r("xOffset must be greater than or equal to zero.")}if(n<0){throw new r("yOffset must be greater than or equal to zero.")}if(a<0){throw new r("framebufferXOffset must be greater than or equal to zero.")}if(o<0){throw new r("framebufferYOffset must be greater than or equal to zero.")}if(t+s>this._size){throw new r("xOffset + source.width must be less than or equal to width.")}if(n+l>this._size){throw new r("yOffset + source.height must be less than or equal to height.")}if(this._pixelDatatype===i.FLOAT){throw new r("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.")}var u=this._gl;var c=this._textureTarget;u.activeTexture(u.TEXTURE0);u.bindTexture(c,this._texture);u.copyTexSubImage2D(this._targetFace,0,t,n,a,o,s,l);u.bindTexture(c,null)};return n});define("Renderer/MipmapHint",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={DONT_CARE:t.DONT_CARE,FASTEST:t.FASTEST,NICEST:t.NICEST,validate:function(e){return e===r.DONT_CARE||e===r.FASTEST||e===r.NICEST}};return e(r)});define("Renderer/TextureMagnificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEAREST:t.NEAREST,LINEAR:t.LINEAR,validate:function(e){return e===r.NEAREST||e===r.LINEAR}};return e(r)});define("Renderer/TextureMinificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEAREST:t.NEAREST,LINEAR:t.LINEAR,NEAREST_MIPMAP_NEAREST:t.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:t.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:t.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:t.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===r.NEAREST||e===r.LINEAR||e===r.NEAREST_MIPMAP_NEAREST||e===r.LINEAR_MIPMAP_NEAREST||e===r.NEAREST_MIPMAP_LINEAR||e===r.LINEAR_MIPMAP_LINEAR}};return e(r)});define("Renderer/TextureWrap",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={CLAMP_TO_EDGE:t.CLAMP_TO_EDGE,REPEAT:t.REPEAT,MIRRORED_REPEAT:t.MIRRORED_REPEAT,validate:function(e){return e===r.CLAMP_TO_EDGE||e===r.REPEAT||e===r.MIRRORED_REPEAT}};return e(r)});define("Renderer/Sampler",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./TextureMagnificationFilter","./TextureMinificationFilter","./TextureWrap"],function(e,t,r,i,n,a,o){"use strict";function s(r){r=e(r,e.EMPTY_OBJECT);var s=e(r.wrapS,o.CLAMP_TO_EDGE);var l=e(r.wrapT,o.CLAMP_TO_EDGE);var u=e(r.minificationFilter,a.LINEAR);var c=e(r.magnificationFilter,n.LINEAR);var d=t(r.maximumAnisotropy)?r.maximumAnisotropy:1;if(!o.validate(s)){throw new i("Invalid sampler.wrapS.")}if(!o.validate(l)){throw new i("Invalid sampler.wrapT.")}if(!a.validate(u)){throw new i("Invalid sampler.minificationFilter.")}if(!n.validate(c)){throw new i("Invalid sampler.magnificationFilter.")}if(d<1){throw new i("sampler.maximumAnisotropy must be greater than or equal to one.")}this._wrapS=s;this._wrapT=l;this._minificationFilter=u;this._magnificationFilter=c;this._maximumAnisotropy=d}r(s.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}});return s});define("Renderer/CubeMap",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","./ContextLimits","./CubeMapFace","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";function p(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}var i=r.context;var a=r.source;var u;var f;if(t(a)){var h=[a.positiveX,a.negativeX,a.positiveY,a.negativeY,a.positiveZ,a.negativeZ];if(!h[0]||!h[1]||!h[2]||!h[3]||!h[4]||!h[5]){throw new n("options.source requires positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ faces.")}u=h[0].width;f=h[0].height;for(var p=1;p<6;++p){if(Number(h[p].width)!==u||Number(h[p].height)!==f){throw new n("Each face in options.source must have the same width and height.")}}}else{u=r.width;f=r.height}var m=u;var v=e(r.pixelFormat,o.RGBA);var g=e(r.pixelDatatype,c.UNSIGNED_BYTE);if(!t(u)||!t(f)){throw new n("options requires a source field to create an initialized cube map or width and height fields to create a blank cube map.")}if(u!==f){throw new n("Width must equal height.")}if(m<=0){throw new n("Width and height must be greater than zero.")}if(m>s.maximumCubeMapSize){throw new n("Width and height must be less than or equal to the maximum cube map size ("+s.maximumCubeMapSize+").  Check maximumCubeMapSize.")}if(!o.validate(v)){throw new n("Invalid options.pixelFormat.")}if(o.isDepthFormat(v)){throw new n("options.pixelFormat cannot be DEPTH_COMPONENT or DEPTH_STENCIL.")}if(!c.validate(g)){throw new n("Invalid options.pixelDatatype.")}if(g===c.FLOAT&&!i.floatingPointTexture){throw new n("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.")}var _=o.textureSizeInBytes(v,g,m,m)*6;var y=r.preMultiplyAlpha||(v===o.RGB||v===o.LUMINANCE);var b=e(r.flipY,true);var w=i._gl;var C=w.TEXTURE_CUBE_MAP;var S=w.createTexture();w.activeTexture(w.TEXTURE0);w.bindTexture(C,S);function T(e,t){if(t.arrayBufferView){w.texImage2D(e,0,v,m,m,0,v,g,t.arrayBufferView)}else{w.texImage2D(e,0,v,v,g,t)}}if(t(a)){w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y);w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,b);T(w.TEXTURE_CUBE_MAP_POSITIVE_X,a.positiveX);T(w.TEXTURE_CUBE_MAP_NEGATIVE_X,a.negativeX);T(w.TEXTURE_CUBE_MAP_POSITIVE_Y,a.positiveY);T(w.TEXTURE_CUBE_MAP_NEGATIVE_Y,a.negativeY);T(w.TEXTURE_CUBE_MAP_POSITIVE_Z,a.positiveZ);T(w.TEXTURE_CUBE_MAP_NEGATIVE_Z,a.negativeZ)}else{w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X,0,v,m,m,0,v,g,null);w.texImage2D(w.TEXTURE_CUBE_MAP_NEGATIVE_X,0,v,m,m,0,v,g,null);w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_Y,0,v,m,m,0,v,g,null);w.texImage2D(w.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,v,m,m,0,v,g,null);w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_Z,0,v,m,m,0,v,g,null);w.texImage2D(w.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,v,m,m,0,v,g,null)}w.bindTexture(C,null);this._gl=w;this._textureFilterAnisotropic=i._textureFilterAnisotropic;this._textureTarget=C;this._texture=S;this._pixelFormat=v;this._pixelDatatype=g;this._size=m;this._hasMipmap=false;this._sizeInBytes=_;this._preMultiplyAlpha=y;this._flipY=b;this._sampler=undefined;this._positiveX=new l(w,S,C,w.TEXTURE_CUBE_MAP_POSITIVE_X,v,g,m,y,b);this._negativeX=new l(w,S,C,w.TEXTURE_CUBE_MAP_NEGATIVE_X,v,g,m,y,b);this._positiveY=new l(w,S,C,w.TEXTURE_CUBE_MAP_POSITIVE_Y,v,g,m,y,b);this._negativeY=new l(w,S,C,w.TEXTURE_CUBE_MAP_NEGATIVE_Y,v,g,m,y,b);this._positiveZ=new l(w,S,C,w.TEXTURE_CUBE_MAP_POSITIVE_Z,v,g,m,y,b);this._negativeZ=new l(w,S,C,w.TEXTURE_CUBE_MAP_NEGATIVE_Z,v,g,m,y,b);this.sampler=t(r.sampler)?r.sampler:new d}r(p.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){var r=e.minificationFilter;var i=e.magnificationFilter;var n=r===h.NEAREST_MIPMAP_NEAREST||r===h.NEAREST_MIPMAP_LINEAR||r===h.LINEAR_MIPMAP_NEAREST||r===h.LINEAR_MIPMAP_LINEAR;if(this._pixelDatatype===c.FLOAT){r=n?h.NEAREST_MIPMAP_NEAREST:h.NEAREST;i=f.NEAREST}var a=this._gl;var o=this._textureTarget;a.activeTexture(a.TEXTURE0);a.bindTexture(o,this._texture);a.texParameteri(o,a.TEXTURE_MIN_FILTER,r);a.texParameteri(o,a.TEXTURE_MAG_FILTER,i);a.texParameteri(o,a.TEXTURE_WRAP_S,e.wrapS);a.texParameteri(o,a.TEXTURE_WRAP_T,e.wrapT);if(t(this._textureFilterAnisotropic)){a.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy)}a.bindTexture(o,null);this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){if(this._hasMipmap){return Math.floor(this._sizeInBytes*4/3)}return this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}});p.prototype.generateMipmap=function(t){t=e(t,u.DONT_CARE);if(this._size>1&&!a.isPowerOfTwo(this._size)){throw new n("width and height must be a power of two to call generateMipmap().")}if(!u.validate(t)){throw new n("hint is invalid.")}this._hasMipmap=true;var r=this._gl;var i=this._textureTarget;r.hint(r.GENERATE_MIPMAP_HINT,t);r.activeTexture(r.TEXTURE0);r.bindTexture(i,this._texture);r.generateMipmap(i);r.bindTexture(i,null)};p.prototype.isDestroyed=function(){return false};p.prototype.destroy=function(){this._gl.deleteTexture(this._texture);this._positiveX=i(this._positiveX);this._negativeX=i(this._negativeX);this._positiveY=i(this._positiveY);this._negativeY=i(this._negativeY);this._positiveZ=i(this._positiveZ);this._negativeZ=i(this._negativeZ);return i(this)};return p});define("Renderer/Texture",["../Core/Cartesian2","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","../Core/WebGLConstants","./ContextLimits","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";function m(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.context)){throw new a("options.context is required.")}var n=i.context;var o=i.width;var c=i.height;var h=i.source;if(r(h)){if(!r(o)){o=t(h.videoWidth,h.width)}if(!r(c)){c=t(h.videoHeight,h.height)}}var p=t(i.pixelFormat,s.RGBA);var m=t(i.pixelDatatype,d.UNSIGNED_BYTE);var v=p;var g=s.isCompressedFormat(v);if(n.webgl2){if(p===s.DEPTH_STENCIL){v=l.DEPTH24_STENCIL8}else if(p===s.DEPTH_COMPONENT){if(m===d.UNSIGNED_SHORT){v=l.DEPTH_COMPONENT16}else if(m===d.UNSIGNED_INT){v=l.DEPTH_COMPONENT24}}if(m===d.FLOAT){switch(p){case s.RGBA:v=l.RGBA32F;break;case s.RGB:v=l.RGB32F;break;case s.RG:v=l.RG32F;break;case s.R:v=l.R32F;break}}}if(!r(o)||!r(c)){throw new a("options requires a source field to create an initialized texture or width and height fields to create a blank texture.")}if(o<=0){throw new a("Width must be greater than zero.")}if(o>u.maximumTextureSize){throw new a("Width must be less than or equal to the maximum texture size ("+u.maximumTextureSize+").  Check maximumTextureSize.")}if(c<=0){throw new a("Height must be greater than zero.")}if(c>u.maximumTextureSize){throw new a("Height must be less than or equal to the maximum texture size ("+u.maximumTextureSize+").  Check maximumTextureSize.")}if(!s.validate(p)){throw new a("Invalid options.pixelFormat.")}if(!g&&!d.validate(m)){throw new a("Invalid options.pixelDatatype.")}if(p===s.DEPTH_COMPONENT&&(m!==d.UNSIGNED_SHORT&&m!==d.UNSIGNED_INT)){throw new a("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.")}if(p===s.DEPTH_STENCIL&&m!==d.UNSIGNED_INT_24_8){throw new a("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.")}if(m===d.FLOAT&&!n.floatingPointTexture){throw new a("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.")}if(s.isDepthFormat(p)){if(r(h)){throw new a("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.")}if(!n.depthTexture){throw new a("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.")}}if(g){if(!r(h)||!r(h.arrayBufferView)){throw new a("When options.pixelFormat is compressed, options.source.arrayBufferView must be defined.")}if(s.isDXTFormat(v)&&!n.s3tc){throw new a("When options.pixelFormat is S3TC compressed, this WebGL implementation must support the WEBGL_texture_compression_s3tc extension. Check context.s3tc.")}else if(s.isPVRTCFormat(v)&&!n.pvrtc){throw new a("When options.pixelFormat is PVRTC compressed, this WebGL implementation must support the WEBGL_texture_compression_pvrtc extension. Check context.pvrtc.")}else if(s.isETC1Format(v)&&!n.etc1){throw new a("When options.pixelFormat is ETC1 compressed, this WebGL implementation must support the WEBGL_texture_compression_etc1 extension. Check context.etc1.")}if(s.compressedTextureSizeInBytes(v,o,c)!==h.arrayBufferView.byteLength){throw new a("The byte length of the array buffer is invalid for the compressed texture with the given width and height.")}}var _=i.preMultiplyAlpha||p===s.RGB||p===s.LUMINANCE;var y=t(i.flipY,true);var b=n._gl;var w=b.TEXTURE_2D;var C=b.createTexture();b.activeTexture(b.TEXTURE0);b.bindTexture(w,C);if(r(h)){b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,y);if(r(h.arrayBufferView)){if(g){b.compressedTexImage2D(w,0,v,o,c,0,h.arrayBufferView)}else{b.texImage2D(w,0,v,o,c,0,p,m,h.arrayBufferView)}}else if(r(h.framebuffer)){if(h.framebuffer!==n.defaultFramebuffer){h.framebuffer._bind()}b.copyTexImage2D(w,0,v,h.xOffset,h.yOffset,o,c,0);if(h.framebuffer!==n.defaultFramebuffer){h.framebuffer._unBind()}}else{b.texImage2D(w,0,v,p,m,h)}}else{b.texImage2D(w,0,v,o,c,0,p,m,null)}b.bindTexture(w,null);var S;if(g){S=s.compressedTextureSizeInBytes(p,o,c)}else{S=s.textureSizeInBytes(p,m,o,c)}this._context=n;this._textureFilterAnisotropic=n._textureFilterAnisotropic;this._textureTarget=w;this._texture=C;this._pixelFormat=p;this._pixelDatatype=m;this._width=o;this._height=c;this._dimensions=new e(o,c);this._hasMipmap=false;this._sizeInBytes=S;this._preMultiplyAlpha=_;this._flipY=y;this._sampler=undefined;this.sampler=r(i.sampler)?i.sampler:new f}m.fromFramebuffer=function(e){e=t(e,t.EMPTY_OBJECT);if(!r(e.context)){throw new a("options.context is required.")}var i=e.context;var n=i._gl;var o=t(e.pixelFormat,s.RGB);var l=t(e.framebufferXOffset,0);var u=t(e.framebufferYOffset,0);var c=t(e.width,n.drawingBufferWidth);var d=t(e.height,n.drawingBufferHeight);var f=e.framebuffer;if(!r(e.context)){throw new a("context is required.")}if(!s.validate(o)){throw new a("Invalid pixelFormat.")}if(s.isDepthFormat(o)||s.isCompressedFormat(o)){throw new a("pixelFormat cannot be DEPTH_COMPONENT, DEPTH_STENCIL or a compressed format.")}if(l<0){throw new a("framebufferXOffset must be greater than or equal to zero.")}if(u<0){throw new a("framebufferYOffset must be greater than or equal to zero.")}if(l+c>n.drawingBufferWidth){throw new a("framebufferXOffset + width must be less than or equal to drawingBufferWidth")}if(u+d>n.drawingBufferHeight){throw new a("framebufferYOffset + height must be less than or equal to drawingBufferHeight.")}var h=new m({context:i,width:c,height:d,pixelFormat:o,source:{framebuffer:r(f)?f:i.defaultFramebuffer,xOffset:l,yOffset:u,width:c,height:d}});return h};i(m.prototype,{sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter;var i=e.magnificationFilter;var n=t===p.NEAREST_MIPMAP_NEAREST||t===p.NEAREST_MIPMAP_LINEAR||t===p.LINEAR_MIPMAP_NEAREST||t===p.LINEAR_MIPMAP_LINEAR;if(this._pixelDatatype===d.FLOAT){t=n?p.NEAREST_MIPMAP_NEAREST:p.NEAREST;i=h.NEAREST}var a=this._context._gl;var o=this._textureTarget;a.activeTexture(a.TEXTURE0);a.bindTexture(o,this._texture);a.texParameteri(o,a.TEXTURE_MIN_FILTER,t);a.texParameteri(o,a.TEXTURE_MAG_FILTER,i);a.texParameteri(o,a.TEXTURE_WRAP_S,e.wrapS);a.texParameteri(o,a.TEXTURE_WRAP_T,e.wrapT);if(r(this._textureFilterAnisotropic)){a.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy)}a.bindTexture(o,null);this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){if(this._hasMipmap){return Math.floor(this._sizeInBytes*4/3)}return this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}});m.prototype.copyFrom=function(e,i,n){i=t(i,0);n=t(n,0);if(!r(e)){throw new a("source is required.")}if(s.isDepthFormat(this._pixelFormat)){throw new a("Cannot call copyFrom when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.")}if(s.isCompressedFormat(this._pixelFormat)){throw new a("Cannot call copyFrom with a compressed texture pixel format.")}if(i<0){throw new a("xOffset must be greater than or equal to zero.")}if(n<0){throw new a("yOffset must be greater than or equal to zero.")}if(i+e.width>this._width){throw new a("xOffset + source.width must be less than or equal to width.")}if(n+e.height>this._height){throw new a("yOffset + source.height must be less than or equal to height.")}var o=this._context._gl;var l=this._textureTarget;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._preMultiplyAlpha);o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,this._flipY);o.activeTexture(o.TEXTURE0);o.bindTexture(l,this._texture);if(e.arrayBufferView){o.texSubImage2D(l,0,i,n,e.width,e.height,this._pixelFormat,this._pixelDatatype,e.arrayBufferView)}else{o.texSubImage2D(l,0,i,n,this._pixelFormat,this._pixelDatatype,e)}o.bindTexture(l,null)};m.prototype.copyFromFramebuffer=function(e,r,i,n,o,l){e=t(e,0);r=t(r,0);i=t(i,0);n=t(n,0);o=t(o,this._width);l=t(l,this._height);if(s.isDepthFormat(this._pixelFormat)){throw new a("Cannot call copyFromFramebuffer when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.")}if(this._pixelDatatype===d.FLOAT){throw new a("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.")}if(s.isCompressedFormat(this._pixelFormat)){throw new a("Cannot call copyFrom with a compressed texture pixel format.")}if(e<0){throw new a("xOffset must be greater than or equal to zero.")}if(r<0){throw new a("yOffset must be greater than or equal to zero.")}if(i<0){throw new a("framebufferXOffset must be greater than or equal to zero.")}if(n<0){throw new a("framebufferYOffset must be greater than or equal to zero.")}if(e+o>this._width){throw new a("xOffset + width must be less than or equal to width.")}if(r+l>this._height){throw new a("yOffset + height must be less than or equal to height.")}var u=this._context._gl;var c=this._textureTarget;u.activeTexture(u.TEXTURE0);u.bindTexture(c,this._texture);u.copyTexSubImage2D(c,0,e,r,i,n,o,l);u.bindTexture(c,null)};m.prototype.generateMipmap=function(e){e=t(e,c.DONT_CARE);if(s.isDepthFormat(this._pixelFormat)){throw new a("Cannot call generateMipmap when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.")}if(s.isCompressedFormat(this._pixelFormat)){throw new a("Cannot call generateMipmap with a compressed pixel format.")}if(this._width>1&&!o.isPowerOfTwo(this._width)){throw new a("width must be a power of two to call generateMipmap().")}if(this._height>1&&!o.isPowerOfTwo(this._height)){throw new a("height must be a power of two to call generateMipmap().")}if(!c.validate(e)){throw new a("hint is invalid.")}this._hasMipmap=true;var r=this._context._gl;var i=this._textureTarget;r.hint(r.GENERATE_MIPMAP_HINT,e);r.activeTexture(r.TEXTURE0);r.bindTexture(i,this._texture);r.generateMipmap(i);r.bindTexture(i,null)};m.prototype.isDestroyed=function(){return false};m.prototype.destroy=function(){this._context._gl.deleteTexture(this._texture);return n(this)};return m});define("Shaders/Materials/BumpMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    \n    vec2 centerPixel = fract(repeat * st);\n    float centerBump = texture2D(image, centerPixel).channel;\n    \n    float imageWidth = float(imageDimensions.x);\n    vec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));\n    float rightBump = texture2D(image, rightPixel).channel;\n    \n    float imageHeight = float(imageDimensions.y);\n    vec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));\n    float topBump = texture2D(image, leftPixel).channel;\n    \n    vec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));\n    vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\n \n    material.normal = normalEC;\n    material.diffuse = vec3(0.01);\n    \n    return material;\n}\n"});define("Shaders/Materials/CheckerboardMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    \n    // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n    float b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);  // 0.0 or 1.0\n    \n    // Find the distance from the closest separator (region between two colors)\n    float scaledWidth = fract(repeat.s * st.s);\n    scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\n    float scaledHeight = fract(repeat.t * st.t);\n    scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\n    float value = min(scaledWidth, scaledHeight);\n    \n    vec4 currentColor = mix(lightColor, darkColor, b);\n    vec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);\n    \n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n    \n    return material;\n}\n"});define("Shaders/Materials/DotMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    \n    // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n    float b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));  // 0.0 or 1.0\n\n    vec4 color = mix(lightColor, darkColor, b);\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n    \n    return material;\n}\n"});define("Shaders/Materials/FadeMaterial",[],function(){"use strict";return"uniform vec4 fadeInColor;\nuniform vec4 fadeOutColor;\nuniform float maximumDistance;\nuniform bool repeat;\nuniform vec2 fadeDirection;\nuniform vec2 time;\n\nfloat getTime(float t, float coord)\n{\n    float scalar = 1.0 / maximumDistance;\n    float q  = distance(t, coord) * scalar;\n    if (repeat)\n    {\n        float r = distance(t, coord + 1.0) * scalar;\n        float s = distance(t, coord - 1.0) * scalar;\n        q = min(min(r, s), q);\n    }\n    return clamp(q, 0.0, 1.0);\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    \n    vec2 st = materialInput.st;\n    float s = getTime(time.x, st.s) * fadeDirection.s;\n    float t = getTime(time.y, st.t) * fadeDirection.t;\n    \n    float u = length(vec2(s, t));\n    vec4 color = mix(fadeInColor, fadeOutColor, u);\n    \n    material.emission = color.rgb;\n    material.alpha = color.a;\n    \n    return material;\n}\n"});define("Shaders/Materials/GridMaterial",[],function(){"use strict";return'#ifdef GL_OES_standard_derivatives\n    #extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform vec4 color;\nuniform float cellAlpha;\nuniform vec2 lineCount;\nuniform vec2 lineThickness;\nuniform vec2 lineOffset;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n    float scaledWidth = fract(lineCount.s * st.s - lineOffset.s);\n    scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\n    float scaledHeight = fract(lineCount.t * st.t - lineOffset.t);\n    scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\n\n    float value;\n#ifdef GL_OES_standard_derivatives\n    // Fuzz Factor - Controls blurriness of lines\n    const float fuzz = 1.2;\n    vec2 thickness = (lineThickness * czm_resolutionScale) - 1.0;\n\n    // From "3D Engine Design for Virtual Globes" by Cozzi and Ring, Listing 4.13.\n    vec2 dx = abs(dFdx(st));\n    vec2 dy = abs(dFdy(st));\n    vec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;\n    value = min(\n        smoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),\n        smoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));\n#else\n    // Fuzz Factor - Controls blurriness of lines\n    const float fuzz = 0.05;\n\n    vec2 range = 0.5 - (lineThickness * 0.05);\n    value = min(\n        1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),\n        1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));\n#endif\n\n    // Edges taken from RimLightingMaterial.glsl\n    // See http://www.fundza.com/rman_shaders/surface/fake_rim/fake_rim1.html\n    float dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\n    float sRim = smoothstep(0.8, 1.0, dRim);\n    value *= (1.0 - sRim);\n\n    vec3 halfColor = color.rgb * 0.5;\n    material.diffuse = halfColor;\n    material.emission = halfColor;\n    material.alpha = color.a * (1.0 - ((1.0 - cellAlpha) * value));\n\n    return material;\n}\n'});define("Shaders/Materials/NormalMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    \n    vec4 textureValue = texture2D(image, fract(repeat * materialInput.st));\n    vec3 normalTangentSpace = textureValue.channels;\n    normalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;\n    normalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);\n    normalTangentSpace = normalize(normalTangentSpace);\n    vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\n    \n    material.normal = normalEC;\n    \n    return material;\n}\n"});define("Shaders/Materials/PolylineArrowMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform vec4 color;\n\nvarying float v_width;\n\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\n    float slope = (p0.y - p1.y) / (p0.x - p1.x);\n    return slope * (x - p0.x) + p0.y;\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n#ifdef GL_OES_standard_derivatives\n    float base = 1.0 - abs(fwidth(st.s)) * 10.0;\n#else\n    float base = 0.99; // 1% of the line will be the arrow head\n#endif\n\n    vec2 center = vec2(1.0, 0.5);\n    float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\n    float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\n\n    float halfWidth = 0.15;\n    float s = step(0.5 - halfWidth, st.t);\n    s *= 1.0 - step(0.5 + halfWidth, st.t);\n    s *= 1.0 - step(base, st.s);\n\n    float t = step(base, materialInput.st.s);\n    t *= 1.0 - step(ptOnUpperLine, st.t);\n    t *= step(ptOnLowerLine, st.t);\n\n    // Find the distance from the closest separator (region between two colors)\n    float dist;\n    if (st.s < base)\n    {\n        float d1 = abs(st.t - (0.5 - halfWidth));\n        float d2 = abs(st.t - (0.5 + halfWidth));\n        dist = min(d1, d2);\n    }\n    else\n    {\n        float d1 = czm_infinity;\n        if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n        {\n            d1 = abs(st.s - base);\n        }\n        float d2 = abs(st.t - ptOnUpperLine);\n        float d3 = abs(st.t - ptOnLowerLine);\n        dist = min(min(d1, d2), d3);\n    }\n\n    vec4 outsideColor = vec4(0.0);\n    vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\n    vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\n\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n    return material;\n}\n"});define("Shaders/Materials/PolylineDashMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nvarying float v_polylineAngle;\n\nconst float maskLength = 16.0;\n\nmat2 rotate(float rad) {\n    float c = cos(rad);\n    float s = sin(rad);\n    return mat2(\n        c, s,\n        -s, c\n    );\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\n\n    // Get the relative position within the dash from 0 to 1\n    float dashPosition = fract(pos.x / dashLength);\n    // Figure out the mask index.\n    float maskIndex = floor(dashPosition * maskLength);\n    // Test the bit mask.\n    float maskTest = floor(dashPattern / pow(2.0, maskIndex));\n    vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\n    if (fragColor.a < 0.005) {   // matches 0/255 and 1/255\n        discard;\n    }\n\n    material.emission = fragColor.rgb;\n    material.alpha = fragColor.a;\n    return material;\n}"});define("Shaders/Materials/PolylineGlowMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform float glowPower;\n\nvarying float v_width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\n\n    material.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\n    material.alpha = clamp(0.0, 1.0, glow) * color.a;\n\n    return material;\n}\n"});define("Shaders/Materials/PolylineOutlineMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 outlineColor;\nuniform float outlineWidth;\n\nvarying float v_width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    \n    vec2 st = materialInput.st;\n    float halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\n    float b = step(0.5 - halfInteriorWidth, st.t);\n    b *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\n    \n    // Find the distance from the closest separator (region between two colors)\n    float d1 = abs(st.t - (0.5 - halfInteriorWidth));\n    float d2 = abs(st.t - (0.5 + halfInteriorWidth));\n    float dist = min(d1, d2);\n    \n    vec4 currentColor = mix(outlineColor, color, b);\n    vec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\n    \n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n    \n    return material;\n}\n"});define("Shaders/Materials/RimLightingMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 rimColor;\nuniform float width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    // See http://www.fundza.com/rman_shaders/surface/fake_rim/fake_rim1.html\n    float d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));\n    float s = smoothstep(1.0 - width, 1.0, d);\n\n    material.diffuse = color.rgb;\n    material.emission = rimColor.rgb * s; \n    material.alpha = mix(color.a, rimColor.a, s);\n\n    return material;\n}\n"});define("Shaders/Materials/StripeMaterial",[],function(){"use strict";return"uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform float offset;\nuniform float repeat;\nuniform bool horizontal;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    // Based on the Stripes Fragment Shader in the Orange Book (11.1.2)\n    float coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\n    float value = fract((coord - offset) * (repeat * 0.5));\n    float dist = min(value, min(abs(value - 0.5), 1.0 - value));\n    \n    vec4 currentColor = mix(evenColor, oddColor, step(0.5, value));\n    vec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);\n    \n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n    \n    return material;\n}\n"});define("Shaders/Materials/Water",[],function(){"use strict";return"// Thanks for the contribution Jonas\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\nuniform sampler2D specularMap;\nuniform sampler2D normalMap;\nuniform vec4 baseWaterColor;\nuniform vec4 blendColor;\nuniform float frequency;\nuniform float animationSpeed;\nuniform float amplitude;\nuniform float specularIntensity;\nuniform float fadeFactor;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    float time = czm_frameNumber * animationSpeed;\n    \n    // fade is a function of the distance from the fragment and the frequency of the waves\n    float fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);\n            \n    float specularMapValue = texture2D(specularMap, materialInput.st).r;\n    \n    // note: not using directional motion at this time, just set the angle to 0.0;\n    vec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);\n    vec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));\n    \n    // fade out the normal perturbation as we move further from the water surface\n    normalTangentSpace.xy /= fade;\n        \n    // attempt to fade out the normal perturbation as we approach non water areas (low specular map value)\n    normalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);\n    \n    normalTangentSpace = normalize(normalTangentSpace);\n    \n    // get ratios for alignment of the new normal vector with a vector perpendicular to the tangent plane\n    float tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\n    \n    // fade out water effect as specular map value decreases\n    material.alpha = specularMapValue;\n    \n    // base color is a blend of the water and non-water color based on the value from the specular map\n    // may need a uniform blend factor to better control this\n    material.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);\n    \n    // diffuse highlights are based on how perturbed the normal is\n    material.diffuse += (0.1 * tsPerturbationRatio);\n    \n    material.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\n    \n    material.specular = specularIntensity;\n    material.shininess = 10.0;\n    \n    return material;\n}\n"});define("Scene/Material",["../Core/Cartesian2","../Core/clone","../Core/Color","../Core/combine","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/isArray","../Core/loadCRN","../Core/loadImage","../Core/loadKTX","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Renderer/CubeMap","../Renderer/Texture","../Shaders/Materials/BumpMapMaterial","../Shaders/Materials/CheckerboardMaterial","../Shaders/Materials/DotMaterial","../Shaders/Materials/FadeMaterial","../Shaders/Materials/GridMaterial","../Shaders/Materials/NormalMapMaterial","../Shaders/Materials/PolylineArrowMaterial","../Shaders/Materials/PolylineDashMaterial","../Shaders/Materials/PolylineGlowMaterial","../Shaders/Materials/PolylineOutlineMaterial","../Shaders/Materials/RimLightingMaterial","../Shaders/Materials/StripeMaterial","../Shaders/Materials/Water","../ThirdParty/when"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M){"use strict";function R(e){this.type=undefined;this.shaderSource=undefined;this.materials=undefined;this.uniforms=undefined;this._uniforms=undefined;this.translucent=undefined;this._strict=undefined;this._template=undefined;this._count=undefined;this._texturePaths={};this._loadedImages=[];this._loadedCubeMaps=[];this._textures={};this._updateFunctions=[];this._defaultTexture=undefined;L(e,this);s(this,{type:{value:this.type,writable:false}});if(!o(R._uniformList[this.type])){R._uniformList[this.type]=Object.keys(this._uniforms)}}R._uniformList={};R.fromType=function(e,t){if(!o(R._materialCache.getMaterial(e))){throw new u("material with type '"+e+"' does not exist.")}var r=new R({fabric:{type:e}});if(o(t)){for(var i in t){if(t.hasOwnProperty(i)){r.uniforms[i]=t[i]}}}return r};R.prototype.isTranslucent=function(){if(o(this.translucent)){if(typeof this.translucent==="function"){return this.translucent()}return this.translucent}var e=true;var t=this._translucentFunctions;var r=t.length;for(var i=0;i<r;++i){var n=t[i];if(typeof n==="function"){e=e&&n()}else{e=e&&n}if(!e){break}}return e};R.prototype.update=function(e){var t;var r;var i=this._loadedImages;var n=i.length;for(t=0;t<n;++t){var a=i[t];r=a.id;var s=a.image;var l;if(o(s.internalFormat)){l=new _({context:e,pixelFormat:s.internalFormat,width:s.width,height:s.height,source:{arrayBufferView:s.bufferView}})}else{l=new _({context:e,source:s})}this._textures[r]=l;var u=r+"Dimensions";if(this.uniforms.hasOwnProperty(u)){var c=this.uniforms[u];c.x=l._width;c.y=l._height}}i.length=0;var d=this._loadedCubeMaps;n=d.length;for(t=0;t<n;++t){var f=d[t];r=f.id;var h=f.images;var p=new g({context:e,source:{positiveX:h[0],negativeX:h[1],positiveY:h[2],negativeY:h[3],positiveZ:h[4],negativeZ:h[5]}});this._textures[r]=p}d.length=0;var m=this._updateFunctions;n=m.length;for(t=0;t<n;++t){m[t](this,e)}var v=this.materials;for(var y in v){if(v.hasOwnProperty(y)){v[y].update(e)}}};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){var e=this._textures;for(var t in e){if(e.hasOwnProperty(t)){var r=e[t];if(r!==this._defaultTexture){r.destroy()}}}var i=this.materials;for(var n in i){if(i.hasOwnProperty(n)){i[n].destroy()}}return l(this)};function L(e,r){e=a(e,a.EMPTY_OBJECT);r._strict=a(e.strict,false);r._count=a(e.count,0);r._template=t(a(e.fabric,a.EMPTY_OBJECT));r._template.uniforms=t(a(r._template.uniforms,a.EMPTY_OBJECT));r._template.materials=t(a(r._template.materials,a.EMPTY_OBJECT));r.type=o(r._template.type)?r._template.type:n();r.shaderSource="";r.materials={};r.uniforms={};r._uniforms={};r._translucentFunctions=[];var s;var l=R._materialCache.getMaterial(r.type);if(o(l)){var u=t(l.fabric,true);r._template=i(r._template,u,true);s=l.translucent}V(r);if(!o(l)){R._materialCache.addMaterial(r.type,r)}z(r);Y(r);Z(r);var c=r._translucentFunctions.length===0?true:undefined;s=a(s,c);s=a(e.translucent,s);if(o(s)){if(typeof s==="function"){var d=function(){return s(r)};r._translucentFunctions.push(d)}else{r._translucentFunctions.push(s)}}}function N(e,t,r,i){if(o(e)){for(var n in e){if(e.hasOwnProperty(n)){var a=t.indexOf(n)!==-1;if(i&&!a||!i&&a){r(n,t)}}}}}function k(e,t){var r="fabric: property name '"+e+"' is not valid. It should be ";for(var i=0;i<t.length;i++){var n="'"+t[i]+"'";r+=i===t.length-1?"or "+n+".":n+", "}throw new u(r)}function F(e,t){var r="fabric: uniforms and materials cannot share the same property '"+e+"'";throw new u(r)}var B=["type","materials","uniforms","components","source"];var U=["diffuse","specular","shininess","normal","emission","alpha"];function V(e){var t=e._template;var r=t.uniforms;var i=t.materials;var n=t.components;if(o(n)&&o(t.source)){throw new u("fabric: cannot have source and components in the same template.")}N(t,B,k,true);N(n,U,k,true);var a=[];for(var s in i){if(i.hasOwnProperty(s)){a.push(s)}}N(r,a,F,false)}function z(e){var t=e._template.components;var r=e._template.source;if(o(r)){e.shaderSource+=r+"\n"}else{e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n";e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n";if(o(t)){for(var i in t){if(t.hasOwnProperty(i)){e.shaderSource+="material."+i+" = "+t[i]+";\n"}}}e.shaderSource+="return material;\n}\n"}}var q={mat2:p,mat3:m,mat4:v};var G=/\.ktx$/i;var H=/\.crn$/i;function j(e){var t;return function(r,i){var n=r.uniforms;var a=n[e];var s=t!==a;t=a;var l=r._textures[e];var u;var c;if(a instanceof HTMLVideoElement){if(a.readyState>=2){if(s&&o(l)){if(l!==i.defaultTexture){l.destroy()}l=undefined}if(!o(l)||l===i.defaultTexture){l=new _({context:i,source:a});r._textures[e]=l;return}l.copyFrom(a)}else if(!o(l)){r._textures[e]=i.defaultTexture}return}if(a instanceof _&&a!==l){r._texturePaths[e]=undefined;var p=r._textures[e];if(p!==r._defaultTexture){p.destroy()}r._textures[e]=a;u=e+"Dimensions";if(n.hasOwnProperty(u)){c=n[u];c.x=a._width;c.y=a._height}return}if(!o(l)){r._texturePaths[e]=undefined;if(!o(r._defaultTexture)){r._defaultTexture=i.defaultTexture}l=r._textures[e]=r._defaultTexture;u=e+"Dimensions";if(n.hasOwnProperty(u)){c=n[u];c.x=l._width;c.y=l._height}}if(a===R.DefaultImageId){return}if(a!==r._texturePaths[e]){if(typeof a==="string"){var m;if(G.test(a)){m=h(a)}else if(H.test(a)){m=d(a)}else{m=f(a)}M(m,function(t){r._loadedImages.push({id:e,image:t})})}else if(a instanceof HTMLCanvasElement){r._loadedImages.push({id:e,image:a})}r._texturePaths[e]=a}}}function W(e){return function(t,r){var i=t.uniforms[e];if(i instanceof g){var n=t._textures[e];if(n!==t._defaultTexture){n.destroy()}t._texturePaths[e]=undefined;t._textures[e]=i;return}if(!o(t._textures[e])){t._texturePaths[e]=undefined;t._textures[e]=r.defaultCubeMap}if(i===R.DefaultCubeMapId){return}var a=i.positiveX+i.negativeX+i.positiveY+i.negativeY+i.positiveZ+i.negativeZ;if(a!==t._texturePaths[e]){var s=[f(i.positiveX),f(i.negativeX),f(i.positiveY),f(i.negativeY),f(i.positiveZ),f(i.negativeZ)];M.all(s).then(function(r){t._loadedCubeMaps.push({id:e,images:r})});t._texturePaths[e]=a}}}function Y(e){var t=e._template.uniforms;for(var r in t){if(t.hasOwnProperty(r)){X(e,r)}}}function X(e,t){var r=e._strict;var i=e._template.uniforms;var n=i[t];var a=Q(n);if(!o(a)){throw new u("fabric: uniform '"+t+"' has invalid type.")}var s;if(a==="channels"){s=K(e,t,n,false);if(s===0&&r){throw new u("strict: shader source does not use channels '"+t+"'.")}}else{if(a==="sampler2D"){var l=t+"Dimensions";if(J(e,l)>0){i[l]={type:"ivec3",x:1,y:1};X(e,l)}}var c=new RegExp("uniform\\s+"+a+"\\s+"+t+"\\s*;");if(!c.test(e.shaderSource)){var d="uniform "+a+" "+t+";";e.shaderSource=d+e.shaderSource}var f=t+"_"+e._count++;s=K(e,t,f);if(s===1&&r){throw new u("strict: shader source does not use uniform '"+t+"'.")}e.uniforms[t]=n;if(a==="sampler2D"){e._uniforms[f]=function(){return e._textures[t]};e._updateFunctions.push(j(t))}else if(a==="samplerCube"){e._uniforms[f]=function(){return e._textures[t]};e._updateFunctions.push(W(t))}else if(a.indexOf("mat")!==-1){var h=new q[a];e._uniforms[f]=function(){return q[a].fromColumnMajorArray(e.uniforms[t],h)}}else{e._uniforms[f]=function(){return e.uniforms[t]}}}}function Q(e){var t=e.type;if(!o(t)){var r=typeof e;if(r==="number"){t="float"}else if(r==="boolean"){t="bool"}else if(r==="string"||e instanceof HTMLCanvasElement){if(/^([rgba]){1,4}$/i.test(e)){t="channels"}else if(e===R.DefaultCubeMapId){t="samplerCube"}else{t="sampler2D"}}else if(r==="object"){if(c(e)){if(e.length===4||e.length===9||e.length===16){t="mat"+Math.sqrt(e.length)}}else{var i=0;for(var n in e){if(e.hasOwnProperty(n)){i+=1}}if(i>=2&&i<=4){t="vec"+i}else if(i===6){t="samplerCube"}}}}return t}function Z(e){var t=e._strict;var r=e._template.materials;for(var n in r){if(r.hasOwnProperty(n)){var a=new R({strict:t,fabric:r[n],count:e._count});e._count=a._count;e._uniforms=i(e._uniforms,a._uniforms,true);e.materials[n]=a;e._translucentFunctions=e._translucentFunctions.concat(a._translucentFunctions);var o="czm_getMaterial";var s=o+"_"+e._count++;K(a,o,s);e.shaderSource=a.shaderSource+e.shaderSource;var l=s+"(materialInput)";var c=K(e,n,l);if(c===0&&t){throw new u("strict: shader source does not use material '"+n+"'.")}}}}function K(e,t,r,i){i=a(i,true);var n=0;var o="([\\w])?";var s="([\\w"+(i?".":"")+"])?";var l=new RegExp(s+t+o,"g");e.shaderSource=e.shaderSource.replace(l,function(e,t,i){if(t||i){return e}n+=1;return r});return n}function J(e,t,r){return K(e,t,t,r)}R._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}};R.DefaultImageId="czm_defaultImage";R.DefaultCubeMapId="czm_defaultCubeMap";R.ColorType="Color";R._materialCache.addMaterial(R.ColorType,{fabric:{type:R.ColorType,uniforms:{color:new r(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});R.ImageType="Image";R._materialCache.addMaterial(R.ImageType,{fabric:{type:R.ImageType,uniforms:{image:R.DefaultImageId,repeat:new e(1,1),color:new r(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});R.DiffuseMapType="DiffuseMap";R._materialCache.addMaterial(R.DiffuseMapType,{fabric:{type:R.DiffuseMapType,uniforms:{image:R.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:false});R.AlphaMapType="AlphaMap";R._materialCache.addMaterial(R.AlphaMapType,{fabric:{type:R.AlphaMapType,uniforms:{image:R.DefaultImageId,channel:"a",repeat:new e(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:true});R.SpecularMapType="SpecularMap";R._materialCache.addMaterial(R.SpecularMapType,{fabric:{type:R.SpecularMapType,uniforms:{image:R.DefaultImageId,channel:"r",repeat:new e(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:false});R.EmissionMapType="EmissionMap";R._materialCache.addMaterial(R.EmissionMapType,{fabric:{type:R.EmissionMapType,uniforms:{image:R.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:false});R.BumpMapType="BumpMap";R._materialCache.addMaterial(R.BumpMapType,{fabric:{type:R.BumpMapType,uniforms:{image:R.DefaultImageId,channel:"r",strength:.8,repeat:new e(1,1)},source:y},translucent:false});R.NormalMapType="NormalMap";R._materialCache.addMaterial(R.NormalMapType,{fabric:{type:R.NormalMapType,uniforms:{image:R.DefaultImageId,channels:"rgb",strength:.8,repeat:new e(1,1)},source:T},translucent:false});R.GridType="Grid";R._materialCache.addMaterial(R.GridType,{fabric:{type:R.GridType,uniforms:{color:new r(0,1,0,1),cellAlpha:.1,lineCount:new e(8,8),lineThickness:new e(1,1),lineOffset:new e(0,0)},source:S},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}});R.StripeType="Stripe";R._materialCache.addMaterial(R.StripeType,{fabric:{type:R.StripeType,uniforms:{horizontal:true,evenColor:new r(1,1,1,.5),oddColor:new r(0,0,1,.5),offset:0,repeat:5},source:D},translucent:function(e){var t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}});R.CheckerboardType="Checkerboard";R._materialCache.addMaterial(R.CheckerboardType,{fabric:{type:R.CheckerboardType,uniforms:{lightColor:new r(1,1,1,.5),darkColor:new r(0,0,0,.5),repeat:new e(5,5)},source:b},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}});R.DotType="Dot";R._materialCache.addMaterial(R.DotType,{fabric:{type:R.DotType,uniforms:{lightColor:new r(1,1,0,.75),darkColor:new r(0,1,1,.75),repeat:new e(5,5)},source:w},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}});R.WaterType="Water";R._materialCache.addMaterial(R.WaterType,{fabric:{type:R.WaterType,uniforms:{baseWaterColor:new r(.2,.3,.6,1),blendColor:new r(0,1,.699,1),specularMap:R.DefaultImageId,normalMap:R.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:I},translucent:function(e){var t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}});R.RimLightingType="RimLighting";R._materialCache.addMaterial(R.RimLightingType,{fabric:{type:R.RimLightingType,uniforms:{color:new r(1,0,0,.7),rimColor:new r(1,1,1,.4),width:.3},source:O},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}});R.FadeType="Fade";R._materialCache.addMaterial(R.FadeType,{fabric:{type:R.FadeType,uniforms:{fadeInColor:new r(1,0,0,1),fadeOutColor:new r(0,0,0,0),maximumDistance:.5,repeat:true,fadeDirection:{x:true,y:true},time:new e(.5,.5)},source:C},translucent:function(e){var t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}});R.PolylineArrowType="PolylineArrow";R._materialCache.addMaterial(R.PolylineArrowType,{fabric:{type:R.PolylineArrowType,uniforms:{color:new r(1,1,1,1)},source:E},translucent:true});R.PolylineDashType="PolylineDash";R._materialCache.addMaterial(R.PolylineDashType,{fabric:{type:R.PolylineDashType,uniforms:{color:new r(1,0,1,1),gapColor:new r(0,0,0,0),dashLength:16,dashPattern:255},source:x},translucent:true});R.PolylineGlowType="PolylineGlow";R._materialCache.addMaterial(R.PolylineGlowType,{fabric:{type:R.PolylineGlowType,uniforms:{color:new r(0,.5,1,1),glowPower:.25},source:P},translucent:true});R.PolylineOutlineType="PolylineOutline";R._materialCache.addMaterial(R.PolylineOutlineType,{fabric:{type:R.PolylineOutlineType,uniforms:{color:new r(1,1,1,1),outlineColor:new r(1,0,0,1),outlineWidth:1},source:A},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}});return R});define("Scene/MaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/freezeObject","../Core/VertexFormat","../Shaders/Appearances/AllMaterialAppearanceFS","../Shaders/Appearances/AllMaterialAppearanceVS","../Shaders/Appearances/BasicMaterialAppearanceFS","../Shaders/Appearances/BasicMaterialAppearanceVS","../Shaders/Appearances/TexturedMaterialAppearanceFS","../Shaders/Appearances/TexturedMaterialAppearanceVS","./Appearance","./Material"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";function h(r){r=e(r,e.EMPTY_OBJECT);var i=e(r.translucent,true);var n=e(r.closed,false);var a=e(r.materialSupport,h.MaterialSupport.TEXTURED);this.material=t(r.material)?r.material:f.fromType(f.ColorType);this.translucent=i;this._vertexShaderSource=e(r.vertexShaderSource,a.vertexShaderSource);this._fragmentShaderSource=e(r.fragmentShaderSource,a.fragmentShaderSource);this._renderState=d.getDefaultRenderState(i,n,r.renderState);this._closed=n;this._materialSupport=a;this._vertexFormat=a.vertexFormat;this._flat=e(r.flat,false);this._faceForward=e(r.faceForward,!n)}r(h.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});h.prototype.getFragmentShaderSource=d.prototype.getFragmentShaderSource;h.prototype.isTranslucent=d.prototype.isTranslucent;h.prototype.getRenderState=d.prototype.getRenderState;h.MaterialSupport={BASIC:i({vertexFormat:n.POSITION_AND_NORMAL,vertexShaderSource:l,fragmentShaderSource:s}),TEXTURED:i({vertexFormat:n.POSITION_NORMAL_AND_ST,vertexShaderSource:c,fragmentShaderSource:u}),ALL:i({vertexFormat:n.ALL,vertexShaderSource:o,fragmentShaderSource:a})};return h});define("Shaders/Appearances/PerInstanceColorAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n    \n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n    \n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    material.diffuse = v_color.rgb;\n    material.alpha = v_color.a;\n    \n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n}\n"});define("Shaders/Appearances/PerInstanceColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec4 color;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\n\nvoid main() \n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_color = color;\n    \n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Shaders/Appearances/PerInstanceFlatColorAppearanceFS",[],function(){"use strict";return"varying vec4 v_color;\n\nvoid main()\n{\n    gl_FragColor = v_color;\n}\n"});define("Shaders/Appearances/PerInstanceFlatColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 color;\nattribute float batchId;\n\nvarying vec4 v_color;\n\nvoid main() \n{\n    vec4 p = czm_computePosition();\n\n    v_color = color;\n    \n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Scene/PerInstanceColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceColorAppearanceFS","../Shaders/Appearances/PerInstanceColorAppearanceVS","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PerInstanceFlatColorAppearanceVS","./Appearance"],function(e,t,r,i,n,a,o,s){"use strict";function l(t){t=e(t,e.EMPTY_OBJECT);var r=e(t.translucent,true);var u=e(t.closed,false);var c=e(t.flat,false);var d=c?o:n;var f=c?a:i;var h=c?l.FLAT_VERTEX_FORMAT:l.VERTEX_FORMAT;this.material=undefined;this.translucent=r;this._vertexShaderSource=e(t.vertexShaderSource,d);this._fragmentShaderSource=e(t.fragmentShaderSource,f);this._renderState=s.getDefaultRenderState(r,u,t.renderState);this._closed=u;this._vertexFormat=h;this._flat=c;this._faceForward=e(t.faceForward,!u)}t(l.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});l.VERTEX_FORMAT=r.POSITION_AND_NORMAL;l.FLAT_VERTEX_FORMAT=r.POSITION_ONLY;l.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource;l.prototype.isTranslucent=s.prototype.isTranslucent;l.prototype.getRenderState=s.prototype.getRenderState;return l});define("Renderer/BufferUsage",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={STREAM_DRAW:t.STREAM_DRAW,STATIC_DRAW:t.STATIC_DRAW,DYNAMIC_DRAW:t.DYNAMIC_DRAW,validate:function(e){return e===r.STREAM_DRAW||e===r.STATIC_DRAW||e===r.DYNAMIC_DRAW}};return e(r)});define("Renderer/DrawCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/PrimitiveType"],function(e,t,r,i){"use strict";function n(t){t=e(t,e.EMPTY_OBJECT);this._boundingVolume=t.boundingVolume;this._orientedBoundingBox=t.orientedBoundingBox;this._cull=e(t.cull,true);this._modelMatrix=t.modelMatrix;this._primitiveType=e(t.primitiveType,i.TRIANGLES);this._vertexArray=t.vertexArray;this._count=t.count;this._offset=e(t.offset,0);this._instanceCount=e(t.instanceCount,0);this._shaderProgram=t.shaderProgram;this._uniformMap=t.uniformMap;this._renderState=t.renderState;this._framebuffer=t.framebuffer;this._pass=t.pass;this._executeInClosestFrustum=e(t.executeInClosestFrustum,false);this._owner=t.owner;this._debugShowBoundingVolume=e(t.debugShowBoundingVolume,false);this._debugOverlappingFrustums=0;this._castShadows=e(t.castShadows,false);this._receiveShadows=e(t.receiveShadows,false);this.dirty=true;this.lastDirtyTime=0;this.derivedCommands={}}r(n.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){if(this._boundingVolume!==e){this._boundingVolume=e;this.dirty=true}}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){if(this._orientedBoundingBox!==e){this._orientedBoundingBox=e;this.dirty=true}}},cull:{get:function(){return this._cull},set:function(e){if(this._cull!==e){this._cull=e;this.dirty=true}}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){if(this._modelMatrix!==e){this._modelMatrix=e;this.dirty=true}}},primitiveType:{get:function(){return this._primitiveType},set:function(e){if(this._primitiveType!==e){this._primitiveType=e;this.dirty=true}}},vertexArray:{get:function(){return this._vertexArray},set:function(e){if(this._vertexArray!==e){this._vertexArray=e;this.dirty=true}}},count:{get:function(){return this._count},set:function(e){if(this._count!==e){this._count=e;this.dirty=true}}},offset:{get:function(){return this._offset},set:function(e){if(this._offset!==e){this._offset=e;this.dirty=true}}},instanceCount:{get:function(){return this._instanceCount},set:function(e){if(this._instanceCount!==e){this._instanceCount=e;this.dirty=true}}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){if(this._shaderProgram!==e){this._shaderProgram=e;this.dirty=true}}},castShadows:{get:function(){return this._castShadows},set:function(e){if(this._castShadows!==e){this._castShadows=e;this.dirty=true}}},receiveShadows:{get:function(){return this._receiveShadows},set:function(e){if(this._receiveShadows!==e){this._receiveShadows=e;this.dirty=true}}},uniformMap:{get:function(){return this._uniformMap},set:function(e){if(this._uniformMap!==e){this._uniformMap=e;this.dirty=true}}},renderState:{get:function(){return this._renderState},set:function(e){if(this._renderState!==e){this._renderState=e;this.dirty=true}}},framebuffer:{get:function(){return this._framebuffer},set:function(e){if(this._framebuffer!==e){this._framebuffer=e;this.dirty=true}}},pass:{get:function(){return this._pass},set:function(e){if(this._pass!==e){this._pass=e;this.dirty=true}}},executeInClosestFrustum:{get:function(){return this._executeInClosestFrustum},set:function(e){if(this._executeInClosestFrustum!==e){this._executeInClosestFrustum=e;this.dirty=true}}},owner:{get:function(){return this._owner},set:function(e){if(this._owner!==e){this._owner=e;this.dirty=true}}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){if(this._debugShowBoundingVolume!==e){this._debugShowBoundingVolume=e;this.dirty=true}}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){if(this._debugOverlappingFrustums!==e){this._debugOverlappingFrustums=e;this.dirty=true}}}});n.shallowClone=function(e,r){if(!t(e)){return undefined}if(!t(r)){r=new n}r._boundingVolume=e._boundingVolume;r._orientedBoundingBox=e._orientedBoundingBox;r._cull=e._cull;r._modelMatrix=e._modelMatrix;r._primitiveType=e._primitiveType;r._vertexArray=e._vertexArray;r._count=e._count;r._offset=e._offset;r._instanceCount=e._instanceCount;r._shaderProgram=e._shaderProgram;r._uniformMap=e._uniformMap;r._renderState=e._renderState;r._framebuffer=e._framebuffer;r._pass=e._pass;r._executeInClosestFrustum=e._executeInClosestFrustum;r._owner=e._owner;r._debugShowBoundingVolume=e._debugShowBoundingVolume;r._debugOverlappingFrustums=e._debugOverlappingFrustums;r._castShadows=e._castShadows;r._receiveShadows=e._receiveShadows;r.dirty=true;r.lastDirtyTime=0;return r};n.prototype.execute=function(e,t){e.draw(this,t)};return n});define("Renderer/Pass",["../Core/freezeObject"],function(e){"use strict";var t={ENVIRONMENT:0,COMPUTE:1,GLOBE:2,CESIUM_3D_TILE:3,GROUND:4,OPAQUE:5,TRANSLUCENT:6,OVERLAY:7,NUMBER_OF_PASSES:8};return e(t)});define("Renderer/RenderState",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/WebGLConstants","../Core/WindingOrder","./ContextLimits"],function(e,t,r,i,n,a,o,s){"use strict";function l(e){return e===a.FUNC_ADD||e===a.FUNC_SUBTRACT||e===a.FUNC_REVERSE_SUBTRACT||e===a.MIN||e===a.MAX}function u(e){return e===a.ZERO||e===a.ONE||e===a.SRC_COLOR||e===a.ONE_MINUS_SRC_COLOR||e===a.DST_COLOR||e===a.ONE_MINUS_DST_COLOR||e===a.SRC_ALPHA||e===a.ONE_MINUS_SRC_ALPHA||e===a.DST_ALPHA||e===a.ONE_MINUS_DST_ALPHA||e===a.CONSTANT_COLOR||e===a.ONE_MINUS_CONSTANT_COLOR||e===a.CONSTANT_ALPHA||e===a.ONE_MINUS_CONSTANT_ALPHA||e===a.SRC_ALPHA_SATURATE}function c(e){return e===a.FRONT||e===a.BACK||e===a.FRONT_AND_BACK}function d(e){return e===a.NEVER||e===a.LESS||e===a.EQUAL||e===a.LEQUAL||e===a.GREATER||e===a.NOTEQUAL||e===a.GEQUAL||e===a.ALWAYS}function f(e){return e===a.NEVER||e===a.LESS||e===a.EQUAL||e===a.LEQUAL||e===a.GREATER||e===a.NOTEQUAL||e===a.GEQUAL||e===a.ALWAYS}function h(e){return e===a.ZERO||e===a.KEEP||e===a.REPLACE||e===a.INCR||e===a.DECR||e===a.INVERT||e===a.INCR_WRAP||e===a.DECR_WRAP}function p(p){var m=r(p,{});var v=r(m.cull,{});var g=r(m.polygonOffset,{});var _=r(m.scissorTest,{});var y=r(_.rectangle,{});var b=r(m.depthRange,{});var w=r(m.depthTest,{});var C=r(m.colorMask,{});var S=r(m.blending,{});var T=r(S.color,{});var E=r(m.stencilTest,{});var x=r(E.frontOperation,{});var P=r(E.backOperation,{});var A=r(m.sampleCoverage,{});var O=m.viewport;this.frontFace=r(m.frontFace,o.COUNTER_CLOCKWISE);this.cull={enabled:r(v.enabled,false),face:r(v.face,a.BACK)};this.lineWidth=r(m.lineWidth,1);this.polygonOffset={enabled:r(g.enabled,false),factor:r(g.factor,0),units:r(g.units,0)};this.scissorTest={enabled:r(_.enabled,false),rectangle:e.clone(y)};this.depthRange={near:r(b.near,0),far:r(b.far,1)};this.depthTest={enabled:r(w.enabled,false),func:r(w.func,a.LESS)};this.colorMask={red:r(C.red,true),green:r(C.green,true),blue:r(C.blue,true),alpha:r(C.alpha,true)};this.depthMask=r(m.depthMask,true);this.stencilMask=r(m.stencilMask,~0);this.blending={enabled:r(S.enabled,false),color:new t(r(T.red,0),r(T.green,0),r(T.blue,0),r(T.alpha,0)),equationRgb:r(S.equationRgb,a.FUNC_ADD),equationAlpha:r(S.equationAlpha,a.FUNC_ADD),functionSourceRgb:r(S.functionSourceRgb,a.ONE),functionSourceAlpha:r(S.functionSourceAlpha,a.ONE),functionDestinationRgb:r(S.functionDestinationRgb,a.ZERO),functionDestinationAlpha:r(S.functionDestinationAlpha,a.ZERO)};this.stencilTest={enabled:r(E.enabled,false),frontFunction:r(E.frontFunction,a.ALWAYS),backFunction:r(E.backFunction,a.ALWAYS),reference:r(E.reference,0),mask:r(E.mask,~0),frontOperation:{fail:r(x.fail,a.KEEP),zFail:r(x.zFail,a.KEEP),zPass:r(x.zPass,a.KEEP)},backOperation:{fail:r(P.fail,a.KEEP),zFail:r(P.zFail,a.KEEP),zPass:r(P.zPass,a.KEEP)}};this.sampleCoverage={enabled:r(A.enabled,false),value:r(A.value,1),invert:r(A.invert,false)};this.viewport=i(O)?new e(O.x,O.y,O.width,O.height):undefined;if(this.lineWidth<s.minimumAliasedLineWidth||this.lineWidth>s.maximumAliasedLineWidth){throw new n("renderState.lineWidth is out of range.  Check minimumAliasedLineWidth and maximumAliasedLineWidth.")}if(!o.validate(this.frontFace)){throw new n("Invalid renderState.frontFace.")}if(!c(this.cull.face)){throw new n("Invalid renderState.cull.face.")}if(this.scissorTest.rectangle.width<0||this.scissorTest.rectangle.height<0){throw new n("renderState.scissorTest.rectangle.width and renderState.scissorTest.rectangle.height must be greater than or equal to zero.")}if(this.depthRange.near>this.depthRange.far){throw new n("renderState.depthRange.near can not be greater than renderState.depthRange.far.")}if(this.depthRange.near<0){throw new n("renderState.depthRange.near must be greater than or equal to zero.")}if(this.depthRange.far>1){throw new n("renderState.depthRange.far must be less than or equal to one.")}if(!d(this.depthTest.func)){throw new n("Invalid renderState.depthTest.func.")}if(this.blending.color.red<0||this.blending.color.red>1||this.blending.color.green<0||this.blending.color.green>1||this.blending.color.blue<0||this.blending.color.blue>1||this.blending.color.alpha<0||this.blending.color.alpha>1){throw new n("renderState.blending.color components must be greater than or equal to zero and less than or equal to one.")}if(!l(this.blending.equationRgb)){throw new n("Invalid renderState.blending.equationRgb.")}if(!l(this.blending.equationAlpha)){throw new n("Invalid renderState.blending.equationAlpha.")}if(!u(this.blending.functionSourceRgb)){throw new n("Invalid renderState.blending.functionSourceRgb.")}if(!u(this.blending.functionSourceAlpha)){throw new n("Invalid renderState.blending.functionSourceAlpha.")}if(!u(this.blending.functionDestinationRgb)){throw new n("Invalid renderState.blending.functionDestinationRgb.")}if(!u(this.blending.functionDestinationAlpha)){throw new n("Invalid renderState.blending.functionDestinationAlpha.")}if(!f(this.stencilTest.frontFunction)){throw new n("Invalid renderState.stencilTest.frontFunction.")}if(!f(this.stencilTest.backFunction)){throw new n("Invalid renderState.stencilTest.backFunction.")}if(!h(this.stencilTest.frontOperation.fail)){throw new n("Invalid renderState.stencilTest.frontOperation.fail.")}if(!h(this.stencilTest.frontOperation.zFail)){throw new n("Invalid renderState.stencilTest.frontOperation.zFail.")}if(!h(this.stencilTest.frontOperation.zPass)){throw new n("Invalid renderState.stencilTest.frontOperation.zPass.")}if(!h(this.stencilTest.backOperation.fail)){throw new n("Invalid renderState.stencilTest.backOperation.fail.")}if(!h(this.stencilTest.backOperation.zFail)){throw new n("Invalid renderState.stencilTest.backOperation.zFail.")}if(!h(this.stencilTest.backOperation.zPass)){throw new n("Invalid renderState.stencilTest.backOperation.zPass.")}if(i(this.viewport)){if(this.viewport.width<0){throw new n("renderState.viewport.width must be greater than or equal to zero.")}if(this.viewport.height<0){throw new n("renderState.viewport.height must be greater than or equal to zero.")}if(this.viewport.width>s.maximumViewportWidth){throw new n("renderState.viewport.width must be less than or equal to the maximum viewport width ("+s.maximumViewportWidth.toString()+").  Check maximumViewportWidth.")}if(this.viewport.height>s.maximumViewportHeight){throw new n("renderState.viewport.height must be less than or equal to the maximum viewport height ("+s.maximumViewportHeight.toString()+").  Check maximumViewportHeight.")}}this.id=0;this._applyFunctions=[]}var m=0;var v={};p.fromCache=function(e){var t=JSON.stringify(e);var r=v[t];if(i(r)){++r.referenceCount;return r.state}var n=new p(e);var a=JSON.stringify(n);r=v[a];if(!i(r)){n.id=m++;r={referenceCount:0,state:n};v[a]=r}++r.referenceCount;v[t]={referenceCount:1,state:r.state};return r.state};p.removeFromCache=function(e){var t=new p(e);var r=JSON.stringify(t);var n=v[r];var a=JSON.stringify(e);var o=v[a];if(i(o)){--o.referenceCount;if(o.referenceCount===0){delete v[a];if(i(n)){--n.referenceCount}}}if(i(n)&&n.referenceCount===0){delete v[r]}};p.getCache=function(){return v};p.clearCache=function(){v={}};function g(e,t,r){if(r){e.enable(t)}else{e.disable(t)}}function _(e,t){e.frontFace(t.frontFace)}function y(e,t){var r=t.cull;var i=r.enabled;g(e,e.CULL_FACE,i);if(i){e.cullFace(r.face)}}function b(e,t){e.lineWidth(t.lineWidth)}function w(e,t){var r=t.polygonOffset;var i=r.enabled;g(e,e.POLYGON_OFFSET_FILL,i);if(i){e.polygonOffset(r.factor,r.units)}}function C(e,t,r){var n=t.scissorTest;var a=i(r.scissorTest)?r.scissorTest.enabled:n.enabled;g(e,e.SCISSOR_TEST,a);if(a){var o=i(r.scissorTest)?r.scissorTest.rectangle:n.rectangle;e.scissor(o.x,o.y,o.width,o.height)}}function S(e,t){var r=t.depthRange;e.depthRange(r.near,r.far)}function T(e,t){var r=t.depthTest;var i=r.enabled;g(e,e.DEPTH_TEST,i);if(i){e.depthFunc(r.func)}}function E(e,t){var r=t.colorMask;e.colorMask(r.red,r.green,r.blue,r.alpha)}function x(e,t){e.depthMask(t.depthMask)}function P(e,t){e.stencilMask(t.stencilMask)}function A(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}function O(e,t,r){var n=t.blending;var a=i(r.blendingEnabled)?r.blendingEnabled:n.enabled;g(e,e.BLEND,a);if(a){A(e,n.color);e.blendEquationSeparate(n.equationRgb,n.equationAlpha);e.blendFuncSeparate(n.functionSourceRgb,n.functionDestinationRgb,n.functionSourceAlpha,n.functionDestinationAlpha)}}function D(e,t){var r=t.stencilTest;var i=r.enabled;g(e,e.STENCIL_TEST,i);if(i){var n=r.frontFunction;var a=r.backFunction;var o=r.reference;var s=r.mask;e.stencilFunc(n,o,s);e.stencilFuncSeparate(e.BACK,a,o,s);e.stencilFuncSeparate(e.FRONT,n,o,s);var l=r.frontOperation;var u=l.fail;var c=l.zFail;var d=l.zPass;e.stencilOpSeparate(e.FRONT,u,c,d);var f=r.backOperation;var h=f.fail;var p=f.zFail;var m=f.zPass;e.stencilOpSeparate(e.BACK,h,p,m)}}function I(e,t){var r=t.sampleCoverage;var i=r.enabled;g(e,e.SAMPLE_COVERAGE,i);if(i){e.sampleCoverage(r.value,r.invert)}}var M=new e;function R(e,t,n){var a=r(t.viewport,n.viewport);if(!i(a)){a=M;a.width=n.context.drawingBufferWidth;a.height=n.context.drawingBufferHeight}n.context.uniformState.viewport=a;e.viewport(a.x,a.y,a.width,a.height)}p.apply=function(e,t,r){_(e,t);y(e,t);b(e,t);w(e,t);S(e,t);T(e,t);E(e,t);x(e,t);P(e,t);D(e,t);I(e,t);C(e,t,r);O(e,t,r);R(e,t,r)};function L(e,t){var r=[];if(e.frontFace!==t.frontFace){r.push(_)}if(e.cull.enabled!==t.cull.enabled||e.cull.face!==t.cull.face){r.push(y)}if(e.lineWidth!==t.lineWidth){r.push(b)}if(e.polygonOffset.enabled!==t.polygonOffset.enabled||e.polygonOffset.factor!==t.polygonOffset.factor||e.polygonOffset.units!==t.polygonOffset.units){r.push(w)}if(e.depthRange.near!==t.depthRange.near||e.depthRange.far!==t.depthRange.far){r.push(S)}if(e.depthTest.enabled!==t.depthTest.enabled||e.depthTest.func!==t.depthTest.func){r.push(T)}if(e.colorMask.red!==t.colorMask.red||e.colorMask.green!==t.colorMask.green||e.colorMask.blue!==t.colorMask.blue||e.colorMask.alpha!==t.colorMask.alpha){r.push(E)}if(e.depthMask!==t.depthMask){r.push(x)}if(e.stencilMask!==t.stencilMask){r.push(P)}if(e.stencilTest.enabled!==t.stencilTest.enabled||e.stencilTest.frontFunction!==t.stencilTest.frontFunction||e.stencilTest.backFunction!==t.stencilTest.backFunction||e.stencilTest.reference!==t.stencilTest.reference||e.stencilTest.mask!==t.stencilTest.mask||e.stencilTest.frontOperation.fail!==t.stencilTest.frontOperation.fail||e.stencilTest.frontOperation.zFail!==t.stencilTest.frontOperation.zFail||e.stencilTest.backOperation.fail!==t.stencilTest.backOperation.fail||e.stencilTest.backOperation.zFail!==t.stencilTest.backOperation.zFail||e.stencilTest.backOperation.zPass!==t.stencilTest.backOperation.zPass){r.push(D)}if(e.sampleCoverage.enabled!==t.sampleCoverage.enabled||e.sampleCoverage.value!==t.sampleCoverage.value||e.sampleCoverage.invert!==t.sampleCoverage.invert){r.push(I)}return r}p.partialApply=function(e,t,r,n,a,o){if(t!==r){var s=r._applyFunctions[t.id];if(!i(s)){s=L(t,r);r._applyFunctions[t.id]=s}var l=s.length;for(var u=0;u<l;++u){s[u](e,r)}}var c=i(n.scissorTest)?n.scissorTest:t.scissorTest;var d=i(a.scissorTest)?a.scissorTest:r.scissorTest;if(c!==d||o){C(e,r,a)}var f=i(n.blendingEnabled)?n.blendingEnabled:t.blending.enabled;var h=i(a.blendingEnabled)?a.blendingEnabled:r.blending.enabled;if(f!==h||h&&t.blending!==r.blending){O(e,r,a)}if(t!==r||n!==a||n.context!==a.context){R(e,r,a)}};p.getState=function(r){if(!i(r)){throw new n("renderState is required.")}return{frontFace:r.frontFace,cull:{enabled:r.cull.enabled,face:r.cull.face},lineWidth:r.lineWidth,polygonOffset:{enabled:r.polygonOffset.enabled,factor:r.polygonOffset.factor,units:r.polygonOffset.units},scissorTest:{enabled:r.scissorTest.enabled,rectangle:e.clone(r.scissorTest.rectangle)},depthRange:{near:r.depthRange.near,far:r.depthRange.far},depthTest:{enabled:r.depthTest.enabled,func:r.depthTest.func},colorMask:{red:r.colorMask.red,green:r.colorMask.green,blue:r.colorMask.blue,alpha:r.colorMask.alpha},depthMask:r.depthMask,stencilMask:r.stencilMask,blending:{enabled:r.blending.enabled,color:t.clone(r.blending.color),equationRgb:r.blending.equationRgb,equationAlpha:r.blending.equationAlpha,functionSourceRgb:r.blending.functionSourceRgb,functionSourceAlpha:r.blending.functionSourceAlpha,functionDestinationRgb:r.blending.functionDestinationRgb,functionDestinationAlpha:r.blending.functionDestinationAlpha},stencilTest:{enabled:r.stencilTest.enabled,frontFunction:r.stencilTest.frontFunction,backFunction:r.stencilTest.backFunction,reference:r.stencilTest.reference,mask:r.stencilTest.mask,frontOperation:{fail:r.stencilTest.frontOperation.fail,zFail:r.stencilTest.frontOperation.zFail,zPass:r.stencilTest.frontOperation.zPass},backOperation:{fail:r.stencilTest.backOperation.fail,zFail:r.stencilTest.backOperation.zFail,zPass:r.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:r.sampleCoverage.enabled,value:r.sampleCoverage.value,invert:r.sampleCoverage.invert},viewport:i(r.viewport)?e.clone(r.viewport):undefined}};return p});define("Renderer/AutomaticUniforms",["../Core/Cartesian3","../Core/Matrix4","../Core/WebGLConstants"],function(e,t,r){"use strict";var i=new e;function n(e){this._size=e.size;this._datatype=e.datatype;this.getValue=e.getValue}if(typeof WebGLRenderingContext==="undefined"){return{}}var a={};a[r.FLOAT]="float";a[r.FLOAT_VEC2]="vec2";a[r.FLOAT_VEC3]="vec3";a[r.FLOAT_VEC4]="vec4";a[r.INT]="int";a[r.INT_VEC2]="ivec2";a[r.INT_VEC3]="ivec3";a[r.INT_VEC4]="ivec4";a[r.BOOL]="bool";a[r.BOOL_VEC2]="bvec2";a[r.BOOL_VEC3]="bvec3";a[r.BOOL_VEC4]="bvec4";a[r.FLOAT_MAT2]="mat2";a[r.FLOAT_MAT3]="mat3";a[r.FLOAT_MAT4]="mat4";a[r.SAMPLER_2D]="sampler2D";a[r.SAMPLER_CUBE]="samplerCube";n.prototype.getDeclaration=function(e){var t="uniform "+a[this._datatype]+" "+e;var r=this._size;if(r===1){t+=";"}else{t+="["+r.toString()+"];"}return t};var o={czm_viewport:new n({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new n({size:1,datatype:r.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new n({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_normal:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight2D:new n({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new n({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new n({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new n({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_sunPositionWC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_encodedCameraPositionMCHigh:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new n({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return t.getTranslation(e.inverseView,i)}}),czm_frameNumber:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new n({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new n({size:1,datatype:r.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new n({size:1,datatype:r.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_temeToPseudoFixed:new n({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_resolutionScale:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.resolutionScale}}),czm_fogDensity:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.fogDensity}}),czm_imagerySplitPosition:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.imagerySplitPosition}}),czm_geometricToleranceOverMeter:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new n({size:1,datatype:r.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}})};return o});define("Renderer/createUniform",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e,t,r,i){switch(t.type){case e.FLOAT:return new d(e,t,r,i);case e.FLOAT_VEC2:return new f(e,t,r,i);case e.FLOAT_VEC3:return new h(e,t,r,i);case e.FLOAT_VEC4:return new p(e,t,r,i);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new m(e,t,r,i);case e.INT:case e.BOOL:return new v(e,t,r,i);case e.INT_VEC2:case e.BOOL_VEC2:return new g(e,t,r,i);case e.INT_VEC3:case e.BOOL_VEC3:return new _(e,t,r,i);case e.INT_VEC4:case e.BOOL_VEC4:return new y(e,t,r,i);case e.FLOAT_MAT2:return new b(e,t,r,i);case e.FLOAT_MAT3:return new w(e,t,r,i);case e.FLOAT_MAT4:return new C(e,t,r,i);default:throw new u("Unrecognized uniform type: "+t.type+' for uniform "'+r+'".')}}function d(e,t,r,i){this.name=r;this.value=undefined;this._value=0;this._gl=e;this._location=i}d.prototype.set=function(){if(this.value!==this._value){this._value=this.value;this._gl.uniform1f(this._location,this.value)}};function f(t,r,i,n){this.name=i;this.value=undefined;this._value=new e;this._gl=t;this._location=n}f.prototype.set=function(){var t=this.value;if(!e.equals(t,this._value)){e.clone(t,this._value);this._gl.uniform2f(this._location,t.x,t.y)}};function h(e,t,r,i){this.name=r;this.value=undefined;this._value=undefined;this._gl=e;this._location=i}h.prototype.set=function(){var e=this.value;if(n(e.red)){if(!i.equals(e,this._value)){this._value=i.clone(e,this._value);this._gl.uniform3f(this._location,e.red,e.green,e.blue)}}else if(n(e.x)){if(!t.equals(e,this._value)){this._value=t.clone(e,this._value);this._gl.uniform3f(this._location,e.x,e.y,e.z)}}else{throw new a('Invalid vec3 value for uniform "'+this._activethis.name+'".')}};function p(e,t,r,i){this.name=r;this.value=undefined;this._value=undefined;this._gl=e;this._location=i}p.prototype.set=function(){var e=this.value;if(n(e.red)){if(!i.equals(e,this._value)){this._value=i.clone(e,this._value);this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha)}}else if(n(e.x)){if(!r.equals(e,this._value)){this._value=r.clone(e,this._value);this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w)}}else{throw new a('Invalid vec4 value for uniform "'+this._activethis.name+'".')}};function m(e,t,r,i){this.name=r;this.value=undefined;this._gl=e;this._location=i;this.textureUnitIndex=undefined}m.prototype.set=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);var t=this.value;e.bindTexture(t._target,t._texture)};m.prototype._setSampler=function(e){this.textureUnitIndex=e;this._gl.uniform1i(this._location,e);return e+1};function v(e,t,r,i){this.name=r;this.value=undefined;this._value=0;this._gl=e;this._location=i}v.prototype.set=function(){if(this.value!==this._value){this._value=this.value;this._gl.uniform1i(this._location,this.value)}};function g(t,r,i,n){this.name=i;this.value=undefined;this._value=new e;this._gl=t;this._location=n}g.prototype.set=function(){var t=this.value;if(!e.equals(t,this._value)){e.clone(t,this._value);this._gl.uniform2i(this._location,t.x,t.y)}};function _(e,r,i,n){this.name=i;this.value=undefined;this._value=new t;this._gl=e;this._location=n}_.prototype.set=function(){var e=this.value;if(!t.equals(e,this._value)){t.clone(e,this._value);this._gl.uniform3i(this._location,e.x,e.y,e.z)}};function y(e,t,i,n){this.name=i;this.value=undefined;this._value=new r;this._gl=e;this._location=n}y.prototype.set=function(){var e=this.value;if(!r.equals(e,this._value)){r.clone(e,this._value);this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w)}};function b(e,t,r,i){this.name=r;this.value=undefined;this._value=new Float32Array(4);this._gl=e;this._location=i}b.prototype.set=function(){if(!o.equalsArray(this.value,this._value,0)){o.toArray(this.value,this._value);this._gl.uniformMatrix2fv(this._location,false,this._value)}};function w(e,t,r,i){this.name=r;this.value=undefined;this._value=new Float32Array(9);this._gl=e;this._location=i}w.prototype.set=function(){if(!s.equalsArray(this.value,this._value,0)){s.toArray(this.value,this._value);this._gl.uniformMatrix3fv(this._location,false,this._value)}};function C(e,t,r,i){this.name=r;this.value=undefined;this._value=new Float32Array(16);this._gl=e;this._location=i}C.prototype.set=function(){if(!l.equalsArray(this.value,this._value,0)){l.toArray(this.value,this._value);this._gl.uniformMatrix4fv(this._location,false,this._value)}};return c});define("Renderer/createUniformArray",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e,t,r,i){switch(t.type){case e.FLOAT:return new d(e,t,r,i);case e.FLOAT_VEC2:return new f(e,t,r,i);case e.FLOAT_VEC3:return new h(e,t,r,i);case e.FLOAT_VEC4:return new p(e,t,r,i);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new m(e,t,r,i);case e.INT:case e.BOOL:return new v(e,t,r,i);case e.INT_VEC2:case e.BOOL_VEC2:return new g(e,t,r,i);case e.INT_VEC3:case e.BOOL_VEC3:return new _(e,t,r,i);case e.INT_VEC4:case e.BOOL_VEC4:return new y(e,t,r,i);case e.FLOAT_MAT2:return new b(e,t,r,i);case e.FLOAT_MAT3:return new w(e,t,r,i);case e.FLOAT_MAT4:return new C(e,t,r,i);default:throw new u("Unrecognized uniform type: "+t.type+' for uniform "'+r+'".')}}function d(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n);this._gl=e;this._location=i[0]}d.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;for(var n=0;n<t;++n){var a=e[n];if(a!==r[n]){r[n]=a;i=true}}if(i){this._gl.uniform1fv(this._location,r)}};function f(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*2);this._gl=e;this._location=i[0]}f.prototype.set=function(){var t=this.value;var r=t.length;var i=this._value;var n=false;var a=0;for(var o=0;o<r;++o){var s=t[o];if(!e.equalsArray(s,i,a)){e.pack(s,i,a);n=true}a+=2}if(n){this._gl.uniform2fv(this._location,i)}};function h(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*3);this._gl=e;this._location=i[0]}h.prototype.set=function(){var e=this.value;var r=e.length;var i=this._value;var o=false;var s=0;for(var l=0;l<r;++l){var u=e[l];if(n(u.red)){if(u.red!==i[s]||u.green!==i[s+1]||u.blue!==i[s+2]){i[s]=u.red;i[s+1]=u.green;i[s+2]=u.blue;o=true}}else if(n(u.x)){if(!t.equalsArray(u,i,s)){t.pack(u,i,s);o=true}}else{throw new a("Invalid vec3 value.")}s+=3}if(o){this._gl.uniform3fv(this._location,i)}};function p(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*4);this._gl=e;this._location=i[0]}p.prototype.set=function(){var e=this.value;var t=e.length;var o=this._value;var s=false;var l=0;for(var u=0;u<t;++u){var c=e[u];if(n(c.red)){if(!i.equalsArray(c,o,l)){i.pack(c,o,l);s=true}}else if(n(c.x)){if(!r.equalsArray(c,o,l)){r.pack(c,o,l);s=true}}else{throw new a("Invalid vec4 value.")}l+=4}if(s){this._gl.uniform4fv(this._location,o)}};function m(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n);this._gl=e;this._locations=i;this.textureUnitIndex=undefined}m.prototype.set=function(){var e=this._gl;var t=e.TEXTURE0+this.textureUnitIndex;var r=this.value;var i=r.length;for(var n=0;n<i;++n){var a=r[n];e.activeTexture(t+n);e.bindTexture(a._target,a._texture)}};m.prototype._setSampler=function(e){this.textureUnitIndex=e;var t=this._locations;var r=t.length;for(var i=0;i<r;++i){var n=e+i;this._gl.uniform1i(t[i],n)}return e+r};function v(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Int32Array(n);this._gl=e;this._location=i[0]}v.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;for(var n=0;n<t;++n){var a=e[n];if(a!==r[n]){r[n]=a;i=true}}if(i){this._gl.uniform1iv(this._location,r)}};function g(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Int32Array(n*2);this._gl=e;this._location=i[0]}g.prototype.set=function(){var t=this.value;var r=t.length;var i=this._value;var n=false;var a=0;for(var o=0;o<r;++o){var s=t[o];if(!e.equalsArray(s,i,a)){e.pack(s,i,a);n=true}a+=2}if(n){this._gl.uniform2iv(this._location,i)}};function _(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Int32Array(n*3);this._gl=e;this._location=i[0]}_.prototype.set=function(){var e=this.value;var r=e.length;var i=this._value;var n=false;var a=0;for(var o=0;o<r;++o){var s=e[o];if(!t.equalsArray(s,i,a)){t.pack(s,i,a);n=true}a+=3}if(n){this._gl.uniform3iv(this._location,i)}};function y(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Int32Array(n*4);this._gl=e;this._location=i[0]}y.prototype.set=function(){var e=this.value;var t=e.length;var i=this._value;var n=false;var a=0;for(var o=0;o<t;++o){var s=e[o];if(!r.equalsArray(s,i,a)){r.pack(s,i,a);n=true}a+=4}if(n){this._gl.uniform4iv(this._location,i)}};function b(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*4);this._gl=e;this._location=i[0]}b.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;var n=0;for(var a=0;a<t;++a){var s=e[a];if(!o.equalsArray(s,r,n)){o.pack(s,r,n);i=true}n+=4}if(i){this._gl.uniformMatrix2fv(this._location,false,r)}};function w(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*9);this._gl=e;this._location=i[0]}w.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;var n=0;for(var a=0;a<t;++a){var o=e[a];if(!s.equalsArray(o,r,n)){s.pack(o,r,n);i=true}n+=9}if(i){this._gl.uniformMatrix3fv(this._location,false,r)}};function C(e,t,r,i){var n=i.length;this.name=r;this.value=new Array(n);this._value=new Float32Array(n*16);this._gl=e;this._location=i[0]}C.prototype.set=function(){var e=this.value;var t=e.length;var r=this._value;var i=false;var n=0;for(var a=0;a<t;++a){var o=e[a];if(!l.equalsArray(o,r,n)){l.pack(o,r,n);i=true}n+=16}if(i){this._gl.uniformMatrix4fv(this._location,false,r)}};return c});define("Renderer/ShaderProgram",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/RuntimeError","./AutomaticUniforms","./ContextLimits","./createUniform","./createUniformArray"],function(e,t,r,i,n,a,o,s,l,u){"use strict";var c=0;function d(e){var t=h(e.vertexShaderText,e.fragmentShaderText);this._gl=e.gl;this._logShaderCompilation=e.logShaderCompilation;this._debugShaders=e.debugShaders;this._attributeLocations=e.attributeLocations;this._program=undefined;this._numberOfVertexAttributes=undefined;this._vertexAttributes=undefined;this._uniformsByName=undefined;this._uniforms=undefined;this._automaticUniforms=undefined;this._manualUniforms=undefined;this._duplicateUniformNames=t.duplicateUniformNames;this._cachedShader=undefined;this.maximumTextureUnitIndex=undefined;this._vertexShaderSource=e.vertexShaderSource;this._vertexShaderText=e.vertexShaderText;this._fragmentShaderSource=e.fragmentShaderSource;this._fragmentShaderText=t.fragmentShaderText;this.id=c++}d.fromCache=function(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}return r.context.shaderCache.getShaderProgram(r)};d.replaceCache=function(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}return r.context.shaderCache.replaceShaderProgram(r)};r(d.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){b(this);return this._vertexAttributes}},numberOfVertexAttributes:{get:function(){b(this);return this._numberOfVertexAttributes}},allUniforms:{get:function(){b(this);return this._uniformsByName}}});function f(e){var r=[];var i=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(t(i)){var n=i.length;for(var a=0;a<n;a++){var o=i[a].trim();var s=o.slice(o.lastIndexOf(" ")+1);r.push(s)}}return r}function h(e,t){var r={};if(!s.highpFloatSupported||!s.highpIntSupported){var i,n;var a;var o;var l=f(e);var u=f(t);var c=l.length;var d=u.length;for(i=0;i<c;i++){for(n=0;n<d;n++){if(l[i]===u[n]){a=l[i];o="czm_mediump_"+a;var h=new RegExp(a+"\\b","g");t=t.replace(h,o);r[o]=a}}}}return{fragmentShaderText:t,duplicateUniformNames:r}}var p="[Cesium WebGL] ";function m(e,r){var i=r._vertexShaderText;var n=r._fragmentShaderText;var o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,i);e.compileShader(o);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,n);e.compileShader(s);var l=e.createProgram();e.attachShader(l,o);e.attachShader(l,s);e.deleteShader(o);e.deleteShader(s);var u=r._attributeLocations;if(t(u)){for(var c in u){if(u.hasOwnProperty(c)){e.bindAttribLocation(l,u[c],c)}}}e.linkProgram(l);var d;if(!e.getProgramParameter(l,e.LINK_STATUS)){var f=r._debugShaders;if(!e.getShaderParameter(s,e.COMPILE_STATUS)){d=e.getShaderInfoLog(s);console.error(p+"Fragment shader compile log: "+d);if(t(f)){var h=f.getTranslatedShaderSource(s);if(h!==""){console.error(p+"Translated fragment shader source:\n"+h)}else{console.error(p+"Fragment shader translation failed.")}}e.deleteProgram(l);throw new a("Fragment shader failed to compile.  Compile log: "+d)}if(!e.getShaderParameter(o,e.COMPILE_STATUS)){d=e.getShaderInfoLog(o);console.error(p+"Vertex shader compile log: "+d);if(t(f)){var m=f.getTranslatedShaderSource(o);if(m!==""){console.error(p+"Translated vertex shader source:\n"+m)}else{console.error(p+"Vertex shader translation failed.")}}e.deleteProgram(l);throw new a("Vertex shader failed to compile.  Compile log: "+d)}d=e.getProgramInfoLog(l);console.error(p+"Shader program link log: "+d);if(t(f)){console.error(p+"Translated vertex shader source:\n"+f.getTranslatedShaderSource(o));console.error(p+"Translated fragment shader source:\n"+f.getTranslatedShaderSource(s))}e.deleteProgram(l);throw new a("Program failed to link.  Link log: "+d)}var v=r._logShaderCompilation;if(v){d=e.getShaderInfoLog(o);if(t(d)&&d.length>0){console.log(p+"Vertex shader compile log: "+d)}}if(v){d=e.getShaderInfoLog(s);if(t(d)&&d.length>0){console.log(p+"Fragment shader compile log: "+d)}}if(v){d=e.getProgramInfoLog(l);if(t(d)&&d.length>0){console.log(p+"Shader program link log: "+d)}}return l}function v(e,t,r){var i={};for(var n=0;n<r;++n){var a=e.getActiveAttrib(t,n);var o=e.getAttribLocation(t,a.name);i[a.name]={name:a.name,type:a.type,index:o}}return i}function g(e,r){var i={};var n=[];var a=[];var o=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(var s=0;s<o;++s){var c=e.getActiveUniform(r,s);var d="[0]";var f=c.name.indexOf(d,c.name.length-d.length)!==-1?c.name.slice(0,c.name.length-3):c.name;if(f.indexOf("gl_")!==0){if(c.name.indexOf("[")<0){var h=e.getUniformLocation(r,f);if(h!==null){var p=l(e,c,f,h);i[f]=p;n.push(p);if(p._setSampler){a.push(p)}}}else{var m;var v;var g;var _;var y=f.indexOf("[");if(y>=0){m=i[f.slice(0,y)];if(!t(m)){continue}v=m._locations;if(v.length<=1){g=m.value;_=e.getUniformLocation(r,f);if(_!==null){v.push(_);g.push(e.getUniform(r,_))}}}else{v=[];for(var b=0;b<c.size;++b){_=e.getUniformLocation(r,f+"["+b+"]");if(_!==null){v.push(_)}}m=u(e,c,f,v);i[f]=m;n.push(m);if(m._setSampler){a.push(m)}}}}}return{uniformsByName:i,uniforms:n,samplerUniforms:a}}function _(e,r){var i=[];var n=[];for(var a in r){if(r.hasOwnProperty(a)){var s=r[a];var l=a;var u=e._duplicateUniformNames[l];if(t(u)){s.name=u;l=u}var c=o[l];if(t(c)){i.push({uniform:s,automaticUniform:c})}else{n.push(s)}}}return{automaticUniforms:i,manualUniforms:n}}function y(e,t,r){e.useProgram(t);var i=0;var n=r.length;for(var a=0;a<n;++a){i=r[a]._setSampler(i)}e.useProgram(null);return i}function b(e){if(t(e._program)){return}var r=e._gl;var i=m(r,e,e._debugShaders);var n=r.getProgramParameter(i,r.ACTIVE_ATTRIBUTES);var a=g(r,i);var o=_(e,a.uniformsByName);e._program=i;e._numberOfVertexAttributes=n;e._vertexAttributes=v(r,i,n);e._uniformsByName=a.uniformsByName;e._uniforms=a.uniforms;e._automaticUniforms=o.automaticUniforms;e._manualUniforms=o.manualUniforms;e.maximumTextureUnitIndex=y(r,i,a.samplerUniforms)}d.prototype._bind=function(){b(this);this._gl.useProgram(this._program)};d.prototype._setUniforms=function(e,r,i){var a;var o;if(t(e)){var s=this._manualUniforms;a=s.length;for(o=0;o<a;++o){var l=s[o];l.value=e[l.name]()}}var u=this._automaticUniforms;a=u.length;for(o=0;o<a;++o){var c=u[o];c.uniform.value=c.automaticUniform.getValue(r)}var d=this._uniforms;a=d.length;for(o=0;o<a;++o){d[o].set()}if(i){var f=this._gl;var h=this._program;f.validateProgram(h);if(!f.getProgramParameter(h,f.VALIDATE_STATUS)){throw new n("Program validation failed.  Program info log: "+f.getProgramInfoLog(h))}}};d.prototype.isDestroyed=function(){return false};d.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this);return undefined};d.prototype.finalDestroy=function(){this._gl.deleteProgram(this._program);return i(this)};return d});define("Renderer/modernizeShader",["../Core/defined","../Core/DeveloperError"],function(e,t){"use strict";function r(e,r){var n=/#define OUTPUT_DECLARATION/;var c=e.split("\n");if(/#version 300 es/g.test(e)){return e}var d=-1;var f,h;for(f=0;f<c.length;++f){h=c[f];if(n.test(h)){d=f;break}}if(d===-1){throw new t("Could not find a #define OUTPUT_DECLARATION!")}var p=[];for(f=0;f<10;f++){var m="gl_FragData\\["+f+"\\]";var v="czm_out"+f;var g=new RegExp(m,"g");if(g.test(e)){s(v,p);i(m,v,c);c.splice(d,0,"layout(location = "+f+") out vec4 "+v+";");d+=1}}var _="czm_fragColor";if(a("gl_FragColor",c)){s(_,p);i("gl_FragColor",_,c);c.splice(d,0,"layout(location = 0) out vec4 czm_fragColor;");d+=1}var y=l(p,c);var b={};for(f=0;f<c.length;f++){h=c[f];for(var w in y){if(y.hasOwnProperty(w)){var C=new RegExp("(layout)[^]+(out)[^]+("+w+")[^]+","g");if(C.test(h)){b[h]=w}}}}for(var S in b){if(b.hasOwnProperty(S)){var T=b[S];var E=c.indexOf(S);var x=y[T];var P=x.length;var A;for(A=0;A<P;A++){c.splice(E,0,x[A])}E+=P+1;for(A=P-1;A>=0;A--){c.splice(E,0,"#endif //"+x[A])}}}var O="#version 300 es";var D=false;for(f=0;f<c.length;f++){if(/#version/.test(c[f])){c[f]=O;D=true}}if(!D){c.splice(0,0,O)}u("EXT_draw_buffers",c);u("EXT_frag_depth",c);i("texture2D","texture",c);i("texture3D","texture",c);i("textureCube","texture",c);i("gl_FragDepthEXT","gl_FragDepth",c);if(r){i("varying","in",c)}else{i("attribute","in",c);i("varying","out",c)}return o(c)}function i(e,t,r){var i="(^|[^\\w])("+e+")($|[^\\w])";var n=new RegExp(i,"g");var a=r.length;for(var o=0;o<a;++o){var s=r[o];r[o]=s.replace(n,"$1"+t+"$3")}}function n(e,t,r){var i=r.length;for(var n=0;n<i;++n){var a=r[n];r[n]=a.replace(e,t)}}function a(e,t){var r="(^|[^\\w])("+e+")($|[^\\w])";var i=new RegExp(r,"g");var n=t.length;for(var a=0;a<n;++a){var o=t[a];if(i.test(o)){return true}}return false}function o(e){var t="";var r=e.length;for(var i=0;i<r;++i){t+=e[i]+"\n"}return t}function s(e,t){if(t.indexOf(e)===-1){t.push(e)}}function l(t,r){var i={};var n=t.length;var a=[];for(var o=0;o<r.length;++o){var s=r[o];var l=/(#ifdef|#if)/g.test(s);var u=/#else/g.test(s);var c=/#endif/g.test(s);if(l){a.push(s)}else if(u){var d=a[a.length-1];var f=d.replace("ifdef","ifndef");if(/if/g.test(f)){f=f.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")}a.pop();a.push(f)}else if(c){a.pop()}else if(!/layout/g.test(s)){for(var h=0;h<n;++h){var p=t[h];if(s.indexOf(p)!==-1){if(!e(i[p])){i[p]=a.slice()}else{i[p]=i[p].filter(function(e){return a.indexOf(e)>=0})}}}}}return i}function u(e,t){var r="#extension\\s+GL_"+e+"\\s+:\\s+[a-zA-Z0-9]+\\s*$";n(new RegExp(r,"g"),"",t)}return r});define("Shaders/Builtin/Constants/degreesPerRadian",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for converting radians to degrees.\n *\n * @alias czm_degreesPerRadian\n * @glslConstant\n *\n * @see CesiumMath.DEGREES_PER_RADIAN\n *\n * @example\n * // GLSL declaration\n * const float czm_degreesPerRadian = ...;\n *\n * // Example\n * float deg = czm_degreesPerRadian * rad;\n */\nconst float czm_degreesPerRadian = 57.29577951308232;\n"});define("Shaders/Builtin/Constants/depthRange",[],function(){"use strict";return"/**\n * A built-in GLSL vec2 constant for defining the depth range.\n * This is a workaround to a bug where IE11 does not implement gl_DepthRange.\n *\n * @alias czm_depthRange\n * @glslConstant\n *\n * @example\n * // GLSL declaration\n * float depthRangeNear = czm_depthRange.near;\n * float depthRangeFar = czm_depthRange.far;\n *\n */\nconst czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);\n"});define("Shaders/Builtin/Constants/epsilon1",[],function(){"use strict";return"/**\n * 0.1\n *\n * @name czm_epsilon1\n * @glslConstant\n */\nconst float czm_epsilon1 = 0.1;\n"});define("Shaders/Builtin/Constants/epsilon2",[],function(){"use strict";return"/**\n * 0.01\n *\n * @name czm_epsilon2\n * @glslConstant\n */\nconst float czm_epsilon2 = 0.01;\n"});define("Shaders/Builtin/Constants/epsilon3",[],function(){"use strict";return"/**\n * 0.001\n *\n * @name czm_epsilon3\n * @glslConstant\n */\nconst float czm_epsilon3 = 0.001;\n"});define("Shaders/Builtin/Constants/epsilon4",[],function(){"use strict";return"/**\n * 0.0001\n *\n * @name czm_epsilon4\n * @glslConstant\n */\nconst float czm_epsilon4 = 0.0001;\n"});define("Shaders/Builtin/Constants/epsilon5",[],function(){"use strict";return"/**\n * 0.00001\n *\n * @name czm_epsilon5\n * @glslConstant\n */\nconst float czm_epsilon5 = 0.00001;\n"});define("Shaders/Builtin/Constants/epsilon6",[],function(){"use strict";return"/**\n * 0.000001\n *\n * @name czm_epsilon6\n * @glslConstant\n */\nconst float czm_epsilon6 = 0.000001;\n"});define("Shaders/Builtin/Constants/epsilon7",[],function(){"use strict";return"/**\n * 0.0000001\n *\n * @name czm_epsilon7\n * @glslConstant\n */\nconst float czm_epsilon7 = 0.0000001;\n"});define("Shaders/Builtin/Constants/infinity",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_infinity\n * @glslConstant\n */\nconst float czm_infinity = 5906376272000.0;  // Distance from the Sun to Pluto in meters.  TODO: What is best given lowp, mediump, and highp?\n"});define("Shaders/Builtin/Constants/oneOverPi",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for <code>1/pi</code>.\n *\n * @alias czm_oneOverPi\n * @glslConstant\n *\n * @see CesiumMath.ONE_OVER_PI\n *\n * @example\n * // GLSL declaration\n * const float czm_oneOverPi = ...;\n *\n * // Example\n * float pi = 1.0 / czm_oneOverPi;\n */\nconst float czm_oneOverPi = 0.3183098861837907;\n"});define("Shaders/Builtin/Constants/oneOverTwoPi",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for <code>1/2pi</code>.\n *\n * @alias czm_oneOverTwoPi\n * @glslConstant\n *\n * @see CesiumMath.ONE_OVER_TWO_PI\n *\n * @example\n * // GLSL declaration\n * const float czm_oneOverTwoPi = ...;\n *\n * // Example\n * float pi = 2.0 * czm_oneOverTwoPi;\n */\nconst float czm_oneOverTwoPi = 0.15915494309189535;\n"});define("Shaders/Builtin/Constants/passCesium3DTile",[],function(){"use strict";return"/**\n * The automatic GLSL constant for {@link Pass#CESIUM_3D_TILE}\n *\n * @name czm_passCesium3DTile\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passCesium3DTile = 3.0;\n"});define("Shaders/Builtin/Constants/passCompute",[],function(){"use strict";return"/**\n * The automatic GLSL constant for {@link Pass#COMPUTE}\n *\n * @name czm_passCompute\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passCompute = 1.0;\n"});define("Shaders/Builtin/Constants/passEnvironment",[],function(){"use strict";return"/**\n * The automatic GLSL constant for {@link Pass#ENVIRONMENT}\n *\n * @name czm_passEnvironment\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passEnvironment = 0.0;\n"});define("Shaders/Builtin/Constants/passGlobe",[],function(){"use strict";return"/**\n * The automatic GLSL constant for {@link Pass#GLOBE}\n *\n * @name czm_passGlobe\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passGlobe = 2.0;\n"});define("Shaders/Builtin/Constants/passGround",[],function(){"use strict";return"/**\n * The automatic GLSL constant for {@link Pass#GROUND}\n *\n * @name czm_passGround\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passGround = 4.0;\n"});define("Shaders/Builtin/Constants/passOpaque",[],function(){"use strict";return"/**\n * The automatic GLSL constant for {@link Pass#OPAQUE}\n *\n * @name czm_passOpaque\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passOpaque = 5.0;\n"});define("Shaders/Builtin/Constants/passOverlay",[],function(){"use strict";return"/**\n * The automatic GLSL constant for {@link Pass#OVERLAY}\n *\n * @name czm_passOverlay\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passOverlay = 7.0;\n"});define("Shaders/Builtin/Constants/passTranslucent",[],function(){"use strict";return"/**\n * The automatic GLSL constant for {@link Pass#TRANSLUCENT}\n *\n * @name czm_passTranslucent\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passTranslucent = 6.0;\n"});define("Shaders/Builtin/Constants/pi",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for <code>Math.PI</code>.\n *\n * @alias czm_pi\n * @glslConstant\n *\n * @see CesiumMath.PI\n *\n * @example\n * // GLSL declaration\n * const float czm_pi = ...;\n *\n * // Example\n * float twoPi = 2.0 * czm_pi;\n */\nconst float czm_pi = 3.141592653589793;\n"});define("Shaders/Builtin/Constants/piOverFour",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for <code>pi/4</code>.\n *\n * @alias czm_piOverFour\n * @glslConstant\n *\n * @see CesiumMath.PI_OVER_FOUR\n *\n * @example\n * // GLSL declaration\n * const float czm_piOverFour = ...;\n *\n * // Example\n * float pi = 4.0 * czm_piOverFour;\n */\nconst float czm_piOverFour = 0.7853981633974483;\n"});define("Shaders/Builtin/Constants/piOverSix",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for <code>pi/6</code>.\n *\n * @alias czm_piOverSix\n * @glslConstant\n *\n * @see CesiumMath.PI_OVER_SIX\n *\n * @example\n * // GLSL declaration\n * const float czm_piOverSix = ...;\n *\n * // Example\n * float pi = 6.0 * czm_piOverSix;\n */\nconst float czm_piOverSix = 0.5235987755982988;\n"});define("Shaders/Builtin/Constants/piOverThree",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for <code>pi/3</code>.\n *\n * @alias czm_piOverThree\n * @glslConstant\n *\n * @see CesiumMath.PI_OVER_THREE\n *\n * @example\n * // GLSL declaration\n * const float czm_piOverThree = ...;\n *\n * // Example\n * float pi = 3.0 * czm_piOverThree;\n */\nconst float czm_piOverThree = 1.0471975511965976;\n"});define("Shaders/Builtin/Constants/piOverTwo",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for <code>pi/2</code>.\n *\n * @alias czm_piOverTwo\n * @glslConstant\n *\n * @see CesiumMath.PI_OVER_TWO\n *\n * @example\n * // GLSL declaration\n * const float czm_piOverTwo = ...;\n *\n * // Example\n * float pi = 2.0 * czm_piOverTwo;\n */\nconst float czm_piOverTwo = 1.5707963267948966;\n"});define("Shaders/Builtin/Constants/radiansPerDegree",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for converting degrees to radians.\n *\n * @alias czm_radiansPerDegree\n * @glslConstant\n *\n * @see CesiumMath.RADIANS_PER_DEGREE\n *\n * @example\n * // GLSL declaration\n * const float czm_radiansPerDegree = ...;\n *\n * // Example\n * float rad = czm_radiansPerDegree * deg;\n */\nconst float czm_radiansPerDegree = 0.017453292519943295;\n"});define("Shaders/Builtin/Constants/sceneMode2D",[],function(){"use strict";return"/**\n * The constant identifier for the 2D {@link SceneMode}\n *\n * @name czm_sceneMode2D\n * @glslConstant\n * @see czm_sceneMode\n * @see czm_sceneModeColumbusView\n * @see czm_sceneMode3D\n * @see czm_sceneModeMorphing\n */\nconst float czm_sceneMode2D = 2.0;\n"});define("Shaders/Builtin/Constants/sceneMode3D",[],function(){"use strict";return"/**\n * The constant identifier for the 3D {@link SceneMode}\n *\n * @name czm_sceneMode3D\n * @glslConstant\n * @see czm_sceneMode\n * @see czm_sceneMode2D\n * @see czm_sceneModeColumbusView\n * @see czm_sceneModeMorphing\n */\nconst float czm_sceneMode3D = 3.0;\n"});define("Shaders/Builtin/Constants/sceneModeColumbusView",[],function(){"use strict";return"/**\n * The constant identifier for the Columbus View {@link SceneMode}\n *\n * @name czm_sceneModeColumbusView\n * @glslConstant\n * @see czm_sceneMode\n * @see czm_sceneMode2D\n * @see czm_sceneMode3D\n * @see czm_sceneModeMorphing\n */\nconst float czm_sceneModeColumbusView = 1.0;\n"});define("Shaders/Builtin/Constants/sceneModeMorphing",[],function(){"use strict";return"/**\n * The constant identifier for the Morphing {@link SceneMode}\n *\n * @name czm_sceneModeMorphing\n * @glslConstant\n * @see czm_sceneMode\n * @see czm_sceneMode2D\n * @see czm_sceneModeColumbusView\n * @see czm_sceneMode3D\n */\nconst float czm_sceneModeMorphing = 0.0;\n"});define("Shaders/Builtin/Constants/solarRadius",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for one solar radius.\n *\n * @alias czm_solarRadius\n * @glslConstant\n *\n * @see CesiumMath.SOLAR_RADIUS\n *\n * @example\n * // GLSL declaration\n * const float czm_solarRadius = ...;\n */\nconst float czm_solarRadius = 695500000.0;\n"});define("Shaders/Builtin/Constants/threePiOver2",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for <code>3pi/2</code>.\n *\n * @alias czm_threePiOver2\n * @glslConstant\n *\n * @see CesiumMath.THREE_PI_OVER_TWO\n *\n * @example\n * // GLSL declaration\n * const float czm_threePiOver2 = ...;\n *\n * // Example\n * float pi = (2.0 / 3.0) * czm_threePiOver2;\n */\nconst float czm_threePiOver2 = 4.71238898038469;\n"});define("Shaders/Builtin/Constants/twoPi",[],function(){"use strict";return"/**\n * A built-in GLSL floating-point constant for <code>2pi</code>.\n *\n * @alias czm_twoPi\n * @glslConstant\n *\n * @see CesiumMath.TWO_PI\n *\n * @example\n * // GLSL declaration\n * const float czm_twoPi = ...;\n *\n * // Example\n * float pi = czm_twoPi / 2.0;\n */\nconst float czm_twoPi = 6.283185307179586;\n"});define("Shaders/Builtin/Constants/webMercatorMaxLatitude",[],function(){"use strict";return"/**\n * The maximum latitude, in radians, both North and South, supported by a Web Mercator\n * (EPSG:3857) projection.  Technically, the Mercator projection is defined\n * for any latitude up to (but not including) 90 degrees, but it makes sense\n * to cut it off sooner because it grows exponentially with increasing latitude.\n * The logic behind this particular cutoff value, which is the one used by\n * Google Maps, Bing Maps, and Esri, is that it makes the projection\n * square.  That is, the rectangle is equal in the X and Y directions.\n *\n * The constant value is computed as follows:\n *   czm_pi * 0.5 - (2.0 * atan(exp(-czm_pi)))\n *\n * @name czm_webMercatorMaxLatitude\n * @glslConstant\n */\nconst float czm_webMercatorMaxLatitude = 1.4844222297453324;\n"});define("Shaders/Builtin/Structs/depthRangeStruct",[],function(){"use strict";return"/**\n * @name czm_depthRangeStruct\n * @glslStruct\n */\nstruct czm_depthRangeStruct\n{\n    float near;\n    float far;\n};\n"});define("Shaders/Builtin/Structs/ellipsoid",[],function(){"use strict";return"/** DOC_TBA\n *\n * @name czm_ellipsoid\n * @glslStruct\n */\nstruct czm_ellipsoid\n{\n    vec3 center;\n    vec3 radii;\n    vec3 inverseRadii;\n    vec3 inverseRadiiSquared;\n};\n"});define("Shaders/Builtin/Structs/material",[],function(){"use strict";return"/**\n * Holds material information that can be used for lighting. Returned by all czm_getMaterial functions.\n *\n * @name czm_material\n * @glslStruct\n *\n * @property {vec3} diffuse Incoming light that scatters evenly in all directions.\n * @property {float} specular Intensity of incoming light reflecting in a single direction.\n * @property {float} shininess The sharpness of the specular reflection.  Higher values create a smaller, more focused specular highlight.\n * @property {vec3} normal Surface's normal in eye coordinates. It is used for effects such as normal mapping. The default is the surface's unmodified normal.\n * @property {vec3} emission Light emitted by the material equally in all directions. The default is vec3(0.0), which emits no light.\n * @property {float} alpha Opacity of this material. 0.0 is completely transparent; 1.0 is completely opaque.\n */\nstruct czm_material\n{\n    vec3 diffuse;\n    float specular;\n    float shininess;\n    vec3 normal;\n    vec3 emission;\n    float alpha;\n};\n"});define("Shaders/Builtin/Structs/materialInput",[],function(){"use strict";return"/**\n * Used as input to every material's czm_getMaterial function.\n *\n * @name czm_materialInput\n * @glslStruct\n *\n * @property {float} s 1D texture coordinates.\n * @property {vec2} st 2D texture coordinates.\n * @property {vec3} str 3D texture coordinates.\n * @property {vec3} normalEC Unperturbed surface normal in eye coordinates.\n * @property {mat3} tangentToEyeMatrix Matrix for converting a tangent space normal to eye space.\n * @property {vec3} positionToEyeEC Vector from the fragment to the eye in eye coordinates.  The magnitude is the distance in meters from the fragment to the eye.\n */\nstruct czm_materialInput\n{\n    float s;\n    vec2 st;\n    vec3 str;\n    vec3 normalEC;\n    mat3 tangentToEyeMatrix;\n    vec3 positionToEyeEC;\n};\n"});define("Shaders/Builtin/Structs/ray",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_ray\n * @glslStruct\n */\nstruct czm_ray\n{\n    vec3 origin;\n    vec3 direction;\n};\n"});define("Shaders/Builtin/Structs/raySegment",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_raySegment\n * @glslStruct\n */\nstruct czm_raySegment\n{\n    float start;\n    float stop;\n};\n\n/**\n * DOC_TBA\n *\n * @name czm_emptyRaySegment\n * @glslConstant \n */\nconst czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);\n\n/**\n * DOC_TBA\n *\n * @name czm_fullRaySegment\n * @glslConstant \n */\nconst czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);\n"});define("Shaders/Builtin/Structs/shadowParameters",[],function(){"use strict";return"struct czm_shadowParameters\n{\n#ifdef USE_CUBE_MAP_SHADOW\n    vec3 texCoords;\n#else\n    vec2 texCoords;\n#endif\n\n    float depthBias;\n    float depth;\n    float nDotL;\n    vec2 texelStepSize;\n    float normalShadingSmooth;\n    float darkness;\n};\n"});define("Shaders/Builtin/Functions/alphaWeight",[],function(){"use strict";return"/**\n * @private\n */\nfloat czm_alphaWeight(float a)\n{\n    float x = 2.0 * (gl_FragCoord.x - czm_viewport.x) / czm_viewport.z - 1.0;\n    float y = 2.0 * (gl_FragCoord.y - czm_viewport.y) / czm_viewport.w - 1.0;\n    float z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\n    vec4 q = vec4(x, y, z, 0.0);\n    q /= gl_FragCoord.w;\n\n    if (czm_inverseProjection != mat4(0.0)) {\n        q = czm_inverseProjection * q;\n    } else {\n        float top = czm_frustumPlanes.x;\n        float bottom = czm_frustumPlanes.y;\n        float left = czm_frustumPlanes.z;\n        float right = czm_frustumPlanes.w;\n\n        float near = czm_currentFrustum.x;\n        float far = czm_currentFrustum.y;\n\n        q.x = (q.x * (right - left) + left + right) * 0.5;\n        q.y = (q.y * (top - bottom) + bottom + top) * 0.5;\n        q.z = (q.z * (near - far) - near - far) * 0.5;\n        q.w = 1.0;\n    }\n\n    // See Weighted Blended Order-Independent Transparency for examples of different weighting functions:\n    // http://jcgt.org/published/0002/02/09/\n    return pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 100.0 / (1e-5 + pow(abs(z) / 10.0, 3.0) + pow(abs(z) / 200.0, 6.0))));\n}\n"});define("Shaders/Builtin/Functions/antialias",[],function(){"use strict";return"/**\n * Procedural anti-aliasing by blurring two colors that meet at a sharp edge.\n *\n * @name czm_antialias\n * @glslFunction\n *\n * @param {vec4} color1 The color on one side of the edge.\n * @param {vec4} color2 The color on the other side of the edge.\n * @param {vec4} currentcolor The current color, either <code>color1</code> or <code>color2</code>.\n * @param {float} dist The distance to the edge in texture coordinates.\n * @param {float} [fuzzFactor=0.1] Controls the blurriness between the two colors.\n * @returns {vec4} The anti-aliased color.\n *\n * @example\n * // GLSL declarations\n * vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor);\n * vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist);\n *\n * // get the color for a material that has a sharp edge at the line y = 0.5 in texture space\n * float dist = abs(textureCoordinates.t - 0.5);\n * vec4 currentColor = mix(bottomColor, topColor, step(0.5, textureCoordinates.t));\n * vec4 color = czm_antialias(bottomColor, topColor, currentColor, dist, 0.1);\n */\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)\n{\n    float val1 = clamp(dist / fuzzFactor, 0.0, 1.0);\n    float val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);\n    val1 = val1 * (1.0 - val2);\n    val1 = val1 * val1 * (3.0 - (2.0 * val1));\n    val1 = pow(val1, 0.5); //makes the transition nicer\n    \n    vec4 midColor = (color1 + color2) * 0.5;\n    return mix(midColor, currentColor, val1);\n}\n\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)\n{\n    return czm_antialias(color1, color2, currentColor, dist, 0.1);\n}\n"});define("Shaders/Builtin/Functions/cascadeColor",[],function(){"use strict";return"\nvec4 czm_cascadeColor(vec4 weights)\n{\n    return vec4(1.0, 0.0, 0.0, 1.0) * weights.x +\n           vec4(0.0, 1.0, 0.0, 1.0) * weights.y +\n           vec4(0.0, 0.0, 1.0, 1.0) * weights.z +\n           vec4(1.0, 0.0, 1.0, 1.0) * weights.w;\n}\n"});define("Shaders/Builtin/Functions/cascadeDistance",[],function(){"use strict";return"\nuniform vec4 shadowMap_cascadeDistances;\n\nfloat czm_cascadeDistance(vec4 weights)\n{\n    return dot(shadowMap_cascadeDistances, weights);\n}\n"});define("Shaders/Builtin/Functions/cascadeMatrix",[],function(){"use strict";return"\nuniform mat4 shadowMap_cascadeMatrices[4];\n\nmat4 czm_cascadeMatrix(vec4 weights)\n{\n    return shadowMap_cascadeMatrices[0] * weights.x +\n           shadowMap_cascadeMatrices[1] * weights.y +\n           shadowMap_cascadeMatrices[2] * weights.z +\n           shadowMap_cascadeMatrices[3] * weights.w;\n}\n"});define("Shaders/Builtin/Functions/cascadeWeights",[],function(){"use strict";return"\nuniform vec4 shadowMap_cascadeSplits[2];\n\nvec4 czm_cascadeWeights(float depthEye)\n{\n    // One component is set to 1.0 and all others set to 0.0.\n    vec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));\n    vec4 far = step(depthEye, shadowMap_cascadeSplits[1]);\n    return near * far;\n}\n"});define("Shaders/Builtin/Functions/columbusViewMorph",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_columbusViewMorph\n * @glslFunction\n */\nvec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)\n{\n    // Just linear for now.\n    vec3 p = mix(position2D.xyz, position3D.xyz, time);\n    return vec4(p, 1.0);\n}\n"});define("Shaders/Builtin/Functions/computePosition",[],function(){"use strict";return"/**\n * Returns a position in model coordinates relative to eye taking into\n * account the current scene mode: 3D, 2D, or Columbus view.\n * <p>\n * This uses standard position attributes, <code>position3DHigh</code>, \n * <code>position3DLow</code>, <code>position2DHigh</code>, and <code>position2DLow</code>, \n * and should be used when writing a vertex shader for an {@link Appearance}.\n * </p>\n *\n * @name czm_computePosition\n * @glslFunction\n *\n * @returns {vec4} The position relative to eye.\n *\n * @example\n * vec4 p = czm_computePosition();\n * v_positionEC = (czm_modelViewRelativeToEye * p).xyz;\n * gl_Position = czm_modelViewProjectionRelativeToEye * p;\n *\n * @see czm_translateRelativeToEye\n */\nvec4 czm_computePosition();\n"});define("Shaders/Builtin/Functions/cosineAndSine",[],function(){"use strict";return"/**\n * @private\n */\nvec2 cordic(float angle)\n{\n// Scale the vector by the appropriate factor for the 24 iterations to follow.\n    vec2 vector = vec2(6.0725293500888267e-1, 0.0);\n// Iteration 1\n    float sense = (angle < 0.0) ? -1.0 : 1.0;\n //   float factor = sense * 1.0;  // 2^-0\n    mat2 rotation = mat2(1.0, sense, -sense, 1.0);\n    vector = rotation * vector;\n    angle -= sense * 7.8539816339744828e-1;  // atan(2^-0)\n// Iteration 2\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    float factor = sense * 5.0e-1;  // 2^-1\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 4.6364760900080609e-1;  // atan(2^-1)\n// Iteration 3\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 2.5e-1;  // 2^-2\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 2.4497866312686414e-1;  // atan(2^-2)\n// Iteration 4\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.25e-1;  // 2^-3\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.2435499454676144e-1;  // atan(2^-3)\n// Iteration 5\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 6.25e-2;  // 2^-4\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 6.2418809995957350e-2;  // atan(2^-4)\n// Iteration 6\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 3.125e-2;  // 2^-5\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 3.1239833430268277e-2;  // atan(2^-5)\n// Iteration 7\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.5625e-2;  // 2^-6\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.5623728620476831e-2;  // atan(2^-6)\n// Iteration 8\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 7.8125e-3;  // 2^-7\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 7.8123410601011111e-3;  // atan(2^-7)\n// Iteration 9\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 3.90625e-3;  // 2^-8\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 3.9062301319669718e-3;  // atan(2^-8)\n// Iteration 10\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.953125e-3;  // 2^-9\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.9531225164788188e-3;  // atan(2^-9)\n// Iteration 11\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 9.765625e-4;  // 2^-10\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 9.7656218955931946e-4;  // atan(2^-10)\n// Iteration 12\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 4.8828125e-4;  // 2^-11\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 4.8828121119489829e-4;  // atan(2^-11)\n// Iteration 13\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 2.44140625e-4;  // 2^-12\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 2.4414062014936177e-4;  // atan(2^-12)\n// Iteration 14\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.220703125e-4;  // 2^-13\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.2207031189367021e-4;  // atan(2^-13)\n// Iteration 15\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 6.103515625e-5;  // 2^-14\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 6.1035156174208773e-5;  // atan(2^-14)\n// Iteration 16\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 3.0517578125e-5;  // 2^-15\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 3.0517578115526096e-5;  // atan(2^-15)\n// Iteration 17\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.52587890625e-5;  // 2^-16\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.5258789061315762e-5;  // atan(2^-16)\n// Iteration 18\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 7.62939453125e-6;  // 2^-17\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 7.6293945311019700e-6;  // atan(2^-17)\n// Iteration 19\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 3.814697265625e-6;  // 2^-18\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 3.8146972656064961e-6;  // atan(2^-18)\n// Iteration 20\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.9073486328125e-6;  // 2^-19\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.9073486328101870e-6;  // atan(2^-19)\n// Iteration 21\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 9.5367431640625e-7;  // 2^-20\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 9.5367431640596084e-7;  // atan(2^-20)\n// Iteration 22\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 4.76837158203125e-7;  // 2^-21\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 4.7683715820308884e-7;  // atan(2^-21)\n// Iteration 23\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 2.384185791015625e-7;  // 2^-22\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 2.3841857910155797e-7;  // atan(2^-22)\n// Iteration 24\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.1920928955078125e-7;  // 2^-23\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n//    angle -= sense * 1.1920928955078068e-7;  // atan(2^-23)\n\n    return vector;\n}\n\n/**\n * Computes the cosine and sine of the provided angle using the CORDIC algorithm.\n *\n * @name czm_cosineAndSine\n * @glslFunction\n *\n * @param {float} angle The angle in radians.\n *\n * @returns {vec2} The resulting cosine of the angle (as the x coordinate) and sine of the angle (as the y coordinate).\n *\n * @example\n * vec2 v = czm_cosineAndSine(czm_piOverSix);\n * float cosine = v.x;\n * float sine = v.y;\n */\nvec2 czm_cosineAndSine(float angle)\n{\n    if (angle < -czm_piOverTwo || angle > czm_piOverTwo)\n    {\n        if (angle < 0.0)\n        {\n            return -cordic(angle + czm_pi);\n        }\n        else\n        {\n            return -cordic(angle - czm_pi);\n        }\n    }\n    else\n    {\n        return cordic(angle);\n    }\n}\n"});define("Shaders/Builtin/Functions/decompressTextureCoordinates",[],function(){"use strict";return"/**\n * Decompresses texture coordinates that were packed into a single float.\n *\n * @name czm_decompressTextureCoordinates\n * @glslFunction\n *\n * @param {float} encoded The compressed texture coordinates.\n * @returns {vec2} The decompressed texture coordinates.\n */\n vec2 czm_decompressTextureCoordinates(float encoded)\n {\n    float temp = encoded / 4096.0;\n    float xZeroTo4095 = floor(temp);\n    float stx = xZeroTo4095 / 4095.0;\n    float sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;\n    return vec2(stx, sty);\n }\n"});define("Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates",[],function(){"use strict";return"/**\n * Computes a 3x3 rotation matrix that transforms vectors from an ellipsoid's east-north-up coordinate system \n * to eye coordinates.  In east-north-up coordinates, x points east, y points north, and z points along the \n * surface normal.  East-north-up can be used as an ellipsoid's tangent space for operations such as bump mapping.\n * <br /><br />\n * The ellipsoid is assumed to be centered at the model coordinate's origin.\n *\n * @name czm_eastNorthUpToEyeCoordinates\n * @glslFunction\n *\n * @param {vec3} positionMC The position on the ellipsoid in model coordinates.\n * @param {vec3} normalEC The normalized ellipsoid surface normal, at <code>positionMC</code>, in eye coordinates.\n *\n * @returns {mat3} A 3x3 rotation matrix that transforms vectors from the east-north-up coordinate system to eye coordinates.\n *\n * @example\n * // Transform a vector defined in the east-north-up coordinate \n * // system, (0, 0, 1) which is the surface normal, to eye \n * // coordinates.\n * mat3 m = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\n * vec3 normalEC = m * vec3(0.0, 0.0, 1.0);\n */\nmat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)\n{\n    vec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));  // normalized surface tangent in model coordinates\n    vec3 tangentEC = normalize(czm_normal3D * tangentMC);                // normalized surface tangent in eye coordiantes\n    vec3 bitangentEC = normalize(cross(normalEC, tangentEC));            // normalized surface bitangent in eye coordinates\n\n    return mat3(\n        tangentEC.x,   tangentEC.y,   tangentEC.z,\n        bitangentEC.x, bitangentEC.y, bitangentEC.z,\n        normalEC.x,    normalEC.y,    normalEC.z);\n}\n"});define("Shaders/Builtin/Functions/ellipsoidContainsPoint",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_ellipsoidContainsPoint\n * @glslFunction\n *\n */\nbool czm_ellipsoidContainsPoint(czm_ellipsoid ellipsoid, vec3 point)\n{\n    vec3 scaled = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;\n    return (dot(scaled, scaled) <= 1.0);\n}\n"});define("Shaders/Builtin/Functions/ellipsoidNew",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_ellipsoidNew\n * @glslFunction\n *\n */\nczm_ellipsoid czm_ellipsoidNew(vec3 center, vec3 radii)\n{\n    vec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\n    vec3 inverseRadiiSquared = inverseRadii * inverseRadii;\n    czm_ellipsoid temp = czm_ellipsoid(center, radii, inverseRadii, inverseRadiiSquared);\n    return temp;\n}\n"});define("Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_ellipsoidWgs84TextureCoordinates\n * @glslFunction\n */\nvec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)\n{\n    return vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);\n}\n"});define("Shaders/Builtin/Functions/equalsEpsilon",[],function(){"use strict";return"/**\n * Compares <code>left</code> and <code>right</code> componentwise. Returns <code>true</code>\n * if they are within <code>epsilon</code> and <code>false</code> otherwise. The inputs\n * <code>left</code> and <code>right</code> can be <code>float</code>s, <code>vec2</code>s,\n * <code>vec3</code>s, or <code>vec4</code>s.\n *\n * @name czm_equalsEpsilon\n * @glslFunction\n *\n * @param {} left The first vector.\n * @param {} right The second vector.\n * @param {float} epsilon The epsilon to use for equality testing.\n * @returns {bool} <code>true</code> if the components are within <code>epsilon</code> and <code>false</code> otherwise.\n *\n * @example\n * // GLSL declarations\n * bool czm_equalsEpsilon(float left, float right, float epsilon);\n * bool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon);\n * bool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon);\n * bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon);\n */\nbool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {\n    return all(lessThanEqual(abs(left - right), vec4(epsilon)));\n}\n\nbool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {\n    return all(lessThanEqual(abs(left - right), vec3(epsilon)));\n}\n\nbool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {\n    return all(lessThanEqual(abs(left - right), vec2(epsilon)));\n}\n\nbool czm_equalsEpsilon(float left, float right, float epsilon) {\n    return (abs(left - right) <= epsilon);\n}\n"});define("Shaders/Builtin/Functions/eyeOffset",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_eyeOffset\n * @glslFunction\n *\n * @param {vec4} positionEC DOC_TBA.\n * @param {vec3} eyeOffset DOC_TBA.\n *\n * @returns {vec4} DOC_TBA.\n */\nvec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)\n{\n    // This equation is approximate in x and y.\n    vec4 p = positionEC;\n    vec4 zEyeOffset = normalize(p) * eyeOffset.z;\n    p.xy += eyeOffset.xy + zEyeOffset.xy;\n    p.z += zEyeOffset.z;\n    return p;\n}\n"});define("Shaders/Builtin/Functions/eyeToWindowCoordinates",[],function(){"use strict";return"/**\n * Transforms a position from eye to window coordinates.  The transformation\n * from eye to clip coordinates is done using {@link czm_projection}.\n * The transform from normalized device coordinates to window coordinates is\n * done using {@link czm_viewportTransformation}, which assumes a depth range\n * of <code>near = 0</code> and <code>far = 1</code>.\n * <br /><br />\n * This transform is useful when there is a need to manipulate window coordinates\n * in a vertex shader as done by {@link BillboardCollection}.\n *\n * @name czm_eyeToWindowCoordinates\n * @glslFunction\n *\n * @param {vec4} position The position in eye coordinates to transform.\n *\n * @returns {vec4} The transformed position in window coordinates.\n *\n * @see czm_modelToWindowCoordinates\n * @see czm_projection\n * @see czm_viewportTransformation\n * @see BillboardCollection\n *\n * @example\n * vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n */\nvec4 czm_eyeToWindowCoordinates(vec4 positionEC)\n{\n    vec4 q = czm_projection * positionEC;                        // clip coordinates\n    q.xyz /= q.w;                                                // normalized device coordinates\n    q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz; // window coordinates\n    return q;\n}\n"});define("Shaders/Builtin/Functions/fog",[],function(){"use strict";return"/**\n * Gets the color with fog at a distance from the camera.\n * \n * @name czm_fog\n * @glslFunction\n * \n * @param {float} distanceToCamera The distance to the camera in meters.\n * @param {vec3} color The original color.\n * @param {vec3} fogColor The color of the fog.\n *\n * @returns {vec3} The color adjusted for fog at the distance from the camera.\n */\nvec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)\n{\n    float scalar = distanceToCamera * czm_fogDensity;\n    float fog = 1.0 - exp(-(scalar * scalar));\n    \n    return mix(color, fogColor, fog);\n}\n"});define("Shaders/Builtin/Functions/geodeticSurfaceNormal",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_geodeticSurfaceNormal\n * @glslFunction\n *\n * @param {vec3} positionOnEllipsoid DOC_TBA\n * @param {vec3} ellipsoidCenter DOC_TBA\n * @param {vec3} oneOverEllipsoidRadiiSquared DOC_TBA\n * \n * @returns {vec3} DOC_TBA.\n */\nvec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)\n{\n    return normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);\n}\n"});define("Shaders/Builtin/Functions/getDefaultMaterial",[],function(){"use strict";return"/**\n * An czm_material with default values. Every material's czm_getMaterial\n * should use this default material as a base for the material it returns.\n * The default normal value is given by materialInput.normalEC.\n *\n * @name czm_getDefaultMaterial\n * @glslFunction \n *\n * @param {czm_materialInput} input The input used to construct the default material.\n * \n * @returns {czm_material} The default material.\n *\n * @see czm_materialInput\n * @see czm_material\n * @see czm_getMaterial\n */\nczm_material czm_getDefaultMaterial(czm_materialInput materialInput)\n{\n    czm_material material;\n    material.diffuse = vec3(0.0);\n    material.specular = 0.0;\n    material.shininess = 1.0;\n    material.normal = materialInput.normalEC;\n    material.emission = vec3(0.0);\n    material.alpha = 1.0;\n    return material;\n}\n"});define("Shaders/Builtin/Functions/getLambertDiffuse",[],function(){"use strict";return"/**\n * Calculates the intensity of diffusely reflected light.\n *\n * @name czm_getLambertDiffuse\n * @glslFunction\n *\n * @param {vec3} lightDirectionEC Unit vector pointing to the light source in eye coordinates.\n * @param {vec3} normalEC The surface normal in eye coordinates.\n *\n * @returns {float} The intensity of the diffuse reflection.\n *\n * @see czm_phong\n *\n * @example\n * float diffuseIntensity = czm_getLambertDiffuse(lightDirectionEC, normalEC);\n * float specularIntensity = czm_getSpecular(lightDirectionEC, toEyeEC, normalEC, 200);\n * vec3 color = (diffuseColor * diffuseIntensity) + (specularColor * specularIntensity);\n */\nfloat czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)\n{\n    return max(dot(lightDirectionEC, normalEC), 0.0);\n}\n"});define("Shaders/Builtin/Functions/getSpecular",[],function(){"use strict";return"/**\n * Calculates the specular intensity of reflected light.\n *\n * @name czm_getSpecular\n * @glslFunction\n *\n * @param {vec3} lightDirectionEC Unit vector pointing to the light source in eye coordinates.\n * @param {vec3} toEyeEC Unit vector pointing to the eye position in eye coordinates.\n * @param {vec3} normalEC The surface normal in eye coordinates.\n * @param {float} shininess The sharpness of the specular reflection.  Higher values create a smaller, more focused specular highlight.\n *\n * @returns {float} The intensity of the specular highlight.\n *\n * @see czm_phong\n *\n * @example\n * float diffuseIntensity = czm_getLambertDiffuse(lightDirectionEC, normalEC);\n * float specularIntensity = czm_getSpecular(lightDirectionEC, toEyeEC, normalEC, 200);\n * vec3 color = (diffuseColor * diffuseIntensity) + (specularColor * specularIntensity);\n */\nfloat czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)\n{\n    vec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);\n    float specular = max(dot(toReflectedLight, toEyeEC), 0.0);\n\n    // pow has undefined behavior if both parameters <= 0.\n    // Prevent this by making sure shininess is at least czm_epsilon2.\n    return pow(specular, max(shininess, czm_epsilon2));\n}\n"});define("Shaders/Builtin/Functions/getWaterNoise",[],function(){"use strict";return"/**\n * @private\n */\nvec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)\n{\n    float cosAngle = cos(angleInRadians);\n    float sinAngle = sin(angleInRadians);\n\n    // time dependent sampling directions\n    vec2 s0 = vec2(1.0/17.0, 0.0);\n    vec2 s1 = vec2(-1.0/29.0, 0.0);\n    vec2 s2 = vec2(1.0/101.0, 1.0/59.0);\n    vec2 s3 = vec2(-1.0/109.0, -1.0/57.0);\n\n    // rotate sampling direction by specified angle\n    s0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));\n    s1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));\n    s2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));\n    s3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));\n\n    vec2 uv0 = (uv/103.0) + (time * s0);\n    vec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);\n    vec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);\n    vec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);\n\n    uv0 = fract(uv0);\n    uv1 = fract(uv1);\n    uv2 = fract(uv2);\n    uv3 = fract(uv3);\n    vec4 noise = (texture2D(normalMap, uv0)) +\n                 (texture2D(normalMap, uv1)) +\n                 (texture2D(normalMap, uv2)) +\n                 (texture2D(normalMap, uv3));\n\n    // average and scale to between -1 and 1\n    return ((noise / 4.0) - 0.5) * 2.0;\n}\n"});define("Shaders/Builtin/Functions/getWgs84EllipsoidEC",[],function(){"use strict";return"/**\n * Returns the WGS84 ellipsoid, with its center at the origin of world coordinates, in eye coordinates.\n *\n * @name czm_getWgs84EllipsoidEC\n * @glslFunction\n *\n * @returns {czm_ellipsoid} The WGS84 ellipsoid, with its center at the origin of world coordinates, in eye coordinates.\n *\n * @see Ellipsoid.WGS84\n *\n * @example\n * czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n */\nczm_ellipsoid czm_getWgs84EllipsoidEC()\n{\n    vec3 radii = vec3(6378137.0, 6378137.0, 6356752.314245);\n    vec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\n    vec3 inverseRadiiSquared = inverseRadii * inverseRadii;\n    czm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\n    return temp;\n}\n"});define("Shaders/Builtin/Functions/HSBToRGB",[],function(){"use strict";return"/**\n * Converts an HSB color (hue, saturation, brightness) to RGB\n * HSB <-> RGB conversion with minimal branching: {@link http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl}\n *\n * @name czm_HSBToRGB\n * @glslFunction\n * \n * @param {vec3} hsb The color in HSB.\n *\n * @returns {vec3} The color in RGB.\n *\n * @example\n * vec3 hsb = czm_RGBToHSB(rgb);\n * hsb.z *= 0.1;\n * rgb = czm_HSBToRGB(hsb);\n */\n\nconst vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\nvec3 czm_HSBToRGB(vec3 hsb)\n{\n    vec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);\n    return hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);\n}\n"});define("Shaders/Builtin/Functions/HSLToRGB",[],function(){"use strict";return"/**\n * Converts an HSL color (hue, saturation, lightness) to RGB\n * HSL <-> RGB conversion: {@link http://www.chilliant.com/rgb2hsv.html}\n *\n * @name czm_HSLToRGB\n * @glslFunction\n * \n * @param {vec3} rgb The color in HSL.\n *\n * @returns {vec3} The color in RGB.\n *\n * @example\n * vec3 hsl = czm_RGBToHSL(rgb);\n * hsl.z *= 0.1;\n * rgb = czm_HSLToRGB(hsl);\n */\n\nvec3 hueToRGB(float hue)\n{\n    float r = abs(hue * 6.0 - 3.0) - 1.0;\n    float g = 2.0 - abs(hue * 6.0 - 2.0);\n    float b = 2.0 - abs(hue * 6.0 - 4.0);\n    return clamp(vec3(r, g, b), 0.0, 1.0);\n}\n\nvec3 czm_HSLToRGB(vec3 hsl)\n{\n    vec3 rgb = hueToRGB(hsl.x);\n    float c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;\n    return (rgb - 0.5) * c + hsl.z;\n}\n"});define("Shaders/Builtin/Functions/hue",[],function(){"use strict";return"/**\n * Adjusts the hue of a color.\n * \n * @name czm_hue\n * @glslFunction\n * \n * @param {vec3} rgb The color.\n * @param {float} adjustment The amount to adjust the hue of the color in radians.\n *\n * @returns {float} The color with the hue adjusted.\n *\n * @example\n * vec3 adjustHue = czm_hue(color, czm_pi); // The same as czm_hue(color, -czm_pi)\n */\nvec3 czm_hue(vec3 rgb, float adjustment)\n{\n    const mat3 toYIQ = mat3(0.299,     0.587,     0.114,\n                            0.595716, -0.274453, -0.321263,\n                            0.211456, -0.522591,  0.311135);\n    const mat3 toRGB = mat3(1.0,  0.9563,  0.6210,\n                            1.0, -0.2721, -0.6474,\n                            1.0, -1.107,   1.7046);\n    \n    vec3 yiq = toYIQ * rgb;\n    float hue = atan(yiq.z, yiq.y) + adjustment;\n    float chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\n    \n    vec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\n    return toRGB * color;\n}\n"});define("Shaders/Builtin/Functions/isEmpty",[],function(){"use strict";return"/**\n * Determines if a time interval is empty.\n *\n * @name czm_isEmpty\n * @glslFunction \n * \n * @param {czm_raySegment} interval The interval to test.\n * \n * @returns {bool} <code>true</code> if the time interval is empty; otherwise, <code>false</code>.\n *\n * @example\n * bool b0 = czm_isEmpty(czm_emptyRaySegment);      // true\n * bool b1 = czm_isEmpty(czm_raySegment(0.0, 1.0)); // false\n * bool b2 = czm_isEmpty(czm_raySegment(1.0, 1.0)); // false, contains 1.0.\n */\nbool czm_isEmpty(czm_raySegment interval)\n{\n    return (interval.stop < 0.0);\n}\n"});define("Shaders/Builtin/Functions/isFull",[],function(){"use strict";return"/**\n * Determines if a time interval is empty.\n *\n * @name czm_isFull\n * @glslFunction \n * \n * @param {czm_raySegment} interval The interval to test.\n * \n * @returns {bool} <code>true</code> if the time interval is empty; otherwise, <code>false</code>.\n *\n * @example\n * bool b0 = czm_isEmpty(czm_emptyRaySegment);      // true\n * bool b1 = czm_isEmpty(czm_raySegment(0.0, 1.0)); // false\n * bool b2 = czm_isEmpty(czm_raySegment(1.0, 1.0)); // false, contains 1.0.\n */\nbool czm_isFull(czm_raySegment interval)\n{\n    return (interval.start == 0.0 && interval.stop == czm_infinity);\n}\n"});define("Shaders/Builtin/Functions/latitudeToWebMercatorFraction",[],function(){"use strict";return"/**\n * Computes the fraction of a Web Wercator rectangle at which a given geodetic latitude is located.\n *\n * @name czm_latitudeToWebMercatorFraction\n * @glslFunction\n *\n * @param {float} latitude The geodetic latitude, in radians.\n * @param {float} southMercatorY The Web Mercator coordinate of the southern boundary of the rectangle.\n * @param {float} oneOverMercatorHeight The total height of the rectangle in Web Mercator coordinates.\n *\n * @returns {float} The fraction of the rectangle at which the latitude occurs.  If the latitude is the southern\n *          boundary of the rectangle, the return value will be zero.  If it is the northern boundary, the return\n *          value will be 1.0.  Latitudes in between are mapped according to the Web Mercator projection.\n */ \nfloat czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)\n{\n    float sinLatitude = sin(latitude);\n    float mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));\n    \n    return (mercatorY - southMercatorY) * oneOverMercatorHeight;\n}\n"});define("Shaders/Builtin/Functions/luminance",[],function(){"use strict";return"/**\n * Computes the luminance of a color. \n *\n * @name czm_luminance\n * @glslFunction\n *\n * @param {vec3} rgb The color.\n * \n * @returns {float} The luminance.\n *\n * @example\n * float light = czm_luminance(vec3(0.0)); // 0.0\n * float dark = czm_luminance(vec3(1.0));  // ~1.0 \n */\nfloat czm_luminance(vec3 rgb)\n{\n    // Algorithm from Chapter 10 of Graphics Shaders.\n    const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n    return dot(rgb, W);\n}\n"});define("Shaders/Builtin/Functions/metersPerPixel",[],function(){"use strict";return"/**\n * Computes the size of a pixel in meters at a distance from the eye.\n \n * @name czm_metersPerPixel\n * @glslFunction\n *\n * @param {vec3} positionEC The position to get the meters per pixel in eye coordinates.\n *\n * @returns {float} The meters per pixel at positionEC.\n */\nfloat czm_metersPerPixel(vec4 positionEC)\n{\n    float width = czm_viewport.z;\n    float height = czm_viewport.w;\n    float pixelWidth;\n    float pixelHeight;\n    \n    float top = czm_frustumPlanes.x;\n    float bottom = czm_frustumPlanes.y;\n    float left = czm_frustumPlanes.z;\n    float right = czm_frustumPlanes.w;\n    \n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        float frustumWidth = right - left;\n        float frustumHeight = top - bottom;\n        pixelWidth = frustumWidth / width;\n        pixelHeight = frustumHeight / height;\n    }\n    else\n    {\n        float distanceToPixel = -positionEC.z;\n        float inverseNear = 1.0 / czm_currentFrustum.x;\n        float tanTheta = top * inverseNear;\n        pixelHeight = 2.0 * distanceToPixel * tanTheta / height;\n        tanTheta = right * inverseNear;\n        pixelWidth = 2.0 * distanceToPixel * tanTheta / width;\n    }\n\n    return max(pixelWidth, pixelHeight);\n}\n"});define("Shaders/Builtin/Functions/modelToWindowCoordinates",[],function(){"use strict";return"/**\n * Transforms a position from model to window coordinates.  The transformation\n * from model to clip coordinates is done using {@link czm_modelViewProjection}.\n * The transform from normalized device coordinates to window coordinates is\n * done using {@link czm_viewportTransformation}, which assumes a depth range\n * of <code>near = 0</code> and <code>far = 1</code>.\n * <br /><br />\n * This transform is useful when there is a need to manipulate window coordinates\n * in a vertex shader as done by {@link BillboardCollection}.\n * <br /><br />\n * This function should not be confused with {@link czm_viewportOrthographic},\n * which is an orthographic projection matrix that transforms from window \n * coordinates to clip coordinates.\n *\n * @name czm_modelToWindowCoordinates\n * @glslFunction\n *\n * @param {vec4} position The position in model coordinates to transform.\n *\n * @returns {vec4} The transformed position in window coordinates.\n *\n * @see czm_eyeToWindowCoordinates\n * @see czm_modelViewProjection\n * @see czm_viewportTransformation\n * @see czm_viewportOrthographic\n * @see BillboardCollection\n *\n * @example\n * vec4 positionWC = czm_modelToWindowCoordinates(positionMC);\n */\nvec4 czm_modelToWindowCoordinates(vec4 position)\n{\n    vec4 q = czm_modelViewProjection * position;                // clip coordinates\n    q.xyz /= q.w;                                                // normalized device coordinates\n    q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz; // window coordinates\n    return q;\n}\n"});define("Shaders/Builtin/Functions/multiplyWithColorBalance",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_multiplyWithColorBalance\n * @glslFunction\n */\nvec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)\n{\n    // Algorithm from Chapter 10 of Graphics Shaders.\n    const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n    \n    vec3 target = left * right;\n    float leftLuminance = dot(left, W);\n    float rightLuminance = dot(right, W);\n    float targetLuminance = dot(target, W);\n    \n    return ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;\n}\n"});define("Shaders/Builtin/Functions/nearFarScalar",[],function(){"use strict";return"/**\n * Computes a value that scales with distance.  The scaling is clamped at the near and\n * far distances, and does not extrapolate.  This function works with the\n * {@link NearFarScalar} JavaScript class.\n *\n * @name czm_nearFarScalar\n * @glslFunction\n *\n * @param {vec4} nearFarScalar A vector with 4 components: Near distance (x), Near value (y), Far distance (z), Far value (w).\n * @param {float} cameraDistSq The square of the current distance from the camera.\n *\n * @returns {float} The value at this distance.\n */\nfloat czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)\n{\n    float valueAtMin = nearFarScalar.y;\n    float valueAtMax = nearFarScalar.w;\n    float nearDistanceSq = nearFarScalar.x * nearFarScalar.x;\n    float farDistanceSq = nearFarScalar.z * nearFarScalar.z;\n\n    float t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);\n\n    t = pow(clamp(t, 0.0, 1.0), 0.2);\n\n    return mix(valueAtMin, valueAtMax, t);\n}\n"});define("Shaders/Builtin/Functions/octDecode",[],function(){"use strict";return" /**\n  * Decodes a unit-length vector in 'oct' encoding to a normalized 3-component Cartesian vector.\n  * The 'oct' encoding is described in \"A Survey of Efficient Representations of Independent Unit Vectors\",\n  * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/\n  *\n  * @name czm_octDecode\n  * @param {vec2} encoded The oct-encoded, unit-length vector\n  * @param {float} range The maximum value of the SNORM range. The encoded vector is stored in log2(rangeMax+1) bits.\n  * @returns {vec3} The decoded and normalized vector\n  */\n  vec3 czm_octDecode(vec2 encoded, float range)\n  {\n      if (encoded.x == 0.0 && encoded.y == 0.0) {\n          return vec3(0.0, 0.0, 0.0);\n      }\n\n     encoded = encoded / range * 2.0 - 1.0;\n     vec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));\n     if (v.z < 0.0)\n     {\n         v.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);\n     }\n\n     return normalize(v);\n  }\n\n/**\n * Decodes a unit-length vector in 'oct' encoding to a normalized 3-component Cartesian vector.\n * The 'oct' encoding is described in \"A Survey of Efficient Representations of Independent Unit Vectors\",\n * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/\n * \n * @name czm_octDecode\n * @param {vec2} encoded The oct-encoded, unit-length vector\n * @returns {vec3} The decoded and normalized vector\n */\n vec3 czm_octDecode(vec2 encoded)\n {\n    return czm_octDecode(encoded, 255.0);\n }\n\n /**\n * Decodes a unit-length vector in 'oct' encoding packed into a floating-point number to a normalized 3-component Cartesian vector.\n * The 'oct' encoding is described in \"A Survey of Efficient Representations of Independent Unit Vectors\",\n * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/\n * \n * @name czm_octDecode\n * @param {float} encoded The oct-encoded, unit-length vector\n * @returns {vec3} The decoded and normalized vector\n */\n vec3 czm_octDecode(float encoded)\n {\n    float temp = encoded / 256.0;\n    float x = floor(temp);\n    float y = (temp - x) * 256.0;\n    return czm_octDecode(vec2(x, y));\n }\n \n/**\n * Decodes three unit-length vectors in 'oct' encoding packed into two floating-point numbers to normalized 3-component Cartesian vectors.\n * The 'oct' encoding is described in \"A Survey of Efficient Representations of Independent Unit Vectors\",\n * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/\n * \n * @name czm_octDecode\n * @param {vec2} encoded The packed oct-encoded, unit-length vectors.\n * @param {vec3} vector1 One decoded and normalized vector.\n * @param {vec3} vector2 One decoded and normalized vector.\n * @param {vec3} vector3 One decoded and normalized vector.\n */\n  void czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)\n {\n    float temp = encoded.x / 65536.0;\n    float x = floor(temp);\n    float encodedFloat1 = (temp - x) * 65536.0;\n\n    temp = encoded.y / 65536.0;\n    float y = floor(temp);\n    float encodedFloat2 = (temp - y) * 65536.0;\n\n    vector1 = czm_octDecode(encodedFloat1);\n    vector2 = czm_octDecode(encodedFloat2);\n    vector3 = czm_octDecode(vec2(x, y));\n }\n \n"});define("Shaders/Builtin/Functions/packDepth",[],function(){"use strict";return"/**\n * Packs a depth value into a vec3 that can be represented by unsigned bytes.\n *\n * @name czm_packDepth\n * @glslFunction\n *\n * @param {float} depth The floating-point depth.\n * @returns {vec3} The packed depth.\n */\nvec4 czm_packDepth(float depth)\n{\n    // See Aras Pranckevičius' post Encoding Floats to RGBA\n    // http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\n    vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;\n    enc = fract(enc);\n    enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n    return enc;\n}\n"});define("Shaders/Builtin/Functions/phong",[],function(){"use strict";return"float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\n    return czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\n\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\n    return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\n\n/**\n * Computes a color using the Phong lighting model.\n *\n * @name czm_phong\n * @glslFunction\n *\n * @param {vec3} toEye A normalized vector from the fragment to the eye in eye coordinates.\n * @param {czm_material} material The fragment's material.\n * \n * @returns {vec4} The computed color.\n * \n * @example\n * vec3 positionToEyeEC = // ...\n * czm_material material = // ...\n * gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n *\n * @see czm_getMaterial\n */\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\n    // Diffuse from directional light sources at eye (for top-down)\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n    }\n\n    // Specular from sun and pseudo-moon\n    float specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n    \n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse;\n    color += material.specular * specular;\n\n    return vec4(color, material.alpha);\n}\n\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\n    float specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\n\n    vec3 ambient = vec3(0.0);\n    vec3 color = ambient + material.emission;\n    color += material.diffuse * diffuse;\n    color += material.specular * specular;\n\n    return vec4(color, material.alpha);\n}\n"});define("Shaders/Builtin/Functions/pointAlongRay",[],function(){"use strict";return"/**\n * Computes the point along a ray at the given time.  <code>time</code> can be positive, negative, or zero.\n *\n * @name czm_pointAlongRay\n * @glslFunction\n *\n * @param {czm_ray} ray The ray to compute the point along.\n * @param {float} time The time along the ray.\n * \n * @returns {vec3} The point along the ray at the given time.\n * \n * @example\n * czm_ray ray = czm_ray(vec3(0.0), vec3(1.0, 0.0, 0.0)); // origin, direction\n * vec3 v = czm_pointAlongRay(ray, 2.0); // (2.0, 0.0, 0.0)\n */\nvec3 czm_pointAlongRay(czm_ray ray, float time)\n{\n    return ray.origin + (time * ray.direction);\n}\n"});define("Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval",[],function(){"use strict";return"/**\n * DOC_TBA\n *\n * @name czm_rayEllipsoidIntersectionInterval\n * @glslFunction\n */\nczm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, czm_ellipsoid ellipsoid)\n{\n   // ray and ellipsoid center in eye coordinates.  radii in model coordinates.\n    vec3 q = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;\n    vec3 w = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;\n   \n    q = q - ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ellipsoid.center, 1.0)).xyz;\n    \n    float q2 = dot(q, q);\n    float qw = dot(q, w);\n    \n    if (q2 > 1.0) // Outside ellipsoid.\n    {\n        if (qw >= 0.0) // Looking outward or tangent (0 intersections).\n        {\n            return czm_emptyRaySegment;\n        }\n        else // qw < 0.0.\n        {\n            float qw2 = qw * qw;\n            float difference = q2 - 1.0; // Positively valued.\n            float w2 = dot(w, w);\n            float product = w2 * difference;\n            \n            if (qw2 < product) // Imaginary roots (0 intersections).\n            {\n                return czm_emptyRaySegment;     \n            }   \n            else if (qw2 > product) // Distinct roots (2 intersections).\n            {\n                float discriminant = qw * qw - product;\n                float temp = -qw + sqrt(discriminant); // Avoid cancellation.\n                float root0 = temp / w2;\n                float root1 = difference / temp;\n                if (root0 < root1)\n                {\n                    czm_raySegment i = czm_raySegment(root0, root1);\n                    return i;\n                }\n                else\n                {\n                    czm_raySegment i = czm_raySegment(root1, root0);\n                    return i;\n                }\n            }\n            else // qw2 == product.  Repeated roots (2 intersections).\n            {\n                float root = sqrt(difference / w2);\n                czm_raySegment i = czm_raySegment(root, root);\n                return i;\n            }\n        }\n    }\n    else if (q2 < 1.0) // Inside ellipsoid (2 intersections).\n    {\n        float difference = q2 - 1.0; // Negatively valued.\n        float w2 = dot(w, w);\n        float product = w2 * difference; // Negatively valued.\n        float discriminant = qw * qw - product;\n        float temp = -qw + sqrt(discriminant); // Positively valued.\n        czm_raySegment i = czm_raySegment(0.0, temp / w2);\n        return i;\n    }\n    else // q2 == 1.0. On ellipsoid.\n    {\n        if (qw < 0.0) // Looking inward.\n        {\n            float w2 = dot(w, w);\n            czm_raySegment i = czm_raySegment(0.0, -qw / w2);\n            return i;\n        }\n        else // qw >= 0.0.  Looking outward or tangent.\n        {\n            return czm_emptyRaySegment;\n        }\n    }\n}\n"});define("Shaders/Builtin/Functions/RGBToHSB",[],function(){"use strict";return"/**\n * Converts an RGB color to HSB (hue, saturation, brightness)\n * HSB <-> RGB conversion with minimal branching: {@link http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl}\n *\n * @name czm_RGBToHSB\n * @glslFunction\n * \n * @param {vec3} rgb The color in RGB.\n *\n * @returns {vec3} The color in HSB.\n *\n * @example\n * vec3 hsb = czm_RGBToHSB(rgb);\n * hsb.z *= 0.1;\n * rgb = czm_HSBToRGB(hsb);\n */\n\nconst vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\nvec3 czm_RGBToHSB(vec3 rgb)\n{\n    vec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));\n    vec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));\n\n    float d = q.x - min(q.w, q.y);\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);\n}\n"});define("Shaders/Builtin/Functions/RGBToHSL",[],function(){"use strict";return"/**\n * Converts an RGB color to HSL (hue, saturation, lightness)\n * HSL <-> RGB conversion: {@link http://www.chilliant.com/rgb2hsv.html}\n *\n * @name czm_RGBToHSL\n * @glslFunction\n * \n * @param {vec3} rgb The color in RGB.\n *\n * @returns {vec3} The color in HSL.\n *\n * @example\n * vec3 hsl = czm_RGBToHSL(rgb);\n * hsl.z *= 0.1;\n * rgb = czm_HSLToRGB(hsl);\n */\n \nvec3 RGBtoHCV(vec3 rgb)\n{\n    // Based on work by Sam Hocevar and Emil Persson\n    vec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);\n    vec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);\n    float c = q.x - min(q.w, q.y);\n    float h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);\n    return vec3(h, c, q.x);\n}\n\nvec3 czm_RGBToHSL(vec3 rgb)\n{\n    vec3 hcv = RGBtoHCV(rgb);\n    float l = hcv.z - hcv.y * 0.5;\n    float s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);\n    return vec3(hcv.x, s, l);\n}\n"});define("Shaders/Builtin/Functions/RGBToXYZ",[],function(){"use strict";return"/**\n * Converts an RGB color to CIE Yxy.\n * <p>The conversion is described in\n * {@link http://content.gpwiki.org/index.php/D3DBook:High-Dynamic_Range_Rendering#Luminance_Transform|Luminance Transform}\n * </p>\n * \n * @name czm_RGBToXYZ\n * @glslFunction\n * \n * @param {vec3} rgb The color in RGB.\n *\n * @returns {vec3} The color in CIE Yxy.\n *\n * @example\n * vec3 xyz = czm_RGBToXYZ(rgb);\n * xyz.x = max(xyz.x - luminanceThreshold, 0.0);\n * rgb = czm_XYZToRGB(xyz);\n */\nvec3 czm_RGBToXYZ(vec3 rgb)\n{\n    const mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,\n                              0.3576, 0.7152, 0.1192,\n                              0.1805, 0.0722, 0.9505);\n    vec3 xyz = RGB2XYZ * rgb;\n    vec3 Yxy;\n    Yxy.r = xyz.g;\n    float temp = dot(vec3(1.0), xyz);\n    Yxy.gb = xyz.rg / temp;\n    return Yxy;\n}\n"});define("Shaders/Builtin/Functions/saturation",[],function(){"use strict";return"/**\n * Adjusts the saturation of a color.\n * \n * @name czm_saturation\n * @glslFunction\n * \n * @param {vec3} rgb The color.\n * @param {float} adjustment The amount to adjust the saturation of the color.\n *\n * @returns {float} The color with the saturation adjusted.\n *\n * @example\n * vec3 greyScale = czm_saturation(color, 0.0);\n * vec3 doubleSaturation = czm_saturation(color, 2.0);\n */\nvec3 czm_saturation(vec3 rgb, float adjustment)\n{\n    // Algorithm from Chapter 16 of OpenGL Shading Language\n    const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n    vec3 intensity = vec3(dot(rgb, W));\n    return mix(intensity, rgb, adjustment);\n}\n"});define("Shaders/Builtin/Functions/shadowDepthCompare",[],function(){"use strict";return"\nfloat czm_sampleShadowMap(samplerCube shadowMap, vec3 d)\n{\n    return czm_unpackDepth(textureCube(shadowMap, d));\n}\n\nfloat czm_sampleShadowMap(sampler2D shadowMap, vec2 uv)\n{\n#ifdef USE_SHADOW_DEPTH_TEXTURE\n    return texture2D(shadowMap, uv).r;\n#else\n    return czm_unpackDepth(texture2D(shadowMap, uv));\n#endif\n}\n\nfloat czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)\n{\n    return step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n\nfloat czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)\n{\n    return step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n"});define("Shaders/Builtin/Functions/shadowVisibility",[],function(){"use strict";return"\nfloat czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)\n{\n#ifdef USE_NORMAL_SHADING\n#ifdef USE_NORMAL_SHADING_SMOOTH\n    float strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);\n#else\n    float strength = step(0.0, nDotL);\n#endif\n    visibility *= strength;\n#endif\n\n    visibility = max(visibility, darkness);\n    return visibility;\n}\n\n#ifdef USE_CUBE_MAP_SHADOW\nfloat czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)\n{\n    float depthBias = shadowParameters.depthBias;\n    float depth = shadowParameters.depth;\n    float nDotL = shadowParameters.nDotL;\n    float normalShadingSmooth = shadowParameters.normalShadingSmooth;\n    float darkness = shadowParameters.darkness;\n    vec3 uvw = shadowParameters.texCoords;\n\n    depth -= depthBias;\n    float visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);\n    return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#else\nfloat czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)\n{\n    float depthBias = shadowParameters.depthBias;\n    float depth = shadowParameters.depth;\n    float nDotL = shadowParameters.nDotL;\n    float normalShadingSmooth = shadowParameters.normalShadingSmooth;\n    float darkness = shadowParameters.darkness;\n    vec2 uv = shadowParameters.texCoords;\n\n    depth -= depthBias;\n#ifdef USE_SOFT_SHADOWS\n    vec2 texelStepSize = shadowParameters.texelStepSize;\n    float radius = 1.0;\n    float dx0 = -texelStepSize.x * radius;\n    float dy0 = -texelStepSize.y * radius;\n    float dx1 = texelStepSize.x * radius;\n    float dy1 = texelStepSize.y * radius;\n    float visibility = (\n        czm_shadowDepthCompare(shadowMap, uv, depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)\n    ) * (1.0 / 9.0);\n#else\n    float visibility = czm_shadowDepthCompare(shadowMap, uv, depth);\n#endif\n\n    return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#endif\n"});define("Shaders/Builtin/Functions/signNotZero",[],function(){"use strict";return"/**\n * Returns 1.0 if the given value is positive or zero, and -1.0 if it is negative.  This is similar to the GLSL\n * built-in function <code>sign</code> except that returns 1.0 instead of 0.0 when the input value is 0.0.\n * \n * @name czm_signNotZero\n * @glslFunction\n *\n * @param {} value The value for which to determine the sign.\n * @returns {} 1.0 if the value is positive or zero, -1.0 if the value is negative.\n */\nfloat czm_signNotZero(float value)\n{\n    return value >= 0.0 ? 1.0 : -1.0;\n}\n\nvec2 czm_signNotZero(vec2 value)\n{\n    return vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));\n}\n\nvec3 czm_signNotZero(vec3 value)\n{\n    return vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));\n}\n\nvec4 czm_signNotZero(vec4 value)\n{\n    return vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));\n}\n"});define("Shaders/Builtin/Functions/tangentToEyeSpaceMatrix",[],function(){"use strict";return"/**\n * Creates a matrix that transforms vectors from tangent space to eye space.\n *\n * @name czm_tangentToEyeSpaceMatrix\n * @glslFunction\n *\n * @param {vec3} normalEC The normal vector in eye coordinates.\n * @param {vec3} tangentEC The tangent vector in eye coordinates.\n * @param {vec3} bitangentEC The bitangent vector in eye coordinates.\n *\n * @returns {mat3} The matrix that transforms from tangent space to eye space.\n *\n * @example\n * mat3 tangentToEye = czm_tangentToEyeSpaceMatrix(normalEC, tangentEC, bitangentEC);\n * vec3 normal = tangentToEye * texture2D(normalMap, st).xyz;\n */\nmat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)\n{\n    vec3 normal = normalize(normalEC);\n    vec3 tangent = normalize(tangentEC);\n    vec3 bitangent = normalize(bitangentEC);\n    return mat3(tangent.x  , tangent.y  , tangent.z,\n                bitangent.x, bitangent.y, bitangent.z,\n                normal.x   , normal.y   , normal.z);\n}\n"});define("Shaders/Builtin/Functions/translateRelativeToEye",[],function(){"use strict";return"/**\n * Translates a position (or any <code>vec3</code>) that was encoded with {@link EncodedCartesian3},\n * and then provided to the shader as separate <code>high</code> and <code>low</code> bits to\n * be relative to the eye.  As shown in the example, the position can then be transformed in eye\n * or clip coordinates using {@link czm_modelViewRelativeToEye} or {@link czm_modelViewProjectionRelativeToEye},\n * respectively.\n * <p>\n * This technique, called GPU RTE, eliminates jittering artifacts when using large coordinates as\n * described in {@link http://blogs.agi.com/insight3d/index.php/2008/09/03/precisions-precisions/|Precisions, Precisions}.\n * </p>\n *\n * @name czm_translateRelativeToEye\n * @glslFunction\n *\n * @param {vec3} high The position's high bits.\n * @param {vec3} low The position's low bits.\n * @returns {vec3} The position translated to be relative to the camera's position.\n *\n * @example\n * attribute vec3 positionHigh;\n * attribute vec3 positionLow;\n * \n * void main() \n * {\n *   vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\n *   gl_Position = czm_modelViewProjectionRelativeToEye * p;\n * }\n *\n * @see czm_modelViewRelativeToEye\n * @see czm_modelViewProjectionRelativeToEye\n * @see czm_computePosition\n * @see EncodedCartesian3\n */\nvec4 czm_translateRelativeToEye(vec3 high, vec3 low)\n{\n    vec3 highDifference = high - czm_encodedCameraPositionMCHigh;\n    vec3 lowDifference = low - czm_encodedCameraPositionMCLow;\n\n    return vec4(highDifference + lowDifference, 1.0);\n}\n"});define("Shaders/Builtin/Functions/translucentPhong",[],function(){"use strict";return"/**\n * @private\n */\nvec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\n    // Diffuse from directional light sources at eye (for top-down and horizon views)\n    float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\n    \n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n    }\n    \n    diffuse = clamp(diffuse, 0.0, 1.0);\n\n    // Specular from sun and pseudo-moon\n    float specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\n    specular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse;\n    color += material.specular * specular;\n\n    return vec4(color, material.alpha);\n}\n"});define("Shaders/Builtin/Functions/transpose",[],function(){"use strict";return"/**\n * Returns the transpose of the matrix.  The input <code>matrix</code> can be\n * a <code>mat2</code>, <code>mat3</code>, or <code>mat4</code>.\n *\n * @name czm_transpose\n * @glslFunction\n *\n * @param {} matrix The matrix to transpose.\n *\n * @returns {} The transposed matrix.\n *\n * @example\n * // GLSL declarations\n * mat2 czm_transpose(mat2 matrix);\n * mat3 czm_transpose(mat3 matrix);\n * mat4 czm_transpose(mat4 matrix);\n *\n * // Transpose a 3x3 rotation matrix to find its inverse.\n * mat3 eastNorthUpToEye = czm_eastNorthUpToEyeCoordinates(\n *     positionMC, normalEC);\n * mat3 eyeToEastNorthUp = czm_transpose(eastNorthUpToEye);\n */\nmat2 czm_transpose(mat2 matrix)\n{\n    return mat2(\n        matrix[0][0], matrix[1][0],\n        matrix[0][1], matrix[1][1]);\n}\n\nmat3 czm_transpose(mat3 matrix)\n{\n    return mat3(\n        matrix[0][0], matrix[1][0], matrix[2][0],\n        matrix[0][1], matrix[1][1], matrix[2][1],\n        matrix[0][2], matrix[1][2], matrix[2][2]);\n}\n\nmat4 czm_transpose(mat4 matrix)\n{\n    return mat4(\n        matrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],\n        matrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],\n        matrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],\n        matrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);\n}\n"});define("Shaders/Builtin/Functions/unpackDepth",[],function(){"use strict";return"/**\n * Unpacks a vec3 depth depth value to a float.\n *\n * @name czm_unpackDepth\n * @glslFunction\n *\n * @param {vec3} packedDepth The packed depth.\n *\n * @returns {float} The floating-point depth.\n */\n float czm_unpackDepth(vec4 packedDepth)\n {\n    // See Aras Pranckevičius' post Encoding Floats to RGBA\n    // http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\n    return dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n }\n"});define("Shaders/Builtin/Functions/windowToEyeCoordinates",[],function(){"use strict";return"/**\n * Transforms a position from window to eye coordinates.\n * The transform from window to normalized device coordinates is done using components\n * of (@link czm_viewport} and {@link czm_viewportTransformation} instead of calculating\n * the inverse of <code>czm_viewportTransformation</code>. The transformation from\n * normalized device coordinates to clip coordinates is done using <code>positionWC.w</code>,\n * which is expected to be the scalar used in the perspective divide. The transformation\n * from clip to eye coordinates is done using {@link czm_inverseProjection}.\n *\n * @name czm_windowToEyeCoordinates\n * @glslFunction\n *\n * @param {vec4} fragmentCoordinate The position in window coordinates to transform.\n *\n * @returns {vec4} The transformed position in eye coordinates.\n *\n * @see czm_modelToWindowCoordinates\n * @see czm_eyeToWindowCoordinates\n * @see czm_inverseProjection\n * @see czm_viewport\n * @see czm_viewportTransformation\n *\n * @example\n * vec4 positionEC = czm_windowToEyeCoordinates(gl_FragCoord);\n */\nvec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)\n{\n    float x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;\n    float y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;\n    float z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\n    vec4 q = vec4(x, y, z, 1.0);\n    q /= fragmentCoordinate.w;\n\n    if (czm_inverseProjection != mat4(0.0)) {\n        q = czm_inverseProjection * q;\n    } else {\n        float top = czm_frustumPlanes.x;\n        float bottom = czm_frustumPlanes.y;\n        float left = czm_frustumPlanes.z;\n        float right = czm_frustumPlanes.w;\n\n        float near = czm_currentFrustum.x;\n        float far = czm_currentFrustum.y;\n\n        q.x = (q.x * (right - left) + left + right) * 0.5;\n        q.y = (q.y * (top - bottom) + bottom + top) * 0.5;\n        q.z = (q.z * (near - far) - near - far) * 0.5;\n        q.w = 1.0;\n    }\n\n    return q;\n}\n"});define("Shaders/Builtin/Functions/XYZToRGB",[],function(){"use strict";return"/**\n * Converts a CIE Yxy color to RGB.\n * <p>The conversion is described in\n * {@link http://content.gpwiki.org/index.php/D3DBook:High-Dynamic_Range_Rendering#Luminance_Transform|Luminance Transform}\n * </p>\n * \n * @name czm_XYZToRGB\n * @glslFunction\n * \n * @param {vec3} Yxy The color in CIE Yxy.\n *\n * @returns {vec3} The color in RGB.\n *\n * @example\n * vec3 xyz = czm_RGBToXYZ(rgb);\n * xyz.x = max(xyz.x - luminanceThreshold, 0.0);\n * rgb = czm_XYZToRGB(xyz);\n */\nvec3 czm_XYZToRGB(vec3 Yxy)\n{\n    const mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,\n                              -1.5371,  1.8760, -0.2040,\n                              -0.4985,  0.0416,  1.0572);\n    vec3 xyz;\n    xyz.r = Yxy.r * Yxy.g / Yxy.b;\n    xyz.g = Yxy.r;\n    xyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;\n    \n    return XYZ2RGB * xyz;\n}\n"});define("Shaders/Builtin/CzmBuiltins",["./Constants/degreesPerRadian","./Constants/depthRange","./Constants/epsilon1","./Constants/epsilon2","./Constants/epsilon3","./Constants/epsilon4","./Constants/epsilon5","./Constants/epsilon6","./Constants/epsilon7","./Constants/infinity","./Constants/oneOverPi","./Constants/oneOverTwoPi","./Constants/passCesium3DTile","./Constants/passCompute","./Constants/passEnvironment","./Constants/passGlobe","./Constants/passGround","./Constants/passOpaque","./Constants/passOverlay","./Constants/passTranslucent","./Constants/pi","./Constants/piOverFour","./Constants/piOverSix","./Constants/piOverThree","./Constants/piOverTwo","./Constants/radiansPerDegree","./Constants/sceneMode2D","./Constants/sceneMode3D","./Constants/sceneModeColumbusView","./Constants/sceneModeMorphing","./Constants/solarRadius","./Constants/threePiOver2","./Constants/twoPi","./Constants/webMercatorMaxLatitude","./Structs/depthRangeStruct","./Structs/ellipsoid","./Structs/material","./Structs/materialInput","./Structs/ray","./Structs/raySegment","./Structs/shadowParameters","./Functions/alphaWeight","./Functions/antialias","./Functions/cascadeColor","./Functions/cascadeDistance","./Functions/cascadeMatrix","./Functions/cascadeWeights","./Functions/columbusViewMorph","./Functions/computePosition","./Functions/cosineAndSine","./Functions/decompressTextureCoordinates","./Functions/eastNorthUpToEyeCoordinates","./Functions/ellipsoidContainsPoint","./Functions/ellipsoidNew","./Functions/ellipsoidWgs84TextureCoordinates","./Functions/equalsEpsilon","./Functions/eyeOffset","./Functions/eyeToWindowCoordinates","./Functions/fog","./Functions/geodeticSurfaceNormal","./Functions/getDefaultMaterial","./Functions/getLambertDiffuse","./Functions/getSpecular","./Functions/getWaterNoise","./Functions/getWgs84EllipsoidEC","./Functions/HSBToRGB","./Functions/HSLToRGB","./Functions/hue","./Functions/isEmpty","./Functions/isFull","./Functions/latitudeToWebMercatorFraction","./Functions/luminance","./Functions/metersPerPixel","./Functions/modelToWindowCoordinates","./Functions/multiplyWithColorBalance","./Functions/nearFarScalar","./Functions/octDecode","./Functions/packDepth","./Functions/phong","./Functions/pointAlongRay","./Functions/rayEllipsoidIntersectionInterval","./Functions/RGBToHSB","./Functions/RGBToHSL","./Functions/RGBToXYZ","./Functions/saturation","./Functions/shadowDepthCompare","./Functions/shadowVisibility","./Functions/signNotZero","./Functions/tangentToEyeSpaceMatrix","./Functions/translateRelativeToEye","./Functions/translucentPhong","./Functions/transpose","./Functions/unpackDepth","./Functions/windowToEyeCoordinates","./Functions/XYZToRGB"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U,V,z,q,G,H,j,W,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,ae,oe,se,le,ue,ce,de,fe,he,pe,me,ve,ge,_e,ye,be,we,Ce,Se,Te,Ee,xe,Pe,Ae,Oe,De,Ie,Me,Re,Le,Ne,ke,Fe,Be,Ue,Ve){"use strict";return{czm_degreesPerRadian:e,czm_depthRange:t,czm_epsilon1:r,czm_epsilon2:i,czm_epsilon3:n,czm_epsilon4:a,czm_epsilon5:o,czm_epsilon6:s,czm_epsilon7:l,czm_infinity:u,czm_oneOverPi:c,czm_oneOverTwoPi:d,czm_passCesium3DTile:f,czm_passCompute:h,czm_passEnvironment:p,czm_passGlobe:m,czm_passGround:v,czm_passOpaque:g,czm_passOverlay:_,czm_passTranslucent:y,czm_pi:b,czm_piOverFour:w,czm_piOverSix:C,czm_piOverThree:S,czm_piOverTwo:T,czm_radiansPerDegree:E,czm_sceneMode2D:x,czm_sceneMode3D:P,czm_sceneModeColumbusView:A,czm_sceneModeMorphing:O,czm_solarRadius:D,czm_threePiOver2:I,czm_twoPi:M,czm_webMercatorMaxLatitude:R,czm_depthRangeStruct:L,czm_ellipsoid:N,czm_material:k,czm_materialInput:F,czm_ray:B,czm_raySegment:U,czm_shadowParameters:V,czm_alphaWeight:z,czm_antialias:q,czm_cascadeColor:G,czm_cascadeDistance:H,czm_cascadeMatrix:j,czm_cascadeWeights:W,czm_columbusViewMorph:Y,czm_computePosition:X,czm_cosineAndSine:Q,czm_decompressTextureCoordinates:Z,czm_eastNorthUpToEyeCoordinates:K,czm_ellipsoidContainsPoint:J,czm_ellipsoidNew:$,czm_ellipsoidWgs84TextureCoordinates:ee,czm_equalsEpsilon:te,czm_eyeOffset:re,czm_eyeToWindowCoordinates:ie,czm_fog:ne,czm_geodeticSurfaceNormal:ae,czm_getDefaultMaterial:oe,czm_getLambertDiffuse:se,czm_getSpecular:le,czm_getWaterNoise:ue,czm_getWgs84EllipsoidEC:ce,czm_HSBToRGB:de,czm_HSLToRGB:fe,czm_hue:he,czm_isEmpty:pe,czm_isFull:me,czm_latitudeToWebMercatorFraction:ve,czm_luminance:ge,czm_metersPerPixel:_e,czm_modelToWindowCoordinates:ye,czm_multiplyWithColorBalance:be,czm_nearFarScalar:we,czm_octDecode:Ce,czm_packDepth:Se,czm_phong:Te,czm_pointAlongRay:Ee,czm_rayEllipsoidIntersectionInterval:xe,czm_RGBToHSB:Pe,czm_RGBToHSL:Ae,czm_RGBToXYZ:Oe,czm_saturation:De,czm_shadowDepthCompare:Ie,czm_shadowVisibility:Me,czm_signNotZero:Re,czm_tangentToEyeSpaceMatrix:Le,czm_translateRelativeToEye:Ne,czm_translucentPhong:ke,czm_transpose:Fe,czm_unpackDepth:Be,czm_windowToEyeCoordinates:Ue,czm_XYZToRGB:Ve}});define("Renderer/ShaderSource",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Renderer/modernizeShader","../Shaders/Builtin/CzmBuiltins","./AutomaticUniforms"],function(e,t,r,i,n,a){"use strict";function o(e){e=e.replace(/\/\/.*/g,"");return e.replace(/\/\*\*[\s\S]*?\*\//gm,function(e){var t=e.match(/\n/gm).length;var r="";for(var i=0;i<t;++i){r+="\n"}return r})}function s(e,r,i){var n;for(var a=0;a<i.length;++a){if(i[a].name===e){n=i[a]}}if(!t(n)){r=o(r);n={name:e,glslSource:r,dependsOn:[],requiredBy:[],evaluated:false};i.push(n)}return n}function l(e,r){if(e.evaluated){return}e.evaluated=true;var i=e.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);if(t(i)&&i!==null){i=i.filter(function(e,t){return i.indexOf(e)===t});i.forEach(function(t){if(t!==e.name&&f._czmBuiltinsAndUniforms.hasOwnProperty(t)){var i=s(t,f._czmBuiltinsAndUniforms[t],r);e.dependsOn.push(i);i.requiredBy.push(e);l(i,r)}})}}function u(e){var t=[];var i=[];while(e.length>0){var n=e.pop();i.push(n);if(n.requiredBy.length===0){t.push(n)}}while(t.length>0){var a=t.shift();e.push(a);for(var o=0;o<a.dependsOn.length;++o){var s=a.dependsOn[o];var l=s.requiredBy.indexOf(a);s.requiredBy.splice(l,1);if(s.requiredBy.length===0){t.push(s)}}}var u=[];for(var c=0;c<i.length;++c){if(i[c].requiredBy.length!==0){u.push(i[c])}}if(u.length!==0){var d="A circular dependency was found in the following built-in functions/structs/constants: \n";for(var f=0;f<u.length;++f){d=d+u[f].name+"\n"}throw new r(d)}}function c(e){var t=[];var r=s("main",e,t);l(r,t);u(t);var i="";for(var n=t.length-1;n>=0;--n){i=i+t[n].glslSource+"\n"}return i.replace(r.glslSource,"")}function d(e,n,a){var s;var l;var u="";var d=e.sources;if(t(d)){for(s=0,l=d.length;s<l;++s){u+="\n#line 0\n"+d[s]}}u=o(u);var h;u=u.replace(/#version\s+(.*?)\n/gm,function(e,i){if(t(h)&&h!==i){throw new r("inconsistent versions found: "+h+" and "+i)}h=i;return"\n"});var p=[];u=u.replace(/#extension.*\n/gm,function(e){p.push(e);return"\n"});u=u.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");var m=e.pickColorQualifier;if(t(m)){u=f.createPickFragmentShaderSource(u,m)}var v="";if(t(h)){v="#version "+h+"\n"}var g=p.length;for(s=0;s<g;s++){v+=p[s]}if(n){v+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n#else\n    precision mediump float;\n#endif\n\n"}var _=e.defines;if(t(_)){for(s=0,l=_.length;s<l;++s){var y=_[s];if(y.length!==0){v+="#define "+y+"\n"}}}if(a.webgl2){v+="#define OUTPUT_DECLARATION\n\n"}if(e.includeBuiltIns){v+=c(u)}v+="\n#line 0\n";v+=u;if(a.webgl2){v=i(v,n,true)}return v}function f(i){i=e(i,e.EMPTY_OBJECT);var n=i.pickColorQualifier;if(t(n)&&n!=="uniform"&&n!=="varying"){throw new r("options.pickColorQualifier must be 'uniform' or 'varying'.")}this.defines=t(i.defines)?i.defines.slice(0):[];this.sources=t(i.sources)?i.sources.slice(0):[];this.pickColorQualifier=n;this.includeBuiltIns=e(i.includeBuiltIns,true)}f.prototype.clone=function(){return new f({sources:this.sources,defines:this.defines,pickColorQuantifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})};f.replaceMain=function(e,t){t="void "+t+"()";return e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)};f.prototype.createCombinedVertexShader=function(e){return d(this,false,e)};f.prototype.createCombinedFragmentShader=function(e){return d(this,true,e)};f._czmBuiltinsAndUniforms={};for(var h in n){if(n.hasOwnProperty(h)){f._czmBuiltinsAndUniforms[h]=n[h]}}for(var p in a){if(a.hasOwnProperty(p)){var m=a[p];if(typeof m.getDeclaration==="function"){f._czmBuiltinsAndUniforms[p]=m.getDeclaration(p)}}}f.createPickVertexShaderSource=function(e){var t=f.replaceMain(e,"czm_old_main");var r="attribute vec4 pickColor; \n"+"varying vec4 czm_pickColor; \n"+"void main() \n"+"{ \n"+"    czm_old_main(); \n"+"    czm_pickColor = pickColor; \n"+"}";return t+"\n"+r};f.createPickFragmentShaderSource=function(e,t){var r=f.replaceMain(e,"czm_old_main");var i=t+" vec4 czm_pickColor; \n"+"void main() \n"+"{ \n"+"    czm_old_main(); \n"+"    if (gl_FragColor.a == 0.0) { \n"+"       discard; \n"+"    } \n"+"    gl_FragColor = czm_pickColor; \n"+"}";return r+"\n"+i};f.findVarying=function(e,t){var r=e.sources;var i=t.length;for(var n=0;n<i;++n){var a=t[n];var o=r.length;for(var s=0;s<o;++s){if(r[s].indexOf(a)!==-1){return a}}}return undefined};var v=["v_normalEC","v_normal"];f.findNormalVarying=function(e){return f.findVarying(e,v)};var g=["v_positionEC"];f.findPositionVarying=function(e){return f.findVarying(e,g)};return f});define("Renderer/Buffer",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/IndexDatatype","../Core/WebGLConstants","./BufferUsage"],function(e,t,r,i,n,a,o,s){"use strict";function l(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}if(!t(r.typedArray)&&!t(r.sizeInBytes)){throw new n("Either options.sizeInBytes or options.typedArray is required.")}if(t(r.typedArray)&&t(r.sizeInBytes)){throw new n("Cannot pass in both options.sizeInBytes and options.typedArray.")}if(t(r.typedArray)&&!(typeof r.typedArray==="object"&&typeof r.typedArray.byteLength==="number")){throw new n("options.typedArray must be a typed array")}if(!s.validate(r.usage)){throw new n("usage is invalid.")}var i=r.context._gl;var a=r.bufferTarget;var o=r.typedArray;var l=r.sizeInBytes;var u=r.usage;var c=t(o);if(c){l=o.byteLength}if(l<=0){throw new n("Buffer size must be greater than zero.")}var d=i.createBuffer();i.bindBuffer(a,d);i.bufferData(a,c?o:l,u);i.bindBuffer(a,null);this._gl=i;this._bufferTarget=a;this._sizeInBytes=l;this._usage=u;this._buffer=d;this.vertexArrayDestroyable=true}l.createVertexBuffer=function(e){if(!t(e.context)){throw new n("options.context is required.")}return new l({context:e.context,bufferTarget:o.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})};l.createIndexBuffer=function(e){if(!t(e.context)){throw new n("options.context is required.")}if(!a.validate(e.indexDatatype)){throw new n("Invalid indexDatatype.")}if(e.indexDatatype===a.UNSIGNED_INT&&!e.context.elementIndexUint){throw new n("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.")}var i=e.context;var s=e.indexDatatype;var u=a.getSizeInBytes(s);var c=new l({context:i,bufferTarget:o.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage});var d=c.sizeInBytes/u;r(c,{indexDatatype:{get:function(){return s}},bytesPerIndex:{get:function(){return u}},numberOfIndices:{get:function(){return d}}});return c};r(l.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}});l.prototype._getBuffer=function(){return this._buffer};l.prototype.copyFromArrayView=function(t,r){r=e(r,0);if(!t){throw new n("arrayView is required.")}if(r+t.byteLength>this._sizeInBytes){throw new n("This buffer is not large enough.")}var i=this._gl;var a=this._bufferTarget;i.bindBuffer(a,this._buffer);i.bufferSubData(a,r,t);i.bindBuffer(a,null)};l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){this._gl.deleteBuffer(this._buffer);return i(this)};return l});define("Renderer/VertexArray",["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/IndexDatatype","../Core/Math","../Core/RuntimeError","./Buffer","./BufferUsage","./ContextLimits"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";function h(i,n,o,s){var l=r(n.vertexBuffer);var u=r(n.value);var c=n.value?n.value.length:n.componentsPerAttribute;if(!l&&!u){throw new a("attribute must have a vertexBuffer or a value.")}if(l&&u){throw new a("attribute cannot have both a vertexBuffer and a value.  It must have either a vertexBuffer property defining per-vertex data or a value property defining data for all vertices.")}if(c!==1&&c!==2&&c!==3&&c!==4){if(u){throw new a("attribute.value.length must be in the range [1, 4].")}throw new a("attribute.componentsPerAttribute must be in the range [1, 4].")}if(r(n.componentDatatype)&&!e.validate(n.componentDatatype)){throw new a("attribute must have a valid componentDatatype or not specify it.")}if(r(n.strideInBytes)&&n.strideInBytes>255){throw new a("attribute must have a strideInBytes less than or equal to 255 or not specify it.")}if(r(n.instanceDivisor)&&n.instanceDivisor>0&&!s.instancedArrays){throw new a("instanced arrays is not supported")}if(r(n.instanceDivisor)&&n.instanceDivisor<0){throw new a("attribute must have an instanceDivisor greater than or equal to zero")}if(r(n.instanceDivisor)&&u){throw new a("attribute cannot have have an instanceDivisor if it is not backed by a buffer")}if(r(n.instanceDivisor)&&n.instanceDivisor>0&&n.index===0){throw new a("attribute zero cannot have an instanceDivisor greater than 0")}var d={index:t(n.index,o),enabled:t(n.enabled,true),vertexBuffer:n.vertexBuffer,value:u?n.value.slice(0):undefined,componentsPerAttribute:c,componentDatatype:t(n.componentDatatype,e.FLOAT),normalize:t(n.normalize,false),offsetInBytes:t(n.offsetInBytes,0),strideInBytes:t(n.strideInBytes,0),instanceDivisor:t(n.instanceDivisor,0)};if(l){d.vertexAttrib=function(e){var t=this.index;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer._getBuffer());e.vertexAttribPointer(t,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes);e.enableVertexAttribArray(t);if(this.instanceDivisor>0){s.glVertexAttribDivisor(t,this.instanceDivisor);s._vertexAttribDivisors[t]=this.instanceDivisor;s._previousDrawInstanced=true}};d.disableVertexAttribArray=function(e){e.disableVertexAttribArray(this.index);if(this.instanceDivisor>0){s.glVertexAttribDivisor(o,0)}}}else{switch(d.componentsPerAttribute){case 1:d.vertexAttrib=function(e){e.vertexAttrib1fv(this.index,this.value)};break;case 2:d.vertexAttrib=function(e){e.vertexAttrib2fv(this.index,this.value)};break;case 3:d.vertexAttrib=function(e){e.vertexAttrib3fv(this.index,this.value)};break;case 4:d.vertexAttrib=function(e){e.vertexAttrib4fv(this.index,this.value)};break}d.disableVertexAttribArray=function(e){}}i.push(d)}function p(e,t,i){for(var n=0;n<t.length;++n){var a=t[n];if(a.enabled){a.vertexAttrib(e)}}if(r(i)){e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i._getBuffer())}}function m(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.context)){throw new a("options.context is required.")}if(!r(i.attributes)){throw new a("options.attributes is required.")}var n=i.context;var o=n._gl;var s=i.attributes;var l=i.indexBuffer;var u;var c=[];var d=1;var f=false;var m=false;var v=s.length;for(u=0;u<v;++u){h(c,s[u],u,n)}v=c.length;for(u=0;u<v;++u){var g=c[u];if(r(g.vertexBuffer)&&g.instanceDivisor===0){var _=g.strideInBytes||g.componentsPerAttribute*e.getSizeInBytes(g.componentDatatype);d=g.vertexBuffer.sizeInBytes/_;break}}for(u=0;u<v;++u){if(c[u].instanceDivisor>0){f=true}if(r(c[u].value)){m=true}}var y={};for(u=0;u<v;++u){var b=c[u].index;if(y[b]){throw new a("Index "+b+" is used by more than one attribute.")}y[b]=true}var w;if(n.vertexArrayObject){w=n.glCreateVertexArray();n.glBindVertexArray(w);p(o,c,l);n.glBindVertexArray(null)}this._numberOfVertices=d;this._hasInstancedAttributes=f;this._hasConstantAttributes=m;this._context=n;this._gl=o;this._vao=w;this._attributes=c;this._indexBuffer=l}function v(e){return e.values.length/e.componentsPerAttribute}function g(t){return e.getSizeInBytes(t.componentDatatype)*t.componentsPerAttribute}function _(t){var i;var n;var a;var o=[];for(n in t){if(t.hasOwnProperty(n)&&r(t[n])&&r(t[n].values)){o.push(n);if(t[n].componentDatatype===e.DOUBLE){t[n].componentDatatype=e.FLOAT;t[n].values=e.createTypedArray(e.FLOAT,t[n].values)}}}var s;var l=o.length;if(l>0){s=v(t[o[0]]);for(i=1;i<l;++i){var c=v(t[o[i]]);if(c!==s){throw new u("Each attribute list must have the same number of vertices.  "+"Attribute "+o[i]+" has a different number of vertices "+"("+c.toString()+")"+" than attribute "+o[0]+" ("+s.toString()+").")}}}o.sort(function(r,i){return e.getSizeInBytes(t[i].componentDatatype)-e.getSizeInBytes(t[r].componentDatatype)});var d=0;var f={};for(i=0;i<l;++i){n=o[i];a=t[n];f[n]=d;d+=g(a)}if(d>0){var h=e.getSizeInBytes(t[o[0]].componentDatatype);var p=d%h;if(p!==0){d+=h-p}var m=s*d;var _=new ArrayBuffer(m);var y={};for(i=0;i<l;++i){n=o[i];var b=e.getSizeInBytes(t[n].componentDatatype);y[n]={pointer:e.createTypedArray(t[n].componentDatatype,_),index:f[n]/b,strideInComponentType:d/b}}for(i=0;i<s;++i){for(var w=0;w<l;++w){n=o[w];a=t[n];var C=a.values;var S=y[n];var T=S.pointer;var E=a.componentsPerAttribute;for(var x=0;x<E;++x){T[S.index+x]=C[i*E+x]}S.index+=S.strideInComponentType}}return{buffer:_,offsetsInBytes:f,vertexSizeInBytes:d}}return undefined}m.fromGeometry=function(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.context)){throw new a("options.context is required.")}var n=i.context;var u=t(i.geometry,t.EMPTY_OBJECT);var f=t(i.bufferUsage,d.DYNAMIC_DRAW);var h=t(i.attributeLocations,t.EMPTY_OBJECT);var p=t(i.interleave,false);var v=i.vertexArrayAttributes;var g;var y;var b;var w=r(v)?v:[];var C=u.attributes;if(p){var S=_(C);if(r(S)){b=c.createVertexBuffer({context:n,typedArray:S.buffer,usage:f});var T=S.offsetsInBytes;var E=S.vertexSizeInBytes;for(g in C){if(C.hasOwnProperty(g)&&r(C[g])){y=C[g];if(r(y.values)){w.push({index:h[g],vertexBuffer:b,componentDatatype:y.componentDatatype,componentsPerAttribute:y.componentsPerAttribute,normalize:y.normalize,offsetInBytes:T[g],strideInBytes:E})}else{w.push({index:h[g],value:y.value,componentDatatype:y.componentDatatype,normalize:y.normalize})}}}}}else{for(g in C){if(C.hasOwnProperty(g)&&r(C[g])){y=C[g];var x=y.componentDatatype;if(x===e.DOUBLE){x=e.FLOAT}b=undefined;if(r(y.values)){b=c.createVertexBuffer({context:n,typedArray:e.createTypedArray(x,y.values),usage:f})}w.push({index:h[g],vertexBuffer:b,value:y.value,componentDatatype:x,componentsPerAttribute:y.componentsPerAttribute,normalize:y.normalize})}}}var P;var A=u.indices;if(r(A)){if(o.computeNumberOfVertices(u)>=l.SIXTY_FOUR_KILOBYTES&&n.elementIndexUint){P=c.createIndexBuffer({context:n,typedArray:new Uint32Array(A),usage:f,indexDatatype:s.UNSIGNED_INT})}else{P=c.createIndexBuffer({context:n,typedArray:new Uint16Array(A),usage:f,indexDatatype:s.UNSIGNED_SHORT})}}return new m({context:n,attributes:w,indexBuffer:P})};i(m.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}});m.prototype.getAttribute=function(e){if(!r(e)){throw new a("index is required.")}return this._attributes[e]};function y(e){var t=e._context;var r=e._hasInstancedAttributes;if(!r&&!t._previousDrawInstanced){return}t._previousDrawInstanced=r;var i=t._vertexAttribDivisors;var n=e._attributes;var a=f.maximumVertexAttributes;var o;if(r){var s=n.length;for(o=0;o<s;++o){var l=n[o];if(l.enabled){var u=l.instanceDivisor;var c=l.index;if(u!==i[c]){t.glVertexAttribDivisor(c,u);i[c]=u}}}}else{for(o=0;o<a;++o){if(i[o]>0){t.glVertexAttribDivisor(o,0);i[o]=0}}}}function b(e,t){var i=e._attributes;var n=i.length;for(var a=0;a<n;++a){var o=i[a];if(o.enabled&&r(o.value)){o.vertexAttrib(t)}}}m.prototype._bind=function(){if(r(this._vao)){this._context.glBindVertexArray(this._vao);if(this._context.instancedArrays){y(this)}if(this._hasConstantAttributes){b(this,this._gl)}}else{p(this._gl,this._attributes,this._indexBuffer)}};m.prototype._unBind=function(){if(r(this._vao)){this._context.glBindVertexArray(null)}else{var e=this._attributes;var t=this._gl;for(var i=0;i<e.length;++i){var n=e[i];if(n.enabled){n.disableVertexAttribArray(t)}}if(this._indexBuffer){t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}}};m.prototype.isDestroyed=function(){return false};m.prototype.destroy=function(){var e=this._attributes;for(var t=0;t<e.length;++t){var i=e[t].vertexBuffer;if(r(i)&&!i.isDestroyed()&&i.vertexArrayDestroyable){i.destroy()}}var a=this._indexBuffer;if(r(a)&&!a.isDestroyed()&&a.vertexArrayDestroyable){a.destroy()}if(r(this._vao)){this._context.glDeleteVertexArray(this._vao)}return n(this)};return m});define("Scene/BatchTable",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/combine","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/Math","../Core/PixelFormat","../Renderer/ContextLimits","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g){"use strict";function _(t,i,n){if(!a(t)){throw new l("context is required")}if(!a(i)){throw new l("attributes is required")}if(!a(n)){throw new l("numberOfInstances is required")}this._attributes=i;this._numberOfInstances=n;if(i.length===0){return}var o=y(i);var s=t.floatingPointTexture;var u=o===h.FLOAT&&!s;var c=w(i,u);var d=C(c,i,u);var p=Math.floor(f.maximumTextureSize/d);var m=Math.min(n,p);var v=d*m;var g=Math.ceil(n/m);var _=1/v;var b=_*.5;var S=1/g;var T=S*.5;this._textureDimensions=new e(v,g);this._textureStep=new r(_,b,S,T);this._pixelDatatype=!u?o:h.UNSIGNED_BYTE;this._packFloats=u;this._offsets=c;this._stride=d;this._texture=undefined;var E=4*v*g;this._batchValues=o===h.FLOAT&&!u?new Float32Array(E):new Uint8Array(E);this._batchValuesDirty=false}o(_.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});function y(e){var t=false;var r=e.length;for(var i=0;i<r;++i){if(e[i].componentDatatype!==n.UNSIGNED_BYTE){t=true;break}}return t?h.FLOAT:h.UNSIGNED_BYTE}function b(i,n){var a=i[n].componentsPerAttribute;if(a===2){return e}else if(a===3){return t}else if(a===4){return r}return Number}function w(e,t){var r=new Array(e.length);var i=0;var a=e.length;for(var o=0;o<a;++o){var s=e[o];var l=s.componentDatatype;r[o]=i;if(l!==n.UNSIGNED_BYTE&&t){i+=4}else{++i}}return r}function C(e,t,r){var i=e.length;var a=e[i-1];var o=t[i-1];var s=o.componentDatatype;if(s!==n.UNSIGNED_BYTE&&r){return a+4}return a+1}var S=new r;var T=256;var E=65536;var x=16777216;var P=1/T;var A=1/E;var O=1/x;var D=38;function I(e){var t=e.w/2;var r=Math.floor(t);var i=(t-r)*2;r=r-D;i=i*2-1;i=-i;if(r>=D){return i<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY}var n=i*e.x*P;n+=i*e.y*A;n+=i*e.z*O;return n*Math.pow(10,r)}function M(e,t,i){var n=r.unpack(e,t,S);var a=I(n);n=r.unpack(e,t+4,S);var o=I(n);n=r.unpack(e,t+8,S);var s=I(n);n=r.unpack(e,t+12,S);var l=I(n);return r.fromElements(a,o,s,l,i)}if(!u.supportsTypedArrays()){return}var R=new Float32Array(1);function L(e,t){R[0]=e;e=R[0];if(e===0){return r.clone(r.ZERO,t)}var i=e<0?1:0;var n;if(!isFinite(e)){e=.1;n=D}else{e=Math.abs(e);n=Math.floor(c.logBase(e,10))+1;e=e/Math.pow(10,n)}var a=e*T;t.x=Math.floor(a);a=(a-t.x)*T;t.y=Math.floor(a);a=(a-t.y)*T;t.z=Math.floor(a);t.w=(n+D)*2+i;return t}function N(e,t,i){var n=L(e.x,S);r.pack(n,t,i);n=L(e.y,n);r.pack(n,t,i+4);n=L(e.z,n);r.pack(n,t,i+8);n=L(e.w,n);r.pack(n,t,i+12)}var k=new r;_.prototype.getBatchedAttribute=function(e,t,i){if(e<0||e>=this._numberOfInstances){throw new l("instanceIndex is out of range.")}if(t<0||t>=this._attributes.length){throw new l("attributeIndex is out of range")}var n=this._attributes;var o=this._offsets[t];var s=this._stride;var u=4*s*e+4*o;var c;if(this._packFloats&&n[t].componentDatatype!==h.UNSIGNED_BYTE){c=M(this._batchValues,u,k)}else{c=r.unpack(this._batchValues,u,k)}var d=b(n,t);if(a(d.fromCartesian4)){return d.fromCartesian4(c,i)}else if(a(d.clone)){return d.clone(c,i)}return c.x};var F=[undefined,undefined,new e,new t,new r];var B=new r;_.prototype.setBatchedAttribute=function(e,t,i){if(e<0||e>=this._numberOfInstances){throw new l("instanceIndex is out of range.")}if(t<0||t>=this._attributes.length){throw new l("attributeIndex is out of range")}if(!a(i)){throw new l("value is required.")}var n=this._attributes;var o=F[n[t].componentsPerAttribute];var s=this.getBatchedAttribute(e,t,o);var u=b(this._attributes,t);var c=a(u.equals)?u.equals(s,i):s===i;if(c){return}var d=B;d.x=a(i.x)?i.x:i;d.y=a(i.y)?i.y:0;d.z=a(i.z)?i.z:0;d.w=a(i.w)?i.w:0;var f=this._offsets[t];var p=this._stride;var m=4*p*e+4*f;if(this._packFloats&&n[t].componentDatatype!==h.UNSIGNED_BYTE){N(d,this._batchValues,m)}else{r.pack(d,this._batchValues,m)}this._batchValuesDirty=true};function U(e,t){var r=e._textureDimensions;e._texture=new m({context:t,pixelFormat:d.RGBA,pixelDatatype:e._pixelDatatype,width:r.x,height:r.y,sampler:new p({minificationFilter:g.NEAREST,magnificationFilter:v.NEAREST})})}function V(e){var t=e._textureDimensions;e._texture.copyFrom({width:t.x,height:t.y,arrayBufferView:e._batchValues})}_.prototype.update=function(e){if(a(this._texture)&&!this._batchValuesDirty||this._attributes.length===0){return}this._batchValuesDirty=false;if(!a(this._texture)){U(this,e.context)}V(this)};_.prototype.getUniformMapCallback=function(){var e=this;return function(t){if(e._attributes.length===0){return t}var r={batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}};return i(t,r)}};function z(e){var t=e._stride;if(e._textureDimensions.y===1){return"uniform vec4 batchTextureStep; \n"+"vec2 computeSt(float batchId) \n"+"{ \n"+"    float stepX = batchTextureStep.x; \n"+"    float centerX = batchTextureStep.y; \n"+"    float numberOfAttributes = float("+t+"); \n"+"    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n"+"} \n"}return"uniform vec4 batchTextureStep; \n"+"uniform vec2 batchTextureDimensions; \n"+"vec2 computeSt(float batchId) \n"+"{ \n"+"    float stepX = batchTextureStep.x; \n"+"    float centerX = batchTextureStep.y; \n"+"    float stepY = batchTextureStep.z; \n"+"    float centerY = batchTextureStep.w; \n"+"    float numberOfAttributes = float("+t+"); \n"+"    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n"+"    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n"+"    return vec2(centerX + (xId * stepX), 1.0 - (centerY + (yId * stepY))); \n"+"} \n"}function q(e){if(!e._packFloats){return""}return"float unpackFloat(vec4 value) \n"+"{ \n"+"    value *= 255.0; \n"+"    float temp = value.w / 2.0; \n"+"    float exponent = floor(temp); \n"+"    float sign = (temp - exponent) * 2.0; \n"+"    exponent = exponent - float("+D+"); \n"+"    sign = sign * 2.0 - 1.0; \n"+"    sign = -sign; \n"+"    float unpacked = sign * value.x * float("+P+"); \n"+"    unpacked += sign * value.y * float("+A+"); \n"+"    unpacked += sign * value.z * float("+O+"); \n"+"    return unpacked * pow(10.0, exponent); \n"+"} \n"}function G(e){if(e===1){return"float"}return"vec"+e}function H(e){if(e===1){return".x"}else if(e===2){return".xy"}else if(e===3){return".xyz"}return""}function j(e,t){var r=e._attributes;var i=r[t];var a=i.componentsPerAttribute;var o=i.functionName;var s=G(a);var l=H(a);var u=e._offsets[t];var c=s+" "+o+"(float batchId) \n"+"{ \n"+"    vec2 st = computeSt(batchId); \n"+"    st.x += batchTextureStep.x * float("+u+"); \n";if(e._packFloats&&i.componentDatatype!==h.UNSIGNED_BYTE){c+="vec4 textureValue; \n"+"textureValue.x = unpackFloat(texture2D(batchTexture, st)); \n"+"textureValue.y = unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); \n"+"textureValue.z = unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); \n"+"textureValue.w = unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); \n"}else{c+="    vec4 textureValue = texture2D(batchTexture, st); \n"}c+="    "+s+" value = textureValue"+l+"; \n";if(e._pixelDatatype===h.UNSIGNED_BYTE&&i.componentDatatype===n.UNSIGNED_BYTE&&!i.normalize){c+="value *= 255.0; \n"}else if(e._pixelDatatype===h.FLOAT&&i.componentDatatype===n.UNSIGNED_BYTE&&i.normalize){c+="value /= 255.0; \n"}c+="    return value; \n"+"} \n";return c}_.prototype.getVertexShaderCallback=function(){var e=this._attributes;if(e.length===0){return function(e){return e}}var t="uniform sampler2D batchTexture; \n";t+=z(this)+"\n";t+=q(this)+"\n";var r=e.length;for(var i=0;i<r;++i){t+=j(this,i)}return function(e){var r=e.indexOf("void main");var i=e.substring(0,r);var n=e.substring(r);return i+"\n"+t+"\n"+n}};_.prototype.isDestroyed=function(){return false};_.prototype.destroy=function(){this._texture=this._texture&&this._texture.destroy();return s(this)};return _});define("Scene/DepthFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS};return e(r)});define("Scene/PrimitivePipeline",["../Core/BoundingSphere","../Core/ComponentDatatype","../Core/defined","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/GeographicProjection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Matrix4","../Core/WebMercatorProjection"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";if(!a.supportsTypedArrays()){return{}}function p(e,t,i){var n=!i;var a=e.length;var o;if(!n&&a>1){var s=e[0].modelMatrix;for(o=1;o<a;++o){if(!f.equals(s,e[o].modelMatrix)){n=true;break}}}if(n){for(o=0;o<a;++o){if(r(e[o].geometry)){c.transformToWorldCoordinates(e[o])}}}else{f.multiplyTransformation(t,e[0].modelMatrix,t)}}function m(e,r){var i=e.attributes;var n=i.position;var a=n.values.length/n.componentsPerAttribute;i.batchId=new l({componentDatatype:t.FLOAT,componentsPerAttribute:1,values:new Float32Array(a)});var o=i.batchId.values;for(var s=0;s<a;++s){o[s]=r}}function v(e){var t=e.length;for(var i=0;i<t;++i){var n=e[i];if(r(n.geometry)){m(n.geometry,i)}else if(r(n.westHemisphereGeometry)&&r(n.eastHemisphereGeometry)){m(n.westHemisphereGeometry,i);m(n.eastHemisphereGeometry,i)}}}function g(n){var a=n.instances;var o=n.projection;var s=n.elementIndexUintSupported;var l=n.scene3DOnly;var u=n.vertexCacheOptimize;var d=n.compressVertices;var f=n.modelMatrix;var h;var m;var g;var _=a.length;for(h=0;h<_;++h){if(r(a[h].geometry)){g=a[h].geometry.primitiveType;break}}for(h=1;h<_;++h){if(r(a[h].geometry)&&a[h].geometry.primitiveType!==g){throw new i("All instance geometries must have the same primitiveType.")}}p(a,f,l);if(!l){for(h=0;h<_;++h){if(r(a[h].geometry)){c.splitLongitude(a[h])}}}v(a);if(u){for(h=0;h<_;++h){var y=a[h];if(r(y.geometry)){c.reorderForPostVertexCache(y.geometry);c.reorderForPreVertexCache(y.geometry)}else if(r(y.westHemisphereGeometry)&&r(y.eastHemisphereGeometry)){c.reorderForPostVertexCache(y.westHemisphereGeometry);c.reorderForPreVertexCache(y.westHemisphereGeometry);c.reorderForPostVertexCache(y.eastHemisphereGeometry);c.reorderForPreVertexCache(y.eastHemisphereGeometry)}}}var b=c.combineInstances(a);_=b.length;for(h=0;h<_;++h){m=b[h];var w=m.attributes;var C;if(!l){for(C in w){if(w.hasOwnProperty(C)&&w[C].componentDatatype===t.DOUBLE){var S=C+"3D";var T=C+"2D";c.projectTo2D(m,C,S,T,o);if(r(m.boundingSphere)&&C==="position"){m.boundingSphereCV=e.fromVertices(m.attributes.position2D.values)}c.encodeAttribute(m,S,S+"High",S+"Low");c.encodeAttribute(m,T,T+"High",T+"Low")}}}else{for(C in w){if(w.hasOwnProperty(C)&&w[C].componentDatatype===t.DOUBLE){c.encodeAttribute(m,C,C+"3DHigh",C+"3DLow")}}}if(d){c.compressVertices(m)}}if(!s){var E=[];_=b.length;for(h=0;h<_;++h){m=b[h];E=E.concat(c.fitToUnsignedShortIndices(m))}b=E}return b}function _(e,t,i,n){var a;var o;var s;var l=n.length-1;if(l>=0){var u=n[l];a=u.offset+u.count;s=u.index;o=i[s].indices.length}else{a=0;s=0;o=i[s].indices.length}var c=e.length;for(var d=0;d<c;++d){var f=e[d];var h=f[t];if(!r(h)){continue}var p=h.indices.length;if(a+p>o){a=0;o=i[++s].indices.length}n.push({index:s,offset:a,count:p});a+=p}}function y(e,t){var r=[];_(e,"geometry",t,r);_(e,"westHemisphereGeometry",t,r);_(e,"eastHemisphereGeometry",t,r);return r}var b={};b.combineGeometry=function(t){var i;var n;var a=t.instances;var o=a.length;if(o>0){i=g(t);if(i.length>0){n=c.createAttributeLocations(i[0])}}var s;if(t.createPickOffsets&&i.length>0){s=y(a,i)}var l=new Array(o);var u=new Array(o);for(var d=0;d<o;++d){var f=a[d];var h=f.geometry;if(r(h)){l[d]=h.boundingSphere;u[d]=h.boundingSphereCV}var p=f.eastHemisphereGeometry;var m=f.westHemisphereGeometry;if(r(p)&&r(m)){if(r(p.boundingSphere)&&r(m.boundingSphere)){l[d]=e.union(p.boundingSphere,m.boundingSphere)}if(r(p.boundingSphereCV)&&r(m.boundingSphereCV)){u[d]=e.union(p.boundingSphereCV,m.boundingSphereCV)}}}return{geometries:i,modelMatrix:t.modelMatrix,attributeLocations:n,pickOffsets:s,boundingSpheres:l,boundingSpheresCV:u}};function w(e,t){var i=e.attributes;for(var n in i){if(i.hasOwnProperty(n)){var a=i[n];if(r(a)&&r(a.values)){t.push(a.values.buffer)}}}if(r(e.indices)){t.push(e.indices.buffer)}}function C(e,t){var r=e.length;for(var i=0;i<r;++i){w(e[i],t)}}function S(t){var i=1;var n=t.length;for(var a=0;a<n;a++){var o=t[a];++i;if(!r(o)){continue}var s=o.attributes;i+=6+2*e.packedLength+(r(o.indices)?o.indices.length:0);for(var l in s){if(s.hasOwnProperty(l)&&r(s[l])){var u=s[l];i+=5+u.values.length}}}return i}b.packCreateGeometryResults=function(t,i){var n=new Float64Array(S(t));var a=[];var o={};var s=t.length;var l=0;n[l++]=s;for(var u=0;u<s;u++){var c=t[u];var d=r(c);n[l++]=d?1:0;if(!d){continue}n[l++]=c.primitiveType;n[l++]=c.geometryType;var f=r(c.boundingSphere)?1:0;n[l++]=f;if(f){e.pack(c.boundingSphere,n,l)}l+=e.packedLength;var h=r(c.boundingSphereCV)?1:0;n[l++]=h;if(h){e.pack(c.boundingSphereCV,n,l)}l+=e.packedLength;var p=c.attributes;var m=[];for(var v in p){if(p.hasOwnProperty(v)&&r(p[v])){m.push(v);if(!r(o[v])){o[v]=a.length;a.push(v)}}}n[l++]=m.length;for(var g=0;g<m.length;g++){var _=m[g];var y=p[_];n[l++]=o[_];n[l++]=y.componentDatatype;n[l++]=y.componentsPerAttribute;n[l++]=y.normalize?1:0;n[l++]=y.values.length;n.set(y.values,l);l+=y.values.length}var b=r(c.indices)?c.indices.length:0;n[l++]=b;if(b>0){n.set(c.indices,l);l+=b}}i.push(n.buffer);return{stringTable:a,packedData:n}};b.unpackCreateGeometryResults=function(r){var i=r.stringTable;var n=r.packedData;var a;var o=new Array(n[0]);var c=0;var f=1;while(f<n.length){var h=n[f++]===1;if(!h){o[c++]=undefined;continue}var p=n[f++];var m=n[f++];var v;var g;var _=n[f++]===1;if(_){v=e.unpack(n,f)}f+=e.packedLength;var y=n[f++]===1;if(y){g=e.unpack(n,f)}f+=e.packedLength;var b;var w;var C;var S=new u;var T=n[f++];for(a=0;a<T;a++){var E=i[n[f++]];var x=n[f++];C=n[f++];var P=n[f++]!==0;b=n[f++];w=t.createTypedArray(x,b);for(var A=0;A<b;A++){w[A]=n[f++]}S[E]=new l({componentDatatype:x,componentsPerAttribute:C,normalize:P,values:w})}var O;b=n[f++];if(b>0){var D=w.length/C;O=d.createTypedArray(D,b);for(a=0;a<b;a++){O[a]=n[f++]}}o[c++]=new s({primitiveType:p,geometryType:m,boundingSphere:v,boundingSphereCV:g,indices:O,attributes:S})}return o};function T(e,t){var r=e.length;var i=new Float64Array(1+r*16);var n=0;i[n++]=r;for(var a=0;a<r;a++){var o=e[a];f.pack(o.modelMatrix,i,n);n+=f.packedLength}t.push(i.buffer);return i}function E(e){var t=e;var r=new Array(t[0]);var i=0;var n=1;while(n<t.length){var a=f.unpack(t,n);n+=f.packedLength;r[i++]={modelMatrix:a}}return r}b.packCombineGeometryParameters=function(e,t){var r=e.createGeometryResults;var i=r.length;for(var n=0;n<i;n++){t.push(r[n].packedData.buffer)}return{createGeometryResults:e.createGeometryResults,packedInstances:T(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof o,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}};b.unpackCombineGeometryParameters=function(e){var t=E(e.packedInstances);var r=e.createGeometryResults;var i=r.length;var a=0;for(var s=0;s<i;s++){var l=b.unpackCreateGeometryResults(r[s]);var u=l.length;for(var c=0;c<u;c++){var d=l[c];var p=t[a];p.geometry=d;++a}}var m=n.clone(e.ellipsoid);var v=e.isGeographic?new o(m):new h(m);return{instances:t,ellipsoid:m,projection:v,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:f.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}};function x(t){var i=t.length;var n=1+(e.packedLength+1)*i;var a=new Float32Array(n);var o=0;a[o++]=i;for(var s=0;s<i;++s){var l=t[s];if(!r(l)){a[o++]=0}else{a[o++]=1;e.pack(t[s],a,o)}o+=e.packedLength}return a}function P(t){var r=new Array(t[0]);var i=0;var n=1;while(n<t.length){if(t[n++]===1){r[i]=e.unpack(t,n)}++i;n+=e.packedLength}return r}b.packCombineGeometryResults=function(e,t){if(r(e.geometries)){C(e.geometries,t)}var i=x(e.boundingSpheres);var n=x(e.boundingSpheresCV);t.push(i.buffer,n.buffer);return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,boundingSpheres:i,boundingSpheresCV:n}};b.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,boundingSpheres:P(e.boundingSpheres),boundingSpheresCV:P(e.boundingSpheresCV)}};return b});define("Scene/PrimitiveState",["../Core/freezeObject"],function(e){"use strict";var t={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6};return e(t)});define("Scene/SceneMode",["../Core/freezeObject"],function(e){"use strict";var t={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};t.getMorphTime=function(e){if(e===t.SCENE3D){return 1}else if(e===t.MORPHING){return undefined}return 0};return e(t)});define("Scene/ShadowMode",["../Core/freezeObject"],function(e){"use strict";var t={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4};t.castShadows=function(e){return e===t.ENABLED||e===t.CAST_ONLY};t.receiveShadows=function(e){return e===t.ENABLED||e===t.RECEIVE_ONLY};t.fromCastReceive=function(e,r){if(e&&r){return t.ENABLED}else if(e){return t.CAST_ONLY}else if(r){return t.RECEIVE_ONLY}return t.DISABLED};return e(t)});define("Scene/Primitive",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/isArray","../Core/Matrix4","../Core/RuntimeError","../Core/subdivideArray","../Core/TaskProcessor","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../ThirdParty/when","./BatchTable","./CullFace","./DepthFunction","./PrimitivePipeline","./PrimitiveState","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U){"use strict";function V(e){e=u(e,u.EMPTY_OBJECT);this.geometryInstances=e.geometryInstances;this.appearance=e.appearance;this._appearance=undefined;this._material=undefined;this.depthFailAppearance=e.depthFailAppearance;this._depthFailAppearance=undefined;this._depthFailMaterial=undefined;this.modelMatrix=b.clone(u(e.modelMatrix,b.IDENTITY));this._modelMatrix=new b;this.show=u(e.show,true);this._vertexCacheOptimize=u(e.vertexCacheOptimize,false);this._interleave=u(e.interleave,false);this._releaseGeometryInstances=u(e.releaseGeometryInstances,true);this._allowPicking=u(e.allowPicking,true);this._asynchronous=u(e.asynchronous,true);this._compressVertices=u(e.compressVertices,true);this.cull=u(e.cull,true);this.debugShowBoundingVolume=u(e.debugShowBoundingVolume,false);this.rtcCenter=e.rtcCenter;if(c(this.rtcCenter)&&(!c(this.geometryInstances)||y(this.geometryInstances)&&this.geometryInstances!==1)){throw new h("Relative-to-center rendering only supports one geometry instance.")}this.shadows=u(e.shadows,U.DISABLED);this._translucent=undefined;this._state=F.READY;this._geometries=[];this._error=undefined;this._numberOfInstances=0;this._boundingSpheres=[];this._boundingSphereWC=[];this._boundingSphereCV=[];this._boundingSphere2D=[];this._boundingSphereMorph=[];this._perInstanceAttributeCache=[];this._instanceIds=[];this._lastPerInstanceAttributeIndex=0;this._va=[];this._attributeLocations=undefined;this._primitiveType=undefined;this._frontFaceRS=undefined;this._backFaceRS=undefined;this._sp=undefined;this._depthFailAppearance=undefined;this._spDepthFail=undefined;this._frontFaceDepthFailRS=undefined;this._backFaceDepthFailRS=undefined;this._pickRS=undefined;this._pickSP=undefined;this._pickIds=[];this._colorCommands=[];this._pickCommands=[];this._readOnlyInstanceAttributes=e._readOnlyInstanceAttributes;this._createBoundingVolumeFunction=e._createBoundingVolumeFunction;this._createRenderStatesFunction=e._createRenderStatesFunction;this._createShaderProgramFunction=e._createShaderProgramFunction;this._createCommandsFunction=e._createCommandsFunction;this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction;this._createPickOffsets=e._createPickOffsets;this._pickOffsets=undefined;this._createGeometryResults=undefined;this._ready=false;this._readyPromise=M.defer();this._batchTable=undefined;this._batchTableAttributeIndices=undefined;this._instanceBoundingSpheres=undefined;this._instanceBoundingSpheresCV=undefined;this._batchTableBoundingSpheresUpdated=false;this._batchTableBoundingSphereAttributeIndices=undefined}d(V.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});function z(e){var t=e.length;var r=[];var i=e[0].attributes;var n;for(n in i){if(i.hasOwnProperty(n)){var a=i[n];var o=true;for(var s=1;s<t;++s){var l=e[s].attributes[n];if(!c(l)||a.componentDatatype!==l.componentDatatype||a.componentsPerAttribute!==l.componentsPerAttribute||a.normalize!==l.normalize){o=false;break}}if(o){r.push(n)}}}return r}var q=new t;var G=new r;var H=new i;function j(e){var n=e.length;if(n===1){return e[0]}else if(n===2){return t.unpack(e,0,q)}else if(n===3){return r.unpack(e,0,G)}else if(n===4){return i.unpack(e,0,H)}}function W(e,t){var r=e.geometryInstances;var i=y(r)?r:[r];var n=i.length;if(n===0){return}var a=z(i);var s=a.length;var d=e.allowPicking;var f=[];var h={};var p={};var m=i[0];var v=m.attributes;var g;var _;var b;for(g=0;g<s;++g){_=a[g];b=v[_];h[_]=g;f.push({functionName:"czm_batchTable_"+_,componentDatatype:b.componentDatatype,componentsPerAttribute:b.componentsPerAttribute,normalize:b.normalize})}if(a.indexOf("distanceDisplayCondition")!==-1){f.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:l.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:l.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:l.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:l.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:l.FLOAT,componentsPerAttribute:1});p.center3DHigh=f.length-5;p.center3DLow=f.length-4;p.center2DHigh=f.length-3;p.center2DLow=f.length-2;p.radius=f.length-1}if(d){f.push({functionName:"czm_batchTable_pickColor",componentDatatype:l.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:true})}var w=f.length;var C=new R(t,f,n);for(g=0;g<n;++g){var S=i[g];v=S.attributes;for(var T=0;T<s;++T){_=a[T];b=v[_];var E=j(b.value);var x=h[_];C.setBatchedAttribute(g,x,E)}if(d){var P={primitive:u(S.pickPrimitive,e)};if(c(S.id)){P.id=S.id}var A=t.createPickId(P);e._pickIds.push(A);var O=A.color;var D=H;D.x=o.floatToByte(O.red);D.y=o.floatToByte(O.green);D.z=o.floatToByte(O.blue);D.w=o.floatToByte(O.alpha);C.setBatchedAttribute(g,w-1,D)}}e._batchTable=C;e._batchTableAttributeIndices=h;e._batchTableBoundingSphereAttributeIndices=p}function Y(e){var t;if(y(e.values)){t=e.values.slice(0)}else{t=new e.values.constructor(e.values)}return new g({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function X(t){var r=t.attributes;var i=new _;for(var n in r){if(r.hasOwnProperty(n)&&c(r[n])){i[n]=Y(r[n])}}var a;if(c(t.indices)){var o=t.indices;if(y(o)){a=o.slice(0)}else{a=new o.constructor(o)}}return new v({attributes:i,indices:a,primitiveType:t.primitiveType,boundingSphere:e.clone(t.boundingSphere)})}function Q(e,t){return{geometry:t,modelMatrix:b.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}var Z=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;V._modifyShaderPosition=function(e,t,r){var i;var n="";var a="";var o="";while((i=Z.exec(t))!==null){var s=i[1];var l="vec4 czm_compute"+s[0].toUpperCase()+s.substr(1)+"()";if(l!=="vec4 czm_computePosition()"){n+=l+";\n"}if(!c(e.rtcCenter)){if(!r){a+="attribute vec3 "+s+"2DHigh;\n"+"attribute vec3 "+s+"2DLow;\n";o+=l+"\n"+"{\n"+"    vec4 p;\n"+"    if (czm_morphTime == 1.0)\n"+"    {\n"+"        p = czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n"+"    }\n"+"    else if (czm_morphTime == 0.0)\n"+"    {\n"+"        p = czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy);\n"+"    }\n"+"    else\n"+"    {\n"+"        p = czm_columbusViewMorph(\n"+"                czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy),\n"+"                czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow),\n"+"                czm_morphTime);\n"+"    }\n"+"    return p;\n"+"}\n\n"}else{o+=l+"\n"+"{\n"+"    return czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n"+"}\n\n"}}else{t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,"");t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,"");n+="uniform mat4 u_modifiedModelView;\n";a+="attribute vec4 position;\n";o+=l+"\n"+"{\n"+"    return u_modifiedModelView * position;\n"+"}\n\n";t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,"");t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")}}return[n,a,t,o].join("\n")};V._appendShowToShader=function(e,t){if(!c(e._batchTableAttributeIndices.show)){return t}var r=D.replaceMain(t,"czm_non_show_main");var i="void main() \n"+"{ \n"+"    czm_non_show_main(); \n"+"    gl_Position *= czm_batchTable_show(batchId); \n"+"}";return r+"\n"+i};V._updateColorAttribute=function(e,t,r){if(!c(e._batchTableAttributeIndices.color)&&!c(e._batchTableAttributeIndices.depthFailColor)){return t}if(t.search(/attribute\s+vec4\s+color;/g)===-1){return t}if(r&&!c(e._batchTableAttributeIndices.depthFailColor)){throw new h("A depthFailColor per-instance attribute is required when using a depth fail appearance that uses a color attribute.")}var i=t;i=i.replace(/attribute\s+vec4\s+color;/g,"");if(!r){i=i.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2")}else{i=i.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2")}return i};V._updatePickColorAttribute=function(e){var t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2");return t};V._appendDistanceDisplayConditionToShader=function(e,t,r){if(!c(e._batchTableAttributeIndices.distanceDisplayCondition)){return t}var i=D.replaceMain(t,"czm_non_distanceDisplayCondition_main");var n="void main() \n"+"{ \n"+"    czm_non_distanceDisplayCondition_main(); \n"+"    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n"+"    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n"+"    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n"+"    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n"+"    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n"+"    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";if(!r){n+="    vec4 centerRTE;\n"+"    if (czm_morphTime == 1.0)\n"+"    {\n"+"        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n"+"    }\n"+"    else if (czm_morphTime == 0.0)\n"+"    {\n"+"        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n"+"    }\n"+"    else\n"+"    {\n"+"        centerRTE = czm_columbusViewMorph(\n"+"                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n"+"                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n"+"                czm_morphTime);\n"+"    }\n"}else{n+="    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n"}n+="    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n"+"    float distanceSq; \n"+"    if (czm_sceneMode == czm_sceneMode2D) \n"+"    { \n"+"        distanceSq = czm_eyeHeight2D.y - radiusSq; \n"+"    } \n"+"    else \n"+"    { \n"+"        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n"+"    } \n"+"    distanceSq = max(distanceSq, 0.0); \n"+"    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n"+"    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n"+"    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n"+"    gl_Position *= show; \n"+"}";return i+"\n"+n};function K(e,t){if(!e.compressVertices){return t}var r=t.search(/attribute\s+vec3\s+normal;/g)!==-1;var i=t.search(/attribute\s+vec2\s+st;/g)!==-1;if(!r&&!i){return t}var n=t.search(/attribute\s+vec3\s+tangent;/g)!==-1;var a=t.search(/attribute\s+vec3\s+bitangent;/g)!==-1;var o=i&&r?2:1;o+=n||a?1:0;var s=o>1?"vec"+o:"float";var l="compressedAttributes";var u="attribute "+s+" "+l+";";var c="";var d="";if(i){c+="vec2 st;\n";var f=o>1?l+".x":l;d+="    st = czm_decompressTextureCoordinates("+f+");\n"}if(r&&n&&a){c+="vec3 normal;\n"+"vec3 tangent;\n"+"vec3 bitangent;\n";d+="    czm_octDecode("+l+"."+(i?"yz":"xy")+", normal, tangent, bitangent);\n"}else{if(r){c+="vec3 normal;\n";d+="    normal = czm_octDecode("+l+(o>1?"."+(i?"y":"x"):"")+");\n"}if(n){c+="vec3 tangent;\n";d+="    tangent = czm_octDecode("+l+"."+(i&&r?"z":"y")+");\n"}if(a){c+="vec3 bitangent;\n";d+="    bitangent = czm_octDecode("+l+"."+(i&&r?"z":"y")+");\n"}}var h=t;h=h.replace(/attribute\s+vec3\s+normal;/g,"");h=h.replace(/attribute\s+vec2\s+st;/g,"");h=h.replace(/attribute\s+vec3\s+tangent;/g,"");h=h.replace(/attribute\s+vec3\s+bitangent;/g,"");h=D.replaceMain(h,"czm_non_compressed_main");var p="void main() \n"+"{ \n"+d+"    czm_non_compressed_main(); \n"+"}";return[u,c,h,p].join("\n")}function J(e){var t=D.replaceMain(e,"czm_non_depth_clamp_main");t+="varying float v_WindowZ;\n"+"void main() {\n"+"    czm_non_depth_clamp_main();\n"+"    vec4 position = gl_Position;\n"+"    v_WindowZ = (0.5 * (position.z / position.w) + 0.5) * position.w;\n"+"    position.z = min(position.z, position.w);\n"+"    gl_Position = position;"+"}\n";return t}function $(e){var t=D.replaceMain(e,"czm_non_depth_clamp_main");t+="varying float v_WindowZ;\n"+"void main() {\n"+"    czm_non_depth_clamp_main();\n"+"#ifdef GL_EXT_frag_depth\n"+"    gl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n"+"#endif\n"+"}\n";t="#ifdef GL_EXT_frag_depth\n"+"#extension GL_EXT_frag_depth : enable\n"+"#endif\n"+t;return t}function ee(e,t){var r=e.vertexAttributes;for(var i in r){if(r.hasOwnProperty(i)){if(!c(t[i])){throw new h("Appearance/Geometry mismatch.  The appearance requires vertex shader attribute input '"+i+"', which was not computed as part of the Geometry.  Use the appearance's vertexFormat property when constructing the geometry.")}}}}function te(e,t){return function(){return e[t]}}var re=Math.max(m.hardwareConcurrency-1,1);var ie;var ne=new S("combineGeometry",Number.POSITIVE_INFINITY);function ae(e,t){var r;var i;var n;var a;var o=e._instanceIds;if(e._state===F.READY){r=y(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var s=e._numberOfInstances=r.length;var l=[];var d=[];for(n=0;n<s;++n){i=r[n].geometry;o.push(r[n].id);if(!c(i._workerName)){throw new h("_workerName must be defined for asynchronous geometry.")}d.push({moduleName:i._workerName,geometry:i})}if(!c(ie)){ie=new Array(re);for(n=0;n<re;n++){ie[n]=new S("createGeometry",Number.POSITIVE_INFINITY)}}var f;d=C(d,re);for(n=0;n<d.length;n++){var p=0;var m=d[n];var v=m.length;for(a=0;a<v;++a){f=m[a];i=f.geometry;if(c(i.constructor.pack)){f.offset=p;p+=u(i.constructor.packedLength,i.packedLength)}}var g;if(p>0){var _=new Float64Array(p);g=[_.buffer];for(a=0;a<v;++a){f=m[a];i=f.geometry;if(c(i.constructor.pack)){i.constructor.pack(i,_,f.offset);f.geometry=_}}}l.push(ie[n].scheduleTask({subTasks:d[n]},g))}e._state=F.CREATING;M.all(l,function(t){e._createGeometryResults=t;e._state=F.CREATED}).otherwise(function(r){Se(e,t,F.FAILED,r)})}else if(e._state===F.CREATED){var w=[];r=y(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var T=t.scene3DOnly;var E=t.mapProjection;var x=ne.scheduleTask(k.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:r,ellipsoid:E.ellipsoid,projection:E,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:T,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},w),w);e._createGeometryResults=undefined;e._state=F.COMBINING;M(x,function(r){var i=k.unpackCombineGeometryResults(r);e._geometries=i.geometries;e._attributeLocations=i.attributeLocations;e.modelMatrix=b.clone(i.modelMatrix,e.modelMatrix);e._pickOffsets=i.pickOffsets;e._instanceBoundingSpheres=i.boundingSpheres;e._instanceBoundingSpheresCV=i.boundingSpheresCV;if(c(e._geometries)&&e._geometries.length>0){e._state=F.COMBINED}else{Se(e,t,F.FAILED,undefined)}}).otherwise(function(r){Se(e,t,F.FAILED,r)})}}function oe(e,t){var r=y(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var i=e._numberOfInstances=r.length;var n=new Array(i);var a=e._instanceIds;var o;var s;var l=0;for(s=0;s<i;s++){o=r[s];var u=o.geometry;var d;if(c(u.attributes)&&c(u.primitiveType)){d=X(u)}else{d=u.constructor.createGeometry(u)}n[l++]=Q(o,d);a.push(o.id)}n.length=l;var f=t.scene3DOnly;var h=t.mapProjection;var p=k.combineGeometry({instances:n,ellipsoid:h.ellipsoid,projection:h,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:f,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=p.geometries;e._attributeLocations=p.attributeLocations;e.modelMatrix=b.clone(p.modelMatrix,e.modelMatrix);e._pickOffsets=p.pickOffsets;e._instanceBoundingSpheres=p.boundingSpheres;e._instanceBoundingSpheresCV=p.boundingSpheresCV;if(c(e._geometries)&&e._geometries.length>0){e._state=F.COMBINED}else{Se(e,t,F.FAILED,undefined)}}var se=new p;var le=new n;var ue=new r;var ce=new e;function de(t,r){var i=c(t._batchTableAttributeIndices.distanceDisplayCondition);if(!i||t._batchTableBoundingSpheresUpdated){return}var n=t._batchTableBoundingSphereAttributeIndices;var a=n.center3DHigh;var o=n.center3DLow;var s=n.center2DHigh;var l=n.center2DLow;var u=n.radius;var d=r.mapProjection;var f=d.ellipsoid;var h=t._batchTable;var m=t._instanceBoundingSpheres;var v=m.length;for(var g=0;g<v;++g){var _=m[g];if(!c(_)){continue}var y=t.modelMatrix;if(c(y)){_=e.transform(_,y,ce)}var b=_.center;var w=_.radius;var C=p.fromCartesian(b,se);h.setBatchedAttribute(g,a,C.high);h.setBatchedAttribute(g,o,C.low);var S=f.cartesianToCartographic(b,le);var T=d.project(S,ue);C=p.fromCartesian(T,se);h.setBatchedAttribute(g,s,C.high);h.setBatchedAttribute(g,l,C.low);h.setBatchedAttribute(g,u,w)}t._batchTableBoundingSpheresUpdated=true}function fe(t,r){var i=t._attributeLocations;var n=t._geometries;var a=r.scene3DOnly;var o=r.context;var s=[];var l=n.length;for(var u=0;u<l;++u){var d=n[u];s.push(I.fromGeometry({context:o,geometry:d,attributeLocations:i,bufferUsage:T.STATIC_DRAW,interleave:t._interleave}));if(c(t._createBoundingVolumeFunction)){t._createBoundingVolumeFunction(r,d)}else{t._boundingSpheres.push(e.clone(d.boundingSphere));t._boundingSphereWC.push(new e);if(!a){var f=d.boundingSphereCV.center;var h=f.x;var p=f.y;var m=f.z;f.x=m;f.y=h;f.z=p;t._boundingSphereCV.push(e.clone(d.boundingSphereCV));t._boundingSphere2D.push(new e);t._boundingSphereMorph.push(new e)}}}t._va=s;t._primitiveType=n[0].primitiveType;if(t.releaseGeometryInstances){t.geometryInstances=undefined}t._geometries=undefined;Se(t,r,F.COMPLETE,undefined)}function he(e,t,r,i){var n=r.getRenderState();var o;if(i){o=a(n,false);o.cull={enabled:true,face:L.BACK};e._frontFaceRS=A.fromCache(o);o.cull.face=L.FRONT;e._backFaceRS=A.fromCache(o)}else{e._frontFaceRS=A.fromCache(n);e._backFaceRS=e._frontFaceRS}o=a(n,false);if(c(e._depthFailAppearance)){o.depthTest.enabled=false}if(e.allowPicking){if(i){o.cull={enabled:false};e._pickRS=A.fromCache(o)}else{e._pickRS=A.fromCache(o)}}else{o.colorMask={red:false,green:false,blue:false,alpha:false};if(i){o.cull={enabled:false};e._pickRS=A.fromCache(o)}else{e._pickRS=A.fromCache(o)}}if(c(e._depthFailAppearance)){n=e._depthFailAppearance.getRenderState();o=a(n,false);o.depthTest.func=N.GREATER;if(i){o.cull={enabled:true,face:L.BACK};e._frontFaceDepthFailRS=A.fromCache(o);o.cull.face=L.FRONT;e._backFaceDepthFailRS=A.fromCache(o)}else{e._frontFaceDepthFailRS=A.fromCache(o);e._backFaceDepthFailRS=e._frontFaceRS}}}function pe(e,t,r){var i=t.context;var n=e._attributeLocations;var a=e._batchTable.getVertexShaderCallback()(r.vertexShaderSource);a=V._appendShowToShader(e,a);a=V._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly);a=V._updateColorAttribute(e,a,false);a=K(e,a);a=V._modifyShaderPosition(e,a,t.scene3DOnly);var o=r.getFragmentShaderSource();if(e.allowPicking){var s=D.createPickVertexShaderSource(a);s=V._updatePickColorAttribute(s);e._pickSP=O.replaceCache({context:i,shaderProgram:e._pickSP,vertexShaderSource:s,fragmentShaderSource:D.createPickFragmentShaderSource(o,"varying"),attributeLocations:n})}else{e._pickSP=O.fromCache({context:i,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:n})}ee(e._pickSP,n);e._sp=O.replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:n});ee(e._sp,n);if(c(e._depthFailAppearance)){a=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource);a=V._appendShowToShader(e,a);a=V._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly);a=V._updateColorAttribute(e,a,true);a=K(e,a);a=V._modifyShaderPosition(e,a,t.scene3DOnly);a=J(a);o=$(e._depthFailAppearance.getFragmentShaderSource());e._spDepthFail=O.replaceCache({context:i,shaderProgram:e._spDepthFail,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:n});ee(e._spDepthFail,n)}}var me=new b;var ve=new r;function ge(e,t,r,i){var n=c(r)?r._uniforms:undefined;var a={};var o=t.uniforms;if(c(o)){for(var l in o){if(o.hasOwnProperty(l)){if(c(n)&&c(n[l])){throw new h("Appearance and material have a uniform with the same name: "+l)}a[l]=te(o,l)}}}var u=s(a,n);u=e._batchTable.getUniformMapCallback()(u);if(c(e.rtcCenter)){u.u_modifiedModelView=function(){var t=i.context.uniformState.view;b.multiply(t,e._modelMatrix,me);b.multiplyByPoint(me,e.rtcCenter,ve);b.setTranslation(me,ve,me);return me}}return u}function _e(e,t,r,i,n,a,o,s){var l=ge(e,t,r,s);var u;if(c(e._depthFailAppearance)){u=ge(e,e._depthFailAppearance,e._depthFailAppearance.material,s)}var d=i?P.TRANSLUCENT:P.OPAQUE;var f=n?2:1;f*=c(e._depthFailAppearance)?2:1;a.length=e._va.length*f;o.length=e._va.length;var h=a.length;var p=0;var m=0;for(var v=0;v<h;++v){var g;if(n){g=a[v];if(!c(g)){g=a[v]=new x({owner:e,primitiveType:e._primitiveType})}g.vertexArray=e._va[m];g.renderState=e._backFaceRS;g.shaderProgram=e._sp;g.uniformMap=l;g.pass=d;++v}g=a[v];if(!c(g)){g=a[v]=new x({owner:e,primitiveType:e._primitiveType})}g.vertexArray=e._va[m];g.renderState=e._frontFaceRS;g.shaderProgram=e._sp;g.uniformMap=l;g.pass=d;if(c(e._depthFailAppearance)){if(n){++v;g=a[v];if(!c(g)){g=a[v]=new x({owner:e,primitiveType:e._primitiveType})}g.vertexArray=e._va[m];g.renderState=e._backFaceDepthFailRS;g.shaderProgram=e._spDepthFail;g.uniformMap=u;g.pass=d}++v;g=a[v];if(!c(g)){g=a[v]=new x({owner:e,primitiveType:e._primitiveType})}g.vertexArray=e._va[m];g.renderState=e._frontFaceDepthFailRS;g.shaderProgram=e._spDepthFail;g.uniformMap=u;g.pass=d}var _=o[p];if(!c(_)){_=o[p]=new x({owner:e,primitiveType:e._primitiveType})}_.vertexArray=e._va[m];_.renderState=e._pickRS;_.shaderProgram=e._pickSP;_.uniformMap=l;_.pass=d;++p;++m}}V._updateBoundingVolumes=function(t,r,i){var n;var a;var o;var s=t.appearance.pixelSize;if(c(s)){a=t._boundingSpheres.length;for(n=0;n<a;++n){o=t._boundingSpheres[n];var l=t._boundingSphereWC[n];var u=r.camera.getPixelSize(o,r.context.drawingBufferWidth,r.context.drawingBufferHeight);var d=u*s;l.radius=o.radius+d}}if(!b.equals(i,t._modelMatrix)){b.clone(i,t._modelMatrix);a=t._boundingSpheres.length;for(n=0;n<a;++n){o=t._boundingSpheres[n];if(c(o)){t._boundingSphereWC[n]=e.transform(o,i,t._boundingSphereWC[n]);if(!r.scene3DOnly){t._boundingSphere2D[n]=e.clone(t._boundingSphereCV[n],t._boundingSphere2D[n]);t._boundingSphere2D[n].center.x=0;t._boundingSphereMorph[n]=e.union(t._boundingSphereWC[n],t._boundingSphereCV[n])}}}}};function ye(e,t,r,i,n,a,o,s){if(t.mode!==B.SCENE3D&&!b.equals(n,b.IDENTITY)){throw new h("Primitive.modelMatrix is only supported in 3D mode.")}V._updateBoundingVolumes(e,t,n);var l;if(t.mode===B.SCENE3D){l=e._boundingSphereWC}else if(t.mode===B.COLUMBUS_VIEW){l=e._boundingSphereCV}else if(t.mode===B.SCENE2D&&c(e._boundingSphere2D)){l=e._boundingSphere2D}else if(c(e._boundingSphereMorph)){l=e._boundingSphereMorph}var u=t.commandList;var d=t.passes;if(d.render){var f=U.castShadows(e.shadows);var p=U.receiveShadows(e.shadows);var m=r.length;var v=s?2:1;v*=c(e._depthFailAppearance)?2:1;for(var g=0;g<m;++g){var _=Math.floor(g/v);var y=r[g];y.modelMatrix=n;y.boundingVolume=l[_];y.cull=a;y.debugShowBoundingVolume=o;y.castShadows=f;y.receiveShadows=p;u.push(y)}}if(d.pick){var w=i.length;for(var C=0;C<w;++C){var S=i[C];S.modelMatrix=n;S.boundingVolume=l[C];S.cull=a;u.push(S)}}}V.prototype.update=function(e){if(!c(this.geometryInstances)&&this._va.length===0||c(this.geometryInstances)&&y(this.geometryInstances)&&this.geometryInstances.length===0||!c(this.appearance)||e.mode!==B.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick){return}if(c(this._error)){throw this._error}if(c(this.rtcCenter)&&!e.scene3DOnly){throw new h("RTC rendering is only available for 3D only scenes.")}if(this._state===F.FAILED){return}var t=e.context;if(!c(this._batchTable)){W(this,t)}if(this._batchTable.attributes.length>0){if(E.maximumVertexTextureImageUnits===0){throw new w("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.")}this._batchTable.update(e)}if(this._state!==F.COMPLETE&&this._state!==F.COMBINED){if(this.asynchronous){ae(this,e)}else{oe(this,e)}}if(this._state===F.COMBINED){de(this,e);fe(this,e)}if(!this.show||this._state!==F.COMPLETE){return}var r=this.appearance;var i=r.material;var n=false;var a=false;if(this._appearance!==r){this._appearance=r;this._material=i;n=true;a=true}else if(this._material!==i){this._material=i;a=true}var o=this.depthFailAppearance;var s=c(o)?o.material:undefined;if(this._depthFailAppearance!==o){this._depthFailAppearance=o;this._depthFailMaterial=s;n=true;a=true}else if(this._depthFailMaterial!==s){this._depthFailMaterial=s;a=true}var l=this._appearance.isTranslucent();if(this._translucent!==l){this._translucent=l;n=true}if(c(this._material)){this._material.update(t)}var d=r.closed&&l;if(n){var f=u(this._createRenderStatesFunction,he);f(this,t,r,d)}if(a){var p=u(this._createShaderProgramFunction,pe);p(this,e,r)}if(n||a){var m=u(this._createCommandsFunction,_e);m(this,r,i,l,d,this._colorCommands,this._pickCommands,e)}var v=u(this._updateAndQueueCommandsFunction,ye);v(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,d)};function be(e,t,r){return function(){var i=e.getBatchedAttribute(t,r);var n=e.attributes[r];var a=n.componentsPerAttribute;var o=l.createTypedArray(n.componentDatatype,a);if(c(i.constructor.pack)){i.constructor.pack(i,o,0)}else{o[0]=i}return o}}function we(e,t,r){return function(i){if(!c(i)||!c(i.length)||i.length<1||i.length>4){throw new h("value must be and array with length between 1 and 4.")}var n=j(i);e.setBatchedAttribute(t,r,n)}}function Ce(t,r,i){r.boundingSphere={get:function(){var r=t._instanceBoundingSpheres[i];var n=t.modelMatrix;if(c(n)&&c(r)){r=e.transform(r,n)}return r}};r.boundingSphereCV={get:function(){return t._instanceBoundingSpheresCV[i]}}}V.prototype.getGeometryInstanceAttributes=function(e){if(!c(e)){throw new h("id is required")}if(!c(this._batchTable)){throw new h("must call update before calling getGeometryInstanceAttributes")}var t=-1;var r=this._lastPerInstanceAttributeIndex;var i=this._instanceIds;var n=i.length;for(var a=0;a<n;++a){var o=(r+a)%n;if(e===i[o]){t=o;break}}if(t===-1){return undefined}var s=this._perInstanceAttributeCache[t];if(c(s)){return s}var l=this._batchTable;var u=this._batchTableAttributeIndices;s={};var f={};for(var p in u){if(u.hasOwnProperty(p)){var m=u[p];f[p]={get:be(l,t,m)};var v=true;var g=this._readOnlyInstanceAttributes;if(v&&c(g)){n=g.length;for(var _=0;_<n;++_){if(p===g[_]){v=false;break}}}if(v){f[p].set=we(l,t,m)}}}Ce(this,f,t);d(s,f);this._lastPerInstanceAttributeIndex=t;this._perInstanceAttributeCache[t]=s;return s};V.prototype.isDestroyed=function(){return false};V.prototype.destroy=function(){var e;var t;this._sp=this._sp&&this._sp.destroy();this._pickSP=this._pickSP&&this._pickSP.destroy();var r=this._va;e=r.length;for(t=0;t<e;++t){r[t].destroy()}this._va=undefined;var i=this._pickIds;e=i.length;for(t=0;t<e;++t){i[t].destroy()}this._pickIds=undefined;this._batchTable=this._batchTable&&this._batchTable.destroy();this._instanceIds=undefined;this._perInstanceAttributeCache=undefined;this._attributeLocations=undefined;return f(this)};function Se(e,t,r,i){e._error=i;e._state=r;t.afterRender.push(function(){e._ready=e._state===F.COMPLETE||e._state===F.FAILED;if(!c(i)){e._readyPromise.resolve(e)}else{e._readyPromise.reject(i)}})}return V});define("DataSources/ColorMaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a){"use strict";function o(e){this._definitionChanged=new i;this._color=undefined;this._colorSubscription=undefined;this.color=e}r(o.prototype,{isConstant:{get:function(){return a.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:n("color")});o.prototype.getType=function(e){return"Color"};o.prototype.getValue=function(r,i){if(!t(i)){i={}}i.color=a.getValueOrClonedDefault(this._color,r,e.WHITE,i.color);return i};o.prototype.equals=function(e){return this===e||e instanceof o&&a.equals(this._color,e._color)};return o});define("DataSources/dynamicGeometryGetBoundingSphere",["../Core/BoundingSphere","../Core/defined","../Core/DeveloperError","./BoundingSphereState"],function(e,t,r,i){"use strict";function n(n,a,o,s){if(!t(n)){throw new r("entity is required.")}if(!t(s)){throw new r("result is required.")}var l;if(t(a)&&a.show&&a.ready){l=a.getGeometryInstanceAttributes(n);if(t(l)&&t(l.boundingSphere)){e.clone(l.boundingSphere,s);return i.DONE}}if(t(o)&&o.show&&o.ready){l=o.getGeometryInstanceAttributes(n);if(t(l)&&t(l.boundingSphere)){e.clone(l.boundingSphere,s);return i.DONE}}if(t(a)&&!a.ready||t(o)&&!o.ready){return i.PENDING}return i.FAILED}return n});define("DataSources/MaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Scene/Material"],function(e,t,r,i,n){"use strict";function a(){i.throwInstantiationError()}r(a.prototype,{isConstant:{get:i.throwInstantiationError},definitionChanged:{get:i.throwInstantiationError}});a.prototype.getType=i.throwInstantiationError;a.prototype.getValue=i.throwInstantiationError;a.prototype.equals=i.throwInstantiationError;a.getValue=function(r,i,a){var o;if(t(i)){o=i.getType(r);if(t(o)){if(!t(a)||a.type!==o){a=n.fromType(o)}i.getValue(r,a.uniforms);return a}}if(!t(a)||a.type!==n.ColorType){a=n.fromType(n.ColorType)}e.clone(e.WHITE,a.uniforms.color);return a};return a});define("DataSources/BoxGeometryUpdater",["../Core/BoxGeometry","../Core/BoxOutlineGeometry","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S){"use strict";var T=new y(r.WHITE);var E=new b(true);var x=new b(true);var P=new b(false);var A=new b(r.BLACK);var O=new b(_.DISABLED);var D=new b(new u);var I=new r;function M(e){this.id=e;this.vertexFormat=undefined;this.dimensions=undefined}function R(e,t){if(!a(e)){throw new l("entity is required")}if(!a(t)){throw new l("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(R.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new d;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new M(e);this._onEntityPropertyChanged(e,"box",e.box,undefined)}o(R,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:m}});o(R.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:true},geometryChanged:{get:function(){return this._geometryChanged}}});R.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};R.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};R.prototype.createFillGeometryInstance=function(t){if(!a(t)){throw new l("time is required.")}if(!this._fillEnabled){throw new l("This instance does not represent a filled geometry.")}var n=this._entity;var o=n.isAvailable(t);var s;var u;var d=new p(o&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t));var m=this._distanceDisplayConditionProperty.getValue(t);var v=c.fromDistanceDisplayCondition(m);if(this._materialProperty instanceof y){var g=r.WHITE;if(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)){g=this._materialProperty.color.getValue(t)}u=i.fromColor(g);s={show:d,distanceDisplayCondition:v,color:u}}else{s={show:d,distanceDisplayCondition:v}}return new f({id:n,geometry:e.fromDimensions(this._options),modelMatrix:n.computeModelMatrix(h.MINIMUM_VALUE),attributes:s})};R.prototype.createOutlineGeometryInstance=function(e){if(!a(e)){throw new l("time is required.")}if(!this._outlineEnabled){throw new l("This instance does not represent an outlined geometry.")}var n=this._entity;var o=n.isAvailable(e);var s=S.getValueOrDefault(this._outlineColorProperty,e,r.BLACK);var u=this._distanceDisplayConditionProperty.getValue(e);return new f({id:n,geometry:t.fromDimensions(this._options),modelMatrix:n.computeModelMatrix(h.MINIMUM_VALUE),attributes:{show:new p(o&&n.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:i.fromColor(s),distanceDisplayCondition:c.fromDistanceDisplayCondition(u)}})};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._entitySubscription();s(this)};R.prototype._onEntityPropertyChanged=function(e,t,r,i){if(!(t==="availability"||t==="position"||t==="orientation"||t==="box")){return}var o=this._entity.box;if(!a(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var l=a(s)&&s.isConstant?s.getValue(h.MINIMUM_VALUE):true;var u=o.outline;var c=a(u);if(c&&u.isConstant){c=u.getValue(h.MINIMUM_VALUE)}if(!l&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=o.dimensions;var f=e.position;var p=o.show;if(!a(d)||!a(f)||a(p)&&p.isConstant&&!p.getValue(h.MINIMUM_VALUE)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var g=n(o.material,T);var _=g instanceof y;this._materialProperty=g;this._fillProperty=n(s,x);this._showProperty=n(p,E);this._showOutlineProperty=n(o.outline,P);this._outlineColorProperty=c?n(o.outlineColor,A):undefined;this._shadowsProperty=n(o.shadows,O);this._distanceDisplayConditionProperty=n(o.distanceDisplayCondition,D);var b=o.outlineWidth;this._fillEnabled=l;this._outlineEnabled=c;if(!f.isConstant||!S.isConstant(e.orientation)||!d.isConstant||!S.isConstant(b)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var w=this._options;w.vertexFormat=_?v.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat;w.dimensions=d.getValue(h.MINIMUM_VALUE,w.dimensions);this._outlineWidth=a(b)?b.getValue(h.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};R.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new l("This instance does not represent dynamic geometry.")}if(!a(e)){throw new l("primitives is required.")}return new L(e,this)};function L(e,t){this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new M(t._entity)}L.prototype.update=function(n){if(!a(n)){throw new l("time is required.")}var o=this._primitives;o.removeAndDestroy(this._primitive);o.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;var s=this._geometryUpdater;var u=s._entity;var d=u.box;if(!u.isShowing||!u.isAvailable(n)||!S.getValueOrDefault(d.show,n,true)){return}var h=this._options;var p=u.computeModelMatrix(n);var _=S.getValueOrUndefined(d.dimensions,n,h.dimensions);if(!a(p)||!a(_)){return}h.dimensions=_;var y=this._geometryUpdater.shadowsProperty.getValue(n);var b=this._geometryUpdater.distanceDisplayConditionProperty;var w=b.getValue(n);var T=c.fromDistanceDisplayCondition(w);if(S.getValueOrDefault(d.fill,n,true)){var E=C.getValue(n,s.fillMaterialProperty,this._material);this._material=E;var x=new m({material:E,translucent:E.isTranslucent(),closed:true});h.vertexFormat=x.vertexFormat;this._primitive=o.add(new g({geometryInstances:new f({id:u,geometry:e.fromDimensions(h),modelMatrix:p,attributes:{distanceDisplayCondition:T}}),appearance:x,asynchronous:false,shadows:y}))}if(S.getValueOrDefault(d.outline,n,false)){h.vertexFormat=v.VERTEX_FORMAT;var P=S.getValueOrClonedDefault(d.outlineColor,n,r.BLACK,I);var A=S.getValueOrDefault(d.outlineWidth,n,1);var O=P.alpha!==1;this._outlinePrimitive=o.add(new g({geometryInstances:new f({id:u,geometry:t.fromDimensions(h),modelMatrix:p,attributes:{color:i.fromColor(P),distanceDisplayCondition:T}}),appearance:new v({flat:true,translucent:O,renderState:{lineWidth:s._scene.clampLineWidth(A)}}),asynchronous:false,shadows:y}))}};L.prototype.getBoundingSphere=function(e,t){return w(e,this._primitive,this._outlinePrimitive,t)};L.prototype.isDestroyed=function(){return false};L.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);s(this)};return R});define("DataSources/ImageMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o,s){"use strict";var l=new e(1,1);var u=false;var c=t.WHITE;function d(e){e=r(e,r.EMPTY_OBJECT);this._definitionChanged=new a;this._image=undefined;this._imageSubscription=undefined;this._repeat=undefined;this._repeatSubscription=undefined;this._color=undefined;this._colorSubscription=undefined;this._transparent=undefined;this._transparentSubscription=undefined;this.image=e.image;this.repeat=e.repeat;this.color=e.color;this.transparent=e.transparent}n(d.prototype,{isConstant:{get:function(){return s.isConstant(this._image)&&s.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:o("image"),repeat:o("repeat"),color:o("color"),transparent:o("transparent")});d.prototype.getType=function(e){return"Image"};d.prototype.getValue=function(e,t){if(!i(t)){t={}}t.image=s.getValueOrUndefined(this._image,e);t.repeat=s.getValueOrClonedDefault(this._repeat,e,l,t.repeat);t.color=s.getValueOrClonedDefault(this._color,e,c,t.color);if(s.getValueOrDefault(this._transparent,e,u)){t.color.alpha=Math.min(.99,t.color.alpha)}return t};d.prototype.equals=function(e){return this===e||e instanceof d&&s.equals(this._image,e._image)&&s.equals(this._color,e._color)&&s.equals(this._transparent,e._transparent)&&s.equals(this._repeat,e._repeat)};return d});define("DataSources/createMaterialPropertyDescriptor",["../Core/Color","../Core/DeveloperError","./ColorMaterialProperty","./createPropertyDescriptor","./ImageMaterialProperty"],function(e,t,r,i,n){"use strict";function a(i){if(i instanceof e){return new r(i)}if(typeof i==="string"||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement){var a=new n;a.image=i;return a}throw new t("Unable to infer material type: "+i)}function o(e,t){return i(e,t,a)}return o});define("DataSources/BoxGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._dimensions=undefined;this._dimensionsSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),dimensions:o("dimensions"),material:a("material"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.dimensions=this.dimensions;e.show=this.show;e.material=this.material;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.dimensions=e(this.dimensions,r.dimensions);this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/CallbackProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event"],function(e,t,r,i){"use strict";function n(e,t){this._callback=undefined;this._isConstant=undefined;this._definitionChanged=new i;this.setCallback(e,t)}t(n.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}});n.prototype.getValue=function(e,t){return this._callback(e,t)};n.prototype.setCallback=function(t,i){if(!e(t)){throw new r("callback is required.")}if(!e(i)){throw new r("isConstant is required.")}var n=this._callback!==t||this._isConstant!==i;this._callback=t;this._isConstant=i;if(n){this._definitionChanged.raiseEvent(this)}};n.prototype.equals=function(e){return this===e||e instanceof n&&this._callback===e._callback&&this._isConstant===e._isConstant};return n});define("DataSources/CheckerboardMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o,s){"use strict";var l=t.WHITE;var u=t.BLACK;var c=new e(2,2);function d(e){e=r(e,r.EMPTY_OBJECT);this._definitionChanged=new a;this._evenColor=undefined;this._evenColorSubscription=undefined;this._oddColor=undefined;this._oddColorSubscription=undefined;this._repeat=undefined;this._repeatSubscription=undefined;this.evenColor=e.evenColor;this.oddColor=e.oddColor;this.repeat=e.repeat}n(d.prototype,{isConstant:{get:function(){return s.isConstant(this._evenColor)&&s.isConstant(this._oddColor)&&s.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:o("evenColor"),oddColor:o("oddColor"),repeat:o("repeat")});d.prototype.getType=function(e){return"Checkerboard"};d.prototype.getValue=function(e,t){if(!i(t)){t={}}t.lightColor=s.getValueOrClonedDefault(this._evenColor,e,l,t.lightColor);t.darkColor=s.getValueOrClonedDefault(this._oddColor,e,u,t.darkColor);t.repeat=s.getValueOrDefault(this._repeat,e,c);return t};d.prototype.equals=function(e){return this===e||e instanceof d&&s.equals(this._evenColor,e._evenColor)&&s.equals(this._oddColor,e._oddColor)&&s.equals(this._repeat,e._repeat)};return d});define("DataSources/PositionProperty",["../Core/Cartesian3","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Matrix3","../Core/ReferenceFrame","../Core/Transforms"],function(e,t,r,i,n,a,o){"use strict";function s(){i.throwInstantiationError()}r(s.prototype,{isConstant:{get:i.throwInstantiationError},definitionChanged:{get:i.throwInstantiationError},referenceFrame:{get:i.throwInstantiationError}});s.prototype.getValue=i.throwInstantiationError;s.prototype.getValueInReferenceFrame=i.throwInstantiationError;s.prototype.equals=i.throwInstantiationError;var l=new n;s.convertToReferenceFrame=function(r,i,s,u,c){if(!t(i)){return i}if(!t(c)){c=new e}if(s===u){return e.clone(i,c)}var d=o.computeIcrfToFixedMatrix(r,l);if(!t(d)){d=o.computeTemeToPseudoFixedMatrix(r,l)}if(s===a.INERTIAL){return n.multiplyByVector(d,i,c)}if(s===a.FIXED){return n.multiplyByVector(n.transpose(d,l),i,c)}};return s});define("DataSources/ConstantPositionProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./PositionProperty"],function(e,t,r,i,n,a,o,s){"use strict";function l(r,i){this._definitionChanged=new a;this._value=e.clone(r);this._referenceFrame=t(i,o.FIXED)}i(l.prototype,{isConstant:{get:function(){return!r(this._value)||this._referenceFrame===o.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});l.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)};l.prototype.setValue=function(t,i){var n=false;if(!e.equals(this._value,t)){n=true;this._value=e.clone(t)}if(r(i)&&this._referenceFrame!==i){n=true;this._referenceFrame=i}if(n){this._definitionChanged.raiseEvent(this)}};l.prototype.getValueInReferenceFrame=function(e,t,i){if(!r(e)){throw new n("time is required.")}if(!r(t)){throw new n("referenceFrame is required.")}return s.convertToReferenceFrame(e,this._value,this._referenceFrame,t,i)};l.prototype.equals=function(t){return this===t||t instanceof l&&e.equals(this._value,t._value)&&this._referenceFrame===t._referenceFrame};return l});define("DataSources/CorridorGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._positions=undefined;this._positionsSubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._extrudedHeight=undefined;this._extrudedHeightSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._width=undefined;this._widthSubscription=undefined;this._cornerType=undefined;this._cornerTypeSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),positions:o("positions"),height:o("height"),extrudedHeight:o("extrudedHeight"),granularity:o("granularity"),width:o("width"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),cornerType:o("cornerType"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.positions=this.positions;e.height=this.height;e.extrudedHeight=this.extrudedHeight;e.granularity=this.granularity;e.width=this.width;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.cornerType=this.cornerType;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.positions=e(this.positions,r.positions);this.height=e(this.height,r.height);this.extrudedHeight=e(this.extrudedHeight,r.extrudedHeight);this.granularity=e(this.granularity,r.granularity);this.width=e(this.width,r.width);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.cornerType=e(this.cornerType,r.cornerType);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/createRawPropertyDescriptor",["./createPropertyDescriptor"],function(e){"use strict";function t(e){return e}function r(r,i){return e(r,i,t)}return r});define("DataSources/CylinderGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._length=undefined;this._lengthSubscription=undefined;this._topRadius=undefined;this._topRadiusSubscription=undefined;this._bottomRadius=undefined;this._bottomRadiusSubscription=undefined;this._numberOfVerticalLines=undefined;this._numberOfVerticalLinesSubscription=undefined;this._slices=undefined;this._slicesSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},length:o("length"),topRadius:o("topRadius"),bottomRadius:o("bottomRadius"),numberOfVerticalLines:o("numberOfVerticalLines"),slices:o("slices"),show:o("show"),material:a("material"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.bottomRadius=this.bottomRadius;e.length=this.length;e.topRadius=this.topRadius;e.show=this.show;e.material=this.material;e.numberOfVerticalLines=this.numberOfVerticalLines;e.slices=this.slices;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.bottomRadius=e(this.bottomRadius,r.bottomRadius);this.length=e(this.length,r.length);this.topRadius=e(this.topRadius,r.topRadius);this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.numberOfVerticalLines=e(this.numberOfVerticalLines,r.numberOfVerticalLines);this.slices=e(this.slices,r.slices);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/EllipseGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._semiMajorAxis=undefined;this._semiMajorAxisSubscription=undefined;this._semiMinorAxis=undefined;this._semiMinorAxisSubscription=undefined;this._rotation=undefined;this._rotationSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._extrudedHeight=undefined;this._extrudedHeightSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._stRotation=undefined;this._stRotationSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._numberOfVerticalLines=undefined;this._numberOfVerticalLinesSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},semiMajorAxis:o("semiMajorAxis"),semiMinorAxis:o("semiMinorAxis"),rotation:o("rotation"),show:o("show"),material:a("material"),height:o("height"),extrudedHeight:o("extrudedHeight"),granularity:o("granularity"),stRotation:o("stRotation"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),numberOfVerticalLines:o("numberOfVerticalLines"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.rotation=this.rotation;e.semiMajorAxis=this.semiMajorAxis;e.semiMinorAxis=this.semiMinorAxis;e.show=this.show;e.material=this.material;e.height=this.height;e.extrudedHeight=this.extrudedHeight;e.granularity=this.granularity;e.stRotation=this.stRotation;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.numberOfVerticalLines=this.numberOfVerticalLines;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.rotation=e(this.rotation,r.rotation);this.semiMajorAxis=e(this.semiMajorAxis,r.semiMajorAxis);this.semiMinorAxis=e(this.semiMinorAxis,r.semiMinorAxis);this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.height=e(this.height,r.height);this.extrudedHeight=e(this.extrudedHeight,r.extrudedHeight);this.granularity=e(this.granularity,r.granularity);this.stRotation=e(this.stRotation,r.stRotation);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.numberOfVerticalLines=e(this.numberOfVerticalLines,r.numberOfVerticalLines);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/EllipsoidGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._radii=undefined;this._radiiSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._stackPartitions=undefined;this._stackPartitionsSubscription=undefined;this._slicePartitions=undefined;this._slicePartitionsSubscription=undefined;this._subdivisions=undefined;this._subdivisionsSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),radii:o("radii"),material:a("material"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),stackPartitions:o("stackPartitions"),slicePartitions:o("slicePartitions"),subdivisions:o("subdivisions"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.radii=this.radii;e.material=this.material;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.stackPartitions=this.stackPartitions;e.slicePartitions=this.slicePartitions;e.subdivisions=this.subdivisions;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.radii=e(this.radii,r.radii);this.material=e(this.material,r.material);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.stackPartitions=e(this.stackPartitions,r.stackPartitions);this.slicePartitions=e(this.slicePartitions,r.slicePartitions);this.subdivisions=e(this.subdivisions,r.subdivisions);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/LabelGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(e,t,r,i,n,a){"use strict";function o(t){this._text=undefined;this._textSubscription=undefined;this._font=undefined;this._fontSubscription=undefined;this._style=undefined;this._styleSubscription=undefined;this._fillColor=undefined;this._fillColorSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._horizontalOrigin=undefined;this._horizontalOriginSubscription=undefined;this._verticalOrigin=undefined;this._verticalOriginSubscription=undefined;this._eyeOffset=undefined;this._eyeOffsetSubscription=undefined;this._heightReference=undefined;this._heightReferenceSubscription=undefined;this._pixelOffset=undefined;this._pixelOffsetSubscription=undefined;this._scale=undefined;this._scaleSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._showBackground=undefined;this._showBackgroundSubscription=undefined;this._backgroundColor=undefined;this._backgroundColorSubscription=undefined;this._backgroundPadding=undefined;this._backgroundPaddingSubscription=undefined;this._translucencyByDistance=undefined;this._translucencyByDistanceSubscription=undefined;this._pixelOffsetScaleByDistance=undefined;this._pixelOffsetScaleByDistanceSubscription=undefined;this._scaleByDistance=undefined;this._scaleByDistanceSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._disableDepthTestDistance=undefined;this._disableDepthTestDistanceSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(o.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},text:a("text"),font:a("font"),style:a("style"),fillColor:a("fillColor"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),horizontalOrigin:a("horizontalOrigin"),verticalOrigin:a("verticalOrigin"),eyeOffset:a("eyeOffset"),heightReference:a("heightReference"),pixelOffset:a("pixelOffset"),scale:a("scale"),show:a("show"),showBackground:a("showBackground"),backgroundColor:a("backgroundColor"),backgroundPadding:a("backgroundPadding"),translucencyByDistance:a("translucencyByDistance"),pixelOffsetScaleByDistance:a("pixelOffsetScaleByDistance"),scaleByDistance:a("scaleByDistance"),distanceDisplayCondition:a("distanceDisplayCondition"),disableDepthTestDistance:a("disableDepthTestDistance")});o.prototype.clone=function(e){if(!t(e)){return new o(this)}e.text=this.text;e.font=this.font;e.show=this.show;e.style=this.style;e.fillColor=this.fillColor;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.showBackground=this.showBackground;e.backgroundColor=this.backgroundColor;e.backgroundPadding=this.backgroundPadding;e.scale=this.scale;e.horizontalOrigin=this.horizontalOrigin;e.verticalOrigin=this.verticalOrigin;e.eyeOffset=this.eyeOffset;e.heightReference=this.heightReference;e.pixelOffset=this.pixelOffset;e.translucencyByDistance=this.translucencyByDistance;e.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance;e.scaleByDistance=this.scaleByDistance;e.distanceDisplayCondition=this.distanceDisplayCondition;e.disableDepthTestDistance=this.disableDepthTestDistance;return e};o.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.text=e(this.text,r.text);this.font=e(this.font,r.font);this.show=e(this.show,r.show);this.style=e(this.style,r.style);this.fillColor=e(this.fillColor,r.fillColor);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.showBackground=e(this.showBackground,r.showBackground);this.backgroundColor=e(this.backgroundColor,r.backgroundColor);this.backgroundPadding=e(this.backgroundPadding,r.backgroundPadding);this.scale=e(this.scale,r.scale);this.horizontalOrigin=e(this.horizontalOrigin,r.horizontalOrigin);this.verticalOrigin=e(this.verticalOrigin,r.verticalOrigin);this.eyeOffset=e(this.eyeOffset,r.eyeOffset);this.heightReference=e(this.heightReference,r.heightReference);this.pixelOffset=e(this.pixelOffset,r.pixelOffset);this.translucencyByDistance=e(this.translucencyByDistance,r.translucencyByDistance);this.pixelOffsetScaleByDistance=e(this.pixelOffsetScaleByDistance,r.pixelOffsetScaleByDistance);this.scaleByDistance=e(this.scaleByDistance,r.scaleByDistance);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition);this.disableDepthTestDistance=e(this.disableDepthTestDistance,r.disableDepthTestDistance)};return o});define("DataSources/NodeTransformationProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/TranslationRotationScale","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o){"use strict";var s=new n;var l=function(t){t=e(t,e.EMPTY_OBJECT);this._definitionChanged=new i;this._translation=undefined;this._translationSubscription=undefined;this._rotation=undefined;this._rotationSubscription=undefined;this._scale=undefined;this._scaleSubscription=undefined;this.translation=t.translation;this.rotation=t.rotation;this.scale=t.scale};r(l.prototype,{isConstant:{get:function(){return o.isConstant(this._translation)&&o.isConstant(this._rotation)&&o.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:a("translation"),rotation:a("rotation"),scale:a("scale")});l.prototype.getValue=function(e,r){if(!t(r)){r=new n}r.translation=o.getValueOrClonedDefault(this._translation,e,s.translation,r.translation);r.rotation=o.getValueOrClonedDefault(this._rotation,e,s.rotation,r.rotation);r.scale=o.getValueOrClonedDefault(this._scale,e,s.scale,r.scale);return r};l.prototype.equals=function(e){return this===e||e instanceof l&&o.equals(this._translation,e._translation)&&o.equals(this._rotation,e._rotation)&&o.equals(this._scale,e._scale)};return l});define("DataSources/PropertyBag",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./ConstantProperty","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o,s){"use strict";var l=function(e,r){this._propertyNames=[];this._definitionChanged=new n;if(t(e)){this.merge(e,r)}};r(l.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){var e=this._propertyNames;for(var t=0,r=e.length;t<r;t++){if(!s.isConstant(this[e[t]])){return false}}return true}},definitionChanged:{get:function(){return this._definitionChanged}}});l.prototype.hasProperty=function(e){return this._propertyNames.indexOf(e)!==-1};function u(e){return new a(e)}l.prototype.addProperty=function(r,n,a){var s=this._propertyNames;if(!t(r)){throw new i("propertyName is required.")}if(s.indexOf(r)!==-1){throw new i(r+" is already a registered property.")}s.push(r);Object.defineProperty(this,r,o(r,true,e(a,u)));if(t(n)){this[r]=n}this._definitionChanged.raiseEvent(this)};l.prototype.removeProperty=function(e){var r=this._propertyNames;var n=r.indexOf(e);if(!t(e)){throw new i("propertyName is required.")}if(n===-1){throw new i(e+" is not a registered property.")}this._propertyNames.splice(n,1);delete this[e];this._definitionChanged.raiseEvent(this)};l.prototype.getValue=function(e,r){if(!t(e)){throw new i("time is required.")}if(!t(r)){r={}}var n=this._propertyNames;for(var a=0,o=n.length;a<o;a++){var l=n[a];r[l]=s.getValueOrUndefined(this[l],e,r[l])}return r};l.prototype.merge=function(e,r){if(!t(e)){throw new i("source is required.")}var n=this._propertyNames;var a=t(e._propertyNames)?e._propertyNames:Object.keys(e);for(var o=0,s=a.length;o<s;o++){var l=a[o];var u=this[l];var c=e[l];if(u===undefined&&n.indexOf(l)===-1){this.addProperty(l,undefined,r)}if(c!==undefined){if(u!==undefined){if(t(u)&&t(u.merge)){u.merge(c)}}else if(t(c)&&t(c.merge)&&t(c.clone)){this[l]=c.clone()}else{this[l]=c}}}};function c(e,t){var r=e._propertyNames;var i=t._propertyNames;var n=r.length;if(n!==i.length){return false}for(var a=0;a<n;++a){var o=r[a];var l=i.indexOf(o);if(l===-1){return false}if(!s.equals(e[o],t[o])){return false}}return true}l.prototype.equals=function(e){return this===e||e instanceof l&&c(this,e)};return l});define("DataSources/ModelGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor","./NodeTransformationProperty","./PropertyBag"],function(e,t,r,i,n,a,o,s){"use strict";function l(e){return new o(e)}function u(e){return new s(e,l)}function c(t){this._show=undefined;this._showSubscription=undefined;this._scale=undefined;this._scaleSubscription=undefined;this._minimumPixelSize=undefined;this._minimumPixelSizeSubscription=undefined;this._maximumScale=undefined;this._maximumScaleSubscription=undefined;this._incrementallyLoadTextures=undefined;this._incrementallyLoadTexturesSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._uri=undefined;this._uriSubscription=undefined;this._runAnimations=undefined;this._runAnimationsSubscription=undefined;this._nodeTransformations=undefined;this._nodeTransformationsSubscription=undefined;this._heightReference=undefined;this._heightReferenceSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._silhouetteColor=undefined;this._silhouetteColorSubscription=undefined;this._silhouetteSize=undefined;this._silhouetteSizeSubscription=undefined;this._color=undefined;this._colorSubscription=undefined;this._colorBlendMode=undefined;this._colorBlendModeSubscription=undefined;this._colorBlendAmount=undefined;this._colorBlendAmountSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(c.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),scale:a("scale"),minimumPixelSize:a("minimumPixelSize"),maximumScale:a("maximumScale"),incrementallyLoadTextures:a("incrementallyLoadTextures"),shadows:a("shadows"),uri:a("uri"),runAnimations:a("runAnimations"),nodeTransformations:a("nodeTransformations",undefined,u),heightReference:a("heightReference"),distanceDisplayCondition:a("distanceDisplayCondition"),silhouetteColor:a("silhouetteColor"),silhouetteSize:a("silhouetteSize"),color:a("color"),colorBlendMode:a("colorBlendMode"),colorBlendAmount:a("colorBlendAmount")});c.prototype.clone=function(e){if(!t(e)){return new c(this)}e.show=this.show;e.scale=this.scale;e.minimumPixelSize=this.minimumPixelSize;e.maximumScale=this.maximumScale;e.incrementallyLoadTextures=this.incrementallyLoadTextures;e.shadows=this.shadows;e.uri=this.uri;e.runAnimations=this.runAnimations;e.nodeTransformations=this.nodeTransformations;e.heightReference=this._heightReference;e.distanceDisplayCondition=this.distanceDisplayCondition;e.silhouetteColor=this.silhouetteColor;e.silhouetteSize=this.silhouetteSize;e.color=this.color;e.colorBlendMode=this.colorBlendMode;e.colorBlendAmount=this.colorBlendAmount;return e};c.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.scale=e(this.scale,r.scale);this.minimumPixelSize=e(this.minimumPixelSize,r.minimumPixelSize);this.maximumScale=e(this.maximumScale,r.maximumScale);this.incrementallyLoadTextures=e(this.incrementallyLoadTextures,r.incrementallyLoadTextures);this.shadows=e(this.shadows,r.shadows);this.uri=e(this.uri,r.uri);this.runAnimations=e(this.runAnimations,r.runAnimations);this.heightReference=e(this.heightReference,r.heightReference);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition);this.silhouetteColor=e(this.silhouetteColor,r.silhouetteColor);this.silhouetteSize=e(this.silhouetteSize,r.silhouetteSize);this.color=e(this.color,r.color);this.colorBlendMode=e(this.colorBlendMode,r.colorBlendMode);this.colorBlendAmount=e(this.colorBlendAmount,r.colorBlendAmount);var n=r.nodeTransformations;if(t(n)){var a=this.nodeTransformations;if(t(a)){a.merge(n)}else{this.nodeTransformations=new s(n,l)}}};return c});define("DataSources/PathGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._material=undefined;this._materialSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._width=undefined;this._widthSubscription=undefined;this._resolution=undefined;this._resolutionSubscription=undefined;this._leadTime=undefined;this._leadTimeSubscription=undefined;this._trailTime=undefined;this._trailTimeSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),width:o("width"),resolution:o("resolution"),leadTime:o("leadTime"),trailTime:o("trailTime"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.material=this.material;e.width=this.width;e.resolution=this.resolution;e.show=this.show;e.leadTime=this.leadTime;e.trailTime=this.trailTime;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.material=e(this.material,r.material);this.width=e(this.width,r.width);this.resolution=e(this.resolution,r.resolution);this.show=e(this.show,r.show);this.leadTime=e(this.leadTime,r.leadTime);this.trailTime=e(this.trailTime,r.trailTime);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/PointGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(e,t,r,i,n,a){"use strict";function o(t){this._color=undefined;this._colorSubscription=undefined;this._pixelSize=undefined;this._pixelSizeSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._show=undefined;this._showSubscription=undefined;this._scaleByDistance=undefined;this._scaleByDistanceSubscription=undefined;this._translucencyByDistance=undefined;this._translucencyByDistanceSubscription=undefined;this._heightReference=undefined;this._heightReferenceSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._disableDepthTestDistance=undefined;this._disableDepthTestDistanceSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(o.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},color:a("color"),pixelSize:a("pixelSize"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),show:a("show"),scaleByDistance:a("scaleByDistance"),translucencyByDistance:a("translucencyByDistance"),heightReference:a("heightReference"),distanceDisplayCondition:a("distanceDisplayCondition"),disableDepthTestDistance:a("disableDepthTestDistance")});o.prototype.clone=function(e){if(!t(e)){return new o(this)}e.color=this.color;e.pixelSize=this.pixelSize;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.show=this.show;e.scaleByDistance=this.scaleByDistance;e.translucencyByDistance=this._translucencyByDistance;e.heightReference=this.heightReference;e.distanceDisplayCondition=this.distanceDisplayCondition;e.disableDepthTestDistance=this.disableDepthTestDistance;return e};o.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.color=e(this.color,r.color);this.pixelSize=e(this.pixelSize,r.pixelSize);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.show=e(this.show,r.show);this.scaleByDistance=e(this.scaleByDistance,r.scaleByDistance);this.translucencyByDistance=e(this._translucencyByDistance,r.translucencyByDistance);this.heightReference=e(this.heightReference,r.heightReference);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition);this.disableDepthTestDistance=e(this.disableDepthTestDistance,r.disableDepthTestDistance)};return o});define("DataSources/PolygonGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._hierarchy=undefined;this._hierarchySubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._extrudedHeight=undefined;this._extrudedHeightSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._stRotation=undefined;this._stRotationSubscription=undefined;this._perPositionHeight=undefined;this._perPositionHeightSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._definitionChanged=new n;this._closeTop=undefined;this._closeTopSubscription=undefined;this._closeBottom=undefined;this._closeBottomSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),hierarchy:o("hierarchy"),height:o("height"),extrudedHeight:o("extrudedHeight"),granularity:o("granularity"),stRotation:o("stRotation"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),perPositionHeight:o("perPositionHeight"),closeTop:o("closeTop"),closeBottom:o("closeBottom"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.hierarchy=this.hierarchy;e.height=this.height;e.extrudedHeight=this.extrudedHeight;e.granularity=this.granularity;e.stRotation=this.stRotation;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.perPositionHeight=this.perPositionHeight;e.closeTop=this.closeTop;e.closeBottom=this.closeBottom;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.hierarchy=e(this.hierarchy,r.hierarchy);this.height=e(this.height,r.height);this.extrudedHeight=e(this.extrudedHeight,r.extrudedHeight);this.granularity=e(this.granularity,r.granularity);this.stRotation=e(this.stRotation,r.stRotation);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.perPositionHeight=e(this.perPositionHeight,r.perPositionHeight);this.closeTop=e(this.closeTop,r.closeTop);this.closeBottom=e(this.closeBottom,r.closeBottom);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/PolylineGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._depthFailMaterial=undefined;this._depthFailMaterialSubscription=undefined;this._positions=undefined;this._positionsSubscription=undefined;this._followSurface=undefined;this._followSurfaceSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._widthSubscription=undefined;this._width=undefined;this._widthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),depthFailMaterial:a("depthFailMaterial"),positions:o("positions"),width:o("width"),followSurface:o("followSurface"),granularity:o("granularity"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.depthFailMaterial=this.depthFailMaterial;e.positions=this.positions;e.width=this.width;e.followSurface=this.followSurface;e.granularity=this.granularity;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.depthFailMaterial=e(this.depthFailMaterial,r.depthFailMaterial);this.positions=e(this.positions,r.positions);this.width=e(this.width,r.width);this.followSurface=e(this.followSurface,r.followSurface);this.granularity=e(this.granularity,r.granularity);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/PolylineVolumeGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._positions=undefined;this._positionsSubscription=undefined;this._shape=undefined;this._shapeSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._cornerType=undefined;this._cornerTypeSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubsription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),positions:o("positions"),shape:o("shape"),granularity:o("granularity"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),cornerType:o("cornerType"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.positions=this.positions;e.shape=this.shape;e.granularity=this.granularity;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.cornerType=this.cornerType;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.positions=e(this.positions,r.positions);this.shape=e(this.shape,r.shape);this.granularity=e(this.granularity,r.granularity);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.cornerType=e(this.cornerType,r.cornerType);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/RectangleGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._coordinates=undefined;this._coordinatesSubscription=undefined;this._height=undefined;this._heightSubscription=undefined;this._extrudedHeight=undefined;this._extrudedHeightSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._stRotation=undefined;this._stRotationSubscription=undefined;this._rotation=undefined;this._rotationSubscription=undefined;this._closeTop=undefined;this._closeTopSubscription=undefined;this._closeBottom=undefined;this._closeBottomSubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distancedisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),coordinates:o("coordinates"),material:a("material"),height:o("height"),extrudedHeight:o("extrudedHeight"),granularity:o("granularity"),stRotation:o("stRotation"),rotation:o("rotation"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),closeTop:o("closeTop"),closeBottom:o("closeBottom"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.coordinates=this.coordinates;e.material=this.material;e.height=this.height;e.extrudedHeight=this.extrudedHeight;e.granularity=this.granularity;e.stRotation=this.stRotation;e.rotation=this.rotation;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.closeTop=this.closeTop;e.closeBottom=this.closeBottom;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.coordinates=e(this.coordinates,r.coordinates);this.material=e(this.material,r.material);this.height=e(this.height,r.height);this.extrudedHeight=e(this.extrudedHeight,r.extrudedHeight);this.granularity=e(this.granularity,r.granularity);this.stRotation=e(this.stRotation,r.stRotation);this.rotation=e(this.rotation,r.rotation);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.closeTop=e(this.closeTop,r.closeTop);this.closeBottom=e(this.closeBottom,r.closeBottom);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/WallGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,r,i,n,a,o){"use strict";function s(t){this._show=undefined;this._showSubscription=undefined;this._material=undefined;this._materialSubscription=undefined;this._positions=undefined;this._positionsSubscription=undefined;this._minimumHeights=undefined;this._minimumHeightsSubscription=undefined;this._maximumHeights=undefined;this._maximumHeightsSubscription=undefined;this._granularity=undefined;this._granularitySubscription=undefined;this._fill=undefined;this._fillSubscription=undefined;this._outline=undefined;this._outlineSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this._shadows=undefined;this._shadowsSubscription=undefined;this._distanceDisplayCondition=undefined;this._distanceDisplayConditionSubscription=undefined;this._definitionChanged=new n;this.merge(e(t,e.EMPTY_OBJECT))}r(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),material:a("material"),positions:o("positions"),minimumHeights:o("minimumHeights"),maximumHeights:o("maximumHeights"),granularity:o("granularity"),fill:o("fill"),outline:o("outline"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),shadows:o("shadows"),distanceDisplayCondition:o("distanceDisplayCondition")});s.prototype.clone=function(e){if(!t(e)){return new s(this)}e.show=this.show;e.material=this.material;e.positions=this.positions;e.minimumHeights=this.minimumHeights;e.maximumHeights=this.maximumHeights;e.granularity=this.granularity;e.fill=this.fill;e.outline=this.outline;e.outlineColor=this.outlineColor;e.outlineWidth=this.outlineWidth;e.shadows=this.shadows;e.distanceDisplayCondition=this.distanceDisplayCondition;return e};s.prototype.merge=function(r){if(!t(r)){throw new i("source is required.")}this.show=e(this.show,r.show);this.material=e(this.material,r.material);this.positions=e(this.positions,r.positions);this.minimumHeights=e(this.minimumHeights,r.minimumHeights);this.maximumHeights=e(this.maximumHeights,r.maximumHeights);this.granularity=e(this.granularity,r.granularity);this.fill=e(this.fill,r.fill);this.outline=e(this.outline,r.outline);this.outlineColor=e(this.outlineColor,r.outlineColor);this.outlineWidth=e(this.outlineWidth,r.outlineWidth);this.shadows=e(this.shadows,r.shadows);this.distanceDisplayCondition=e(this.distanceDisplayCondition,r.distanceDisplayCondition)};return s});define("DataSources/Entity",["../Core/Cartesian3","../Core/Check","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/Transforms","./BillboardGraphics","./BoxGraphics","./ConstantPositionProperty","./CorridorGraphics","./createPropertyDescriptor","./createRawPropertyDescriptor","./CylinderGraphics","./EllipseGraphics","./EllipsoidGraphics","./LabelGraphics","./ModelGraphics","./PathGraphics","./PointGraphics","./PolygonGraphics","./PolylineGraphics","./PolylineVolumeGraphics","./Property","./PropertyBag","./RectangleGraphics","./WallGraphics"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I){"use strict";function M(e){return new p(e)}function R(e){return v(e,undefined,M)}function L(e,t){return v(e,undefined,function(e){if(e instanceof t){return e}return new t(e)})}function N(e){e=i(e,i.EMPTY_OBJECT);var t=e.id;if(!n(t)){t=r()}this._availability=undefined;this._id=t;this._definitionChanged=new s;this._name=e.name;this._show=i(e.show,true);this._parent=undefined;this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","orientation","path","point","polygon","polyline","polylineVolume","position","properties","rectangle","viewFrom","wall"];this._billboard=undefined;this._billboardSubscription=undefined;this._box=undefined;this._boxSubscription=undefined;this._corridor=undefined;this._corridorSubscription=undefined;this._cylinder=undefined;this._cylinderSubscription=undefined;this._description=undefined;this._descriptionSubscription=undefined;this._ellipse=undefined;this._ellipseSubscription=undefined;this._ellipsoid=undefined;this._ellipsoidSubscription=undefined;this._label=undefined;this._labelSubscription=undefined;this._model=undefined;this._modelSubscription=undefined;this._orientation=undefined;this._orientationSubscription=undefined;this._path=undefined;this._pathSubscription=undefined;this._point=undefined;this._pointSubscription=undefined;this._polygon=undefined;this._polygonSubscription=undefined;this._polyline=undefined;this._polylineSubscription=undefined;this._polylineVolume=undefined;this._polylineVolumeSubscription=undefined;this._position=undefined;this._positionSubscription=undefined;this._properties=undefined;this._propertiesSubscription=undefined;this._rectangle=undefined;this._rectangleSubscription=undefined;this._viewFrom=undefined;this._viewFromSubscription=undefined;this._wall=undefined;this._wallSubscription=undefined;this._children=[];this.entityCollection=undefined;this.parent=e.parent;this.merge(e)}function k(e,t,r){var i=t.length;for(var n=0;n<i;n++){var a=t[n];var o=a._show;var s=!r&&o;var l=r&&o;if(s!==l){k(a,a._children,r)}}e._definitionChanged.raiseEvent(e,"isShowing",r,!r)}a(N.prototype,{availability:g("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:g("name"),show:{get:function(){return this._show},set:function(e){if(!n(e)){throw new o("value is required.")}if(e===this._show){return}var t=this.isShowing;this._show=e;var r=this.isShowing;if(t!==r){k(this,this._children,r)}this._definitionChanged.raiseEvent(this,"show",e,!e)}},isShowing:{get:function(){return this._show&&(!n(this.entityCollection)||this.entityCollection.show)&&(!n(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(e){var t=this._parent;if(t===e){return}var r=this.isShowing;if(n(t)){var i=t._children.indexOf(this);t._children.splice(i,1)}this._parent=e;if(n(e)){e._children.push(this)}var a=this.isShowing;if(r!==a){k(this,this._children,a)}this._definitionChanged.raiseEvent(this,"parent",e,t)}},propertyNames:{get:function(){return this._propertyNames}},billboard:L("billboard",f),box:L("box",h),corridor:L("corridor",m),cylinder:L("cylinder",_),description:v("description"),ellipse:L("ellipse",y),ellipsoid:L("ellipsoid",b),label:L("label",w),model:L("model",C),orientation:v("orientation"),path:L("path",S),point:L("point",T),polygon:L("polygon",E),polyline:L("polyline",x),polylineVolume:L("polylineVolume",P),properties:L("properties",O),position:R("position"),rectangle:L("rectangle",D),viewFrom:v("viewFrom"),wall:L("wall",I)});N.prototype.isAvailable=function(e){if(!n(e)){throw new o("time is required.")}var t=this._availability;return!n(t)||t.contains(e)};N.prototype.addProperty=function(e){var t=this._propertyNames;if(!n(e)){throw new o("propertyName is required.")}if(t.indexOf(e)!==-1){throw new o(e+" is already a registered property.")}if(e in this){throw new o(e+" is a reserved property name.")}t.push(e);Object.defineProperty(this,e,g(e,true))};N.prototype.removeProperty=function(e){var t=this._propertyNames;var r=t.indexOf(e);if(!n(e)){throw new o("propertyName is required.")}if(r===-1){throw new o(e+" is not a registered property.")}this._propertyNames.splice(r,1);delete this[e]};N.prototype.merge=function(e){if(!n(e)){throw new o("source is required.")}this.name=i(this.name,e.name);this.availability=i(e.availability,this.availability);var t=this._propertyNames;var r=n(e._propertyNames)?e._propertyNames:Object.keys(e);var a=r.length;for(var s=0;s<a;s++){var l=r[s];if(l==="parent"){continue}var u=this[l];var c=e[l];if(!n(u)&&t.indexOf(l)===-1){this.addProperty(l)}if(n(c)){if(n(u)){if(n(u.merge)){u.merge(c)}}else if(n(c.merge)&&n(c.clone)){this[l]=c.clone()}else{this[l]=c}}}};var F=new l;var B=new e;var U=new c;N.prototype.computeModelMatrix=function(e,r){t.typeOf.object("time",e);var i=A.getValueOrUndefined(this._position,e,B);if(!n(i)){return undefined}var a=A.getValueOrUndefined(this._orientation,e,U);if(!n(a)){r=d.eastNorthUpToFixedFrame(i,undefined,r)}else{r=u.fromRotationTranslation(l.fromQuaternion(a,F),i,r)}return r};return N});define("DataSources/EntityCollection",["../Core/AssociativeArray","../Core/createGuid","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/Iso8601","../Core/JulianDate","../Core/RuntimeError","../Core/TimeInterval","./Entity"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";var d={id:undefined};function f(e){if(e._firing){e._refire=true;return}if(e._suspendCount===0){var t=e._addedEntities;var r=e._removedEntities;var i=e._changedEntities;if(i.length!==0||t.length!==0||r.length!==0){e._firing=true;do{e._refire=false;var n=t.values.slice(0);var a=r.values.slice(0);var o=i.values.slice(0);t.removeAll();r.removeAll();i.removeAll();e._collectionChanged.raiseEvent(e,n,a,o)}while(e._refire);e._firing=false}}}function h(r){this._owner=r;this._entities=new e;this._addedEntities=new e;this._removedEntities=new e;this._changedEntities=new e;this._suspendCount=0;this._collectionChanged=new a;this._id=t();this._show=true;this._firing=false;this._refire=false}h.prototype.suspendEvents=function(){this._suspendCount++};h.prototype.resumeEvents=function(){if(this._suspendCount===0){throw new n("resumeEvents can not be called before suspendEvents.")}this._suspendCount--;f(this)};h.collectionChangedEventCallback=undefined;i(h.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(e){if(!r(e)){throw new n("value is required.")}if(e===this._show){return}this.suspendEvents();var t;var i=[];var a=this._entities.values;var o=a.length;for(t=0;t<o;t++){i.push(a[t].isShowing)}this._show=e;for(t=0;t<o;t++){var s=i[t];var l=a[t];if(s!==l.isShowing){l.definitionChanged.raiseEvent(l,"isShowing",l.isShowing,s)}}this.resumeEvents()}},owner:{get:function(){return this._owner}}});h.prototype.computeAvailability=function(){var e=o.MAXIMUM_VALUE;var t=o.MINIMUM_VALUE;var i=this._entities.values;for(var n=0,a=i.length;n<a;n++){var l=i[n];var c=l.availability;if(r(c)){var d=c.start;var f=c.stop;if(s.lessThan(d,e)&&!d.equals(o.MINIMUM_VALUE)){e=d}if(s.greaterThan(f,t)&&!f.equals(o.MAXIMUM_VALUE)){t=f}}}if(o.MAXIMUM_VALUE.equals(e)){e=o.MINIMUM_VALUE}if(o.MINIMUM_VALUE.equals(t)){t=o.MAXIMUM_VALUE}return new u({start:e,stop:t})};h.prototype.add=function(e){if(!r(e)){throw new n("entity is required.")}if(!(e instanceof c)){e=new c(e)}var t=e.id;var i=this._entities;if(i.contains(t)){throw new l("An entity with id "+t+" already exists in this collection.")}e.entityCollection=this;i.set(t,e);if(!this._removedEntities.remove(t)){this._addedEntities.set(t,e)}e.definitionChanged.addEventListener(h.prototype._onEntityDefinitionChanged,this);f(this);return e};h.prototype.remove=function(e){if(!r(e)){return false}return this.removeById(e.id)};h.prototype.contains=function(e){if(!r(e)){throw new n("entity is required")}return this._entities.get(e.id)===e};h.prototype.removeById=function(e){if(!r(e)){return false}var t=this._entities;var i=t.get(e);if(!this._entities.remove(e)){return false}if(!this._addedEntities.remove(e)){this._removedEntities.set(e,i);this._changedEntities.remove(e)}this._entities.remove(e);i.definitionChanged.removeEventListener(h.prototype._onEntityDefinitionChanged,this);f(this);return true};h.prototype.removeAll=function(){var e=this._entities;var t=e.length;var i=e.values;var n=this._addedEntities;var a=this._removedEntities;for(var o=0;o<t;o++){var s=i[o];var l=s.id;var u=n.get(l);if(!r(u)){s.definitionChanged.removeEventListener(h.prototype._onEntityDefinitionChanged,this);a.set(l,s)}}e.removeAll();n.removeAll();this._changedEntities.removeAll();f(this)};h.prototype.getById=function(e){if(!r(e)){throw new n("id is required.")}return this._entities.get(e)};h.prototype.getOrCreateEntity=function(e){if(!r(e)){throw new n("id is required.")}var t=this._entities.get(e);if(!r(t)){d.id=e;t=new c(d);this.add(t)}return t};h.prototype._onEntityDefinitionChanged=function(e){var t=e.id;if(!this._addedEntities.contains(t)){this._changedEntities.set(t,e)}f(this)};return h});define("DataSources/CompositeEntityCollection",["../Core/createGuid","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Math","./Entity","./EntityCollection"],function(e,t,r,i,n,a,o){"use strict";var s={id:undefined};var l=new Array(2);function u(e){var t=e.propertyNames;var r=t.length;for(var i=0;i<r;i++){e[t[i]]=undefined}}function c(e,t,r,i){l[0]=r;l[1]=i.id;t[JSON.stringify(l)]=i.definitionChanged.addEventListener(h.prototype._onDefinitionChanged,e)}function d(e,t,r,i){l[0]=r;l[1]=i.id;var n=JSON.stringify(l);t[n]();t[n]=undefined}function f(e){e._shouldRecomposite=true;if(e._suspendCount!==0){return}var r=e._collections;var i=r.length;var n=e._collectionsCopy;var l=n.length;var f;var p;var m;var v;var g;var _=e._composite;var y=new o(e);var b=e._eventHash;var w;for(f=0;f<l;f++){g=n[f];g.collectionChanged.removeEventListener(h.prototype._onCollectionChanged,e);m=g.values;w=g.id;for(v=m.length-1;v>-1;v--){p=m[v];d(e,b,w,p)}}for(f=i-1;f>=0;f--){g=r[f];g.collectionChanged.addEventListener(h.prototype._onCollectionChanged,e);m=g.values;w=g.id;for(v=m.length-1;v>-1;v--){p=m[v];c(e,b,w,p);var C=y.getById(p.id);if(!t(C)){C=_.getById(p.id);if(!t(C)){s.id=p.id;C=new a(s)}else{u(C)}y.add(C)}C.merge(p)}}e._collectionsCopy=r.slice(0);_.suspendEvents();_.removeAll();var S=y.values;for(f=0;f<S.length;f++){_.add(S[f])}_.resumeEvents()}function h(r,i){this._owner=i;this._composite=new o(this);this._suspendCount=0;this._collections=t(r)?r.slice():[];this._collectionsCopy=[];this._id=e();this._eventHash={};f(this);this._shouldRecomposite=false}r(h.prototype,{collectionChanged:{get:function(){return this._composite._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._composite.values}},owner:{get:function(){return this._owner}}});h.prototype.addCollection=function(e,r){var n=t(r);if(!t(e)){throw new i("collection is required.")}if(n){if(r<0){throw new i("index must be greater than or equal to zero.")}else if(r>this._collections.length){throw new i("index must be less than or equal to the number of collections.")}}if(!n){r=this._collections.length;this._collections.push(e)}else{this._collections.splice(r,0,e)}f(this)};h.prototype.removeCollection=function(e){var t=this._collections.indexOf(e);if(t!==-1){this._collections.splice(t,1);f(this);return true}return false};h.prototype.removeAllCollections=function(){this._collections.length=0;f(this)};h.prototype.containsCollection=function(e){return this._collections.indexOf(e)!==-1};h.prototype.contains=function(e){return this._composite.contains(e)};h.prototype.indexOfCollection=function(e){return this._collections.indexOf(e)};h.prototype.getCollection=function(e){if(!t(e)){throw new i("index is required.","index")}return this._collections[e]};h.prototype.getCollectionsLength=function(){return this._collections.length};function p(e,r){if(!t(r)){throw new i("collection is required.")}var n=e.indexOf(r);if(n===-1){throw new i("collection is not in this composite.")}return n}function m(e,t,r){var i=e._collections;t=n.clamp(t,0,i.length-1);r=n.clamp(r,0,i.length-1);if(t===r){return}var a=i[t];i[t]=i[r];i[r]=a;f(e)}h.prototype.raiseCollection=function(e){var t=p(this._collections,e);m(this,t,t+1)};h.prototype.lowerCollection=function(e){var t=p(this._collections,e);m(this,t,t-1)};h.prototype.raiseCollectionToTop=function(e){var t=p(this._collections,e);if(t===this._collections.length-1){return}this._collections.splice(t,1);this._collections.push(e);f(this)};h.prototype.lowerCollectionToBottom=function(e){var t=p(this._collections,e);if(t===0){return}this._collections.splice(t,1);this._collections.splice(0,0,e);f(this)};h.prototype.suspendEvents=function(){this._suspendCount++;this._composite.suspendEvents()};h.prototype.resumeEvents=function(){if(this._suspendCount===0){throw new i("resumeEvents can not be called before suspendEvents.")}this._suspendCount--;if(this._shouldRecomposite&&this._suspendCount===0){f(this);this._shouldRecomposite=false}this._composite.resumeEvents()};h.prototype.computeAvailability=function(){return this._composite.computeAvailability()};h.prototype.getById=function(e){return this._composite.getById(e)};h.prototype._onCollectionChanged=function(e,r,i){var n=this._collectionsCopy;var o=n.length;var l=this._composite;l.suspendEvents();var f;var h;var p;var m;var v=i.length;var g=this._eventHash;var _=e.id;for(f=0;f<v;f++){var y=i[f];d(this,g,_,y);var b=y.id;for(h=o-1;h>=0;h--){p=n[h].getById(b);if(t(p)){if(!t(m)){m=l.getById(b);u(m)}m.merge(p)}}if(!t(m)){l.removeById(b)}m=undefined}var w=r.length;for(f=0;f<w;f++){var C=r[f];c(this,g,_,C);var S=C.id;for(h=o-1;h>=0;h--){p=n[h].getById(S);if(t(p)){if(!t(m)){m=l.getById(S);if(!t(m)){s.id=S;m=new a(s);l.add(m)}else{u(m)}}m.merge(p)}}m=undefined}l.resumeEvents()};h.prototype._onDefinitionChanged=function(e,r,i,n){var a=this._collections;var o=this._composite;var s=a.length;var l=e.id;var u=o.getById(l);var c=u[r];var d=!t(c);var f=true;for(var h=s-1;h>=0;h--){var p=a[h].getById(e.id);if(t(p)){var m=p[r];if(t(m)){if(f){f=false;if(t(m.merge)&&t(m.clone)){c=m.clone(c)}else{c=m;break}}c.merge(m)}}}if(d&&u.propertyNames.indexOf(r)===-1){u.addProperty(r)}u[r]=c};return h});define("DataSources/CompositeProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","../Core/TimeIntervalCollection","./Property"],function(e,t,r,i,n,a,o){"use strict";function s(t,r,i,n){function a(){i.raiseEvent(t)}var o=[];r.removeAll();var s=n.length;for(var l=0;l<s;l++){var u=n.get(l);if(e(u.data)&&o.indexOf(u.data)===-1){r.add(u.data.definitionChanged,a)}}}function l(){this._eventHelper=new n;this._definitionChanged=new i;this._intervals=new a;this._intervals.changedEvent.addEventListener(l.prototype._intervalsChanged,this)}t(l.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});l.prototype.getValue=function(t,i){if(!e(t)){throw new r("time is required")}var n=this._intervals.findDataForIntervalContainingDate(t);if(e(n)){return n.getValue(t,i)}return undefined};l.prototype.equals=function(e){return this===e||e instanceof l&&this._intervals.equals(e._intervals,o.equals)};l.prototype._intervalsChanged=function(){s(this,this._eventHelper,this._definitionChanged,this._intervals);this._definitionChanged.raiseEvent(this)};return l});define("DataSources/CompositeMaterialProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./CompositeProperty","./Property"],function(e,t,r,i,n,a){"use strict";function o(){this._definitionChanged=new i;this._composite=new n;this._composite.definitionChanged.addEventListener(o.prototype._raiseDefinitionChanged,this)}t(o.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}});o.prototype.getType=function(t){if(!e(t)){throw new r("time is required")}var i=this._composite._intervals.findDataForIntervalContainingDate(t);if(e(i)){return i.getType(t)}return undefined};o.prototype.getValue=function(t,i){if(!e(t)){throw new r("time is required")}var n=this._composite._intervals.findDataForIntervalContainingDate(t);if(e(n)){return n.getValue(t,i)}return undefined};o.prototype.equals=function(e){return this===e||e instanceof o&&this._composite.equals(e._composite,a.equals)};o.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return o});define("DataSources/CompositePositionProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./CompositeProperty","./Property"],function(e,t,r,i,n,a,o,s){"use strict";function l(t){this._referenceFrame=e(t,a.FIXED);this._definitionChanged=new n;this._composite=new o;this._composite.definitionChanged.addEventListener(l.prototype._raiseDefinitionChanged,this)}r(l.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}});l.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,a.FIXED,t)};l.prototype.getValueInReferenceFrame=function(e,r,n){if(!t(e)){throw new i("time is required.")}if(!t(r)){throw new i("referenceFrame is required.")}var a=this._composite._intervals.findDataForIntervalContainingDate(e);if(t(a)){return a.getValueInReferenceFrame(e,r,n)}return undefined};l.prototype.equals=function(e){return this===e||e instanceof l&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,s.equals)};l.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return l});define("Shaders/ShadowVolumeFS",[],function(){"use strict";return"#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n\n// emulated noperspective\nvarying float v_WindowZ;\nvarying vec4 v_color;\n\nvoid writeDepthClampedToFarPlane()\n{\n#ifdef GL_EXT_frag_depth\n    gl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\n\nvoid main(void)\n{\n    gl_FragColor = v_color;\n    writeDepthClampedToFarPlane();\n}\n"});define("Shaders/ShadowVolumeVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 color;\nattribute float batchId;\n\n#ifdef EXTRUDED_GEOMETRY\nattribute vec3 extrudeDirection;\n\nuniform float u_globeMinimumAltitude;\n#endif\n\n// emulated noperspective\nvarying float v_WindowZ;\nvarying vec4 v_color;\n\nvec4 depthClampFarPlane(vec4 vertexInClipCoordinates)\n{\n    v_WindowZ = (0.5 * (vertexInClipCoordinates.z / vertexInClipCoordinates.w) + 0.5) * vertexInClipCoordinates.w;\n    vertexInClipCoordinates.z = min(vertexInClipCoordinates.z, vertexInClipCoordinates.w);\n    return vertexInClipCoordinates;\n}\n\nvoid main()\n{\n    v_color = color;\n\n    vec4 position = czm_computePosition();\n\n#ifdef EXTRUDED_GEOMETRY\n    float delta = min(u_globeMinimumAltitude, czm_geometricToleranceOverMeter * length(position.xyz));\n    delta *= czm_sceneMode == czm_sceneMode3D ? 1.0 : 0.0;\n\n    //extrudeDirection is zero for the top layer\n    position = position + vec4(extrudeDirection * delta, 0.0);\n#endif\n\n    gl_Position = depthClampFarPlane(czm_modelViewProjectionRelativeToEye * position);\n}\n"});define("Scene/StencilFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS};return e(r)});define("Scene/StencilOperation",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={ZERO:t.ZERO,KEEP:t.KEEP,REPLACE:t.REPLACE,INCREMENT:t.INCR,DECREMENT:t.DECR,INVERT:t.INVERT,INCREMENT_WRAP:t.INCR_WRAP,DECREMENT_WRAP:t.DECR_WRAP};return e(r)});define("Scene/ClassificationPrimitive",["../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryInstance","../Core/isArray","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Shaders/ShadowVolumeFS","../Shaders/ShadowVolumeVS","../ThirdParty/when","./BlendingState","./DepthFunction","./PerInstanceColorAppearance","./Primitive","./SceneMode","./StencilFunction","./StencilOperation"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C){"use strict";var S=["color"];function T(e){e=t(e,t.EMPTY_OBJECT);this.geometryInstances=e.geometryInstances;this.show=t(e.show,true);this.debugShowBoundingVolume=t(e.debugShowBoundingVolume,false);this.debugShowShadowVolume=t(e.debugShowShadowVolume,false);this._debugShowShadowVolume=false;this._extruded=t(e._extruded,false);this._uniformMap=e._uniformMap;this._sp=undefined;this._spPick=undefined;this._rsStencilPreloadPass=undefined;this._rsStencilDepthPass=undefined;this._rsColorPass=undefined;this._rsPickPass=undefined;this._ready=false;this._readyPromise=m.defer();this._primitive=undefined;this._pickPrimitive=e._pickPrimitive;var i=new _({flat:true});var n;if(r(this.geometryInstances)&&s(this.geometryInstances)&&this.geometryInstances.length>1){n=S}this._createBoundingVolumeFunction=e._createBoundingVolumeFunction;this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction;this._primitiveOptions={geometryInstances:undefined,appearance:i,vertexCacheOptimize:t(e.vertexCacheOptimize,false),interleave:t(e.interleave,false),releaseGeometryInstances:t(e.releaseGeometryInstances,true),allowPicking:t(e.allowPicking,true),asynchronous:t(e.asynchronous,true),compressVertices:t(e.compressVertices,true),_readOnlyInstanceAttributes:n,_createBoundingVolumeFunction:undefined,_createRenderStatesFunction:undefined,_createShaderProgramFunction:undefined,_createCommandsFunction:undefined,_updateAndQueueCommandsFunction:undefined,_createPickOffsets:true}}i(T.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});T.isSupported=function(e){return e.context.stencilBuffer};function E(e){return{colorMask:{red:false,green:false,blue:false,alpha:false},stencilTest:{enabled:e,frontFunction:w.ALWAYS,frontOperation:{fail:C.KEEP,zFail:C.DECREMENT_WRAP,zPass:C.DECREMENT_WRAP},backFunction:w.ALWAYS,backOperation:{fail:C.KEEP,zFail:C.INCREMENT_WRAP,zPass:C.INCREMENT_WRAP},reference:0,mask:~0},depthTest:{enabled:false},depthMask:false}}function x(e){return{colorMask:{red:false,green:false,blue:false,alpha:false},stencilTest:{enabled:e,frontFunction:w.ALWAYS,frontOperation:{fail:C.KEEP,zFail:C.KEEP,zPass:C.INCREMENT_WRAP},backFunction:w.ALWAYS,backOperation:{fail:C.KEEP,zFail:C.KEEP,zPass:C.DECREMENT_WRAP},reference:0,mask:~0},depthTest:{enabled:true,func:g.LESS_OR_EQUAL},depthMask:false}}function P(e){return{stencilTest:{enabled:e,frontFunction:w.NOT_EQUAL,frontOperation:{fail:C.KEEP,zFail:C.KEEP,zPass:C.DECREMENT_WRAP},backFunction:w.NOT_EQUAL,backOperation:{fail:C.KEEP,zFail:C.KEEP,zPass:C.DECREMENT_WRAP},reference:0,mask:~0},depthTest:{enabled:false},depthMask:false,blending:v.ALPHA_BLEND}}var A={stencilTest:{enabled:true,frontFunction:w.NOT_EQUAL,frontOperation:{fail:C.KEEP,zFail:C.KEEP,zPass:C.DECREMENT_WRAP},backFunction:w.NOT_EQUAL,backOperation:{fail:C.KEEP,zFail:C.KEEP,zPass:C.DECREMENT_WRAP},reference:0,mask:~0},depthTest:{enabled:false},depthMask:false};function O(e,t,i,n){if(r(e._rsStencilPreloadPass)){return}var a=!e.debugShowShadowVolume;e._rsStencilPreloadPass=c.fromCache(E(a));e._rsStencilDepthPass=c.fromCache(x(a));e._rsColorPass=c.fromCache(P(a));e._rsPickPass=c.fromCache(A)}function D(e,t){if(!e.compressVertices){return t}if(t.search(/attribute\s+vec3\s+extrudeDirection;/g)!==-1){var r="compressedAttributes";var i="attribute vec2 "+r+";";var n="vec3 extrudeDirection;\n";var a="    extrudeDirection = czm_octDecode("+r+", 65535.0);\n";var o=t;o=o.replace(/attribute\s+vec3\s+extrudeDirection;/g,"");o=f.replaceMain(o,"czm_non_compressed_main");var s="void main() \n"+"{ \n"+a+"    czm_non_compressed_main(); \n"+"}";return[i,n,o,s].join("\n")}}function I(e,t,i){if(r(e._sp)){return}var n=t.context;var a=e._primitive;var o=p;o=e._primitive._batchTable.getVertexShaderCallback()(o);o=y._appendShowToShader(a,o);o=y._appendDistanceDisplayConditionToShader(a,o);o=y._modifyShaderPosition(e,o,t.scene3DOnly);o=y._updateColorAttribute(a,o);if(e._extruded){o=D(a,o)}var s=e._extruded?"EXTRUDED_GEOMETRY":"";var l=new f({defines:[s],sources:[o]});var u=new f({sources:[h]});var c=e._primitive._attributeLocations;e._sp=d.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:l,fragmentShaderSource:u,attributeLocations:c});if(e._primitive.allowPicking){var m=f.createPickVertexShaderSource(o);m=y._updatePickColorAttribute(m);var v=new f({defines:[s],sources:[m]});var g=new f({sources:[h],pickColorQualifier:"varying"});e._spPick=d.replaceCache({context:n,shaderProgram:e._spPick,vertexShaderSource:v,fragmentShaderSource:g,attributeLocations:c})}else{e._spPick=d.fromCache({context:n,vertexShaderSource:l,fragmentShaderSource:u,attributeLocations:c})}}function M(e,t){var i=e._primitive;var n=i._va.length*3;t.length=n;var a=0;var o=i._batchTable.getUniformMapCallback()(e._uniformMap);for(var s=0;s<n;s+=3){var c=i._va[a++];var d=t[s];if(!r(d)){d=t[s]=new l({owner:e,primitiveType:i._primitiveType})}d.vertexArray=c;d.renderState=e._rsStencilPreloadPass;d.shaderProgram=e._sp;d.uniformMap=o;d.pass=u.GROUND;d=t[s+1];if(!r(d)){d=t[s+1]=new l({owner:e,primitiveType:i._primitiveType})}d.vertexArray=c;d.renderState=e._rsStencilDepthPass;d.shaderProgram=e._sp;d.uniformMap=o;d.pass=u.GROUND;d=t[s+2];if(!r(d)){d=t[s+2]=new l({owner:e,primitiveType:i._primitiveType})}d.vertexArray=c;d.renderState=e._rsColorPass;d.shaderProgram=e._sp;d.uniformMap=o;d.pass=u.GROUND}}function R(e,t){var i=e._primitive;var n=i._pickOffsets;var a=n.length*3;t.length=a;var o=0;var s=i._batchTable.getUniformMapCallback()(e._uniformMap);for(var c=0;c<a;c+=3){var d=n[o++];var f=d.offset;var h=d.count;var p=i._va[d.index];var m=t[c];if(!r(m)){m=t[c]=new l({owner:e,primitiveType:i._primitiveType})}m.vertexArray=p;m.offset=f;m.count=h;m.renderState=e._rsStencilPreloadPass;m.shaderProgram=e._sp;m.uniformMap=s;m.pass=u.GROUND;m=t[c+1];if(!r(m)){m=t[c+1]=new l({owner:e,primitiveType:i._primitiveType})}m.vertexArray=p;m.offset=f;m.count=h;m.renderState=e._rsStencilDepthPass;m.shaderProgram=e._sp;m.uniformMap=s;m.pass=u.GROUND;m=t[c+2];if(!r(m)){m=t[c+2]=new l({owner:e,primitiveType:i._primitiveType})}m.vertexArray=p;m.offset=f;m.count=h;m.renderState=e._rsPickPass;m.shaderProgram=e._spPick;m.uniformMap=s;m.pass=u.GROUND}}function L(e,t,r,i,n,a,o){M(e,a);R(e,o)}function N(e,t,i,n,a,o,s,l){var u=e._primitive;y._updateBoundingVolumes(u,t,a);var c;if(t.mode===b.SCENE3D){c=u._boundingSphereWC}else if(t.mode===b.COLUMBUS_VIEW){c=u._boundingSphereCV}else if(t.mode===b.SCENE2D&&r(u._boundingSphere2D)){c=u._boundingSphere2D}else if(r(u._boundingSphereMorph)){c=u._boundingSphereMorph}var d=t.commandList;var f=t.passes;if(f.render){var h=i.length;for(var p=0;p<h;++p){var m=i[p];m.modelMatrix=a;m.boundingVolume=c[Math.floor(p/3)];m.cull=o;m.debugShowBoundingVolume=s;d.push(m)}}if(f.pick){var v=u._pickOffsets;var g=v.length*3;n.length=g;for(var _=0;_<g;++_){var w=v[Math.floor(_/3)];var C=n[_];C.modelMatrix=a;C.boundingVolume=c[w.index];C.cull=o;d.push(C)}}}T.prototype.update=function(i){if(!this.show||!r(this._primitive)&&!r(this.geometryInstances)){return}var n=this;var l=this._primitiveOptions;if(!r(this._primitive)){var u=s(this.geometryInstances)?this.geometryInstances:[this.geometryInstances];var d=u.length;var f;var h;var p;for(f=0;f<d;++f){h=u[f];var m=h.attributes;if(!r(m)||!r(m.color)){throw new a("Not all of the geometry instances have the same color attribute.")}else if(r(p)&&!e.equals(p,m.color)){throw new a("Not all of the geometry instances have the same color attribute.")}else if(!r(p)){p=m.color}}var v=new Array(d);for(f=0;f<d;++f){h=u[f];v[f]=new o({geometry:h.geometry,attributes:h.attributes,modelMatrix:h.modelMatrix,id:h.id,pickPrimitive:t(this._pickPrimitive,n)})}l.geometryInstances=v;if(r(this._createBoundingVolumeFunction)){l._createBoundingVolumeFunction=function(e,t){n._createBoundingVolumeFunction(e,t)}}l._createRenderStatesFunction=function(e,t,r,i){O(n,t)};l._createShaderProgramFunction=function(e,t,r){I(n,t)};l._createCommandsFunction=function(e,t,r,i,a,o,s){L(n,undefined,undefined,true,false,o,s)};if(r(this._updateAndQueueCommandsFunction)){l._updateAndQueueCommandsFunction=function(e,t,r,i,a,o,s,l){n._updateAndQueueCommandsFunction(e,t,r,i,a,o,s,l)}}else{l._updateAndQueueCommandsFunction=function(e,t,r,i,a,o,s,l){N(n,t,r,i,a,o,s,l)}}this._primitive=new y(l);this._primitive.readyPromise.then(function(e){n._ready=true;if(n.releaseGeometryInstances){n.geometryInstances=undefined}var t=e._error;if(!r(t)){n._readyPromise.resolve(n)}else{n._readyPromise.reject(t)}})}if(this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready){this._debugShowShadowVolume=true;this._rsStencilPreloadPass=c.fromCache(E(false));this._rsStencilDepthPass=c.fromCache(x(false));this._rsColorPass=c.fromCache(P(false))}else if(!this.debugShowShadowVolume&&this._debugShowShadowVolume){this._debugShowShadowVolume=false;this._rsStencilPreloadPass=c.fromCache(E(true));this._rsStencilDepthPass=c.fromCache(x(true));this._rsColorPass=c.fromCache(P(true))}this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume;this._primitive.update(i)};T.prototype.getGeometryInstanceAttributes=function(e){if(!r(this._primitive)){throw new a("must call update before calling getGeometryInstanceAttributes")}return this._primitive.getGeometryInstanceAttributes(e)};T.prototype.isDestroyed=function(){return false};T.prototype.destroy=function(){this._primitive=this._primitive&&this._primitive.destroy();this._sp=this._sp&&this._sp.destroy();this._spPick=this._spPick&&this._spPick.destroy();return n(this)};return T});define("Scene/GroundPrimitive",["../Core/BoundingSphere","../Core/buildModuleUrl","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/GeographicTilingScheme","../Core/GeometryInstance","../Core/isArray","../Core/loadJson","../Core/Math","../Core/OrientedBoundingBox","../Core/Rectangle","../ThirdParty/when","./ClassificationPrimitive","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y){"use strict";var b={u_globeMinimumAltitude:function(){return 55e3}};function w(e){e=a(e,a.EMPTY_OBJECT);this.geometryInstances=e.geometryInstances;this.show=a(e.show,true);this.debugShowBoundingVolume=a(e.debugShowBoundingVolume,false);this.debugShowShadowVolume=a(e.debugShowShadowVolume,false);this._boundingVolumes=[];this._boundingVolumes2D=[];this._ready=false;this._readyPromise=g.defer();this._primitive=undefined;this._maxHeight=undefined;this._minHeight=undefined;this._maxTerrainHeight=w._defaultMaxTerrainHeight;this._minTerrainHeight=w._defaultMinTerrainHeight;this._boundingSpheresKeys=[];this._boundingSpheres=[];var t=this;this._primitiveOptions={geometryInstances:undefined,vertexCacheOptimize:a(e.vertexCacheOptimize,false),interleave:a(e.interleave,false),releaseGeometryInstances:a(e.releaseGeometryInstances,true),allowPicking:a(e.allowPicking,true),asynchronous:a(e.asynchronous,true),compressVertices:a(e.compressVertices,true),_createBoundingVolumeFunction:undefined,_updateAndQueueCommandsFunction:undefined,_pickPrimitive:t,_extruded:true,_uniformMap:b}}s(w.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});w.isSupported=_.isSupported;w._defaultMaxTerrainHeight=9e3;w._defaultMinTerrainHeight=-1e5;w._terrainHeights=undefined;w._terrainHeightsMaxLevel=6;function C(e){return function(t,r){var i=r.maximumRadius;var n=i/Math.cos(t*.5)-i;return e._maxHeight+n}}function S(e){return function(t,r){return e._minHeight}}var T=new i;var E=new i;var x=new i;var P=new n;var A=new v;var O=new c;var D=[new n,new n,new n,new n];var I=new r;function M(e,t){var r=e.mapProjection.ellipsoid;if(!o(t.attributes)||!o(t.attributes.position3DHigh)){if(o(t.rectangle)){return t.rectangle}return undefined}var n=t.attributes.position3DHigh.values;var a=t.attributes.position3DLow.values;var s=n.length;var l=Number.POSITIVE_INFINITY;var u=Number.POSITIVE_INFINITY;var c=Number.NEGATIVE_INFINITY;var d=Number.NEGATIVE_INFINITY;for(var f=0;f<s;f+=3){var h=i.unpack(n,f,T);var p=i.unpack(a,f,E);var m=i.add(h,p,x);var v=r.cartesianToCartographic(m,P);var g=v.latitude;var _=v.longitude;l=Math.min(l,g);u=Math.min(u,_);c=Math.max(c,g);d=Math.max(d,_)}var y=A;y.north=c;y.south=l;y.east=d;y.west=u;return y}var R=new i;var L=new i;var N=new n;var k=new i;var F=new i;function B(e){n.fromRadians(e.east,e.north,0,D[0]);n.fromRadians(e.west,e.north,0,D[1]);n.fromRadians(e.east,e.south,0,D[2]);n.fromRadians(e.west,e.south,0,D[3]);var t=0,r=0;var i=0,a=0;var o=w._terrainHeightsMaxLevel;var s;for(s=0;s<=o;++s){var l=false;for(var u=0;u<4;++u){var c=D[u];O.positionToTileXY(c,s,I);if(u===0){i=I.x;a=I.y}else if(i!==I.x||a!==I.y){l=true;break}}if(l){break}t=i;r=a}if(s===0){return undefined}return{x:t,y:r,level:s>o?o:s-1}}function U(e,t,r){var n=B(t);var a=w._defaultMinTerrainHeight;var s=w._defaultMaxTerrainHeight;if(o(n)){var l=n.level+"-"+n.x+"-"+n.y;var u=w._terrainHeights[l];if(o(u)){a=u[0];s=u[1]}r.cartographicToCartesian(v.northeast(t,N),R);r.cartographicToCartesian(v.southwest(t,N),L);i.subtract(L,R,k);i.add(R,i.multiplyByScalar(k,.5,k),k);var c=r.scaleToGeodeticSurface(k,F);if(o(c)){var d=i.distance(k,c);a=Math.min(a,-d)}else{a=w._defaultMinTerrainHeight}}e._minTerrainHeight=Math.max(w._defaultMinTerrainHeight,a);e._maxTerrainHeight=s}var V=new e;function z(t,r){var i=B(t);var n=w._defaultMaxTerrainHeight;if(o(i)){var a=i.level+"-"+i.x+"-"+i.y;var s=w._terrainHeights[a];if(o(s)){n=s[1]}}var l=e.fromRectangle3D(t,r,0);e.fromRectangle3D(t,r,n,V);return e.union(l,V,l)}function q(t,r,n){var a=r.mapProjection.ellipsoid;var o=M(r,n);if(o.width<p.PI){var s=m.fromRectangle(o,t._maxHeight,t._minHeight,a);t._boundingVolumes.push(s)}else{var l=n.attributes.position3DHigh.values;var u=n.attributes.position3DLow.values;t._boundingVolumes.push(e.fromEncodedCartesianVertices(l,u))}if(!r.scene3DOnly){var c=r.mapProjection;var d=e.fromRectangleWithHeights2D(o,c,t._maxHeight,t._minHeight);i.fromElements(d.center.z,d.center.x,d.center.y,d.center);t._boundingVolumes2D.push(d)}}function G(e,t,r,i,n,a,s,l){var u;if(t.mode===y.SCENE3D){u=e._boundingVolumes}else if(t.mode!==y.SCENE3D&&o(e._boundingVolumes2D)){u=e._boundingVolumes2D}var c=t.commandList;var d=t.passes;if(d.render){var f=r.length;for(var h=0;h<f;++h){var p=r[h];p.owner=e;p.modelMatrix=n;p.boundingVolume=u[Math.floor(h/3)];p.cull=a;p.debugShowBoundingVolume=s;c.push(p)}}if(d.pick){var m=e._primitive._primitive;var v=m._pickOffsets;var g=v.length*3;i.length=g;for(var _=0;_<g;++_){var b=v[Math.floor(_/3)];var w=u[b.index];var C=i[_];C.owner=e;C.modelMatrix=n;C.boundingVolume=w;C.cull=a;c.push(C)}}}w._initialized=false;w._initPromise=undefined;w.initializeTerrainHeights=function(){var e=w._initPromise;if(o(e)){return e}w._initPromise=h(t("Assets/approximateTerrainHeights.json")).then(function(e){w._initialized=true;w._terrainHeights=e});return w._initPromise};w.prototype.update=function(e){if(!this.show||!o(this._primitive)&&!o(this.geometryInstances)){return}if(!w._initialized){if(!this.asynchronous){throw new u("For synchronous GroundPrimitives, you must call GroundPrimitive.initializeTerrainHeights() and wait for the returned promise to resolve.")}w.initializeTerrainHeights();return}var t=this;var r=this._primitiveOptions;if(!o(this._primitive)){var i=e.mapProjection.ellipsoid;var n;var a;var s;var l=f(this.geometryInstances)?this.geometryInstances:[this.geometryInstances];var c=l.length;var h=new Array(c);var p;var m;for(p=0;p<c;++p){n=l[p];a=n.geometry;var g=M(e,a);if(!o(m)){m=g}else if(o(g)){v.union(m,g,m)}var y=n.id;if(o(y)&&o(g)){var b=z(g,i);this._boundingSpheresKeys.push(y);this._boundingSpheres.push(b)}s=a.constructor;if(!o(s)||!o(s.createShadowVolume)){throw new u("Not all of the geometry instances have GroundPrimitive support.")}}U(this,m,e.mapProjection.ellipsoid);var T=e.terrainExaggeration;this._minHeight=this._minTerrainHeight*T;this._maxHeight=this._maxTerrainHeight*T;for(p=0;p<c;++p){n=l[p];a=n.geometry;s=a.constructor;h[p]=new d({geometry:s.createShadowVolume(a,S(this),C(this)),attributes:n.attributes,id:n.id})}r.geometryInstances=h;r._createBoundingVolumeFunction=function(e,r){q(t,e,r)};r._updateAndQueueCommandsFunction=function(e,r,i,n,a,o,s,l){G(t,r,i,n,a,o,s,l)};this._primitive=new _(r);this._primitive.readyPromise.then(function(e){t._ready=true;if(t.releaseGeometryInstances){t.geometryInstances=undefined}var r=e._error;if(!o(r)){t._readyPromise.resolve(t)}else{t._readyPromise.reject(r)}})}this._primitive.debugShowShadowVolume=this.debugShowShadowVolume;this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume;this._primitive.update(e)};w.prototype.getBoundingSphere=function(e){var t=this._boundingSpheresKeys.indexOf(e);if(t!==-1){return this._boundingSpheres[t]}return undefined};w.prototype.getGeometryInstanceAttributes=function(e){if(!o(this._primitive)){throw new u("must call update before calling getGeometryInstanceAttributes")}return this._primitive.getGeometryInstanceAttributes(e)};w.prototype.isDestroyed=function(){return false};w.prototype.destroy=function(){this._primitive=this._primitive&&this._primitive.destroy();return l(this)};return w});define("DataSources/CorridorGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/CorridorGeometry","../Core/CorridorOutlineGeometry","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E){"use strict";var x=new w(e.WHITE);var P=new C(true);var A=new C(true);var O=new C(false);var D=new C(e.BLACK);var I=new C(b.DISABLED);var M=new C(new u);var R=new e;function L(e){this.id=e;this.vertexFormat=undefined;this.positions=undefined;this.width=undefined;this.cornerType=undefined;this.height=undefined;this.extrudedHeight=undefined;this.granularity=undefined}function N(e,t){if(!a(e)){throw new l("entity is required")}if(!a(t)){throw new l("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(N.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._isClosed=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new d;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._onTerrain=false;this._options=new L(e);this._onEntityPropertyChanged(e,"corridor",e.corridor,undefined)}o(N,{perInstanceColorAppearanceType:{value:_},materialAppearanceType:{value:g}});o(N.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!a(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!a(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayCondition}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});N.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};N.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};N.prototype.createFillGeometryInstance=function(i){if(!a(i)){throw new l("time is required.")}if(!this._fillEnabled){throw new l("This instance does not represent a filled geometry.")}var n=this._entity;var o=n.isAvailable(i);var s;var u;var d=new m(o&&n.isShowing&&this._showProperty.getValue(i)&&this._fillProperty.getValue(i));var h=c.fromDistanceDisplayCondition(this._distanceDisplayCondition.getValue(i));if(this._materialProperty instanceof w){var p=e.WHITE;if(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)){p=this._materialProperty.color.getValue(i)}u=t.fromColor(p);s={show:d,distanceDisplayCondition:h,color:u}}else{s={show:d,distanceDisplayCondition:h}}return new f({id:n,geometry:new r(this._options),attributes:s})};N.prototype.createOutlineGeometryInstance=function(r){if(!a(r)){throw new l("time is required.")}if(!this._outlineEnabled){throw new l("This instance does not represent an outlined geometry.")}var n=this._entity;var o=n.isAvailable(r);var s=E.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);return new f({id:n,geometry:new i(this._options),attributes:{show:new m(o&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:c.fromDistanceDisplayCondition(this._distanceDisplayCondition.getValue(r))}})};N.prototype.isDestroyed=function(){return false};N.prototype.destroy=function(){this._entitySubscription();s(this)};N.prototype._onEntityPropertyChanged=function(e,t,r,i){if(!(t==="availability"||t==="corridor")){return}var o=this._entity.corridor;if(!a(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var l=a(s)&&s.isConstant?s.getValue(h.MINIMUM_VALUE):true;var u=o.outline;var c=a(u);if(c&&u.isConstant){c=u.getValue(h.MINIMUM_VALUE)}if(!l&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=o.positions;var f=o.show;if(a(f)&&f.isConstant&&!f.getValue(h.MINIMUM_VALUE)||!a(d)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var m=n(o.material,x);var y=m instanceof w;this._materialProperty=m;this._fillProperty=n(s,A);this._showProperty=n(f,P);this._showOutlineProperty=n(o.outline,O);this._outlineColorProperty=c?n(o.outlineColor,D):undefined;this._shadowsProperty=n(o.shadows,I);this._distanceDisplayCondition=n(o.distanceDisplayCondition,M);var b=o.height;var C=o.extrudedHeight;var S=o.granularity;var T=o.width;var R=o.outlineWidth;var L=o.cornerType;var N=l&&!a(b)&&!a(C)&&y&&v.isSupported(this._scene);if(c&&N){p(p.geometryOutlines);c=false}this._fillEnabled=l;this._onTerrain=N;this._isClosed=a(C)||N;this._outlineEnabled=c;if(!d.isConstant||!E.isConstant(b)||!E.isConstant(C)||!E.isConstant(S)||!E.isConstant(T)||!E.isConstant(R)||!E.isConstant(L)||N&&!E.isConstant(m)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var k=this._options;k.vertexFormat=y?_.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat;k.positions=d.getValue(h.MINIMUM_VALUE,k.positions);k.height=a(b)?b.getValue(h.MINIMUM_VALUE):undefined;k.extrudedHeight=a(C)?C.getValue(h.MINIMUM_VALUE):undefined;k.granularity=a(S)?S.getValue(h.MINIMUM_VALUE):undefined;k.width=a(T)?T.getValue(h.MINIMUM_VALUE):undefined;k.cornerType=a(L)?L.getValue(h.MINIMUM_VALUE):undefined;this._outlineWidth=a(R)?R.getValue(h.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};N.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic){throw new l("This instance does not represent dynamic geometry.")}if(!a(e)){throw new l("primitives is required.")}return new k(e,t,this)};function k(e,t,r){this._primitives=e;this._groundPrimitives=t;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=r;this._options=new L(r._entity)}k.prototype.update=function(n){if(!a(n)){throw new l("time is required.")}var o=this._geometryUpdater;var s=o._onTerrain;var u=this._primitives;var d=this._groundPrimitives;if(s){d.removeAndDestroy(this._primitive)}else{u.removeAndDestroy(this._primitive);u.removeAndDestroy(this._outlinePrimitive);this._outlinePrimitive=undefined}this._primitive=undefined;var h=o._entity;var p=h.corridor;if(!h.isShowing||!h.isAvailable(n)||!E.getValueOrDefault(p.show,n,true)){return}var m=this._options;var b=E.getValueOrUndefined(p.positions,n,m.positions);var w=E.getValueOrUndefined(p.width,n);if(!a(b)||!a(w)){return}m.positions=b;m.width=w;m.height=E.getValueOrUndefined(p.height,n);m.extrudedHeight=E.getValueOrUndefined(p.extrudedHeight,n);m.granularity=E.getValueOrUndefined(p.granularity,n);m.cornerType=E.getValueOrUndefined(p.cornerType,n);var C=this._geometryUpdater.shadowsProperty.getValue(n);var S=this._geometryUpdater.distanceDisplayConditionProperty.getValue(n);var x=c.fromDistanceDisplayCondition(S);if(!a(p.fill)||p.fill.getValue(n)){var P=o.fillMaterialProperty;var A=T.getValue(n,P,this._material);this._material=A;if(s){var O=e.WHITE;if(a(P.color)){O=P.color.getValue(n)}this._primitive=d.add(new v({geometryInstances:new f({id:h,geometry:new r(m),attributes:{color:t.fromColor(O),distanceDisplayCondition:x}}),asynchronous:false,shadows:C}))}else{var D=new g({material:A,translucent:A.isTranslucent(),closed:a(m.extrudedHeight)});m.vertexFormat=D.vertexFormat;this._primitive=u.add(new y({geometryInstances:new f({id:h,geometry:new r(m),attributes:{distanceDisplayCondition:x}}),appearance:D,asynchronous:false,shadows:C}))}}if(!s&&a(p.outline)&&p.outline.getValue(n)){m.vertexFormat=_.VERTEX_FORMAT;var I=E.getValueOrClonedDefault(p.outlineColor,n,e.BLACK,R);var M=E.getValueOrDefault(p.outlineWidth,n,1);var L=I.alpha!==1;this._outlinePrimitive=u.add(new y({geometryInstances:new f({id:h,geometry:new i(m),attributes:{color:t.fromColor(I),distanceDisplayCondition:x}}),appearance:new _({flat:true,translucent:L,renderState:{lineWidth:o._scene.clampLineWidth(M)}}),asynchronous:false,shadows:C}))}};k.prototype.getBoundingSphere=function(e,t){return S(e,this._primitive,this._outlinePrimitive,t)};k.prototype.isDestroyed=function(){return false};k.prototype.destroy=function(){var e=this._primitives;var t=this._groundPrimitives;if(this._geometryUpdater._onTerrain){t.removeAndDestroy(this._primitive)}else{e.removeAndDestroy(this._primitive)}e.removeAndDestroy(this._outlinePrimitive);s(this)};return N});define("DataSources/DataSource",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}e(r.prototype,{name:{get:t.throwInstantiationError},clock:{get:t.throwInstantiationError},entities:{get:t.throwInstantiationError},isLoading:{get:t.throwInstantiationError},changedEvent:{get:t.throwInstantiationError},errorEvent:{get:t.throwInstantiationError},loadingEvent:{get:t.throwInstantiationError},show:{get:t.throwInstantiationError},clustering:{get:t.throwInstantiationError}});r.prototype.update=t.throwInstantiationError;r.setLoading=function(e,t){if(e._isLoading!==t){if(t){e._entityCollection.suspendEvents()}else{e._entityCollection.resumeEvents()}e._isLoading=t;e._loading.raiseEvent(e,t)}};return r});define("Scene/SceneTransforms",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defined","../Core/DeveloperError","../Core/Math","../Core/Matrix4","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/Transforms","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";var h={};var p=new i(0,0,0,1);var m=new i;var v=new e;var g=new t;var _=new t;h.wgs84ToWindowCoordinates=function(e,t,i){return h.wgs84WithEyeOffsetToWindowCoordinates(e,t,r.ZERO,i)};var y=new i;var b=new r;function w(e,t,n,a){var o=n.viewMatrix;var s=l.multiplyByVector(o,i.fromElements(e.x,e.y,e.z,1,y),y);var u=r.multiplyComponents(t,r.normalize(s,b),b);s.x+=t.x+u.x;s.y+=t.y+u.y;s.z+=u.z;return l.multiplyByVector(n.frustum.projectionMatrix,s,a)}var C=new n(Math.PI,s.PI_OVER_TWO);var S=new r;var T=new r;h.wgs84WithEyeOffsetToWindowCoordinates=function(e,i,n,y){if(!a(e)){throw new o("scene is required.")}if(!a(i)){throw new o("position is required.")}var b=e.frameState;var E=h.computeActualWgs84Position(b,i,p);if(!a(E)){return undefined}var x=e.canvas;var P=v;P.x=0;P.y=0;P.width=x.clientWidth;P.height=x.clientHeight;var A=e.camera;var O=false;if(b.mode===f.SCENE2D){var D=e.mapProjection;var I=C;var M=D.project(I,S);var R=r.clone(A.position,T);var L=A.frustum.clone();var N=l.computeViewportTransformation(P,0,1,new l);var k=A.frustum.projectionMatrix;var F=A.positionWC.y;var B=r.fromElements(s.sign(F)*M.x-F,0,-A.positionWC.x);var U=d.pointToGLWindowCoordinates(k,N,B);if(F===0||U.x<=0||U.x>=x.clientWidth){O=true}else{if(U.x>x.clientWidth*.5){P.width=U.x;A.frustum.right=M.x-F;m=w(E,n,A,m);h.clipToGLWindowCoordinates(P,m,g);P.x+=U.x;A.position.x=-A.position.x;var V=A.frustum.right;A.frustum.right=-A.frustum.left;A.frustum.left=-V;m=w(E,n,A,m);h.clipToGLWindowCoordinates(P,m,_)}else{P.x+=U.x;P.width-=U.x;A.frustum.left=-M.x-F;m=w(E,n,A,m);h.clipToGLWindowCoordinates(P,m,g);P.x=P.x-P.width;A.position.x=-A.position.x;var z=A.frustum.left;A.frustum.left=-A.frustum.right;A.frustum.right=-z;m=w(E,n,A,m);h.clipToGLWindowCoordinates(P,m,_)}r.clone(R,A.position);A.frustum=L.clone();y=t.clone(g,y);if(y.x<0||y.x>x.clientWidth){y.x=_.x}}}if(b.mode!==f.SCENE2D||O){m=w(E,n,A,m);if(m.z<0&&!(A.frustum instanceof u)&&!(A.frustum instanceof c)){return undefined}y=h.clipToGLWindowCoordinates(P,m,y)}y.y=x.clientHeight-y.y;return y};h.wgs84ToDrawingBufferCoordinates=function(e,t,r){r=h.wgs84ToWindowCoordinates(e,t,r);if(!a(r)){return undefined}return h.transformWindowToDrawingBuffer(e,r,r)};var E=new r;var x=new n;h.computeActualWgs84Position=function(e,t,i){var n=e.mode;if(n===f.SCENE3D){return r.clone(t,i)}var o=e.mapProjection;var l=o.ellipsoid.cartesianToCartographic(t,x);if(!a(l)){return undefined}o.project(l,E);if(n===f.COLUMBUS_VIEW){return r.fromElements(E.z,E.x,E.y,i)}if(n===f.SCENE2D){return r.fromElements(0,E.x,E.y,i)}var u=e.morphTime;return r.fromElements(s.lerp(E.z,t.x,u),s.lerp(E.x,t.y,u),s.lerp(E.y,t.z,u),i)};var P=new r;var A=new r;var O=new l;h.clipToGLWindowCoordinates=function(e,i,n){r.divideByScalar(i,i.w,P);l.computeViewportTransformation(e,0,1,O);l.multiplyByPoint(O,P,A);return t.fromCartesian3(A,n)};h.transformWindowToDrawingBuffer=function(e,r,i){var n=e.canvas;var a=e.drawingBufferWidth/n.clientWidth;var o=e.drawingBufferHeight/n.clientHeight;return t.fromElements(r.x*a,r.y*o,i)};var D=new i;var I=new i;h.drawingBufferToWgs84Coordinates=function(e,t,n,o){var s=e.context;var u=s.uniformState;var c=e._passState.viewport;var d=i.clone(i.UNIT_W,D);d.x=(t.x-c.x)/c.width*2-1;d.y=(t.y-c.y)/c.height*2-1;d.z=n*2-1;d.w=1;var f;var h=e.camera.frustum;if(!a(h.fovy)){if(a(h._offCenterFrustum)){h=h._offCenterFrustum}var p=u.currentFrustum;f=I;f.x=(d.x*(h.right-h.left)+h.left+h.right)*.5;f.y=(d.y*(h.top-h.bottom)+h.bottom+h.top)*.5;f.z=(d.z*(p.x-p.y)-p.x-p.y)*.5;f.w=1;f=l.multiplyByVector(u.inverseView,f,f)}else{f=l.multiplyByVector(u.inverseViewProjection,d,I);var m=1/f.w;r.multiplyByScalar(f,m,f)}return r.fromCartesian4(f,o)};return h});define("Scene/Billboard",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/NearFarScalar","./HeightReference","./HorizontalOrigin","./SceneMode","./SceneTransforms","./VerticalOrigin"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_){"use strict";function y(e,i){e=s(e,s.EMPTY_OBJECT);if(l(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0){throw new c("disableDepthTestDistance must be greater than or equal to 0.0.")}var n=e.translucencyByDistance;var u=e.pixelOffsetScaleByDistance;var f=e.scaleByDistance;var g=e.distanceDisplayCondition;if(l(n)){if(n.far<=n.near){throw new c("translucencyByDistance.far must be greater than translucencyByDistance.near.")}n=h.clone(n)}if(l(u)){if(u.far<=u.near){throw new c("pixelOffsetScaleByDistance.far must be greater than pixelOffsetScaleByDistance.near.")}u=h.clone(u)}if(l(f)){if(f.far<=f.near){throw new c("scaleByDistance.far must be greater than scaleByDistance.near.")}f=h.clone(f)}if(l(g)){if(g.far<=g.near){throw new c("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.")}g=d.clone(g)}this._show=s(e.show,true);this._position=r.clone(s(e.position,r.ZERO));this._actualPosition=r.clone(this._position);this._pixelOffset=t.clone(s(e.pixelOffset,t.ZERO));this._translate=new t(0,0);this._eyeOffset=r.clone(s(e.eyeOffset,r.ZERO));this._heightReference=s(e.heightReference,p.NONE);this._verticalOrigin=s(e.verticalOrigin,_.CENTER);this._horizontalOrigin=s(e.horizontalOrigin,m.CENTER);this._scale=s(e.scale,1);this._color=a.clone(s(e.color,a.WHITE));this._rotation=s(e.rotation,0);this._alignedAxis=r.clone(s(e.alignedAxis,r.ZERO));this._width=e.width;this._height=e.height;this._scaleByDistance=f;this._translucencyByDistance=n;this._pixelOffsetScaleByDistance=u;this._sizeInMeters=s(e.sizeInMeters,false);this._distanceDisplayCondition=g;this._disableDepthTestDistance=s(e.disableDepthTestDistance,0);this._id=e.id;this._collection=s(e.collection,i);this._pickId=undefined;this._pickPrimitive=s(e._pickPrimitive,this);this._billboardCollection=i;this._dirty=false;this._index=-1;this._imageIndex=-1;this._imageIndexPromise=undefined;this._imageId=undefined;this._image=undefined;this._imageSubRegion=undefined;this._imageWidth=undefined;this._imageHeight=undefined;var y=e.image;var b=e.imageId;if(l(y)){if(!l(b)){if(typeof y==="string"){b=y}else if(l(y.src)){b=y.src}else{b=o()}}this._imageId=b;this._image=y}if(l(e.imageSubRegion)){this._imageId=b;this._imageSubRegion=e.imageSubRegion}if(l(this._billboardCollection._textureAtlas)){this._loadImage()}this._actualClampedPosition=undefined;this._removeCallbackFunc=undefined;this._mode=v.SCENE3D;this._clusterShow=true;this._updateClamping()}var b=y.SHOW_INDEX=0;var w=y.POSITION_INDEX=1;var C=y.PIXEL_OFFSET_INDEX=2;var S=y.EYE_OFFSET_INDEX=3;var T=y.HORIZONTAL_ORIGIN_INDEX=4;var E=y.VERTICAL_ORIGIN_INDEX=5;var x=y.SCALE_INDEX=6;var P=y.IMAGE_INDEX_INDEX=7;var A=y.COLOR_INDEX=8;var O=y.ROTATION_INDEX=9;var D=y.ALIGNED_AXIS_INDEX=10;var I=y.SCALE_BY_DISTANCE_INDEX=11;var M=y.TRANSLUCENCY_BY_DISTANCE_INDEX=12;var R=y.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13;var L=y.DISTANCE_DISPLAY_CONDITION=14;var N=y.DISABLE_DEPTH_DISTANCE=15;y.NUMBER_OF_PROPERTIES=16;function k(e,t){var r=e._billboardCollection;if(l(r)){r._updateBillboard(e,t);e._dirty=true}}u(y.prototype,{show:{get:function(){return this._show},set:function(e){if(!l(e)){throw new c("value is required.")}if(this._show!==e){this._show=e;k(this,b)}}},position:{get:function(){return this._position},set:function(e){if(!l(e)){throw new c("value is required.")}var t=this._position;if(!r.equals(t,e)){r.clone(e,t);r.clone(e,this._actualPosition);this._updateClamping();k(this,w)}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(!l(e)){throw new c("value is required.")}var t=this._heightReference;if(e!==t){this._heightReference=e;this._updateClamping();k(this,w)}}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){if(!l(e)){throw new c("value is required.")}var r=this._pixelOffset;if(!t.equals(r,e)){t.clone(e,r);k(this,C)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(l(e)&&e.far<=e.near){throw new c("far distance must be greater than near distance.")}var t=this._scaleByDistance;if(!h.equals(t,e)){this._scaleByDistance=h.clone(e,t);k(this,I)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(l(e)&&e.far<=e.near){throw new c("far distance must be greater than near distance.")}var t=this._translucencyByDistance;if(!h.equals(t,e)){this._translucencyByDistance=h.clone(e,t);k(this,M)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){if(l(e)&&e.far<=e.near){throw new c("far distance must be greater than near distance.")}var t=this._pixelOffsetScaleByDistance;if(!h.equals(t,e)){this._pixelOffsetScaleByDistance=h.clone(e,t);k(this,R)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){if(!l(e)){throw new c("value is required.")}var t=this._eyeOffset;if(!r.equals(t,e)){r.clone(e,t);k(this,S)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){if(!l(e)){throw new c("value is required.")}if(this._horizontalOrigin!==e){this._horizontalOrigin=e;k(this,T)}}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(!l(e)){throw new c("value is required.")}if(this._verticalOrigin!==e){this._verticalOrigin=e;k(this,E)}}},scale:{get:function(){return this._scale},set:function(e){if(!l(e)){throw new c("value is required.")}if(this._scale!==e){this._scale=e;k(this,x)}}},color:{get:function(){return this._color},set:function(e){if(!l(e)){throw new c("value is required.")}var t=this._color;if(!a.equals(t,e)){a.clone(e,t);k(this,A)}}},rotation:{get:function(){return this._rotation},set:function(e){if(!l(e)){throw new c("value is required.")}if(this._rotation!==e){this._rotation=e;k(this,O)}}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){if(!l(e)){throw new c("value is required.")}var t=this._alignedAxis;if(!r.equals(t,e)){r.clone(e,t);k(this,D)}}},width:{get:function(){return s(this._width,this._imageWidth)},set:function(e){if(this._width!==e){this._width=e;k(this,P)}}},height:{get:function(){return s(this._height,this._imageHeight)},set:function(e){if(this._height!==e){this._height=e;k(this,P)}}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){if(this._sizeInMeters!==e){this._sizeInMeters=e;k(this,A)}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(!d.equals(e,this._distanceDisplayCondition)){if(l(e)&&e.far<=e.near){throw new c("far distance must be greater than near distance.")}this._distanceDisplayCondition=d.clone(e,this._distanceDisplayCondition);k(this,L)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if(!l(e)||e<0){throw new c("disableDepthTestDistance must be greater than or equal to 0.0.")}this._disableDepthTestDistance=e;k(this,N)}}},id:{get:function(){return this._id},set:function(e){this._id=e;if(l(this._pickId)){this._pickId.object.id=e}}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e;if(l(this._pickId)){this._pickId.object.primitive=e}}},image:{get:function(){return this._imageId},set:function(e){if(!l(e)){this._imageIndex=-1;this._imageSubRegion=undefined;this._imageId=undefined;this._image=undefined;this._imageIndexPromise=undefined;k(this,P)}else if(typeof e==="string"){this.setImage(e,e)}else if(l(e.src)){this.setImage(e.src,e)}else{this.setImage(o(),e)}}},ready:{get:function(){return this._imageIndex!==-1}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=r.clone(e,this._actualClampedPosition);k(this,w)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;k(this,b)}}}});y.prototype.getPickId=function(e){if(!l(this._pickId)){this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})}return this._pickId};y.prototype._updateClamping=function(){y._updateClamping(this._billboardCollection,this)};var F=new n;var B=new r;y._updateClamping=function(e,t){var i=e._scene;if(!l(i)){if(t._heightReference!==p.NONE){throw new c("Height reference is not supported without a scene.")}return}var a=i.globe;var o=a.ellipsoid;var s=a._surface;var u=i.frameState.mode;var d=u!==t._mode;t._mode=u;if((t._heightReference===p.NONE||d)&&l(t._removeCallbackFunc)){t._removeCallbackFunc();t._removeCallbackFunc=undefined;t._clampedPosition=undefined}if(t._heightReference===p.NONE||!l(t._position)){return}var f=o.cartesianToCartographic(t._position);if(!l(f)){t._actualClampedPosition=undefined;return}if(l(t._removeCallbackFunc)){t._removeCallbackFunc()}function h(e){if(t._heightReference===p.RELATIVE_TO_GROUND){if(t._mode===v.SCENE3D){var i=o.cartesianToCartographic(e,F);i.height+=f.height;o.cartographicToCartesian(i,e)}else{e.x+=f.height}}t._clampedPosition=r.clone(e,t._clampedPosition)}t._removeCallbackFunc=s.updateHeight(f,h);n.clone(f,F);var m=a.getHeight(f);if(l(m)){F.height=m}o.cartographicToCartesian(F,B);h(B)};y.prototype._loadImage=function(){var t=this._billboardCollection._textureAtlas;var r=this._imageId;var i=this._image;var n=this._imageSubRegion;var a;if(l(i)){a=t.addImage(r,i)}if(l(n)){a=t.addSubRegion(r,n)}this._imageIndexPromise=a;if(!l(a)){return}var o=this;a.then(function(a){if(o._imageId!==r||o._image!==i||!e.equals(o._imageSubRegion,n)){return}var s=t.textureCoordinates[a];o._imageWidth=t.texture.width*s.width;o._imageHeight=t.texture.height*s.height;o._imageIndex=a;o._ready=true;o._image=undefined;o._imageIndexPromise=undefined;k(o,P)}).otherwise(function(e){console.error("Error loading image for billboard: "+e);o._imageIndexPromise=undefined})};y.prototype.setImage=function(e,t){if(!l(e)){throw new c("id is required.")}if(!l(t)){throw new c("image is required.")}if(this._imageId===e){return}this._imageIndex=-1;this._imageSubRegion=undefined;this._imageId=e;this._image=t;if(l(this._billboardCollection._textureAtlas)){this._loadImage()}};y.prototype.setImageSubRegion=function(t,r){if(!l(t)){throw new c("id is required.")}if(!l(r)){throw new c("subRegion is required.")}if(this._imageId===t&&e.equals(this._imageSubRegion,r)){return}this._imageIndex=-1;this._imageId=t;this._imageSubRegion=e.clone(r);if(l(this._billboardCollection._textureAtlas)){this._loadImage()}};y.prototype._setTranslate=function(e){if(!l(e)){throw new c("value is required.")}var r=this._translate;if(!t.equals(r,e)){t.clone(e,r);k(this,C)}};y.prototype._getActualPosition=function(){return l(this._clampedPosition)?this._clampedPosition:this._actualPosition};y.prototype._setActualPosition=function(e){if(!l(this._clampedPosition)){r.clone(e,this._actualPosition)}k(this,w)};var U=new i;y._computeActualPosition=function(e,t,r,i){if(l(e._clampedPosition)){if(r.mode!==e._mode){e._updateClamping()}return e._clampedPosition}else if(r.mode===v.SCENE3D){return t}f.multiplyByPoint(i,t,U);return g.computeActualWgs84Position(r,U)};var V=new r;y._computeScreenSpacePosition=function(e,r,i,n,a,o){var s=f.multiplyByPoint(e,r,V);var u=g.wgs84WithEyeOffsetToWindowCoordinates(a,s,i,o);if(!l(u)){return undefined}t.add(u,n,u);return u};var z=new t(0,0);y.prototype.computeScreenSpacePosition=function(e,r){var i=this._billboardCollection;if(!l(r)){r=new t}if(!l(i)){throw new c("Billboard must be in a collection.  Was it removed?")}if(!l(e)){throw new c("scene is required.")}t.clone(this._pixelOffset,z);t.add(z,this._translate,z);var n=i.modelMatrix;var a=this._position;if(l(this._clampedPosition)){a=this._clampedPosition;if(e.mode!==v.SCENE3D){var o=e.mapProjection;var s=o.ellipsoid;var u=o.unproject(a,F);a=s.cartographicToCartesian(u,V);n=f.IDENTITY}}var d=y._computeScreenSpacePosition(n,a,this._eyeOffset,z,e,r);return d};y.getScreenSpaceBoundingBox=function(t,r,i){var n=t.width;var a=t.height;var o=t.scale;n*=o;a*=o;var s=r.x;if(t.horizontalOrigin===m.RIGHT){s-=n}else if(t.horizontalOrigin===m.CENTER){s-=n*.5}var u=r.y;if(t.verticalOrigin===_.BOTTOM||t.verticalOrigin===_.BASELINE){u-=a}else if(t.verticalOrigin===_.CENTER){u-=a*.5}if(!l(i)){i=new e}i.x=s;i.y=u;i.width=n;i.height=a;return i};y.prototype.equals=function(i){return this===i||l(i)&&this._id===i._id&&r.equals(this._position,i._position)&&this._imageId===i._imageId&&this._show===i._show&&this._scale===i._scale&&this._verticalOrigin===i._verticalOrigin&&this._horizontalOrigin===i._horizontalOrigin&&this._heightReference===i._heightReference&&e.equals(this._imageSubRegion,i._imageSubRegion)&&a.equals(this._color,i._color)&&t.equals(this._pixelOffset,i._pixelOffset)&&t.equals(this._translate,i._translate)&&r.equals(this._eyeOffset,i._eyeOffset)&&h.equals(this._scaleByDistance,i._scaleByDistance)&&h.equals(this._translucencyByDistance,i._translucencyByDistance)&&h.equals(this._pixelOffsetScaleByDistance,i._pixelOffsetScaleByDistance)&&d.equals(this._distanceDisplayCondition,i._distanceDisplayCondition)&&this._disableDepthTestDistance===i._disableDepthTestDistance};y.prototype._destroy=function(){if(l(this._customData)){this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData);this._customData=undefined}if(l(this._removeCallbackFunc)){this._removeCallbackFunc();this._removeCallbackFunc=undefined}this.image=undefined;this._pickId=this._pickId&&this._pickId.destroy();this._billboardCollection=undefined};return y});define("Renderer/VertexArrayFacade",["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Math","./Buffer","./BufferUsage","./VertexArray"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(i,a,o,s){if(!i){throw new n("context is required.")}if(!a||a.length===0){throw new n("At least one attribute is required.")}var l=u._verifyAttributes(a);o=t(o,0);var c=[];var d={};var f;var h;var p=l.length;for(var m=0;m<p;++m){var v=l[m];if(v.vertexBuffer){c.push(v);continue}h=v.usage;f=d[h];if(!r(f)){f=d[h]=[]}f.push(v)}function g(t,r){return e.getSizeInBytes(r.componentDatatype)-e.getSizeInBytes(t.componentDatatype)}this._allBuffers=[];for(h in d){if(d.hasOwnProperty(h)){f=d[h];f.sort(g);var _=u._vertexSizeInBytes(f);var y=f[0].usage;var b={vertexSizeInBytes:_,vertexBuffer:undefined,usage:y,needsCommit:false,arrayBuffer:undefined,arrayViews:u._createArrayViews(f,_)};this._allBuffers.push(b)}}this._size=0;this._instanced=t(s,false);this._precreated=c;this._context=i;this.writers=undefined;this.va=undefined;this.resize(o)}u._verifyAttributes=function(r){var i=[];for(var a=0;a<r.length;++a){var o=r[a];var l={index:t(o.index,a),enabled:t(o.enabled,true),componentsPerAttribute:o.componentsPerAttribute,componentDatatype:t(o.componentDatatype,e.FLOAT),normalize:t(o.normalize,false),vertexBuffer:o.vertexBuffer,usage:t(o.usage,s.STATIC_DRAW)};i.push(l);if(l.componentsPerAttribute!==1&&l.componentsPerAttribute!==2&&l.componentsPerAttribute!==3&&l.componentsPerAttribute!==4){throw new n("attribute.componentsPerAttribute must be in the range [1, 4].")}var u=l.componentDatatype;if(!e.validate(u)){throw new n("Attribute must have a valid componentDatatype or not specify it.")}if(!s.validate(l.usage)){throw new n("Attribute must have a valid usage or not specify it.")}}var c=new Array(i.length);for(var d=0;d<i.length;++d){var f=i[d];var h=f.index;if(c[h]){throw new n("Index "+h+" is used by more than one attribute.")}c[h]=true}return i};u._vertexSizeInBytes=function(t){var r=0;var i=t.length;for(var n=0;n<i;++n){var a=t[n];r+=a.componentsPerAttribute*e.getSizeInBytes(a.componentDatatype)}var o=i>0?e.getSizeInBytes(t[0].componentDatatype):0;var s=o>0?r%o:0;var l=s===0?0:o-s;r+=l;return r};u._createArrayViews=function(t,r){var i=[];var n=0;var a=t.length;for(var o=0;o<a;++o){var s=t[o];var l=s.componentDatatype;i.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:l,normalize:s.normalize,offsetInBytes:n,vertexSizeInComponentType:r/e.getSizeInBytes(l),view:undefined});n+=s.componentsPerAttribute*e.getSizeInBytes(l)}return i};u.prototype.resize=function(e){this._size=e;var t=this._allBuffers;this.writers=[];for(var r=0,i=t.length;r<i;++r){var n=t[r];u._resize(n,this._size);u._appendWriters(this.writers,n)}h(this)};u._resize=function(t,i){if(t.vertexSizeInBytes>0){var n=new ArrayBuffer(i*t.vertexSizeInBytes);if(r(t.arrayBuffer)){var a=new Uint8Array(n);var o=new Uint8Array(t.arrayBuffer);var s=o.length;for(var l=0;l<s;++l){a[l]=o[l]}}var u=t.arrayViews;var c=u.length;for(var d=0;d<c;++d){var f=u[d];f.view=e.createArrayBufferView(f.componentDatatype,n,f.offsetInBytes)}t.arrayBuffer=n}};var c=[function(e,t,r){return function(i,n){t[i*r]=n;e.needsCommit=true}},function(e,t,r){return function(i,n,a){var o=i*r;t[o]=n;t[o+1]=a;e.needsCommit=true}},function(e,t,r){return function(i,n,a,o){var s=i*r;t[s]=n;t[s+1]=a;t[s+2]=o;e.needsCommit=true}},function(e,t,r){return function(i,n,a,o,s){var l=i*r;t[l]=n;t[l+1]=a;t[l+2]=o;t[l+3]=s;e.needsCommit=true}}];u._appendWriters=function(e,t){var r=t.arrayViews;var i=r.length;for(var n=0;n<i;++n){var a=r[n];e[a.index]=c[a.componentsPerAttribute-1](t,a.view,a.vertexSizeInComponentType)}};u.prototype.commit=function(e){var t=false;var i=this._allBuffers;var n;var o;var s;for(o=0,s=i.length;o<s;++o){n=i[o];t=d(this,n)||t}if(t||!r(this.va)){h(this);var c=this.va=[];var f=r(e)?Math.ceil(this._size/(a.SIXTY_FOUR_KILOBYTES-1)):1;for(var p=0;p<f;++p){var m=[];for(o=0,s=i.length;o<s;++o){n=i[o];var v=p*(n.vertexSizeInBytes*(a.SIXTY_FOUR_KILOBYTES-1));u._appendAttributes(m,n,v,this._instanced)}m=m.concat(this._precreated);c.push({va:new l({context:this._context,attributes:m,indexBuffer:e}),indicesCount:1.5*(p!==f-1?a.SIXTY_FOUR_KILOBYTES-1:this._size%(a.SIXTY_FOUR_KILOBYTES-1))})}}};function d(e,t){if(t.needsCommit&&t.vertexSizeInBytes>0){t.needsCommit=false;var i=t.vertexBuffer;var n=e._size*t.vertexSizeInBytes;var a=r(i);if(!a||i.sizeInBytes<n){if(a){i.destroy()}t.vertexBuffer=o.createVertexBuffer({context:e._context,typedArray:t.arrayBuffer,usage:t.usage});t.vertexBuffer.vertexArrayDestroyable=false;return true}t.vertexBuffer.copyFromArrayView(t.arrayBuffer)}return false}u._appendAttributes=function(e,t,r,i){var n=t.arrayViews;var a=n.length;for(var o=0;o<a;++o){var s=n[o];e.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:s.componentDatatype,normalize:s.normalize,vertexBuffer:t.vertexBuffer,offsetInBytes:r+s.offsetInBytes,strideInBytes:t.vertexSizeInBytes,instanceDivisor:i?1:0})}};u.prototype.subCommit=function(e,t){if(e<0||e>=this._size){throw new n("offsetInVertices must be greater than or equal to zero and less than the vertex array size.")}if(e+t>this._size){throw new n("offsetInVertices + lengthInVertices cannot exceed the vertex array size.")}var r=this._allBuffers;for(var i=0,a=r.length;i<a;++i){f(r[i],e,t)}};function f(e,t,r){if(e.needsCommit&&e.vertexSizeInBytes>0){var i=e.vertexSizeInBytes*t;var n=e.vertexSizeInBytes*r;e.vertexBuffer.copyFromArrayView(new Uint8Array(e.arrayBuffer,i,n),i)}}u.prototype.endSubCommits=function(){var e=this._allBuffers;for(var t=0,r=e.length;t<r;++t){e[t].needsCommit=false}};function h(e){var t=e.va;if(!r(t)){return}var i=t.length;for(var n=0;n<i;++n){t[n].va.destroy()}e.va=undefined}u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){var e=this._allBuffers;for(var t=0,r=e.length;t<r;++t){var n=e[t];n.vertexBuffer=n.vertexBuffer&&n.vertexBuffer.destroy()}h(this);return i(this)};return u});define("Shaders/BillboardCollectionFS",[],function(){"use strict";return"uniform sampler2D u_atlas;\n\nvarying vec2 v_textureCoordinates;\n\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#else\nvarying vec4 v_color;\n#endif\n\nvoid main()\n{\n#ifdef RENDER_FOR_PICK\n    vec4 vertexColor = vec4(1.0, 1.0, 1.0, 1.0);\n#else\n    vec4 vertexColor = v_color;\n#endif\n\n    vec4 color = texture2D(u_atlas, v_textureCoordinates) * vertexColor;\n\n// Fully transparent parts of the billboard are not pickable.\n#if defined(RENDER_FOR_PICK) || (!defined(OPAQUE) && !defined(TRANSLUCENT))\n    if (color.a < 0.005)   // matches 0/255 and 1/255\n    {\n        discard;\n    }\n#else\n// The billboard is rendered twice. The opaque pass discards translucent fragments\n// and the translucent pass discards opaque fragments.\n#ifdef OPAQUE\n    if (color.a < 0.995)   // matches < 254/255\n    {\n        discard;\n    }\n#else\n    if (color.a >= 0.995)  // matches 254/255 and 255/255\n    {\n        discard;\n    }\n#endif\n#endif\n\n#ifdef RENDER_FOR_PICK\n    gl_FragColor = v_pickColor;\n#else\n    gl_FragColor = color;\n#endif\n}\n"});define("Shaders/BillboardCollectionVS",[],function(){"use strict";return"#ifdef INSTANCED\nattribute vec2 direction;\n#endif\nattribute vec4 positionHighAndScale;\nattribute vec4 positionLowAndRotation;\nattribute vec4 compressedAttribute0;                       // pixel offset, translate, horizontal origin, vertical origin, show, direction, texture coordinates (texture offset)\nattribute vec4 compressedAttribute1;                       // aligned axis, translucency by distance, image width\nattribute vec4 compressedAttribute2;                       // image height, color, pick color, size in meters, valid aligned axis, 13 bits free\nattribute vec4 eyeOffset;                                  // eye offset in meters, 4 bytes free (texture range)\nattribute vec4 scaleByDistance;                            // near, nearScale, far, farScale\nattribute vec4 pixelOffsetScaleByDistance;                 // near, nearScale, far, farScale\nattribute vec3 distanceDisplayConditionAndDisableDepth;    // near, far, disableDepthTestDistance\n\nvarying vec2 v_textureCoordinates;\n\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#else\nvarying vec4 v_color;\n#endif\n\nconst float UPPER_BOUND = 32768.0;\n\nconst float SHIFT_LEFT16 = 65536.0;\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_LEFT7 = 128.0;\nconst float SHIFT_LEFT5 = 32.0;\nconst float SHIFT_LEFT3 = 8.0;\nconst float SHIFT_LEFT2 = 4.0;\nconst float SHIFT_LEFT1 = 2.0;\n\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nconst float SHIFT_RIGHT7 = 1.0 / 128.0;\nconst float SHIFT_RIGHT5 = 1.0 / 32.0;\nconst float SHIFT_RIGHT3 = 1.0 / 8.0;\nconst float SHIFT_RIGHT2 = 1.0 / 4.0;\nconst float SHIFT_RIGHT1 = 1.0 / 2.0;\n\nvec4 computePositionWindowCoordinates(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters)\n{\n    // Note the halfSize cannot be computed in JavaScript because it is sent via\n    // compressed vertex attributes that coerce it to an integer.\n    vec2 halfSize = imageSize * scale * czm_resolutionScale * 0.5;\n    halfSize *= ((direction * 2.0) - 1.0);\n\n    vec2 originTranslate = origin * abs(halfSize);\n\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\n    if (validAlignedAxis || rotation != 0.0)\n    {\n        float angle = rotation;\n        if (validAlignedAxis)\n        {\n            vec4 projectedAlignedAxis = czm_modelViewProjection * vec4(alignedAxis, 0.0);\n            angle += sign(-projectedAlignedAxis.x) * acos( sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /\n                    (projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y) );\n        }\n\n        float cosTheta = cos(angle);\n        float sinTheta = sin(angle);\n        mat2 rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);\n        halfSize = rotationMatrix * halfSize;\n    }\n#endif\n\n    if (sizeInMeters)\n    {\n        positionEC.xy += halfSize;\n    }\n\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n\n    if (sizeInMeters)\n    {\n        originTranslate /= czm_metersPerPixel(positionEC);\n    }\n\n    positionWC.xy += originTranslate;\n    if (!sizeInMeters)\n    {\n        positionWC.xy += halfSize;\n    }\n\n    positionWC.xy += translate;\n    positionWC.xy += (pixelOffset * czm_resolutionScale);\n\n    return positionWC;\n}\n\nvoid main()\n{\n    // Modifying this shader may also require modifications to Billboard._computeScreenSpacePosition\n\n    // unpack attributes\n    vec3 positionHigh = positionHighAndScale.xyz;\n    vec3 positionLow = positionLowAndRotation.xyz;\n    float scale = positionHighAndScale.w;\n\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\n    float rotation = positionLowAndRotation.w;\n#else\n    float rotation = 0.0;\n#endif\n\n    float compressed = compressedAttribute0.x;\n\n    vec2 pixelOffset;\n    pixelOffset.x = floor(compressed * SHIFT_RIGHT7);\n    compressed -= pixelOffset.x * SHIFT_LEFT7;\n    pixelOffset.x -= UPPER_BOUND;\n\n    vec2 origin;\n    origin.x = floor(compressed * SHIFT_RIGHT5);\n    compressed -= origin.x * SHIFT_LEFT5;\n\n    origin.y = floor(compressed * SHIFT_RIGHT3);\n    compressed -= origin.y * SHIFT_LEFT3;\n\n    origin -= vec2(1.0);\n\n    float show = floor(compressed * SHIFT_RIGHT2);\n    compressed -= show * SHIFT_LEFT2;\n\n#ifdef INSTANCED\n    vec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);\n    vec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);\n    vec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;\n#else\n    vec2 direction;\n    direction.x = floor(compressed * SHIFT_RIGHT1);\n    direction.y = compressed - direction.x * SHIFT_LEFT1;\n\n    vec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);\n#endif\n\n    float temp = compressedAttribute0.y  * SHIFT_RIGHT8;\n    pixelOffset.y = -(floor(temp) - UPPER_BOUND);\n\n    vec2 translate;\n    translate.y = (temp - floor(temp)) * SHIFT_LEFT16;\n\n    temp = compressedAttribute0.z * SHIFT_RIGHT8;\n    translate.x = floor(temp) - UPPER_BOUND;\n\n    translate.y += (temp - floor(temp)) * SHIFT_LEFT8;\n    translate.y -= UPPER_BOUND;\n\n    temp = compressedAttribute1.x * SHIFT_RIGHT8;\n\n    vec2 imageSize = vec2(floor(temp), compressedAttribute2.w);\n\n#ifdef EYE_DISTANCE_TRANSLUCENCY\n    vec4 translucencyByDistance;\n    translucencyByDistance.x = compressedAttribute1.z;\n    translucencyByDistance.z = compressedAttribute1.w;\n\n    translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n\n    temp = compressedAttribute1.y * SHIFT_RIGHT8;\n    translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\n\n#ifdef ALIGNED_AXIS\n    vec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));\n    temp = compressedAttribute2.z * SHIFT_RIGHT5;\n    bool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;\n#else\n    vec3 alignedAxis = vec3(0.0);\n    bool validAlignedAxis = false;\n#endif\n\n#ifdef RENDER_FOR_PICK\n    temp = compressedAttribute2.y;\n#else\n    temp = compressedAttribute2.x;\n#endif\n\n    vec4 color;\n    temp = temp * SHIFT_RIGHT8;\n    color.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    color.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    color.r = floor(temp);\n\n    temp = compressedAttribute2.z * SHIFT_RIGHT8;\n    bool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;\n    temp = floor(temp) * SHIFT_RIGHT8;\n\n#ifdef RENDER_FOR_PICK\n    color.a = (temp - floor(temp)) * SHIFT_LEFT8;\n    vec4 pickColor = color / 255.0;\n#else\n    color.a = floor(temp);\n    color /= 255.0;\n#endif\n\n    ///////////////////////////////////////////////////////////////////////////\n\n    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\n    vec4 positionEC = czm_modelViewRelativeToEye * p;\n    positionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);\n    positionEC.xyz *= show;\n\n    ///////////////////////////////////////////////////////////////////////////\n\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)\n    float lengthSq;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        // 2D camera distance is a special case\n        // treat all billboards as flattened to the z=0.0 plane\n        lengthSq = czm_eyeHeight2D.y;\n    }\n    else\n    {\n        lengthSq = dot(positionEC.xyz, positionEC.xyz);\n    }\n#endif\n\n#ifdef EYE_DISTANCE_SCALING\n    float distanceScale = czm_nearFarScalar(scaleByDistance, lengthSq);\n    scale *= distanceScale;\n    translate *= distanceScale;\n    // push vertex behind near plane for clipping\n    if (scale == 0.0)\n    {\n        positionEC.xyz = vec3(0.0);\n    }\n#endif\n\n    float translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\n    translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\n    // push vertex behind near plane for clipping\n    if (translucency == 0.0)\n    {\n        positionEC.xyz = vec3(0.0);\n    }\n#endif\n\n#ifdef EYE_DISTANCE_PIXEL_OFFSET\n    float pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);\n    pixelOffset *= pixelOffsetScale;\n#endif\n\n#ifdef DISTANCE_DISPLAY_CONDITION\n    float nearSq = distanceDisplayConditionAndDisableDepth.x;\n    float farSq = distanceDisplayConditionAndDisableDepth.y;\n    if (lengthSq < nearSq || lengthSq > farSq)\n    {\n        positionEC.xyz = vec3(0.0);\n    }\n#endif\n\n    vec4 positionWC = computePositionWindowCoordinates(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters);\n    gl_Position = czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\n    v_textureCoordinates = textureCoordinates;\n\n#ifdef DISABLE_DEPTH_DISTANCE\n    float disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z;\n    if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)\n    {\n        disableDepthTestDistance = czm_minimumDisableDepthTestDistance;\n    }\n\n    if (disableDepthTestDistance != 0.0)\n    {\n        // Don't try to \"multiply both sides\" by w.  Greater/less-than comparisons won't work for negative values of w.\n        float zclip = gl_Position.z / gl_Position.w;\n        bool clipped = (zclip < -1.0 || zclip > 1.0);\n        if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))\n        {\n            // Position z on the near plane.\n            gl_Position.z = -gl_Position.w;\n        }\n    }\n#endif\n\n#ifdef RENDER_FOR_PICK\n    v_pickColor = pickColor;\n#else\n    v_color = color;\n    v_color.a *= translucency;\n#endif\n}\n"});define("Scene/BlendOption",["../Core/freezeObject"],function(e){"use strict";var t={OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};return e(t)});define("Renderer/Framebuffer",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/PixelFormat","./ContextLimits"],function(e,t,r,i,n,a,o){"use strict";function s(e,t,r){var i=e._gl;i.framebufferTexture2D(i.FRAMEBUFFER,t,r._target,r._texture,0)}function l(e,t,r){var i=e._gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,t,i.RENDERBUFFER,r._getRenderbuffer())}function u(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}var i=r.context._gl;var u=o.maximumColorAttachments;this._gl=i;this._framebuffer=i.createFramebuffer();this._colorTextures=[];this._colorRenderbuffers=[];this._activeColorAttachments=[];this._depthTexture=undefined;this._depthRenderbuffer=undefined;this._stencilRenderbuffer=undefined;this._depthStencilTexture=undefined;this._depthStencilRenderbuffer=undefined;this.destroyAttachments=e(r.destroyAttachments,true);if(t(r.colorTextures)&&t(r.colorRenderbuffers)){throw new n("Cannot have both color texture and color renderbuffer attachments.")}if(t(r.depthTexture)&&t(r.depthRenderbuffer)){throw new n("Cannot have both a depth texture and depth renderbuffer attachment.")}if(t(r.depthStencilTexture)&&t(r.depthStencilRenderbuffer)){throw new n("Cannot have both a depth-stencil texture and depth-stencil renderbuffer attachment.")}var c=t(r.depthTexture)||t(r.depthRenderbuffer);var d=t(r.depthStencilTexture)||t(r.depthStencilRenderbuffer);if(c&&d){throw new n("Cannot have both a depth and depth-stencil attachment.")}if(t(r.stencilRenderbuffer)&&d){throw new n("Cannot have both a stencil and depth-stencil attachment.")}if(c&&t(r.stencilRenderbuffer)){throw new n("Cannot have both a depth and stencil attachment.")}this._bind();var f;var h;var p;var m;var v;if(t(r.colorTextures)){var g=r.colorTextures;m=this._colorTextures.length=this._activeColorAttachments.length=g.length;if(m>u){throw new n("The number of color attachments exceeds the number supported.")}for(p=0;p<m;++p){f=g[p];if(!a.isColorFormat(f.pixelFormat)){throw new n("The color-texture pixel-format must be a color format.")}v=this._gl.COLOR_ATTACHMENT0+p;s(this,v,f);this._activeColorAttachments[p]=v;this._colorTextures[p]=f}}if(t(r.colorRenderbuffers)){var _=r.colorRenderbuffers;m=this._colorRenderbuffers.length=this._activeColorAttachments.length=_.length;if(m>u){throw new n("The number of color attachments exceeds the number supported.")}for(p=0;p<m;++p){h=_[p];v=this._gl.COLOR_ATTACHMENT0+p;l(this,v,h);this._activeColorAttachments[p]=v;this._colorRenderbuffers[p]=h}}if(t(r.depthTexture)){f=r.depthTexture;if(f.pixelFormat!==a.DEPTH_COMPONENT){throw new n("The depth-texture pixel-format must be DEPTH_COMPONENT.")}s(this,this._gl.DEPTH_ATTACHMENT,f);this._depthTexture=f}if(t(r.depthRenderbuffer)){h=r.depthRenderbuffer;l(this,this._gl.DEPTH_ATTACHMENT,h);this._depthRenderbuffer=h}if(t(r.stencilRenderbuffer)){h=r.stencilRenderbuffer;l(this,this._gl.STENCIL_ATTACHMENT,h);this._stencilRenderbuffer=h}if(t(r.depthStencilTexture)){f=r.depthStencilTexture;if(f.pixelFormat!==a.DEPTH_STENCIL){throw new n("The depth-stencil pixel-format must be DEPTH_STENCIL.")}s(this,this._gl.DEPTH_STENCIL_ATTACHMENT,f);this._depthStencilTexture=f}if(t(r.depthStencilRenderbuffer)){h=r.depthStencilRenderbuffer;l(this,this._gl.DEPTH_STENCIL_ATTACHMENT,h);this._depthStencilRenderbuffer=h}this._unBind()}r(u.prototype,{status:{get:function(){this._bind();var e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);this._unBind();return e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}});u.prototype._bind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)};u.prototype._unBind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)};u.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments};u.prototype.getColorTexture=function(e){if(!t(e)||e<0||e>=this._colorTextures.length){throw new n("index is required, must be greater than or equal to zero and must be less than the number of color attachments.")}return this._colorTextures[e]};u.prototype.getColorRenderbuffer=function(e){if(!t(e)||e<0||e>=this._colorRenderbuffers.length){throw new n("index is required, must be greater than or equal to zero and must be less than the number of color attachments.")}return this._colorRenderbuffers[e]};u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){if(this.destroyAttachments){var e=0;var r=this._colorTextures;var n=r.length;for(;e<n;++e){var a=r[e];if(t(a)){a.destroy()}}var o=this._colorRenderbuffers;n=o.length;for(e=0;e<n;++e){var s=o[e];if(t(s)){s.destroy()}}this._depthTexture=this._depthTexture&&this._depthTexture.destroy();this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy();this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy();this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy();this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}this._gl.deleteFramebuffer(this._framebuffer);return i(this)};return u});define("Scene/TextureAtlas",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/loadImage","../Core/PixelFormat","../Core/RuntimeError","../Renderer/Framebuffer","../Renderer/Texture","../ThirdParty/when"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";function p(e,r,n,a,o){this.bottomLeft=i(e,t.ZERO);this.topRight=i(r,t.ZERO);this.childNode1=n;this.childNode2=a;this.imageIndex=o}var m=new t(16,16);function v(e){e=i(e,i.EMPTY_OBJECT);var t=i(e.borderWidthInPixels,1);var a=i(e.initialSize,m);if(!n(e.context)){throw new s("context is required.")}if(t<0){throw new s("borderWidthInPixels must be greater than or equal to zero.")}if(a.x<1||a.y<1){throw new s("initialSize must be greater than zero.")}this._context=e.context;this._pixelFormat=i(e.pixelFormat,u.RGBA);this._borderWidthInPixels=t;this._textureCoordinates=[];this._guid=r();this._idHash={};this._initialSize=a;this._root=undefined}a(v.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){if(!n(this._texture)){this._texture=new f({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})}return this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}});function g(e,r){var i=e._context;var a=e.numberOfImages;var o=2;var s=e._borderWidthInPixels;if(a>0){var l=e._texture.width;var u=e._texture.height;var c=o*(l+r.width+s);var h=o*(u+r.height+s);var m=l/c;var v=u/h;var g=new p(new t(l+s,s),new t(c,u));var _=new p(new t,new t(c,u),e._root,g);var y=new p(new t(s,u+s),new t(c,h));var b=new p(new t,new t(c,h),_,y);for(var w=0;w<e._textureCoordinates.length;w++){var C=e._textureCoordinates[w];if(n(C)){C.x*=m;C.y*=v;C.width*=m;C.height*=v}}var S=new f({context:e._context,width:c,height:h,pixelFormat:e._pixelFormat});var T=new d({context:i,colorTextures:[e._texture],destroyAttachments:false});T._bind();S.copyFromFramebuffer(0,0,0,0,c,h);T._unBind();T.destroy();e._texture=e._texture&&e._texture.destroy();e._texture=S;e._root=b}else{var E=o*(r.width+2*s);var x=o*(r.height+2*s);if(E<e._initialSize.x){E=e._initialSize.x}if(x<e._initialSize.y){x=e._initialSize.y}e._texture=e._texture&&e._texture.destroy();e._texture=new f({context:e._context,width:E,height:x,pixelFormat:e._pixelFormat});e._root=new p(new t(s,s),new t(E,x))}}function _(e,r,i){if(!n(r)){return undefined}if(!n(r.childNode1)&&!n(r.childNode2)){if(n(r.imageIndex)){return undefined}var a=r.topRight.x-r.bottomLeft.x;var o=r.topRight.y-r.bottomLeft.y;var s=a-i.width;var l=o-i.height;if(s<0||l<0){return undefined}if(s===0&&l===0){return r}if(s>l){r.childNode1=new p(new t(r.bottomLeft.x,r.bottomLeft.y),new t(r.bottomLeft.x+i.width,r.topRight.y));var u=r.bottomLeft.x+i.width+e._borderWidthInPixels;if(u<r.topRight.x){r.childNode2=new p(new t(u,r.bottomLeft.y),new t(r.topRight.x,r.topRight.y))}}else{r.childNode1=new p(new t(r.bottomLeft.x,r.bottomLeft.y),new t(r.topRight.x,r.bottomLeft.y+i.height));var c=r.bottomLeft.y+i.height+e._borderWidthInPixels;if(c<r.topRight.y){r.childNode2=new p(new t(r.bottomLeft.x,c),new t(r.topRight.x,r.topRight.y))}}return _(e,r.childNode1,i)}return _(e,r.childNode1,i)||_(e,r.childNode2,i)}function y(t,i,a){var o=_(t,t._root,i);if(n(o)){o.imageIndex=a;var s=t._texture.width;var l=t._texture.height;var u=o.topRight.x-o.bottomLeft.x;var c=o.topRight.y-o.bottomLeft.y;var d=o.bottomLeft.x/s;var f=o.bottomLeft.y/l;var h=u/s;var p=c/l;t._textureCoordinates[a]=new e(d,f,h,p);t._texture.copyFrom(i,o.bottomLeft.x,o.bottomLeft.y)}else{g(t,i);y(t,i,a)}t._guid=r()}v.prototype.addImage=function(e,t){if(!n(e)){throw new s("id is required.")}if(!n(t)){throw new s("image is required.")}var r=this._idHash[e];if(n(r)){return r}if(typeof t==="function"){t=t(e);if(!n(t)){throw new s("image is required.")}}else if(typeof t==="string"){t=l(t)}var i=this;r=h(t,function(e){if(i.isDestroyed()){return-1}var t=i.numberOfImages;y(i,e,t);return t});this._idHash[e]=r;return r};v.prototype.addSubRegion=function(t,i){if(!n(t)){throw new s("id is required.")}if(!n(i)){throw new s("subRegion is required.")}var a=this._idHash[t];if(!n(a)){throw new c('image with id "'+t+'" not found in the atlas.')}var o=this;return h(a,function(t){if(t===-1){return-1}var n=o._texture.width;var a=o._texture.height;var s=o.numberOfImages;var l=o._textureCoordinates[t];var u=l.x+i.x/n;var c=l.y+i.y/a;var d=i.width/n;var f=i.height/a;o._textureCoordinates.push(new e(u,c,d,f));o._guid=r();return s})};v.prototype.isDestroyed=function(){return false};v.prototype.destroy=function(){this._texture=this._texture&&this._texture.destroy();return o(this)};return v});define("Scene/BillboardCollection",["../Core/AttributeCompression","../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/IndexDatatype","../Core/Math","../Core/Matrix4","../Core/WebGLConstants","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArrayFacade","../Shaders/BillboardCollectionFS","../Shaders/BillboardCollectionVS","./Billboard","./BlendingState","./BlendOption","./HeightReference","./HorizontalOrigin","./SceneMode","./TextureAtlas","./VerticalOrigin"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R){"use strict";var L=x.SHOW_INDEX;var N=x.POSITION_INDEX;var k=x.PIXEL_OFFSET_INDEX;var F=x.EYE_OFFSET_INDEX;var B=x.HORIZONTAL_ORIGIN_INDEX;var U=x.VERTICAL_ORIGIN_INDEX;var V=x.SCALE_INDEX;var z=x.IMAGE_INDEX_INDEX;var q=x.COLOR_INDEX;var G=x.ROTATION_INDEX;var H=x.ALIGNED_AXIS_INDEX;var j=x.SCALE_BY_DISTANCE_INDEX;var W=x.TRANSLUCENCY_BY_DISTANCE_INDEX;var Y=x.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX;var X=x.DISTANCE_DISPLAY_CONDITION_INDEX;var Q=x.DISABLE_DEPTH_DISTANCE;var Z=x.NUMBER_OF_PROPERTIES;var K;var J={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,distanceDisplayConditionAndDisableDepth:8};var $={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,distanceDisplayConditionAndDisableDepth:9};function ee(e){e=o(e,o.EMPTY_OBJECT);this._scene=e.scene;this._textureAtlas=undefined;this._textureAtlasGUID=undefined;this._destroyTextureAtlas=true;this._sp=undefined;this._spTranslucent=undefined;this._spPick=undefined;this._rsOpaque=undefined;this._rsTranslucent=undefined;this._vaf=undefined;this._billboards=[];this._billboardsToUpdate=[];this._billboardsToUpdateIndex=0;this._billboardsRemoved=false;this._createVertexArray=false;this._shaderRotation=false;this._compiledShaderRotation=false;this._compiledShaderRotationPick=false;this._shaderAlignedAxis=false;this._compiledShaderAlignedAxis=false;this._compiledShaderAlignedAxisPick=false;this._shaderScaleByDistance=false;this._compiledShaderScaleByDistance=false;this._compiledShaderScaleByDistancePick=false;this._shaderTranslucencyByDistance=false;this._compiledShaderTranslucencyByDistance=false;this._compiledShaderTranslucencyByDistancePick=false;this._shaderPixelOffsetScaleByDistance=false;this._compiledShaderPixelOffsetScaleByDistance=false;this._compiledShaderPixelOffsetScaleByDistancePick=false;this._shaderDistanceDisplayCondition=false;this._compiledShaderDistanceDisplayCondition=false;this._compiledShaderDistanceDisplayConditionPick=false;this._shaderDisableDepthDistance=false;this._compiledShaderDisableDepthDistance=false;this._compiledShaderDisableDepthDistancePick=false;this._propertiesChanged=new Uint32Array(Z);this._maxSize=0;this._maxEyeOffset=0;this._maxScale=1;this._maxPixelOffset=0;this._allHorizontalCenter=true;this._allVerticalCenter=true;this._allSizedInMeters=true;this._baseVolume=new t;this._baseVolumeWC=new t;this._baseVolume2D=new t;this._boundingVolume=new t;this._boundingVolumeDirty=false;this._colorCommands=[];this._pickCommands=[];this.modelMatrix=p.clone(o(e.modelMatrix,p.IDENTITY));this._modelMatrix=p.clone(p.IDENTITY);this.debugShowBoundingVolume=o(e.debugShowBoundingVolume,false);this.blendOption=o(e.blendOption,A.OPAQUE_AND_TRANSLUCENT);this._blendOption=undefined;this._mode=I.SCENE3D;this._buffersUsage=[g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW,g.STATIC_DRAW];var r=this;this._uniforms={u_atlas:function(){return r._textureAtlas.texture}};var i=this._scene;if(s(i)&&s(i.terrainProviderChanged)){this._removeCallbackFunc=i.terrainProviderChanged.addEventListener(function(){var e=this._billboards;var t=e.length;for(var r=0;r<t;++r){e[r]._updateClamping()}},this)}}l(ee.prototype,{length:{get:function(){re(this);return this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){if(this._textureAtlas!==e){this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy();this._textureAtlas=e;this._createVertexArray=true}}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}});function te(e){var t=e.length;for(var r=0;r<t;++r){if(e[r]){e[r]._destroy()}}}ee.prototype.add=function(e){var t=new x(e,this);t._index=this._billboards.length;this._billboards.push(t);this._createVertexArray=true;return t};ee.prototype.remove=function(e){if(this.contains(e)){this._billboards[e._index]=null;this._billboardsRemoved=true;this._createVertexArray=true;e._destroy();return true}return false};ee.prototype.removeAll=function(){te(this._billboards);this._billboards=[];this._billboardsToUpdate=[];this._billboardsToUpdateIndex=0;this._billboardsRemoved=false;this._createVertexArray=true};function re(e){if(e._billboardsRemoved){e._billboardsRemoved=false;var t=[];var r=e._billboards;var i=r.length;for(var n=0,a=0;n<i;++n){var o=r[n];if(o){o._index=a++;t.push(o)}}e._billboards=t}}ee.prototype._updateBillboard=function(e,t){if(!e._dirty){this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e}++this._propertiesChanged[t]};ee.prototype.contains=function(e){return s(e)&&e._billboardCollection===this};ee.prototype.get=function(e){if(!s(e)){throw new c("index is required.")}re(this);return this._billboards[e]};var ie;function ne(e){var t=16*1024;var r=e.cache.billboardCollection_indexBufferBatched;if(s(r)){return r}var i=t*6-6;var n=new Uint16Array(i);for(var a=0,o=0;a<i;a+=6,o+=4){n[a]=o;n[a+1]=o+1;n[a+2]=o+2;n[a+3]=o+0;n[a+4]=o+2;n[a+5]=o+3}r=v.createIndexBuffer({context:e,typedArray:n,usage:g.STATIC_DRAW,indexDatatype:f.UNSIGNED_SHORT});r.vertexArrayDestroyable=false;e.cache.billboardCollection_indexBufferBatched=r;return r}function ae(e){var t=e.cache.billboardCollection_indexBufferInstanced;if(s(t)){return t}t=v.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:g.STATIC_DRAW,indexDatatype:f.UNSIGNED_SHORT});t.vertexArrayDestroyable=false;e.cache.billboardCollection_indexBufferInstanced=t;return t}function oe(e){var t=e.cache.billboardCollection_vertexBufferInstanced;if(s(t)){return t}t=v.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:g.STATIC_DRAW});t.vertexArrayDestroyable=false;e.cache.billboardCollection_vertexBufferInstanced=t;return t}ee.prototype.computeNewBuffersUsage=function(){var e=this._buffersUsage;var t=false;var r=this._propertiesChanged;for(var i=0;i<Z;++i){var n=r[i]===0?g.STATIC_DRAW:g.STREAM_DRAW;t=t||e[i]!==n;e[i]=n}return t};function se(e,t,r,i){var n=[{index:K.positionHighAndScale,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[N]},{index:K.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[N]},{index:K.compressedAttribute0,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[k]},{index:K.compressedAttribute1,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[W]},{index:K.compressedAttribute2,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[q]},{index:K.eyeOffset,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[F]},{index:K.scaleByDistance,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[j]},{index:K.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:a.FLOAT,usage:r[Y]},{index:K.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:a.FLOAT,usage:r[X]}];if(i){n.push({index:K.direction,componentsPerAttribute:2,componentDatatype:a.FLOAT,vertexBuffer:oe(e)})}var o=i?t:4*t;return new S(e,n,o,i)}var le=new d;function ue(e,r,i,n,a){var o;var s=n[K.positionHighAndScale];var l=n[K.positionLowAndRotation];var u=a._getActualPosition();if(e._mode===I.SCENE3D){t.expand(e._baseVolume,u,e._baseVolume);e._boundingVolumeDirty=true}d.fromCartesian(u,le);var c=a.scale;var f=a.rotation;if(f!==0){e._shaderRotation=true}e._maxScale=Math.max(e._maxScale,c);var h=le.high;var p=le.low;if(e._instanced){o=a._index;s(o,h.x,h.y,h.z,c);l(o,p.x,p.y,p.z,f)}else{o=a._index*4;s(o+0,h.x,h.y,h.z,c);s(o+1,h.x,h.y,h.z,c);s(o+2,h.x,h.y,h.z,c);s(o+3,h.x,h.y,h.z,c);l(o+0,p.x,p.y,p.z,f);l(o+1,p.x,p.y,p.z,f);l(o+2,p.x,p.y,p.z,f);l(o+3,p.x,p.y,p.z,f)}}var ce=new r;var de=32768;var fe=65536;var he=256;var pe=128;var me=32;var ve=8;var ge=4;var _e=1/256;var ye=0;var be=2;var we=3;var Ce=1;function Se(t,r,i,n,a){var o;var l=n[K.compressedAttribute0];var u=a.pixelOffset;var d=u.x;var f=u.y;var p=a._translate;var m=p.x;var v=p.y;t._maxPixelOffset=Math.max(t._maxPixelOffset,Math.abs(d+m),Math.abs(-f+v));var g=a.horizontalOrigin;var _=a._verticalOrigin;var y=a.show&&a.clusterShow;if(a.color.alpha===0){y=false}if(_===R.BASELINE){_=R.BOTTOM}t._allHorizontalCenter=t._allHorizontalCenter&&g===D.CENTER;t._allVerticalCenter=t._allVerticalCenter&&_===R.CENTER;var b=0;var w=0;var C=0;var S=0;var T=a._imageIndex;if(T!==-1){var E=i[T];if(!s(E)){throw new c("Invalid billboard image index: "+T)}b=E.x;w=E.y;C=E.width;S=E.height}var x=b+C;var P=w+S;var A=Math.floor(h.clamp(d,-de,de)+de)*pe;A+=(g+1)*me;A+=(_+1)*ve;A+=(y?1:0)*ge;var O=Math.floor(h.clamp(f,-de,de)+de)*he;var I=Math.floor(h.clamp(m,-de,de)+de)*he;var M=(h.clamp(v,-de,de)+de)*_e;var L=Math.floor(M);var N=Math.floor((M-L)*he);O+=L;I+=N;ce.x=b;ce.y=w;var k=e.compressTextureCoordinates(ce);ce.x=x;var F=e.compressTextureCoordinates(ce);ce.y=P;var B=e.compressTextureCoordinates(ce);ce.x=b;var U=e.compressTextureCoordinates(ce);if(t._instanced){o=a._index;l(o,A,O,I,k)}else{o=a._index*4;l(o+0,A+ye,O,I,k);l(o+1,A+be,O,I,F);l(o+2,A+we,O,I,B);l(o+3,A+Ce,O,I,U)}}function Te(t,r,n,a,l){var u;var d=a[K.compressedAttribute1];var f=l.alignedAxis;if(!i.equals(f,i.ZERO)){t._shaderAlignedAxis=true}var p=0;var m=1;var v=1;var g=1;var _=l.translucencyByDistance;if(s(_)){p=_.near;m=_.nearValue;v=_.far;g=_.farValue;if(m!==1||g!==1){t._shaderTranslucencyByDistance=true}}var y=0;var b=l._imageIndex;if(b!==-1){var w=n[b];if(!s(w)){throw new c("Invalid billboard image index: "+b)}y=w.width}var C=t._textureAtlas.texture.width;var S=Math.round(o(l.width,C*y));t._maxSize=Math.max(t._maxSize,S);var T=h.clamp(S,0,fe);var E=0;if(Math.abs(i.magnitudeSquared(f)-1)<h.EPSILON6){E=e.octEncodeFloat(f)}m=h.clamp(m,0,1);m=m===1?255:m*255|0;T=T*he+m;g=h.clamp(g,0,1);g=g===1?255:g*255|0;E=E*he+g;if(t._instanced){u=l._index;d(u,T,E,p,v)}else{u=l._index*4;d(u+0,T,E,p,v);d(u+1,T,E,p,v);d(u+2,T,E,p,v);d(u+3,T,E,p,v)}}function Ee(e,t,r,a,l){var u;var d=a[K.compressedAttribute2];var f=l.color;var p=l.getPickId(t).color;var m=l.sizeInMeters?1:0;var v=Math.abs(i.magnitudeSquared(l.alignedAxis)-1)<h.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&m===1;var g=0;var _=l._imageIndex;if(_!==-1){var y=r[_];if(!s(y)){throw new c("Invalid billboard image index: "+_)}g=y.height}var b=e._textureAtlas.texture.dimensions;var w=Math.round(o(l.height,b.y*g));e._maxSize=Math.max(e._maxSize,w);var C=n.floatToByte(f.red);var S=n.floatToByte(f.green);var T=n.floatToByte(f.blue);var E=C*fe+S*he+T;C=n.floatToByte(p.red);S=n.floatToByte(p.green);T=n.floatToByte(p.blue);var x=C*fe+S*he+T;var P=n.floatToByte(f.alpha)*fe+n.floatToByte(p.alpha)*he;P+=m*2+v;if(e._instanced){u=l._index;d(u,E,x,P,w)}else{u=l._index*4;d(u+0,E,x,P,w);d(u+1,E,x,P,w);d(u+2,E,x,P,w);d(u+3,E,x,P,w)}}function xe(t,r,i,n,a){var o;var l=n[K.eyeOffset];var u=a.eyeOffset;var d=u.z;if(a._heightReference!==O.NONE){d*=1.005}t._maxEyeOffset=Math.max(t._maxEyeOffset,Math.abs(u.x),Math.abs(u.y),Math.abs(d));if(t._instanced){var f=0;var h=0;var p=a._imageIndex;if(p!==-1){var m=i[p];if(!s(m)){throw new c("Invalid billboard image index: "+p)}f=m.width;h=m.height}ce.x=f;ce.y=h;var v=e.compressTextureCoordinates(ce);o=a._index;l(o,u.x,u.y,d,v)}else{o=a._index*4;l(o+0,u.x,u.y,d,0);l(o+1,u.x,u.y,d,0);l(o+2,u.x,u.y,d,0);l(o+3,u.x,u.y,d,0)}}function Pe(e,t,r,i,n){var a;var o=i[K.scaleByDistance];var l=0;var u=1;var c=1;var d=1;var f=n.scaleByDistance;if(s(f)){l=f.near;u=f.nearValue;c=f.far;d=f.farValue;if(u!==1||d!==1){e._shaderScaleByDistance=true}}if(e._instanced){a=n._index;o(a,l,u,c,d)}else{a=n._index*4;o(a+0,l,u,c,d);o(a+1,l,u,c,d);o(a+2,l,u,c,d);o(a+3,l,u,c,d)}}function Ae(e,t,r,i,n){var a;var o=i[K.pixelOffsetScaleByDistance];var l=0;var u=1;var c=1;var d=1;var f=n.pixelOffsetScaleByDistance;if(s(f)){l=f.near;u=f.nearValue;c=f.far;d=f.farValue;if(u!==1||d!==1){e._shaderPixelOffsetScaleByDistance=true}}if(e._instanced){a=n._index;o(a,l,u,c,d)}else{a=n._index*4;o(a+0,l,u,c,d);o(a+1,l,u,c,d);o(a+2,l,u,c,d);o(a+3,l,u,c,d)}}function Oe(e,t,r,i,n){var a;var o=i[K.distanceDisplayConditionAndDisableDepth];var l=0;var u=Number.MAX_VALUE;var c=n.distanceDisplayCondition;if(s(c)){l=c.near;u=c.far;l*=l;u*=u;e._shaderDistanceDisplayCondition=true}var d=n.disableDepthTestDistance;d*=d;if(d>0){e._shaderDisableDepthDistance=true;if(d===Number.POSITIVE_INFINITY){d=-1}}if(e._instanced){a=n._index;o(a,l,u,d)}else{a=n._index*4;o(a+0,l,u,d);o(a+1,l,u,d);o(a+2,l,u,d);o(a+3,l,u,d)}}function De(e,t,r,i,n){ue(e,t,r,i,n);Se(e,t,r,i,n);Te(e,t,r,i,n);Ee(e,t,r,i,n);xe(e,t,r,i,n);Pe(e,t,r,i,n);Ae(e,t,r,i,n);Oe(e,t,r,i,n)}function Ie(e,r,i,n,a,o){var l;if(n.mode===I.SCENE3D){l=e._baseVolume;e._boundingVolumeDirty=true}else{l=e._baseVolume2D}var u=[];for(var c=0;c<i;++c){var d=r[c];var f=d.position;var h=x._computeActualPosition(d,f,n,a);if(s(h)){d._setActualPosition(h);if(o){u.push(h)}else{t.expand(l,h,l)}}}if(o){t.fromPoints(u,l)}}function Me(e,t){var r=t.mode;var i=e._billboards;var n=e._billboardsToUpdate;var a=e._modelMatrix;if(e._createVertexArray||e._mode!==r||r!==I.SCENE3D&&!p.equals(a,e.modelMatrix)){e._mode=r;p.clone(e.modelMatrix,a);e._createVertexArray=true;if(r===I.SCENE3D||r===I.SCENE2D||r===I.COLUMBUS_VIEW){Ie(e,i,i.length,t,a,true)}}else if(r===I.MORPHING){Ie(e,i,i.length,t,a,true)}else if(r===I.SCENE2D||r===I.COLUMBUS_VIEW){Ie(e,n,e._billboardsToUpdateIndex,t,a,false)}}function Re(e,t,r){var i=1;if(!e._allSizedInMeters||e._maxPixelOffset!==0){i=t.camera.getPixelSize(r,t.context.drawingBufferWidth,t.context.drawingBufferHeight)}var n=i*e._maxScale*e._maxSize*2;if(e._allHorizontalCenter&&e._allVerticalCenter){n*=.5}var a=i*e._maxPixelOffset+e._maxEyeOffset;r.radius+=n+a}var Le=[];ee.prototype.update=function(e){re(this);var r=this._billboards;var i=r.length;var n=e.context;this._instanced=n.instancedArrays;K=this._instanced?$:J;ie=this._instanced?ae:ne;var a=this._textureAtlas;if(!s(a)){a=this._textureAtlas=new M({context:n});for(var o=0;o<i;++o){r[o]._loadImage()}}var l=a.textureCoordinates;if(l.length===0){return}Me(this,e);r=this._billboards;i=r.length;var u=this._billboardsToUpdate;var c=this._billboardsToUpdateIndex;var d=this._propertiesChanged;var f=a.guid;var h=this._createVertexArray||this._textureAtlasGUID!==f;this._textureAtlasGUID=f;var v;var g=e.passes;var S=g.pick;if(h||!S&&this.computeNewBuffersUsage()){this._createVertexArray=false;for(var x=0;x<Z;++x){d[x]=0}this._vaf=this._vaf&&this._vaf.destroy();if(i>0){this._vaf=se(n,i,this._buffersUsage,this._instanced);v=this._vaf.writers;for(var O=0;O<i;++O){var D=this._billboards[O];D._dirty=false;De(this,n,l,v,D)}this._vaf.commit(ie(n))}this._billboardsToUpdateIndex=0}else if(c>0){var R=Le;R.length=0;if(d[N]||d[G]||d[V]){R.push(ue)}if(d[z]||d[k]||d[B]||d[U]||d[L]){R.push(Se);if(this._instanced){R.push(xe)}}if(d[z]||d[H]||d[W]){R.push(Te);R.push(Ee)}if(d[z]||d[q]){R.push(Ee)}if(d[F]){R.push(xe)}if(d[j]){R.push(Pe)}if(d[Y]){R.push(Ae)}if(d[X]||d[Q]){R.push(Oe)}var ee=R.length;v=this._vaf.writers;if(c/i>.1){for(var te=0;te<c;++te){var oe=u[te];oe._dirty=false;for(var le=0;le<ee;++le){R[le](this,n,l,v,oe)}}this._vaf.commit(ie(n))}else{for(var ce=0;ce<c;++ce){var de=u[ce];de._dirty=false;for(var fe=0;fe<ee;++fe){R[fe](this,n,l,v,de)}if(this._instanced){this._vaf.subCommit(de._index,1)}else{this._vaf.subCommit(de._index*4,4)}}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(c>i*1.5){u.length=i}if(!s(this._vaf)||!s(this._vaf.va)){return}if(this._boundingVolumeDirty){this._boundingVolumeDirty=false;t.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC)}var he;var pe=p.IDENTITY;if(e.mode===I.SCENE3D){pe=this.modelMatrix;he=t.clone(this._baseVolumeWC,this._boundingVolume)}else{he=t.clone(this._baseVolume2D,this._boundingVolume)}Re(this,e,he);var me=this._blendOption!==this.blendOption;this._blendOption=this.blendOption;if(me){if(this._blendOption===A.OPAQUE||this._blendOption===A.OPAQUE_AND_TRANSLUCENT){this._rsOpaque=b.fromCache({depthTest:{enabled:true,func:m.LESS},depthMask:true})}else{this._rsOpaque=undefined}var ve=this._blendOption===A.TRANSLUCENT;if(this._blendOption===A.TRANSLUCENT||this._blendOption===A.OPAQUE_AND_TRANSLUCENT){this._rsTranslucent=b.fromCache({depthTest:{enabled:true,func:ve?m.LEQUAL:m.LESS},depthMask:ve,blending:P.ALPHA_BLEND})}else{this._rsTranslucent=undefined}}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;var ge;var _e;if(me||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance){ge=new C({sources:[E]});if(this._instanced){ge.defines.push("INSTANCED")}if(this._shaderRotation){ge.defines.push("ROTATION")}if(this._shaderAlignedAxis){ge.defines.push("ALIGNED_AXIS")}if(this._shaderScaleByDistance){ge.defines.push("EYE_DISTANCE_SCALING")}if(this._shaderTranslucencyByDistance){ge.defines.push("EYE_DISTANCE_TRANSLUCENCY")}if(this._shaderPixelOffsetScaleByDistance){ge.defines.push("EYE_DISTANCE_PIXEL_OFFSET")}if(this._shaderDistanceDisplayCondition){ge.defines.push("DISTANCE_DISPLAY_CONDITION")}if(this._shaderDisableDepthDistance){ge.defines.push("DISABLE_DEPTH_DISTANCE")}if(this._blendOption===A.OPAQUE_AND_TRANSLUCENT){_e=new C({defines:["OPAQUE"],sources:[T]});this._sp=w.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:ge,fragmentShaderSource:_e,attributeLocations:K});_e=new C({defines:["TRANSLUCENT"],sources:[T]});this._spTranslucent=w.replaceCache({context:n,shaderProgram:this._spTranslucent,vertexShaderSource:ge,fragmentShaderSource:_e,attributeLocations:K})}if(this._blendOption===A.OPAQUE){_e=new C({sources:[T]});this._sp=w.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:ge,fragmentShaderSource:_e,attributeLocations:K})}if(this._blendOption===A.TRANSLUCENT){_e=new C({sources:[T]});this._spTranslucent=w.replaceCache({context:n,shaderProgram:this._spTranslucent,vertexShaderSource:ge,fragmentShaderSource:_e,attributeLocations:K})}this._compiledShaderRotation=this._shaderRotation;this._compiledShaderAlignedAxis=this._shaderAlignedAxis;this._compiledShaderScaleByDistance=this._shaderScaleByDistance;this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance;this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance;this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition;this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance}if(!s(this._spPick)||this._shaderRotation!==this._compiledShaderRotationPick||this._shaderAlignedAxis!==this._compiledShaderAlignedAxisPick||this._shaderScaleByDistance!==this._compiledShaderScaleByDistancePick||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistancePick||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistancePick||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayConditionPick||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistancePick){ge=new C({defines:["RENDER_FOR_PICK"],sources:[E]});if(this._instanced){ge.defines.push("INSTANCED")}if(this._shaderRotation){ge.defines.push("ROTATION")}if(this._shaderAlignedAxis){ge.defines.push("ALIGNED_AXIS")}if(this._shaderScaleByDistance){ge.defines.push("EYE_DISTANCE_SCALING")}if(this._shaderTranslucencyByDistance){ge.defines.push("EYE_DISTANCE_TRANSLUCENCY")}if(this._shaderPixelOffsetScaleByDistance){ge.defines.push("EYE_DISTANCE_PIXEL_OFFSET")}if(this._shaderDistanceDisplayCondition){ge.defines.push("DISTANCE_DISPLAY_CONDITION")}if(this._shaderDisableDepthDistance){ge.defines.push("DISABLE_DEPTH_DISTANCE")}_e=new C({defines:["RENDER_FOR_PICK"],sources:[T]});this._spPick=w.replaceCache({context:n,shaderProgram:this._spPick,vertexShaderSource:ge,fragmentShaderSource:_e,attributeLocations:K});this._compiledShaderRotationPick=this._shaderRotation;this._compiledShaderAlignedAxisPick=this._shaderAlignedAxis;this._compiledShaderScaleByDistancePick=this._shaderScaleByDistance;this._compiledShaderTranslucencyByDistancePick=this._shaderTranslucencyByDistance;this._compiledShaderPixelOffsetScaleByDistancePick=this._shaderPixelOffsetScaleByDistance;this._compiledShaderDistanceDisplayConditionPick=this._shaderDistanceDisplayCondition;this._compiledShaderDisableDepthDistancePick=this._shaderDisableDepthDistance}var ye;var be;var we;var Ce;var Ie=e.commandList;if(g.render){var Ne=this._colorCommands;var ke=this._blendOption===A.OPAQUE;var Fe=this._blendOption===A.OPAQUE_AND_TRANSLUCENT;ye=this._vaf.va;be=ye.length;Ne.length=be;var Be=Fe?be*2:be;for(Ce=0;Ce<Be;++Ce){we=Ne[Ce];if(!s(we)){we=Ne[Ce]=new _}var Ue=ke||Fe&&Ce%2===0;we.pass=Ue||!Fe?y.OPAQUE:y.TRANSLUCENT;we.owner=this;var Ve=Fe?Math.floor(Ce/2):Ce;we.boundingVolume=he;we.modelMatrix=pe;we.count=ye[Ve].indicesCount;we.shaderProgram=Ue?this._sp:this._spTranslucent;we.uniformMap=this._uniforms;we.vertexArray=ye[Ve].va;we.renderState=Ue?this._rsOpaque:this._rsTranslucent;we.debugShowBoundingVolume=this.debugShowBoundingVolume;if(this._instanced){we.count=6;we.instanceCount=i}Ie.push(we)}}if(S){var ze=this._pickCommands;ye=this._vaf.va;be=ye.length;ze.length=be;for(Ce=0;Ce<be;++Ce){we=ze[Ce];if(!s(we)){we=ze[Ce]=new _({pass:y.OPAQUE,owner:this})}we.boundingVolume=he;we.modelMatrix=pe;we.count=ye[Ce].indicesCount;we.shaderProgram=this._spPick;we.uniformMap=this._uniforms;we.vertexArray=ye[Ce].va;we.renderState=this._rsOpaque;if(this._instanced){we.count=6;we.instanceCount=i}Ie.push(we)}}};ee.prototype.isDestroyed=function(){return false};ee.prototype.destroy=function(){if(s(this._removeCallbackFunc)){this._removeCallbackFunc();this._removeCallbackFunc=undefined}this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy();this._sp=this._sp&&this._sp.destroy();this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy();this._spPick=this._spPick&&this._spPick.destroy();this._vaf=this._vaf&&this._vaf.destroy();te(this._billboards);return u(this)};return ee});define("Scene/LabelStyle",["../Core/freezeObject"],function(e){"use strict";var t={FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2};return e(t)});define("Scene/Label",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","./Billboard","./HeightReference","./HorizontalOrigin","./LabelStyle","./VerticalOrigin"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";function m(e){if(!e._rebindAllGlyphs&&!e._repositionAllGlyphs){e._labelCollection._labelsToUpdate.push(e)}e._rebindAllGlyphs=true}function v(e){if(!e._rebindAllGlyphs&&!e._repositionAllGlyphs){e._labelCollection._labelsToUpdate.push(e)}e._repositionAllGlyphs=true}function g(e,o){e=n(e,n.EMPTY_OBJECT);if(a(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0){throw new s("disableDepthTestDistance must be greater than 0.0.")}var c=e.translucencyByDistance;var m=e.pixelOffsetScaleByDistance;var v=e.scaleByDistance;var g=e.distanceDisplayCondition;if(a(c)){if(c.far<=c.near){throw new s("translucencyByDistance.far must be greater than translucencyByDistance.near.")}c=u.clone(c)}if(a(m)){if(m.far<=m.near){throw new s("pixelOffsetScaleByDistance.far must be greater than pixelOffsetScaleByDistance.near.")}m=u.clone(m)}if(a(v)){if(v.far<=v.near){throw new s("scaleByDistance.far must be greater than scaleByDistance.near.")}v=u.clone(v)}if(a(g)){if(g.far<=g.near){throw new s("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.")}g=l.clone(g)}this._text=n(e.text,"");this._show=n(e.show,true);this._font=n(e.font,"30px sans-serif");this._fillColor=i.clone(n(e.fillColor,i.WHITE));this._outlineColor=i.clone(n(e.outlineColor,i.BLACK));this._outlineWidth=n(e.outlineWidth,1);this._showBackground=n(e.showBackground,false);this._backgroundColor=n(e.backgroundColor,new i(.165,.165,.165,.8));this._backgroundPadding=n(e.backgroundPadding,new t(7,5));this._style=n(e.style,h.FILL);this._verticalOrigin=n(e.verticalOrigin,p.BASELINE);this._horizontalOrigin=n(e.horizontalOrigin,f.LEFT);this._pixelOffset=t.clone(n(e.pixelOffset,t.ZERO));this._eyeOffset=r.clone(n(e.eyeOffset,r.ZERO));this._position=r.clone(n(e.position,r.ZERO));this._scale=n(e.scale,1);this._id=e.id;this._translucencyByDistance=c;this._pixelOffsetScaleByDistance=m;this._scaleByDistance=v;this._heightReference=n(e.heightReference,d.NONE);this._distanceDisplayCondition=g;this._disableDepthTestDistance=n(e.disableDepthTestDistance,0);this._labelCollection=o;this._glyphs=[];this._backgroundBillboard=undefined;this._rebindAllGlyphs=true;this._repositionAllGlyphs=true;this._actualClampedPosition=undefined;this._removeCallbackFunc=undefined;this._mode=undefined;this._clusterShow=true;this._updateClamping()}o(g.prototype,{show:{get:function(){return this._show},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._show!==e){this._show=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r].billboard;if(a(n)){n.show=e}}var o=this._backgroundBillboard;if(a(o)){o.show=e}}}},position:{get:function(){return this._position},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._position;if(!r.equals(t,e)){r.clone(e,t);var i=this._glyphs;for(var n=0,o=i.length;n<o;n++){var l=i[n].billboard;if(a(l)){l.position=e}}var u=this._backgroundBillboard;if(a(u)){u.position=e}this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(!a(e)){throw new s("value is required.")}if(e!==this._heightReference){this._heightReference=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r].billboard;if(a(n)){n.heightReference=e}}var o=this._backgroundBillboard;if(a(o)){o.heightReference=e}v(this);this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._text!==e){this._text=e;m(this)}}},font:{get:function(){return this._font},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._font!==e){this._font=e;m(this)}}},fillColor:{get:function(){return this._fillColor},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._fillColor;if(!i.equals(t,e)){i.clone(e,t);m(this)}}},outlineColor:{get:function(){return this._outlineColor},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._outlineColor;if(!i.equals(t,e)){i.clone(e,t);m(this)}}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._outlineWidth!==e){this._outlineWidth=e;m(this)}}},showBackground:{get:function(){return this._showBackground},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._showBackground!==e){this._showBackground=e;m(this)}}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._backgroundColor;if(!i.equals(t,e)){i.clone(e,t);var r=this._backgroundBillboard;if(a(r)){r.color=t}}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){if(!a(e)){throw new s("value is required.")}var r=this._backgroundPadding;if(!t.equals(r,e)){t.clone(e,r);v(this)}}},style:{get:function(){return this._style},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._style!==e){this._style=e;m(this)}}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){if(!a(e)){throw new s("value is required.")}var r=this._pixelOffset;if(!t.equals(r,e)){t.clone(e,r);var i=this._glyphs;for(var n=0,o=i.length;n<o;n++){var l=i[n];if(a(l.billboard)){l.billboard.pixelOffset=e}}var u=this._backgroundBillboard;if(a(u)){u.pixelOffset=e}}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far distance must be greater than near distance.")}var t=this._translucencyByDistance;if(!u.equals(t,e)){this._translucencyByDistance=u.clone(e,t);var r=this._glyphs;for(var i=0,n=r.length;i<n;i++){var o=r[i];if(a(o.billboard)){o.billboard.translucencyByDistance=e}}var l=this._backgroundBillboard;if(a(l)){l.translucencyByDistance=e}}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far distance must be greater than near distance.")}var t=this._pixelOffsetScaleByDistance;if(!u.equals(t,e)){this._pixelOffsetScaleByDistance=u.clone(e,t);var r=this._glyphs;for(var i=0,n=r.length;i<n;i++){var o=r[i];if(a(o.billboard)){o.billboard.pixelOffsetScaleByDistance=e}}var l=this._backgroundBillboard;if(a(l)){l.pixelOffsetScaleByDistance=e}}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far distance must be greater than near distance.")}var t=this._scaleByDistance;if(!u.equals(t,e)){this._scaleByDistance=u.clone(e,t);var r=this._glyphs;for(var i=0,n=r.length;i<n;i++){var o=r[i];if(a(o.billboard)){o.billboard.scaleByDistance=e}}var l=this._backgroundBillboard;if(a(l)){l.scaleByDistance=e}}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._eyeOffset;if(!r.equals(t,e)){r.clone(e,t);var i=this._glyphs;for(var n=0,o=i.length;n<o;n++){var l=i[n];if(a(l.billboard)){l.billboard.eyeOffset=e}}var u=this._backgroundBillboard;if(a(u)){u.eyeOffset=e}}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._horizontalOrigin!==e){this._horizontalOrigin=e;v(this)}}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._verticalOrigin!==e){this._verticalOrigin=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.verticalOrigin=e}}var o=this._backgroundBillboard;if(a(o)){o.verticalOrigin=e}v(this)}}},scale:{get:function(){return this._scale},set:function(e){if(!a(e)){throw new s("value is required.")}if(this._scale!==e){this._scale=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.scale=e}}var o=this._backgroundBillboard;if(a(o)){o.scale=e}v(this)}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far must be greater than near")}if(!l.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=l.clone(e,this._distanceDisplayCondition);var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.distanceDisplayCondition=e}}var o=this._backgroundBillboard;if(a(o)){o.distanceDisplayCondition=e}}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if(!a(e)||e<0){throw new s("disableDepthTestDistance must be greater than 0.0.")}this._disableDepthTestDistance=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.disableDepthTestDistance=e}}var o=this._backgroundBillboard;if(a(o)){o.disableDepthTestDistance=e}}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.id=e}}var o=this._backgroundBillboard;if(a(o)){o.id=e}}}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=r.clone(e,this._actualClampedPosition);var t=this._glyphs;for(var i=0,n=t.length;i<n;i++){var o=t[i];if(a(o.billboard)){o.billboard._clampedPosition=e}}var s=this._backgroundBillboard;if(a(s)){s._clampedPosition=e}}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;var t=this._glyphs;for(var r=0,i=t.length;r<i;r++){var n=t[r];if(a(n.billboard)){n.billboard.clusterShow=e}}var o=this._backgroundBillboard;if(a(o)){o.clusterShow=e}}}}});g.prototype._updateClamping=function(){c._updateClamping(this._labelCollection,this)};g.prototype.computeScreenSpacePosition=function(e,r){if(!a(e)){throw new s("scene is required.")}if(!a(r)){r=new t}var i=this._labelCollection;var n=i.modelMatrix;var o=a(this._actualClampedPosition)?this._actualClampedPosition:this._position;var l=c._computeScreenSpacePosition(n,o,this._eyeOffset,this._pixelOffset,e,r);return l};g.getScreenSpaceBoundingBox=function(t,r,i){var n=0;var o=0;var s=0;var l=0;var u=t.scale;var c=t._labelCollection._resolutionScale;var d=t._backgroundBillboard;if(a(d)){n=r.x+d._translate.x/c;o=r.y-d._translate.y/c;s=d.width*u;l=d.height*u;if(t.verticalOrigin===p.BOTTOM||t.verticalOrigin===p.BASELINE){o-=l}else if(t.verticalOrigin===p.CENTER){o-=l*.5}}else{n=Number.POSITIVE_INFINITY;o=Number.POSITIVE_INFINITY;var f=0;var h=0;var m=t._glyphs;var v=m.length;for(var g=0;g<v;++g){var _=m[g];var y=_.billboard;if(!a(y)){continue}var b=r.x+y._translate.x/c;var w=r.y-y._translate.y/c;var C=y.width*u;var S=y.height*u;if(t.verticalOrigin===p.BOTTOM||t.verticalOrigin===p.BASELINE){w-=S}else if(t.verticalOrigin===p.CENTER){w-=S*.5}n=Math.min(n,b);o=Math.min(o,w);f=Math.max(f,b+C);h=Math.max(h,w+S)}s=f-n;l=h-o}if(!a(i)){i=new e}i.x=n;i.y=o;i.width=s;i.height=l;return i};g.prototype.equals=function(e){return this===e||a(e)&&this._show===e._show&&this._scale===e._scale&&this._outlineWidth===e._outlineWidth&&this._showBackground===e._showBackground&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._text===e._text&&this._font===e._font&&r.equals(this._position,e._position)&&i.equals(this._fillColor,e._fillColor)&&i.equals(this._outlineColor,e._outlineColor)&&i.equals(this._backgroundColor,e._backgroundColor)&&t.equals(this._backgroundPadding,e._backgroundPadding)&&t.equals(this._pixelOffset,e._pixelOffset)&&r.equals(this._eyeOffset,e._eyeOffset)&&u.equals(this._translucencyByDistance,e._translucencyByDistance)&&u.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&u.equals(this._scaleByDistance,e._scaleByDistance)&&l.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._id===e._id};g.prototype.isDestroyed=function(){return false};return g});define("Scene/LabelCollection",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/writeTextToCanvas","./BillboardCollection","./BlendOption","./HorizontalOrigin","./Label","./LabelStyle","./TextureAtlas","./VerticalOrigin"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m){"use strict";function v(){this.textureInfo=undefined;this.dimensions=undefined;this.billboard=undefined}function g(e,t,r){this.labelCollection=e;this.index=t;this.dimensions=r}var _=1.2;var y="ID_WHITE_PIXEL";var b=new t(4,4);var w=new e(1,1,1,1);function C(e,t){var r=document.createElement("canvas");r.width=b.x;r.height=b.y;var i=r.getContext("2d");i.fillStyle="#fff";i.fillRect(0,0,r.width,r.height);e.addImage(y,r).then(function(e){t._whitePixelIndex=e})}var S={};function T(e,t,r,i,n,a,o){S.font=t;S.fillColor=r;S.strokeColor=i;S.strokeWidth=n;if(o===m.CENTER){S.textBaseline="middle"}else if(o===m.TOP){S.textBaseline="top"}else{S.textBaseline="bottom"}S.fill=a===h.FILL||a===h.FILL_AND_OUTLINE;S.stroke=a===h.OUTLINE||a===h.FILL_AND_OUTLINE;return l(e,S)}function E(e,t){t.textureInfo=undefined;t.dimensions=undefined;var r=t.billboard;if(i(r)){r.show=false;r.image=undefined;if(i(r._removeCallbackFunc)){r._removeCallbackFunc();r._removeCallbackFunc=undefined}e._spareBillboards.push(r);t.billboard=undefined}}function x(e,t,r,i){e.addImage(t,r).then(function(e,t){i.index=e})}function P(e,t){var r=t._text;var n=r.length;var a=t._glyphs;var o=a.length;var s;var l;var u;if(n<o){for(l=n;l<o;++l){E(e,a[l])}}a.length=n;var c=t._showBackground&&r.split("\n").join("").length>0;var f=t._backgroundBillboard;var h=e._backgroundBillboardCollection;if(!c){if(i(f)){h.remove(f);t._backgroundBillboard=f=undefined}}else{if(!i(f)){f=h.add({collection:e,image:y,imageSubRegion:w});t._backgroundBillboard=f}f.color=t._backgroundColor;f.show=t._show;f.position=t._position;f.eyeOffset=t._eyeOffset;f.pixelOffset=t._pixelOffset;f.horizontalOrigin=d.LEFT;f.verticalOrigin=t._verticalOrigin;f.heightReference=t._heightReference;f.scale=t._scale;f.pickPrimitive=t;f.id=t._id;f.translucencyByDistance=t._translucencyByDistance;f.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance;f.scaleByDistance=t._scaleByDistance;f.distanceDisplayCondition=t._distanceDisplayCondition;f.disableDepthTestDistance=t._disableDepthTestDistance}var p=e._glyphTextureCache;for(u=0;u<n;++u){var m=r.charAt(u);var _=t._font;var b=t._fillColor;var C=t._outlineColor;var S=t._outlineWidth;var P=t._style;var A=t._verticalOrigin;var O=JSON.stringify([m,_,b.toRgba(),C.toRgba(),S,+P,+A]);var D=p[O];if(!i(D)){var I=T(m,_,b,C,S,P,A);D=new g(e,-1,I.dimensions);p[O]=D;if(I.width>0&&I.height>0){x(e._textureAtlas,O,I,D)}}s=a[u];if(i(s)){if(D.index===-1){E(e,s)}else if(i(s.textureInfo)){s.textureInfo=undefined}}else{s=new v;a[u]=s}s.textureInfo=D;s.dimensions=D.dimensions;if(D.index!==-1){var M=s.billboard;var R=e._spareBillboards;if(!i(M)){if(R.length>0){M=R.pop()}else{M=e._billboardCollection.add({collection:e})}s.billboard=M}M.show=t._show;M.position=t._position;M.eyeOffset=t._eyeOffset;M.pixelOffset=t._pixelOffset;M.horizontalOrigin=d.LEFT;M.verticalOrigin=t._verticalOrigin;M.heightReference=t._heightReference;M.scale=t._scale;M.pickPrimitive=t;M.id=t._id;M.image=O;M.translucencyByDistance=t._translucencyByDistance;M.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance;M.scaleByDistance=t._scaleByDistance;M.distanceDisplayCondition=t._distanceDisplayCondition;M.disableDepthTestDistance=t._disableDepthTestDistance}}t._repositionAllGlyphs=true}function A(e,t,r){if(t===d.CENTER){return-e/2}else if(t===d.RIGHT){return-(e+r.x)}return r.x}var O=new t;var D=new t;function I(e,r){var n=e._glyphs;var a=e._text;var o;var s;var l=0;var u=0;var c=[];var f=Number.NEGATIVE_INFINITY;var h=0;var p=1;var v=0;var g=n.length;var y=e._backgroundBillboard;var b=D;t.clone(i(y)?e._backgroundPadding:t.ZERO,b);for(v=0;v<g;++v){if(a.charAt(v)==="\n"){c.push(l);++p;l=0}else{o=n[v];s=o.dimensions;h=Math.max(h,s.height-s.descent);f=Math.max(f,s.descent);l+=s.width-s.bounds.minx;if(v<g-1){l+=n[v+1].dimensions.bounds.minx}u=Math.max(u,l)}}c.push(l);var w=h+f;var C=e._scale;var S=e._horizontalOrigin;var T=e._verticalOrigin;var E=0;var x=c[E];var P=A(x,S,b);var I=_*w;var M=I*(p-1);O.x=P*C*r;O.y=0;var R=0;for(v=0;v<g;++v){if(a.charAt(v)==="\n"){++E;R+=I;x=c[E];P=A(x,S,b);O.x=P*C*r}else{o=n[v];s=o.dimensions;if(T===m.TOP){O.y=s.height-h-b.y}else if(T===m.CENTER){O.y=(M+s.height-h)/2}else if(T===m.BASELINE){O.y=M}else{O.y=M+f+b.y}O.y=(O.y-s.descent-R)*C*r;if(i(o.billboard)){o.billboard._setTranslate(O)}if(v<g-1){var L=n[v+1];O.x+=(s.width-s.bounds.minx+L.dimensions.bounds.minx)*C*r}}}if(i(y)&&a.split("\n").join("").length>0){if(S===d.CENTER){P=-u/2-b.x}else if(S===d.RIGHT){P=-(u+b.x*2)}else{P=0}O.x=P*C*r;if(T===m.TOP){O.y=w-h-f}else if(T===m.CENTER){O.y=(w-h)/2-f}else if(T===m.BASELINE){O.y=-b.y-f}else{O.y=0}O.y=O.y*C*r;y.width=u+b.x*2;y.height=w+M+b.y*2;y._setTranslate(O)}}function M(e,t){var r=t._glyphs;for(var n=0,o=r.length;n<o;++n){E(e,r[n])}if(i(t._backgroundBillboard)){e._backgroundBillboardCollection.remove(t._backgroundBillboard);t._backgroundBillboard=undefined}t._labelCollection=undefined;if(i(t._removeCallbackFunc)){t._removeCallbackFunc()}a(t)}function R(e){e=r(e,r.EMPTY_OBJECT);this._scene=e.scene;this._textureAtlas=undefined;this._backgroundTextureAtlas=undefined;this._whitePixelIndex=undefined;this._backgroundBillboardCollection=new u({scene:this._scene});this._backgroundBillboardCollection.destroyTextureAtlas=false;this._billboardCollection=new u({scene:this._scene});this._billboardCollection.destroyTextureAtlas=false;this._spareBillboards=[];this._glyphTextureCache={};this._labels=[];this._labelsToUpdate=[];this._totalGlyphCount=0;this._resolutionScale=undefined;this.modelMatrix=s.clone(r(e.modelMatrix,s.IDENTITY));this.debugShowBoundingVolume=r(e.debugShowBoundingVolume,false);this.blendOption=r(e.blendOption,c.OPAQUE_AND_TRANSLUCENT)}n(R.prototype,{length:{get:function(){return this._labels.length}}});R.prototype.add=function(e){var t=new f(e,this);this._labels.push(t);this._labelsToUpdate.push(t);return t};R.prototype.remove=function(e){if(i(e)&&e._labelCollection===this){var t=this._labels.indexOf(e);if(t!==-1){this._labels.splice(t,1);M(this,e);return true}}return false};R.prototype.removeAll=function(){var e=this._labels;for(var t=0,r=e.length;t<r;++t){M(this,e[t])}e.length=0};R.prototype.contains=function(e){return i(e)&&e._labelCollection===this};R.prototype.get=function(e){if(!i(e)){throw new o("index is required.")}return this._labels[e]};R.prototype.update=function(e){var t=this._billboardCollection;var r=this._backgroundBillboardCollection;t.modelMatrix=this.modelMatrix;t.debugShowBoundingVolume=this.debugShowBoundingVolume;r.modelMatrix=this.modelMatrix;r.debugShowBoundingVolume=this.debugShowBoundingVolume;var n=e.context;if(!i(this._textureAtlas)){this._textureAtlas=new p({context:n});t.textureAtlas=this._textureAtlas}if(!i(this._backgroundTextureAtlas)){this._backgroundTextureAtlas=new p({context:n,initialSize:b});r.textureAtlas=this._backgroundTextureAtlas;C(this._backgroundTextureAtlas,this)}var a=n.uniformState;var o=a.resolutionScale;var s=this._resolutionScale!==o;this._resolutionScale=o;var l;if(s){l=this._labels}else{l=this._labelsToUpdate}var u=l.length;for(var d=0;d<u;++d){var f=l[d];if(f.isDestroyed()){continue}var h=f._glyphs.length;if(f._rebindAllGlyphs){P(this,f);f._rebindAllGlyphs=false}if(s||f._repositionAllGlyphs){I(f,o);f._repositionAllGlyphs=false}var m=f._glyphs.length-h;this._totalGlyphCount+=m}var v=r.length>0?c.TRANSLUCENT:this.blendOption;t.blendOption=v;r.blendOption=v;this._labelsToUpdate.length=0;r.update(e);t.update(e)};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this.removeAll();this._billboardCollection=this._billboardCollection.destroy();this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy();this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy();this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy();return a(this)};return R});define("Scene/PointPrimitive",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/NearFarScalar","./SceneMode","./SceneTransforms"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";function p(e,t){e=a(e,a.EMPTY_OBJECT);if(o(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0){throw new l("disableDepthTestDistance must be greater than or equal to 0.0.")}var i=e.translucencyByDistance;var s=e.scaleByDistance;var c=e.distanceDisplayCondition;if(o(i)){if(i.far<=i.near){throw new l("translucencyByDistance.far must be greater than translucencyByDistance.near.")}i=d.clone(i)}if(o(s)){if(s.far<=s.near){throw new l("scaleByDistance.far must be greater than scaleByDistance.near.")}s=d.clone(s)}if(o(c)){if(c.far<=c.near){throw new l("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.")}c=u.clone(c)}this._show=a(e.show,true);this._position=r.clone(a(e.position,r.ZERO));this._actualPosition=r.clone(this._position);this._color=n.clone(a(e.color,n.WHITE));this._outlineColor=n.clone(a(e.outlineColor,n.TRANSPARENT));this._outlineWidth=a(e.outlineWidth,0);this._pixelSize=a(e.pixelSize,10);this._scaleByDistance=s;this._translucencyByDistance=i;this._distanceDisplayCondition=c;this._disableDepthTestDistance=a(e.disableDepthTestDistance,0);this._id=e.id;this._collection=a(e.collection,t);this._clusterShow=true;this._pickId=undefined;this._pointPrimitiveCollection=t;this._dirty=false;this._index=-1}var m=p.SHOW_INDEX=0;var v=p.POSITION_INDEX=1;var g=p.COLOR_INDEX=2;var _=p.OUTLINE_COLOR_INDEX=3;var y=p.OUTLINE_WIDTH_INDEX=4;var b=p.PIXEL_SIZE_INDEX=5;var w=p.SCALE_BY_DISTANCE_INDEX=6;var C=p.TRANSLUCENCY_BY_DISTANCE_INDEX=7;var S=p.DISTANCE_DISPLAY_CONDITION_INDEX=8;var T=p.DISABLE_DEPTH_DISTANCE_INDEX=9;p.NUMBER_OF_PROPERTIES=10;function E(e,t){var r=e._pointPrimitiveCollection;if(o(r)){r._updatePointPrimitive(e,t);e._dirty=true}}s(p.prototype,{show:{get:function(){return this._show},set:function(e){if(!o(e)){throw new l("value is required.")}if(this._show!==e){this._show=e;E(this,m)}}},position:{get:function(){return this._position},set:function(e){if(!o(e)){throw new l("value is required.")}var t=this._position;if(!r.equals(t,e)){r.clone(e,t);r.clone(e,this._actualPosition);E(this,v)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(o(e)&&e.far<=e.near){throw new l("far distance must be greater than near distance.")}var t=this._scaleByDistance;if(!d.equals(t,e)){this._scaleByDistance=d.clone(e,t);E(this,w)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(o(e)&&e.far<=e.near){throw new l("far distance must be greater than near distance.")}var t=this._translucencyByDistance;if(!d.equals(t,e)){this._translucencyByDistance=d.clone(e,t);E(this,C)}}},pixelSize:{get:function(){return this._pixelSize},set:function(e){if(!o(e)){throw new l("value is required.")}if(this._pixelSize!==e){this._pixelSize=e;E(this,b)}}},color:{get:function(){return this._color},set:function(e){if(!o(e)){throw new l("value is required.")}var t=this._color;if(!n.equals(t,e)){n.clone(e,t);E(this,g)}}},outlineColor:{get:function(){return this._outlineColor},set:function(e){if(!o(e)){throw new l("value is required.")}var t=this._outlineColor;if(!n.equals(t,e)){n.clone(e,t);E(this,_)}}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){if(!o(e)){throw new l("value is required.")}if(this._outlineWidth!==e){this._outlineWidth=e;E(this,y)}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(o(e)&&e.far<=e.near){throw new l("far must be greater than near")}if(!u.equals(this._distanceDisplayCondition,e)){this._distanceDisplayCondition=u.clone(e,this._distanceDisplayCondition);E(this,S)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if(!o(e)||e<0){throw new l("disableDepthTestDistance must be greater than or equal to 0.0.")}this._disableDepthTestDistance=e;E(this,T)}}},id:{get:function(){return this._id},set:function(e){this._id=e;if(o(this._pickId)){this._pickId.object.id=e}}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;E(this,m)}}}});p.prototype.getPickId=function(e){if(!o(this._pickId)){this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})}return this._pickId};p.prototype._getActualPosition=function(){return this._actualPosition};p.prototype._setActualPosition=function(e){r.clone(e,this._actualPosition);E(this,v)};var x=new i;p._computeActualPosition=function(e,t,r){if(t.mode===f.SCENE3D){return e}c.multiplyByPoint(r,e,x);return h.computeActualWgs84Position(t,x)};var P=new i;p._computeScreenSpacePosition=function(e,t,r,n){var a=c.multiplyByVector(e,i.fromElements(t.x,t.y,t.z,1,P),P);var o=h.wgs84ToWindowCoordinates(r,a,n);return o};p.prototype.computeScreenSpacePosition=function(e,r){var i=this._pointPrimitiveCollection;if(!o(r)){r=new t}if(!o(i)){throw new l("PointPrimitive must be in a collection.")}if(!o(e)){throw new l("scene is required.")}var n=i.modelMatrix;var a=p._computeScreenSpacePosition(n,this._actualPosition,e,r);if(!o(a)){return undefined}a.y=e.canvas.clientHeight-a.y;return a};p.getScreenSpaceBoundingBox=function(t,r,i){var n=t.pixelSize;var a=n*.5;var s=r.x-a;var l=r.y-a;var u=n;var c=n;if(!o(i)){i=new e}i.x=s;i.y=l;i.width=u;i.height=c;return i};p.prototype.equals=function(e){return this===e||o(e)&&this._id===e._id&&r.equals(this._position,e._position)&&n.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&n.equals(this._outlineColor,e._outlineColor)&&d.equals(this._scaleByDistance,e._scaleByDistance)&&d.equals(this._translucencyByDistance,e._translucencyByDistance)&&u.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance};p.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy();this._pointPrimitiveCollection=undefined};return p});define("Shaders/PointPrimitiveCollectionFS",[],function(){"use strict";return"varying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\n\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#endif\n\nvoid main()\n{\n    // The distance in UV space from this fragment to the center of the point, at most 0.5.\n    float distanceToCenter = length(gl_PointCoord - vec2(0.5));\n    // The max distance stops one pixel shy of the edge to leave space for anti-aliasing.\n    float maxDistance = max(0.0, 0.5 - v_pixelDistance);\n    float wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);\n    float innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);\n\n    vec4 color = mix(v_outlineColor, v_color, innerAlpha);\n    color.a *= wholeAlpha;\n\n// Fully transparent parts of the billboard are not pickable.\n#if defined(RENDER_FOR_PICK) || (!defined(OPAQUE) && !defined(TRANSLUCENT))\n    if (color.a < 0.005)   // matches 0/255 and 1/255\n    {\n        discard;\n    }\n#else\n// The billboard is rendered twice. The opaque pass discards translucent fragments\n// and the translucent pass discards opaque fragments.\n#ifdef OPAQUE\n    if (color.a < 0.995)   // matches < 254/255\n    {\n        discard;\n    }\n#else\n    if (color.a >= 0.995)  // matches 254/255 and 255/255\n    {\n        discard;\n    }\n#endif\n#endif\n\n#ifdef RENDER_FOR_PICK\n    gl_FragColor = v_pickColor;\n#else\n    gl_FragColor = color;\n#endif\n}\n"});define("Shaders/PointPrimitiveCollectionVS",[],function(){"use strict";return'uniform float u_maxTotalPointSize;\n\nattribute vec4 positionHighAndSize;\nattribute vec4 positionLowAndOutline;\nattribute vec4 compressedAttribute0;                       // color, outlineColor, pick color\nattribute vec4 compressedAttribute1;                       // show, translucency by distance, some free space\nattribute vec4 scaleByDistance;                            // near, nearScale, far, farScale\nattribute vec3 distanceDisplayConditionAndDisableDepth;    // near, far, disableDepthTestDistance\n\nvarying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\n\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#endif\n\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\n\nvoid main()\n{\n    // Modifying this shader may also require modifications to PointPrimitive._computeScreenSpacePosition\n\n    // unpack attributes\n    vec3 positionHigh = positionHighAndSize.xyz;\n    vec3 positionLow = positionLowAndOutline.xyz;\n    float outlineWidthBothSides = 2.0 * positionLowAndOutline.w;\n    float totalSize = positionHighAndSize.w + outlineWidthBothSides;\n    float outlinePercent = outlineWidthBothSides / totalSize;\n    // Scale in response to browser-zoom.\n    totalSize *= czm_resolutionScale;\n    // Add padding for anti-aliasing on both sides.\n    totalSize += 3.0;\n\n    float temp = compressedAttribute1.x * SHIFT_RIGHT8;\n    float show = floor(temp);\n\n#ifdef EYE_DISTANCE_TRANSLUCENCY\n    vec4 translucencyByDistance;\n    translucencyByDistance.x = compressedAttribute1.z;\n    translucencyByDistance.z = compressedAttribute1.w;\n\n    translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n\n    temp = compressedAttribute1.y * SHIFT_RIGHT8;\n    translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\n\n    ///////////////////////////////////////////////////////////////////////////\n\n    vec4 color;\n    vec4 outlineColor;\n#ifdef RENDER_FOR_PICK\n    // compressedAttribute0.z => pickColor.rgb\n\n    color = vec4(0.0);\n    outlineColor = vec4(0.0);\n    vec4 pickColor;\n    temp = compressedAttribute0.z * SHIFT_RIGHT8;\n    pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    pickColor.r = floor(temp);\n#else\n    // compressedAttribute0.x => color.rgb\n\n    temp = compressedAttribute0.x * SHIFT_RIGHT8;\n    color.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    color.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    color.r = floor(temp);\n\n    // compressedAttribute0.y => outlineColor.rgb\n\n    temp = compressedAttribute0.y * SHIFT_RIGHT8;\n    outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    outlineColor.r = floor(temp);\n#endif\n\n    // compressedAttribute0.w => color.a, outlineColor.a, pickColor.a\n\n    temp = compressedAttribute0.w * SHIFT_RIGHT8;\n#ifdef RENDER_FOR_PICK\n    pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\n    pickColor = pickColor / 255.0;\n#endif\n    temp = floor(temp) * SHIFT_RIGHT8;\n    outlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\n    outlineColor /= 255.0;\n    color.a = floor(temp);\n    color /= 255.0;\n\n    ///////////////////////////////////////////////////////////////////////////\n\n    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\n    vec4 positionEC = czm_modelViewRelativeToEye * p;\n    positionEC.xyz *= show;\n\n    ///////////////////////////////////////////////////////////////////////////\n\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)\n    float lengthSq;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        // 2D camera distance is a special case\n        // treat all billboards as flattened to the z=0.0 plane\n        lengthSq = czm_eyeHeight2D.y;\n    }\n    else\n    {\n        lengthSq = dot(positionEC.xyz, positionEC.xyz);\n    }\n#endif\n\n#ifdef EYE_DISTANCE_SCALING\n    totalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);\n#endif\n    // Clamp to max point size.\n    totalSize = min(totalSize, u_maxTotalPointSize);\n    // If size is too small, push vertex behind near plane for clipping.\n    // Note that context.minimumAliasedPointSize "will be at most 1.0".\n    if (totalSize < 1.0)\n    {\n        positionEC.xyz = vec3(0.0);\n        totalSize = 1.0;\n    }\n\n    float translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\n    translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\n    // push vertex behind near plane for clipping\n    if (translucency < 0.004)\n    {\n        positionEC.xyz = vec3(0.0);\n    }\n#endif\n\n#ifdef DISTANCE_DISPLAY_CONDITION\n    float nearSq = distanceDisplayConditionAndDisableDepth.x;\n    float farSq = distanceDisplayConditionAndDisableDepth.y;\n    if (lengthSq < nearSq || lengthSq > farSq) {\n        positionEC.xyz = vec3(0.0);\n    }\n#endif\n\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n\n    gl_Position = czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\n\n#ifdef DISABLE_DEPTH_DISTANCE\n    float disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z;\n    if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)\n    {\n        disableDepthTestDistance = czm_minimumDisableDepthTestDistance;\n    }\n\n    if (disableDepthTestDistance != 0.0)\n    {\n        // Don\'t try to "multiply both sides" by w.  Greater/less-than comparisons won\'t work for negative values of w.\n        float zclip = gl_Position.z / gl_Position.w;\n        bool clipped = (zclip < -1.0 || zclip > 1.0);\n        if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))\n        {\n            // Position z on the near plane.\n            gl_Position.z = -gl_Position.w;\n        }\n    }\n#endif\n\n    v_color = color;\n    v_color.a *= translucency;\n    v_outlineColor = outlineColor;\n    v_outlineColor.a *= translucency;\n\n    v_innerPercent = 1.0 - outlinePercent;\n    v_pixelDistance = 2.0 / totalSize;\n    gl_PointSize = totalSize;\n\n#ifdef RENDER_FOR_PICK\n    v_pickColor = pickColor;\n#endif\n}\n'});define("Scene/PointPrimitiveCollection",["../Core/BoundingSphere","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/Math","../Core/Matrix4","../Core/PrimitiveType","../Core/WebGLConstants","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArrayFacade","../Shaders/PointPrimitiveCollectionFS","../Shaders/PointPrimitiveCollectionVS","./BlendingState","./BlendOption","./PointPrimitive","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x){"use strict";var P=E.SHOW_INDEX;var A=E.POSITION_INDEX;var O=E.COLOR_INDEX;var D=E.OUTLINE_COLOR_INDEX;var I=E.OUTLINE_WIDTH_INDEX;var M=E.PIXEL_SIZE_INDEX;var R=E.SCALE_BY_DISTANCE_INDEX;var L=E.TRANSLUCENCY_BY_DISTANCE_INDEX;var N=E.DISTANCE_DISPLAY_CONDITION_INDEX;var k=E.DISABLE_DEPTH_DISTANCE_INDEX;var F=E.NUMBER_OF_PROPERTIES;var B={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5};function U(t){t=i(t,i.EMPTY_OBJECT);this._sp=undefined;this._spTranslucent=undefined;this._spPick=undefined;this._rsOpaque=undefined;this._rsTranslucent=undefined;this._vaf=undefined;this._pointPrimitives=[];this._pointPrimitivesToUpdate=[];this._pointPrimitivesToUpdateIndex=0;this._pointPrimitivesRemoved=false;this._createVertexArray=false;this._shaderScaleByDistance=false;this._compiledShaderScaleByDistance=false;this._compiledShaderScaleByDistancePick=false;this._shaderTranslucencyByDistance=false;this._compiledShaderTranslucencyByDistance=false;this._compiledShaderTranslucencyByDistancePick=false;this._shaderDistanceDisplayCondition=false;this._compiledShaderDistanceDisplayCondition=false;this._compiledShaderDistanceDisplayConditionPick=false;this._shaderDisableDepthDistance=false;this._compiledShaderDisableDepthDistance=false;this._compiledShaderDisableDepthDistancePick=false;this._propertiesChanged=new Uint32Array(F);this._maxPixelSize=1;this._baseVolume=new e;this._baseVolumeWC=new e;this._baseVolume2D=new e;this._boundingVolume=new e;this._boundingVolumeDirty=false;this._colorCommands=[];this._pickCommands=[];this.modelMatrix=c.clone(i(t.modelMatrix,c.IDENTITY));this._modelMatrix=c.clone(c.IDENTITY);this.debugShowBoundingVolume=i(t.debugShowBoundingVolume,false);this.blendOption=i(t.blendOption,T.OPAQUE_AND_TRANSLUCENT);this._blendOption=undefined;this._mode=x.SCENE3D;this._maxTotalPointSize=1;this._buffersUsage=[h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW,h.STATIC_DRAW];var r=this;this._uniforms={u_maxTotalPointSize:function(){return r._maxTotalPointSize}}}a(U.prototype,{length:{get:function(){z(this);return this._pointPrimitives.length}}});function V(e){var t=e.length;for(var r=0;r<t;++r){if(e[r]){e[r]._destroy()}}}U.prototype.add=function(e){var t=new E(e,this);t._index=this._pointPrimitives.length;this._pointPrimitives.push(t);this._createVertexArray=true;return t};U.prototype.remove=function(e){if(this.contains(e)){this._pointPrimitives[e._index]=null;this._pointPrimitivesRemoved=true;this._createVertexArray=true;e._destroy();return true}return false};U.prototype.removeAll=function(){V(this._pointPrimitives);this._pointPrimitives=[];this._pointPrimitivesToUpdate=[];this._pointPrimitivesToUpdateIndex=0;this._pointPrimitivesRemoved=false;this._createVertexArray=true};function z(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=false;var t=[];var r=e._pointPrimitives;var i=r.length;for(var n=0,a=0;n<i;++n){var o=r[n];if(o){o._index=a++;t.push(o)}}e._pointPrimitives=t}}U.prototype._updatePointPrimitive=function(e,t){if(!e._dirty){this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e}++this._propertiesChanged[t]};U.prototype.contains=function(e){return n(e)&&e._pointPrimitiveCollection===this};U.prototype.get=function(e){if(!n(e)){throw new s("index is required.")}z(this);return this._pointPrimitives[e]};U.prototype.computeNewBuffersUsage=function(){var e=this._buffersUsage;var t=false;var r=this._propertiesChanged;for(var i=0;i<F;++i){var n=r[i]===0?h.STATIC_DRAW:h.STREAM_DRAW;t=t||e[i]!==n;e[i]=n}return t};function q(e,t,i){return new b(e,[{index:B.positionHighAndSize,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[A]},{index:B.positionLowAndShow,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[A]},{index:B.compressedAttribute0,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[O]},{index:B.compressedAttribute1,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[L]},{index:B.scaleByDistance,componentsPerAttribute:4,componentDatatype:r.FLOAT,usage:i[R]},{index:B.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:r.FLOAT,usage:i[N]}],t)}var G=new l;function H(t,r,i,n){var a=n._index;var o=n._getActualPosition();if(t._mode===x.SCENE3D){e.expand(t._baseVolume,o,t._baseVolume);t._boundingVolumeDirty=true}l.fromCartesian(o,G);var s=n.pixelSize;var u=n.outlineWidth;t._maxPixelSize=Math.max(t._maxPixelSize,s+u);var c=i[B.positionHighAndSize];var d=G.high;c(a,d.x,d.y,d.z,s);var f=i[B.positionLowAndOutline];var h=G.low;f(a,h.x,h.y,h.z,u)}var j=65536;var W=256;function Y(e,r,i,n){var a=n._index;var o=n.color;var s=n.getPickId(r).color;var l=n.outlineColor;var u=t.floatToByte(o.red);var c=t.floatToByte(o.green);var d=t.floatToByte(o.blue);var f=u*j+c*W+d;u=t.floatToByte(l.red);c=t.floatToByte(l.green);d=t.floatToByte(l.blue);var h=u*j+c*W+d;u=t.floatToByte(s.red);c=t.floatToByte(s.green);d=t.floatToByte(s.blue);var p=u*j+c*W+d;var m=t.floatToByte(o.alpha)*j+t.floatToByte(l.alpha)*W+t.floatToByte(s.alpha);var v=i[B.compressedAttribute0];v(a,f,h,p,m)}function X(e,t,r,i){var a=i._index;var o=0;var s=1;var l=1;var c=1;var d=i.translucencyByDistance;if(n(d)){o=d.near;s=d.nearValue;l=d.far;c=d.farValue;if(s!==1||c!==1){e._shaderTranslucencyByDistance=true}}var f=i.show&&i.clusterShow;if(i.color.alpha===0&&i.outlineColor.alpha===0){f=false}s=u.clamp(s,0,1);s=s===1?255:s*255|0;var h=(f?1:0)*W+s;c=u.clamp(c,0,1);c=c===1?255:c*255|0;var p=c;var m=r[B.compressedAttribute1];m(a,h,p,o,l)}function Q(e,t,r,i){var a=i._index;var o=r[B.scaleByDistance];var s=0;var l=1;var u=1;var c=1;var d=i.scaleByDistance;if(n(d)){s=d.near;l=d.nearValue;u=d.far;c=d.farValue;if(l!==1||c!==1){e._shaderScaleByDistance=true}}o(a,s,l,u,c)}function Z(e,t,r,i){var a=i._index;var o=r[B.distanceDisplayConditionAndDisableDepth];var s=0;var l=Number.MAX_VALUE;var u=i.distanceDisplayCondition;if(n(u)){s=u.near;l=u.far;s*=s;l*=l;e._shaderDistanceDisplayCondition=true}var c=i.disableDepthTestDistance;c*=c;if(c>0){e._shaderDisableDepthDistance=true;if(c===Number.POSITIVE_INFINITY){c=-1}}o(a,s,l,c)}function K(e,t,r,i){H(e,t,r,i);Y(e,t,r,i);X(e,t,r,i);Q(e,t,r,i);Z(e,t,r,i)}function J(t,r,i,a,o,s){var l;if(a.mode===x.SCENE3D){l=t._baseVolume;t._boundingVolumeDirty=true}else{l=t._baseVolume2D}var u=[];for(var c=0;c<i;++c){var d=r[c];var f=d.position;var h=E._computeActualPosition(f,a,o);if(n(h)){d._setActualPosition(h);if(s){u.push(h)}else{e.expand(l,h,l)}}}if(s){e.fromPoints(u,l)}}function $(e,t){var r=t.mode;var i=e._pointPrimitives;var n=e._pointPrimitivesToUpdate;var a=e._modelMatrix;if(e._createVertexArray||e._mode!==r||r!==x.SCENE3D&&!c.equals(a,e.modelMatrix)){e._mode=r;c.clone(e.modelMatrix,a);e._createVertexArray=true;if(r===x.SCENE3D||r===x.SCENE2D||r===x.COLUMBUS_VIEW){J(e,i,i.length,t,a,true)}}else if(r===x.MORPHING){J(e,i,i.length,t,a,true)}else if(r===x.SCENE2D||r===x.COLUMBUS_VIEW){J(e,n,e._pointPrimitivesToUpdateIndex,t,a,false)}}function ee(e,t,r){var i=t.camera.getPixelSize(r,t.context.drawingBufferWidth,t.context.drawingBufferHeight);var n=i*e._maxPixelSize;r.radius+=n}var te=[];U.prototype.update=function(t){z(this);this._maxTotalPointSize=p.maximumAliasedPointSize;$(this,t);var r=this._pointPrimitives;var i=r.length;var a=this._pointPrimitivesToUpdate;var o=this._pointPrimitivesToUpdateIndex;var s=this._propertiesChanged;var l=this._createVertexArray;var u;var h=t.context;var b=t.passes;var E=b.pick;if(l||!E&&this.computeNewBuffersUsage()){this._createVertexArray=false;for(var U=0;U<F;++U){s[U]=0}this._vaf=this._vaf&&this._vaf.destroy();if(i>0){this._vaf=q(h,i,this._buffersUsage);u=this._vaf.writers;for(var V=0;V<i;++V){var G=this._pointPrimitives[V];G._dirty=false;K(this,h,u,G)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(o>0){var j=te;j.length=0;if(s[A]||s[I]||s[M]){j.push(H)}if(s[O]||s[D]){j.push(Y)}if(s[P]||s[L]){j.push(X)}if(s[R]){j.push(Q)}if(s[N]||s[k]){j.push(Z)}var W=j.length;u=this._vaf.writers;if(o/i>.1){for(var J=0;J<o;++J){var re=a[J];re._dirty=false;for(var ie=0;ie<W;++ie){j[ie](this,h,u,re)}}this._vaf.commit()}else{for(var ne=0;ne<o;++ne){var ae=a[ne];ae._dirty=false;for(var oe=0;oe<W;++oe){j[oe](this,h,u,ae)}this._vaf.subCommit(ae._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(o>i*1.5){a.length=i}if(!n(this._vaf)||!n(this._vaf.va)){return}if(this._boundingVolumeDirty){this._boundingVolumeDirty=false;e.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC)}var se;var le=c.IDENTITY;if(t.mode===x.SCENE3D){le=this.modelMatrix;se=e.clone(this._baseVolumeWC,this._boundingVolume)}else{se=e.clone(this._baseVolume2D,this._boundingVolume)}ee(this,t,se);var ue=this._blendOption!==this.blendOption;this._blendOption=this.blendOption;if(ue){if(this._blendOption===T.OPAQUE||this._blendOption===T.OPAQUE_AND_TRANSLUCENT){this._rsOpaque=g.fromCache({depthTest:{enabled:true,func:f.LEQUAL},depthMask:true})}else{this._rsOpaque=undefined}if(this._blendOption===T.TRANSLUCENT||this._blendOption===T.OPAQUE_AND_TRANSLUCENT){this._rsTranslucent=g.fromCache({depthTest:{enabled:true,func:f.LEQUAL},depthMask:false,blending:S.ALPHA_BLEND})}else{this._rsTranslucent=undefined}}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||t.minimumDisableDepthTestDistance!==0;var ce;var de;if(ue||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance){ce=new y({sources:[C]});if(this._shaderScaleByDistance){ce.defines.push("EYE_DISTANCE_SCALING")}if(this._shaderTranslucencyByDistance){ce.defines.push("EYE_DISTANCE_TRANSLUCENCY")}if(this._shaderDistanceDisplayCondition){ce.defines.push("DISTANCE_DISPLAY_CONDITION")}if(this._shaderDisableDepthDistance){ce.defines.push("DISABLE_DEPTH_DISTANCE")}if(this._blendOption===T.OPAQUE_AND_TRANSLUCENT){de=new y({defines:["OPAQUE"],sources:[w]});this._sp=_.replaceCache({context:h,shaderProgram:this._sp,vertexShaderSource:ce,fragmentShaderSource:de,attributeLocations:B});de=new y({defines:["TRANSLUCENT"],sources:[w]});this._spTranslucent=_.replaceCache({context:h,shaderProgram:this._spTranslucent,vertexShaderSource:ce,fragmentShaderSource:de,attributeLocations:B})}if(this._blendOption===T.OPAQUE){de=new y({sources:[w]});this._sp=_.replaceCache({context:h,shaderProgram:this._sp,vertexShaderSource:ce,fragmentShaderSource:de,attributeLocations:B})}if(this._blendOption===T.TRANSLUCENT){de=new y({sources:[w]});this._spTranslucent=_.replaceCache({context:h,shaderProgram:this._spTranslucent,vertexShaderSource:ce,fragmentShaderSource:de,attributeLocations:B})}this._compiledShaderScaleByDistance=this._shaderScaleByDistance;this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance;this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition;this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance}if(!n(this._spPick)||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistancePick||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistancePick||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayConditionPick||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistancePick){ce=new y({defines:["RENDER_FOR_PICK"],sources:[C]});if(this._shaderScaleByDistance){ce.defines.push("EYE_DISTANCE_SCALING")}if(this._shaderTranslucencyByDistance){ce.defines.push("EYE_DISTANCE_TRANSLUCENCY")}if(this._shaderDistanceDisplayCondition){ce.defines.push("DISTANCE_DISPLAY_CONDITION")}if(this._shaderDisableDepthDistance){ce.defines.push("DISABLE_DEPTH_DISTANCE")}de=new y({defines:["RENDER_FOR_PICK"],sources:[w]});this._spPick=_.replaceCache({context:h,shaderProgram:this._spPick,vertexShaderSource:ce,fragmentShaderSource:de,attributeLocations:B});this._compiledShaderScaleByDistancePick=this._shaderScaleByDistance;this._compiledShaderTranslucencyByDistancePick=this._shaderTranslucencyByDistance;this._compiledShaderDistanceDisplayConditionPick=this._shaderDistanceDisplayCondition;this._compiledShaderDisableDepthDistancePick=this._shaderDisableDepthDistance}var fe;var he;var pe;var me;var ve=t.commandList;if(b.render){var ge=this._colorCommands;var _e=this._blendOption===T.OPAQUE;var ye=this._blendOption===T.OPAQUE_AND_TRANSLUCENT;fe=this._vaf.va;he=fe.length;ge.length=he;var be=ye?he*2:he;for(me=0;me<be;++me){var we=_e||ye&&me%2===0;pe=ge[me];if(!n(pe)){pe=ge[me]=new m}pe.primitiveType=d.POINTS;pe.pass=we||!ye?v.OPAQUE:v.TRANSLUCENT;pe.owner=this;var Ce=ye?Math.floor(me/2):me;pe.boundingVolume=se;pe.modelMatrix=le;pe.shaderProgram=we?this._sp:this._spTranslucent;pe.uniformMap=this._uniforms;pe.vertexArray=fe[Ce].va;pe.renderState=we?this._rsOpaque:this._rsTranslucent;pe.debugShowBoundingVolume=this.debugShowBoundingVolume;ve.push(pe)}}if(E){var Se=this._pickCommands;fe=this._vaf.va;he=fe.length;Se.length=he;for(me=0;me<he;++me){pe=Se[me];if(!n(pe)){pe=Se[me]=new m({primitiveType:d.POINTS,pass:v.OPAQUE,owner:this})}pe.boundingVolume=se;pe.modelMatrix=le;pe.shaderProgram=this._spPick;pe.uniformMap=this._uniforms;pe.vertexArray=fe[me].va;pe.renderState=this._rsOpaque;ve.push(pe)}}};U.prototype.isDestroyed=function(){return false};U.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy();this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy();this._spPick=this._spPick&&this._spPick.destroy();this._vaf=this._vaf&&this._vaf.destroy();V(this._pointPrimitives);return o(this)};return U});define("ThirdParty/kdbush",[],function(){"use strict";function e(e,r,i,n,a){return new t(e,r,i,n,a)}function t(e,t,n,o,s){t=t||r;n=n||i;s=s||Array;this.nodeSize=o||64;this.points=e;this.ids=new s(e.length);this.coords=new s(e.length*2);for(var l=0;l<e.length;l++){this.ids[l]=l;this.coords[2*l]=t(e[l]);this.coords[2*l+1]=n(e[l])}a(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}t.prototype={range:function(e,t,r,i){return n(this.ids,this.coords,e,t,r,i,this.nodeSize)},within:function(e,t,r){return u(this.ids,this.coords,e,t,r,this.nodeSize)}};function r(e){return e[0]}function i(e){return e[1]}function n(e,t,r,i,n,a,o){var s=[0,e.length-1,0];var l=[];var u,c;while(s.length){var d=s.pop();var f=s.pop();var h=s.pop();if(f-h<=o){for(var p=h;p<=f;p++){u=t[2*p];c=t[2*p+1];if(u>=r&&u<=n&&c>=i&&c<=a)l.push(e[p])}continue}var m=Math.floor((h+f)/2);u=t[2*m];c=t[2*m+1];if(u>=r&&u<=n&&c>=i&&c<=a)l.push(e[m]);var v=(d+1)%2;if(d===0?r<=u:i<=c){s.push(h);s.push(m-1);s.push(v)}if(d===0?n>=u:a>=c){s.push(m+1);s.push(f);s.push(v)}}return l}function a(e,t,r,i,n,s){if(n-i<=r)return;var l=Math.floor((i+n)/2);o(e,t,l,i,n,s%2);a(e,t,r,i,l-1,s+1);a(e,t,r,l+1,n,s+1)}function o(e,t,r,i,n,a){while(n>i){if(n-i>600){var l=n-i+1;var u=r-i+1;var c=Math.log(l);var d=.5*Math.exp(2*c/3);var f=.5*Math.sqrt(c*d*(l-d)/l)*(u-l/2<0?-1:1);var h=Math.max(i,Math.floor(r-u*d/l+f));var p=Math.min(n,Math.floor(r+(l-u)*d/l+f));o(e,t,r,h,p,a)}var m=t[2*r+a];var v=i;var g=n;s(e,t,i,r);if(t[2*n+a]>m)s(e,t,i,n);while(v<g){s(e,t,v,g);v++;g--;while(t[2*v+a]<m)v++;while(t[2*g+a]>m)g--}if(t[2*i+a]===m)s(e,t,i,g);else{g++;s(e,t,g,n)}if(g<=r)i=g+1;if(r<=g)n=g-1}}function s(e,t,r,i){l(e,r,i);l(t,2*r,2*i);l(t,2*r+1,2*i+1)}function l(e,t,r){var i=e[t];e[t]=e[r];e[r]=i}function u(e,t,r,i,n,a){var o=[0,e.length-1,0];var s=[];var l=n*n;while(o.length){var u=o.pop();var d=o.pop();var f=o.pop();if(d-f<=a){for(var h=f;h<=d;h++){if(c(t[2*h],t[2*h+1],r,i)<=l)s.push(e[h])}continue}var p=Math.floor((f+d)/2);var m=t[2*p];var v=t[2*p+1];if(c(m,v,r,i)<=l)s.push(e[p]);var g=(u+1)%2;if(u===0?r-n<=m:i-n<=v){o.push(f);o.push(p-1);o.push(g)}if(u===0?r+n>=m:i+n>=v){o.push(p+1);o.push(d);o.push(g)}}return s}function c(e,t,r,i){var n=e-r;var a=t-i;return n*n+a*a}return e});define("DataSources/EntityCluster",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/EllipsoidalOccluder","../Core/Event","../Core/Matrix4","../Scene/Billboard","../Scene/BillboardCollection","../Scene/Label","../Scene/LabelCollection","../Scene/PointPrimitive","../Scene/PointPrimitiveCollection","../Scene/SceneMode","../ThirdParty/kdbush"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";function g(e){e=i(e,i.EMPTY_OBJECT);this._enabled=i(e.enabled,false);this._pixelRange=i(e.pixelRange,80);this._minimumClusterSize=i(e.minimumClusterSize,2);this._clusterBillboards=i(e.clusterBillboards,true);this._clusterLabels=i(e.clusterLabels,true);this._clusterPoints=i(e.clusterPoints,true);this._labelCollection=undefined;this._billboardCollection=undefined;this._pointCollection=undefined;this._clusterBillboardCollection=undefined;this._clusterLabelCollection=undefined;this._clusterPointCollection=undefined;this._collectionIndicesByEntity={};this._unusedLabelIndices=[];this._unusedBillboardIndices=[];this._unusedPointIndices=[];this._previousClusters=[];this._previousHeight=undefined;this._enabledDirty=false;this._clusterDirty=false;this._cluster=undefined;this._removeEventListener=undefined;this._clusterEvent=new s}function _(e){return e.coord.x}function y(e){return e.coord.y}function b(e,t){e.x-=t;e.y-=t;e.width+=t*2;e.height+=t*2}var w=new e;function C(t,r,i,a,o){if(n(t._labelCollection)&&a._clusterLabels){o=d.getScreenSpaceBoundingBox(t,r,o)}else if(n(t._billboardCollection)&&a._clusterBillboards){o=u.getScreenSpaceBoundingBox(t,r,o)}else if(n(t._pointPrimitiveCollection)&&a._clusterPoints){o=h.getScreenSpaceBoundingBox(t,r,o)}b(o,i);if(a._clusterLabels&&!n(t._labelCollection)&&n(t.id)&&E(a,t.id)&&n(t.id._label)){var s=a._collectionIndicesByEntity[t.id];var l=a._labelCollection.get(s);var c=d.getScreenSpaceBoundingBox(l,r,w);b(c,i);o=e.union(o,c,o)}return o}function S(e,t){e.clusterShow=true;if(!n(e._labelCollection)&&n(e.id)&&E(t,e.id)&&n(e.id._label)){var r=t._collectionIndicesByEntity[e.id];var i=t._labelCollection.get(r);i.clusterShow=true}}function T(e,t,r,i){var n={billboard:i._clusterBillboardCollection.add(),label:i._clusterLabelCollection.add(),point:i._clusterPointCollection.add()};n.billboard.show=false;n.point.show=false;n.label.show=true;n.label.text=t.toLocaleString();n.label.id=r;n.billboard.position=n.label.position=n.point.position=e;i._clusterEvent.raiseEvent(r,n)}function E(e,t){return n(e)&&n(e._collectionIndicesByEntity[t])&&n(e._collectionIndicesByEntity[t].labelIndex)}function x(e,t,r,i,a){if(!n(e)){return}var o=e.length;for(var s=0;s<o;++s){var l=e.get(s);l.clusterShow=false;if(!l.show||a._scene.mode===m.SCENE3D&&!i.isPointVisible(l.position)){continue}var u=a._clusterLabels&&n(l._labelCollection);var c=a._clusterBillboards&&n(l.id._billboard);var d=a._clusterPoints&&n(l.id._point);if(u&&(d||c)){continue}var f=l.computeScreenSpacePosition(r);if(!n(f)){continue}t.push({index:s,collection:e,clustered:false,coord:f})}}var P=new e;var A=new e;var O=new e;function D(i){return function(a){if(n(a)&&a<.05||!i.enabled){return}var s=i._scene;var d=i._labelCollection;var h=i._billboardCollection;var m=i._pointCollection;if(!n(d)&&!n(h)&&!n(m)||!i._clusterBillboards&&!i._clusterLabels&&!i._clusterPoints){return}var g=i._clusterLabelCollection;var b=i._clusterBillboardCollection;var w=i._clusterPointCollection;if(n(g)){g.removeAll()}else{g=i._clusterLabelCollection=new f({scene:s})}if(n(b)){b.removeAll()}else{b=i._clusterBillboardCollection=new c({scene:s})}if(n(w)){w.removeAll()}else{w=i._clusterPointCollection=new p}var E=i._pixelRange;var D=i._minimumClusterSize;var I=i._previousClusters;var M=[];var R=i._previousHeight;var L=s.camera.positionCartographic.height;var N=s.mapProjection.ellipsoid;var k=s.camera.positionWC;var F=new o(N,k);var B=[];if(i._clusterLabels){x(d,B,s,F,i)}if(i._clusterBillboards){x(h,B,s,F,i)}if(i._clusterPoints){x(m,B,s,F,i)}var U;var V;var z;var q;var G;var H;var j;var W;var Y;var X;var Q;var Z;var K=v(B,_,y,64,Int32Array);if(L<R){z=I.length;for(U=0;U<z;++U){var J=I[U];if(!F.isPointVisible(J.position)){continue}var $=u._computeScreenSpacePosition(l.IDENTITY,J.position,r.ZERO,t.ZERO,s);if(!n($)){continue}var ee=1-L/R;var te=J.width=J.width*ee;var re=J.height=J.height*ee;te=Math.max(te,J.minimumWidth);re=Math.max(re,J.minimumHeight);var ie=$.x-te*.5;var ne=$.y-re*.5;var ae=$.x+te;var oe=$.y+re;G=K.range(ie,ne,ae,oe);H=G.length;X=0;Y=[];for(V=0;V<H;++V){j=G[V];W=B[j];if(!W.clustered){++X;Q=W.collection;Z=W.index;Y.push(Q.get(Z).id)}}if(X>=D){T(J.position,X,Y,i);M.push(J);for(V=0;V<H;++V){B[G[V]].clustered=true}}}}z=B.length;for(U=0;U<z;++U){var se=B[U];if(se.clustered){continue}se.clustered=true;Q=se.collection;Z=se.index;var le=Q.get(Z);q=C(le,se.coord,E,i,P);var ue=e.clone(q,A);G=K.range(q.x,q.y,q.x+q.width,q.y+q.height);H=G.length;var ce=r.clone(le.position);X=1;Y=[le.id];for(V=0;V<H;++V){j=G[V];W=B[j];if(!W.clustered){var de=W.collection.get(W.index);var fe=C(de,W.coord,E,i,O);r.add(de.position,ce,ce);e.union(ue,fe,ue);++X;Y.push(de.id)}}if(X>=D){var he=r.multiplyByScalar(ce,1/X,ce);T(he,X,Y,i);M.push({position:he,width:ue.width,height:ue.height,minimumWidth:q.width,minimumHeight:q.height});for(V=0;V<H;++V){B[G[V]].clustered=true}}else{S(le,i)}}if(g.length===0){g.destroy();i._clusterLabelCollection=undefined}if(b.length===0){b.destroy();i._clusterBillboardCollection=undefined}if(w.length===0){w.destroy();i._clusterPointCollection=undefined}i._previousClusters=M;i._previousHeight=L}}g.prototype._initialize=function(e){this._scene=e;var t=D(this);this._cluster=t;this._removeEventListener=e.camera.changed.addEventListener(t)};a(g.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled;this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange;this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize;this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards;this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels;this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints;this._clusterPoints=e}}});function I(e,t,r,i){return function(a){var o=this[e];if(!n(this._collectionIndicesByEntity)){this._collectionIndicesByEntity={}}var s=this._collectionIndicesByEntity[a.id];if(!n(s)){s=this._collectionIndicesByEntity[a.id]={billboardIndex:undefined,labelIndex:undefined,pointIndex:undefined}}if(n(o)&&n(s[i])){return o.get(s[i])}if(!n(o)){o=this[e]=new t({scene:this._scene})}var l;var u;var c=this[r];if(c.length>0){l=c.pop();u=o.get(l)}else{u=o.add();l=o.length-1}s[i]=l;this._clusterDirty=true;return u}}function M(e,t){var r=e._collectionIndicesByEntity[t];if(!n(r.billboardIndex)&&!n(r.labelIndex)&&!n(r.pointIndex)){delete e._collectionIndicesByEntity[t]}}g.prototype.getLabel=I("_labelCollection",f,"_unusedLabelIndices","labelIndex");g.prototype.removeLabel=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!n(this._labelCollection)||!n(t)||!n(t.labelIndex)){return}var r=t.labelIndex;t.labelIndex=undefined;M(this,e.id);var i=this._labelCollection.get(r);i.show=false;i.text="";i.id=undefined;this._unusedLabelIndices.push(r);this._clusterDirty=true};g.prototype.getBillboard=I("_billboardCollection",c,"_unusedBillboardIndices","billboardIndex");g.prototype.removeBillboard=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!n(this._billboardCollection)||!n(t)||!n(t.billboardIndex)){return}var r=t.billboardIndex;t.billboardIndex=undefined;M(this,e.id);var i=this._billboardCollection.get(r);i.id=undefined;i.show=false;i.image=undefined;this._unusedBillboardIndices.push(r);this._clusterDirty=true};g.prototype.getPoint=I("_pointCollection",p,"_unusedPointIndices","pointIndex");g.prototype.removePoint=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!n(this._pointCollection)||!n(t)||!n(t.pointIndex)){return}var r=t.pointIndex;t.pointIndex=undefined;M(this,e.id);var i=this._pointCollection.get(r);i.show=false;i.id=undefined;this._unusedPointIndices.push(r);this._clusterDirty=true};function R(e){if(!n(e)){return}var t=e.length;for(var r=0;r<t;++r){e.get(r).clusterShow=true}}function L(e){if(e.enabled){return}if(n(e._clusterLabelCollection)){e._clusterLabelCollection.destroy()}if(n(e._clusterBillboardCollection)){e._clusterBillboardCollection.destroy()}if(n(e._clusterPointCollection)){e._clusterPointCollection.destroy()}e._clusterLabelCollection=undefined;e._clusterBillboardCollection=undefined;e._clusterPointCollection=undefined;R(e._labelCollection);R(e._billboardCollection);R(e._pointCollection)}g.prototype.update=function(e){var t;if(n(this._labelCollection)&&this._labelCollection.length>0&&this._labelCollection.get(0)._glyphs.length===0){t=e.commandList;e.commandList=[];this._labelCollection.update(e);e.commandList=t}if(n(this._billboardCollection)&&this._billboardCollection.length>0&&!n(this._billboardCollection.get(0).width)){t=e.commandList;e.commandList=[];this._billboardCollection.update(e);e.commandList=t}if(this._enabledDirty){this._enabledDirty=false;L(this);this._clusterDirty=true}if(this._clusterDirty){this._clusterDirty=false;this._cluster()}if(n(this._clusterLabelCollection)){this._clusterLabelCollection.update(e)}if(n(this._clusterBillboardCollection)){this._clusterBillboardCollection.update(e)}if(n(this._clusterPointCollection)){this._clusterPointCollection.update(e)}if(n(this._labelCollection)){this._labelCollection.update(e)}if(n(this._billboardCollection)){this._billboardCollection.update(e)}if(n(this._pointCollection)){this._pointCollection.update(e)}};g.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy();this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy();this._pointCollection=this._pointCollection&&this._pointCollection.destroy();this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy();this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy();this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy();if(n(this._removeEventListener)){this._removeEventListener();this._removeEventListener=undefined}this._labelCollection=undefined;this._billboardCollection=undefined;this._pointCollection=undefined;this._clusterBillboardCollection=undefined;this._clusterLabelCollection=undefined;this._clusterPointCollection=undefined;this._collectionIndicesByEntity=undefined;this._unusedLabelIndices=[];this._unusedBillboardIndices=[];this._unusedPointIndices=[];this._previousClusters=[];this._previousHeight=undefined;this._enabledDirty=false;this._pixelRangeDirty=false;this._minimumClusterSizeDirty=false;return undefined};return g});define("DataSources/CustomDataSource",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./DataSource","./EntityCluster","./EntityCollection"],function(e,t,r,i,n,a,o){"use strict";function s(e){this._name=e;this._clock=undefined;this._changed=new i;this._error=new i;this._isLoading=false;this._loading=new i;this._entityCollection=new o(this);this._entityCluster=new a}t(s.prototype,{name:{get:function(){return this._name},set:function(e){if(this._name!==e){this._name=e;this._changed.raiseEvent(this)}}},clock:{get:function(){return this._clock},set:function(e){if(this._clock!==e){this._clock=e;this._changed.raiseEvent(this)}}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(e){n.setLoading(this,e)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(t){if(!e(t)){throw new r("value must be defined.")}this._entityCluster=t}}});return s});define("DataSources/CylinderGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/CylinderGeometry","../Core/CylinderOutlineGeometry","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S){"use strict";var T=new y(e.WHITE);var E=new b(true);var x=new b(true);var P=new b(false);var A=new b(e.BLACK);var O=new b(_.DISABLED);var D=new b(new u);var I=new e;function M(e){this.id=e;this.vertexFormat=undefined;this.length=undefined;this.topRadius=undefined;this.bottomRadius=undefined;this.slices=undefined;this.numberOfVerticalLines=undefined}function R(e,t){if(!a(e)){throw new l("entity is required")}if(!a(t)){throw new l("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(R.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new d;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new M(e);this._onEntityPropertyChanged(e,"cylinder",e.cylinder,undefined)}o(R,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:m}});o(R.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:true},geometryChanged:{get:function(){return this._geometryChanged}}});R.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};R.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};R.prototype.createFillGeometryInstance=function(i){if(!a(i)){throw new l("time is required.")}if(!this._fillEnabled){throw new l("This instance does not represent a filled geometry.")}var n=this._entity;var o=n.isAvailable(i);var s;var u;var d=new p(o&&n.isShowing&&this._showProperty.getValue(i)&&this._fillProperty.getValue(i));var m=this._distanceDisplayConditionProperty.getValue(i);var v=c.fromDistanceDisplayCondition(m);if(this._materialProperty instanceof y){var g=e.WHITE;if(a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)){g=this._materialProperty.color.getValue(i)}u=t.fromColor(g);s={show:d,distanceDisplayCondition:v,color:u}}else{s={show:d,distanceDisplayCondition:v}}return new f({id:n,geometry:new r(this._options),modelMatrix:n.computeModelMatrix(h.MINIMUM_VALUE),attributes:s})};R.prototype.createOutlineGeometryInstance=function(r){if(!a(r)){throw new l("time is required.")}if(!this._outlineEnabled){throw new l("This instance does not represent an outlined geometry.")}var n=this._entity;var o=n.isAvailable(r);var s=S.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var u=this._distanceDisplayConditionProperty.getValue(r);return new f({id:n,geometry:new i(this._options),modelMatrix:n.computeModelMatrix(h.MINIMUM_VALUE),attributes:{show:new p(o&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:c.fromDistanceDisplayCondition(u)}})};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._entitySubscription();s(this)};R.prototype._onEntityPropertyChanged=function(e,t,r,i){if(!(t==="availability"||t==="position"||t==="orientation"||t==="cylinder")){return}var o=e.cylinder;if(!a(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var l=a(s)&&s.isConstant?s.getValue(h.MINIMUM_VALUE):true;var u=o.outline;var c=a(u);if(c&&u.isConstant){c=u.getValue(h.MINIMUM_VALUE)}if(!l&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=e.position;var f=o.length;var p=o.topRadius;var g=o.bottomRadius;var _=o.show;if(a(_)&&_.isConstant&&!_.getValue(h.MINIMUM_VALUE)||(!a(d)||!a(f)||!a(p)||!a(g))){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var b=n(o.material,T);var w=b instanceof y;this._materialProperty=b;this._fillProperty=n(s,x);this._showProperty=n(_,E);this._showOutlineProperty=n(o.outline,P);this._outlineColorProperty=c?n(o.outlineColor,A):undefined;this._shadowsProperty=n(o.shadows,O);this._distanceDisplayConditionProperty=n(o.distanceDisplayCondition,D);var C=o.slices;var I=o.outlineWidth;var M=o.numberOfVerticalLines;this._fillEnabled=l;this._outlineEnabled=c;if(!d.isConstant||!S.isConstant(e.orientation)||!f.isConstant||!p.isConstant||!g.isConstant||!S.isConstant(C)||!S.isConstant(I)||!S.isConstant(M)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var R=this._options;R.vertexFormat=w?v.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat;R.length=f.getValue(h.MINIMUM_VALUE);R.topRadius=p.getValue(h.MINIMUM_VALUE);R.bottomRadius=g.getValue(h.MINIMUM_VALUE);R.slices=a(C)?C.getValue(h.MINIMUM_VALUE):undefined;R.numberOfVerticalLines=a(M)?M.getValue(h.MINIMUM_VALUE):undefined;this._outlineWidth=a(I)?I.getValue(h.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};R.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new l("This instance does not represent dynamic geometry.")}if(!a(e)){throw new l("primitives is required.")}return new L(e,this)};function L(e,t){this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new M(t._entity)}L.prototype.update=function(n){if(!a(n)){throw new l("time is required.")}var o=this._primitives;o.removeAndDestroy(this._primitive);o.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;var s=this._geometryUpdater;var u=s._entity;var d=u.cylinder;if(!u.isShowing||!u.isAvailable(n)||!S.getValueOrDefault(d.show,n,true)){return}var h=this._options;var p=u.computeModelMatrix(n);var _=S.getValueOrUndefined(d.length,n);var y=S.getValueOrUndefined(d.topRadius,n);var b=S.getValueOrUndefined(d.bottomRadius,n);if(!a(p)||!a(_)||!a(y)||!a(b)){return}h.length=_;h.topRadius=y;h.bottomRadius=b;h.slices=S.getValueOrUndefined(d.slices,n);h.numberOfVerticalLines=S.getValueOrUndefined(d.numberOfVerticalLines,n);var w=this._geometryUpdater.shadowsProperty.getValue(n);var T=this._geometryUpdater.distanceDisplayConditionProperty;var E=T.getValue(n);var x=c.fromDistanceDisplayCondition(E);if(S.getValueOrDefault(d.fill,n,true)){var P=C.getValue(n,s.fillMaterialProperty,this._material);this._material=P;var A=new m({material:P,translucent:P.isTranslucent(),closed:true});h.vertexFormat=A.vertexFormat;this._primitive=o.add(new g({geometryInstances:new f({id:u,geometry:new r(h),modelMatrix:p,attributes:{distanceDisplayCondition:x}}),appearance:A,asynchronous:false,shadows:w}))}if(S.getValueOrDefault(d.outline,n,false)){h.vertexFormat=v.VERTEX_FORMAT;var O=S.getValueOrClonedDefault(d.outlineColor,n,e.BLACK,I);var D=S.getValueOrDefault(d.outlineWidth,n,1);var M=O.alpha!==1;this._outlinePrimitive=o.add(new g({geometryInstances:new f({id:u,geometry:new i(h),modelMatrix:p,attributes:{color:t.fromColor(O),distanceDisplayCondition:x}}),appearance:new v({flat:true,translucent:M,renderState:{lineWidth:s._scene.clampLineWidth(D)}}),asynchronous:false,shadows:w}))}};L.prototype.getBoundingSphere=function(e,t){return w(e,this._primitive,this._outlinePrimitive,t)};L.prototype.isDestroyed=function(){return false};L.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);s(this)};return R});define("Scene/ColorBlendMode",["../Core/freezeObject","../Core/Math"],function(e,t){"use strict";var r={HIGHLIGHT:0,REPLACE:1,MIX:2};r.getColorBlend=function(e,i){if(e===r.HIGHLIGHT){return 0}else if(e===r.REPLACE){return 1}else if(e===r.MIX){return t.clamp(i,t.EPSILON4,1)}};return e(r)});define("DataSources/DataSourceClock",["../Core/Clock","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","./createRawPropertyDescriptor"],function(e,t,r,i,n,a,o,s){"use strict";function l(){this._startTime=undefined;this._stopTime=undefined;this._currentTime=undefined;this._clockRange=undefined;this._clockStep=undefined;this._multiplier=undefined;this._definitionChanged=new a}i(l.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:s("startTime"),stopTime:s("stopTime"),currentTime:s("currentTime"),clockRange:s("clockRange"),clockStep:s("clockStep"),multiplier:s("multiplier")});l.prototype.clone=function(e){if(!r(e)){e=new l}e.startTime=this.startTime;e.stopTime=this.stopTime;e.currentTime=this.currentTime;e.clockRange=this.clockRange;e.clockStep=this.clockStep;e.multiplier=this.multiplier;return e};l.prototype.equals=function(e){return this===e||r(e)&&o.equals(this.startTime,e.startTime)&&o.equals(this.stopTime,e.stopTime)&&o.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier};l.prototype.merge=function(e){if(!r(e)){throw new n("source is required.")}this.startTime=t(this.startTime,e.startTime);this.stopTime=t(this.stopTime,e.stopTime);this.currentTime=t(this.currentTime,e.currentTime);this.clockRange=t(this.clockRange,e.clockRange);this.clockStep=t(this.clockStep,e.clockStep);this.multiplier=t(this.multiplier,e.multiplier)};l.prototype.getValue=function(i){if(!r(i)){i=new e}i.startTime=t(this.startTime,i.startTime);i.stopTime=t(this.stopTime,i.stopTime);i.currentTime=t(this.currentTime,i.currentTime);i.clockRange=t(this.clockRange,i.clockRange);i.multiplier=t(this.multiplier,i.multiplier);i.clockStep=t(this.clockStep,i.clockStep);return i};return l});define("DataSources/GridMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o,s){"use strict";var l=t.WHITE;var u=.1;var c=new e(8,8);var d=new e(0,0);var f=new e(1,1);function h(e){e=r(e,r.EMPTY_OBJECT);this._definitionChanged=new a;this._color=undefined;this._colorSubscription=undefined;this._cellAlpha=undefined;this._cellAlphaSubscription=undefined;this._lineCount=undefined;this._lineCountSubscription=undefined;this._lineThickness=undefined;this._lineThicknessSubscription=undefined;this._lineOffset=undefined;this._lineOffsetSubscription=undefined;this.color=e.color;this.cellAlpha=e.cellAlpha;this.lineCount=e.lineCount;this.lineThickness=e.lineThickness;this.lineOffset=e.lineOffset}n(h.prototype,{isConstant:{get:function(){return s.isConstant(this._color)&&s.isConstant(this._cellAlpha)&&s.isConstant(this._lineCount)&&s.isConstant(this._lineThickness)&&s.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:o("color"),cellAlpha:o("cellAlpha"),lineCount:o("lineCount"),lineThickness:o("lineThickness"),lineOffset:o("lineOffset")});h.prototype.getType=function(e){return"Grid"};h.prototype.getValue=function(e,t){if(!i(t)){t={}}t.color=s.getValueOrClonedDefault(this._color,e,l,t.color);t.cellAlpha=s.getValueOrDefault(this._cellAlpha,e,u);t.lineCount=s.getValueOrClonedDefault(this._lineCount,e,c,t.lineCount);t.lineThickness=s.getValueOrClonedDefault(this._lineThickness,e,f,t.lineThickness);t.lineOffset=s.getValueOrClonedDefault(this._lineOffset,e,d,t.lineOffset);return t};h.prototype.equals=function(e){return this===e||e instanceof h&&s.equals(this._color,e._color)&&s.equals(this._cellAlpha,e._cellAlpha)&&s.equals(this._lineCount,e._lineCount)&&s.equals(this._lineThickness,e._lineThickness)&&s.equals(this._lineOffset,e._lineOffset)};return h});define("DataSources/PolylineArrowMaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a){"use strict";function o(e){this._definitionChanged=new i;this._color=undefined;this._colorSubscription=undefined;this.color=e}r(o.prototype,{isConstant:{get:function(){return a.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:n("color")});o.prototype.getType=function(e){return"PolylineArrow"};o.prototype.getValue=function(r,i){if(!t(i)){i={}}i.color=a.getValueOrClonedDefault(this._color,r,e.WHITE,i.color);return i};o.prototype.equals=function(e){return this===e||e instanceof o&&a.equals(this._color,e._color)};return o});define("DataSources/PolylineDashMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o){"use strict";var s=e.WHITE;var l=e.TRANSPARENT;var u=16;var c=255;function d(e){e=t(e,t.EMPTY_OBJECT);this._definitionChanged=new n;this._color=undefined;this._colorSubscription=undefined;this._gapColor=undefined;this._gapColorSubscription=undefined;this._dashLength=undefined;this._dashLengthSubscription=undefined;this._dashPattern=undefined;this._dashPatternSubscription=undefined;this.color=e.color;this.gapColor=e.gapColor;this.dashLength=e.dashLength;this.dashPattern=e.dashPattern}i(d.prototype,{isConstant:{get:function(){return o.isConstant(this._color)&&o.isConstant(this._gapColor)&&o.isConstant(this._dashLength)&&o.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:a("color"),gapColor:a("gapColor"),dashLength:a("dashLength"),dashPattern:a("dashPattern")});d.prototype.getType=function(e){return"PolylineDash"};d.prototype.getValue=function(e,t){if(!r(t)){t={}}t.color=o.getValueOrClonedDefault(this._color,e,s,t.color);t.gapColor=o.getValueOrClonedDefault(this._gapColor,e,l,t.gapColor);t.dashLength=o.getValueOrDefault(this._dashLength,e,u,t.dashLength);t.dashPattern=o.getValueOrDefault(this._dashPattern,e,c,t.dashPattern);return t};d.prototype.equals=function(e){return this===e||e instanceof d&&o.equals(this._color,e._color)&&o.equals(this._gapColor,e._gapColor)&&o.equals(this._dashLength,e._dashLength)&&o.equals(this._dashPattern,e._dashPattern)};return d});define("DataSources/PolylineGlowMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o){"use strict";var s=e.WHITE;var l=.25;function u(e){e=t(e,t.EMPTY_OBJECT);this._definitionChanged=new n;this._color=undefined;this._colorSubscription=undefined;this._glowPower=undefined;this._glowPowerSubscription=undefined;this.color=e.color;this.glowPower=e.glowPower}i(u.prototype,{isConstant:{get:function(){return o.isConstant(this._color)&&o.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:a("color"),glowPower:a("glowPower")});u.prototype.getType=function(e){return"PolylineGlow"};u.prototype.getValue=function(e,t){if(!r(t)){t={}}t.color=o.getValueOrClonedDefault(this._color,e,s,t.color);t.glowPower=o.getValueOrDefault(this._glowPower,e,l,t.glowPower);return t};u.prototype.equals=function(e){return this===e||e instanceof u&&o.equals(this._color,e._color)&&o.equals(this._glowPower,e._glowPower)};return u});define("DataSources/PolylineOutlineMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,r,i,n,a,o){"use strict";var s=e.WHITE;var l=e.BLACK;var u=1;function c(e){e=t(e,t.EMPTY_OBJECT);this._definitionChanged=new n;this._color=undefined;this._colorSubscription=undefined;this._outlineColor=undefined;this._outlineColorSubscription=undefined;this._outlineWidth=undefined;this._outlineWidthSubscription=undefined;this.color=e.color;this.outlineColor=e.outlineColor;this.outlineWidth=e.outlineWidth}i(c.prototype,{isConstant:{get:function(){return o.isConstant(this._color)&&o.isConstant(this._outlineColor)&&o.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:a("color"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth")});c.prototype.getType=function(e){return"PolylineOutline"};c.prototype.getValue=function(e,t){if(!r(t)){t={}}t.color=o.getValueOrClonedDefault(this._color,e,s,t.color);t.outlineColor=o.getValueOrClonedDefault(this._outlineColor,e,l,t.outlineColor);t.outlineWidth=o.getValueOrDefault(this._outlineWidth,e,u);return t};c.prototype.equals=function(e){return this===e||e instanceof c&&o.equals(this._color,e._color)&&o.equals(this._outlineColor,e._outlineColor)&&o.equals(this._outlineWidth,e._outlineWidth)};return c});define("DataSources/PositionPropertyArray",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","../Core/ReferenceFrame","./Property"],function(e,t,r,i,n,a,o,s){"use strict";function l(t,r){this._value=undefined;this._definitionChanged=new n;this._eventHelper=new a;this._referenceFrame=e(r,o.FIXED);this.setValue(t)}r(l.prototype,{isConstant:{get:function(){var e=this._value;if(!t(e)){return true}var r=e.length;for(var i=0;i<r;i++){if(!s.isConstant(e[i])){return false}}return true}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});l.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)};l.prototype.getValueInReferenceFrame=function(e,r,n){if(!t(e)){throw new i("time is required.")}if(!t(r)){throw new i("referenceFrame is required.")}var a=this._value;if(!t(a)){return undefined}var o=a.length;if(!t(n)){n=new Array(o)}var s=0;var l=0;while(s<o){var u=a[s];var c=u.getValueInReferenceFrame(e,r,n[s]);if(t(c)){n[l]=c;l++}s++}n.length=l;return n};l.prototype.setValue=function(e){var r=this._eventHelper;r.removeAll();if(t(e)){this._value=e.slice();var i=e.length;for(var n=0;n<i;n++){var a=e[n];if(t(a)){r.add(a.definitionChanged,l.prototype._raiseDefinitionChanged,this)}}}else{this._value=undefined}this._definitionChanged.raiseEvent(this)};l.prototype.equals=function(e){return this===e||e instanceof l&&this._referenceFrame===e._referenceFrame&&s.arrayEquals(this._value,e._value)};l.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return l});define("DataSources/PropertyArray",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","./Property"],function(e,t,r,i,n,a){"use strict";function o(e){this._value=undefined;this._definitionChanged=new i;this._eventHelper=new n;this.setValue(e)}t(o.prototype,{isConstant:{get:function(){var t=this._value;if(!e(t)){return true}var r=t.length;for(var i=0;i<r;i++){if(!a.isConstant(t[i])){return false}}return true}},definitionChanged:{get:function(){return this._definitionChanged}}});o.prototype.getValue=function(t,i){if(!e(t)){throw new r("time is required.")}var n=this._value;if(!e(n)){return undefined}var a=n.length;if(!e(i)){i=new Array(a)}var o=0;var s=0;while(o<a){var l=this._value[o];var u=l.getValue(t,i[o]);if(e(u)){i[s]=u;s++}o++}i.length=s;return i};o.prototype.setValue=function(t){var r=this._eventHelper;r.removeAll();if(e(t)){this._value=t.slice();var i=t.length;for(var n=0;n<i;n++){var a=t[n];if(e(a)){r.add(a.definitionChanged,o.prototype._raiseDefinitionChanged,this)}}}else{this._value=undefined}this._definitionChanged.raiseEvent(this)};o.prototype.equals=function(e){return this===e||e instanceof o&&a.arrayEquals(this._value,e._value)};o.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return o});define("DataSources/ReferenceProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/RuntimeError","./Property"],function(e,t,r,i,n,a){"use strict";function o(t){var r=true;if(t._resolveEntity){var i=t._targetCollection.getById(t._targetId);if(e(i)){i.definitionChanged.addEventListener(l.prototype._onTargetEntityDefinitionChanged,t);t._targetEntity=i;t._resolveEntity=false}else{i=t._targetEntity;r=false}if(!e(i)){throw new n('target entity "'+t._targetId+'" could not be resolved.')}}return r}function s(t){var r=t._targetProperty;if(t._resolveProperty){var i=o(t);var a=t._targetPropertyNames;r=t._targetEntity;var s=a.length;for(var l=0;l<s&&e(r);l++){r=r[a[l]]}if(e(r)){t._targetProperty=r;t._resolveProperty=!i}else if(!e(t._targetProperty)){throw new n('targetProperty "'+t._targetId+"."+a.join(".")+'" could not be resolved.')}}return r}function l(t,n,a){if(!e(t)){throw new r("targetCollection is required.")}if(!e(n)||n===""){throw new r("targetId is required.")}if(!e(a)||a.length===0){throw new r("targetPropertyNames is required.")}for(var o=0;o<a.length;o++){var s=a[o];if(!e(s)||s===""){throw new r("reference contains invalid properties.")}}this._targetCollection=t;this._targetId=n;this._targetPropertyNames=a;this._targetProperty=undefined;this._targetEntity=undefined;this._definitionChanged=new i;this._resolveEntity=true;this._resolveProperty=true;t.collectionChanged.addEventListener(l.prototype._onCollectionChanged,this)}t(l.prototype,{isConstant:{get:function(){return a.isConstant(s(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return s(this).referenceFrame}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return s(this)}}});l.fromString=function(t,i){if(!e(t)){throw new r("targetCollection is required.")}if(!e(i)){throw new r("referenceString is required.")}var n;var a=[];var o=true;var s=false;var u="";for(var c=0;c<i.length;++c){var d=i.charAt(c);if(s){u+=d;s=false}else if(d==="\\"){s=true}else if(o&&d==="#"){n=u;o=false;u=""}else if(!o&&d==="."){a.push(u);u=""}else{u+=d}}a.push(u);return new l(t,n,a)};l.prototype.getValue=function(e,t){return s(this).getValue(e,t)};l.prototype.getValueInReferenceFrame=function(e,t,r){return s(this).getValueInReferenceFrame(e,t,r)};l.prototype.getType=function(e){return s(this).getType(e)};l.prototype.equals=function(e){if(this===e){return true}var t=this._targetPropertyNames;var r=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==r.length){return false}var i=this._targetPropertyNames.length;for(var n=0;n<i;n++){if(t[n]!==r[n]){return false}}return true};l.prototype._onTargetEntityDefinitionChanged=function(e,t,r,i){if(this._targetPropertyNames[0]===t){this._resolveProperty=true;this._definitionChanged.raiseEvent(this)}};l.prototype._onCollectionChanged=function(t,r,i){var n=this._targetEntity;if(e(n)){if(i.indexOf(n)!==-1){n.definitionChanged.removeEventListener(l.prototype._onTargetEntityDefinitionChanged,this);this._resolveEntity=true;this._resolveProperty=true}else if(this._resolveEntity){s(this);if(!this._resolveEntity){this._definitionChanged.raiseEvent(this)}}}};return l});define("DataSources/Rotation",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Math"],function(e,t,r,i){"use strict";var n={packedLength:1,pack:function(i,n,a){if(!t(i)){throw new r("value is required")}if(!t(n)){throw new r("array is required")}a=e(a,0);n[a]=i;return n},unpack:function(i,n,a){if(!t(i)){throw new r("array is required")}n=e(n,0);return i[n]},convertPackedArrayForInterpolation:function(n,a,o,s){if(!t(n)){throw new r("packedArray is required")}a=e(a,0);o=e(o,n.length);var l;for(var u=0,c=o-a+1;u<c;u++){var d=n[a+u];if(u===0||Math.abs(l-d)<Math.PI){s[u]=d}else{s[u]=d-i.TWO_PI}l=d}},unpackInterpolationResult:function(e,n,a,o,s){if(!t(e)){throw new r("array is required")}if(!t(n)){throw new r("sourceArray is required")}s=e[0];if(s<0){return s+i.TWO_PI}return s}};return n});define("DataSources/SampledProperty",["../Core/binarySearch","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ExtrapolationType","../Core/JulianDate","../Core/LinearApproximation"],function(e,t,r,i,n,a,o,s,l){"use strict";var u={packedLength:1,pack:function(e,r,i){i=t(i,0);r[i]=e},unpack:function(e,r,i){r=t(r,0);return e[r]}};function c(e,t,r){var i;var n=e.length;var a=r.length;var o=n+a;e.length=o;if(n!==t){var s=n-1;for(i=o-1;i>=t;i--){e[i]=e[s--]}}for(i=0;i<a;i++){e[t++]=r[i]}}function d(e,t){if(e instanceof s){return e}if(typeof e==="string"){return s.fromIso8601(e)}return s.addSeconds(t,e,new s)}var f=[];var h=[];function p(t,i,n,a,o){var l=0;var u;var p;var m;var v;var g;var _;while(l<a.length){g=d(a[l],t);m=e(i,g,s.compare);var y=0;var b=0;if(m<0){m=~m;v=m*o;p=undefined;_=i[m];while(l<a.length){g=d(a[l],t);if(r(p)&&s.compare(p,g)>=0||r(_)&&s.compare(g,_)>=0){break}f[y++]=g;l=l+1;for(u=0;u<o;u++){h[b++]=a[l];l=l+1}p=g}if(y>0){h.length=b;c(n,v,h);f.length=y;c(i,m,f)}}else{for(u=0;u<o;u++){l++;n[m*o+u]=a[l]}l++}}}function m(e,i){if(!r(e)){throw new n("type is required.")}var s=e;if(s===Number){s=u}var c=s.packedLength;var d=t(s.packedInterpolationLength,c);var f=0;var h;if(r(i)){var p=i.length;h=new Array(p);for(var m=0;m<p;m++){var v=i[m];if(v===Number){v=u}var g=v.packedLength;c+=g;d+=t(v.packedInterpolationLength,g);h[m]=v}f=p}this._type=e;this._innerType=s;this._interpolationDegree=1;this._interpolationAlgorithm=l;this._numberOfPoints=0;this._times=[];this._values=[];this._xTable=[];this._yTable=[];this._packedLength=c;this._packedInterpolationLength=d;this._updateTableLength=true;this._interpolationResult=new Array(d);this._definitionChanged=new a;this._derivativeTypes=i;this._innerDerivativeTypes=h;this._inputOrder=f;this._forwardExtrapolationType=o.NONE;this._forwardExtrapolationDuration=0;this._backwardExtrapolationType=o.NONE;this._backwardExtrapolationDuration=0}i(m.prototype,{isConstant:{get:function(){return this._values.length===0}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){if(this._forwardExtrapolationType!==e){this._forwardExtrapolationType=e;this._definitionChanged.raiseEvent(this)}}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){if(this._forwardExtrapolationDuration!==e){this._forwardExtrapolationDuration=e;this._definitionChanged.raiseEvent(this)}}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){if(this._backwardExtrapolationType!==e){this._backwardExtrapolationType=e;this._definitionChanged.raiseEvent(this)}}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){if(this._backwardExtrapolationDuration!==e){this._backwardExtrapolationDuration=e;this._definitionChanged.raiseEvent(this)}}}});m.prototype.getValue=function(t,i){if(!r(t)){throw new n("time is required.")}var a=this._times;var l=a.length;if(l===0){return undefined}var u;var c=this._innerType;var d=this._values;var f=e(a,t,s.compare);if(f<0){f=~f;if(f===0){var h=a[f];u=this._backwardExtrapolationDuration;if(this._backwardExtrapolationType===o.NONE||u!==0&&s.secondsDifference(h,t)>u){return undefined}if(this._backwardExtrapolationType===o.HOLD){return c.unpack(d,0,i)}}if(f>=l){f=l-1;var p=a[f];u=this._forwardExtrapolationDuration;if(this._forwardExtrapolationType===o.NONE||u!==0&&s.secondsDifference(t,p)>u){return undefined}if(this._forwardExtrapolationType===o.HOLD){f=l-1;return c.unpack(d,f*c.packedLength,i)}}var m=this._xTable;var v=this._yTable;var g=this._interpolationAlgorithm;var _=this._packedInterpolationLength;var y=this._inputOrder;if(this._updateTableLength){this._updateTableLength=false;var b=Math.min(g.getRequiredDataPoints(this._interpolationDegree,y),l);if(b!==this._numberOfPoints){this._numberOfPoints=b;m.length=b;v.length=b*_}}var w=this._numberOfPoints-1;if(w<1){return undefined}var C=0;var S=l-1;var T=S-C+1;if(T>=w+1){var E=f-(w/2|0)-1;if(E<C){E=C}var x=E+w;if(x>S){x=S;E=x-w;if(E<C){E=C}}C=E;S=x}var P=S-C+1;for(var A=0;A<P;++A){m[A]=s.secondsDifference(a[C+A],a[S])}if(!r(c.convertPackedArrayForInterpolation)){var O=0;var D=this._packedLength;var I=C*D;var M=(S+1)*D;while(I<M){v[O]=d[I];I++;O++}}else{c.convertPackedArrayForInterpolation(d,C,S,v)}var R=s.secondsDifference(t,a[S]);var L;if(y===0||!r(g.interpolate)){L=g.interpolateOrderZero(R,m,v,_,this._interpolationResult)}else{var N=Math.floor(_/(y+1));L=g.interpolate(R,m,v,N,y,y,this._interpolationResult)}if(!r(c.unpackInterpolationResult)){return c.unpack(L,0,i)}return c.unpackInterpolationResult(L,d,C,S,i)}return c.unpack(d,f*this._packedLength,i)};m.prototype.setInterpolationOptions=function(e){if(!r(e)){return}var t=false;var i=e.interpolationAlgorithm;var n=e.interpolationDegree;if(r(i)&&this._interpolationAlgorithm!==i){this._interpolationAlgorithm=i;t=true}if(r(n)&&this._interpolationDegree!==n){this._interpolationDegree=n;t=true}if(t){this._updateTableLength=true;this._definitionChanged.raiseEvent(this)}};m.prototype.addSample=function(e,t,i){var a=this._innerDerivativeTypes;var o=r(a);if(!r(e)){throw new n("time is required.")}if(!r(t)){throw new n("value is required.")}if(o&&!r(i)){throw new n("derivatives is required.")}var s=this._innerType;var l=[];l.push(e);s.pack(t,l,l.length);if(o){var u=a.length;for(var c=0;c<u;c++){a[c].pack(i[c],l,l.length)}}p(undefined,this._times,this._values,l,this._packedLength);this._updateTableLength=true;this._definitionChanged.raiseEvent(this)};m.prototype.addSamples=function(e,t,i){var a=this._innerDerivativeTypes;var o=r(a);if(!r(e)){throw new n("times is required.")}if(!r(t)){throw new n("values is required.")}if(e.length!==t.length){throw new n("times and values must be the same length.")}if(o&&(!r(i)||i.length!==e.length)){throw new n("times and derivativeValues must be the same length.")}var s=this._innerType;var l=e.length;var u=[];for(var c=0;c<l;c++){u.push(e[c]);s.pack(t[c],u,u.length);if(o){var d=i[c];var f=a.length;for(var h=0;h<f;h++){a[h].pack(d[h],u,u.length)}}}p(undefined,this._times,this._values,u,this._packedLength);this._updateTableLength=true;this._definitionChanged.raiseEvent(this)};m.prototype.addSamplesPackedArray=function(e,t){if(!r(e)){throw new n("packedSamples is required.")}p(t,this._times,this._values,e,this._packedLength);this._updateTableLength=true;this._definitionChanged.raiseEvent(this)};m.prototype.equals=function(e){if(this===e){return true}if(!r(e)){return false}if(this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm){return false}var t=this._derivativeTypes;var i=r(t);var n=e._derivativeTypes;var a=r(n);if(i!==a){return false}var o;var l;if(i){l=t.length;if(l!==n.length){return false}for(o=0;o<l;o++){if(t[o]!==n[o]){return false}}}var u=this._times;var c=e._times;l=u.length;if(l!==c.length){return false}for(o=0;o<l;o++){if(!s.equals(u[o],c[o])){return false}}var d=this._values;var f=e._values;for(o=0;o<l;o++){if(d[o]!==f[o]){return false}}return true};m._mergeNewSamples=p;return m});define("DataSources/SampledPositionProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./PositionProperty","./Property","./SampledProperty"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(r,i){i=t(i,0);var n;if(i>0){n=new Array(i);for(var s=0;s<i;s++){n[s]=e}}this._numberOfDerivatives=i;this._property=new u(e,n);this._definitionChanged=new a;this._referenceFrame=t(r,o.FIXED);this._property._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}i(c.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}});c.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)};c.prototype.getValueInReferenceFrame=function(e,t,i){if(!r(e)){throw new n("time is required.")}if(!r(t)){throw new n("referenceFrame is required.")}i=this._property.getValue(e,i);if(r(i)){return s.convertToReferenceFrame(e,i,this._referenceFrame,t,i)}return undefined};c.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)};c.prototype.addSample=function(e,t,i){var a=this._numberOfDerivatives;if(a>0&&(!r(i)||i.length!==a)){throw new n("derivatives length must be equal to the number of derivatives.")}this._property.addSample(e,t,i)};c.prototype.addSamples=function(e,t,r){this._property.addSamples(e,t,r)};c.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)};c.prototype.equals=function(e){return this===e||e instanceof c&&l.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame};return c});define("DataSources/StripeOrientation",["../Core/freezeObject"],function(e){"use strict";var t={HORIZONTAL:0,VERTICAL:1};return e(t)});define("DataSources/StripeMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property","./StripeOrientation"],function(e,t,r,i,n,a,o,s){"use strict";var l=s.HORIZONTAL;var u=e.WHITE;var c=e.BLACK;var d=0;var f=1;function h(e){e=t(e,t.EMPTY_OBJECT);this._definitionChanged=new n;this._orientation=undefined;this._orientationSubscription=undefined;this._evenColor=undefined;this._evenColorSubscription=undefined;this._oddColor=undefined;this._oddColorSubscription=undefined;this._offset=undefined;this._offsetSubscription=undefined;this._repeat=undefined;this._repeatSubscription=undefined;this.orientation=e.orientation;this.evenColor=e.evenColor;this.oddColor=e.oddColor;this.offset=e.offset;this.repeat=e.repeat}i(h.prototype,{isConstant:{get:function(){return o.isConstant(this._orientation)&&o.isConstant(this._evenColor)&&o.isConstant(this._oddColor)&&o.isConstant(this._offset)&&o.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:a("orientation"),evenColor:a("evenColor"),oddColor:a("oddColor"),offset:a("offset"),repeat:a("repeat")});h.prototype.getType=function(e){return"Stripe"};h.prototype.getValue=function(e,t){if(!r(t)){t={}}t.horizontal=o.getValueOrDefault(this._orientation,e,l)===s.HORIZONTAL;t.evenColor=o.getValueOrClonedDefault(this._evenColor,e,u,t.evenColor);t.oddColor=o.getValueOrClonedDefault(this._oddColor,e,c,t.oddColor);t.offset=o.getValueOrDefault(this._offset,e,d);t.repeat=o.getValueOrDefault(this._repeat,e,f);return t};h.prototype.equals=function(e){return this===e||e instanceof h&&o.equals(this._orientation,e._orientation)&&o.equals(this._evenColor,e._evenColor)&&o.equals(this._oddColor,e._oddColor)&&o.equals(this._offset,e._offset)&&o.equals(this._repeat,e._repeat)};return h});define("DataSources/TimeIntervalCollectionPositionProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","../Core/TimeIntervalCollection","./PositionProperty","./Property"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(t){this._definitionChanged=new n;this._intervals=new o;this._intervals.changedEvent.addEventListener(u.prototype._intervalsChanged,this);this._referenceFrame=e(t,a.FIXED)}r(u.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}});u.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,a.FIXED,t)};u.prototype.getValueInReferenceFrame=function(e,r,n){if(!t(e)){throw new i("time is required.")}if(!t(r)){throw new i("referenceFrame is required.")}var a=this._intervals.findDataForIntervalContainingDate(e);if(t(a)){return s.convertToReferenceFrame(e,a,this._referenceFrame,r,n)}return undefined};u.prototype.equals=function(e){return this===e||e instanceof u&&this._intervals.equals(e._intervals,l.equals)&&this._referenceFrame===e._referenceFrame};u.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};return u});define("DataSources/TimeIntervalCollectionProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/TimeIntervalCollection","./Property"],function(e,t,r,i,n,a){"use strict";function o(){this._definitionChanged=new i;this._intervals=new n;this._intervals.changedEvent.addEventListener(o.prototype._intervalsChanged,this)}t(o.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});o.prototype.getValue=function(t,i){if(!e(t)){throw new r("time is required")}var n=this._intervals.findDataForIntervalContainingDate(t);if(e(n)&&typeof n.clone==="function"){return n.clone(i)}return n};o.prototype.equals=function(e){return this===e||e instanceof o&&this._intervals.equals(e._intervals,a.equals)};o.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};return o});define("DataSources/VelocityVectorProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","./Property"],function(e,t,r,i,n,a,o,s){"use strict";function l(e,r){this._position=undefined;this._subscription=undefined;this._definitionChanged=new a;this._normalize=t(r,true);this.position=e}i(l.prototype,{isConstant:{get:function(){return s.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){var t=this._position;if(t!==e){if(r(t)){this._subscription()}this._position=e;if(r(e)){this._subscription=e._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}this._definitionChanged.raiseEvent(this)}}},normalize:{get:function(){return this._normalize},set:function(e){if(this._normalize===e){return}this._normalize=e;this._definitionChanged.raiseEvent(this)}}});var u=new e;var c=new e;var d=new o;var f=1/60;l.prototype.getValue=function(e,t){return this._getValue(e,t)};l.prototype._getValue=function(t,i,a){if(!r(t)){throw new n("time is required")}if(!r(i)){i=new e}var l=this._position;if(s.isConstant(l)){return this._normalize?undefined:e.clone(e.ZERO,i)}var h=l.getValue(t,u);var p=l.getValue(o.addSeconds(t,f,d),c);if(!r(h)){return undefined}if(!r(p)){p=h;h=l.getValue(o.addSeconds(t,-f,d),c);if(!r(h)){return undefined}}if(e.equals(h,p)){return this._normalize?undefined:e.clone(e.ZERO,i)}if(r(a)){h.clone(a)}var m=e.subtract(p,h,i);if(this._normalize){return e.normalize(m,i)}return e.divideByScalar(m,f,i)};l.prototype.equals=function(e){return this===e||e instanceof l&&s.equals(this._position,e._position)};return l});define("DataSources/CzmlDataSource",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/ClockRange","../Core/ClockStep","../Core/Color","../Core/CornerType","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/ExtrapolationType","../Core/getAbsoluteUri","../Core/getFilenameFromUri","../Core/HermitePolynomialApproximation","../Core/isArray","../Core/Iso8601","../Core/joinUrls","../Core/JulianDate","../Core/LagrangePolynomialApproximation","../Core/LinearApproximation","../Core/loadJson","../Core/Math","../Core/NearFarScalar","../Core/objectToQuery","../Core/Quaternion","../Core/Rectangle","../Core/ReferenceFrame","../Core/RuntimeError","../Core/Spherical","../Core/TimeInterval","../Core/TimeIntervalCollection","../Scene/ColorBlendMode","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/ShadowMode","../Scene/VerticalOrigin","../ThirdParty/Uri","../ThirdParty/when","./BillboardGraphics","./BoxGraphics","./ColorMaterialProperty","./CompositeMaterialProperty","./CompositePositionProperty","./CompositeProperty","./ConstantPositionProperty","./ConstantProperty","./CorridorGraphics","./CylinderGraphics","./DataSource","./DataSourceClock","./EllipseGraphics","./EllipsoidGraphics","./EntityCluster","./EntityCollection","./GridMaterialProperty","./ImageMaterialProperty","./LabelGraphics","./ModelGraphics","./NodeTransformationProperty","./PathGraphics","./PointGraphics","./PolygonGraphics","./PolylineArrowMaterialProperty","./PolylineDashMaterialProperty","./PolylineGlowMaterialProperty","./PolylineGraphics","./PolylineOutlineMaterialProperty","./PositionPropertyArray","./PropertyArray","./PropertyBag","./RectangleGraphics","./ReferenceProperty","./Rotation","./SampledPositionProperty","./SampledProperty","./StripeMaterialProperty","./StripeOrientation","./TimeIntervalCollectionPositionProperty","./TimeIntervalCollectionProperty","./VelocityVectorProperty","./WallGraphics"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U,V,z,q,G,H,j,W,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,ae,oe,se,le,ue,ce,de,fe,he,pe,me,ve,ge,_e,ye,be,we,Ce,Se,Te,Ee,xe,Pe,Ae,Oe,De,Ie,Me){"use strict";var Re;function Le(e,t){if(t[0]==="#"){t=Re+t}return Se.fromString(e,t)}var Ne=new r;var ke=new R;var Fe=new i;var Be=new L;function Ue(e){var t=e.rgbaf;if(c(t)){return t}var r=e.rgba;if(!c(r)){return undefined}var i=r.length;if(i===o.packedLength){return[o.byteToFloat(r[0]),o.byteToFloat(r[1]),o.byteToFloat(r[2]),o.byteToFloat(r[3])]}t=new Array(i);for(var n=0;n<i;n+=5){t[n]=r[n];t[n+1]=o.byteToFloat(r[n+1]);t[n+2]=o.byteToFloat(r[n+2]);t[n+3]=o.byteToFloat(r[n+3]);t[n+4]=o.byteToFloat(r[n+4])}return t}function Ve(e,t,r){var i=u(e.uri,e);if(c(t)){i=v(i,v(t));if(c(r)){i=w(i,"?"+r,false)}}return i}function ze(e){var t=e.wsen;if(c(t)){return t}var r=e.wsenDegrees;if(!c(r)){return undefined}var i=r.length;if(i===D.packedLength){return[x.toRadians(r[0]),x.toRadians(r[1]),x.toRadians(r[2]),x.toRadians(r[3])]}t=new Array(i);for(var n=0;n<i;n+=5){t[n]=r[n];t[n+1]=x.toRadians(r[n+1]);t[n+2]=x.toRadians(r[n+2]);t[n+3]=x.toRadians(r[n+3]);t[n+4]=x.toRadians(r[n+4])}return t}function qe(e){var t=e.length;ke.magnitude=1;if(t===2){ke.clock=e[0];ke.cone=e[1];r.fromSpherical(ke,Ne);return[Ne.x,Ne.y,Ne.z]}var i=new Array(t/3*4);for(var n=0,a=0;n<t;n+=3,a+=4){i[a]=e[n];ke.clock=e[n+1];ke.cone=e[n+2];r.fromSpherical(ke,Ne);i[a+1]=Ne.x;i[a+2]=Ne.y;i[a+3]=Ne.z}return i}function Ge(e){var t=e.length;if(t===3){ke.clock=e[0];ke.cone=e[1];ke.magnitude=e[2];r.fromSpherical(ke,Ne);return[Ne.x,Ne.y,Ne.z]}var i=new Array(t);for(var n=0;n<t;n+=4){i[n]=e[n];ke.clock=e[n+1];ke.cone=e[n+2];ke.magnitude=e[n+3];r.fromSpherical(ke,Ne);i[n+1]=Ne.x;i[n+2]=Ne.y;i[n+3]=Ne.z}return i}function He(e){var t=e.length;if(t===3){Fe.longitude=e[0];Fe.latitude=e[1];Fe.height=e[2];h.WGS84.cartographicToCartesian(Fe,Ne);return[Ne.x,Ne.y,Ne.z]}var r=new Array(t);for(var i=0;i<t;i+=4){r[i]=e[i];Fe.longitude=e[i+1];Fe.latitude=e[i+2];Fe.height=e[i+3];h.WGS84.cartographicToCartesian(Fe,Ne);r[i+1]=Ne.x;r[i+2]=Ne.y;r[i+3]=Ne.z}return r}function je(e){var t=e.length;if(t===3){Fe.longitude=x.toRadians(e[0]);Fe.latitude=x.toRadians(e[1]);Fe.height=e[2];h.WGS84.cartographicToCartesian(Fe,Ne);return[Ne.x,Ne.y,Ne.z]}var r=new Array(t);for(var i=0;i<t;i+=4){r[i]=e[i];Fe.longitude=x.toRadians(e[i+1]);Fe.latitude=x.toRadians(e[i+2]);Fe.height=e[i+3];h.WGS84.cartographicToCartesian(Fe,Ne);r[i+1]=Ne.x;r[i+2]=Ne.y;r[i+3]=Ne.z}return r}function We(e){var t=e.cartesian;if(c(t)){return t}var r=e.cartesianVelocity;if(c(r)){return r}var i=e.unitCartesian;if(c(i)){return i}var n=e.unitSpherical;if(c(n)){return qe(n)}var a=e.spherical;if(c(a)){return Ge(a)}var o=e.cartographicRadians;if(c(o)){return He(o)}var s=e.cartographicDegrees;if(c(s)){return je(s)}throw new M(JSON.stringify(e)+" is not a valid CZML interval.")}function Ye(e,t){var r=e[t];var i=e[t+1];var n=e[t+2];var a=e[t+3];var o=1/Math.sqrt(r*r+i*i+n*n+a*a);e[t]=r*o;e[t+1]=i*o;e[t+2]=n*o;e[t+3]=a*o}function Xe(e){var t=e.unitQuaternion;if(c(t)){if(t.length===4){Ye(t,0);return t}for(var r=1;r<t.length;r+=5){Ye(t,r)}}return t}function Qe(i){if(typeof i==="boolean"){return Boolean}else if(typeof i==="number"){return Number}else if(typeof i==="string"){return String}else if(i.hasOwnProperty("array")){return Array}else if(i.hasOwnProperty("boolean")){return Boolean}else if(i.hasOwnProperty("boundingRectangle")){return e}else if(i.hasOwnProperty("cartesian2")){return t}else if(i.hasOwnProperty("cartesian")||i.hasOwnProperty("unitCartesian")||i.hasOwnProperty("unitSpherical")||i.hasOwnProperty("spherical")||i.hasOwnProperty("cartographicRadians")||i.hasOwnProperty("cartographicDegrees")){return r}else if(i.hasOwnProperty("rgba")||i.hasOwnProperty("rgbaf")){return o}else if(i.hasOwnProperty("colorBlendMode")){return k}else if(i.hasOwnProperty("cornerType")){return s}else if(i.hasOwnProperty("heightReference")){return F}else if(i.hasOwnProperty("horizontalOrigin")){return B}else if(i.hasOwnProperty("date")){return C}else if(i.hasOwnProperty("labelStyle")){return U}else if(i.hasOwnProperty("number")){return Number}else if(i.hasOwnProperty("nearFarScalar")){return P}else if(i.hasOwnProperty("object")||i.hasOwnProperty("value")){return Object}else if(i.hasOwnProperty("unitQuaternion")){return O}else if(i.hasOwnProperty("shadowMode")){return V}else if(i.hasOwnProperty("string")){return String}else if(i.hasOwnProperty("stripeOrientation")){return Ae}else if(i.hasOwnProperty("wsen")||i.hasOwnProperty("wsenDegrees")){return D}else if(i.hasOwnProperty("uri")){return q}else if(i.hasOwnProperty("verticalOrigin")){return z}return Object}function Ze(i,n,a,l){switch(i){case Array:return n.array;case Boolean:return u(n["boolean"],n);case e:return n.boundingRectangle;case t:return n.cartesian2;case r:return We(n);case o:return Ue(n);case k:return k[u(n.colorBlendMode,n)];case s:return s[u(n.cornerType,n)];case F:return F[u(n.heightReference,n)];case B:return B[u(n.horizontalOrigin,n)];case Image:return Ve(n,a,l);case C:return C.fromIso8601(u(n.date,n));case U:return U[u(n.labelStyle,n)];case Number:return u(n.number,n);case P:return n.nearFarScalar;case Object:return u(u(n.object,n.value),n);case O:return Xe(n);case Te:return u(n.number,n);case V:return V[u(u(n.shadowMode,n.shadows),n)];case String:return u(n.string,n);case Ae:return Ae[u(n.stripeOrientation,n)];case D:return ze(n);case q:return Ve(n,a,l);case z:return z[u(n.verticalOrigin,n)];default:throw new M(i)}}var Ke={HERMITE:_,LAGRANGE:S,LINEAR:T};function Je(e,t){var r=e.interpolationAlgorithm;if(c(r)||c(e.interpolationDegree)){t.setInterpolationOptions({interpolationAlgorithm:Ke[r],interpolationDegree:e.interpolationDegree})}var i=e.forwardExtrapolationType;if(c(i)){t.forwardExtrapolationType=m[i]}var n=e.forwardExtrapolationDuration;if(c(n)){t.forwardExtrapolationDuration=n}var a=e.backwardExtrapolationType;if(c(a)){t.backwardExtrapolationType=m[a]}var o=e.backwardExtrapolationDuration;if(c(o)){t.backwardExtrapolationDuration=o}}var $e={iso8601:undefined};function et(e,t,r,i,n,a,o,s){var l;var d=i.interval;if(c(d)){$e.iso8601=d;l=L.fromIso8601($e);if(c(n)){l=L.intersect(l,n,Be)}}else if(c(n)){l=n}var f;var h;var p;var m;var v=c(i.reference);var g=c(l)&&!l.equals(b.MAXIMUM_INTERVAL);if(!v){p=Ze(e,i,a,s);f=u(e.packedLength,1);m=u(p.length,1);h=!c(i.array)&&typeof p!=="string"&&m>f&&e!==Object}var _=typeof e.unpack==="function"&&e!==Te;if(!h&&!g){if(v){t[r]=Le(o,i.reference)}else if(_){t[r]=new K(e.unpack(p,0))}else{t[r]=new K(p)}return}var y=t[r];var w;var S=i.epoch;if(c(S)){w=C.fromIso8601(S)}if(h&&!g){if(!(y instanceof xe)){y=new xe(e);t[r]=y}y.addSamplesPackedArray(p,w);Je(i,y);return}var T;if(!h&&g){l=l.clone();if(v){l.data=Le(o,i.reference)}else if(_){l.data=e.unpack(p,0)}else{l.data=p}if(!c(y)){if(v){y=new Q}else{y=new De}t[r]=y}if(!v&&y instanceof De){y.intervals.addInterval(l)}else if(y instanceof Q){l.data=v?l.data:new K(l.data);y.intervals.addInterval(l)}else{T=b.MAXIMUM_INTERVAL.clone();T.data=y;y=new Q;t[r]=y;y.intervals.addInterval(T);l.data=v?l.data:new K(l.data);y.intervals.addInterval(l)}return}if(!c(y)){y=new Q;t[r]=y}if(!(y instanceof Q)){T=b.MAXIMUM_INTERVAL.clone();T.data=y;y=new Q;t[r]=y;y.intervals.addInterval(T)}var E=y.intervals;T=E.findInterval(l);if(!c(T)||!(T.data instanceof xe)){T=l.clone();T.data=new xe(e);E.addInterval(T)}T.data.addSamplesPackedArray(p,w);Je(i,T.data)}function tt(e,t,r,i,n,a,o,s){if(!c(i)){return}if(y(i)){for(var l=0,u=i.length;l<u;l++){et(e,t,r,i[l],n,a,o,s)}}else{et(e,t,r,i,n,a,o,s)}}function rt(e,t,i,n,a,o,s){var l;var d=i.interval;if(c(d)){$e.iso8601=d;l=L.fromIso8601($e);if(c(n)){l=L.intersect(l,n,Be)}}else if(c(n)){l=n}var f;var h;var p=false;var m;var v=c(i.cartesianVelocity)?1:0;var g=r.packedLength*(v+1);var _=c(i.reference);var y=c(l)&&!l.equals(b.MAXIMUM_INTERVAL);if(!_){if(c(i.referenceFrame)){f=I[i.referenceFrame]}f=u(f,I.FIXED);h=We(i);m=u(h.length,1);p=m>g}if(!p&&!y){if(_){e[t]=Le(o,i.reference)}else{e[t]=new Z(r.unpack(h),f)}return}var w=e[t];var S;var T=i.epoch;if(c(T)){S=C.fromIso8601(T)}if(p&&!y){if(!(w instanceof Ee)||c(f)&&w.referenceFrame!==f){w=new Ee(f,v);e[t]=w}w.addSamplesPackedArray(h,S);Je(i,w);return}var E;if(!p&&y){l=l.clone();if(_){l.data=Le(o,i.reference)}else{l.data=r.unpack(h)}if(!c(w)){if(_){w=new X(f)}else{w=new Oe(f)}e[t]=w}if(!_&&w instanceof Oe&&(c(f)&&w.referenceFrame===f)){w.intervals.addInterval(l)}else if(w instanceof X){l.data=_?l.data:new Z(l.data,f);w.intervals.addInterval(l)}else{E=b.MAXIMUM_INTERVAL.clone();E.data=w;w=new X(w.referenceFrame);e[t]=w;w.intervals.addInterval(E);l.data=_?l.data:new Z(l.data,f);w.intervals.addInterval(l)}return}if(!c(w)){w=new X(f);e[t]=w}else if(!(w instanceof X)){E=b.MAXIMUM_INTERVAL.clone();E.data=w;w=new X(w.referenceFrame);e[t]=w;w.intervals.addInterval(E)}var x=w.intervals;E=x.findInterval(l);if(!c(E)||!(E.data instanceof Ee)||c(f)&&E.data.referenceFrame!==f){E=l.clone();E.data=new Ee(f,v);x.addInterval(E)}E.data.addSamplesPackedArray(h,S);Je(i,E.data)}function it(e,t,r,i,n,a,o){if(!c(r)){return}if(y(r)){for(var s=0,l=r.length;s<l;s++){rt(e,t,r[s],i,n,a,o)}}else{rt(e,t,r,i,n,a,o)}}function nt(e,r,i,n,a,s,l){var u;var d=i.interval;if(c(d)){$e.iso8601=d;u=L.fromIso8601($e);if(c(n)){u=L.intersect(u,n,Be)}}else if(c(n)){u=n}var f=e[r];var h;var p;if(c(u)){if(!(f instanceof Y)){f=new Y;e[r]=f}var m=f.intervals;p=m.findInterval({start:u.start,stop:u.stop});if(c(p)){h=p.data}else{p=u.clone();m.addInterval(p)}}else{h=f}var v;if(c(i.solidColor)){if(!(h instanceof W)){h=new W}v=i.solidColor;tt(o,h,"color",v.color,undefined,undefined,s)}else if(c(i.grid)){if(!(h instanceof oe)){h=new oe}v=i.grid;tt(o,h,"color",v.color,undefined,a,s,l);tt(Number,h,"cellAlpha",v.cellAlpha,undefined,a,s,l);tt(t,h,"lineCount",v.lineCount,undefined,a,s,l);tt(t,h,"lineThickness",v.lineThickness,undefined,a,s,l);tt(t,h,"lineOffset",v.lineOffset,undefined,a,s,l)}else if(c(i.image)){if(!(h instanceof se)){h=new se}v=i.image;tt(Image,h,"image",v.image,undefined,a,s,l);tt(t,h,"repeat",v.repeat,undefined,a,s,l);tt(o,h,"color",v.color,undefined,a,s,l);tt(Boolean,h,"transparent",v.transparent,undefined,a,s,l)}else if(c(i.stripe)){if(!(h instanceof Pe)){h=new Pe}v=i.stripe;tt(Ae,h,"orientation",v.orientation,undefined,a,s,l);tt(o,h,"evenColor",v.evenColor,undefined,a,s,l);tt(o,h,"oddColor",v.oddColor,undefined,a,s,l);tt(Number,h,"offset",v.offset,undefined,a,s,l);tt(Number,h,"repeat",v.repeat,undefined,a,s,l)}else if(c(i.polylineOutline)){if(!(h instanceof _e)){h=new _e}v=i.polylineOutline;tt(o,h,"color",v.color,undefined,a,s,l);tt(o,h,"outlineColor",v.outlineColor,undefined,a,s,l);tt(Number,h,"outlineWidth",v.outlineWidth,undefined,a,s,l)}else if(c(i.polylineGlow)){if(!(h instanceof ve)){h=new ve}v=i.polylineGlow;tt(o,h,"color",v.color,undefined,a,s,l);tt(Number,h,"glowPower",v.glowPower,undefined,a,s,l)}else if(c(i.polylineArrow)){if(!(h instanceof pe)){h=new pe}v=i.polylineArrow;tt(o,h,"color",v.color,undefined,undefined,s)}else if(c(i.polylineDash)){if(!(h instanceof me)){h=new me}v=i.polylineDash;tt(o,h,"color",v.color,undefined,undefined,s);tt(o,h,"gapColor",v.gapColor,undefined,undefined,s);tt(Number,h,"dashLength",v.dashLength,undefined,a,s,l);tt(Number,h,"dashPattern",v.dashPattern,undefined,a,s,l)}if(c(p)){p.data=h}else{e[r]=h}}function at(e,t,r,i,n,a,o){if(!c(r)){return}if(y(r)){for(var s=0,l=r.length;s<l;s++){nt(e,t,r[s],i,n,a,o)}}else{nt(e,t,r,i,n,a,o)}}function ot(e,t,r,i,n){e.name=u(t.name,e.name)}function st(e,t,r,i,n){var a=t.description;if(c(a)){tt(String,e,"description",a,undefined,i,r,n)}}function lt(e,t,r,i,n){var a=t.position;if(c(a)){it(e,"position",a,undefined,i,r,n)}}function ut(e,t,i,n,a){var o=t.viewFrom;if(c(o)){tt(r,e,"viewFrom",o,undefined,n,i,a)}}function ct(e,t,r,i,n){var a=t.orientation;if(c(a)){tt(O,e,"orientation",a,undefined,i,r,n)}}function dt(e,t,r,i,n){var a=t.properties;if(c(a)){if(!c(e.properties)){e.properties=new we}for(var o in a){if(a.hasOwnProperty(o)){if(!e.properties.hasProperty(o)){e.properties.addProperty(o)}var s=a[o];if(y(s)){for(var l=0,u=s.length;l<u;l++){et(Qe(s[l]),e.properties,o,s[l],undefined,i,r,n)}}else{et(Qe(s),e.properties,o,s,undefined,i,r,n)}}}}}function ft(e,t,r,i){var n=r.references;if(c(n)){var a=n.map(function(e){return Le(i,e)});var o=r.interval;if(c(o)){o=L.fromIso8601(o);if(!(e[t]instanceof X)){o.data=new be(a);var s=new Q;s.intervals.addInterval(o);e[t]=s}}else{e[t]=new be(a)}}else{tt(Array,e,t,r,undefined,undefined,i)}}function ht(e,t,r,i){if(!c(r)){return}if(y(r)){for(var n=0,a=r.length;n<a;++n){ft(e,t,r[n],i)}}else{ft(e,t,r,i)}}function pt(e,t,i,n){if(c(i.references)){var a=i.references.map(function(e){return Le(n,e)});var o=i.interval;if(c(o)){o=L.fromIso8601(o);if(!(e[t]instanceof X)){o.data=new ye(a);var s=new X;s.intervals.addInterval(o);e[t]=s}}else{e[t]=new ye(a)}}else{if(c(i.cartesian)){i.array=r.unpackArray(i.cartesian)}else if(c(i.cartographicRadians)){i.array=r.fromRadiansArrayHeights(i.cartographicRadians)}else if(c(i.cartographicDegrees)){i.array=r.fromDegreesArrayHeights(i.cartographicDegrees)}if(c(i.array)){tt(Array,e,t,i,undefined,undefined,n)}}}function mt(e,t,r,i){if(!c(r)){return}if(y(r)){for(var n=0,a=r.length;n<a;n++){pt(e,t,r[n],i)}}else{pt(e,t,r,i)}}function vt(e,t,r,i,n){var a;var o=t.availability;if(!c(o)){return}var s;if(y(o)){var l=o.length;for(var u=0;u<l;u++){if(!c(s)){s=new N}$e.iso8601=o[u];a=L.fromIso8601($e);s.addInterval(a)}}else{$e.iso8601=o;a=L.fromIso8601($e);s=new N;s.addInterval(a)}e.availability=s}function gt(e,t,i,n,a,o){if(!c(t)){return}if(c(t.velocityReference)){e.alignedAxis=new Ie(Le(a,t.velocityReference),true)}else{tt(r,e,"alignedAxis",t,i,n,a,o)}}function _t(i,n,a,s,l){var u=n.billboard;if(!c(u)){return}var d;var f=u.interval;if(c(f)){$e.iso8601=f;d=L.fromIso8601($e)}var h=i.billboard;if(!c(h)){i.billboard=h=new H}tt(Boolean,h,"show",u.show,d,s,a,l);tt(Image,h,"image",u.image,d,s,a,l);tt(Number,h,"scale",u.scale,d,s,a,l);tt(t,h,"pixelOffset",u.pixelOffset,d,s,a,l);tt(r,h,"eyeOffset",u.eyeOffset,d,s,a,l);tt(B,h,"horizontalOrigin",u.horizontalOrigin,d,s,a,l);tt(z,h,"verticalOrigin",u.verticalOrigin,d,s,a,l);tt(F,h,"heightReference",u.heightReference,d,s,a,l);tt(o,h,"color",u.color,d,s,a,l);tt(Te,h,"rotation",u.rotation,d,s,a,l);gt(h,u.alignedAxis,d,s,a,l);tt(Boolean,h,"sizeInMeters",u.sizeInMeters,d,s,a,l);tt(Number,h,"width",u.width,d,s,a,l);tt(Number,h,"height",u.height,d,s,a,l);tt(P,h,"scaleByDistance",u.scaleByDistance,d,s,a,l);tt(P,h,"translucencyByDistance",u.translucencyByDistance,d,s,a,l);tt(P,h,"pixelOffsetScaleByDistance",u.pixelOffsetScaleByDistance,d,s,a,l);tt(e,h,"imageSubRegion",u.imageSubRegion,d,s,a,l)}function yt(e,t,i,n,a){var s=t.box;if(!c(s)){return}var l;var u=s.interval;if(c(u)){$e.iso8601=u;l=L.fromIso8601($e)}var d=e.box;if(!c(d)){e.box=d=new j}tt(Boolean,d,"show",s.show,l,n,i,a);tt(r,d,"dimensions",s.dimensions,l,n,i,a);tt(Boolean,d,"fill",s.fill,l,n,i,a);at(d,"material",s.material,l,n,i,a);tt(Boolean,d,"outline",s.outline,l,n,i,a);tt(o,d,"outlineColor",s.outlineColor,l,n,i,a);tt(Number,d,"outlineWidth",s.outlineWidth,l,n,i,a);tt(V,d,"shadows",s.shadows,l,n,i,a)}function bt(e,t,r,i,n){var a=t.corridor;if(!c(a)){return}var l;var u=a.interval;if(c(u)){$e.iso8601=u;l=L.fromIso8601($e)}var d=e.corridor;if(!c(d)){e.corridor=d=new J}tt(Boolean,d,"show",a.show,l,i,r,n);mt(d,"positions",a.positions,r);tt(Number,d,"width",a.width,l,i,r,n);tt(Number,d,"height",a.height,l,i,r,n);tt(Number,d,"extrudedHeight",a.extrudedHeight,l,i,r,n);tt(s,d,"cornerType",a.cornerType,l,i,r,n);tt(Number,d,"granularity",a.granularity,l,i,r,n);tt(Boolean,d,"fill",a.fill,l,i,r,n);at(d,"material",a.material,l,i,r,n);tt(Boolean,d,"outline",a.outline,l,i,r,n);tt(o,d,"outlineColor",a.outlineColor,l,i,r,n);tt(Number,d,"outlineWidth",a.outlineWidth,l,i,r,n);tt(V,d,"shadows",a.shadows,l,i,r,n)}function wt(e,t,r,i,n){var a=t.cylinder;if(!c(a)){return}var s;var l=a.interval;if(c(l)){$e.iso8601=l;s=L.fromIso8601($e)}var u=e.cylinder;if(!c(u)){e.cylinder=u=new $}tt(Boolean,u,"show",a.show,s,i,r,n);tt(Number,u,"length",a.length,s,i,r,n);tt(Number,u,"topRadius",a.topRadius,s,i,r,n);tt(Number,u,"bottomRadius",a.bottomRadius,s,i,r,n);tt(Boolean,u,"fill",a.fill,s,i,r,n);at(u,"material",a.material,s,i,r,n);tt(Boolean,u,"outline",a.outline,s,i,r,n);tt(o,u,"outlineColor",a.outlineColor,s,i,r,n);tt(Number,u,"outlineWidth",a.outlineWidth,s,i,r,n);tt(Number,u,"numberOfVerticalLines",a.numberOfVerticalLines,s,i,r,n);tt(Number,u,"slices",a.slices,s,i,r,n);tt(V,u,"shadows",a.shadows,s,i,r,n)}function Ct(e,t){var r=e.version;if(c(r)){if(typeof r==="string"){var i=r.split(".");if(i.length===2){if(i[0]!=="1"){throw new M("Cesium only supports CZML version 1.")}t._version=r}}}if(!c(t._version)){throw new M("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.")}var n=t._documentPacket;if(c(e.name)){n.name=e.name}var a=e.clock;if(c(a)){var o=n.clock;if(!c(o)){n.clock={interval:a.interval,currentTime:a.currentTime,range:a.range,step:a.step,multiplier:a.multiplier}}else{o.interval=u(a.interval,o.interval);o.currentTime=u(a.currentTime,o.currentTime);o.range=u(a.range,o.range);o.step=u(a.step,o.step);o.multiplier=u(a.multiplier,o.multiplier)}}}function St(e,t,r,i,n){var a=t.ellipse;if(!c(a)){return}var s;var l=a.interval;if(c(l)){$e.iso8601=l;s=L.fromIso8601($e)}var u=e.ellipse;if(!c(u)){e.ellipse=u=new re}tt(Boolean,u,"show",a.show,s,i,r,n);tt(Number,u,"semiMajorAxis",a.semiMajorAxis,s,i,r,n);tt(Number,u,"semiMinorAxis",a.semiMinorAxis,s,i,r,n);tt(Number,u,"height",a.height,s,i,r,n);tt(Number,u,"extrudedHeight",a.extrudedHeight,s,i,r,n);tt(Te,u,"rotation",a.rotation,s,i,r,n);tt(Te,u,"stRotation",a.stRotation,s,i,r,n);tt(Number,u,"granularity",a.granularity,s,i,r,n);tt(Boolean,u,"fill",a.fill,s,i,r,n);at(u,"material",a.material,s,i,r,n);tt(Boolean,u,"outline",a.outline,s,i,r,n);tt(o,u,"outlineColor",a.outlineColor,s,i,r,n);tt(Number,u,"outlineWidth",a.outlineWidth,s,i,r,n);tt(Number,u,"numberOfVerticalLines",a.numberOfVerticalLines,s,i,r,n);tt(V,u,"shadows",a.shadows,s,i,r,n)}function Tt(e,t,i,n,a){var s=t.ellipsoid;if(!c(s)){return}var l;var u=s.interval;if(c(u)){$e.iso8601=u;l=L.fromIso8601($e)}var d=e.ellipsoid;if(!c(d)){e.ellipsoid=d=new ie}tt(Boolean,d,"show",s.show,l,n,i,a);tt(r,d,"radii",s.radii,l,n,i,a);tt(Boolean,d,"fill",s.fill,l,n,i,a);at(d,"material",s.material,l,n,i,a);tt(Boolean,d,"outline",s.outline,l,n,i,a);tt(o,d,"outlineColor",s.outlineColor,l,n,i,a);tt(Number,d,"outlineWidth",s.outlineWidth,l,n,i,a);tt(Number,d,"stackPartitions",s.stackPartitions,l,n,i,a);tt(Number,d,"slicePartitions",s.slicePartitions,l,n,i,a);tt(Number,d,"subdivisions",s.subdivisions,l,n,i,a);tt(V,d,"shadows",s.shadows,l,n,i,a)}function Et(e,i,n,a,s){var l=i.label;if(!c(l)){return}var u;var d=l.interval;if(c(d)){$e.iso8601=d;u=L.fromIso8601($e)}var f=e.label;if(!c(f)){e.label=f=new le}tt(Boolean,f,"show",l.show,u,a,n,s);tt(String,f,"text",l.text,u,a,n,s);tt(String,f,"font",l.font,u,a,n,s);tt(U,f,"style",l.style,u,a,n,s);tt(Number,f,"scale",l.scale,u,a,n,s);tt(Boolean,f,"showBackground",l.showBackground,u,a,n,s);tt(o,f,"backgroundColor",l.backgroundColor,u,a,n,s);tt(t,f,"backgroundPadding",l.backgroundPadding,u,a,n,s);tt(t,f,"pixelOffset",l.pixelOffset,u,a,n,s);tt(r,f,"eyeOffset",l.eyeOffset,u,a,n,s);tt(B,f,"horizontalOrigin",l.horizontalOrigin,u,a,n,s);tt(z,f,"verticalOrigin",l.verticalOrigin,u,a,n,s);tt(F,f,"heightReference",l.heightReference,u,a,n,s);tt(o,f,"fillColor",l.fillColor,u,a,n,s);tt(o,f,"outlineColor",l.outlineColor,u,a,n,s);tt(Number,f,"outlineWidth",l.outlineWidth,u,a,n,s);tt(P,f,"translucencyByDistance",l.translucencyByDistance,u,a,n,s);tt(P,f,"pixelOffsetScaleByDistance",l.pixelOffsetScaleByDistance,u,a,n,s)}function xt(e,t,r,i,n){var a=t.model;if(!c(a)){return}var s;var l=a.interval;if(c(l)){$e.iso8601=l;s=L.fromIso8601($e)}var u=e.model;if(!c(u)){e.model=u=new ue}tt(Boolean,u,"show",a.show,s,i,r,n);tt(q,u,"uri",a.gltf,s,i,r,n);tt(Number,u,"scale",a.scale,s,i,r,n);tt(Number,u,"minimumPixelSize",a.minimumPixelSize,s,i,r,n);tt(Number,u,"maximumScale",a.maximumScale,s,i,r,n);tt(Boolean,u,"incrementallyLoadTextures",a.incrementallyLoadTextures,s,i,r,n);tt(Boolean,u,"runAnimations",a.runAnimations,s,i,r,n);tt(V,u,"shadows",a.shadows,s,i,r,n);tt(F,u,"heightReference",a.heightReference,s,i,r,n);tt(o,u,"silhouetteColor",a.silhouetteColor,s,i,r,n);tt(Number,u,"silhouetteSize",a.silhouetteSize,s,i,r,n);tt(o,u,"color",a.color,s,i,r,n);tt(k,u,"colorBlendMode",a.colorBlendMode,s,i,r,n);tt(Number,u,"colorBlendAmount",a.colorBlendAmount,s,i,r,n);var d=a.nodeTransformations;if(c(d)){if(y(d)){for(var f=0,h=d.length;f<h;f++){Pt(u,d[f],s,i,r,n)}}else{Pt(u,d,s,i,r,n)}}}function Pt(e,t,i,n,a,o){var s;var l=t.interval;if(c(l)){$e.iso8601=l;s=L.fromIso8601($e);if(c(i)){s=L.intersect(s,i,Be)}}else if(c(i)){s=i}var u=e.nodeTransformations;var d=Object.keys(t);for(var f=0,h=d.length;f<h;++f){var p=d[f];if(p==="interval"){continue}var m=t[p];if(!c(m)){continue}if(!c(u)){e.nodeTransformations=u=new we}if(!u.hasProperty(p)){u.addProperty(p)}var v=u[p];if(!c(v)){u[p]=v=new ce}tt(r,v,"translation",m.translation,s,n,a,o);tt(O,v,"rotation",m.rotation,s,n,a,o);tt(r,v,"scale",m.scale,s,n,a,o)}}function At(e,t,r,i,n){var a=t.path;if(!c(a)){return}var o;var s=a.interval;if(c(s)){$e.iso8601=s;o=L.fromIso8601($e)}var l=e.path;if(!c(l)){e.path=l=new de}tt(Boolean,l,"show",a.show,o,i,r,n);tt(Number,l,"width",a.width,o,i,r,n);tt(Number,l,"resolution",a.resolution,o,i,r,n);tt(Number,l,"leadTime",a.leadTime,o,i,r,n);tt(Number,l,"trailTime",a.trailTime,o,i,r,n);at(l,"material",a.material,o,i,r,n)}function Ot(e,t,r,i,n){var a=t.point;if(!c(a)){return}var s;var l=a.interval;if(c(l)){$e.iso8601=l;s=L.fromIso8601($e)}var u=e.point;if(!c(u)){e.point=u=new fe}tt(Boolean,u,"show",a.show,s,i,r,n);tt(Number,u,"pixelSize",a.pixelSize,s,i,r,n);tt(F,u,"heightReference",a.heightReference,s,i,r,n);tt(o,u,"color",a.color,s,i,r,n);tt(o,u,"outlineColor",a.outlineColor,s,i,r,n);tt(Number,u,"outlineWidth",a.outlineWidth,s,i,r,n);tt(P,u,"scaleByDistance",a.scaleByDistance,s,i,r,n);tt(P,u,"translucencyByDistance",a.translucencyByDistance,s,i,r,n)}function Dt(e,t,r,i,n){var a=t.polygon;if(!c(a)){return}var s;var l=a.interval;if(c(l)){$e.iso8601=l;s=L.fromIso8601($e)}var u=e.polygon;if(!c(u)){e.polygon=u=new he}tt(Boolean,u,"show",a.show,s,i,r,n);mt(u,"hierarchy",a.positions,r);tt(Number,u,"height",a.height,s,i,r,n);tt(Number,u,"extrudedHeight",a.extrudedHeight,s,i,r,n);tt(Te,u,"stRotation",a.stRotation,s,i,r,n);tt(Number,u,"granularity",a.granularity,s,i,r,n);tt(Boolean,u,"fill",a.fill,s,i,r,n);at(u,"material",a.material,s,i,r,n);tt(Boolean,u,"outline",a.outline,s,i,r,n);tt(o,u,"outlineColor",a.outlineColor,s,i,r,n);tt(Number,u,"outlineWidth",a.outlineWidth,s,i,r,n);tt(Boolean,u,"perPositionHeight",a.perPositionHeight,s,i,r,n);tt(Boolean,u,"closeTop",a.closeTop,s,i,r,n);tt(Boolean,u,"closeBottom",a.closeBottom,s,i,r,n);tt(V,u,"shadows",a.shadows,s,i,r,n)}function It(e,t,r,i,n){var a=t.polyline;if(!c(a)){return}var o;var s=a.interval;if(c(s)){$e.iso8601=s;o=L.fromIso8601($e)}var l=e.polyline;if(!c(l)){e.polyline=l=new ge}tt(Boolean,l,"show",a.show,o,i,r,n);mt(l,"positions",a.positions,r);tt(Number,l,"width",a.width,o,i,r,n);tt(Number,l,"granularity",a.granularity,o,i,r,n);at(l,"material",a.material,o,i,r,n);tt(Boolean,l,"followSurface",a.followSurface,o,i,r,n);tt(V,l,"shadows",a.shadows,o,i,r,n)}function Mt(e,t,r,i,n){var a=t.rectangle;if(!c(a)){return}var s;var l=a.interval;if(c(l)){$e.iso8601=l;s=L.fromIso8601($e)}var u=e.rectangle;if(!c(u)){e.rectangle=u=new Ce}tt(Boolean,u,"show",a.show,s,i,r,n);tt(D,u,"coordinates",a.coordinates,s,i,r,n);tt(Number,u,"height",a.height,s,i,r,n);tt(Number,u,"extrudedHeight",a.extrudedHeight,s,i,r,n);tt(Te,u,"rotation",a.rotation,s,i,r,n);tt(Te,u,"stRotation",a.stRotation,s,i,r,n);tt(Number,u,"granularity",a.granularity,s,i,r,n);tt(Boolean,u,"fill",a.fill,s,i,r,n);at(u,"material",a.material,s,i,r,n);tt(Boolean,u,"outline",a.outline,s,i,r,n);tt(o,u,"outlineColor",a.outlineColor,s,i,r,n);tt(Number,u,"outlineWidth",a.outlineWidth,s,i,r,n);tt(Boolean,u,"closeTop",a.closeTop,s,i,r,n);tt(Boolean,u,"closeBottom",a.closeBottom,s,i,r,n);tt(V,u,"shadows",a.shadows,s,i,r,n)}function Rt(e,t,r,i,n){var a=t.wall;if(!c(a)){return}var s;var l=a.interval;if(c(l)){$e.iso8601=l;s=L.fromIso8601($e)}var u=e.wall;if(!c(u)){e.wall=u=new Me}tt(Boolean,u,"show",a.show,s,i,r,n);mt(u,"positions",a.positions,r);ht(u,"minimumHeights",a.minimumHeights,r);ht(u,"maximumHeights",a.maximumHeights,r);tt(Number,u,"granularity",a.granularity,s,i,r,n);tt(Boolean,u,"fill",a.fill,s,i,r,n);at(u,"material",a.material,s,i,r,n);tt(Boolean,u,"outline",a.outline,s,i,r,n);tt(o,u,"outlineColor",a.outlineColor,s,i,r,n);tt(Number,u,"outlineWidth",a.outlineWidth,s,i,r,n);tt(V,u,"shadows",a.shadows,s,i,r,n)}function Lt(e,t,r,i,n,a){var o=e.id;if(!c(o)){o=l()}Re=o;if(!c(n._version)&&o!=="document"){throw new M("The first CZML packet is required to be the document object.")}if(e["delete"]===true){t.removeById(o)}else if(o==="document"){Ct(e,n)}else{var s=t.getOrCreateEntity(o);var u=e.parent;if(c(u)){s.parent=t.getOrCreateEntity(u)}for(var d=r.length-1;d>-1;d--){r[d](s,e,t,i,a)}}Re=undefined}function Nt(e){var t;var r=e._documentPacket.clock;if(!c(r)){if(!c(e._clock)){var i=e._entityCollection.computeAvailability();if(!i.start.equals(b.MINIMUM_VALUE)){var o=i.start;var s=i.stop;var l=C.secondsDifference(s,o);var d=Math.round(l/120);t=new te;t.startTime=C.clone(o);t.stopTime=C.clone(s);t.clockRange=n.LOOP_STOP;t.multiplier=d;t.currentTime=C.clone(o);t.clockStep=a.SYSTEM_CLOCK_MULTIPLIER;e._clock=t;return true}}return false}if(c(e._clock)){t=e._clock.clone()}else{t=new te;t.startTime=b.MINIMUM_VALUE.clone();t.stopTime=b.MAXIMUM_VALUE.clone();t.currentTime=b.MINIMUM_VALUE.clone();t.clockRange=n.LOOP_STOP;t.clockStep=a.SYSTEM_CLOCK_MULTIPLIER;t.multiplier=1}if(c(r.interval)){$e.iso8601=r.interval;var f=L.fromIso8601($e);t.startTime=f.start;t.stopTime=f.stop}if(c(r.currentTime)){t.currentTime=C.fromIso8601(r.currentTime)}if(c(r.range)){t.clockRange=u(n[r.range],n.LOOP_STOP)}if(c(r.step)){t.clockStep=u(a[r.step],a.SYSTEM_CLOCK_MULTIPLIER)}if(c(r.multiplier)){t.multiplier=r.multiplier}if(!t.equals(e._clock)){e._clock=t.clone(e._clock);return true}return false}function kt(e,t,r,i){if(!c(t)){throw new f("czml is required.")}r=u(r,u.EMPTY_OBJECT);var n=t;var a=r.sourceUri;var o=c(r.query)?A(r.query):undefined;if(typeof t==="string"){if(c(o)){t=w(t,"?"+o,false)}n=E(t);a=u(a,t)}ee.setLoading(e,true);return G(n,function(t){return Ft(e,t,a,i,o)}).otherwise(function(t){ee.setLoading(e,false);e._error.raiseEvent(e,t);console.log(t);return G.reject(t)})}function Ft(e,t,r,i,n){ee.setLoading(e,true);var a=e._entityCollection;if(i){e._version=undefined;e._documentPacket=new Bt;a.removeAll()}Ut._processCzml(t,a,r,undefined,e,n);var o=Nt(e);var s=e._documentPacket;if(c(s.name)&&e._name!==s.name){e._name=s.name;o=true}else if(!c(e._name)&&c(r)){e._name=g(r);o=true}ee.setLoading(e,false);if(o){e._changed.raiseEvent(e)}return e}function Bt(){this.name=undefined;this.clock=undefined}function Ut(e){this._name=e;this._changed=new p;this._error=new p;this._isLoading=false;this._loading=new p;this._clock=undefined;this._documentPacket=new Bt;this._version=undefined;this._entityCollection=new ae(this);this._entityCluster=new ne}Ut.load=function(e,t){return(new Ut).load(e,t)};d(Ut.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!c(e)){throw new f("value must be defined.")}this._entityCluster=e}}});Ut.updaters=[_t,yt,bt,wt,St,Tt,Et,xt,ot,st,At,Ot,Dt,It,dt,Mt,lt,ut,Rt,ct,vt];Ut.prototype.process=function(e,t){return kt(this,e,t,false)};Ut.prototype.load=function(e,t){return kt(this,e,t,true)};Ut.processPacketData=tt;Ut.processPositionPacketData=it;Ut.processMaterialPacketData=at;Ut._processCzml=function(e,t,r,i,n,a){i=c(i)?i:Ut.updaters;if(y(e)){for(var o=0,s=e.length;o<s;o++){Lt(e[o],t,i,r,n,a)}}else{Lt(e,t,i,r,n,a)}};return Ut});define("DataSources/DataSourceCollection",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../ThirdParty/when"],function(e,t,r,i,n,a,o){"use strict";function s(){this._dataSources=[];this._dataSourceAdded=new a;this._dataSourceRemoved=new a}r(s.prototype,{length:{get:function(){return this._dataSources.length}},dataSourceAdded:{get:function(){return this._dataSourceAdded}},dataSourceRemoved:{get:function(){return this._dataSourceRemoved}}});s.prototype.add=function(e){if(!t(e)){throw new n("dataSource is required.")}var r=this;var i=this._dataSources;return o(e,function(e){if(i===r._dataSources){r._dataSources.push(e);r._dataSourceAdded.raiseEvent(r,e)}return e})};s.prototype.remove=function(t,r){r=e(r,false);var i=this._dataSources.indexOf(t);if(i!==-1){this._dataSources.splice(i,1);this._dataSourceRemoved.raiseEvent(this,t);if(r&&typeof t.destroy==="function"){t.destroy()}return true}return false};s.prototype.removeAll=function(t){t=e(t,false);var r=this._dataSources;for(var i=0,n=r.length;i<n;++i){var a=r[i];this._dataSourceRemoved.raiseEvent(this,a);if(t&&typeof a.destroy==="function"){a.destroy()}}this._dataSources=[]};s.prototype.contains=function(e){return this.indexOf(e)!==-1};s.prototype.indexOf=function(e){return this._dataSources.indexOf(e)};s.prototype.get=function(e){if(!t(e)){throw new n("index is required.")}return this._dataSources[e]};s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){this.removeAll(true);return i(this)};return s});define("DataSources/EllipseGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/EllipseGeometry","../Core/EllipseOutlineGeometry","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E){"use strict";var x=new w(e.WHITE);var P=new C(true);var A=new C(true);var O=new C(false);var D=new C(e.BLACK);var I=new C(b.DISABLED);var M=new C(new s);var R=new e;function L(e){this.id=e;this.vertexFormat=undefined;this.center=undefined;this.semiMajorAxis=undefined;this.semiMinorAxis=undefined;this.rotation=undefined;this.height=undefined;this.extrudedHeight=undefined;this.granularity=undefined;this.stRotation=undefined;this.numberOfVerticalLines=undefined}function N(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(N.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._isClosed=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new d;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._onTerrain=false;this._options=new L(e);this._onEntityPropertyChanged(e,"ellipse",e.ellipse,undefined)}n(N,{perInstanceColorAppearanceType:{value:_},materialAppearanceType:{value:g}});n(N.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});N.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};N.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};N.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var c;var d=new m(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var h=this._distanceDisplayConditionProperty.getValue(r);var p=l.fromDistanceDisplayCondition(h);if(this._materialProperty instanceof w){var v=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){v=this._materialProperty.color.getValue(r)}c=t.fromColor(v);s={show:d,distanceDisplayCondition:p,color:c}}else{s={show:d,distanceDisplayCondition:p}}return new f({id:n,geometry:new u(this._options),attributes:s})};N.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=E.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var u=this._distanceDisplayConditionProperty.getValue(r);return new f({id:n,geometry:new c(this._options),attributes:{show:new m(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:l.fromDistanceDisplayCondition(u)}})};N.prototype.isDestroyed=function(){return false};N.prototype.destroy=function(){this._entitySubscription();a(this)};N.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="position"||t==="ellipse")){return}var o=this._entity.ellipse;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var l=i(s)&&s.isConstant?s.getValue(h.MINIMUM_VALUE):true;var u=o.outline;var c=i(u);if(c&&u.isConstant){c=u.getValue(h.MINIMUM_VALUE)}if(!l&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=this._entity.position;var f=o.semiMajorAxis;var m=o.semiMinorAxis;var y=o.show;if(i(y)&&y.isConstant&&!y.getValue(h.MINIMUM_VALUE)||(!i(d)||!i(f)||!i(m))){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var b=r(o.material,x);var C=b instanceof w;this._materialProperty=b;this._fillProperty=r(s,A);this._showProperty=r(y,P);this._showOutlineProperty=r(o.outline,O);this._outlineColorProperty=c?r(o.outlineColor,D):undefined;this._shadowsProperty=r(o.shadows,I);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,M);var S=o.rotation;var T=o.height;var R=o.extrudedHeight;var L=o.granularity;var N=o.stRotation;var k=o.outlineWidth;var F=o.numberOfVerticalLines;var B=l&&!i(T)&&!i(R)&&C&&v.isSupported(this._scene);if(c&&B){p(p.geometryOutlines);c=false}this._fillEnabled=l;this._onTerrain=B;this._isClosed=i(R)||B;this._outlineEnabled=c;if(!d.isConstant||!f.isConstant||!m.isConstant||!E.isConstant(S)||!E.isConstant(T)||!E.isConstant(R)||!E.isConstant(L)||!E.isConstant(N)||!E.isConstant(k)||!E.isConstant(F)||B&&!E.isConstant(b)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var U=this._options;U.vertexFormat=C?_.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat;U.center=d.getValue(h.MINIMUM_VALUE,U.center);U.semiMajorAxis=f.getValue(h.MINIMUM_VALUE,U.semiMajorAxis);U.semiMinorAxis=m.getValue(h.MINIMUM_VALUE,U.semiMinorAxis);U.rotation=i(S)?S.getValue(h.MINIMUM_VALUE):undefined;U.height=i(T)?T.getValue(h.MINIMUM_VALUE):undefined;U.extrudedHeight=i(R)?R.getValue(h.MINIMUM_VALUE):undefined;U.granularity=i(L)?L.getValue(h.MINIMUM_VALUE):undefined;U.stRotation=i(N)?N.getValue(h.MINIMUM_VALUE):undefined;U.numberOfVerticalLines=i(F)?F.getValue(h.MINIMUM_VALUE):undefined;this._outlineWidth=i(k)?k.getValue(h.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};N.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new k(e,t,this)};function k(e,t,r){this._primitives=e;this._groundPrimitives=t;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=r;this._options=new L(r._entity)}k.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._geometryUpdater;var a=n._onTerrain;var s=this._primitives;var d=this._groundPrimitives;if(a){d.removeAndDestroy(this._primitive)}else{s.removeAndDestroy(this._primitive);s.removeAndDestroy(this._outlinePrimitive);this._outlinePrimitive=undefined}this._primitive=undefined;var h=n._entity;var p=h.ellipse;if(!h.isShowing||!h.isAvailable(r)||!E.getValueOrDefault(p.show,r,true)){return}var m=this._options;var b=E.getValueOrUndefined(h.position,r,m.center);var w=E.getValueOrUndefined(p.semiMajorAxis,r);var C=E.getValueOrUndefined(p.semiMinorAxis,r);if(!i(b)||!i(w)||!i(C)){return}m.center=b;m.semiMajorAxis=w;m.semiMinorAxis=C;m.rotation=E.getValueOrUndefined(p.rotation,r);m.height=E.getValueOrUndefined(p.height,r);m.extrudedHeight=E.getValueOrUndefined(p.extrudedHeight,r);m.granularity=E.getValueOrUndefined(p.granularity,r);m.stRotation=E.getValueOrUndefined(p.stRotation,r);m.numberOfVerticalLines=E.getValueOrUndefined(p.numberOfVerticalLines,r);var S=this._geometryUpdater.shadowsProperty.getValue(r);var x=this._geometryUpdater.distanceDisplayConditionProperty;var P=x.getValue(r);var A=l.fromDistanceDisplayCondition(P);if(E.getValueOrDefault(p.fill,r,true)){var O=n.fillMaterialProperty;var D=T.getValue(r,O,this._material);this._material=D;if(a){var I=e.WHITE;if(i(O.color)){I=O.color.getValue(r)}this._primitive=d.add(new v({geometryInstances:new f({id:h,geometry:new u(m),attributes:{color:t.fromColor(I),distanceDisplayCondition:A}}),asynchronous:false,shadows:S}))}else{var M=new g({material:D,translucent:D.isTranslucent(),closed:i(m.extrudedHeight)});m.vertexFormat=M.vertexFormat;this._primitive=s.add(new y({geometryInstances:new f({id:h,geometry:new u(m)}),attributes:{distanceDisplayCondition:A},appearance:M,asynchronous:false,shadows:S}))}}if(!a&&E.getValueOrDefault(p.outline,r,false)){m.vertexFormat=_.VERTEX_FORMAT;var L=E.getValueOrClonedDefault(p.outlineColor,r,e.BLACK,R);var N=E.getValueOrDefault(p.outlineWidth,r,1);var k=L.alpha!==1;this._outlinePrimitive=s.add(new y({geometryInstances:new f({id:h,geometry:new c(m),attributes:{color:t.fromColor(L),distanceDisplayCondition:A}}),appearance:new _({flat:true,translucent:k,renderState:{lineWidth:n._scene.clampLineWidth(N)}}),asynchronous:false,shadows:S}))}};k.prototype.getBoundingSphere=function(e,t){return S(e,this._primitive,this._outlinePrimitive,t)};k.prototype.isDestroyed=function(){return false};k.prototype.destroy=function(){var e=this._primitives;var t=this._groundPrimitives;if(this._geometryUpdater._onTerrain){t.removeAndDestroy(this._primitive)}else{e.removeAndDestroy(this._primitive)}e.removeAndDestroy(this._outlinePrimitive);a(this)};return N});define("DataSources/EllipsoidGeometryUpdater",["../Core/Cartesian3","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/EllipsoidGeometry","../Core/EllipsoidOutlineGeometry","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/Matrix4","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/SceneMode","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x){"use strict";var P=new C(t.WHITE);var A=new S(true);var O=new S(true);var D=new S(false);var I=new S(t.BLACK);var M=new S(w.DISABLED);var R=new S(new l);var L=new e;var N=new t;var k=new e(1,1,1);function F(e){this.id=e;this.vertexFormat=undefined;this.radii=undefined;this.stackPartitions=undefined;this.slicePartitions=undefined;this.subdivisions=undefined}function B(e,t){if(!n(e)){throw new s("entity is required")}if(!n(t)){throw new s("scene is required")}this._scene=t;this._entity=e;this._entitySubscription=e.definitionChanged.addEventListener(B.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new f;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new F(e);this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,undefined)}a(B,{perInstanceColorAppearanceType:{value:_},materialAppearanceType:{value:g}});a(B.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!n(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!n(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:true},geometryChanged:{get:function(){return this._geometryChanged}}});B.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};B.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};B.prototype.createFillGeometryInstance=function(e){if(!n(e)){throw new s("time is required.")}if(!this._fillEnabled){throw new s("This instance does not represent a filled geometry.")}var i=this._entity;var a=i.isAvailable(e);var o;var l;var d=new v(a&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e));var f=this._distanceDisplayConditionProperty.getValue(e);var m=u.fromDistanceDisplayCondition(f);if(this._materialProperty instanceof C){var g=t.WHITE;if(n(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){g=this._materialProperty.color.getValue(e)}l=r.fromColor(g);o={show:d,distanceDisplayCondition:m,color:l}}else{o={show:d,distanceDisplayCondition:m}}return new h({id:i,geometry:new c(this._options),modelMatrix:i.computeModelMatrix(p.MINIMUM_VALUE),attributes:o})};B.prototype.createOutlineGeometryInstance=function(e){if(!n(e)){throw new s("time is required.")}if(!this._outlineEnabled){throw new s("This instance does not represent an outlined geometry.")}var i=this._entity;var a=i.isAvailable(e);var o=x.getValueOrDefault(this._outlineColorProperty,e,t.BLACK);var l=this._distanceDisplayConditionProperty.getValue(e);return new h({id:i,geometry:new d(this._options),modelMatrix:i.computeModelMatrix(p.MINIMUM_VALUE),attributes:{show:new v(a&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:r.fromColor(o),distanceDisplayCondition:u.fromDistanceDisplayCondition(l)}})};B.prototype.isDestroyed=function(){return false};B.prototype.destroy=function(){this._entitySubscription();o(this)};B.prototype._onEntityPropertyChanged=function(e,t,r,a){if(!(t==="availability"||t==="position"||t==="orientation"||t==="ellipsoid")){return}var o=e.ellipsoid;if(!n(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var l=n(s)&&s.isConstant?s.getValue(p.MINIMUM_VALUE):true;var u=o.outline;var c=n(u);if(c&&u.isConstant){c=u.getValue(p.MINIMUM_VALUE)}if(!l&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var d=e.position;var f=o.radii;var h=o.show;if(n(h)&&h.isConstant&&!h.getValue(p.MINIMUM_VALUE)||(!n(d)||!n(f))){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var m=i(o.material,P);var v=m instanceof C;this._materialProperty=m;this._fillProperty=i(s,O);this._showProperty=i(h,A);this._showOutlineProperty=i(o.outline,D);this._outlineColorProperty=c?i(o.outlineColor,I):undefined;this._shadowsProperty=i(o.shadows,M);this._distanceDisplayConditionProperty=i(o.distanceDisplayCondition,R);this._fillEnabled=l;this._outlineEnabled=c;var y=o.stackPartitions;var b=o.slicePartitions;var w=o.outlineWidth;var S=o.subdivisions;if(!d.isConstant||!x.isConstant(e.orientation)||!f.isConstant||!x.isConstant(y)||!x.isConstant(b)||!x.isConstant(w)||!x.isConstant(S)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var T=this._options;T.vertexFormat=v?_.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat;T.radii=f.getValue(p.MINIMUM_VALUE,T.radii);T.stackPartitions=n(y)?y.getValue(p.MINIMUM_VALUE):undefined;T.slicePartitions=n(b)?b.getValue(p.MINIMUM_VALUE):undefined;T.subdivisions=n(S)?S.getValue(p.MINIMUM_VALUE):undefined;this._outlineWidth=n(w)?w.getValue(p.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};B.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new s("This instance does not represent dynamic geometry.")}if(!n(e)){throw new s("primitives is required.")}return new U(e,this)};function U(e,t){this._entity=t._entity;this._scene=t._scene;this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new F(t._entity);this._modelMatrix=new m;this._material=undefined;this._attributes=undefined;this._outlineAttributes=undefined;this._lastSceneMode=undefined;this._lastShow=undefined;this._lastOutlineShow=undefined;this._lastOutlineWidth=undefined;this._lastOutlineColor=undefined}U.prototype.update=function(e){if(!n(e)){throw new s("time is required.")}var a=this._entity;var o=a.ellipsoid;if(!a.isShowing||!a.isAvailable(e)||!x.getValueOrDefault(o.show,e,true)){if(n(this._primitive)){this._primitive.show=false}if(n(this._outlinePrimitive)){this._outlinePrimitive.show=false}return}var f=x.getValueOrUndefined(o.radii,e,L);var p=a.computeModelMatrix(e,this._modelMatrix);if(!n(p)||!n(f)){if(n(this._primitive)){this._primitive.show=false}if(n(this._outlinePrimitive)){this._outlinePrimitive.show=false}return}var w;var C=x.getValueOrDefault(o.fill,e,true);var S=x.getValueOrDefault(o.outline,e,false);var T=x.getValueOrClonedDefault(o.outlineColor,e,t.BLACK,N);var A=E.getValue(e,i(o.material,P),this._material);this._material=A;var O=x.getValueOrUndefined(o.stackPartitions,e);var D=x.getValueOrUndefined(o.slicePartitions,e);var I=x.getValueOrUndefined(o.subdivisions,e);var M=x.getValueOrDefault(o.outlineWidth,e,1);var R=this._scene.mode;var F=R===b.SCENE3D;var B=this._options;var U=this._geometryUpdater.shadowsProperty.getValue(e);var V=this._geometryUpdater.distanceDisplayConditionProperty;var z=V.getValue(e);var q=u.fromDistanceDisplayCondition(z);var G=!F||this._lastSceneMode!==R||!n(this._primitive)||B.stackPartitions!==O||B.slicePartitions!==D||B.subdivisions!==I||this._lastOutlineWidth!==M;if(G){var H=this._primitives;H.removeAndDestroy(this._primitive);H.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;this._lastSceneMode=R;this._lastOutlineWidth=M;B.stackPartitions=O;B.slicePartitions=D;B.subdivisions=I;B.radii=F?k:f;w=new g({material:A,translucent:A.isTranslucent(),closed:true});B.vertexFormat=w.vertexFormat;this._primitive=H.add(new y({geometryInstances:new h({id:a,geometry:new c(B),modelMatrix:!F?p:undefined,attributes:{show:new v(C),distanceDisplayCondition:q}}),appearance:w,asynchronous:false,shadows:U}));B.vertexFormat=_.VERTEX_FORMAT;this._outlinePrimitive=H.add(new y({geometryInstances:new h({id:a,geometry:new d(B),modelMatrix:!F?p:undefined,attributes:{show:new v(S),color:r.fromColor(T),distanceDisplayCondition:q}}),appearance:new _({flat:true,translucent:T.alpha!==1,renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(M)}}),asynchronous:false,shadows:U}));this._lastShow=C;this._lastOutlineShow=S;this._lastOutlineColor=t.clone(T,this._lastOutlineColor);this._lastDistanceDisplayCondition=z}else if(this._primitive.ready){var j=this._primitive;var W=this._outlinePrimitive;j.show=true;W.show=true;w=j.appearance;w.material=A;var Y=this._attributes;if(!n(Y)){Y=j.getGeometryInstanceAttributes(a);this._attributes=Y}if(C!==this._lastShow){Y.show=v.toValue(C,Y.show);this._lastShow=C}var X=this._outlineAttributes;if(!n(X)){X=W.getGeometryInstanceAttributes(a);this._outlineAttributes=X}if(S!==this._lastOutlineShow){X.show=v.toValue(S,X.show);this._lastOutlineShow=S}if(!t.equals(T,this._lastOutlineColor)){X.color=r.toValue(T,X.color);t.clone(T,this._lastOutlineColor)}if(!l.equals(z,this._lastDistanceDisplayCondition)){Y.distanceDisplayCondition=u.toValue(z,Y.distanceDisplayCondition);X.distanceDisplayCondition=u.toValue(z,X.distanceDisplayCondition);l.clone(z,this._lastDistanceDisplayCondition)}}if(F){f.x=Math.max(f.x,.001);f.y=Math.max(f.y,.001);f.z=Math.max(f.z,.001);p=m.multiplyByScale(p,f,p);this._primitive.modelMatrix=p;this._outlinePrimitive.modelMatrix=p}};U.prototype.getBoundingSphere=function(e,t){return T(e,this._primitive,this._outlinePrimitive,t)};U.prototype.isDestroyed=function(){return false};U.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);o(this)};return B});define("DataSources/StaticGeometryColorBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/Primitive","./BoundingSphereState","./ColorMaterialProperty","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";var f=new t;var h=new n;function p(t,r,n,a,o,s,l){this.translucent=r;this.appearanceType=n;this.depthFailAppearanceType=a;this.depthFailMaterialProperty=o;this.depthFailMaterial=undefined;this.closed=s;this.shadows=l;this.primitives=t;this.createPrimitive=false;this.waitingOnCreate=false;this.primitive=undefined;this.oldPrimitive=undefined;this.geometry=new e;this.updaters=new e;this.updatersWithAttributes=new e;this.attributes=new e;this.subscriptions=new e;this.showsUpdated=new e;this.itemsToRemove=[];this.invalidated=false;var u;if(i(o)){u=o.definitionChanged.addEventListener(p.prototype.onMaterialChanged,this)}this.removeMaterialSubscription=u}p.prototype.onMaterialChanged=function(){this.invalidated=true};p.prototype.isMaterial=function(e){var t=this.depthFailMaterialProperty;var r=e.depthFailMaterialProperty;if(r===t){return true}if(i(t)){return t.equals(r)}return false};p.prototype.add=function(e,t){var r=e.entity.id;this.createPrimitive=true;this.geometry.set(r,t);this.updaters.set(r,e);if(!e.hasConstantFill||!e.fillMaterialProperty.isConstant||!d.isConstant(e.distanceDisplayConditionProperty)){this.updatersWithAttributes.set(r,e)}else{var i=this;this.subscriptions.set(r,e.entity.definitionChanged.addEventListener(function(t,r,n,a){if(r==="isShowing"){i.showsUpdated.set(t.id,e)}}))}};p.prototype.remove=function(e){var t=e.entity.id;this.createPrimitive=this.geometry.remove(t)||this.createPrimitive;if(this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);if(i(r)){r();this.subscriptions.remove(t)}}};p.prototype.update=function(e){var l=true;var p=0;var m=this.primitive;var v=this.primitives;var g;var _;if(this.createPrimitive){var y=this.geometry.values;var b=y.length;if(b>0){if(i(m)){if(!i(this.oldPrimitive)){this.oldPrimitive=m}else{v.remove(m)}}for(_=0;_<b;_++){var w=y[_];var C=w.attributes;g=this.attributes.get(w.id.id);if(i(g)){if(i(C.show)){C.show.value=g.show}if(i(C.color)){C.color.value=g.color}if(i(C.depthFailColor)){C.depthFailColor.value=g.depthFailColor}}}var S;if(i(this.depthFailAppearanceType)){if(i(this.depthFailMaterialProperty)){this.depthFailMaterial=c.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial)}S=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})}m=new s({asynchronous:true,geometryInstances:y,appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:S,shadows:this.shadows});v.add(m);l=false}else{if(i(m)){v.remove(m);m=undefined}var T=this.oldPrimitive;if(i(T)){v.remove(T);this.oldPrimitive=undefined}}this.attributes.removeAll();this.primitive=m;this.createPrimitive=false;this.waitingOnCreate=true}else if(i(m)&&m.ready){if(i(this.oldPrimitive)){v.remove(this.oldPrimitive);this.oldPrimitive=undefined}if(i(this.depthFailAppearanceType)&&!(this.depthFailMaterialProperty instanceof u)){this.depthFailMaterial=c.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial);this.primitive.depthFailAppearance.material=this.depthFailMaterial}var E=this.updatersWithAttributes.values;var x=E.length;var P=this.waitingOnCreate;for(_=0;_<x;_++){var A=E[_];var O=this.geometry.get(A.entity.id);g=this.attributes.get(O.id.id);if(!i(g)){g=m.getGeometryInstanceAttributes(O.id);this.attributes.set(O.id.id,g)}if(!A.fillMaterialProperty.isConstant||P){var D=A.fillMaterialProperty.color;D.getValue(e,f);if(!t.equals(g._lastColor,f)){g._lastColor=t.clone(f,g._lastColor);g.color=r.toValue(f,g.color);if(this.translucent&&g.color[3]===255||!this.translucent&&g.color[3]!==255){this.itemsToRemove[p++]=A}}}if(i(this.depthFailAppearanceType)&&this.depthFailAppearanceType instanceof u&&(!A.depthFailMaterialProperty.isConstant||P)){var I=A.depthFailMaterialProperty.color;I.getValue(e,f);if(!t.equals(g._lastDepthFailColor,f)){g._lastDepthFailColor=t.clone(f,g._lastDepthFailColor);g.depthFailColor=r.toValue(f,g.depthFailColor)}}var M=A.entity.isShowing&&(A.hasConstantFill||A.isFilled(e));var R=g.show[0]===1;if(M!==R){g.show=o.toValue(M,g.show)}var L=A.distanceDisplayConditionProperty;if(!d.isConstant(L)){var N=L.getValue(e,h);if(!n.equals(N,g._lastDistanceDisplayCondition)){g._lastDistanceDisplayCondition=n.clone(N,g._lastDistanceDisplayCondition);g.distanceDisplayCondition=a.toValue(N,g.distanceDisplayCondition)}}}this.updateShows(m);this.waitingOnCreate=false}else if(i(m)&&!m.ready){l=false}this.itemsToRemove.length=p;return l};p.prototype.updateShows=function(e){var t=this.showsUpdated.values;var r=t.length;for(var n=0;n<r;n++){var a=t[n];var s=this.geometry.get(a.entity.id);var l=this.attributes.get(s.id.id);if(!i(l)){l=e.getGeometryInstanceAttributes(s.id);this.attributes.set(s.id.id,l)}var u=a.entity.isShowing;var c=l.show[0]===1;if(u!==c){l.show=o.toValue(u,l.show)}}this.showsUpdated.removeAll()};p.prototype.contains=function(e){return this.updaters.contains(e.id)};p.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready){return l.PENDING}var n=r.getGeometryInstanceAttributes(e);if(!i(n)||!i(n.boundingSphere)||i(n.show)&&n.show[0]===0){return l.FAILED}n.boundingSphere.clone(t);return l.DONE};p.prototype.removeAllPrimitives=function(){var e=this.primitives;var t=this.primitive;if(i(t)){e.remove(t);this.primitive=undefined;this.geometry.removeAll();this.updaters.removeAll()}var r=this.oldPrimitive;if(i(r)){e.remove(r);this.oldPrimitive=undefined}};p.prototype.destroy=function(){var e=this.primitive;var t=this.primitives;if(i(e)){t.remove(e)}var r=this.oldPrimitive;if(i(r)){t.remove(r)}if(i(this.removeMaterialSubscription)){this.removeMaterialSubscription()}};function m(e,t,r,i,n){this._solidItems=[];this._translucentItems=[];this._primitives=e;this._appearanceType=t;this._depthFailAppearanceType=r;this._closed=i;this._shadows=n}m.prototype.add=function(e,t){var r;var i;var n=t.createFillGeometryInstance(e);if(n.attributes.color.value[3]===255){r=this._solidItems;i=false}else{r=this._translucentItems;i=true}var a=r.length;for(var o=0;o<a;o++){var s=r[o];if(s.isMaterial(t)){s.add(t,n);return}}var l=new p(this._primitives,i,this._appearanceType,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);l.add(t,n);r.push(l)};function v(e,t){var r=e.length;for(var i=r-1;i>=0;i--){var n=e[i];if(n.remove(t)){if(n.updaters.length===0){e.splice(i,1);n.destroy();return true}}}return false}m.prototype.remove=function(e){if(!v(this._solidItems,e)){v(this._translucentItems,e)}};function g(e,t,r){var i=false;var n=t.length;for(var a=0;a<n;++a){var o=t[a];var s=o.itemsToRemove;var l=s.length;if(l>0){for(a=0;a<l;a++){var u=s[a];o.remove(u);e.add(r,u);i=true}}}return i}function _(e,t,r,i){var n=t.length;var a;for(a=n-1;a>=0;a--){var o=t[a];if(o.invalidated){t.splice(a,1);var s=o.updaters.values;var l=s.length;for(var u=0;u<l;u++){e.add(r,s[u])}o.destroy()}}n=t.length;for(a=0;a<n;++a){i=t[a].update(r)&&i}return i}m.prototype.update=function(e){var t=_(this,this._solidItems,e,true);t=_(this,this._translucentItems,e,t)&&t;var r=g(this,this._solidItems,e);var i=g(this,this._translucentItems,e);if(r||i){t=_(this,this._solidItems,e,t)&&t;t=_(this,this._translucentItems,e,t)&&t}return t};function y(e,t,r){var i=e.length;for(var n=0;n<i;n++){var a=e[n];if(a.contains(t)){return a.getBoundingSphere(t,r)}}return l.FAILED}m.prototype.getBoundingSphere=function(e,t){var r=y(this._solidItems,e,t);if(r===l.FAILED){return y(this._translucentItems,e,t)}return r};function b(e){var t=e.length;for(var r=0;r<t;r++){e[r].destroy()}e.length=0}m.prototype.removeAllPrimitives=function(){b(this._solidItems);b(this._translucentItems)};return m});define("DataSources/StaticGeometryPerMaterialBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/Primitive","./BoundingSphereState","./ColorMaterialProperty","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";var f=new n;function h(t,r,i,n,a,o,s){this.primitives=t;this.appearanceType=r;this.materialProperty=i;this.depthFailAppearanceType=n;this.depthFailMaterialProperty=a;this.closed=o;this.shadows=s;this.updaters=new e;this.createPrimitive=true;this.primitive=undefined;this.oldPrimitive=undefined;this.geometry=new e;this.material=undefined;this.depthFailMaterial=undefined;this.updatersWithAttributes=new e;this.attributes=new e;this.invalidated=false;this.removeMaterialSubscription=i.definitionChanged.addEventListener(h.prototype.onMaterialChanged,this);this.subscriptions=new e;this.showsUpdated=new e}h.prototype.onMaterialChanged=function(){this.invalidated=true};h.prototype.isMaterial=function(e){var t=this.materialProperty;var r=e.fillMaterialProperty;var n=this.depthFailMaterialProperty;var a=e.depthFailMaterialProperty;if(r===t&&a===n){return true}var o=i(t)&&t.equals(r);o=(!i(n)&&!i(a)||i(n)&&n.equals(a))&&o;return o};h.prototype.add=function(e,t){var r=t.entity.id;this.updaters.set(r,t);this.geometry.set(r,t.createFillGeometryInstance(e));if(!t.hasConstantFill||!t.fillMaterialProperty.isConstant||!d.isConstant(t.distanceDisplayConditionProperty)){this.updatersWithAttributes.set(r,t)}else{var i=this;this.subscriptions.set(r,t.entity.definitionChanged.addEventListener(function(e,r,n,a){if(r==="isShowing"){i.showsUpdated.set(e.id,t)}}))}this.createPrimitive=true};h.prototype.remove=function(e){var t=e.entity.id;this.createPrimitive=this.geometry.remove(t)||this.createPrimitive;if(this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);if(i(r)){r();this.subscriptions.remove(t)}}return this.createPrimitive};var p=new t;h.prototype.update=function(e){var l=true;var h=this.primitive;var m=this.primitives;var v=this.geometry.values;var g;var _;if(this.createPrimitive){var y=v.length;if(y>0){if(i(h)){if(!i(this.oldPrimitive)){this.oldPrimitive=h}else{m.remove(h)}}for(_=0;_<y;_++){var b=v[_];var w=b.attributes;g=this.attributes.get(b.id.id);if(i(g)){if(i(w.show)){w.show.value=g.show}if(i(w.color)){w.color.value=g.color}if(i(w.depthFailColor)){w.depthFailColor.value=g.depthFailColor}}}this.material=c.getValue(e,this.materialProperty,this.material);var C;if(i(this.depthFailMaterialProperty)){var S;if(this.depthFailMaterialProperty instanceof c){this.depthFailMaterial=c.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial);S=this.depthFailMaterial.isTranslucent()}else{S=this.material.isTranslucent()}C=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:S,closed:this.closed})}h=new s({asynchronous:true,geometryInstances:v,appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:C,shadows:this.shadows});m.add(h);l=false}else{if(i(h)){m.remove(h);h=undefined}var T=this.oldPrimitive;if(i(T)){m.remove(T);this.oldPrimitive=undefined}}this.attributes.removeAll();this.primitive=h;this.createPrimitive=false}else if(i(h)&&h.ready){if(i(this.oldPrimitive)){m.remove(this.oldPrimitive);this.oldPrimitive=undefined}this.material=c.getValue(e,this.materialProperty,this.material);this.primitive.appearance.material=this.material;if(i(this.depthFailAppearanceType)&&!(this.depthFailMaterialProperty instanceof u)){this.depthFailMaterial=c.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial);this.primitive.depthFailAppearance.material=this.depthFailMaterial}var E=this.updatersWithAttributes.values;var x=E.length;for(_=0;_<x;_++){var P=E[_];var A=P.entity;var O=this.geometry.get(A.id);g=this.attributes.get(O.id.id);if(!i(g)){g=h.getGeometryInstanceAttributes(O.id);this.attributes.set(O.id.id,g)}if(i(this.depthFailAppearanceType)&&this.depthFailAppearanceType instanceof u&&!P.depthFailMaterialProperty.isConstant){var D=P.depthFailMaterialProperty.color;D.getValue(e,p);if(!t.equals(g._lastDepthFailColor,p)){g._lastDepthFailColor=t.clone(p,g._lastDepthFailColor);g.depthFailColor=r.toValue(p,g.depthFailColor)}}var I=A.isShowing&&(P.hasConstantFill||P.isFilled(e));var M=g.show[0]===1;if(I!==M){g.show=o.toValue(I,g.show)}var R=P.distanceDisplayConditionProperty;if(!d.isConstant(R)){var L=R.getValue(e,f);if(!n.equals(L,g._lastDistanceDisplayCondition)){g._lastDistanceDisplayCondition=n.clone(L,g._lastDistanceDisplayCondition);g.distanceDisplayCondition=a.toValue(L,g.distanceDisplayCondition)}}}this.updateShows(h)}else if(i(h)&&!h.ready){l=false}return l};h.prototype.updateShows=function(e){var t=this.showsUpdated.values;var r=t.length;for(var n=0;n<r;n++){var a=t[n];var s=a.entity;var l=this.geometry.get(s.id);var u=this.attributes.get(l.id.id);if(!i(u)){u=e.getGeometryInstanceAttributes(l.id);this.attributes.set(l.id.id,u)}var c=s.isShowing;var d=u.show[0]===1;if(c!==d){u.show=o.toValue(c,u.show)}}this.showsUpdated.removeAll()};h.prototype.contains=function(e){return this.updaters.contains(e.id)};h.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready){return l.PENDING}var n=r.getGeometryInstanceAttributes(e);if(!i(n)||!i(n.boundingSphere)||i(n.show)&&n.show[0]===0){return l.FAILED}n.boundingSphere.clone(t);return l.DONE};h.prototype.destroy=function(){var e=this.primitive;var t=this.primitives;if(i(e)){t.remove(e)}var r=this.oldPrimitive;if(i(r)){t.remove(r)}this.removeMaterialSubscription()};function m(e,t,r,i,n){this._items=[];this._primitives=e;this._appearanceType=t;this._depthFailAppearanceType=r;this._closed=i;this._shadows=n}m.prototype.add=function(e,t){var r=this._items;var i=r.length;for(var n=0;n<i;n++){var a=r[n];if(a.isMaterial(t)){a.add(e,t);return}}var o=new h(this._primitives,this._appearanceType,t.fillMaterialProperty,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);o.add(e,t);r.push(o)};m.prototype.remove=function(e){var t=this._items;var r=t.length;for(var i=r-1;i>=0;i--){var n=t[i];if(n.remove(e)){if(n.updaters.length===0){t.splice(i,1);n.destroy()}break}}};m.prototype.update=function(e){var t;var r=this._items;var i=r.length;for(t=i-1;t>=0;t--){var n=r[t];if(n.invalidated){r.splice(t,1);var a=n.updaters.values;var o=a.length;for(var s=0;s<o;s++){this.add(e,a[s])}n.destroy()}}var l=true;for(t=0;t<i;t++){l=r[t].update(e)&&l}return l};m.prototype.getBoundingSphere=function(e,t){var r=this._items;var i=r.length;for(var n=0;n<i;n++){var a=r[n];if(a.contains(e)){return a.getBoundingSphere(e,t)}}return l.FAILED};m.prototype.removeAllPrimitives=function(){var e=this._items;var t=e.length;for(var r=0;r<t;r++){e[r].destroy()}this._items.length=0};return m});define("DataSources/StaticGroundGeometryColorBatch",["../Core/AssociativeArray","../Core/Color","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,l){"use strict";var u=new t;var c=new i;function d(t,r,i){this.primitives=t;this.color=r;this.key=i;this.createPrimitive=false;this.waitingOnCreate=false;this.primitive=undefined;this.oldPrimitive=undefined;this.geometry=new e;this.updaters=new e;this.updatersWithAttributes=new e;this.attributes=new e;this.subscriptions=new e;this.showsUpdated=new e;this.itemsToRemove=[];this.isDirty=false}d.prototype.add=function(e,t){var r=e.entity.id;this.createPrimitive=true;this.geometry.set(r,t);this.updaters.set(r,e);if(!e.hasConstantFill||!e.fillMaterialProperty.isConstant||!l.isConstant(e.distanceDisplayConditionProperty)){this.updatersWithAttributes.set(r,e)}else{var i=this;this.subscriptions.set(r,e.entity.definitionChanged.addEventListener(function(t,r,n,a){if(r==="isShowing"){i.showsUpdated.set(t.id,e)}}))}};d.prototype.remove=function(e){var t=e.entity.id;this.createPrimitive=this.geometry.remove(t)||this.createPrimitive;if(this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);if(r(i)){i();this.subscriptions.remove(t)}}};var f=new Array(4);d.prototype.update=function(e){var s=true;var d=0;var h=this.primitive;var p=this.primitives;var m;var v;if(this.createPrimitive){var g=this.geometry.values;var _=g.length;if(_>0){if(r(h)){if(!r(this.oldPrimitive)){this.oldPrimitive=h}else{p.remove(h)}}for(v=0;v<_;v++){var y=g[v];var b=y.attributes;m=this.attributes.get(y.id.id);if(r(m)){if(r(b.show)){b.show.value=m.show}if(r(b.color)){b.color.value=m.color}}}h=new o({asynchronous:true,geometryInstances:g});p.add(h);s=false}else{if(r(h)){p.remove(h);h=undefined}var w=this.oldPrimitive;if(r(w)){p.remove(w);this.oldPrimitive=undefined}}this.attributes.removeAll();this.primitive=h;this.createPrimitive=false;this.waitingOnCreate=true}else if(r(h)&&h.ready){if(r(this.oldPrimitive)){p.remove(this.oldPrimitive);this.oldPrimitive=undefined}var C=this.updatersWithAttributes.values;var S=C.length;var T=this.waitingOnCreate;for(v=0;v<S;v++){var E=C[v];var x=this.geometry.get(E.entity.id);m=this.attributes.get(x.id.id);if(!r(m)){m=h.getGeometryInstanceAttributes(x.id);this.attributes.set(x.id.id,m)}if(!E.fillMaterialProperty.isConstant||T){var P=E.fillMaterialProperty.color;P.getValue(e,u);if(!t.equals(m._lastColor,u)){m._lastColor=t.clone(u,m._lastColor);var A=this.color;var O=u.toBytes(f);if(A[0]!==O[0]||A[1]!==O[1]||A[2]!==O[2]||A[3]!==O[3]){this.itemsToRemove[d++]=E}}}var D=E.entity.isShowing&&(E.hasConstantFill||E.isFilled(e));var I=m.show[0]===1;if(D!==I){m.show=a.toValue(D,m.show)}var M=E.distanceDisplayConditionProperty;if(!l.isConstant(M)){var R=M.getValue(e,c);if(!i.equals(R,m._lastDistanceDisplayCondition)){m._lastDistanceDisplayCondition=i.clone(R,m._lastDistanceDisplayCondition);m.distanceDisplayCondition=n.toValue(R,m.distanceDisplayCondition)}}}this.updateShows(h);this.waitingOnCreate=false}else if(r(h)&&!h.ready){s=false}this.itemsToRemove.length=d;return s};d.prototype.updateShows=function(e){var t=this.showsUpdated.values;var i=t.length;for(var n=0;n<i;n++){var o=t[n];var s=this.geometry.get(o.entity.id);var l=this.attributes.get(s.id.id);if(!r(l)){l=e.getGeometryInstanceAttributes(s.id);this.attributes.set(s.id.id,l)}var u=o.entity.isShowing;var c=l.show[0]===1;if(u!==c){l.show=a.toValue(u,l.show)}}this.showsUpdated.removeAll()};d.prototype.contains=function(e){return this.updaters.contains(e.id)};d.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready){return s.PENDING}var n=i.getBoundingSphere(e);if(!r(n)){return s.FAILED}n.clone(t);return s.DONE};d.prototype.removeAllPrimitives=function(){var e=this.primitives;var t=this.primitive;if(r(t)){e.remove(t);this.primitive=undefined;this.geometry.removeAll();this.updaters.removeAll()}var i=this.oldPrimitive;if(r(i)){e.remove(i);this.oldPrimitive=undefined}};function h(t){this._batches=new e;this._primitives=t}h.prototype.add=function(e,t){var r=t.createFillGeometryInstance(e);var i=this._batches;var n=new Uint32Array(r.attributes.color.value.buffer)[0];var a;if(i.contains(n)){a=i.get(n)}else{a=new d(this._primitives,r.attributes.color.value,n);i.set(n,a)}a.add(t,r);return a};h.prototype.remove=function(e){var t=this._batches.values;var r=t.length;for(var i=0;i<r;++i){if(t[i].remove(e)){return}}};h.prototype.update=function(e){var t;var r;var i=true;var n=this._batches;var a=n.values;var o=a.length;for(t=0;t<o;++t){i=a[t].update(e)&&i}for(t=0;t<o;++t){var s=a[t];var l=s.itemsToRemove;var u=l.length;for(var c=0;c<u;c++){r=l[c];s.remove(r);var d=this.add(e,r);s.isDirty=true;d.isDirty=true}}var f=a.slice();var h=f.length;for(t=0;t<h;++t){var p=f[t];if(p.isDirty){i=f[t].update(e)&&i;p.isDirty=false}if(p.geometry.length===0){n.remove(p.key)}}return i};h.prototype.getBoundingSphere=function(e,t){var r=this._batches.values;var i=r.length;for(var n=0;n<i;++n){var a=r[n];if(a.contains(e)){return a.getBoundingSphere(e,t)}}return s.FAILED};h.prototype.removeAllPrimitives=function(){var e=this._batches.values;var t=e.length;for(var r=0;r<t;++r){e[r].removeAllPrimitives()}};return h});define("DataSources/StaticOutlineGeometryBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/PerInstanceColorAppearance","../Scene/Primitive","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";function d(t,r,i,n){this.translucent=r;this.width=i;this.shadows=n;this.primitives=t;this.createPrimitive=false;this.waitingOnCreate=false;this.primitive=undefined;this.oldPrimitive=undefined;this.geometry=new e;this.updaters=new e;this.updatersWithAttributes=new e;this.attributes=new e;this.itemsToRemove=[];this.subscriptions=new e;this.showsUpdated=new e}d.prototype.add=function(e,t){var r=e.entity.id;this.createPrimitive=true;this.geometry.set(r,t);this.updaters.set(r,e);if(!e.hasConstantOutline||!e.outlineColorProperty.isConstant||!c.isConstant(e.distanceDisplayConditionProperty)){this.updatersWithAttributes.set(r,e)}else{var i=this;this.subscriptions.set(r,e.entity.definitionChanged.addEventListener(function(t,r,n,a){if(r==="isShowing"){i.showsUpdated.set(t.id,e)}}))}};d.prototype.remove=function(e){var t=e.entity.id;this.createPrimitive=this.geometry.remove(t)||this.createPrimitive;if(this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var r=this.subscriptions.get(t);if(i(r)){r();this.subscriptions.remove(t)}}};var f=new t;var h=new n;d.prototype.update=function(e){var u=true;var d=0;var p=this.primitive;var m=this.primitives;var v;var g;if(this.createPrimitive){var _=this.geometry.values;var y=_.length;if(y>0){if(i(p)){if(!i(this.oldPrimitive)){this.oldPrimitive=p}else{m.remove(p)}}for(g=0;g<y;g++){var b=_[g];var w=b.attributes;v=this.attributes.get(b.id.id);if(i(v)){if(i(w.show)){w.show.value=v.show}if(i(w.color)){w.color.value=v.color}}}p=new l({asynchronous:true,geometryInstances:_,appearance:new s({flat:true,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows});m.add(p);u=false}else{if(i(p)){m.remove(p);p=undefined}var C=this.oldPrimitive;if(i(C)){m.remove(C);this.oldPrimitive=undefined}}this.attributes.removeAll();this.primitive=p;this.createPrimitive=false;this.waitingOnCreate=true}else if(i(p)&&p.ready){if(i(this.oldPrimitive)){m.remove(this.oldPrimitive);this.oldPrimitive=undefined}var S=this.updatersWithAttributes.values;var T=S.length;var E=this.waitingOnCreate;for(g=0;g<T;g++){var x=S[g];var P=this.geometry.get(x.entity.id);v=this.attributes.get(P.id.id);if(!i(v)){v=p.getGeometryInstanceAttributes(P.id);this.attributes.set(P.id.id,v)}if(!x.outlineColorProperty.isConstant||E){var A=x.outlineColorProperty;A.getValue(e,f);if(!t.equals(v._lastColor,f)){v._lastColor=t.clone(f,v._lastColor);v.color=r.toValue(f,v.color);if(this.translucent&&v.color[3]===255||!this.translucent&&v.color[3]!==255){this.itemsToRemove[d++]=x}}}var O=x.entity.isShowing&&(x.hasConstantOutline||x.isOutlineVisible(e));var D=v.show[0]===1;if(O!==D){v.show=o.toValue(O,v.show)}var I=x.distanceDisplayConditionProperty;if(!c.isConstant(I)){var M=I.getValue(e,h);if(!n.equals(M,v._lastDistanceDisplayCondition)){v._lastDistanceDisplayCondition=n.clone(M,v._lastDistanceDisplayCondition);v.distanceDisplayCondition=a.toValue(M,v.distanceDisplayCondition)}}}this.updateShows(p);this.waitingOnCreate=false}else if(i(p)&&!p.ready){u=false}this.itemsToRemove.length=d;return u};d.prototype.updateShows=function(e){var t=this.showsUpdated.values;var r=t.length;for(var n=0;n<r;n++){var a=t[n];var s=this.geometry.get(a.entity.id);var l=this.attributes.get(s.id.id);if(!i(l)){l=e.getGeometryInstanceAttributes(s.id);this.attributes.set(s.id.id,l)}var u=a.entity.isShowing;var c=l.show[0]===1;if(u!==c){l.show=o.toValue(u,l.show)}}this.showsUpdated.removeAll()};d.prototype.contains=function(e){return this.updaters.contains(e.id)};d.prototype.getBoundingSphere=function(e,t){var r=this.primitive;if(!r.ready){return u.PENDING}var n=r.getGeometryInstanceAttributes(e);if(!i(n)||!i(n.boundingSphere)||i(n.show)&&n.show[0]===0){return u.FAILED}n.boundingSphere.clone(t);return u.DONE};d.prototype.removeAllPrimitives=function(){var e=this.primitives;var t=this.primitive;if(i(t)){e.remove(t);this.primitive=undefined;this.geometry.removeAll();this.updaters.removeAll()}var r=this.oldPrimitive;if(i(r)){e.remove(r);this.oldPrimitive=undefined}};function p(t,r,i){this._primitives=t;this._scene=r;this._shadows=i;this._solidBatches=new e;this._translucentBatches=new e}p.prototype.add=function(e,t){var r=t.createOutlineGeometryInstance(e);var n=this._scene.clampLineWidth(t.outlineWidth);var a;var o;if(r.attributes.color.value[3]===255){a=this._solidBatches;o=a.get(n);if(!i(o)){o=new d(this._primitives,false,n,this._shadows);a.set(n,o)}o.add(t,r)}else{a=this._translucentBatches;o=a.get(n);if(!i(o)){o=new d(this._primitives,true,n,this._shadows);a.set(n,o)}o.add(t,r)}};p.prototype.remove=function(e){var t;var r=this._solidBatches.values;var i=r.length;for(t=0;t<i;t++){if(r[t].remove(e)){return}}var n=this._translucentBatches.values;var a=n.length;for(t=0;t<a;t++){if(n[t].remove(e)){return}}};p.prototype.update=function(e){var t;var r;var i;var n;var a=this._solidBatches.values;var o=a.length;var s=this._translucentBatches.values;var l=s.length;var u;var c=true;var d=false;do{d=false;for(r=0;r<o;r++){n=a[r];c=n.update(e);u=n.itemsToRemove;var f=u.length;if(f>0){d=true;for(t=0;t<f;t++){i=u[t];n.remove(i);this.add(e,i)}}}for(r=0;r<l;r++){n=s[r];c=n.update(e);u=n.itemsToRemove;var h=u.length;if(h>0){d=true;for(t=0;t<h;t++){i=u[t];n.remove(i);this.add(e,i)}}}}while(d);return c};p.prototype.getBoundingSphere=function(e,t){var r;var i=this._solidBatches.values;var n=i.length;for(r=0;r<n;r++){var a=i[r];if(a.contains(e)){return a.getBoundingSphere(e,t)}}var o=this._translucentBatches.values;var s=o.length;for(r=0;r<s;r++){var l=o[r];if(l.contains(e)){return l.getBoundingSphere(e,t)}}return u.FAILED};p.prototype.removeAllPrimitives=function(){var e;var t=this._solidBatches.values;var r=t.length;for(e=0;e<r;e++){t[e].removeAllPrimitives()}var i=this._translucentBatches.values;var n=i.length;for(e=0;e<n;e++){i[e].removeAllPrimitives()}};return p});define("DataSources/GeometryVisualizer",["../Core/AssociativeArray","../Core/BoundingSphere","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Scene/ShadowMode","./BoundingSphereState","./ColorMaterialProperty","./StaticGeometryColorBatch","./StaticGeometryPerMaterialBatch","./StaticGroundGeometryColorBatch","./StaticOutlineGeometryBatch"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";var f=[];function h(t,r){this._primitives=t;this._groundPrimitives=r;this._dynamicUpdaters=new e}h.prototype.add=function(e,t){this._dynamicUpdaters.set(t.entity.id,t.createDynamicUpdater(this._primitives,this._groundPrimitives))};h.prototype.remove=function(e){var t=e.entity.id;var i=this._dynamicUpdaters.get(t);if(r(i)){this._dynamicUpdaters.remove(t);i.destroy()}};h.prototype.update=function(e){var t=this._dynamicUpdaters.values;for(var r=0,i=t.length;r<i;r++){t[r].update(e)}return true};h.prototype.removeAllPrimitives=function(){var e=this._dynamicUpdaters.values;for(var t=0,r=e.length;t<r;t++){e[t].destroy()}this._dynamicUpdaters.removeAll()};h.prototype.getBoundingSphere=function(e,t){var i=this._dynamicUpdaters.get(e.id);if(r(i)&&r(i.getBoundingSphere)){return i.getBoundingSphere(e,t)}return o.FAILED};function p(e,t){var r=e._batches;var i=r.length;for(var n=0;n<i;n++){r[n].remove(t)}}function m(e,t,i){if(i.isDynamic){e._dynamicBatch.add(t,i);return}var n;if(i.outlineEnabled||i.fillEnabled){n=i.shadowsProperty.getValue(t)}if(i.outlineEnabled){e._outlineBatches[n].add(t,i)}var o=0;if(r(i.depthFailMaterialProperty)){o=i.depthFailMaterialProperty instanceof s?1:2}var l;if(r(n)){l=n+o*a.NUMBER_OF_SHADOW_MODES}if(i.fillEnabled){if(i.onTerrain){e._groundColorBatch.add(t,i)}else if(i.isClosed){if(i.fillMaterialProperty instanceof s){e._closedColorBatches[l].add(t,i)}else{e._closedMaterialBatches[l].add(t,i)}}else if(i.fillMaterialProperty instanceof s){e._openColorBatches[l].add(t,i)}else{e._openMaterialBatches[l].add(t,i)}}}function v(t,i,o){if(!r(t)){throw new n("type is required.")}if(!r(i)){throw new n("scene is required.")}if(!r(o)){throw new n("entityCollection is required.")}this._type=t;var s=i.primitives;var p=i.groundPrimitives;this._scene=i;this._primitives=s;this._groundPrimitives=p;this._entityCollection=undefined;this._addedObjects=new e;this._removedObjects=new e;this._changedObjects=new e;var m=a.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(m);this._closedColorBatches=new Array(m*3);this._closedMaterialBatches=new Array(m*3);this._openColorBatches=new Array(m*3);this._openMaterialBatches=new Array(m*3);for(var g=0;g<m;++g){this._outlineBatches[g]=new d(s,i,g);this._closedColorBatches[g]=new l(s,t.perInstanceColorAppearanceType,undefined,true,g);this._closedMaterialBatches[g]=new u(s,t.materialAppearanceType,undefined,true,g);this._openColorBatches[g]=new l(s,t.perInstanceColorAppearanceType,undefined,false,g);this._openMaterialBatches[g]=new u(s,t.materialAppearanceType,undefined,false,g);this._closedColorBatches[g+m]=new l(s,t.perInstanceColorAppearanceType,t.perInstanceColorAppearanceType,true,g);this._closedMaterialBatches[g+m]=new u(s,t.materialAppearanceType,t.perInstanceColorAppearanceType,true,g);this._openColorBatches[g+m]=new l(s,t.perInstanceColorAppearanceType,t.perInstanceColorAppearanceType,false,g);this._openMaterialBatches[g+m]=new u(s,t.materialAppearanceType,t.perInstanceColorAppearanceType,false,g);this._closedColorBatches[g+m*2]=new l(s,t.perInstanceColorAppearanceType,t.materialAppearanceType,true,g);this._closedMaterialBatches[g+m*2]=new u(s,t.materialAppearanceType,t.materialAppearanceType,true,g);this._openColorBatches[g+m*2]=new l(s,t.perInstanceColorAppearanceType,t.materialAppearanceType,false,g);this._openMaterialBatches[g+m*2]=new u(s,t.materialAppearanceType,t.materialAppearanceType,false,g)}this._groundColorBatch=new c(p);this._dynamicBatch=new h(s,p);this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatch,this._dynamicBatch);this._subscriptions=new e;this._updaters=new e;this._entityCollection=o;o.collectionChanged.addEventListener(v.prototype._onCollectionChanged,this);this._onCollectionChanged(o,o.values,f)}v.prototype.update=function(e){if(!r(e)){throw new n("time is required.")}var t=this._addedObjects;var i=t.values;var a=this._removedObjects;var o=a.values;var s=this._changedObjects;var l=s.values;var u;var c;var d;var f;for(u=l.length-1;u>-1;u--){c=l[u];d=c.id;f=this._updaters.get(d);if(f.entity===c){p(this,f);m(this,e,f)}else{o.push(c);i.push(c)}}for(u=o.length-1;u>-1;u--){c=o[u];d=c.id;f=this._updaters.get(d);p(this,f);f.destroy();this._updaters.remove(d);this._subscriptions.get(d)();this._subscriptions.remove(d)}for(u=i.length-1;u>-1;u--){c=i[u];d=c.id;f=new this._type(c,this._scene);this._updaters.set(d,f);m(this,e,f);this._subscriptions.set(d,f.geometryChanged.addEventListener(v._onGeometryChanged,this))}t.removeAll();a.removeAll();s.removeAll();var h=true;var g=this._batches;var _=g.length;for(u=0;u<_;u++){h=g[u].update(e)&&h}return h};var g=[];var _=new t;v.prototype.getBoundingSphere=function(e,i){if(!r(e)){throw new n("entity is required.")}if(!r(i)){throw new n("result is required.")}var a=g;var s=_;var l=0;var u=o.DONE;var c=this._batches;var d=c.length;for(var f=0;f<d;f++){u=c[f].getBoundingSphere(e,s);if(u===o.PENDING){return o.PENDING}else if(u===o.DONE){a[l]=t.clone(s,a[l]);l++}}if(l===0){return o.FAILED}a.length=l;t.fromBoundingSpheres(a,i);return o.DONE};v.prototype.isDestroyed=function(){return false};v.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(v.prototype._onCollectionChanged,this);this._addedObjects.removeAll();this._removedObjects.removeAll();var e;var t=this._batches;var r=t.length;for(e=0;e<r;e++){t[e].removeAllPrimitives()}var n=this._subscriptions.values;r=n.length;for(e=0;e<r;e++){n[e]()}this._subscriptions.removeAll();return i(this)};v._onGeometryChanged=function(e){var t=this._removedObjects;var i=this._changedObjects;var n=e.entity;var a=n.id;if(!r(t.get(a))&&!r(i.get(a))){i.set(a,n)}};v.prototype._onCollectionChanged=function(e,t,r){var i=this._addedObjects;var n=this._removedObjects;var a=this._changedObjects;var o;var s;var l;for(o=r.length-1;o>-1;o--){l=r[o];s=l.id;if(!i.remove(s)){n.set(s,l);a.remove(s)}}for(o=t.length-1;o>-1;o--){l=t[o];s=l.id;if(n.remove(s)){a.set(s,l)}else{i.set(s,l)}}};return v});define("DataSources/LabelVisualizer",["../Core/AssociativeArray","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/VerticalOrigin","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m){"use strict";var v=1;var g="30px sans-serif";var _=f.FILL;var y=i.WHITE;var b=i.BLACK;var w=1;var C=false;var S=new i(.165,.165,.165,.8);var T=new t(7,5);var E=t.ZERO;var x=r.ZERO;var P=c.NONE;var A=d.CENTER;var O=h.CENTER;var D=0;var I=new r;var M=new i;var R=new i;var L=new i;var N=new t;var k=new r;var F=new t;var B=new u;var U=new u;var V=new u;var z=new l;function q(e){this.entity=e;this.label=undefined;this.index=undefined}function G(t,r){if(!a(t)){throw new s("entityCluster is required.")}if(!a(r)){throw new s("entityCollection is required.")}r.collectionChanged.addEventListener(G.prototype._onCollectionChanged,this);this._cluster=t;this._entityCollection=r;this._items=new e;this._onCollectionChanged(r,r.values,[],[])}G.prototype.update=function(e){if(!a(e)){throw new s("time is required.")}var t=this._items.values;var r=this._cluster;for(var i=0,n=t.length;i<n;i++){var o=t[i];var l=o.entity;var u=l._label;var c;var d=o.label;var f=l.isShowing&&l.isAvailable(e)&&m.getValueOrDefault(u._show,e,true);if(f){I=m.getValueOrUndefined(l._position,e,I);c=m.getValueOrUndefined(u._text,e);f=a(I)&&a(c)}if(!f){H(o,l,r);continue}if(!m.isConstant(l._position)){r._clusterDirty=true}if(!a(d)){d=r.getLabel(l);d.id=l;o.label=d}d.show=true;d.position=I;d.text=c;d.scale=m.getValueOrDefault(u._scale,e,v);d.font=m.getValueOrDefault(u._font,e,g);d.style=m.getValueOrDefault(u._style,e,_);d.fillColor=m.getValueOrDefault(u._fillColor,e,y,M);d.outlineColor=m.getValueOrDefault(u._outlineColor,e,b,R);d.outlineWidth=m.getValueOrDefault(u._outlineWidth,e,w);d.showBackground=m.getValueOrDefault(u._showBackground,e,C);d.backgroundColor=m.getValueOrDefault(u._backgroundColor,e,S,L);d.backgroundPadding=m.getValueOrDefault(u._backgroundPadding,e,T,N);d.pixelOffset=m.getValueOrDefault(u._pixelOffset,e,E,F);d.eyeOffset=m.getValueOrDefault(u._eyeOffset,e,x,k);d.heightReference=m.getValueOrDefault(u._heightReference,e,P);d.horizontalOrigin=m.getValueOrDefault(u._horizontalOrigin,e,A);d.verticalOrigin=m.getValueOrDefault(u._verticalOrigin,e,O);d.translucencyByDistance=m.getValueOrUndefined(u._translucencyByDistance,e,B);d.pixelOffsetScaleByDistance=m.getValueOrUndefined(u._pixelOffsetScaleByDistance,e,U);d.scaleByDistance=m.getValueOrUndefined(u._scaleByDistance,e,V);d.distanceDisplayCondition=m.getValueOrUndefined(u._distanceDisplayCondition,e,z);d.disableDepthTestDistance=m.getValueOrDefault(u._disableDepthTestDistance,e,D)}return true};G.prototype.getBoundingSphere=function(e,t){if(!a(e)){throw new s("entity is required.")}if(!a(t)){throw new s("result is required.")}var i=this._items.get(e.id);if(!a(i)||!a(i.label)){return p.FAILED}var o=i.label;t.center=r.clone(n(o._clampedPosition,o.position),t.center);t.radius=0;return p.DONE};G.prototype.isDestroyed=function(){return false};G.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(G.prototype._onCollectionChanged,this);var e=this._entityCollection.values;for(var t=0;t<e.length;t++){this._cluster.removeLabel(e[t])}return o(this)};G.prototype._onCollectionChanged=function(e,t,r,i){var n;var o;var s=this._items;var l=this._cluster;for(n=t.length-1;n>-1;n--){o=t[n];if(a(o._label)&&a(o._position)){s.set(o.id,new q(o))}}for(n=i.length-1;n>-1;n--){o=i[n];if(a(o._label)&&a(o._position)){if(!s.contains(o.id)){s.set(o.id,new q(o))}}else{H(s.get(o.id),o,l);s.remove(o.id)}}for(n=r.length-1;n>-1;n--){o=r[n];H(s.get(o.id),o,l);s.remove(o.id)}};function H(e,t,r){if(a(e)){e.label=undefined;r.removeLabel(t)}}return G});define("ThirdParty/GltfPipeline/addToArray",[],function(){"use strict";function e(e,t){e.push(t);return e.length-1}return e});define("ThirdParty/GltfPipeline/ForEach",["../../Core/defined"],function(e){"use strict";function t(){}t.object=function(t,r){if(e(t)){for(var i=0;i<t.length;i++){var n=t[i];var a=r(n,i);if(typeof a==="number"){i+=a}else if(a){break}}}};t.topLevel=function(e,r,i){var n=e[r];t.object(n,i)};t.accessor=function(e,r){t.topLevel(e,"accessors",r)};t.accessorWithSemantic=function(e,r,i){t.mesh(e,function(e){t.meshPrimitive(e,function(e){t.meshPrimitiveAttribute(e,function(t,n){if(n.indexOf(r)===0){i(t,n,e)}})})})};t.animation=function(e,r){t.topLevel(e,"animations",r)};t.animationSampler=function(r,i){var n=r.samplers;if(e(n)){t.object(n,i)}};t.buffer=function(e,r){t.topLevel(e,"buffers",r)};t.bufferView=function(e,r){t.topLevel(e,"bufferViews",r)};t.camera=function(e,r){t.topLevel(e,"cameras",r)};t.image=function(e,r){t.topLevel(e,"images",r)};t.material=function(e,r){t.topLevel(e,"materials",r)};t.materialValue=function(t,r){var i=t.values;if(e(i)){for(var n in i){if(i.hasOwnProperty(n)){r(i[n],n)}}}};t.mesh=function(e,r){t.topLevel(e,"meshes",r)};t.meshPrimitive=function(t,r){var i=t.primitives;if(e(i)){var n=i.length;for(var a=0;a<n;a++){var o=i[a];r(o,a)}}};t.meshPrimitiveAttribute=function(t,r){var i=t.attributes;if(e(i)){for(var n in i){if(i.hasOwnProperty(n)){r(i[n],n)}}}};t.meshPrimitiveTargetAttribute=function(t,r){var i=t.targets;if(e(i)){for(var n in i){if(i.hasOwnProperty(n)){var a=i[n];for(var o in a){if(a.hasOwnProperty(o)&&o!=="extras"){r(a[o],o)}}}}}};t.node=function(e,r){t.topLevel(e,"nodes",r)};t.nodeInTree=function(r,i,n){var a=r.nodes;if(e(a)){for(var o=0;o<i.length;o++){var s=i[o];var l=a[s];if(e(l)){n(l,s);var u=l.children;if(e(u)){t.nodeInTree(r,u,n)}}}}};t.nodeInScene=function(r,i,n){var a=i.nodes;if(e(a)){t.nodeInTree(r,a,n)}};t.program=function(e,r){t.topLevel(e,"programs",r)};t.sampler=function(e,r){t.topLevel(e,"samplers",r)};t.scene=function(e,r){t.topLevel(e,"scenes",r)};t.shader=function(e,r){t.topLevel(e,"shaders",r)};t.skin=function(e,r){t.topLevel(e,"skins",r)};t.techniqueAttribute=function(t,r){var i=t.attributes;if(e(i)){for(var n in i){if(i.hasOwnProperty(n)){if(r(i[n],n)){break}}}}};t.techniqueParameter=function(t,r){var i=t.parameters;if(e(i)){for(var n in i){if(i.hasOwnProperty(n)){if(r(i[n],n)){break}}}}};t.technique=function(e,r){t.topLevel(e,"techniques",r)};t.texture=function(e,r){t.topLevel(e,"textures",r)};return t});define("ThirdParty/GltfPipeline/addDefaults",["./addToArray","./ForEach","../../Core/clone","../../Core/defaultValue","../../Core/defined","../../Core/WebGLConstants"],function(e,t,r,i,n,a){"use strict";var o={accessors:[],animations:[{channels:[],samplers:[{interpolation:"LINEAR"}]}],asset:{},buffers:[{byteLength:0,type:"arraybuffer"}],bufferViews:[{byteLength:0}],cameras:[],images:[],materials:[{values:function(e){var t=i(e.extensions,{});var r=t.KHR_materials_common;if(!n(r)){return{}}},extensions:function(e){var t=i(e.extensions,{});var r=t.KHR_materials_common;if(n(r)){var a=r.technique;var o={ambient:[0,0,0,1],emission:[0,0,0,1],transparency:[1]};if(a!=="CONSTANT"){o.diffuse=[0,0,0,1];if(a!=="LAMBERT"){o.specular=[0,0,0,1];o.shininess=[0]}}return{KHR_materials_common:{doubleSided:false,transparent:false,values:o}}}}}],meshes:[{primitives:[{attributes:{},mode:a.TRIANGLES}]}],nodes:[{children:[],matrix:function(e){if(!n(e.translation)&&!n(e.rotation)&&!n(e.scale)){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},rotation:function(e){if(n(e.translation)||n(e.scale)){return[0,0,0,1]}},scale:function(e){if(n(e.translation)||n(e.rotation)){return[1,1,1]}},translation:function(e){if(n(e.rotation)||n(e.scale)){return[0,0,0]}}}],programs:[{attributes:[]}],samplers:[{magFilter:a.LINEAR,minFilter:a.NEAREST_MIPMAP_LINEAR,wrapS:a.REPEAT,wrapT:a.REPEAT}],scenes:[{nodes:[]}],shaders:[],skins:[{bindShapeMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}],techniques:[{parameters:{},attributes:{},uniforms:{},states:{enable:[]}}],textures:[{format:a.RGBA,internalFormat:a.RGBA,target:a.TEXTURE_2D,type:a.UNSIGNED_BYTE}],extensionsUsed:[],extensionsRequired:[]};function s(e,t){for(var r in t){if(t.hasOwnProperty(r)){var a=t[r];if(typeof a==="function"){a=a(e)}if(n(a)){if(typeof a==="object"){if(Array.isArray(a)){var o=i(e[r],[]);if(a.length>0){var l=a[0];if(typeof l==="object"){var u=o.length;for(var c=0;c<u;c++){s(o[c],l)}}else{o=i(e[r],a)}}e[r]=o}else{var d=a["*"];e[r]=i(e[r],{});var f=e[r];if(n(d)){for(var h in f){if(f.hasOwnProperty(h)&&h!=="extras"){var p=f[h];s(p,d)}}}else{s(f,a)}}}else{e[r]=i(e[r],a)}}}}}var l={values:{emission:[.5,.5,.5,1]}};var u={attributes:{a_position:"position"},parameters:{modelViewMatrix:{semantic:"MODELVIEW",type:a.FLOAT_MAT4},projectionMatrix:{semantic:"PROJECTION",type:a.FLOAT_MAT4},emission:{type:a.FLOAT_VEC4,value:[.5,.5,.5,1]},position:{semantic:"POSITION",type:a.FLOAT_VEC3}},states:{enable:[a.CULL_FACE,a.DEPTH_TEST]},uniforms:{u_modelViewMatrix:"modelViewMatrix",u_projectionMatrix:"projectionMatrix",u_emission:"emission"}};var c={attributes:["a_position"]};var d={type:a.VERTEX_SHADER,extras:{_pipeline:{extension:".vert",source:""+"precision highp float;\n"+"\n"+"uniform mat4 u_modelViewMatrix;\n"+"uniform mat4 u_projectionMatrix;\n"+"\n"+"attribute vec3 a_position;\n"+"\n"+"void main (void)\n"+"{\n"+"    gl_Position = u_projectionMatrix * u_modelViewMatrix * vec4(a_position, 1.0);\n"+"}\n"}}};var f={type:a.FRAGMENT_SHADER,extras:{_pipeline:{extension:".frag",source:""+"precision highp float;\n"+"\n"+"uniform vec4 u_emission;\n"+"\n"+"void main(void)\n"+"{\n"+"    gl_FragColor = u_emission;\n"+"}\n"}}};function h(t){var i=t.materials;var a=t.meshes;var o;var s=a.length;for(var u=0;u<s;u++){var c=a[u];var d=c.primitives;var f=d.length;for(var h=0;h<f;h++){var p=d[h];if(!n(p.material)){if(!n(o)){o=e(i,r(l,true))}p.material=o}}}}function p(t){var a=t.materials;var o=t.techniques;var s=t.programs;var l=t.shaders;var h;var p=a.length;for(var m=0;m<p;m++){var v=a[m];var g=v.technique;var _=i(v.extensions,{});var y=_.KHR_materials_common;if(!n(g)){if(!n(h)&&!n(y)){var b=r(u,true);h=e(o,b);var w=r(c,true);b.program=e(s,w);var C=r(d,true);w.vertexShader=e(l,C);var S=r(f,true);w.fragmentShader=e(l,S)}v.technique=h}}}function m(e){var t=e.accessors;var r=t.length;for(var i=0;i<r;i++){var a=t[i];if(!n(a.byteOffset)){a.byteOffset=0}}var o=e.bufferViews;var s=o.length;for(var l=0;l<s;l++){var u=o[l];if(!n(u.byteOffset)){u.byteOffset=0}}}function v(e){var t=e.scenes;if(!n(e.scene)){var r=t.length;for(var i=0;i<r;i++){e.scene=i;break}}}function g(e){var t=e.techniques;var r=t.length;for(var i=0;i<r;i++){var a=t[i];var o=a.parameters;if(n(o.diffuse)){o.diffuse.semantic="_3DTILESDIFFUSE"}}}function _(e){var r={};var i=0;t.bufferView(e,function(e,t){if(!n(e.target)){r[t]=true;i++}});if(i>0){var o=e.accessors;var s=e.bufferViews;t.mesh(e,function(e){t.meshPrimitive(e,function(e){var l=e.indices;if(n(l)){var u=o[l];var c=u.bufferView;if(r[c]){var d=s[c];if(n(d)){d.target=a.ELEMENT_ARRAY_BUFFER;r[c]=false;i--}}}t.meshPrimitiveAttribute(e,function(e){var t=o[e];var l=t.bufferView;if(r[l]){var u=s[l];if(n(u)){u.target=a.ARRAY_BUFFER;r[l]=false;i--}}});t.meshPrimitiveTargetAttribute(e,function(e){var t=o[e].bufferView;if(r[t]){var l=s[t];if(n(l)){l.target=a.ARRAY_BUFFER;r[t]=false;i--}}})});if(i===0){return true}})}}function y(e,t){t=i(t,{});s(e,o);h(e);p(e);m(e);v(e);_(e);if(t.optimizeForCesium){g(e)}return e}return y});define("ThirdParty/GltfPipeline/addPipelineExtras",["../../Core/defaultValue","../../Core/defined"],function(e,t){"use strict";var r={attributes:true,uniforms:true,extensions:true,values:true,samplers:true};function i(i){var n=[];for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];var s=o.length;for(var l=0;l<s;l++){var u=o[l];if(t(u)&&typeof u==="object"){u.extras=e(u.extras,{});u.extras._pipeline=e(u.extras._pipeline,{});n.push(u)}}}}while(n.length>0){var c=n.pop();for(var d in c){if(c.hasOwnProperty(d)){var f=c[d];if(t(f)&&typeof f==="object"&&d!=="extras"){n.push(f);if(!r[d]&&!Array.isArray(f)){f.extras=e(f.extras,{});f.extras._pipeline=e(f.extras._pipeline,{})}}}}}i.extras=e(i.extras,{});i.extras._pipeline=e(i.extras._pipeline,{});i.asset=e(i.asset,{});i.asset.extras=e(i.asset.extras,{});i.asset.extras._pipeline=e(i.asset.extras._pipeline,{});return i}return i});define("ThirdParty/GltfPipeline/byteLengthForComponentType",["../../Core/WebGLConstants"],function(e){"use strict";function t(t){switch(t){case e.BYTE:case e.UNSIGNED_BYTE:return 1;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.FLOAT:case e.UNSIGNED_INT:return 4}}return t});define("ThirdParty/GltfPipeline/numberOfComponentsForType",[],function(){"use strict";function e(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}}return e});define("ThirdParty/GltfPipeline/getAccessorByteStride",["./byteLengthForComponentType","./numberOfComponentsForType","../../Core/defined"],function(e,t,r){"use strict";function i(i,n){var a=i.bufferViews[n.bufferView];if(r(a.byteStride)&&a.byteStride>0){return a.byteStride}return e(n.componentType)*t(n.type)}return i});define("ThirdParty/GltfPipeline/removeExtensionsRequired",["../../Core/defined"],function(e){"use strict";function t(t,r){var i=t.extensionsRequired;if(e(i)){var n=i.indexOf(r);if(n>=0){i.splice(n,1)}if(i.length===0){delete t.extensionsRequired}}}return t});define("ThirdParty/GltfPipeline/removeExtensionsUsed",["./removeExtensionsRequired","../../Core/defined"],function(e,t){"use strict";function r(r,i){var n=r.extensionsUsed;if(t(n)){var a=n.indexOf(i);if(a>=0){n.splice(a,1)}e(r,i);if(n.length===0){delete r.extensionsUsed}}}return r});define("ThirdParty/GltfPipeline/addExtensionsUsed",["../../Core/defined"],function(e){"use strict";function t(t,r){var i=t.extensionsUsed;if(!e(i)){i=[];t.extensionsUsed=i}if(i.indexOf(r)<0){i.push(r)}}return t});define("ThirdParty/GltfPipeline/addExtensionsRequired",["./addExtensionsUsed","../../Core/defined"],function(e,t){"use strict";function r(r,i){var n=r.extensionsRequired;if(!t(n)){n=[];r.extensionsRequired=n}if(n.indexOf(i)<0){n.push(i)}e(r,i)}return r});define("ThirdParty/GltfPipeline/findAccessorMinMax",["./getAccessorByteStride","./numberOfComponentsForType","../../Core/arrayFill","../../Core/ComponentDatatype","../../Core/defined"],function(e,t,r,i,n){"use strict";function a(a,o){var s=a.bufferViews;var l=a.buffers;var u=o.bufferView;var c=t(o.type);var d=r(new Array(c),Number.POSITIVE_INFINITY);var f=r(new Array(c),Number.NEGATIVE_INFINITY);if(n(u)&&n(s)&&s.hasOwnProperty(u)){var h=s[u];var p=h.buffer;if(n(p)&&n(l)&&l.hasOwnProperty(p)){var m=l[p];var v=m.extras._pipeline.source;var g=o.count;var _=e(a,o);var y=o.byteOffset+h.byteOffset;var b=o.componentType;for(var w=0;w<g;w++){var C=i.createArrayBufferView(b,v.buffer,y+v.byteOffset,c);for(var S=0;S<c;S++){var T=C[S];d[S]=Math.min(d[S],T);f[S]=Math.max(f[S],T)}y+=_}}}return{min:d,max:f}}return a});define("ThirdParty/GltfPipeline/updateVersion",["./addExtensionsRequired","./addToArray","./findAccessorMinMax","./ForEach","./getAccessorByteStride","../../Core/Cartesian3","../../Core/Math","../../Core/clone","../../Core/defaultValue","../../Core/defined","../../Core/Quaternion","../../Core/WebGLConstants"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";var f={.8:_,"1.0":U,"2.0":undefined};function h(e,t){t=l(t,{});var r=t.targetVersion;var i=e.version;e.asset=l(e.asset,{version:"1.0"});i=l(i,e.asset.version);if(!f.hasOwnProperty(i)){if(u(i)){i=(""+i).substring(0,3)}if(!f.hasOwnProperty(i)){i="1.0"}}var n=f[i];while(u(n)){if(i===r){break}n(e);i=e.asset.version;n=f[i]}return e}function p(e){var t=e.materials;for(var r in t){if(t.hasOwnProperty(r)){var i=t[r];var n=i.instanceTechnique;if(u(n)){i.technique=n.technique;i.values=n.values;delete i.instanceTechnique}}}}function m(e){var t=e.meshes;for(var r in t){if(t.hasOwnProperty(r)){var i=t[r];var n=i.primitives;if(u(n)){var a=n.length;for(var o=0;o<a;o++){var s=n[o];var c=l(s.primitive,d.TRIANGLES);s.mode=l(s.mode,c);delete s.primitive}}}}}function v(e){var t=e.nodes;var r=new a;var i=new c;for(var n in t){if(t.hasOwnProperty(n)){var o=t[n];if(u(o.rotation)){var s=o.rotation;a.fromArray(s,0,r);c.fromAxisAngle(r,s[3],i);o.rotation=[i.x,i.y,i.z,i.w]}var l=o.instanceSkin;if(u(l)){o.skeletons=l.skeletons;o.skin=l.skin;o.meshes=l.meshes;delete o.instanceSkin}}}}function g(e){var t=e.techniques;for(var r in t){if(t.hasOwnProperty(r)){var i=t[r];var n=i.passes;if(u(n)){var a=l(i.pass,"defaultPass");if(n.hasOwnProperty(a)){var o=n[a];var s=o.instanceProgram;i.attributes=l(i.attributes,s.attributes);i.program=l(i.program,s.program);i.uniforms=l(i.uniforms,s.uniforms);i.states=l(i.states,o.states)}delete i.passes;delete i.pass}}}}function _(e){if(!u(e.asset)){e.asset={}}var t=e.asset;t.version="1.0";if(!u(t.profile)||typeof t.profile==="string"){t.profile={}}if(u(e.version)){delete e.version}p(e);m(e);v(e);g(e);if(u(e.lights)){var r=l(e.extensions,{});e.extensions=r;var i=l(r.KHR_materials_common,{});r.KHR_materials_common=i;i.lights=e.lights;delete e.lights}if(u(e.allExtensions)){e.extensionsUsed=e.allExtensions;e.allExtensions=undefined}}function y(e){var t=e.animations;for(var r in t){if(t.hasOwnProperty(r)){var i=t[r];var n=i.parameters;if(u(n)){var a=i.samplers;for(var o in a){if(a.hasOwnProperty(o)){var s=a[o];s.input=n[s.input];s.output=n[s.output]}}delete i.parameters}}}}function b(e,t){var r=[];for(var i in e){if(e.hasOwnProperty(i)){var n=e[i];t[i]=r.length;r.push(n);if(!u(n.name)){n.name=i}}}return r}function w(e){var r;var n={accessors:{},animations:{},bufferViews:{},buffers:{},cameras:{},materials:{},meshes:{},nodes:{},programs:{},shaders:{},skins:{},techniques:{}};var a;var o={};var s=e.nodes;for(var l in s){if(s.hasOwnProperty(l)){a=s[l].jointName;if(u(a)){o[a]=l}}}for(var c in e){if(e.hasOwnProperty(c)&&c!=="extras"&&c!=="asset"&&c!=="extensions"){var d={};var f=e[c];if(typeof f==="object"&&!Array.isArray(f)){e[c]=b(f,d);n[c]=d;if(c==="animations"){d={};f.samplers=b(f.samplers,d);n[c].samplers=d}}}}for(a in o){if(o.hasOwnProperty(a)){o[a]=n.nodes[o[a]]}}if(u(e.scene)){e.scene=n.scenes[e.scene]}i.bufferView(e,function(e){if(u(e.buffer)){e.buffer=n.buffers[e.buffer]}});i.accessor(e,function(e){if(u(e.bufferView)){e.bufferView=n.bufferViews[e.bufferView]}});i.shader(e,function(e){var t=e.extensions;if(u(t)){var r=t.KHR_binary_glTF;if(u(r)){e.bufferView=n.bufferViews[r.bufferView];delete t.KHR_binary_glTF}if(Object.keys(t).length===0){delete e.extensions}}});i.program(e,function(e){if(u(e.vertexShader)){e.vertexShader=n.shaders[e.vertexShader]}if(u(e.fragmentShader)){e.fragmentShader=n.shaders[e.fragmentShader]}});i.technique(e,function(e){if(u(e.program)){e.program=n.programs[e.program]}i.techniqueParameter(e,function(e){if(u(e.node)){e.node=n.nodes[e.node]}var t=e.value;if(u(t)){if(Array.isArray(t)){if(t.length===1){var r=t[0];if(typeof r==="string"){t[0]=n.textures[r]}}}else if(typeof t==="string"){e.value=[n.textures[t]]}}})});i.mesh(e,function(e){i.meshPrimitive(e,function(e){if(u(e.indices)){e.indices=n.accessors[e.indices]}i.meshPrimitiveAttribute(e,function(t,r){e.attributes[r]=n.accessors[t]});if(u(e.material)){e.material=n.materials[e.material]}})});i.node(e,function(i){var a=i.children;if(u(a)){var o=a.length;for(r=0;r<o;r++){a[r]=n.nodes[a[r]]}}if(u(i.meshes)){var s=i.meshes;var l=s.length;if(l>0){i.mesh=n.meshes[s[0]];for(r=1;r<l;r++){var c={mesh:n.meshes[s[r]],extras:{_pipeline:{}}};var d=t(e.nodes,c);if(!u(a)){a=[];i.children=a}a.push(d)}}delete i.meshes}if(u(i.camera)){i.camera=n.cameras[i.camera]}if(u(i.skeletons)){var f=i.skeletons;var h=f.length;if(h>0&&u(i.skin)){var p=e.skins[n.skins[i.skin]];p.skeleton=n.nodes[f[0]]}delete i.skeletons}if(u(i.skin)){i.skin=n.skins[i.skin]}if(u(i.jointName)){delete i.jointName}});i.skin(e,function(e){if(u(e.inverseBindMatrices)){e.inverseBindMatrices=n.accessors[e.inverseBindMatrices]}var t=[];var i=e.jointNames;if(u(i)){for(r=0;r<i.length;r++){t[r]=o[i[r]]}e.joints=t;delete e.jointNames}});i.scene(e,function(e){var t=e.nodes;if(u(t)){var i=t.length;for(r=0;r<i;r++){t[r]=n.nodes[t[r]]}}});i.animation(e,function(e){var t={};e.samplers=b(e.samplers,t);i.animationSampler(e,function(e){e.input=n.accessors[e.input];e.output=n.accessors[e.output]});var a=e.channels;if(u(a)){var o=a.length;for(r=0;r<o;r++){var s=a[r];s.sampler=t[s.sampler];var l=s.target;if(u(l)){l.node=n.nodes[l.id]}}}});i.material(e,function(e){if(u(e.technique)){e.technique=n.techniques[e.technique]}i.materialValue(e,function(t,r){if(Array.isArray(t)){if(t.length===1){var i=t[0];if(typeof i==="string"){t[0]=n.textures[i]}}}else if(typeof t==="string"){e.values[r]={index:n.textures[t]}}});var t=e.extensions;if(u(t)){var r=t.KHR_materials_common;if(u(r)){i.materialValue(r,function(e,t){if(Array.isArray(e)){if(e.length===1){var i=e[0];if(typeof i==="string"){e[0]=n.textures[i]}}}else if(typeof e==="string"){r.values[t]={index:n.textures[e]}}})}}});i.image(e,function(e){var t=e.extensions;if(u(t)){var r=t.KHR_binary_glTF;if(u(r)){e.bufferView=n.bufferViews[r.bufferView];e.mimeType=r.mimeType;delete t.KHR_binary_glTF}if(Object.keys(t).length===0){delete e.extensions}}if(u(e.extras)){var i=e.extras.compressedImage3DTiles;for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];var s=o.extensions;if(u(s)){var l=s.KHR_binary_glTF;if(u(l)){o.bufferView=n.bufferViews[l.bufferView];o.mimeType=l.mimeType;delete s.KHR_binary_glTF}if(Object.keys(t).length===0){delete o.extensions}}}}}});i.texture(e,function(e){if(u(e.sampler)){e.sampler=n.samplers[e.sampler]}if(u(e.source)){e.source=n.images[e.source]}})}function C(e){var t=e.asset;delete t.profile}var S={CESIUM_RTC:true,KHR_materials_common:true,WEB3D_quantized_attributes:true};function T(e){var t=e.extensionsUsed;e.extensionsRequired=l(e.extensionsRequired,[]);if(u(t)){var r=t.length;for(var i=0;i<r;i++){var n=t[i];if(u(S[n])){e.extensionsRequired.push(n)}}}}function E(e){i.buffer(e,function(e){delete e.type})}function x(e){i.mesh(e,function(e){i.meshPrimitive(e,function(e){i.meshPrimitiveAttribute(e,function(t,r){if(r==="TEXCOORD"){e.attributes.TEXCOORD_0=t}else if(r==="COLOR"){e.attributes.COLOR_0=t}});delete e.attributes.TEXCOORD;delete e.attributes.COLOR})});i.technique(e,function(e){i.techniqueParameter(e,function(e){var t=e.semantic;if(u(t)){if(t==="TEXCOORD"){e.semantic="TEXCOORD_0"}else if(t==="COLOR"){e.semantic="COLOR_0"}}})})}var P={POSITION:true,NORMAL:true,TEXCOORD:true,COLOR:true,JOINT:true,WEIGHT:true};function A(e){var t={};i.mesh(e,function(e){i.meshPrimitive(e,function(e){i.meshPrimitiveAttribute(e,function(e,r){if(r.charAt(0)!=="_"){var i=r.search(/_[0-9]+/g);var n=r;if(i>=0){n=r.substring(0,i)}if(!u(P[n])){var a="_"+r;t[r]=a}}});for(var r in t){if(t.hasOwnProperty(r)){var n=t[r];var a=e.attributes[r];if(u(a)){delete e.attributes[r];e.attributes[n]=a}}}})});i.technique(e,function(e){i.techniqueParameter(e,function(e){var r=t[e.semantic];if(u(r)){e.semantic=r}})})}function O(e){i.technique(e,function(e){i.techniqueParameter(e,function(e){var t=e.value;if(u(t)&&!Array.isArray(t)){e.value=[t]}})})}function D(e){i.technique(e,function(e){var t=e.states;if(u(t)){var r=t.functions;if(u(r)){delete r.scissor}var i=t.enable;if(u(i)){var n=i.indexOf(d.SCISSOR_TEST);if(n>=0){i.splice(n,1)}}}})}function I(e){i.technique(e,function(e){var t=e.states;if(u(t)){var r=t.functions;if(u(r)){var i=r.blendColor;if(u(i)){for(var n=0;n<4;n++){i[n]=o.clamp(i[n],0,1)}}var a=r.depthRange;if(u(a)){a[1]=o.clamp(a[1],0,1);a[0]=o.clamp(a[0],0,a[1])}}}})}function M(e){i.camera(e,function(e){var t=e.perspective;if(u(t)){var r=t.aspectRatio;if(u(r)&&r===0){delete t.aspectRatio}var i=t.yfov;if(u(i)&&i===0){t.yfov=1}}})}function R(e){i.buffer(e,function(e){if(!u(e.byteLength)){e.byteLength=e.extras._pipeline.source.length}});i.bufferView(e,function(t){if(!u(t.byteLength)){var r=t.buffer;var i=e.buffers[r];t.byteLength=i.byteLength}})}function L(e){var r=e.bufferViews;var a={};i.accessor(e,function(i){var o=i.bufferView;if(u(o)){if(!u(a[o])){a[o]=true}var l=s(r[o]);var c=n(e,i);if(u(c)){l.byteStride=c;if(l.byteStride!==0){l.byteLength=i.count*c}l.byteOffset+=i.byteOffset;i.byteOffset=0;delete i.byteStride}i.bufferView=t(r,l)}});var o={};var l=0;i.bufferView(e,function(e,t){if(u(a[t])){l++}else{o[t]=t-l}});var c=0;for(var d in a){if(u(d)){var f=parseInt(d)-c;r.splice(f,1);c++}}i.accessor(e,function(e){var t=e.bufferView;if(u(t)){e.bufferView=o[t]}});i.shader(e,function(e){var t=e.bufferView;if(u(t)){e.bufferView=o[t]}});i.image(e,function(e){var t=e.bufferView;if(u(t)){e.bufferView=o[t]}if(u(e.extras)){var r=e.extras.compressedImage3DTiles;for(var i in r){if(r.hasOwnProperty(i)){var n=r[i];var a=n.bufferView;if(u(a)){n.bufferView=o[a]}}}}})}function N(e){i.accessor(e,function(t){if(!u(t.min)||!u(t.max)){var i=r(e,t);t.min=i.min;t.max=i.max}})}function k(e){i.technique(e,function(e){i.techniqueAttribute(e,function(t){var r=e.parameters[t];if(u(r.value)){delete r.value}})})}function F(e){i.technique(e,function(e){i.techniqueParameter(e,function(e){if(u(e.count)){var t=e.semantic;if(!u(t)||t!=="JOINTMATRIX"&&t.indexOf("_")!==0){delete e.count}}})})}function B(t){var r=t.techniques;if(u(r)&&r.length>0){e(t,"KHR_technique_webgl")}}function U(e){if(!u(e.asset)){e.asset={}}var t=e.asset;t.version="2.0";p(e);y(e);w(e);C(e);T(e);R(e);L(e);E(e);x(e);A(e);O(e);D(e);I(e);M(e);k(e);F(e);B(e)}return h});define("ThirdParty/GltfPipeline/parseBinaryGltf",["./addPipelineExtras","./removeExtensionsUsed","./updateVersion","../../Core/ComponentDatatype","../../Core/defined","../../Core/DeveloperError","../../Core/getMagic","../../Core/getStringFromTypedArray","../../Core/WebGLConstants"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(u){var c=i.createArrayBufferView(l.INT,u.buffer,u.byteOffset,5);var d=o(u);if(d!=="glTF"){throw new a("File is not valid binary glTF")}var f=c[1];if(f!==1&&f!==2){throw new a("Binary glTF version is not 1 or 2")}var h;var p;var m;if(f===1){m=c[2];var v=c[3];var g=c[4];if(g!==0){throw new a("Binary glTF scene format is not JSON")}var _=20;var y=_+v;var b=s(u,_,v);h=JSON.parse(b);var w=new Uint8Array(u.subarray(y,m));p=h.buffers;if(n(p)&&Object.keys(p).length>0){var C=p.binary_glTF;if(!n(C)){C=p.KHR_binary_glTF}if(n(C)){C.extras={_pipeline:{source:w}}}}r(h);t(h,"KHR_binary_glTF");e(h)}if(f===2){m=c[2];var S=12;var T;while(S<m){var E=i.createArrayBufferView(l.INT,u.buffer,u.byteOffset+S,2);var x=E[0];var P=E[1];S+=8;var A=u.subarray(S,S+x);S+=x;if(P===1313821514){var O=s(A);h=JSON.parse(O);e(h)}else if(P===5130562){T=new Uint8Array(A)}}if(n(h)&&n(T)){p=h.buffers;if(n(p)&&p.length>0){var D=p[0];D.extras._pipeline.source=T}}}return h}return u});define("ThirdParty/GltfPipeline/techniqueParameterForSemantic",["../../Core/defined"],function(e){"use strict";function t(t,r){var i=t.parameters;for(var n in i){if(i.hasOwnProperty(n)){var a=i[n];var o=a.semantic;if(e(o)&&o===r){return n}}}}return t});define("ThirdParty/GltfPipeline/webGLConstantToGlslType",["../../Core/WebGLConstants"],function(e){"use strict";function t(t){switch(t){case e.FLOAT:return"float";case e.FLOAT_VEC2:return"vec2";case e.FLOAT_VEC3:return"vec3";case e.FLOAT_VEC4:return"vec4";case e.FLOAT_MAT2:return"mat2";case e.FLOAT_MAT3:return"mat3";case e.FLOAT_MAT4:return"mat4";case e.SAMPLER_2D:return"sampler2D";case e.BOOL:return"bool"}}return t});define("ThirdParty/GltfPipeline/glslTypeToWebGLConstant",["../../Core/WebGLConstants"],function(e){"use strict";function t(t){switch(t){case"float":return e.FLOAT;case"vec2":return e.FLOAT_VEC2;case"vec3":return e.FLOAT_VEC3;case"vec4":return e.FLOAT_VEC4;case"mat2":return e.FLOAT_MAT2;case"mat3":return e.FLOAT_MAT3;case"mat4":return e.FLOAT_MAT4;case"sampler2D":return e.SAMPLER_2D}}return t});define("ThirdParty/GltfPipeline/processModelMaterialsCommon",["./addToArray","./ForEach","./numberOfComponentsForType","./techniqueParameterForSemantic","./webGLConstantToGlslType","./glslTypeToWebGLConstant","../../Core/clone","../../Core/defined","../../Core/defaultValue","../../Core/WebGLConstants"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e,r){r=l(r,{});if(!s(e)){return undefined}var i=false;var n=e.extensionsRequired;var a=e.extensionsUsed;if(s(a)){var o=a.indexOf("KHR_materials_common");if(o>=0){a.splice(o,1);i=true}if(s(n)){o=n.indexOf("KHR_materials_common");if(o>=0){n.splice(o,1)}}}if(i){if(!s(e.programs)){e.programs=[]}if(!s(e.shaders)){e.shaders=[]}if(!s(e.techniques)){e.techniques=[]}m(e);var u=d(e);y(e);var c={};t.material(e,function(t){if(s(t.extensions)&&s(t.extensions.KHR_materials_common)){var i=t.extensions.KHR_materials_common;var n=p(i);var a=c[n];if(!s(a)){a=f(e,i,u,r);c[n]=a}t.values={};var o=i.values;for(var l in o){if(o.hasOwnProperty(l)){var d=o[l];t.values[l]=d}}t.technique=a;delete t.extensions.KHR_materials_common;if(Object.keys(t.extensions).length===0){delete t.extensions}}});if(s(e.extensions)){delete e.extensions.KHR_materials_common;if(Object.keys(e.extensions).length===0){delete e.extensions}}_(e)}return e}function d(e){var t={};var r;if(s(e.extensions)&&s(e.extensions.KHR_materials_common)){r=e.extensions.KHR_materials_common.lights}if(s(r)){var i=e.nodes;for(var n in i){if(i.hasOwnProperty(n)){var a=i[n];if(s(a.extensions)&&s(a.extensions.KHR_materials_common)){var o=a.extensions.KHR_materials_common.light;if(s(o)&&s(r[o])){r[o].node=n}delete a.extensions.KHR_materials_common}}}var l=0;for(var c in r){if(r.hasOwnProperty(c)){var d=r[c];var f=d.type;if(f!=="ambient"&&!s(d.node)){delete r[c];continue}var h="light"+l.toString();d.baseName=h;switch(f){case"ambient":var p=d.ambient;t[h+"Color"]={type:u.FLOAT_VEC3,value:p.color};break;case"directional":var m=d.directional;t[h+"Color"]={type:u.FLOAT_VEC3,value:m.color};if(s(d.node)){t[h+"Transform"]={node:d.node,semantic:"MODELVIEW",type:u.FLOAT_MAT4}}break;case"point":var v=d.point;t[h+"Color"]={type:u.FLOAT_VEC3,value:v.color};if(s(d.node)){t[h+"Transform"]={node:d.node,semantic:"MODELVIEW",type:u.FLOAT_MAT4}}t[h+"Attenuation"]={type:u.FLOAT_VEC3,value:[v.constantAttenuation,v.linearAttenuation,v.quadraticAttenuation]};break;case"spot":var g=d.spot;t[h+"Color"]={type:u.FLOAT_VEC3,value:g.color};if(s(d.node)){t[h+"Transform"]={node:d.node,semantic:"MODELVIEW",type:u.FLOAT_MAT4};t[h+"InverseTransform"]={node:d.node,semantic:"MODELVIEWINVERSE",type:u.FLOAT_MAT4,useInFragment:true}}t[h+"Attenuation"]={type:u.FLOAT_VEC3,value:[g.constantAttenuation,g.linearAttenuation,g.quadraticAttenuation]};t[h+"FallOff"]={type:u.FLOAT_VEC2,value:[g.fallOffAngle,g.fallOffExponent]};break}++l}}}return t}function f(t,i,o,c){var d=l(c.optimizeForCesium,false);var f=s(t.extensions)&&s(t.extensions.CESIUM_RTC);var p=l(c.addBatchIdToGeneratedShaders,false);var m=t.techniques;var g=t.shaders;var _=t.programs;var y=i.technique.toUpperCase();var b;if(s(t.extensions)&&s(t.extensions.KHR_materials_common)){b=t.extensions.KHR_materials_common.lights}var w=i.values;if(s(i.transparent)){w.transparent=i.transparent}if(s(i.doubleSided)){w.doubleSided=i.doubleSided}var C=l(i.jointCount,0);var S=C>0;var T={};if(S){T=i.extras._pipeline.skinning}var E="precision highp float;\n";var x="precision highp float;\n";var P=y!=="CONSTANT";var A={modelViewMatrix:{semantic:f?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:u.FLOAT_MAT4},projectionMatrix:{semantic:"PROJECTION",type:u.FLOAT_MAT4}};if(P){A.normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:u.FLOAT_MAT3}}if(S){A.jointMatrix={count:C,semantic:"JOINTMATRIX",type:u.FLOAT_MAT4}}var O;var D=false;for(var I in w){if(w.hasOwnProperty(I)&&I!=="transparent"&&I!=="doubleSided"){var M=h(I,w[I]);O=I.toLowerCase();if(!D&&M===u.SAMPLER_2D){D=true}A[O]={type:M}}}if(s(A.diffuse)&&d){A.diffuse.semantic="_3DTILESDIFFUSE"}if(s(o)){for(var R in o){if(o.hasOwnProperty(R)){A[R]=o[R]}}}var L={};for(var N in A){if(A.hasOwnProperty(N)&&N!=="extras"){var k=A[N];L["u_"+N]=N;var F=s(k.count)?"["+k.count+"]":"";if(k.type!==u.FLOAT_MAT3&&k.type!==u.FLOAT_MAT4||k.useInFragment){x+="uniform "+n(k.type)+" u_"+N+F+";\n";delete k.useInFragment}else{E+="uniform "+n(k.type)+" u_"+N+F+";\n"}}}var B="";if(S){var U,V;var z=r(T.type);var q=false;if(T.type.indexOf("MAT")===0){q=true;z=Math.sqrt(z)}if(!q){for(U=0;U<z;U++){if(U===0){B+="  mat4 skinMat = "}else{B+="  skinMat += "}B+="a_weight["+U+"] * u_jointMatrix[int(a_joint["+U+"])];\n"}}else{for(U=0;U<z;U++){for(V=0;V<z;V++){if(U===0&&V===0){B+="  mat4 skinMat = "}else{B+="  skinMat += "}B+="a_weight["+U+"]["+V+"] * u_jointMatrix[int(a_joint["+U+"]["+V+"])];\n"}}}}var G={a_position:"position"};A.position={semantic:"POSITION",type:u.FLOAT_VEC3};E+="attribute vec3 a_position;\n";E+="varying vec3 v_positionEC;\n";if(S){B+="  vec4 pos = u_modelViewMatrix * skinMat * vec4(a_position,1.0);\n"}else{B+="  vec4 pos = u_modelViewMatrix * vec4(a_position,1.0);\n"}B+="  v_positionEC = pos.xyz;\n";B+="  gl_Position = u_projectionMatrix * pos;\n";x+="varying vec3 v_positionEC;\n";if(P){G.a_normal="normal";A.normal={semantic:"NORMAL",type:u.FLOAT_VEC3};E+="attribute vec3 a_normal;\n";E+="varying vec3 v_normal;\n";if(S){B+="  v_normal = u_normalMatrix * mat3(skinMat) * a_normal;\n"}else{B+="  v_normal = u_normalMatrix * a_normal;\n"}x+="varying vec3 v_normal;\n"}var H;if(D){G.a_texcoord_0="texcoord_0";A.texcoord_0={semantic:"TEXCOORD_0",type:u.FLOAT_VEC2};H="v_texcoord_0";E+="attribute vec2 a_texcoord_0;\n";E+="varying vec2 "+H+";\n";B+="  "+H+" = a_texcoord_0;\n";x+="varying vec2 "+H+";\n"}if(S){G.a_joint="joint";var j=v(T.type);var W=a(j);A.joint={semantic:"JOINT",type:W};G.a_weight="weight";A.weight={semantic:"WEIGHT",type:W};E+="attribute "+j+" a_joint;\n";E+="attribute "+j+" a_weight;\n"}if(p){G.a_batchId="batchId";A.batchId={semantic:"_BATCHID",type:u.FLOAT};E+="attribute float a_batchId;\n"}var Y=P&&(y==="BLINN"||y==="PHONG")&&s(A.specular)&&s(A.shininess);var X=false;var Q=false;var Z="";for(var K in b){if(b.hasOwnProperty(K)){var J=b[K];var $=J.type.toLowerCase();var ee=J.baseName;Z+="  {\n";var te="u_"+ee+"Color";var re;var ie;if($==="ambient"){Q=true;Z+="    ambientLight += "+te+";\n"}else if(P){X=true;re="v_"+ee+"Direction";ie="v_"+ee+"Position";if($!=="point"){E+="varying vec3 "+re+";\n";x+="varying vec3 "+re+";\n";B+="  "+re+" = mat3(u_"+ee+"Transform) * vec3(0.,0.,1.);\n";if($==="directional"){Z+="    vec3 l = normalize("+re+");\n"}}if($!=="directional"){E+="varying vec3 "+ie+";\n";x+="varying vec3 "+ie+";\n";B+="  "+ie+" = u_"+ee+"Transform[3].xyz;\n";Z+="    vec3 VP = "+ie+" - v_positionEC;\n";Z+="    vec3 l = normalize(VP);\n";Z+="    float range = length(VP);\n";Z+="    float attenuation = 1.0 / (u_"+ee+"Attenuation.x + ";Z+="(u_"+ee+"Attenuation.y * range) + ";Z+="(u_"+ee+"Attenuation.z * range * range));\n"}else{Z+="    float attenuation = 1.0;\n"}if($==="spot"){Z+="    float spotDot = dot(l, normalize("+re+"));\n";Z+="    if (spotDot < cos(u_"+ee+"FallOff.x * 0.5))\n";Z+="    {\n";Z+="      attenuation = 0.0;\n";Z+="    }\n";Z+="    else\n";Z+="    {\n";Z+="        attenuation *= max(0.0, pow(spotDot, u_"+ee+"FallOff.y));\n";Z+="    }\n"}Z+="    diffuseLight += "+te+"* max(dot(normal,l), 0.) * attenuation;\n";if(Y){if(y==="BLINN"){Z+="    vec3 h = normalize(l + viewDir);\n";Z+="    float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess)) * attenuation;\n"}else{Z+="    vec3 reflectDir = reflect(-l, normal);\n";Z+="    float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess)) * attenuation;\n"}Z+="    specularLight += "+te+" * specularIntensity;\n"}}Z+="  }\n"}}if(!Q){Z+="  ambientLight += vec3(0.2, 0.2, 0.2);\n"}if(!X&&y!=="CONSTANT"){if(d){Z+="  vec3 l = normalize(czm_sunDirectionEC);\n"}else{Z+="  vec3 l = vec3(0.0, 0.0, 1.0);\n"}Z+="  diffuseLight += vec3(1.0, 1.0, 1.0) * max(dot(normal,l), 0.);\n";if(Y){if(y==="BLINN"){Z+="  vec3 h = normalize(l + viewDir);\n";Z+="  float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess));\n"}else{Z+="  vec3 reflectDir = reflect(-l, normal);\n";Z+="  float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess));\n"}Z+="  specularLight += vec3(1.0, 1.0, 1.0) * specularIntensity;\n"}}E+="void main(void) {\n";E+=B;E+="}\n";x+="void main(void) {\n";var ne="  vec3 color = vec3(0.0, 0.0, 0.0);\n";if(P){x+="  vec3 normal = normalize(v_normal);\n";if(i.doubleSided){x+="  if (gl_FrontFacing == false)\n";x+="  {\n";x+="    normal = -normal;\n";x+="  }\n"}}var ae;if(y!=="CONSTANT"){if(s(A.diffuse)){if(A.diffuse.type===u.SAMPLER_2D){x+="  vec4 diffuse = texture2D(u_diffuse, "+H+");\n"}else{x+="  vec4 diffuse = u_diffuse;\n"}x+="  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n";ne+="  color += diffuse.rgb * diffuseLight;\n"}if(Y){if(A.specular.type===u.SAMPLER_2D){x+="  vec3 specular = texture2D(u_specular, "+H+").rgb;\n"}else{x+="  vec3 specular = u_specular.rgb;\n"}x+="  vec3 specularLight = vec3(0.0, 0.0, 0.0);\n";ne+="  color += specular * specularLight;\n"}if(s(A.transparency)){ae="  gl_FragColor = vec4(color * diffuse.a * u_transparency, diffuse.a * u_transparency);\n"}else{ae="  gl_FragColor = vec4(color * diffuse.a, diffuse.a);\n"}}else{if(s(A.transparency)){ae="  gl_FragColor = vec4(color * u_transparency, u_transparency);\n"}else{ae="  gl_FragColor = vec4(color, 1.0);\n"}}if(s(A.emission)){if(A.emission.type===u.SAMPLER_2D){x+="  vec3 emission = texture2D(u_emission, "+H+").rgb;\n"}else{x+="  vec3 emission = u_emission.rgb;\n"}ne+="  color += emission;\n"}if(s(A.ambient)||y!=="CONSTANT"){if(s(A.ambient)){if(A.ambient.type===u.SAMPLER_2D){x+="  vec3 ambient = texture2D(u_ambient, "+H+").rgb;\n"}else{x+="  vec3 ambient = u_ambient.rgb;\n"}}else{x+="  vec3 ambient = diffuse.rgb;\n"}ne+="  color += ambient * ambientLight;\n"}x+="  vec3 viewDir = -normalize(v_positionEC);\n";x+="  vec3 ambientLight = vec3(0.0, 0.0, 0.0);\n";x+=Z;x+=ne;x+=ae;x+="}\n";var oe;if(w.transparent){oe={enable:[u.DEPTH_TEST,u.BLEND],functions:{depthMask:[false],blendEquationSeparate:[u.FUNC_ADD,u.FUNC_ADD],blendFuncSeparate:[u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA]}}}else if(i.doubleSided){oe={enable:[u.DEPTH_TEST]}}else{oe={enable:[u.CULL_FACE,u.DEPTH_TEST]}}var se=e(g,{type:u.VERTEX_SHADER,extras:{_pipeline:{source:E,extension:".glsl"}}});var le=e(g,{type:u.FRAGMENT_SHADER,extras:{_pipeline:{source:x,extension:".glsl"}}});var ue=Object.keys(G);var ce=e(_,{attributes:ue,fragmentShader:le,vertexShader:se});var de=e(m,{attributes:G,parameters:A,program:ce,states:oe,uniforms:L});return de}function h(e,t){var r;if(s(t.value)){r=t.value}else if(s(t.index)){r=[t.index]}else{r=t}switch(e){case"ambient":return r.length===1?u.SAMPLER_2D:u.FLOAT_VEC4;case"diffuse":return r.length===1?u.SAMPLER_2D:u.FLOAT_VEC4;case"emission":return r.length===1?u.SAMPLER_2D:u.FLOAT_VEC4;case"specular":return r.length===1?u.SAMPLER_2D:u.FLOAT_VEC4;case"shininess":return u.FLOAT;case"transparency":return u.FLOAT;case"transparent":return u.BOOL;case"doubleSided":return u.BOOL}}function p(e){var t="";t+="technique:"+e.technique+";";var r=e.values;var i=Object.keys(r).sort();var n=i.length;for(var a=0;a<n;++a){var o=i[a];if(r.hasOwnProperty(o)){t+=o+":"+h(o,r[o]);t+=";"}}var s=l(e.doubleSided,l(e.values.doubleSided,false));t+=s.toString()+";";var u=l(e.transparent,l(e.values.transparent,false));t+=u.toString()+";";var c=l(e.jointCount,0);t+=c.toString()+";";if(c>0){var d=e.extras._pipeline.skinning;t+=d.type+";"}return t}function m(e){if(!s(e.extensions)){e.extensions={}}var t=e.extensions;if(!s(t.KHR_materials_common)){t.KHR_materials_common={}}var r=t.KHR_materials_common;if(!s(r.lights)){r.lights={}}var i=r.lights;var n=i.length;for(var a=0;a<n;a++){var o=i[a];if(o.type==="ambient"){if(!s(o.ambient)){o.ambient={}}var u=o.ambient;if(!s(u.color)){u.color=[1,1,1]}}else if(o.type==="directional"){if(!s(o.directional)){o.directional={}}var c=o.directional;if(!s(c.color)){c.color=[1,1,1]}}else if(o.type==="point"){if(!s(o.point)){o.point={}}var d=o.point;if(!s(d.color)){d.color=[1,1,1]}d.constantAttenuation=l(d.constantAttenuation,1);d.linearAttenuation=l(d.linearAttenuation,0);d.quadraticAttenuation=l(d.quadraticAttenuation,0)}else if(o.type==="spot"){if(!s(o.spot)){o.spot={}}var f=o.spot;if(!s(f.color)){f.color=[1,1,1]}f.constantAttenuation=l(f.constantAttenuation,1);f.fallOffAngle=l(f.fallOffAngle,3.14159265);f.fallOffExponent=l(f.fallOffExponent,0);f.linearAttenuation=l(f.linearAttenuation,0);f.quadraticAttenuation=l(f.quadraticAttenuation,0)}}}function v(e){if(e==="SCALAR"){return"float"}return e.toLowerCase()}function g(e,t){var r=e.accessors;var n=e.materials;var a=e.techniques;var o=e.programs;var l=e.shaders;var u=t.attributes;var c=n[t.material];var d=a[c.technique];var f=o[d.program];var h=l[f.vertexShader];for(var p in u){if(u.hasOwnProperty(p)){if(!s(i(d,p))){var m=u[p];var g=r[m];var _=p.toLowerCase();if(_.charAt(0)==="_"){_=_.slice(1)}var y="a_"+_;d.parameters[_]={semantic:p,type:g.componentType};d.attributes[y]=_;f.attributes.push(y);var b=h.extras._pipeline;var w=b.source;w="attribute "+v(g.type)+" "+y+";\n"+w;b.source=w}}}}function _(e){t.mesh(e,function(r){t.meshPrimitive(r,function(t){g(e,t)})})}function y(r){var i=r.accessors;var n=r.materials;t.mesh(r,function(r){t.meshPrimitive(r,function(t){var r=t.material;var a=n[r];if(s(a.extensions)&&s(a.extensions.KHR_materials_common)){var l=a.extensions.KHR_materials_common;var u=t.attributes.JOINT;var c;var d;if(s(u)){var f=i[u];c=f.componentType;d=f.type}var h=s(u);var p=l.extras._pipeline.skinning;if(!s(p)){l.extras._pipeline.skinning={skinned:h,componentType:c,type:d}}else if(p.skinned!==h||p.type!==d){var m=o(a,true);m.extensions.KHR_materials_common.extras._pipeline.skinning={skinned:h,componentType:c,type:d};r=e(n,m);t.material=r}}})})}return c});define("ThirdParty/GltfPipeline/processPbrMetallicRoughness",["./addToArray","./ForEach","./numberOfComponentsForType","./techniqueParameterForSemantic","./webGLConstantToGlslType","./glslTypeToWebGLConstant","../../Core/clone","../../Core/defined","../../Core/defaultValue","../../Core/WebGLConstants"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e,r){r=l(r,{});var i=false;t.material(e,function(e){if(s(e.pbrMetallicRoughness)){i=true}});if(i){if(!s(e.programs)){e.programs=[]}if(!s(e.shaders)){e.shaders=[]}if(!s(e.techniques)){e.techniques=[]}v(e);if(!s(e.techniques)){e.techniques=[]}var n=[];t.material(e,function(t){if(s(t.pbrMetallicRoughness)){var i=t.pbrMetallicRoughness;var a=d(e,t,r);var o={values:i,technique:a};n.push(o)}});e.materials=n;m(e)}return e}function d(i,o,c){var d=l(c.optimizeForCesium,false);var p=s(i.extensions)&&s(i.extensions.CESIUM_RTC);var m=l(c.addBatchIdToGeneratedShaders,false);var v=i.techniques;var g=i.shaders;var _=i.programs;var y=o.pbrMetallicRoughness;for(var b in o){if(o.hasOwnProperty(b)&&(b.indexOf("Texture")>=0||b.indexOf("Factor")>=0)||b==="doubleSided"){y[b]=o[b]}}var w="precision highp float;\n";var C="precision highp float;\n";var S;if(s(i.skins)){S=i.skins[0]}var T=s(S)?S.joints:[];var E=T.length;var x=o.extras._pipeline.skinning;var P=s(x.type);var A=true;var O=false;var D=false;var I;t.mesh(i,function(e){t.meshPrimitive(e,function(e){var t=e.targets;if(!D&&s(t)){D=true;I=t}var r=e.attributes;for(var i in r){if(i.indexOf("TANGENT")>=0){O=true}}})});var M={modelViewMatrix:{semantic:p?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:u.FLOAT_MAT4},projectionMatrix:{semantic:"PROJECTION",type:u.FLOAT_MAT4}};if(A){M.normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:u.FLOAT_MAT3}}if(P){M.jointMatrix={count:E,semantic:"JOINTMATRIX",type:u.FLOAT_MAT4}}if(D){M.morphWeights={count:I.length,semantic:"MORPHWEIGHTS",type:u.FLOAT}}var R=false;for(var L in y){if(y.hasOwnProperty(L)){var N=f(L,y[L]);if(!R&&N===u.SAMPLER_2D){R=true}M[L]={type:N}}}var k={};for(var F in M){if(M.hasOwnProperty(F)&&F!=="extras"){var B=M[F];k["u_"+F]=F;var U=s(B.count)?"["+B.count+"]":"";if(B.type!==u.FLOAT_MAT3&&B.type!==u.FLOAT_MAT4&&F!=="morphWeights"||B.useInFragment){C+="uniform "+n(B.type)+" u_"+F+U+";\n";delete B.useInFragment}else{w+="uniform "+n(B.type)+" u_"+F+U+";\n"}}}var V="";if(P){var z,q;var G=r(x.type);var H=false;if(x.type.indexOf("MAT")===0){H=true;G=Math.sqrt(G)}if(!H){for(z=0;z<G;z++){if(z===0){V+="    mat4 skinMatrix = "}else{V+="    skinMatrix += "}V+="a_weight["+z+"] * u_jointMatrix[int(a_joint["+z+"])];\n"}}else{for(z=0;z<G;z++){for(q=0;q<G;q++){if(z===0&&q===0){V+="    mat4 skinMatrix = "}else{V+="    skinMatrix += "}V+="a_weight["+z+"]["+q+"] * u_jointMatrix[int(a_joint["+z+"]["+q+"])];\n"}}}}var j={a_position:"position"};M.position={semantic:"POSITION",type:u.FLOAT_VEC3};w+="attribute vec3 a_position;\n";w+="varying vec3 v_positionEC;\n";if(d){w+="varying vec3 v_positionWC;\n"}V+="    vec3 weightedPosition = a_position;\n";if(A){V+="    vec3 weightedNormal = a_normal;\n"}if(O){V+="    vec3 weightedTangent = a_tangent;\n"}if(D){for(var W=0;W<I.length;W++){var Y=I[W];for(var X in Y){if(Y.hasOwnProperty(X)&&X!=="extras"){var Q=X.toLowerCase()+"_"+W;j["a_"+Q]=Q;M[Q]={semantic:X+"_"+W,type:u.FLOAT_VEC3};w+="attribute vec3 a_"+Q+";\n";if(X==="POSITION"){V+="    weightedPosition += u_morphWeights["+W+"] * a_"+Q+";\n"}else if(X==="NORMAL"){V+="    weightedNormal += u_morphWeights["+W+"] * a_"+Q+";\n"}else if(X==="TANGENT"){V+="    weightedTangent += u_morphWeights["+W+"] * a_"+Q+";\n"}}}}}if(P){V+="    vec4 position = skinMatrix * vec4(weightedPosition, 1.0);\n"}else{V+="    vec4 position = vec4(weightedPosition, 1.0);\n"}if(d){V+="    v_positionWC = (czm_model * position).xyz;\n"}V+="    position = u_modelViewMatrix * position;\n";V+="    v_positionEC = position.xyz;\n";V+="    gl_Position = u_projectionMatrix * position;\n";C+="varying vec3 v_positionEC;\n";if(d){C+="varying vec3 v_positionWC;\n"}if(A){j.a_normal="normal";M.normal={semantic:"NORMAL",type:u.FLOAT_VEC3};w+="attribute vec3 a_normal;\n";w+="varying vec3 v_normal;\n";if(P){V+="    v_normal = u_normalMatrix * mat3(skinMatrix) * weightedNormal;\n"}else{V+="    v_normal = u_normalMatrix * weightedNormal;\n"}C+="varying vec3 v_normal;\n"}if(O){j.a_tangent="tangent";M.tangent={semantic:"TANGENT",type:u.FLOAT_VEC3};w+="attribute vec3 a_tangent;\n";w+="varying vec3 v_tangent;\n";V+="    v_tangent = (u_modelViewMatrix * vec4(weightedTangent, 1.0)).xyz;\n";C+="varying vec3 v_tangent;\n"}var Z;if(R){j.a_texcoord_0="texcoord_0";M.texcoord_0={semantic:"TEXCOORD_0",type:u.FLOAT_VEC2};Z="v_texcoord_0";w+="attribute vec2 a_texcoord_0;\n";w+="varying vec2 "+Z+";\n";V+="    "+Z+" = a_texcoord_0;\n";C+="varying vec2 "+Z+";\n"}if(P){j.a_joint="joint";var K=h(x.type);var J=a(K);M.joint={semantic:"JOINTS_0",type:J};j.a_weight="weight";M.weight={semantic:"WEIGHTS_0",type:J};w+="attribute "+K+" a_joint;\n";w+="attribute "+K+" a_weight;\n"}if(m){j.a_batchId="batchId";M.batchId={semantic:"_BATCHID",type:u.FLOAT};w+="attribute float a_batchId;\n"}w+="void main(void) \n{\n";w+=V;w+="}\n";C+="const float M_PI = 3.141592653589793;\n";C+="vec3 lambertianDiffuse(vec3 baseColor) \n"+"{\n"+"    return baseColor / M_PI;\n"+"}\n\n";C+="vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH) \n"+"{\n"+"    return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\n"+"}\n\n";C+="vec3 fresnelSchlick(float metalness, float VdotH) \n"+"{\n"+"    return metalness + (vec3(1.0) - metalness) * pow(1.0 - VdotH, 5.0);\n"+"}\n\n";C+="float smithVisibilityG1(float NdotV, float roughness) \n"+"{\n"+"    float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;\n"+"    return NdotV / (NdotV * (1.0 - k) + k);\n"+"}\n\n";C+="float smithVisibilityGGX(float roughness, float NdotL, float NdotV) \n"+"{\n"+"    return smithVisibilityG1(NdotL, roughness) * smithVisibilityG1(NdotV, roughness);\n"+"}\n\n";C+="float GGX(float roughness, float NdotH) \n"+"{\n"+"    float roughnessSquared = roughness * roughness;\n"+"    float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;\n"+"    return roughnessSquared / (M_PI * f * f);\n"+"}\n\n";C+="void main(void) \n{\n";if(A){C+="    vec3 ng = normalize(v_normal);\n";if(s(y.normalTexture)){if(O){C+="    vec3 t = normalize(v_tangent);\n";C+="    vec3 b = normalize(cross(ng, t));\n";C+="    mat3 tbn = mat3(t, b, ng);\n";C+="    vec3 n = texture2D(u_normalTexture, "+Z+").rgb;\n";C+="    n = normalize(tbn * (2.0 * n - 1.0));\n"}else{C="#ifdef GL_OES_standard_derivatives\n"+"#extension GL_OES_standard_derivatives : enable\n"+"#endif\n"+C;C+="#ifdef GL_OES_standard_derivatives\n";C+="    vec3 pos_dx = dFdx(v_positionEC);\n";C+="    vec3 pos_dy = dFdy(v_positionEC);\n";C+="    vec3 tex_dx = dFdx(vec3("+Z+",0.0));\n";C+="    vec3 tex_dy = dFdy(vec3("+Z+",0.0));\n";C+="    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n";C+="    t = normalize(t - ng * dot(ng, t));\n";C+="    vec3 b = normalize(cross(ng, t));\n";C+="    mat3 tbn = mat3(t, b, ng);\n";C+="    vec3 n = texture2D(u_normalTexture, "+Z+").rgb;\n";C+="    n = normalize(tbn * (2.0 * n - 1.0));\n";C+="#else\n";C+="    vec3 n = ng;\n";C+="#endif\n"}}else{C+="    vec3 n = ng;\n"}if(y.doubleSided){C+="    if (!gl_FrontFacing)\n";C+="    {\n";C+="        n = -n;\n";C+="    }\n"}}if(s(y.baseColorTexture)){C+="    vec4 baseColorWithAlpha = texture2D(u_baseColorTexture, "+Z+");\n";if(s(y.baseColorFactor)){C+="    baseColorWithAlpha *= u_baseColorFactor;\n"}}else{if(s(y.baseColorFactor)){C+="    vec4 baseColorWithAlpha = u_baseColorFactor;\n"}else{C+="    vec4 baseColorWithAlpha = vec4(1.0);\n"}}C+="    vec3 baseColor = baseColorWithAlpha.rgb;\n";if(s(y.metallicRoughnessTexture)){C+="    vec3 metallicRoughness = texture2D(u_metallicRoughnessTexture, "+Z+").rgb;\n";C+="    float metalness = clamp(metallicRoughness.b, 0.0, 1.0);\n";C+="    float roughness = clamp(metallicRoughness.g, 0.04, 1.0);\n";if(s(y.metallicFactor)){C+="    metalness *= u_metallicFactor;\n"}if(s(y.roughnessFactor)){C+="    roughness *= u_roughnessFactor;\n"}}else{if(s(y.metallicFactor)){C+="    float metalness = clamp(u_metallicFactor, 0.0, 1.0);\n"}else{C+="    float metalness = 1.0;\n"}if(s(y.roughnessFactor)){C+="    float roughness = clamp(u_roughnessFactor, 0.04, 1.0);\n"}else{C+="    float roughness = 1.0;\n"}}C+="    vec3 v = -normalize(v_positionEC);\n";C+="    vec3 lightColor = vec3(1.0, 1.0, 1.0);\n";if(d){C+="    vec3 l = normalize(czm_sunDirectionEC);\n"}else{C+="    vec3 l = vec3(0.0, 0.0, 1.0);\n"}C+="    vec3 h = normalize(v + l);\n";if(d){C+="    vec3 r = normalize(czm_inverseViewRotation * normalize(reflect(v, n)));\n";C+="    czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n";C+="    float vertexRadius = length(v_positionWC);\n";C+="    float horizonDotNadir = 1.0 - ellipsoid.radii.x / vertexRadius;\n";C+="    float reflectionDotNadir = dot(r, normalize(v_positionWC));\n";C+="    r.x = -r.x;\n";C+="    r = -normalize(czm_temeToPseudoFixed * r);\n";C+="    r.x = -r.x;\n"}else{C+="    vec3 r = normalize(reflect(v, n));\n"}C+="    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n";C+="    float NdotV = abs(dot(n, v)) + 0.001;\n";C+="    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n";C+="    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n";C+="    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n";C+="    vec3 f0 = vec3(0.04);\n";C+="    float alpha = roughness * roughness;\n";C+="    vec3 diffuseColor = baseColor * (1.0 - metalness);\n";C+="    vec3 specularColor = mix(f0, baseColor, metalness);\n";C+="    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n";C+="    vec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\n";C+="    vec3 r0 = specularColor.rgb;\n";C+="    vec3 F = fresnelSchlick2(r0, r90, VdotH);\n";C+="    float G = smithVisibilityGGX(alpha, NdotL, NdotV);\n";C+="    float D = GGX(alpha, NdotH);\n";C+="    vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(baseColor);\n";C+="    vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);\n";C+="    vec3 color = NdotL * lightColor * (diffuseContribution + specularContribution);\n";if(d){C+="    float inverseRoughness = 1.0 - roughness;\n";C+="    inverseRoughness *= inverseRoughness;\n";C+="    vec3 sceneSkyBox = textureCube(czm_environmentMap, r).rgb * inverseRoughness;\n";C+="    float atmosphereHeight = 0.05;\n";C+="    float blendRegionSize = 0.1 * ((1.0 - inverseRoughness) * 8.0 + 1.1 - horizonDotNadir);\n";C+="    float farAboveHorizon = clamp(horizonDotNadir - blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);\n";C+="    float aroundHorizon = clamp(horizonDotNadir + blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);\n";C+="    float farBelowHorizon = clamp(horizonDotNadir + blendRegionSize * 1.5, 1.0e-10 - blendRegionSize, 0.99999);\n";C+="    float smoothstepHeight = smoothstep(0.0, atmosphereHeight, horizonDotNadir);\n";C+="    float lightScale = smoothstepHeight * 1.5 + 1.0;\n";C+="    vec3 diffuseIrradiance = mix(vec3(0.5), vec3(0.05), smoothstepHeight);\n";C+="    vec3 belowHorizonColor = mix(vec3(0.1, 0.2, 0.4), vec3(0.2, 0.5, 0.7), smoothstepHeight);\n";C+="    vec3 nadirColor = belowHorizonColor * 0.5;\n";C+="    vec3 aboveHorizonColor = vec3(0.8, 0.9, 0.95);\n";C+="    vec3 blueSkyColor = mix(vec3(0.09, 0.13, 0.24), aboveHorizonColor, reflectionDotNadir * inverseRoughness * 0.5 + 0.5);\n";C+="    vec3 zenithColor = mix(blueSkyColor, sceneSkyBox, smoothstepHeight);\n";C+="    vec3 specularIrradiance = mix(zenithColor, aboveHorizonColor, smoothstep(farAboveHorizon, aroundHorizon, reflectionDotNadir) * inverseRoughness);\n";C+="    specularIrradiance = mix(specularIrradiance, belowHorizonColor, smoothstep(aroundHorizon, farBelowHorizon, reflectionDotNadir) * inverseRoughness);\n";C+="    specularIrradiance = mix(specularIrradiance, nadirColor, smoothstep(farBelowHorizon, 1.0, reflectionDotNadir) * inverseRoughness);\n";C+="    vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, 1.0 - roughness)).rg;\n";C+="    vec3 IBLColor = (diffuseIrradiance * diffuseColor) + (specularIrradiance * (specularColor * brdfLut.x + brdfLut.y));\n";C+="    color = color * lightScale + IBLColor;\n"}if(s(y.occlusionTexture)){C+="    color *= texture2D(u_occlusionTexture, "+Z+").r;\n"}if(s(y.emissiveTexture)){C+="    vec3 emissive = texture2D(u_emissiveTexture, "+Z+").rgb;\n";if(s(y.emissiveFactor)){C+="    emissive *= u_emissiveFactor;\n"}C+="    color += emissive;\n"}else{if(s(y.emissiveFactor)){C+="    color += u_emissiveFactor;\n"}}var $=o.alphaMode;if(s($)){if($==="MASK"){var ee=o.alphaCutoff;if(s(ee)){C+="    gl_FragColor = vec4(color, int(baseColorWithAlpha.a >= "+ee+"));\n"}else{C+="    gl_FragColor = vec4(color, 1.0);\n"}}else if($==="BLEND"){C+="    gl_FragColor = vec4(color, baseColorWithAlpha.a);\n"}else{C+="    gl_FragColor = vec4(color, 1.0);\n"}}else{C+="    gl_FragColor = vec4(color, 1.0);\n"}C+="}\n";var te;if(s($)&&$!=="OPAQUE"){te={enable:[u.DEPTH_TEST,u.BLEND],functions:{depthMask:[false],blendEquationSeparate:[u.FUNC_ADD,u.FUNC_ADD],blendFuncSeparate:[u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA]}}}else if(y.doubleSided){te={enable:[u.DEPTH_TEST]}}else{te={enable:[u.CULL_FACE,u.DEPTH_TEST]}}var re=e(g,{type:u.VERTEX_SHADER,extras:{_pipeline:{source:w,extension:".glsl"}}});var ie=e(g,{type:u.FRAGMENT_SHADER,extras:{_pipeline:{source:C,extension:".glsl"}}});var ne=Object.keys(j);var ae=e(_,{attributes:ne,fragmentShader:ie,vertexShader:re});var oe=e(v,{attributes:j,parameters:M,program:ae,states:te,uniforms:k});return oe}function f(e,t){var r;switch(e){case"baseColorFactor":return u.FLOAT_VEC4;case"metallicFactor":return u.FLOAT;case"roughnessFactor":return u.FLOAT;case"baseColorTexture":return u.SAMPLER_2D;case"metallicRoughnessTexture":return u.SAMPLER_2D;case"normalTexture":return u.SAMPLER_2D;case"occlusionTexture":return u.SAMPLER_2D;case"emissiveTexture":return u.SAMPLER_2D;case"emissiveFactor":return u.FLOAT_VEC3;case"doubleSided":return u.BOOL}}function h(e){if(e==="SCALAR"){return"float"}return e.toLowerCase()}function p(e,t){var r=e.accessors;var n=e.materials;var a=e.techniques;var o=e.programs;var l=e.shaders;var u=t.targets;var c=t.attributes;for(var d in u){if(s(d)){var f=u[d];for(var p in f){if(p!=="extras"){c[p+"_"+d]=f[p]}}}}var m=n[t.material];var v=a[m.technique];var g=o[v.program];var _=l[g.vertexShader];for(var y in c){if(c.hasOwnProperty(y)){if(!s(i(v,y))){var b=c[y];var w=r[b];if(y.charAt(0)==="_"){y=y.slice(1)}var C="a_"+y;v.parameters[y]={semantic:y,type:w.componentType};v.attributes[C]=y;g.attributes.push(C);var S=_.extras._pipeline;var T=S.source;T="attribute "+h(w.type)+" "+C+";\n"+T;S.source=T}}}}function m(e){t.mesh(e,function(r){t.meshPrimitive(r,function(t){p(e,t)})})}function v(r){var i=r.accessors;var n=r.materials;t.mesh(r,function(r){t.meshPrimitive(r,function(t){var r=t.material;var a=n[r];var l=t.attributes.JOINTS_0;var u;var c;if(s(l)){var d=i[l];u=d.componentType;c=d.type}var f=s(l);var h=a.extras._pipeline.skinning;if(!s(h)){a.extras._pipeline.skinning={skinned:f,componentType:u,type:c}}else if(h.skinned!==f||h.type!==c){var p=o(a,true);p.material.extras._pipeline.skinning={skinned:f,componentType:u,type:c};r=e(n,p);t.material=r}})})}return c});define("ThirdParty/GltfPipeline/removePipelineExtras",["../../Core/defined"],function(e){"use strict";function t(r){if(e(r)&&typeof r==="object"){if(e(r.extras)&&e(r.extras._pipeline)){delete r.extras._pipeline;if(Object.keys(r.extras).length===0){delete r.extras}}for(var i in r){if(r.hasOwnProperty(i)){t(r[i])}}}return r}return t});define("Scene/AttributeType",["../Core/freezeObject"],function(e){"use strict";var t={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"};return e(t)});define("Scene/Axis",["../Core/Check","../Core/freezeObject","../Core/Math","../Core/Matrix3","../Core/Matrix4"],function(e,t,r,i,n){"use strict";var a={X:0,Y:1,Z:2,Y_UP_TO_Z_UP:n.fromRotationTranslation(i.fromRotationX(r.PI_OVER_TWO)),Z_UP_TO_Y_UP:n.fromRotationTranslation(i.fromRotationX(-r.PI_OVER_TWO)),X_UP_TO_Z_UP:n.fromRotationTranslation(i.fromRotationY(-r.PI_OVER_TWO)),Z_UP_TO_X_UP:n.fromRotationTranslation(i.fromRotationY(r.PI_OVER_TWO)),X_UP_TO_Y_UP:n.fromRotationTranslation(i.fromRotationZ(r.PI_OVER_TWO)),Y_UP_TO_X_UP:n.fromRotationTranslation(i.fromRotationZ(-r.PI_OVER_TWO)),fromName:function(t){e.typeOf.string("name",t);return a[t]}};return t(a)});define("Scene/getAttributeOrUniformBySemantic",["../Core/defined"],function(e){"use strict";function t(t,r){var i=t.techniques;var n;for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];var s=o.parameters;var l=o.attributes;var u=o.uniforms;for(var c in l){if(l.hasOwnProperty(c)){n=s[l[c]];if(e(n)&&n.semantic===r){return c}}}for(var d in u){if(u.hasOwnProperty(d)){n=s[u[d]];if(e(n)&&n.semantic===r){return d}}}}}return undefined}return t});define("Scene/JobType",["../Core/freezeObject"],function(e){"use strict";var t={TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3};return e(t)});define("Scene/ModelAnimationCache",["./AttributeType","../Core/Cartesian3","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/LinearSpline","../Core/Matrix4","../Core/Quaternion","../Core/QuaternionSpline","../Core/WebGLConstants","../Core/WeightSpline","../ThirdParty/GltfPipeline/getAccessorByteStride","../ThirdParty/GltfPipeline/numberOfComponentsForType"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";function h(){}var p=/^data\:/i;function m(e,t){var r=e.gltf;var i=r.buffers;var n=r.bufferViews;var a=n[t.bufferView];var o=i[a.buffer];var s=a.byteOffset+t.byteOffset;var l=t.count*f(t.type);var u=p.test(o.uri)?"":o.uri;return e.cacheKey+"//"+u+"/"+s+"/"+l}var v={};h.getAnimationParameterValues=function(e,a){var o=m(e,a);var l=v[o];if(!n(l)){var u=e.gltf;var c=u.buffers;var h=u.bufferViews;var p=h[a.bufferView];var g=p.buffer;var _=c[g];var y=_.extras._pipeline.source;var b=a.componentType;var w=a.type;var C=f(w);var S=a.count;var T=d(u,a);l=new Array(S);var E=i(a.byteOffset,0);var x=p.byteOffset+E;for(var P=0;P<S;P++){var A=r.createArrayBufferView(b,y.buffer,x,C);if(w==="SCALAR"){l[P]=A[0]}else if(w==="VEC3"){l[P]=t.fromArray(A)}else if(w==="VEC4"){l[P]=s.unpack(A)}x+=T}if(n(e.cacheKey)){v[o]=l}}return l};var g={};function _(e,t,r){return e.cacheKey+"//"+t+"/"+r}function y(e){this._value=e}y.prototype.evaluate=function(e,t){return this._value};h.getAnimationSpline=function(e,t,r,i,o,s,u,d){var f=_(e,t,i);var h=g[f];if(!n(h)){var p=s;var m=d;if(p.length===1&&m.length===1){h=new y(m[0])}else if(o.interpolation==="LINEAR"){if(u==="translation"||u==="scale"){h=new a({times:p,points:m})}else if(u==="rotation"){h=new l({times:p,points:m})}else if(u==="weights"){h=new c({times:p,weights:m})}}if(n(e.cacheKey)){g[f]=h}}return h};var b={};h.getSkinInverseBindMatrices=function(t,i){var a=m(t,i);var s=b[a];if(!n(s)){var l=t.gltf;var c=l.buffers;var h=l.bufferViews;var p=i.bufferView;var v=h[p];var g=v.buffer;var _=c[g];var y=_.extras._pipeline.source;var w=i.componentType;var C=i.type;var S=i.count;var T=d(l,i);var E=v.byteOffset+i.byteOffset;var x=f(C);s=new Array(S);if(w===u.FLOAT&&C===e.MAT4){for(var P=0;P<S;++P){var A=r.createArrayBufferView(w,y.buffer,E,x);s[P]=o.fromArray(A);E+=T}}b[a]=s}return s};return h});define("Scene/ModelAnimationLoop",["../Core/freezeObject"],function(e){"use strict";var t={NONE:0,REPEAT:1,MIRRORED_REPEAT:2};return e(t)});define("Scene/ModelAnimationState",["../Core/freezeObject"],function(e){"use strict";return e({STOPPED:0,ANIMATING:1})});define("Scene/ModelAnimation",["../Core/defaultValue","../Core/defineProperties","../Core/Event","../Core/JulianDate","./ModelAnimationLoop","./ModelAnimationState"],function(e,t,r,i,n,a){"use strict";function o(t,o,s){this._name=t.name;this._startTime=i.clone(t.startTime);this._delay=e(t.delay,0);this._stopTime=t.stopTime;this.removeOnStop=e(t.removeOnStop,false);this._speedup=e(t.speedup,1);this._reverse=e(t.reverse,false);this._loop=e(t.loop,n.NONE);this.start=new r;this.update=new r;this.stop=new r;this._state=a.STOPPED;this._runtimeAnimation=s;this._computedStartTime=undefined;this._duration=undefined;var l=this;this._raiseStartEvent=function(){l.start.raiseEvent(o,l)};this._updateEventTime=0;this._raiseUpdateEvent=function(){l.update.raiseEvent(o,l,l._updateEventTime)};this._raiseStopEvent=function(){l.stop.raiseEvent(o,l)}}t(o.prototype,{name:{get:function(){return this._name}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},speedup:{get:function(){return this._speedup}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}}});return o});define("Scene/ModelAnimationCollection",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","../Core/Math","./ModelAnimation","./ModelAnimationLoop","./ModelAnimationState"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";function d(e){this.animationAdded=new a;this.animationRemoved=new a;this._model=e;this._scheduledAnimations=[];this._previousTime=undefined}i(d.prototype,{length:{get:function(){return this._scheduledAnimations.length}}});d.prototype.add=function(e){e=t(e,t.EMPTY_OBJECT);var i=this._model;var a=i._runtime.animations;if(!r(a)){throw new n("Animations are not loaded.  Wait for Model.readyPromise to resolve.")}var o=a[e.name];if(!r(o)){throw new n("options.name must be a valid animation name.")}if(r(e.speedup)&&e.speedup<=0){throw new n("options.speedup must be greater than zero.")}var s=new l(e,i,o);this._scheduledAnimations.push(s);this.animationAdded.raiseEvent(i,s);return s};d.prototype.addAll=function(i){i=t(i,t.EMPTY_OBJECT);if(!r(this._model._runtime.animations)){throw new n("Animations are not loaded.  Wait for Model.readyPromise to resolve.")}if(r(i.speedup)&&i.speedup<=0){throw new n("options.speedup must be greater than zero.")}i=e(i);var a=[];var o=this._model._animationIds;var s=o.length;for(var l=0;l<s;++l){i.name=o[l];a.push(this.add(i))}return a};d.prototype.remove=function(e){if(r(e)){var t=this._scheduledAnimations;var i=t.indexOf(e);if(i!==-1){t.splice(i,1);this.animationRemoved.raiseEvent(this._model,e);return true}}return false};d.prototype.removeAll=function(){var e=this._model;var t=this._scheduledAnimations;var r=t.length;this._scheduledAnimations=[];for(var i=0;i<r;++i){this.animationRemoved.raiseEvent(e,t[i])}};d.prototype.contains=function(e){if(r(e)){return this._scheduledAnimations.indexOf(e)!==-1}return false};d.prototype.get=function(e){if(!r(e)){throw new n("index is required.")}return this._scheduledAnimations[e]};function f(e,t){var r=e.channelEvaluators;var i=r.length;for(var n=0;n<i;++n){r[n](t)}}var h=[];function p(e,t,r){return function(){e.animationRemoved.raiseEvent(t,r)}}d.prototype.update=function(e){var i=this._scheduledAnimations;var n=i.length;if(n===0){this._previousTime=undefined;return false}if(o.equals(e.time,this._previousTime)){return false}this._previousTime=o.clone(e.time,this._previousTime);var a=false;var l=e.time;var d=this._model;for(var m=0;m<n;++m){var v=i[m];var g=v._runtimeAnimation;if(!r(v._computedStartTime)){v._computedStartTime=o.addSeconds(t(v.startTime,l),v.delay,new o)}if(!r(v._duration)){v._duration=g.stopTime*(1/v.speedup)}var _=v._computedStartTime;var y=v._duration;var b=v.stopTime;var w=y!==0?o.secondsDifference(l,_)/y:0;var C=w>=0;var S=v.loop===u.REPEAT||v.loop===u.MIRRORED_REPEAT;var T=(C||S&&!r(v.startTime))&&(w<=1||S)&&(!r(b)||o.lessThanOrEquals(l,b));if(T){if(v._state===c.STOPPED){v._state=c.ANIMATING;if(v.start.numberOfListeners>0){e.afterRender.push(v._raiseStartEvent)}}if(v.loop===u.REPEAT){w=w-Math.floor(w)}else if(v.loop===u.MIRRORED_REPEAT){var E=Math.floor(w);var x=w-E;w=E%2===1?1-x:x}if(v.reverse){w=1-w}var P=w*y*v.speedup;P=s.clamp(P,g.startTime,g.stopTime);f(g,P);if(v.update.numberOfListeners>0){v._updateEventTime=P;e.afterRender.push(v._raiseUpdateEvent)}a=true}else if(C&&v._state===c.ANIMATING){v._state=c.STOPPED;if(v.stop.numberOfListeners>0){e.afterRender.push(v._raiseStopEvent)}if(v.removeOnStop){h.push(v)}}}n=h.length;for(var A=0;A<n;++A){var O=h[A];i.splice(i.indexOf(O),1);e.afterRender.push(p(this,d,O))}h.length=0;return a};return d});define("Scene/ModelMaterial",["../Core/defined","../Core/defineProperties","../Core/DeveloperError"],function(e,t,r){"use strict";function i(e,t,r){this._name=t.name;this._id=r;this._uniformMap=e._uniformMaps[r]}t(i.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}}});i.prototype.setValue=function(t,i){if(!e(t)){throw new r("name is required.")}var n=this._uniformMap.values[t];if(!e(n)){throw new r("name must match a parameter name in the material's technique that is targetable and not optimized out.")}n.value=n.clone(i,n.value)};i.prototype.getValue=function(t){if(!e(t)){throw new r("name is required.")}var i=this._uniformMap.values[t];if(!e(i)){return undefined}return i.value};return i});define("Scene/ModelMesh",["../Core/defineProperties"],function(e){"use strict";function t(e,t,r){var i=[];var n=e.primitives;var a=n.length;for(var o=0;o<a;++o){var s=n[o];i[o]=t[s.material]}this._name=e.name;this._materials=i;this._id=r}e(t.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},materials:{get:function(){return this._materials}}});return t});define("Scene/ModelNode",["../Core/defineProperties","../Core/Matrix4"],function(e,t){"use strict";function r(e,r,i,n,a){this._model=e;this._runtimeNode=i;this._name=r.name;this._id=n;this.useMatrix=false;this._show=true;this._matrix=t.clone(a)}e(r.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},show:{get:function(){return this._show},set:function(e){if(this._show!==e){this._show=e;this._model._perNodeShowDirty=true}}},matrix:{get:function(){return this._matrix},set:function(e){this._matrix=t.clone(e,this._matrix);this.useMatrix=true;var r=this._model;r._cesiumAnimationsDirty=true;this._runtimeNode.dirtyNumber=r._maxDirtyNumber}}});r.prototype.setMatrix=function(e){t.clone(e,this._matrix)};return r});define("Scene/Model",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/FeatureDetection","../Core/getAbsoluteUri","../Core/getBaseUri","../Core/getMagic","../Core/getStringFromTypedArray","../Core/IndexDatatype","../Core/joinUrls","../Core/loadArrayBuffer","../Core/loadCRN","../Core/loadImage","../Core/loadImageFromTypedArray","../Core/loadKTX","../Core/loadText","../Core/Math","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/PixelFormat","../Core/PrimitiveType","../Core/Quaternion","../Core/Queue","../Core/RuntimeError","../Core/Transforms","../Core/WebGLConstants","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/VertexArray","../ThirdParty/GltfPipeline/addDefaults","../ThirdParty/GltfPipeline/addPipelineExtras","../ThirdParty/GltfPipeline/ForEach","../ThirdParty/GltfPipeline/getAccessorByteStride","../ThirdParty/GltfPipeline/numberOfComponentsForType","../ThirdParty/GltfPipeline/parseBinaryGltf","../ThirdParty/GltfPipeline/processModelMaterialsCommon","../ThirdParty/GltfPipeline/processPbrMetallicRoughness","../ThirdParty/GltfPipeline/removePipelineExtras","../ThirdParty/GltfPipeline/updateVersion","../ThirdParty/Uri","../ThirdParty/when","./AttributeType","./Axis","./BlendingState","./ColorBlendMode","./getAttributeOrUniformBySemantic","./HeightReference","./JobType","./ModelAnimationCache","./ModelAnimationCollection","./ModelMaterial","./ModelMesh","./ModelNode","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U,V,z,q,G,H,j,W,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,ae,oe,se,le,ue,ce,de,fe,he,pe,me,ve,ge,_e,ye,be,we){"use strict";if(!p.supportsTypedArrays()){return{}}var Ce=new r;var Se={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};var Te="model/gltf-binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01";function Ee(){this.vertexBuffersToCreate=new L;this.indexBuffersToCreate=new L;this.buffers={};this.pendingBufferLoads=0;this.programsToCreate=new L;this.shaders={};this.pendingShaderLoads=0;this.texturesToCreate=new L;this.pendingTextureLoads=0;this.texturesToCreateFromBufferView=new L;this.pendingBufferViewToImage=0;this.createSamplers=true;this.createSkins=true;this.createRuntimeAnimations=true;this.createVertexArrays=true;this.createRenderStates=true;this.createUniformMaps=true;this.createRuntimeNodes=true;this.skinnedNodesIds=[]}Ee.prototype.getBuffer=function(e){return Me(this.buffers[e.buffer],e.byteOffset,e.byteLength)};Ee.prototype.finishedPendingBufferLoads=function(){return this.pendingBufferLoads===0};Ee.prototype.finishedBuffersCreation=function(){return this.pendingBufferLoads===0&&this.vertexBuffersToCreate.length===0&&this.indexBuffersToCreate.length===0};Ee.prototype.finishedProgramCreation=function(){return this.pendingShaderLoads===0&&this.programsToCreate.length===0};Ee.prototype.finishedTextureCreation=function(){var e=this.pendingTextureLoads===0;var t=this.texturesToCreate.length===0&&this.texturesToCreateFromBufferView.length===0;return e&&t};Ee.prototype.finishedEverythingButTextureCreation=function(){var e=this.pendingBufferLoads===0&&this.pendingShaderLoads===0;var t=this.vertexBuffersToCreate.length===0&&this.indexBuffersToCreate.length===0&&this.programsToCreate.length===0&&this.pendingBufferViewToImage===0;return e&&t};Ee.prototype.finished=function(){return this.finishedTextureCreation()&&this.finishedEverythingButTextureCreation()};function xe(e,t){e._cachedGltf=t}function Pe(e){this._gltf=e.gltf;this.ready=e.ready;this.modelsToLoad=[];this.count=0}c(Pe.prototype,{gltf:{set:function(e){this._gltf=e},get:function(){return this._gltf}}});Pe.prototype.makeReady=function(e){this.gltf=e;var t=this.modelsToLoad;var r=t.length;for(var i=0;i<r;++i){var n=t[i];if(!n.isDestroyed()){xe(n,this)}}this.modelsToLoad=undefined;this.ready=true};function Ae(e){var t=[];if(u(e)){var r=e.animations;for(var i in r){if(r.hasOwnProperty(i)){t.push(i)}}}return t}var Oe={};function De(t){t=l(t,l.EMPTY_OBJECT);var r=t.cacheKey;this._cacheKey=r;this._cachedGltf=undefined;this._releaseGltfJson=l(t.releaseGltfJson,false);this._animationIds=undefined;var i;if(u(r)&&u(Oe[r])&&Oe[r].ready){i=Oe[r];++i.count}else{var n=t.gltf;if(u(n)){if(n instanceof ArrayBuffer){n=new Uint8Array(n)}if(n instanceof Uint8Array){var a=te(n);i=new Pe({gltf:a,ready:true})}else{i=new Pe({gltf:t.gltf,ready:true})}i.count=1;if(u(r)){Oe[r]=i}}}xe(this,i);this._basePath=l(t.basePath,"");var s=v(document.location.href);this._baseUri=b(s,this._basePath);this.show=l(t.show,true);this.silhouetteColor=l(t.silhouetteColor,o.RED);this._silhouetteColor=new o;this._silhouetteColorPreviousAlpha=1;this._normalAttributeName=undefined;this.silhouetteSize=l(t.silhouetteSize,0);this.modelMatrix=D.clone(l(t.modelMatrix,D.IDENTITY));this._modelMatrix=D.clone(this.modelMatrix);this._clampedModelMatrix=undefined;this.scale=l(t.scale,1);this._scale=this.scale;this.minimumPixelSize=l(t.minimumPixelSize,0);this._minimumPixelSize=this.minimumPixelSize;this.maximumScale=t.maximumScale;this._maximumScale=this.maximumScale;this.id=t.id;this._id=t.id;this.heightReference=l(t.heightReference,he.NONE);this._heightReference=this.heightReference;this._heightChanged=false;this._removeUpdateHeightCallback=undefined;var c=t.scene;this._scene=c;if(u(c)&&u(c.terrainProviderChanged)){this._terrainProviderChangedCallback=c.terrainProviderChanged.addEventListener(function(){this._heightChanged=true},this)}this._pickObject=t.pickObject;this._allowPicking=l(t.allowPicking,true);this._ready=false;this._readyPromise=se.defer();this.activeAnimations=new ve(this);this._defaultTexture=undefined;this._incrementallyLoadTextures=l(t.incrementallyLoadTextures,true);this._asynchronous=l(t.asynchronous,true);this.shadows=l(t.shadows,we.ENABLED);this._shadows=this.shadows;this.color=l(t.color,o.WHITE);this._color=new o;this._colorPreviousAlpha=1;this.colorBlendMode=l(t.colorBlendMode,de.HIGHLIGHT);this.colorBlendAmount=l(t.colorBlendAmount,.5);this.debugShowBoundingVolume=l(t.debugShowBoundingVolume,false);this._debugShowBoundingVolume=false;this.debugWireframe=l(t.debugWireframe,false);this._debugWireframe=false;this._distanceDisplayCondition=t.distanceDisplayCondition;this._addBatchIdToGeneratedShaders=t.addBatchIdToGeneratedShaders;this._precreatedAttributes=t.precreatedAttributes;this._vertexShaderLoaded=t.vertexShaderLoaded;this._fragmentShaderLoaded=t.fragmentShaderLoaded;this._uniformMapLoaded=t.uniformMapLoaded;this._pickVertexShaderLoaded=t.pickVertexShaderLoaded;this._pickFragmentShaderLoaded=t.pickFragmentShaderLoaded;this._pickUniformMapLoaded=t.pickUniformMapLoaded;this._ignoreCommands=l(t.ignoreCommands,false);this._requestType=t.requestType;this._upAxis=l(t.upAxis,ue.Y);this.cull=l(t.cull,true);this.opaquePass=l(t.opaquePass,z.OPAQUE);this._computedModelMatrix=new D;this._initialRadius=undefined;this._boundingSphere=undefined;this._scaledBoundingSphere=new e;this._state=Se.NEEDS_LOAD;this._loadResources=undefined;this._mode=undefined;this._perNodeShowDirty=false;this._cesiumAnimationsDirty=false;this._dirty=false;this._maxDirtyNumber=0;this._runtime={animations:undefined,rootNodes:undefined,nodes:undefined,nodesByName:undefined,skinnedNodes:undefined,meshesByName:undefined,materialsByName:undefined,materialsById:undefined};this._uniformMaps={};this._extensionsUsed=undefined;this._extensionsRequired=undefined;this._quantizedUniforms={};this._programPrimitives={};this._rendererResources={buffers:{},vertexArrays:{},programs:{},pickPrograms:{},silhouettePrograms:{},textures:{},samplers:{},renderStates:{}};this._cachedRendererResources=undefined;this._loadRendererResourcesFromCache=false;this._updatedGltfVersion=false;this._cachedGeometryByteLength=0;this._cachedTexturesByteLength=0;this._geometryByteLength=0;this._texturesByteLength=0;this._trianglesLength=0;this._nodeCommands=[];this._pickIds=[];this._rtcCenter=undefined;this._rtcCenterEye=undefined;this._rtcCenter3D=undefined;this._rtcCenter2D=undefined}c(De.prototype,{gltf:{get:function(){return u(this._cachedGltf)?this._cachedGltf.gltf:undefined}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return this._basePath}},boundingSphere:{get:function(){if(this._state!==Se.LOADED){throw new f("The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.")}var e=this.modelMatrix;if(this.heightReference!==he.NONE&&this._clampedModelMatrix){e=this._clampedModelMatrix}var t=D.getScale(e,Ce);var i=u(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;r.multiplyByScalar(t,i,t);var n=this._scaledBoundingSphere;n.center=r.multiplyComponents(this._boundingSphere.center,t,n.center);n.radius=r.maximumComponent(t)*this._initialRadius;if(u(this._rtcCenter)){r.add(this._rtcCenter,n.center,n.center)}return n}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return u(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(u(e)&&e.far<=e.near){throw new f("far must be greater than near")}this._distanceDisplayCondition=h.clone(e,this._distanceDisplayCondition)}},extensionsUsed:{get:function(){if(!u(this._extensionsUsed)){this._extensionsUsed=nt(this)}return this._extensionsUsed}},extensionsRequired:{get:function(){if(!u(this._extensionsRequired)){this._extensionsRequired=at(this)}return this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return this._texturesByteLength}},cachedGeometryByteLength:{get:function(){return this._cachedGeometryByteLength}},cachedTexturesByteLength:{get:function(){return this._cachedTexturesByteLength}}});function Ie(e){return e.stencilBuffer}De.silhouetteSupported=function(e){return Ie(e.context)};function Me(e,t,r){return e.subarray(t,t+r)}function Re(e){var t=g(e);return t==="glTF"}De.fromGltf=function(e){if(!u(e)||!u(e.url)){throw new f("options.url is required")}var t=e.url;var r=l(e.cacheKey,m(t));var i=l(e.basePath,v(t,true));e=a(e);if(u(e.basePath)&&!u(e.cacheKey)){r+=i}e.cacheKey=r;e.basePath=i;var n=new De(e);e.headers=u(e.headers)?a(e.headers):{};if(!u(e.headers.Accept)){e.headers.Accept=Te}var o=Oe[r];if(!u(o)){o=new Pe({ready:false});o.count=1;o.modelsToLoad.push(n);xe(n,o);Oe[r]=o;w(t,e.headers).then(function(e){var t=new Uint8Array(e);if(Re(t)){var r=te(t);o.makeReady(r,t)}else{var i=_(t);o.makeReady(JSON.parse(i))}}).otherwise(Ue(n,"model",t))}else if(!o.ready){++o.count;o.modelsToLoad.push(n)}return n};De._gltfCache=Oe;function Le(e,t,r){if(e._state!==Se.LOADED){throw new f("The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.")}if(!u(r)){throw new f("name is required.")}return e._runtime[t][r]}De.prototype.getNode=function(e){var t=Le(this,"nodesByName",e);return u(t)?t.publicNode:undefined};De.prototype.getMesh=function(e){return Le(this,"meshesByName",e)};De.prototype.getMaterial=function(e){return Le(this,"materialsByName",e)};var Ne=new r;var ke=new r;function Fe(e,t){var r=e.accessors[t];var i=r.extensions;var n=r.min;var a=r.max;if(u(i)){var o=i.WEB3D_quantized_attributes;if(u(o)){n=o.decodedMin;a=o.decodedMax}}return{min:n,max:a}}function Be(t){var i=t.gltf;var n=i.nodes;var a=i.meshes;var o=i.scenes[i.scene].nodes;var s=o.length;var l=[];var c=new r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);var d=new r(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var f=0;f<s;++f){var h=n[o[f]];h._transformToRoot=et(h);l.push(h);while(l.length>0){h=l.pop();var p=h._transformToRoot;var m=h.mesh;if(u(m)){var v=a[m];var g=v.primitives;var _=g.length;for(var y=0;y<_;++y){var b=g[y].attributes.POSITION;if(u(b)){var w=Fe(i,b);var C=r.fromArray(w.min,0,Ne);var S=r.fromArray(w.max,0,ke);if(u(c)&&u(d)){D.multiplyByPoint(p,C,C);D.multiplyByPoint(p,S,S);r.minimumByComponent(c,C,c);r.maximumByComponent(d,S,d)}}}}var T=h.children;var E=T.length;for(var x=0;x<E;++x){var P=n[T[x]];P._transformToRoot=et(P);D.multiplyTransformation(p,P._transformToRoot,P._transformToRoot);l.push(P)}delete h._transformToRoot}}var A=e.fromCornerPoints(c,d);if(t._upAxis===ue.Y){e.transformWithoutScale(A,ue.Y_UP_TO_Z_UP,A)}else if(t._upAxis===ue.X){e.transformWithoutScale(A,ue.X_UP_TO_Z_UP,A)}return A}function Ue(e,t,r){return function(){e._state=Se.FAILED;e._readyPromise.reject(new N("Failed to load "+t+": "+r))}}function Ve(e){var t=e.gltf;var r=e._loadResources;J.buffer(t,function(e,t){r.buffers[t]=e.extras._pipeline.source})}function ze(e,t){return function(r){var i=e._loadResources;var n=new Uint8Array(r);--i.pendingBufferLoads;e.gltf.buffers[t].extras._pipeline.source=n}}function qe(e){var t=e._loadResources;var r=e.gltf.buffers;for(var i in r){if(r.hasOwnProperty(i)){var n=r[i];n.extras=l(n.extras,{});n.extras._pipeline=l(n.extras._pipeline,{});if(u(n.extras._pipeline.source)){t.buffers[i]=n.extras._pipeline.source}else{var a=b(e._baseUri,n.uri);++t.pendingBufferLoads;w(a).then(ze(e,i)).otherwise(Ue(e,"buffer",a))}}}}function Ge(e){var t=e.gltf.bufferViews;var r=e._loadResources.vertexBuffersToCreate;J.bufferView(e.gltf,function(e,t){if(e.target===F.ARRAY_BUFFER){r.enqueue(t)}});var i=e._loadResources.indexBuffersToCreate;var n={};J.accessor(e.gltf,function(e){var r=e.bufferView;var a=t[r];if(a.target===F.ELEMENT_ARRAY_BUFFER&&!u(n[r])){n[r]=true;i.enqueue({id:r,componentType:e.componentType})}})}function He(e,t,r){return function(i){var n=e._loadResources;n.shaders[r]={source:i,type:t,bufferView:undefined};--n.pendingShaderLoads;e.gltf.shaders[r].extras._pipeline.source=i}}function je(e){var t=e.gltf;var r=t.buffers;var i=t.bufferViews;J.shader(t,function(t,n){if(u(t.bufferView)){var a=t.bufferView;var o=i[a];var s=o.buffer;var l=r[s];var c=_(l.extras._pipeline.source,o.byteOffset,o.byteLength);e._loadResources.shaders[n]={source:c,bufferView:undefined};t.extras._pipeline.source=c}else if(u(t.extras._pipeline.source)){e._loadResources.shaders[n]={source:t.extras._pipeline.source,bufferView:undefined}}else{++e._loadResources.pendingShaderLoads;var d=b(e._baseUri,t.uri);x(d).then(He(e,t.type,n)).otherwise(Ue(e,"shader",d))}})}function We(e){J.program(e.gltf,function(t,r){e._loadResources.programsToCreate.enqueue(r)})}function Ye(e,t,r){return function(i){var n=e.gltf;var a=e._loadResources;--a.pendingTextureLoads;a.texturesToCreate.enqueue({id:t,image:i,bufferView:i.bufferView,width:i.width,height:i.height,internalFormat:i.internalFormat});n.images[r].extras._pipeline.source=i}}var Xe=/(^data:image\/ktx)|(\.ktx$)/i;var Qe=/(^data:image\/crn)|(\.crn$)/i;function Ze(e,t){var r=e.gltf;var i=r.images;var n;J.texture(r,function(r,a){var o=r.source;var s=i[o];var l=s.extras;var c=s.bufferView;var d=s.mimeType;n=s.uri;if(u(l)&&u(l.compressedImage3DTiles)){var f=l.compressedImage3DTiles.crunch;var h=l.compressedImage3DTiles.s3tc;var p=l.compressedImage3DTiles.pvrtc1;var m=l.compressedImage3DTiles.etc1;if(t.s3tc&&u(f)){d=f.mimeType;if(u(f.bufferView)){c=f.bufferView}else{n=f.uri}}else if(t.s3tc&&u(h)){d=h.mimeType;if(u(h.bufferView)){c=h.bufferView}else{n=h.uri}}else if(t.pvrtc&&u(p)){d=p.mimeType;if(u(p.bufferView)){c=p.bufferView}else{n=p.uri}}else if(t.etc1&&u(m)){d=m.mimeType;if(u(m.bufferView)){c=m.bufferView}else{n=m.uri}}}if(u(c)){e._loadResources.texturesToCreateFromBufferView.enqueue({id:a,image:undefined,bufferView:c,mimeType:d})}else{++e._loadResources.pendingTextureLoads;n=new oe(n);var v=b(e._baseUri,n);var g;if(Xe.test(v)){g=E(v)}else if(Qe.test(v)){g=C(v)}else{g=S(v)}g.then(Ye(e,a,o)).otherwise(Ue(e,"image",v))}})}var Ke=new r;var Je=new R;var $e=new r;function et(e){if(u(e.matrix)){return D.fromArray(e.matrix)}return D.fromTranslationQuaternionRotationScale(r.fromArray(e.translation,0,Ke),R.unpack(e.rotation,0,Je),r.fromArray(e.scale,0,$e))}function tt(e){var t={};var r={};var i=[];var n=e._loadResources.skinnedNodesIds;J.node(e.gltf,function(a,o){var s={matrix:undefined,translation:undefined,rotation:undefined,scale:undefined,computedShow:true,transformToRoot:new D,computedMatrix:new D,dirtyNumber:0,commands:[],inverseBindMatrices:undefined,bindShapeMatrix:undefined,joints:[],computedJointMatrices:[],jointName:a.jointName,weights:[],children:[],parents:[],publicNode:undefined};s.publicNode=new ye(e,a,s,o,et(a));t[o]=s;r[a.name]=s;if(u(a.skin)){n.push(o);i.push(s)}});e._runtime.nodes=t;e._runtime.nodesByName=r;e._runtime.skinnedNodes=i}function rt(e){var t={};var r={};var i=e._uniformMaps;J.material(e.gltf,function(n,a){i[a]={uniformMap:undefined,values:undefined,jointMatrixUniformName:undefined,morphWeightsUniformName:undefined};var o=new ge(e,n,a);t[n.name]=o;r[a]=o});e._runtime.materialsByName=t;e._runtime.materialsById=r}function it(e){var t={};var r=e._runtime.materialsById;J.mesh(e.gltf,function(i,n){t[i.name]=new _e(i,r,n);if(u(e.extensionsUsed.WEB3D_quantized_attributes)){var a=i.primitives;var o=a.length;for(var s=0;s<o;s++){var l=a[s];var c=mt(e,l);var d=e._programPrimitives[c];if(!u(d)){d=[];e._programPrimitives[c]=d}d.push(l)}}});e._runtime.meshesByName=t}function nt(e){var t=e.gltf.extensionsUsed;var r={};if(u(t)){var i=t.length;for(var n=0;n<i;n++){var a=t[n];r[a]=true}}return r}function at(e){var t=e.gltf.extensionsRequired;var r={};if(u(t)){var i=t.length;for(var n=0;n<i;n++){var a=t[n];r[a]=true}}return r}var ot=function(){this.id=undefined;this.model=undefined;this.context=undefined};ot.prototype.set=function(e,t,r){this.id=e;this.model=t;this.context=r};ot.prototype.execute=function(){st(this.id,this.model,this.context)};function st(e,t,r){var i=t._loadResources;var n=t.gltf.bufferViews;var a=n[e];var o=B.createVertexBuffer({context:r,typedArray:i.getBuffer(a),usage:U.STATIC_DRAW});o.vertexArrayDestroyable=false;t._rendererResources.buffers[e]=o;t._geometryByteLength+=o.sizeInBytes}var lt=function(){this.id=undefined;this.componentType=undefined;this.model=undefined;this.context=undefined};lt.prototype.set=function(e,t,r,i){this.id=e;this.componentType=t;this.model=r;this.context=i};lt.prototype.execute=function(){ut(this.id,this.componentType,this.model,this.context)};function ut(e,t,r,i){var n=r._loadResources;var a=r.gltf.bufferViews;var o=a[e];var s=B.createIndexBuffer({context:i,typedArray:n.getBuffer(o),usage:U.STATIC_DRAW,indexDatatype:t});s.vertexArrayDestroyable=false;r._rendererResources.buffers[e]=s;r._geometryByteLength+=s.sizeInBytes}var ct=new ot;var dt=new lt;function ft(e,t){var r=e._loadResources;if(r.pendingBufferLoads!==0){return}var i=t.context;var n=r.vertexBuffersToCreate;var a=r.indexBuffersToCreate;var o;if(e.asynchronous){while(n.length>0){ct.set(n.peek(),e,i);if(!t.jobScheduler.execute(ct,pe.BUFFER)){break}n.dequeue()}while(a.length>0){o=a.peek();dt.set(o.id,o.componentType,e,i);if(!t.jobScheduler.execute(dt,pe.BUFFER)){break}a.dequeue()}}else{while(n.length>0){st(n.dequeue(),e,i)}while(a.length>0){o=a.dequeue();ut(o.id,o.componentType,e,i)}}}function ht(e,t){var r={};var i=t.length;var n;for(n=1;n<i;++n){var a=t[n];if(/pos/i.test(a)){t[n]=t[0];t[0]=a;break}}for(n=0;n<i;++n){r[t[n]]=n}return r}function pt(e,t,r){var i=e.indexOf(t);return e.replace(new RegExp(t,"g"),function(e,t,n){return i===t?e:r})}function mt(e,t){var r=e.gltf;var i=t.material;var n=r.materials[i];var a=n.technique;var o=r.techniques[a];return o.program}function vt(e,t){var r=e.gltf;var i=r.accessors[t];var n=i.extensions;if(u(n)){return n.WEB3D_quantized_attributes}return undefined}function gt(e,t,r){var i=e.gltf;var n=t.material;var a=i.materials[n];var o=a.technique;var s=i.techniques[o];for(var l in s.parameters){if(s.parameters.hasOwnProperty(l)){var u=s.parameters[l].semantic;if(u===r){var c=s.attributes;for(var d in c){if(c.hasOwnProperty(d)){var f=c[d];if(f===l){return d}}}}}}return undefined}function _t(e,t,r,i){var n={};r._quantizedUniforms[t]=n;var a=r._programPrimitives[t];for(var o=0;o<a.length;o++){var s=a[o];if(mt(r,s)===t){for(var l in s.attributes){if(s.attributes.hasOwnProperty(l)){var c=gt(r,s,l);var d=s.attributes[l];if(l.charAt(0)==="_"){l=l.substring(1)}var f="gltf_u_dec_"+l.toLowerCase();var h=f+"_scale";var p=f+"_translate";if(!u(n[f])&&!u(n[h])){var m=vt(r,d);if(u(m)){var v=m.decodeMatrix;var g="gltf_decoded_"+l;var _=c.replace("a_","gltf_a_dec_");var y=Math.floor(Math.sqrt(v.length));e=pt(e,c,_);var b;if(y>2){b="vec"+(y-1)}else{b="float"}e=b+" "+_+";\n"+e;var w="";if(y===5){e="uniform mat4 "+h+";\n"+e;e="uniform vec4 "+p+";\n"+e;w="\n"+"void main() {\n"+"    "+_+" = "+h+" * "+c+" + "+p+";\n"+"    "+g+"();\n"+"}\n";n[h]={mat:4};n[p]={vec:4}}else{e="uniform mat"+y+" "+f+";\n"+e;w="\n"+"void main() {\n"+"    "+_+" = "+b+"("+f+" * vec"+y+"("+c+",1.0));\n"+"    "+g+"();\n"+"}\n";n[f]={mat:y}}e=j.replaceMain(e,g);e+=w}}}}}}r._programPrimitives[t]=undefined;return e}function yt(e){var t=e.gltf;return u(t.asset)?l(t.asset.premultipliedAlpha,false):false}function bt(e,t){e=j.replaceMain(e,"gltf_blend_main");e+="uniform vec4 gltf_color; \n"+"uniform float gltf_colorBlend; \n"+"void main() \n"+"{ \n"+"    gltf_blend_main(); \n";if(t){e+="    float alpha = 1.0 - ceil(gl_FragColor.a) + gl_FragColor.a; \n"+"    gl_FragColor.rgb /= alpha; \n"}e+="    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); \n"+"    float highlight = ceil(gltf_colorBlend); \n"+"    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); \n"+"    gl_FragColor.a *= gltf_color.a; \n"+"} \n";return e}function wt(e,t,r){if(u(r)){e=r(e,t)}return e}var Ct=function(){this.id=undefined;this.model=undefined;this.context=undefined};Ct.prototype.set=function(e,t,r){this.id=e;this.model=t;this.context=r};Ct.prototype.execute=function(){St(this.id,this.model,this.context)};function St(e,t,r){var i=t.gltf.programs;var n=t.gltf.shaders;var a=i[e];var o=ht(t,a.attributes);var s=n[a.vertexShader].extras._pipeline.source;var l=n[a.fragmentShader].extras._pipeline.source;var c=a.attributes.length;var d=t._precreatedAttributes;if(u(d)){for(var f in d){if(d.hasOwnProperty(f)){o[f]=c++}}}if(t.extensionsUsed.WEB3D_quantized_attributes){s=_t(s,e,t,r)}var h=yt(t);var p=bt(l,h);var m=wt(s,e,t._vertexShaderLoaded);var v=wt(p,e,t._fragmentShaderLoaded);t._rendererResources.programs[e]=H.fromCache({context:r,vertexShaderSource:m,fragmentShaderSource:v,attributeLocations:o});if(t.allowPicking){var g=wt(s,e,t._pickVertexShaderLoaded);var _=wt(l,e,t._pickFragmentShaderLoaded);if(!t._pickFragmentShaderLoaded){_=j.createPickFragmentShaderSource(l,"uniform")}t._rendererResources.pickPrograms[e]=H.fromCache({context:r,vertexShaderSource:g,fragmentShaderSource:_,attributeLocations:o})}}var Tt=new Ct;function Et(e,t){var r=e._loadResources;var i=r.programsToCreate;if(r.pendingShaderLoads!==0){return}if(r.pendingBufferLoads!==0){return}var n=t.context;if(e.asynchronous){while(i.length>0){Tt.set(i.peek(),e,n);if(!t.jobScheduler.execute(Tt,pe.PROGRAM)){break}i.dequeue()}}else{while(i.length>0){St(i.dequeue(),e,n)}}}function xt(e,t){return function(r){e.texturesToCreate.enqueue({id:t.id,image:r,bufferView:undefined});--e.pendingBufferViewToImage}}function Pt(e){var t=e._loadResources;if(t.pendingBufferLoads!==0){return}while(t.texturesToCreateFromBufferView.length>0){var r=t.texturesToCreateFromBufferView.dequeue();var i=e.gltf;var n=i.bufferViews[r.bufferView];var a=i.textures[r.id].source;var o=Ue(e,"image","id: "+r.id+", bufferView: "+r.bufferView);if(r.mimeType==="image/ktx"){E(t.getBuffer(n)).then(Ye(e,r.id,a)).otherwise(o);++e._loadResources.pendingTextureLoads}else if(r.mimeType==="image/crn"){C(t.getBuffer(n)).then(Ye(e,r.id,a)).otherwise(o);++e._loadResources.pendingTextureLoads}else{var s=xt(t,r);T(t.getBuffer(n),r.mimeType).then(s).otherwise(o);++t.pendingBufferViewToImage}}}function At(e,t){var r=e._loadResources;if(r.createSamplers){r.createSamplers=false;var i=e._rendererResources.samplers;var n=e.gltf.samplers;for(var a in n){if(n.hasOwnProperty(a)){var o=n[a];i[a]=new G({wrapS:o.wrapS,wrapT:o.wrapT,minificationFilter:o.minFilter,magnificationFilter:o.magFilter})}}}}var Ot=function(){this.gltfTexture=undefined;this.model=undefined;this.context=undefined};Ot.prototype.set=function(e,t,r){this.gltfTexture=e;this.model=t;this.context=r};Ot.prototype.execute=function(){Dt(this.gltfTexture,this.model,this.context)};function Dt(e,t,r){var i=t.gltf.textures;var n=i[e.id];var a=t._rendererResources.samplers;var o=a[n.sampler];o=l(o,new G({wrapS:X.REPEAT,wrapT:X.REPEAT}));var s=e.internalFormat;var c=!(u(s)&&I.isCompressedFormat(s))&&(o.minificationFilter===Y.NEAREST_MIPMAP_NEAREST||o.minificationFilter===Y.NEAREST_MIPMAP_LINEAR||o.minificationFilter===Y.LINEAR_MIPMAP_NEAREST||o.minificationFilter===Y.LINEAR_MIPMAP_LINEAR);var d=c||o.wrapS===X.REPEAT||o.wrapS===X.MIRRORED_REPEAT||o.wrapT===X.REPEAT||o.wrapT===X.MIRRORED_REPEAT;var f;var h=e.image;if(u(s)&&n.target===F.TEXTURE_2D){f=new W({context:r,source:{arrayBufferView:e.bufferView},width:e.width,height:e.height,pixelFormat:s,sampler:o})}else if(u(h)){var p=!P.isPowerOfTwo(h.width)||!P.isPowerOfTwo(h.height);if(d&&p){var m=document.createElement("canvas");m.width=P.nextPowerOfTwo(h.width);m.height=P.nextPowerOfTwo(h.height);var v=m.getContext("2d");v.drawImage(h,0,0,h.width,h.height,0,0,m.width,m.height);h=m}if(n.target===F.TEXTURE_2D){f=new W({context:r,source:h,pixelFormat:n.internalFormat,pixelDatatype:n.type,sampler:o,flipY:false})}if(c){f.generateMipmap()}}t._rendererResources.textures[e.id]=f;t._texturesByteLength+=f.sizeInBytes}var It=new Ot;function Mt(e,t){var r=t.context;var i=e._loadResources.texturesToCreate;if(e.asynchronous){while(i.length>0){It.set(i.peek(),e,r);if(!t.jobScheduler.execute(It,pe.TEXTURE)){break}i.dequeue()}}else{while(i.length>0){Dt(i.dequeue(),e,r)}}}function Rt(e,t){var r=e.gltf;var i=r.techniques;var n=r.materials;var a={};var o;var s;var l=i[n[t.material].technique];var c=l.parameters;var d=l.attributes;var f=e._rendererResources.programs[l.program];var h=f.vertexAttributes;var p=f._attributeLocations;for(o in h){if(h.hasOwnProperty(o)){var m=d[o];s=h[o].index;if(u(m)){var v=c[m];a[v.semantic]=s}}}var g=e._precreatedAttributes;if(u(g)){for(o in g){if(g.hasOwnProperty(o)){s=p[o];a[o]=s}}}return a}function Lt(e,t){var r=e.length;var i={};for(var n=0;n<r;++n){var a=[e[n]];while(a.length>0){var o=a.pop();var s=t[o];if(u(s)){i[o]=o}var l=s.children;var c=l.length;for(var d=0;d<c;++d){a.push(l[d])}}}return i}function Nt(e,t){var r=e.gltf;var i=r.skins;var n=r.nodes;var a=e._runtime.nodes;var o=e._loadResources.skinnedNodesIds;var s=o.length;for(var l=0;l<s;++l){var c=o[l];var d=a[c];var f=n[c];var h=t[f.skin];d.inverseBindMatrices=h.inverseBindMatrices;d.bindShapeMatrix=h.bindShapeMatrix;var p=[];var m=i[f.skin];if(u(m.skeleton)){p.push(m.skeleton)}var v=Lt(p,n);var g=i[f.skin].joints;var _=g.length;for(var y=0;y<_;++y){var b=g[y];var w=v[b];var C=a[w];d.joints.push(C)}}}function kt(e){var t=e._loadResources;if(t.pendingBufferLoads!==0){return}if(!t.createSkins){return}t.createSkins=false;var r=e.gltf;var i=r.accessors;var n={};J.skin(r,function(t,r){var a=i[t.inverseBindMatrices];var o;if(!D.equals(t.bindShapeMatrix,D.IDENTITY)){o=D.clone(t.bindShapeMatrix)}n[r]={inverseBindMatrices:me.getSkinInverseBindMatrices(e,a),bindShapeMatrix:o}});Nt(e,n)}function Ft(e,t,r,i){return function(n){if(u(i)){t[r]=i.evaluate(n,t[r]);t.dirtyNumber=e._maxDirtyNumber}}}function Bt(e){var t=e._loadResources;if(!t.finishedPendingBufferLoads()){return}if(!t.createRuntimeAnimations){return}t.createRuntimeAnimations=false;e._runtime.animations={};var r=e._runtime.nodes;var i=e.gltf.animations;var n=e.gltf.accessors;for(var a in i){if(i.hasOwnProperty(a)){var o=i[a];var s=o.channels;var l=o.samplers;var u=Number.MAX_VALUE;var c=-Number.MAX_VALUE;var d=s.length;var f=new Array(d);for(var h=0;h<d;++h){var p=s[h];var m=p.target;var v=m.path;var g=l[p.sampler];var _=me.getAnimationParameterValues(e,n[g.input]);var y=me.getAnimationParameterValues(e,n[g.output]);u=Math.min(u,_[0]);c=Math.max(c,_[_.length-1]);var b=me.getAnimationSpline(e,a,o,p.sampler,g,_,v,y);f[h]=Ft(e,r[m.node],m.path,b)}e._runtime.animations[a]={startTime:u,stopTime:c,channelEvaluators:f}}}}function Ut(e,t){var r=e._loadResources;if(!r.finishedBuffersCreation()||!r.finishedProgramCreation()){return}if(!r.createVertexArrays){return}r.createVertexArrays=false;var i=e._rendererResources.buffers;var n=e._rendererResources.vertexArrays;var a=e.gltf;var o=a.accessors;var s=a.meshes;for(var l in s){if(s.hasOwnProperty(l)){var c=s[l].primitives;var d=c.length;for(var f=0;f<d;++f){var h=c[f];var p=Rt(e,h);var m;var v;var g;var _=[];var y=h.attributes;for(m in y){if(y.hasOwnProperty(m)){v=p[m];if(u(v)){var b=o[y[m]];var w=false;if(u(b.normalized)&&b.normalized){w=true}_.push({index:v,vertexBuffer:i[b.bufferView],componentsPerAttribute:ee(b.type),componentDatatype:b.componentType,normalize:w,offsetInBytes:b.byteOffset,strideInBytes:$(a,b)})}}}var C=e._precreatedAttributes;if(u(C)){for(m in C){if(C.hasOwnProperty(m)){v=p[m];if(u(v)){g=C[m];g.index=v;_.push(g)}}}}var S;if(u(h.indices)){var T=o[h.indices];S=i[T.bufferView]}n[l+".primitive."+f]=new Q({context:t,attributes:_,indexBuffer:S})}}}}function Vt(e){var t={};t[F.BLEND]=false;t[F.CULL_FACE]=false;t[F.DEPTH_TEST]=false;t[F.POLYGON_OFFSET_FILL]=false;var r=e.enable;var i=r.length;var n;for(n=0;n<i;++n){t[r[n]]=true}return t}function zt(e,t){var r=e._loadResources;var i=e.gltf.techniques;if(r.createRenderStates){r.createRenderStates=false;for(var n in i){if(i.hasOwnProperty(n)){qt(e,n,t)}}}}function qt(e,t,r){var i=e._rendererResources.renderStates;var n=e.gltf.techniques;var a=n[t];var o=a.states;var s=Vt(o);var c=l(o.functions,l.EMPTY_OBJECT);var d=l(c.blendColor,[0,0,0,0]);var f=l(c.blendEquationSeparate,[F.FUNC_ADD,F.FUNC_ADD]);var h=l(c.blendFuncSeparate,[F.ONE,F.ZERO,F.ONE,F.ZERO]);var p=l(c.colorMask,[true,true,true,true]);var m=l(c.depthRange,[0,1]);var v=l(c.polygonOffset,[0,0]);if(s[F.BLEND]&&yt(e)){if(h[0]===F.ONE&&h[1]===F.ONE_MINUS_SRC_ALPHA){h[0]=F.SRC_ALPHA;h[1]=F.ONE_MINUS_SRC_ALPHA;h[2]=F.SRC_ALPHA;h[3]=F.ONE_MINUS_SRC_ALPHA}}i[t]=q.fromCache({frontFace:u(c.frontFace)?c.frontFace[0]:F.CCW,cull:{enabled:s[F.CULL_FACE],face:u(c.cullFace)?c.cullFace[0]:F.BACK},lineWidth:u(c.lineWidth)?c.lineWidth[0]:1,polygonOffset:{enabled:s[F.POLYGON_OFFSET_FILL],factor:v[0],units:v[1]},depthRange:{near:m[0],far:m[1]},depthTest:{enabled:s[F.DEPTH_TEST],func:u(c.depthFunc)?c.depthFunc[0]:F.LESS},colorMask:{red:p[0],green:p[1],blue:p[2],alpha:p[3]},depthMask:u(c.depthMask)?c.depthMask[0]:true,blending:{enabled:s[F.BLEND],color:{red:d[0],green:d[1],blue:d[2],alpha:d[3]},equationRgb:f[0],equationAlpha:f[1],functionSourceRgb:h[0],functionDestinationRgb:h[1],functionSourceAlpha:h[2],functionDestinationAlpha:h[3]}})}var Gt=new r;var Ht={MODEL:function(e,t){return function(){return e.model}},VIEW:function(e,t){return function(){return e.view}},PROJECTION:function(e,t){return function(){return e.projection}},MODELVIEW:function(e,t){return function(){return e.modelView}},CESIUM_RTC_MODELVIEW:function(e,t){var i=new D;return function(){if(u(t._rtcCenter)){D.getTranslation(e.model,Gt);r.add(Gt,t._rtcCenter,Gt);D.multiplyByPoint(e.view,Gt,Gt);return D.setTranslation(e.modelView,Gt,i)}return e.modelView}},MODELVIEWPROJECTION:function(e,t){return function(){return e.modelViewProjection}},MODELINVERSE:function(e,t){return function(){return e.inverseModel}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t){return function(){return e.inverseModelView}},MODELVIEWPROJECTIONINVERSE:function(e,t){return function(){return e.inverseModelViewProjection}},MODELINVERSETRANSPOSE:function(e,t){return function(){return e.inverseTransposeModel}},MODELVIEWINVERSETRANSPOSE:function(e,t){return function(){return e.normal}},VIEWPORT:function(e,t){return function(){return e.viewportCartesian4}}};function jt(e,t){var r={value:e,clone:function(e,t){return e},func:function(){return r.value}};return r}function Wt(e,r){var i={value:t.fromArray(e),clone:t.clone,func:function(){return i.value}};return i}function Yt(e,t){var i={value:r.fromArray(e),clone:r.clone,func:function(){return i.value}};return i}function Xt(e,t){var r={value:i.fromArray(e),clone:i.clone,func:function(){return r.value}};return r}function Qt(e,t){var r={value:A.fromColumnMajorArray(e),clone:A.clone,func:function(){return r.value}};return r}function Zt(e,t){var r={value:O.fromColumnMajorArray(e),clone:O.clone,func:function(){return r.value}};return r}function Kt(e,t){var r={value:D.fromColumnMajorArray(e),clone:D.clone,func:function(){return r.value}};return r}function Jt(e,t){this._value=undefined;this._textureId=e.index;this._model=t}c(Jt.prototype,{value:{get:function(){if(!u(this._value)){var e=this._model._rendererResources.textures[this._textureId];if(u(e)){this._value=e}else{return this._model._defaultTexture}}return this._value},set:function(e){this._value=e}}});Jt.prototype.clone=function(e,t){return e};Jt.prototype.func=undefined;function $t(e,t){var r=new Jt(e,t);r.func=function(){return r.value};return r}var er={};er[F.FLOAT]=jt;er[F.FLOAT_VEC2]=Wt;er[F.FLOAT_VEC3]=Yt;er[F.FLOAT_VEC4]=Xt;er[F.INT]=jt;er[F.INT_VEC2]=Wt;er[F.INT_VEC3]=Yt;er[F.INT_VEC4]=Xt;er[F.BOOL]=jt;er[F.BOOL_VEC2]=Wt;er[F.BOOL_VEC3]=Yt;er[F.BOOL_VEC4]=Xt;er[F.FLOAT_MAT2]=Qt;er[F.FLOAT_MAT3]=Zt;er[F.FLOAT_MAT4]=Kt;er[F.SAMPLER_2D]=$t;var tr={MODEL:function(e,t,r){return function(){return r.computedMatrix}},VIEW:function(e,t,r){return function(){return e.view}},PROJECTION:function(e,t,r){return function(){return e.projection}},MODELVIEW:function(e,t,r){var i=new D;return function(){return D.multiplyTransformation(e.view,r.computedMatrix,i)}},CESIUM_RTC_MODELVIEW:function(e,t,r){var i=new D;return function(){D.multiplyTransformation(e.view,r.computedMatrix,i);return D.setTranslation(i,t._rtcCenterEye,i)}},MODELVIEWPROJECTION:function(e,t,r){var i=new D;return function(){D.multiplyTransformation(e.view,r.computedMatrix,i);return D.multiply(e._projection,i,i)}},MODELINVERSE:function(e,t,r){var i=new D;return function(){return D.inverse(r.computedMatrix,i)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,r){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,r){var i=new D;var n=new D;return function(){D.multiplyTransformation(e.view,r.computedMatrix,i);return D.inverse(i,n)}},MODELVIEWPROJECTIONINVERSE:function(e,t,r){var i=new D;var n=new D;return function(){D.multiplyTransformation(e.view,r.computedMatrix,i);D.multiply(e._projection,i,i);return D.inverse(i,n)}},MODELINVERSETRANSPOSE:function(e,t,r){var i=new D;var n=new O;return function(){D.inverse(r.computedMatrix,i);D.getRotation(i,n);return O.transpose(n,n)}},MODELVIEWINVERSETRANSPOSE:function(e,t,r){var i=new D;var n=new D;var a=new O;return function(){D.multiplyTransformation(e.view,r.computedMatrix,i);D.inverse(i,n);D.getRotation(n,a);return O.transpose(a,a)}},VIEWPORT:function(e,t,r){return function(){return e.viewportCartesian4}}};function rr(e,t,r,i){var n=t._runtime.nodes[e];return tr[r](i,t,n)}function ir(e,t){var r=e._loadResources;if(!r.finishedProgramCreation()){return}if(!r.createUniformMaps){return}r.createUniformMaps=false;var i=e.gltf;var n=i.materials;var a=i.techniques;var o=e._uniformMaps;for(var s in n){if(n.hasOwnProperty(s)){var l=n[s];var c;c=l.values;var d=a[l.technique];var f=d.parameters;var h=d.uniforms;var p={};var m={};var v;var g;for(var _ in h){if(h.hasOwnProperty(_)&&_!=="extras"){var y=h[_];var b=f[y];if(u(c[y])){var w=er[b.type](c[y],e);p[_]=w.func;m[y]=w}else if(u(b.node)){p[_]=rr(b.node,e,b.semantic,t.uniformState)}else if(u(b.semantic)){if(b.semantic==="JOINTMATRIX"){v=_}else if(b.semantic==="MORPHWEIGHTS"){g=_}else{p[_]=Ht[b.semantic](t.uniformState,e)}}else if(u(b.value)){var C=er[b.type](b.value,e);p[_]=C.func;m[y]=C}}}var S=o[s];S.uniformMap=p;S.values=m;S.jointMatrixUniformName=v;S.morphWeightsUniformName=g}}}function nr(e){return[e[0],e[1],e[2],e[3],e[5],e[6],e[7],e[8],e[10],e[11],e[12],e[13],e[15],e[16],e[17],e[18]]}function ar(e){return[e[20],e[21],e[22],e[23]]}function or(e,t,r){var i=e.gltf;var n=i.accessors;var a=mt(e,t);var o=e._quantizedUniforms[a];var s={};var l={};for(var c in t.attributes){if(t.attributes.hasOwnProperty(c)){var d=t.attributes[c];var f=n[d];var h=f.extensions;if(c.charAt(0)==="_"){c=c.substring(1)}if(u(h)){var p=h.WEB3D_quantized_attributes;if(u(p)){var m=p.decodeMatrix;var v="gltf_u_dec_"+c.toLowerCase();switch(f.type){case le.SCALAR:l[v]=Qt(m,e).func;s[v]=true;break;case le.VEC2:l[v]=Zt(m,e).func;s[v]=true;break;case le.VEC3:l[v]=Kt(m,e).func;s[v]=true;break;case le.VEC4:var g=v+"_scale";var _=v+"_translate";l[g]=Kt(nr(m),e).func;l[_]=Xt(ar(m),e).func;s[g]=true;s[_]=true;break}}}}}for(var y in o){if(o.hasOwnProperty(y)){if(!s[y]){var b=o[y];if(u(b.mat)){if(b.mat===2){l[y]=Qt(A.IDENTITY,e).func}else if(b.mat===3){l[y]=Zt(O.IDENTITY,e).func}else if(b.mat===4){l[y]=Kt(D.IDENTITY,e).func}}if(u(b.vec)){if(b.vec===4){l[y]=Xt([0,0,0,0],e).func}}}}}return l}function sr(e){return function(){return e}}function lr(e){return function(){return e.computedJointMatrices}}function ur(e){return function(){return e.weights}}function cr(e){return function(){return e.silhouetteColor}}function dr(e){return function(){return e.silhouetteSize}}function fr(e){return function(){return e.color}}function hr(e){return function(){return de.getColorBlend(e.colorBlendMode,e.colorBlendAmount)}}function pr(e,t){switch(e.mode){case M.TRIANGLES:return t/3;case M.TRIANGLE_STRIP:case M.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function mr(t,i,n,a,o){var l=t._nodeCommands;var c=t._pickIds;var d=t.allowPicking;var f=t._runtime.meshesByName;var h=t._rendererResources;var p=h.vertexArrays;var m=h.programs;var v=h.pickPrograms;var g=h.renderStates;var _=t._uniformMaps;var b=t.gltf;var w=b.accessors;var C=b.meshes;var S=b.techniques;var T=b.materials;var E=i.mesh;var x=C[E];var P=x.primitives;var A=P.length;for(var O=0;O<A;++O){var I=P[O];var M=w[I.indices];var R=T[I.material];var L=S[R.technique];var N=L.program;var k;var F=I.attributes.POSITION;if(u(F)){var B=Fe(b,F);k=e.fromCornerPoints(r.fromArray(B.min),r.fromArray(B.max))}var U=p[E+".primitive."+O];var q;var G;if(u(M)){G=M.count;q=M.byteOffset/y.getSizeInBytes(M.componentType)}else{var H=w[I.attributes.POSITION];G=H.count;q=0}t._trianglesLength+=pr(I,G);var j=_[I.material];var W=j.uniformMap;if(u(j.jointMatrixUniformName)){var Y={};Y[j.jointMatrixUniformName]=lr(n);W=s(W,Y)}if(u(j.morphWeightsUniformName)){var X={};X[j.morphWeightsUniformName]=ur(n);W=s(W,X)}W=s(W,{gltf_color:fr(t),gltf_colorBlend:hr(t)});if(u(t._uniformMapLoaded)){W=t._uniformMapLoaded(W,N,n)}if(t.extensionsUsed.WEB3D_quantized_attributes){var Q=or(t,I,a);W=s(W,Q)}var Z=g[R.technique];var K=Z.blending.enabled;var J=t._pickObject;if(!u(J)){J={primitive:t,id:t.id,node:n.publicNode,mesh:f[x.name]}}var $=we.castShadows(t._shadows);var ee=we.receiveShadows(t._shadows);var te=new V({boundingVolume:new e,cull:t.cull,modelMatrix:new D,primitiveType:I.mode,vertexArray:U,count:G,offset:q,shaderProgram:m[L.program],castShadows:$,receiveShadows:ee,uniformMap:W,renderState:Z,owner:J,pass:K?z.TRANSLUCENT:t.opaquePass});var re;if(d){var ie;if(u(t._pickFragmentShaderLoaded)){if(u(t._pickUniformMapLoaded)){ie=t._pickUniformMapLoaded(W)}else{ie=s(W)}}else{var ne=a.createPickId(J);c.push(ne);var ae={czm_pickColor:sr(ne.color)};ie=s(W,ae)}re=new V({boundingVolume:new e,cull:t.cull,modelMatrix:new D,primitiveType:I.mode,vertexArray:U,count:G,offset:q,shaderProgram:v[L.program],uniformMap:ie,renderState:Z,owner:J,pass:K?z.TRANSLUCENT:t.opaquePass})}var oe;var se;if(!o){oe=V.shallowClone(te);oe.boundingVolume=new e;oe.modelMatrix=new D;if(d){se=V.shallowClone(re);se.boundingVolume=new e;se.modelMatrix=new D}}var le={show:true,boundingSphere:k,command:te,pickCommand:re,command2D:oe,pickCommand2D:se,silhouetteModelCommand:undefined,silhouetteModelCommand2D:undefined,silhouetteColorCommand:undefined,silhouetteColorCommand2D:undefined,translucentCommand:undefined,translucentCommand2D:undefined};n.commands.push(le);l.push(le)}}function vr(e,t,i){var n=e._loadResources;if(!n.finishedEverythingButTextureCreation()){return}if(!n.createRuntimeNodes){return}n.createRuntimeNodes=false;var a=[];var o=e._runtime.nodes;var s=e.gltf;var l=s.nodes;var c=s.skins;var d=s.scenes[s.scene];var f=d.nodes;var h=f.length;var p=[];var m={};for(var v=0;v<h;++v){p.push({parentRuntimeNode:undefined,gltfNode:l[f[v]],id:f[v]});var g=[];while(p.length>0){var _=p.pop();m[_.id]=true;var y=_.parentRuntimeNode;var b=_.gltfNode;var w=o[_.id];if(w.parents.length===0){if(u(b.matrix)){w.matrix=D.fromColumnMajorArray(b.matrix)}else{var C=b.rotation;w.translation=r.fromArray(b.translation);w.rotation=R.unpack(C);w.scale=r.fromArray(b.scale)}}if(u(y)){y.children.push(w);w.parents.push(y)}else{a.push(w)}if(u(b.mesh)){mr(e,b,w,t,i)}var S=b.children;var T=S.length;for(var E=0;E<T;E++){var x=S[E];if(!m[x]){p.push({parentRuntimeNode:w,gltfNode:l[x],id:S[E]})}}var P=b.skin;if(u(P)){g.push(c[P].skeleton)}if(p.length===0){for(var A=0;A<g.length;A++){var O=g[A];if(!m[O]){p.push({parentRuntimeNode:undefined,gltfNode:l[O],id:O})}}}}}e._runtime.rootNodes=a;e._runtime.nodes=o}function gr(e){var t=0;for(var r in e){if(e.hasOwnProperty(r)){t+=e[r].sizeInBytes}}return t}function _r(e){var t=0;for(var r in e){if(e.hasOwnProperty(r)){t+=e[r].sizeInBytes}}return t}function yr(e,t){var r=t.context;var i=t.scene3DOnly;Jr(e,r);if(e._loadRendererResourcesFromCache){var n=e._rendererResources;var a=e._cachedRendererResources;n.buffers=a.buffers;n.vertexArrays=a.vertexArrays;n.programs=a.programs;n.pickPrograms=a.pickPrograms;n.silhouettePrograms=a.silhouettePrograms;n.textures=a.textures;n.samplers=a.samplers;n.renderStates=a.renderStates;if(u(e._precreatedAttributes)){Ut(e,r)}e._cachedGeometryByteLength+=gr(a.buffers);e._cachedTexturesByteLength+=_r(a.textures)}else{ft(e,t);Et(e,t);At(e,r);Pt(e);Mt(e,t)}kt(e);Bt(e);if(!e._loadRendererResourcesFromCache){Ut(e,r);zt(e,r)}ir(e,r);vr(e,r,i)}function br(e,t){var r=e.publicNode;var i=r.matrix;if(r.useMatrix&&u(i)){D.clone(i,t)}else if(u(e.matrix)){D.clone(e.matrix,t)}else{D.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t);r.setMatrix(t)}}var wr=[];var Cr=new i;var Sr=new D;function Tr(t,n,a,o){var s=t._maxDirtyNumber;var l=t.allowPicking;var c=t._runtime.rootNodes;var d=c.length;var f=wr;var h=t._computedModelMatrix;if(t._mode!==be.SCENE3D&&!t._ignoreCommands){var p=D.getColumn(h,3,Cr);if(!i.equals(p,i.UNIT_W)){h=k.basisTo2D(o,h,Sr);t._rtcCenter=t._rtcCenter3D}else{var m=t.boundingSphere.center;var v=k.wgs84To2DModelMatrix(o,m,Sr);h=D.multiply(v,h,Sr);if(u(t._rtcCenter)){D.setTranslation(h,i.UNIT_W,h);t._rtcCenter=t._rtcCenter2D}}}for(var g=0;g<d;++g){var _=c[g];br(_,_.transformToRoot);f.push(_);while(f.length>0){_=f.pop();var y=_.transformToRoot;var b=_.commands;if(_.dirtyNumber===s||n||a){var w=D.multiplyTransformation(h,y,_.computedMatrix);var C=b.length;if(C>0){for(var S=0;S<C;++S){var T=b[S];var E=T.command;D.clone(w,E.modelMatrix);e.transform(T.boundingSphere,E.modelMatrix,E.boundingVolume);if(u(t._rtcCenter)){r.add(t._rtcCenter,E.boundingVolume.center,E.boundingVolume.center)}if(l){var x=T.pickCommand;D.clone(E.modelMatrix,x.modelMatrix);e.clone(E.boundingVolume,x.boundingVolume)}E=T.command2D;if(u(E)&&t._mode===be.SCENE2D){D.clone(w,E.modelMatrix);E.modelMatrix[13]-=P.sign(E.modelMatrix[13])*2*P.PI*o.ellipsoid.maximumRadius;e.transform(T.boundingSphere,E.modelMatrix,E.boundingVolume);if(l){var A=T.pickCommand2D;D.clone(E.modelMatrix,A.modelMatrix);e.clone(E.boundingVolume,A.boundingVolume)}}}}}var O=_.children;var I=O.length;for(var M=0;M<I;++M){var R=O[M];R.dirtyNumber=Math.max(R.dirtyNumber,_.dirtyNumber);if(R.dirtyNumber===s||a){br(R,R.transformToRoot);D.multiplyTransformation(y,R.transformToRoot,R.transformToRoot)}f.push(R)}}}++t._maxDirtyNumber}var Er=new D;function xr(e){var t=e._runtime.skinnedNodes;var r=t.length;for(var i=0;i<r;++i){var n=t[i];Er=D.inverseTransformation(n.transformToRoot,Er);var a=n.computedJointMatrices;var o=n.joints;var s=n.bindShapeMatrix;var l=n.inverseBindMatrices;var c=l.length;for(var d=0;d<c;++d){if(!u(a[d])){a[d]=new D}a[d]=D.multiplyTransformation(Er,o[d].transformToRoot,a[d]);a[d]=D.multiplyTransformation(a[d],l[d],a[d]);if(u(s)){a[d]=D.multiplyTransformation(a[d],s,a[d])}}}}function Pr(e){var t=e._runtime.rootNodes;var r=t.length;var i=wr;for(var n=0;n<r;++n){var a=t[n];a.computedShow=a.publicNode.show;i.push(a);while(i.length>0){a=i.pop();var o=a.computedShow;var s=a.commands;var l=s.length;for(var u=0;u<l;++u){s[u].show=o}var c=a.children;var d=c.length;for(var f=0;f<d;++f){var h=c[f];h.computedShow=o&&h.publicNode.show;i.push(h)}}}}function Ar(e,t){var r=e.id;if(e._id!==r){e._id=r;var i=e._pickIds;var n=i.length;for(var a=0;a<n;++a){i[a].object.id=r}}}function Or(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;var t=e.debugWireframe?M.LINES:M.TRIANGLES;var r=e._nodeCommands;var i=r.length;for(var n=0;n<i;++n){r[n].command.primitiveType=t}}}function Dr(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;var t=e.debugShowBoundingVolume;var r=e._nodeCommands;var i=r.length;for(var n=0;n<i;++n){r[n].command.debugShowBoundingVolume=t}}}function Ir(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;var t=we.castShadows(e.shadows);var r=we.receiveShadows(e.shadows);var i=e._nodeCommands;var n=i.length;for(var a=0;a<n;a++){var o=i[a];o.command.castShadows=t;o.command.receiveShadows=r}}}function Mr(e){var t=a(e,true);t.cull.enabled=false;t.depthTest.enabled=true;t.depthMask=false;t.blending=ce.ALPHA_BLEND;return q.fromCache(t)}function Rr(e){var t=V.shallowClone(e);t.pass=z.TRANSLUCENT;t.renderState=Mr(e.renderState);return t}function Lr(e,t){var r=t.scene3DOnly;var i=e.color.alpha;if(i>0&&i<1){var n=e._nodeCommands;var a=n.length;if(!u(n[0].translucentCommand)){for(var o=0;o<a;++o){var s=n[o];var l=s.command;s.translucentCommand=Rr(l);if(!r){var c=s.command2D;s.translucentCommand2D=Rr(c)}}}}}function Nr(e,t){var r=e._rendererResources.programs;for(var i in r){if(r.hasOwnProperty(i)){if(r[i]===t){return i}}}}function kr(e,t,r){var i=t.vertexShaderSource.sources[0];var n=t._attributeLocations;var a=e._normalAttributeName;i=j.replaceMain(i,"gltf_silhouette_main");i+="uniform float gltf_silhouetteSize; \n"+"void main() \n"+"{ \n"+"    gltf_silhouette_main(); \n"+"    vec3 n = normalize(czm_normal3D * "+a+"); \n"+"    n.x *= czm_projection[0][0]; \n"+"    n.y *= czm_projection[1][1]; \n"+"    vec4 clip = gl_Position; \n"+"    clip.xy += n.xy * clip.w * gltf_silhouetteSize / czm_viewport.z; \n"+"    gl_Position = clip; \n"+"}";var o="uniform vec4 gltf_silhouetteColor; \n"+"void main() \n"+"{ \n"+"    gl_FragColor = gltf_silhouetteColor; \n"+"}";return H.fromCache({context:r.context,vertexShaderSource:i,fragmentShaderSource:o,attributeLocations:n})}function Fr(e,t){return Ie(t.context)&&e.silhouetteSize>0&&e.silhouetteColor.alpha>0&&u(e._normalAttributeName)}function Br(e){var t=e._nodeCommands;var r=t.length;for(var i=0;i<r;++i){var n=t[i];var a=n.command;if(a.pass===z.TRANSLUCENT){return true}}return false}function Ur(e){return e.color.alpha>0&&e.color.alpha<1}function Vr(e){return e.color.alpha===0}function zr(e,t){return Math.floor(e)!==Math.floor(t)||Math.ceil(e)!==Math.ceil(t)}var qr=0;function Gr(e,t){var r=++qr%255;var i=Br(e)||Ur(e)||e.silhouetteColor.alpha<1;var n=e._rendererResources.silhouettePrograms;var o=t.scene3DOnly;var l=e._nodeCommands;var c=l.length;for(var d=0;d<c;++d){var f=l[d];var h=f.command;var p=Ur(e)?f.translucentCommand:h;var m=V.shallowClone(p);var v=a(p.renderState);v.stencilTest={enabled:true,frontFunction:F.ALWAYS,backFunction:F.ALWAYS,reference:r,mask:~0,frontOperation:{fail:F.KEEP,zFail:F.KEEP,zPass:F.REPLACE},backOperation:{fail:F.KEEP,zFail:F.KEEP,zPass:F.REPLACE}};if(Vr(e)){v.colorMask={red:false,green:false,blue:false,alpha:false};v.depthMask=false}v=q.fromCache(v);m.renderState=v;f.silhouetteModelCommand=m;var g=V.shallowClone(h);v=a(h.renderState,true);v.depthTest.enabled=true;v.cull.enabled=false;if(i){g.pass=z.TRANSLUCENT;v.depthMask=false;v.blending=ce.ALPHA_BLEND}v.stencilTest={enabled:true,frontFunction:F.NOTEQUAL,backFunction:F.NOTEQUAL,reference:r,mask:~0,frontOperation:{fail:F.KEEP,zFail:F.KEEP,zPass:F.KEEP},backOperation:{fail:F.KEEP,zFail:F.KEEP,zPass:F.KEEP}};v=q.fromCache(v);var _=h.shaderProgram;var y=Nr(e,_);var b=n[y];if(!u(b)){b=kr(e,_,t);n[y]=b}var w=s(h.uniformMap,{gltf_silhouetteColor:cr(e),gltf_silhouetteSize:dr(e)});g.renderState=v;g.shaderProgram=b;g.uniformMap=w;g.castShadows=false;g.receiveShadows=false;f.silhouetteColorCommand=g;if(!o){var C=f.command2D;var S=V.shallowClone(m);S.boundingVolume=C.boundingVolume;S.modelMatrix=C.modelMatrix;f.silhouetteModelCommand2D=S;var T=V.shallowClone(g);S.boundingVolume=C.boundingVolume;S.modelMatrix=C.modelMatrix;f.silhouetteColorCommand2D=T}}}function Hr(e,t){if(!Fr(e,t)){return}var r=e._nodeCommands;var i=zr(e.color.alpha,e._colorPreviousAlpha)||zr(e.silhouetteColor.alpha,e._silhouetteColorPreviousAlpha)||!u(r[0].silhouetteModelCommand);e._colorPreviousAlpha=e.color.alpha;e._silhouetteColorPreviousAlpha=e.silhouetteColor.alpha;if(i){Gr(e,t)}}var jr=new e;function Wr(e,t,r){jr.center=e;jr.radius=t;return r.camera.getPixelSize(jr,r.context.drawingBufferWidth,r.context.drawingBufferHeight)}var Yr=new r;var Xr=new n;function Qr(e,t){var i=e.scale;if(e.minimumPixelSize!==0){var n=t.context;var a=Math.max(n.drawingBufferWidth,n.drawingBufferHeight);var o=u(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;Yr.x=o[12];Yr.y=o[13];Yr.z=o[14];if(u(e._rtcCenter)){r.add(e._rtcCenter,Yr,Yr)}if(e._mode!==be.SCENE3D){var s=t.mapProjection;var l=s.ellipsoid.cartesianToCartographic(Yr,Xr);s.project(l,Yr);r.fromElements(Yr.z,Yr.x,Yr.y,Yr)}var c=e.boundingSphere.radius;var d=Wr(Yr,c,t);var f=1/d;var h=Math.min(f*(2*c),a);if(h<e.minimumPixelSize){i=e.minimumPixelSize*d/(2*e._initialRadius)}}return u(e.maximumScale)?Math.min(e.maximumScale,i):i}function Zr(e){if(u(e._cacheKey)&&u(e._cachedGltf)&&--e._cachedGltf.count===0){delete Oe[e._cacheKey]}e._cachedGltf=undefined}function Kr(e){var t=e.extensionsRequired;for(var r in t){if(t.hasOwnProperty(r)){if(r!=="CESIUM_RTC"&&r!=="KHR_technique_webgl"&&r!=="KHR_binary_glTF"&&r!=="KHR_materials_common"&&r!=="WEB3D_quantized_attributes"){throw new N("Unsupported glTF Extension: "+r)}}}}function Jr(e,t){var r=e.gltf.glExtensionsUsed;if(u(r)){var i=r.length;for(var n=0;n<i;n++){var a=r[n];if(a!=="OES_element_index_uint"){throw new N("Unsupported WebGL Extension: "+a)}else if(!t.elementIndexUint){throw new N("OES_element_index_uint WebGL extension is not enabled.")}}}}function $r(e,t){this.buffers=undefined;this.vertexArrays=undefined;this.programs=undefined;this.pickPrograms=undefined;this.silhouettePrograms=undefined;this.textures=undefined;this.samplers=undefined;this.renderStates=undefined;this.ready=false;this.context=e;this.cacheKey=t;this.count=0}function ei(e){for(var t in e){if(e.hasOwnProperty(t)){e[t].destroy()}}}function ti(e){ei(e.buffers);ei(e.vertexArrays);ei(e.programs);ei(e.pickPrograms);ei(e.silhouettePrograms);ei(e.textures)}$r.prototype.release=function(){if(--this.count===0){if(u(this.cacheKey)){delete this.context.cache.modelRendererResourceCache[this.cacheKey]}ti(this);return d(this)}return undefined};function ri(e,t,r){return function(i){if(e.heightReference===he.RELATIVE_TO_GROUND){var n=t.cartesianToCartographic(i,Xr);n.height+=r.height;t.cartographicToCartesian(n,i)}var a=e._clampedModelMatrix;D.clone(e.modelMatrix,a);a[12]=i.x;a[13]=i.y;a[14]=i.z;e._heightChanged=true}}function ii(e){if(u(e._removeUpdateHeightCallback)){e._removeUpdateHeightCallback();e._removeUpdateHeightCallback=undefined}var t=e._scene;if(!u(t)||e.heightReference===he.NONE){if(e.heightReference!==he.NONE){throw new f("Height reference is not supported without a scene.")}e._clampedModelMatrix=undefined;return}var r=t.globe;var i=r.ellipsoid;var a=e.modelMatrix;Yr.x=a[12];Yr.y=a[13];Yr.z=a[14];var o=i.cartesianToCartographic(Yr);if(!u(e._clampedModelMatrix)){e._clampedModelMatrix=D.clone(a,new D)}var s=r._surface;e._removeUpdateHeightCallback=s.updateHeight(o,ri(e,i,o));var l=r.getHeight(o);if(u(l)){var c=ri(e,i,o);n.clone(o,Xr);Xr.height=l;i.cartographicToCartesian(Xr,Yr);c(Yr)}}var ni=new r;var ai=new n;function oi(e,t){var i;var n=e.distanceDisplayCondition;var a=n.near*n.near;var o=n.far*n.far;if(t.mode===be.SCENE2D){var s=t.camera.frustum.right-t.camera.frustum.left;i=s*.5;i=i*i}else{var l=D.getTranslation(e.modelMatrix,ni);if(t.mode===be.COLUMBUS_VIEW){var u=t.mapProjection;var c=u.ellipsoid;var d=c.cartesianToCartographic(l,ai);l=u.project(d,l);r.fromElements(l.z,l.x,l.y,l)}i=r.distanceSquared(l,t.camera.positionWC)}return i>=a&&i<=o}De.prototype.update=function(e){if(e.mode===be.MORPHING){return}var t=e.context;this._defaultTexture=t.defaultTexture;if(this._state===Se.NEEDS_LOAD&&u(this.gltf)){var i;var n=this.cacheKey;if(u(n)){t.cache.modelRendererResourceCache=l(t.cache.modelRendererResourceCache,{});var a=t.cache.modelRendererResourceCache;i=a[this.cacheKey];if(u(i)){if(!i.ready){return}++i.count;this._loadRendererResourcesFromCache=true}else{i=new $r(t,n);i.count=1;a[this.cacheKey]=i}this._cachedRendererResources=i}else{i=new $r(t);i.count=1;this._cachedRendererResources=i}this._state=Se.LOADING;if(this._state!==Se.FAILED){var o=this.gltf.extensions;if(u(o)&&u(o.CESIUM_RTC)){var s=r.fromArray(o.CESIUM_RTC.center);if(!r.equals(s,r.ZERO)){this._rtcCenter3D=s;var c=e.mapProjection;var d=c.ellipsoid;var f=d.cartesianToCartographic(this._rtcCenter3D);var h=c.project(f);r.fromElements(h.z,h.x,h.y,h);this._rtcCenter2D=h;this._rtcCenterEye=new r;this._rtcCenter=this._rtcCenter3D}}this._loadResources=new Ee;if(!this._loadRendererResourcesFromCache){qe(this)}}}var p=this._loadResources;var m=this._incrementallyLoadTextures;var v=false;if(this._state===Se.LOADING){if(p.pendingBufferLoads===0){if(!this._updatedGltfVersion){var g={optimizeForCesium:true,addBatchIdToGeneratedShaders:this._addBatchIdToGeneratedShaders};e.brdfLutGenerator.update(e);ae(this.gltf);Kr(this);K(this.gltf);Z(this.gltf);re(this.gltf,g);ie(this.gltf,g);Ve(this);this._animationIds=Ae(this.gltf);if(!this._loadRendererResourcesFromCache){Ge(this);je(this);We(this);Ze(this,t)}rt(this);it(this);tt(this);this._boundingSphere=Be(this);this._initialRadius=this._boundingSphere.radius;this._updatedGltfVersion=true}if(this._updatedGltfVersion&&p.pendingShaderLoads===0){yr(this,e)}}if(p.finished()||m&&p.finishedEverythingButTextureCreation()){this._state=Se.LOADED;v=true}}if(u(p)&&this._state===Se.LOADED){if(m&&!v){yr(this,e)}if(p.finished()){this._loadResources=undefined;var _=this._rendererResources;var y=this._cachedRendererResources;y.buffers=_.buffers;y.vertexArrays=_.vertexArrays;y.programs=_.programs;y.pickPrograms=_.pickPrograms;y.silhouettePrograms=_.silhouettePrograms;y.textures=_.textures;y.samplers=_.samplers;y.renderStates=_.renderStates;y.ready=true;this._normalAttributeName=fe(this.gltf,"NORMAL");if(u(this._precreatedAttributes)){y.vertexArrays={}}if(this.releaseGltfJson){Zr(this)}}}var b=Fr(this,e);var w=Ur(this);var C=Vr(this);var S=u(this.distanceDisplayCondition)?oi(this,e):true;var T=this.show&&S&&this.scale!==0&&(!C||b);if(T&&this._state===Se.LOADED||v){var E=this.activeAnimations.update(e)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=false;this._dirty=false;var x=this.modelMatrix;var A=e.mode!==this._mode;this._mode=e.mode;var O=!D.equals(this._modelMatrix,x)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||this.minimumPixelSize!==0||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||A;if(O||v){D.clone(x,this._modelMatrix);ii(this);if(u(this._clampedModelMatrix)){x=this._clampedModelMatrix}this._scale=this.scale;this._minimumPixelSize=this.minimumPixelSize;this._maximumScale=this.maximumScale;this._heightReference=this.heightReference;this._heightChanged=false;var I=Qr(this,e);var M=this._computedModelMatrix;D.multiplyByUniformScale(x,I,M);if(this._upAxis===ue.Y){D.multiplyTransformation(M,ue.Y_UP_TO_Z_UP,M)}else if(this._upAxis===ue.X){D.multiplyTransformation(M,ue.X_UP_TO_Z_UP,M)}}if(E||O||v){Tr(this,O,v,e.mapProjection);this._dirty=true;if(E||v){xr(this)}}if(this._perNodeShowDirty){this._perNodeShowDirty=false;Pr(this)}Ar(this,t);Or(this);Dr(this);Ir(this);Lr(this,e);Hr(this,e)}if(v){var R=this;e.afterRender.push(function(){R._ready=true;R._readyPromise.resolve(R)});return}if(T&&!this._ignoreCommands){var L=e.commandList;var N=e.passes;var k=this._nodeCommands;var F=k.length;var B;var U;var V=e.mapProjection.ellipsoid.maximumRadius*P.PI;var z;if(N.render){for(B=0;B<F;++B){U=k[B];if(U.show){var q=w?U.translucentCommand:U.command;q=b?U.silhouetteModelCommand:q;L.push(q);z=U.command.boundingVolume;if(e.mode===be.SCENE2D&&(z.center.y+z.radius>V||z.center.y-z.radius<V)){var G=w?U.translucentCommand2D:U.command2D;G=b?U.silhouetteModelCommand2D:G;L.push(G)}}}if(b){for(B=0;B<F;++B){U=k[B];if(U.show){L.push(U.silhouetteColorCommand);z=U.command.boundingVolume;if(e.mode===be.SCENE2D&&(z.center.y+z.radius>V||z.center.y-z.radius<V)){L.push(U.silhouetteColorCommand2D)}}}}}if(N.pick&&this.allowPicking){for(B=0;B<F;++B){U=k[B];if(U.show){var H=U.pickCommand;L.push(H);z=H.boundingVolume;if(e.mode===be.SCENE2D&&(z.center.y+z.radius>V||z.center.y-z.radius<V)){L.push(U.pickCommand2D)}}}}}};De.prototype.isDestroyed=function(){return false};De.prototype.destroy=function(){if(u(this._precreatedAttributes)){ei(this._rendererResources.vertexArrays)}if(u(this._removeUpdateHeightCallback)){this._removeUpdateHeightCallback();this._removeUpdateHeightCallback=undefined}if(u(this._terrainProviderChangedCallback)){this._terrainProviderChangedCallback();this._terrainProviderChangedCallback=undefined}this._rendererResources=undefined;this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release();var e=this._pickIds;var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}Zr(this);return d(this)};return De});define("DataSources/ModelVisualizer",["../Core/AssociativeArray","../Core/BoundingSphere","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Scene/ColorBlendMode","../Scene/HeightReference","../Scene/Model","../Scene/ModelAnimationLoop","../Scene/ShadowMode","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";var p=1;var m=0;var v=true;var g=d.ENABLED;var _=l.NONE;var y=r.RED;var b=0;var w=r.WHITE;var C=s.HIGHLIGHT;var S=.5;var T=new o;var E=new o;function x(t,r){if(!i(t)){throw new a("scene is required.")}if(!i(r)){throw new a("entityCollection is required.")}r.collectionChanged.addEventListener(x.prototype._onCollectionChanged,this);this._scene=t;this._primitives=t.primitives;this._entityCollection=r;this._modelHash={};this._entitiesToVisualize=new e;this._onCollectionChanged(r,r.values,[],[])}x.prototype.update=function(e){if(!i(e)){throw new a("time is required.")}var t=this._entitiesToVisualize.values;var r=this._modelHash;var n=this._primitives;for(var s=0,l=t.length;s<l;s++){var d=t[s];var f=d._model;var x;var P=r[d.id];var A=d.isShowing&&d.isAvailable(e)&&h.getValueOrDefault(f._show,e,true);var D;if(A){D=d.computeModelMatrix(e,T);x=h.getValueOrUndefined(f._uri,e);A=i(D)&&i(x)}if(!A){if(i(P)){P.modelPrimitive.show=false}continue}var I=i(P)?P.modelPrimitive:undefined;if(!i(I)||x!==P.uri){if(i(I)){n.removeAndDestroy(I);delete r[d.id]}I=u.fromGltf({url:x,incrementallyLoadTextures:h.getValueOrDefault(f._incrementallyLoadTextures,e,v),scene:this._scene});I.readyPromise.otherwise(O);I.id=d;n.add(I);P={modelPrimitive:I,uri:x,animationsRunning:false,nodeTransformationsScratch:{},originalNodeMatrixHash:{}};r[d.id]=P}I.show=true;I.scale=h.getValueOrDefault(f._scale,e,p);I.minimumPixelSize=h.getValueOrDefault(f._minimumPixelSize,e,m);I.maximumScale=h.getValueOrUndefined(f._maximumScale,e);I.modelMatrix=o.clone(D,I.modelMatrix);I.shadows=h.getValueOrDefault(f._shadows,e,g);I.heightReference=h.getValueOrDefault(f._heightReference,e,_);I.distanceDisplayCondition=h.getValueOrUndefined(f._distanceDisplayCondition,e);I.silhouetteColor=h.getValueOrDefault(f._silhouetteColor,e,y,I._silhouetteColor);I.silhouetteSize=h.getValueOrDefault(f._silhouetteSize,e,b);I.color=h.getValueOrDefault(f._color,e,w,I._color);I.colorBlendMode=h.getValueOrDefault(f._colorBlendMode,e,C);I.colorBlendAmount=h.getValueOrDefault(f._colorBlendAmount,e,S);if(I.ready){var M=h.getValueOrDefault(f._runAnimations,e,true);if(P.animationsRunning!==M){if(M){I.activeAnimations.addAll({loop:c.REPEAT})}else{I.activeAnimations.removeAll()}P.animationsRunning=M}var R=h.getValueOrUndefined(f._nodeTransformations,e,P.nodeTransformationsScratch);if(i(R)){var L=P.originalNodeMatrixHash;var N=Object.keys(R);for(var k=0,F=N.length;k<F;++k){var B=N[k];var U=R[B];if(!i(U)){continue}var V=I.getNode(B);if(!i(V)){continue}var z=L[B];if(!i(z)){z=V.matrix.clone();L[B]=z}var q=o.fromTranslationRotationScale(U,E);V.matrix=o.multiply(z,q,q)}}}}return true};x.prototype.isDestroyed=function(){return false};x.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(x.prototype._onCollectionChanged,this);var e=this._entitiesToVisualize.values;var t=this._modelHash;var r=this._primitives;for(var i=e.length-1;i>-1;i--){P(this,e[i],t,r)}return n(this)};x.prototype.getBoundingSphere=function(e,r){if(!i(e)){throw new a("entity is required.")}if(!i(r)){throw new a("result is required.")}var n=this._modelHash[e.id];if(!i(n)){return f.FAILED}var o=n.modelPrimitive;if(!i(o)||!o.show){return f.FAILED}if(!o.ready){return f.PENDING}if(o.heightReference===l.NONE){t.transform(o.boundingSphere,o.modelMatrix,r)}else{if(!i(o._clampedModelMatrix)){return f.PENDING}t.transform(o.boundingSphere,o._clampedModelMatrix,r)}return f.DONE};x.prototype._onCollectionChanged=function(e,t,r,n){var a;var o;var s=this._entitiesToVisualize;var l=this._modelHash;var u=this._primitives;for(a=t.length-1;a>-1;a--){o=t[a];if(i(o._model)&&i(o._position)){s.set(o.id,o)}}for(a=n.length-1;a>-1;a--){o=n[a];if(i(o._model)&&i(o._position)){A(o,l);s.set(o.id,o)}else{P(this,o,l,u);s.remove(o.id)}}for(a=r.length-1;a>-1;a--){o=r[a];P(this,o,l,u);s.remove(o.id)}};function P(e,t,r,n){var a=r[t.id];if(i(a)){n.removeAndDestroy(a.modelPrimitive);delete r[t.id]}}function A(e,t){var r=t[e.id];if(i(r)){r.nodeTransformationsScratch={}}}function O(e){console.error(e)}return x});define("Shaders/PolylineCommon",[],function(){"use strict";return"void clipLineSegmentToNearPlane(\n    vec3 p0,\n    vec3 p1,\n    out vec4 positionWC,\n    out bool clipped,\n    out bool culledByNearPlane)\n{\n    culledByNearPlane = false;\n    clipped = false;\n\n    vec3 p1ToP0 = p1 - p0;\n    float magnitude = length(p1ToP0);\n    vec3 direction = normalize(p1ToP0);\n    float endPoint0Distance =  -(czm_currentFrustum.x + p0.z);\n    float denominator = -direction.z;\n\n    if (endPoint0Distance < 0.0 && abs(denominator) < czm_epsilon7)\n    {\n        culledByNearPlane = true;\n    }\n    else if (endPoint0Distance < 0.0 && abs(denominator) > czm_epsilon7)\n    {\n        // t = (-plane distance - dot(plane normal, ray origin)) / dot(plane normal, ray direction)\n        float t = (czm_currentFrustum.x + p0.z) / denominator;\n        if (t < 0.0 || t > magnitude)\n        {\n            culledByNearPlane = true;\n        }\n        else\n        {\n            p0 = p0 + t * direction;\n            clipped = true;\n        }\n    }\n\n    positionWC = czm_eyeToWindowCoordinates(vec4(p0, 1.0));\n}\n\nvec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle) {\n    vec4 endPointWC, p0, p1;\n    bool culledByNearPlane, clipped;\n\n    vec4 positionEC = czm_modelViewRelativeToEye * position;\n    vec4 prevEC = czm_modelViewRelativeToEye * previous;\n    vec4 nextEC = czm_modelViewRelativeToEye * next;\n\n    // Compute the window coordinates of the points.\n    vec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);\n    vec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);\n    vec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);\n\n#ifdef POLYLINE_DASH\n    // Determine the relative screen space direction of the line.\n    vec2 lineDir;\n    if (usePrevious) {\n        lineDir = normalize(positionWindow.xy - previousWindow.xy);\n    }\n    else {\n        lineDir = normalize(nextWindow.xy - positionWindow.xy);\n    }\n    angle = atan(lineDir.x, lineDir.y) - 1.570796327; // precomputed atan(1,0)\n\n    // Quantize the angle so it doesn't change rapidly between segments.\n    angle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;\n#endif\n\n    clipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, p0, clipped, culledByNearPlane);\n    clipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, p1, clipped, culledByNearPlane);\n    clipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, endPointWC, clipped, culledByNearPlane);\n\n    if (culledByNearPlane)\n    {\n        return vec4(0.0, 0.0, 0.0, 1.0);\n    }\n\n    vec2 prevWC = normalize(p0.xy - endPointWC.xy);\n    vec2 nextWC = normalize(p1.xy - endPointWC.xy);\n\n    float expandWidth = width * 0.5;\n    vec2 direction;\n\n    if (czm_equalsEpsilon(previous.xyz - position.xyz, vec3(0.0), czm_epsilon1) || czm_equalsEpsilon(prevWC, -nextWC, czm_epsilon1))\n    {\n        direction = vec2(-nextWC.y, nextWC.x);\n    }\n    else if (czm_equalsEpsilon(next.xyz - position.xyz, vec3(0.0), czm_epsilon1) || clipped)\n    {\n        direction = vec2(prevWC.y, -prevWC.x);\n    }\n    else\n    {\n        vec2 normal = vec2(-nextWC.y, nextWC.x);\n        direction = normalize((nextWC + prevWC) * 0.5);\n        if (dot(direction, normal) < 0.0)\n        {\n            direction = -direction;\n        }\n\n        // The sine of the angle between the two vectors is given by the formula\n        //         |a x b| = |a||b|sin(theta)\n        // which is\n        //     float sinAngle = length(cross(vec3(direction, 0.0), vec3(nextWC, 0.0)));\n        // Because the z components of both vectors are zero, the x and y coordinate will be zero.\n        // Therefore, the sine of the angle is just the z component of the cross product.\n        float sinAngle = abs(direction.x * nextWC.y - direction.y * nextWC.x);\n        expandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);\n    }\n\n    vec2 offset = direction * expandDirection * expandWidth * czm_resolutionScale;\n    return vec4(endPointWC.xy + offset, -endPointWC.z, 1.0);\n}\n"});define("Shaders/PolylineFS",[],function(){"use strict";return"varying vec2 v_st;\n\nvoid main()\n{\n    czm_materialInput materialInput;\n    \n    materialInput.s = v_st.s;\n    materialInput.st = v_st;\n    materialInput.str = vec3(v_st, 0.0);\n    \n    czm_material material = czm_getMaterial(materialInput);\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n"});define("Shaders/PolylineVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 position2DHigh;\nattribute vec3 position2DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 prevPosition2DHigh;\nattribute vec3 prevPosition2DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec3 nextPosition2DHigh;\nattribute vec3 nextPosition2DLow;\nattribute vec4 texCoordExpandAndBatchIndex;\n\nvarying vec2  v_st;\nvarying float v_width;\nvarying vec4  czm_pickColor;\nvarying float v_polylineAngle;\n\nvoid main()\n{\n    float texCoord = texCoordExpandAndBatchIndex.x;\n    float expandDir = texCoordExpandAndBatchIndex.y;\n    bool usePrev = texCoordExpandAndBatchIndex.z < 0.0;\n    float batchTableIndex = texCoordExpandAndBatchIndex.w;\n\n    vec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex);\n    float width = widthAndShow.x + 0.5;\n    float show = widthAndShow.y;\n\n    if (width < 1.0)\n    {\n        show = 0.0;\n    }\n\n    vec4 pickColor = batchTable_getPickColor(batchTableIndex);\n\n    vec4 p, prev, next;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz);\n        prev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz);\n        next = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\n        prev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy);\n        next = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy),\n                czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz),\n                czm_morphTime);\n        prev = czm_columbusViewMorph(\n                czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy),\n                czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz),\n                czm_morphTime);\n        next = czm_columbusViewMorph(\n                czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy),\n                czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz),\n                czm_morphTime);\n    }\n\n    #ifdef DISTANCE_DISPLAY_CONDITION\n        vec3 centerHigh = batchTable_getCenterHigh(batchTableIndex);\n        vec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex);\n        vec3 centerLow = centerLowAndRadius.xyz;\n        float radius = centerLowAndRadius.w;\n        vec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex);\n\n        float lengthSq;\n        if (czm_sceneMode == czm_sceneMode2D)\n        {\n            lengthSq = czm_eyeHeight2D.y;\n        }\n        else\n        {\n            vec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz);\n            lengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius);\n        }\n\n        float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\n        float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\n        if (lengthSq < nearSq || lengthSq > farSq)\n        {\n            show = 0.0;\n        }\n    #endif\n\n    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, v_polylineAngle);\n    gl_Position = czm_viewportOrthographic * positionWC * show;\n\n    v_st = vec2(texCoord, clamp(expandDir, 0.0, 1.0));\n    v_width = width;\n    czm_pickColor = pickColor;\n}\n"});define("Scene/Polyline",["../Core/arrayRemoveDuplicates","../Core/BoundingSphere","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/PolylinePipeline","./Material"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(o,s){o=n(o,n.EMPTY_OBJECT);this._show=n(o.show,true);this._width=n(o.width,1);this._loop=n(o.loop,false);this._distanceDisplayCondition=o.distanceDisplayCondition;this._material=o.material;if(!a(this._material)){this._material=d.fromType(d.ColorType,{color:new i(1,1,1,1)})}var l=o.positions;if(!a(l)){l=[]}this._positions=l;this._actualPositions=e(l,r.equalsEpsilon);if(this._loop&&this._actualPositions.length>2){if(this._actualPositions===this._positions){this._actualPositions=l.slice()}this._actualPositions.push(r.clone(this._actualPositions[0]))}this._length=this._actualPositions.length;this._id=o.id;var f;if(a(s)){f=u.clone(s.modelMatrix)}this._modelMatrix=f;this._segments=c.wrapLongitude(this._actualPositions,f);this._actualLength=undefined;this._propertiesChanged=new Uint32Array(y);this._polylineCollection=s;this._dirty=false;this._pickId=undefined;this._boundingVolume=t.fromPoints(this._actualPositions);this._boundingVolumeWC=t.transform(this._boundingVolume,this._modelMatrix);this._boundingVolume2D=new t}var h=f.POSITION_INDEX=0;var p=f.SHOW_INDEX=1;var m=f.WIDTH_INDEX=2;var v=f.MATERIAL_INDEX=3;var g=f.POSITION_SIZE_INDEX=4;var _=f.DISTANCE_DISPLAY_CONDITION=5;var y=f.NUMBER_OF_PROPERTIES=6;function b(e,t){++e._propertiesChanged[t];var r=e._polylineCollection;if(a(r)){r._updatePolyline(e,t);e._dirty=true}}o(f.prototype,{show:{get:function(){return this._show},set:function(e){if(!a(e)){throw new s("value is required.")}if(e!==this._show){this._show=e;b(this,p)}}},positions:{get:function(){return this._positions},set:function(i){if(!a(i)){throw new s("value is required.")}var n=e(i,r.equalsEpsilon);if(this._loop&&n.length>2){if(n===i){n=i.slice()}n.push(r.clone(n[0]))}if(this._actualPositions.length!==n.length||this._actualPositions.length!==this._length){b(this,g)}this._positions=i;this._actualPositions=n;this._length=n.length;this._boundingVolume=t.fromPoints(this._actualPositions,this._boundingVolume);this._boundingVolumeWC=t.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC);b(this,h);this.update()}},material:{get:function(){return this._material},set:function(e){if(!a(e)){throw new s("material is required.")}if(this._material!==e){this._material=e;b(this,v)}}},width:{get:function(){return this._width},set:function(e){if(!a(e)){throw new s("value is required.")}var t=this._width;if(e!==t){this._width=e;b(this,m)}}},loop:{get:function(){return this._loop},set:function(e){if(!a(e)){throw new s("value is required.")}if(e!==this._loop){var t=this._actualPositions;if(e){if(t.length>2&&!r.equals(t[0],t[t.length-1])){if(t.length===this._positions.length){this._actualPositions=t=this._positions.slice()}t.push(r.clone(t[0]))}}else if(t.length>2&&r.equals(t[0],t[t.length-1])){if(t.length-1===this._positions.length){this._actualPositions=this._positions}else{t.pop()}}this._loop=e;b(this,g)}}},id:{get:function(){return this._id},set:function(e){this._id=e;if(a(this._pickId)){this._pickId.object.id=e}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(a(e)&&e.far<=e.near){throw new s("far distance must be greater than near distance.")}if(!l.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=l.clone(e,this._distanceDisplayCondition);b(this,_)}}}});f.prototype.update=function(){var e=u.IDENTITY;if(a(this._polylineCollection)){e=this._polylineCollection.modelMatrix}var r=this._segments.positions.length;var i=this._segments.lengths;var n=this._propertiesChanged[h]>0||this._propertiesChanged[g]>0;if(!u.equals(e,this._modelMatrix)||n){this._segments=c.wrapLongitude(this._actualPositions,e);this._boundingVolumeWC=t.transform(this._boundingVolume,e,this._boundingVolumeWC)}this._modelMatrix=u.clone(e,this._modelMatrix);if(this._segments.positions.length!==r){b(this,g)}else{var o=i.length;for(var s=0;s<o;++s){if(i[s]!==this._segments.lengths[s]){b(this,g);break}}}};f.prototype.getPickId=function(e){if(!a(this._pickId)){this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})}return this._pickId};f.prototype._clean=function(){this._dirty=false;var e=this._propertiesChanged;for(var t=0;t<y-1;++t){e[t]=0}};f.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy();this._material=this._material&&this._material.destroy();this._polylineCollection=undefined};return f});define("Scene/PolylineCollection",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/IndexDatatype","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/Plane","../Core/RuntimeError","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/PolylineCommon","../Shaders/PolylineFS","../Shaders/PolylineVS","./BatchTable","./BlendingState","./Material","./Polyline","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N){"use strict";var k=L.SHOW_INDEX;var F=L.WIDTH_INDEX;var B=L.POSITION_INDEX;var U=L.MATERIAL_INDEX;var V=L.POSITION_SIZE_INDEX;var z=L.DISTANCE_DISPLAY_CONDITION;var q=L.NUMBER_OF_PROPERTIES;var G={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function H(e){e=s(e,s.EMPTY_OBJECT);this.modelMatrix=v.clone(s(e.modelMatrix,v.IDENTITY));this._modelMatrix=v.clone(v.IDENTITY);this.debugShowBoundingVolume=s(e.debugShowBoundingVolume,false);this._opaqueRS=undefined;this._translucentRS=undefined;this._colorCommands=[];this._pickCommands=[];this._polylinesUpdated=false;this._polylinesRemoved=false;this._createVertexArray=false;this._propertiesChanged=new Uint32Array(q);this._polylines=[];this._polylineBuckets={};this._positionBufferUsage={bufferUsage:b.STATIC_DRAW,frameCount:0};this._mode=undefined;this._polylinesToUpdate=[];this._vertexArrays=[];this._positionBuffer=undefined;this._texCoordExpandAndBatchIndexBuffer=undefined;this._batchTable=undefined;this._createBatchTable=false}u(H.prototype,{length:{get:function(){ae(this);return this._polylines.length}}});H.prototype.add=function(e){var t=new L(e,this);t._index=this._polylines.length;this._polylines.push(t);this._createVertexArray=true;this._createBatchTable=true;return t};H.prototype.remove=function(e){if(this.contains(e)){this._polylines[e._index]=undefined;this._polylinesRemoved=true;this._createVertexArray=true;this._createBatchTable=true;if(l(e._bucket)){var t=e._bucket;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy();t.pickShaderProgram=t.pickShaderProgram&&t.pickShaderProgram.destroy()}e._destroy();return true}return false};H.prototype.removeAll=function(){oe(this);le(this);this._polylineBuckets={};this._polylinesRemoved=false;this._polylines.length=0;this._polylinesToUpdate.length=0;this._createVertexArray=true};H.prototype.contains=function(e){return l(e)&&e._polylineCollection===this};H.prototype.get=function(e){if(!l(e)){throw new d("index is required.")}ae(this);return this._polylines[e]};function j(e,t){if(l(e._batchTable)){e._batchTable.destroy()}var r=[{functionName:"batchTable_getWidthAndShow",componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:o.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:true},{functionName:"batchTable_getCenterHigh",componentDatatype:o.FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:o.FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:o.FLOAT,componentsPerAttribute:2}];e._batchTable=new I(t,r,e._polylines.length)}var W=new f;var Y=new i;var X=new t;H.prototype.update=function(e){ae(this);if(this._polylines.length===0){return}ne(this,e);var r=e.context;var n=e.mapProjection;var a;var o=this._propertiesChanged;if(this._createBatchTable){if(w.maximumVertexTextureImageUnits===0){throw new _("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.")}j(this,r);this._createBatchTable=false}if(this._createVertexArray||J(this)){ee(this,r,n)}else if(this._polylinesUpdated){var s=this._polylinesToUpdate;if(this._mode!==N.SCENE3D){var u=s.length;for(var c=0;c<u;++c){a=s[c];a.update()}}if(o[V]||o[U]){ee(this,r,n)}else{var d=s.length;var h=this._polylineBuckets;for(var p=0;p<d;++p){a=s[p];o=a._propertiesChanged;var m=a._bucket;var g=0;for(var y in h){if(h.hasOwnProperty(y)){if(h[y]===m){if(o[B]){m.writeUpdate(g,a,this._positionBuffer,n)}break}g+=h[y].lengthOfPositions}}if(o[k]||o[F]){this._batchTable.setBatchedAttribute(a._index,0,new t(a._width,a._show))}if(this._batchTable.attributes.length>2){if(o[B]||o[V]){var b=e.mode===N.SCENE2D?a._boundingVolume2D:a._boundingVolumeWC;var C=f.fromCartesian(b.center,W);var S=i.fromElements(C.low.x,C.low.y,C.low.z,b.radius,Y);this._batchTable.setBatchedAttribute(a._index,2,C.high);this._batchTable.setBatchedAttribute(a._index,3,S)}if(o[z]){var E=X;E.x=0;E.y=Number.MAX_VALUE;var x=a.distanceDisplayCondition;if(l(x)){E.x=x.near;E.y=x.far}this._batchTable.setBatchedAttribute(a._index,4,E)}}a._clean()}}s.length=0;this._polylinesUpdated=false}o=this._propertiesChanged;for(var P=0;P<q;++P){o[P]=0}var A=v.IDENTITY;if(e.mode===N.SCENE3D){A=this.modelMatrix}var O=e.passes;var D=e.morphTime!==0;if(!l(this._opaqueRS)||this._opaqueRS.depthTest.enabled!==D){this._opaqueRS=T.fromCache({depthMask:D,depthTest:{enabled:D}})}if(!l(this._translucentRS)||this._translucentRS.depthTest.enabled!==D){this._translucentRS=T.fromCache({blending:M.ALPHA_BLEND,depthMask:!D,depthTest:{enabled:D}})}this._batchTable.update(e);if(O.render){var I=this._colorCommands;K(this,e,I,A,true)}if(O.pick){var R=this._pickCommands;K(this,e,R,A,false)}};var Q=new e;var Z=new e;function K(t,r,i,n,a){var o=r.context;var s=r.commandList;var u=i.length;var c=0;var d=true;var f=t._vertexArrays;var h=t.debugShowBoundingVolume;var p=t._batchTable;var m=p.getUniformMapCallback();var v=f.length;for(var g=0;g<v;++g){var _=f[g];var y=_.buckets;var b=y.length;for(var w=0;w<b;++w){var T=y[w];var E=T.offset;var x=a?T.bucket.shaderProgram:T.bucket.pickShaderProgram;var P=T.bucket.polylines;var A=P.length;var O;var D;var I=0;var M;for(var R=0;R<A;++R){var L=P[R];var k=re(L._material);if(k!==O){if(l(O)&&I>0){var F=D.isTranslucent();if(c>=u){M=new C({owner:t});i.push(M)}else{M=i[c]}++c;M.boundingVolume=e.clone(Q,M.boundingVolume);M.modelMatrix=n;M.shaderProgram=x;M.vertexArray=_.va;M.renderState=F?t._translucentRS:t._opaqueRS;M.pass=F?S.TRANSLUCENT:S.OPAQUE;M.debugShowBoundingVolume=a?h:false;M.uniformMap=m(D._uniforms);M.count=I;M.offset=E;E+=I;I=0;d=true;s.push(M)}D=L._material;D.update(o);O=k}var B=L._locatorBuckets;var U=B.length;for(var V=0;V<U;++V){var z=B[V];if(z.locator===T){I+=z.count}}var q;if(r.mode===N.SCENE3D){q=L._boundingVolumeWC}else if(r.mode===N.COLUMBUS_VIEW){q=L._boundingVolume2D}else if(r.mode===N.SCENE2D){if(l(L._boundingVolume2D)){q=e.clone(L._boundingVolume2D,Z);q.center.x=0}}else if(l(L._boundingVolumeWC)&&l(L._boundingVolume2D)){q=e.union(L._boundingVolumeWC,L._boundingVolume2D,Z)}if(d){d=false;e.clone(q,Q)}else{e.union(q,Q,Q)}}if(l(O)&&I>0){if(c>=u){M=new C({owner:t});i.push(M)}else{M=i[c]}++c;M.boundingVolume=e.clone(Q,M.boundingVolume);M.modelMatrix=n;M.shaderProgram=x;M.vertexArray=_.va;M.renderState=D.isTranslucent()?t._translucentRS:t._opaqueRS;M.pass=D.isTranslucent()?S.TRANSLUCENT:S.OPAQUE;M.debugShowBoundingVolume=a?h:false;M.uniformMap=m(D._uniforms);M.count=I;M.offset=E;d=true;s.push(M)}O=undefined}}i.length=c}H.prototype.isDestroyed=function(){return false};H.prototype.destroy=function(){se(this);oe(this);le(this);this._batchTable=this._batchTable&&this._batchTable.destroy();return c(this)};function J(e){var t=false;var r=e._propertiesChanged;var i=e._positionBufferUsage;if(r[B]){if(i.bufferUsage!==b.STREAM_DRAW){t=true;i.bufferUsage=b.STREAM_DRAW;i.frameCount=100}else{i.frameCount=100}}else if(i.bufferUsage!==b.STATIC_DRAW){if(i.frameCount===0){t=true;i.bufferUsage=b.STATIC_DRAW}else{i.frameCount--}}return t}var $=[0,0,0];function ee(e,t,r){e._createVertexArray=false;oe(e);se(e);ie(e);var i=[[]];var n=i[0];var a=e._batchTable;var s=[0];var u=0;var c=[[]];var d=0;var f=e._polylineBuckets;var p;var v;for(p in f){if(f.hasOwnProperty(p)){v=f[p];v.updateShader(t,a);d+=v.lengthOfPositions}}if(d>0){var g=e._mode;var _=new Float32Array(6*d*3);var w=new Float32Array(d*4);var C;var S=0;var T=0;var E=0;for(p in f){if(f.hasOwnProperty(p)){v=f[p];v.write(_,w,S,T,E,a,t,r);if(g===N.MORPHING){if(!l(C)){C=new Float32Array(6*d*3)}v.writeForMorph(C,S)}var x=v.lengthOfPositions;S+=6*x*3;T+=x*4;E+=x*4;u=v.updateIndices(i,s,c,u)}}var A=e._positionBufferUsage.bufferUsage;var O=b.STATIC_DRAW;e._positionBuffer=y.createVertexBuffer({context:t,typedArray:_,usage:A});var D;if(l(C)){D=y.createVertexBuffer({context:t,typedArray:C,usage:A})}e._texCoordExpandAndBatchIndexBuffer=y.createVertexBuffer({context:t,typedArray:w,usage:O});var I=3*Float32Array.BYTES_PER_ELEMENT;var M=4*Float32Array.BYTES_PER_ELEMENT;var R=0;var L=i.length;for(var k=0;k<L;++k){n=i[k];if(n.length>0){var F=new Uint16Array(n);var B=y.createIndexBuffer({context:t,typedArray:F,usage:b.STATIC_DRAW,indexDatatype:h.UNSIGNED_SHORT});R+=s[k];var U=6*(k*(I*m.SIXTY_FOUR_KILOBYTES)-R*I);var V=I+U;var z=I+V;var q=I+z;var H=I+q;var j=I+H;var W=k*(M*m.SIXTY_FOUR_KILOBYTES)-R*M;var Y=[{index:G.position3DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:U,strideInBytes:6*I},{index:G.position3DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:V,strideInBytes:6*I},{index:G.position2DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:U,strideInBytes:6*I},{index:G.position2DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:V,strideInBytes:6*I},{index:G.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:z,strideInBytes:6*I},{index:G.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:q,strideInBytes:6*I},{index:G.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:z,strideInBytes:6*I},{index:G.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:q,strideInBytes:6*I},{index:G.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:H,strideInBytes:6*I},{index:G.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:j,strideInBytes:6*I},{index:G.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:H,strideInBytes:6*I},{index:G.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:o.FLOAT,offsetInBytes:j,strideInBytes:6*I},{index:G.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:o.FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:W}];var X;var Q;var Z;var K;if(g===N.SCENE3D){X=e._positionBuffer;Q="vertexBuffer";Z=$;K="value"}else if(g===N.SCENE2D||g===N.COLUMBUS_VIEW){X=$;Q="value";Z=e._positionBuffer;K="vertexBuffer"}else{X=D;Q="vertexBuffer";Z=e._positionBuffer;K="vertexBuffer"}Y[0][Q]=X;Y[1][Q]=X;Y[2][K]=Z;Y[3][K]=Z;Y[4][Q]=X;Y[5][Q]=X;Y[6][K]=Z;Y[7][K]=Z;Y[8][Q]=X;Y[9][Q]=X;Y[10][K]=Z;Y[11][K]=Z;var J=new P({context:t,attributes:Y,indexBuffer:B});e._vertexArrays.push({va:J,buckets:c[k]})}}}}var te=[];function re(e){var t=R._uniformList[e.type];var r=t.length;te.length=2*r;var i=0;for(var n=0;n<r;++n){var a=t[n];te[i]=a;te[i+1]=e._uniforms[a]();i+=2}return e.type+":"+JSON.stringify(te)}function ie(e){var t=e._mode;var r=e._modelMatrix;var i=e._polylineBuckets={};var n=e._polylines;var a=n.length;for(var o=0;o<a;++o){var s=n[o];if(s._actualPositions.length>1){s.update();var u=s.material;var c=i[u.type];if(!l(c)){c=i[u.type]=new ce(u,t,r)}c.addPolyline(s)}}}function ne(e,t){var r=t.mode;if(e._mode!==r||!v.equals(e._modelMatrix,e.modelMatrix)){e._mode=r;e._modelMatrix=v.clone(e.modelMatrix);e._createVertexArray=true}}function ae(e){if(e._polylinesRemoved){e._polylinesRemoved=false;var t=[];var r=e._polylines.length;for(var i=0,n=0;i<r;++i){var a=e._polylines[i];if(l(a)){a._index=n++;t.push(a)}}e._polylines=t}}function oe(e){var t=e._polylines;var r=t.length;for(var i=0;i<r;++i){if(l(t[i])){var n=t[i]._bucket;if(l(n)){n.shaderProgram=n.shaderProgram&&n.shaderProgram.destroy()}}}}function se(e){var t=e._vertexArrays.length;for(var r=0;r<t;++r){e._vertexArrays[r].va.destroy()}e._vertexArrays.length=0}H.prototype._updatePolyline=function(e,t){this._polylinesUpdated=true;this._polylinesToUpdate.push(e);++this._propertiesChanged[t]};function le(e){var t=e._polylines;var r=t.length;for(var i=0;i<r;++i){if(l(t[i])){t[i]._destroy()}}}function ue(e,t,r){this.count=e;this.offset=t;this.bucket=r}function ce(e,t,r){this.polylines=[];this.lengthOfPositions=0;this.material=e;this.shaderProgram=undefined;this.pickShaderProgram=undefined;this.mode=t;this.modelMatrix=r}ce.prototype.addPolyline=function(e){var t=this.polylines;t.push(e);e._actualLength=this.getPolylinePositionsLength(e);this.lengthOfPositions+=e._actualLength;e._bucket=this};ce.prototype.updateShader=function(e,t){if(l(this.shaderProgram)){return}var r=["DISTANCE_DISPLAY_CONDITION"];var i=new x({sources:[this.material.shaderSource,O]});if(this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)!==-1){r.push("POLYLINE_DASH")}var n=t.getVertexShaderCallback()(D);var a=new x({defines:r,sources:[A,n]});var o=new x({sources:i.sources,pickColorQualifier:"varying"});this.shaderProgram=E.fromCache({context:e,vertexShaderSource:a,fragmentShaderSource:i,attributeLocations:G});this.pickShaderProgram=E.fromCache({context:e,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:G})};function de(e){return r.dot(r.UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(g.ORIGIN_ZX_PLANE)===p.INTERSECTING}ce.prototype.getPolylinePositionsLength=function(e){var t;if(this.mode===N.SCENE3D||!de(e)){t=e._actualPositions.length;return t*4-4}var r=0;var i=e._segments.lengths;t=i.length;for(var n=0;n<t;++n){r+=i[n]*4-4}return r};var fe=new r;var he=new r;var pe=new r;var me=new r;var ve=new i;var ge=new t;ce.prototype.write=function(e,t,n,o,s,u,c,d){var h=this.mode;var p=d.ellipsoid.maximumRadius*m.PI;var v=this.polylines;var g=v.length;for(var _=0;_<g;++_){var y=v[_];var b=y.width;var w=y.show&&b>0;var C=y._index;var S=this.getSegments(y,d);var T=S.positions;var E=S.lengths;var x=T.length;var P=y.getPickId(c).color;var A=0;var O=0;var D;for(var I=0;I<x;++I){if(I===0){if(y._loop){D=T[x-2]}else{D=me;r.subtract(T[0],T[1],D);r.add(T[0],D,D)}}else{D=T[I-1]}r.clone(D,he);r.clone(T[I],fe);if(I===x-1){if(y._loop){D=T[1]}else{D=me;r.subtract(T[x-1],T[x-2],D);r.add(T[x-1],D,D)}}else{D=T[I+1]}r.clone(D,pe);var M=E[A];if(I===O+M){O+=M;++A}var R=I-O===0;var L=I===O+E[A]-1;if(h===N.SCENE2D){he.z=0;fe.z=0;pe.z=0}if(h===N.SCENE2D||h===N.MORPHING){if((R||L)&&p-Math.abs(fe.x)<1){if(fe.x<0&&he.x>0||fe.x>0&&he.x<0){r.clone(fe,he)}if(fe.x<0&&pe.x>0||fe.x>0&&pe.x<0){r.clone(fe,pe)}}}var k=R?2:0;var F=L?2:4;for(var B=k;B<F;++B){f.writeElements(fe,e,n);f.writeElements(he,e,n+6);f.writeElements(pe,e,n+12);var U=B-2<0?-1:1;t[s]=I/(x-1);t[s+1]=2*(B%2)-1;t[s+2]=U;t[s+3]=C;n+=6*3;s+=4}}var V=ve;V.x=a.floatToByte(P.red);V.y=a.floatToByte(P.green);V.z=a.floatToByte(P.blue);V.w=a.floatToByte(P.alpha);var z=ge;z.x=b;z.y=w?1:0;var q=h===N.SCENE2D?y._boundingVolume2D:y._boundingVolumeWC;var G=f.fromCartesian(q.center,W);var H=G.high;var j=i.fromElements(G.low.x,G.low.y,G.low.z,q.radius,Y);var Q=X;Q.x=0;Q.y=Number.MAX_VALUE;var Z=y.distanceDisplayCondition;if(l(Z)){Q.x=Z.near;Q.y=Z.far}u.setBatchedAttribute(C,0,z);u.setBatchedAttribute(C,1,V);if(u.attributes.length>2){u.setBatchedAttribute(C,2,H);u.setBatchedAttribute(C,3,j);u.setBatchedAttribute(C,4,Q)}}};var _e=new r;var ye=new r;var be=new r;var we=new r;ce.prototype.writeForMorph=function(e,t){var i=this.modelMatrix;var n=this.polylines;var a=n.length;for(var o=0;o<a;++o){var s=n[o];var l=s._segments.positions;var u=s._segments.lengths;var c=l.length;var d=0;var h=0;for(var p=0;p<c;++p){var m;if(p===0){if(s._loop){m=l[c-2]}else{m=we;r.subtract(l[0],l[1],m);r.add(l[0],m,m)}}else{m=l[p-1]}m=v.multiplyByPoint(i,m,ye);var g=v.multiplyByPoint(i,l[p],_e);var _;if(p===c-1){if(s._loop){_=l[1]}else{_=we;r.subtract(l[c-1],l[c-2],_);r.add(l[c-1],_,_)}}else{_=l[p+1]}_=v.multiplyByPoint(i,_,be);var y=u[d];if(p===h+y){h+=y;++d}var b=p-h===0;var w=p===h+u[d]-1;var C=b?2:0;var S=w?2:4;for(var T=C;T<S;++T){f.writeElements(g,e,t);f.writeElements(m,e,t+6);f.writeElements(_,e,t+12);t+=6*3}}}};var Ce=new Array(1);ce.prototype.updateIndices=function(e,t,r,i){var n=r.length-1;var a=new ue(0,i,this);r[n].push(a);var o=0;var s=e[e.length-1];var l=0;if(s.length>0){l=s[s.length-1]+1}var u=this.polylines;var c=u.length;for(var d=0;d<c;++d){var f=u[d];f._locatorBuckets=[];var h;if(this.mode===N.SCENE3D){h=Ce;var p=f._actualPositions.length;if(p>0){h[0]=p}else{continue}}else{h=f._segments.lengths}var v=h.length;if(v>0){var g=0;for(var _=0;_<v;++_){var y=h[_]-1;for(var b=0;b<y;++b){if(l+4>=m.SIXTY_FOUR_KILOBYTES-2){f._locatorBuckets.push({locator:a,count:g});g=0;t.push(4);s=[];e.push(s);l=0;a.count=o;o=0;i=0;a=new ue(0,0,this);r[++n]=[a]}s.push(l,l+2,l+1);s.push(l+1,l+2,l+3);g+=6;o+=6;i+=6;l+=4}}f._locatorBuckets.push({locator:a,count:g});if(l+4>=m.SIXTY_FOUR_KILOBYTES-2){t.push(0);s=[];e.push(s);l=0;a.count=o;i=0;o=0;a=new ue(0,0,this);r[++n]=[a]}}f._clean()}a.count=o;return i};ce.prototype.getPolylineStartIndex=function(e){var t=this.polylines;var r=0;var i=t.length;for(var n=0;n<i;++n){var a=t[n];if(a===e){break}r+=a._actualLength}return r};var Se={positions:undefined,lengths:undefined};var Te=new Array(1);var Ee=new r;var xe=new n;ce.prototype.getSegments=function(t,i){var n=t._actualPositions;if(this.mode===N.SCENE3D){Te[0]=n.length;Se.positions=n;Se.lengths=Te;return Se}if(de(t)){n=t._segments.positions}var a=i.ellipsoid;var o=[];var s=this.modelMatrix;var l=n.length;var u;var c=Ee;for(var d=0;d<l;++d){u=n[d];c=v.multiplyByPoint(s,u,c);o.push(i.project(a.cartesianToCartographic(c,xe)))}if(o.length>0){t._boundingVolume2D=e.fromPoints(o,t._boundingVolume2D);var f=t._boundingVolume2D.center;t._boundingVolume2D.center=new r(f.z,f.x,f.y)}Se.positions=o;Se.lengths=t._segments.lengths;return Se};var Pe;ce.prototype.writeUpdate=function(e,t,i,n){var a=this.mode;var o=n.ellipsoid.maximumRadius*m.PI;var s=t._actualLength;if(s){e+=this.getPolylineStartIndex(t);var u=Pe;var c=6*s*3;if(!l(u)||u.length<c){u=Pe=new Float32Array(c)}else if(u.length>c){u=new Float32Array(u.buffer,0,c)}var d=this.getSegments(t,n);var h=d.positions;var p=d.lengths;var v=0;var g=0;var _=0;var y;s=h.length;for(var b=0;b<s;++b){if(b===0){if(t._loop){y=h[s-2]}else{y=me;r.subtract(h[0],h[1],y);r.add(h[0],y,y)}}else{y=h[b-1]}r.clone(y,he);r.clone(h[b],fe);if(b===s-1){if(t._loop){y=h[1]}else{y=me;r.subtract(h[s-1],h[s-2],y);r.add(h[s-1],y,y)}}else{y=h[b+1]}r.clone(y,pe);var w=p[g];if(b===_+w){_+=w;++g}var C=b-_===0;var S=b===_+p[g]-1;if(a===N.SCENE2D){he.z=0;fe.z=0;pe.z=0}if(a===N.SCENE2D||a===N.MORPHING){if((C||S)&&o-Math.abs(fe.x)<1){if(fe.x<0&&he.x>0||fe.x>0&&he.x<0){r.clone(fe,he)}if(fe.x<0&&pe.x>0||fe.x>0&&pe.x<0){r.clone(fe,pe)}}}var T=C?2:0;var E=S?2:4;for(var x=T;x<E;++x){f.writeElements(fe,u,v);f.writeElements(he,u,v+6);f.writeElements(pe,u,v+12);v+=6*3}}i.copyFromArrayView(u,6*3*Float32Array.BYTES_PER_ELEMENT*e)}};return H});define("DataSources/ScaledPositionProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/ReferenceFrame","./Property"],function(e,t,r,i,n,a,o){"use strict";function s(e){this._definitionChanged=new n;this._value=undefined;this._removeSubscription=undefined;this.setValue(e)}t(s.prototype,{isConstant:{get:function(){return o.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return e(this._value)?this._value.referenceFrame:a.FIXED}}});s.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,a.FIXED,t)};s.prototype.setValue=function(t){if(this._value!==t){this._value=t;if(e(this._removeSubscription)){this._removeSubscription();this._removeSubscription=undefined}if(e(t)){this._removeSubscription=t.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)}this._definitionChanged.raiseEvent(this)}};s.prototype.getValueInReferenceFrame=function(t,n,a){if(!e(t)){throw new r("time is required.")}if(!e(n)){throw new r("referenceFrame is required.")}if(!e(this._value)){return undefined}a=this._value.getValueInReferenceFrame(t,n,a);return e(a)?i.WGS84.scaleToGeodeticSurface(a,a):undefined};s.prototype.equals=function(e){return this===e||e instanceof s&&this._value===e._value};s.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};return s});define("DataSources/PathVisualizer",["../Core/AssociativeArray","../Core/Cartesian3","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/JulianDate","../Core/Matrix3","../Core/Matrix4","../Core/ReferenceFrame","../Core/TimeInterval","../Core/Transforms","../Scene/PolylineCollection","../Scene/SceneMode","./CompositePositionProperty","./ConstantPositionProperty","./MaterialProperty","./Property","./ReferenceProperty","./SampledPositionProperty","./ScaledPositionProperty","./TimeIntervalCollectionPositionProperty"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b){"use strict";var w=60;var C=1;var S=new u;var T=new u;var E=new u;function x(e){this.entity=e;this.polyline=undefined;this.index=undefined;this.updater=undefined}function P(e,t,i,n,o,s,l,u,c){var d=u;var f;f=e.getValueInReferenceFrame(t,s,c[d]);if(r(f)){c[d++]=f}var h=!r(o)||a.lessThanOrEquals(o,t)||a.greaterThanOrEquals(o,i);var p=0;var m=n.length;var v=n[p];var g=i;var _=false;var y;var b;var w;while(p<m){if(!h&&a.greaterThanOrEquals(v,o)){f=e.getValueInReferenceFrame(o,s,c[d]);if(r(f)){c[d++]=f}h=true}if(a.greaterThan(v,t)&&a.lessThan(v,g)&&!v.equals(o)){f=e.getValueInReferenceFrame(v,s,c[d]);if(r(f)){c[d++]=f}}if(p<m-1){if(l>0&&!_){var C=n[p+1];var S=a.secondsDifference(C,v);_=S>l;if(_){y=Math.ceil(S/l);b=0;w=S/Math.max(y,2);y=Math.max(y-1,1)}}if(_&&b<y){v=a.addSeconds(v,w,new a);b++;continue}}_=false;p++;v=n[p]}f=e.getValueInReferenceFrame(i,s,c[d]);if(r(f)){c[d++]=f}return d}function A(e,t,i,n,o,s,l,u){var c;var d=0;var f=l;var h=t;var p=Math.max(s,60);var m=!r(n)||a.lessThanOrEquals(n,t)||a.greaterThanOrEquals(n,i);while(a.lessThan(h,i)){if(!m&&a.greaterThanOrEquals(h,n)){m=true;c=e.getValueInReferenceFrame(n,o,u[f]);if(r(c)){u[f]=c;f++}}c=e.getValueInReferenceFrame(h,o,u[f]);if(r(c)){u[f]=c;f++}d++;h=a.addSeconds(t,p*d,new a)}c=e.getValueInReferenceFrame(i,o,u[f]);if(r(c)){u[f]=c;f++}return f}function O(e,t,i,n,o,s,l,c){E.start=t;E.stop=i;var d=l;var f=e.intervals;for(var h=0;h<f.length;h++){var p=f.get(h);if(!u.intersect(p,E,S).isEmpty){var m=p.start;if(!p.isStartIncluded){if(p.isStopIncluded){m=p.stop}else{m=a.addSeconds(p.start,a.secondsDifference(p.stop,p.start)/2,new a)}}var v=e.getValueInReferenceFrame(m,o,c[d]);if(r(v)){c[d]=v;d++}}}return d}function D(e,t,i,n,a,o,s,l){var u=e.getValueInReferenceFrame(t,a,l[s]);if(r(u)){l[s++]=u}return s}function I(e,t,r,i,n,o,s,l){T.start=t;T.stop=r;var c=s;var d=e.intervals;for(var f=0;f<d.length;f++){var h=d.get(f);if(!u.intersect(h,T,S).isEmpty){var p=h.start;var m=h.stop;var v=t;if(a.greaterThan(p,v)){v=p}var g=r;if(a.lessThan(m,g)){g=m}c=M(h.data,v,g,i,n,o,c,l)}}return c}function M(e,t,r,i,n,a,o,s){while(e instanceof g){e=e.resolvedProperty}if(e instanceof _){var l=e._property._times;o=P(e,t,r,l,i,n,a,o,s)}else if(e instanceof h){o=I(e,t,r,i,n,a,o,s)}else if(e instanceof b){o=O(e,t,r,i,n,a,o,s)}else if(e instanceof p||e instanceof y&&v.isConstant(e)){o=D(e,t,r,i,n,a,o,s)}else{o=A(e,t,r,i,n,a,o,s)}return o}function R(e,t,i,n,a,o,s){if(!r(s)){s=[]}var l=M(e,t,i,n,a,o,0,s);s.length=l;return s}var L=new o;function N(e,t){this._unusedIndexes=[];this._polylineCollection=new d;this._scene=e;this._referenceFrame=t;e.primitives.add(this._polylineCollection)}N.prototype.update=function(e){if(this._referenceFrame===l.INERTIAL){var i=c.computeIcrfToFixedMatrix(e,L);if(!r(i)){i=c.computeTemeToPseudoFixedMatrix(e,L)}s.fromRotationTranslation(i,t.ZERO,this._polylineCollection.modelMatrix)}};N.prototype.updateObject=function(e,t){var i=t.entity;var n=i._path;var o=i._position;var s;var l;var u=n._show;var c=t.polyline;var d=i.isShowing&&(!r(u)||u.getValue(e));if(d){var f=v.getValueOrUndefined(n._leadTime,e);var h=v.getValueOrUndefined(n._trailTime,e);var p=i._availability;var g=r(p);var _=r(f);var y=r(h);d=g||_&&y;if(d){if(y){s=a.addSeconds(e,-h,new a)}if(_){l=a.addSeconds(e,f,new a)}if(g){var b=p.start;var S=p.stop;if(!y||a.greaterThan(b,s)){s=b}if(!_||a.lessThan(S,l)){l=S}}d=a.lessThan(s,l)}}if(!d){if(r(c)){this._unusedIndexes.push(t.index);t.polyline=undefined;c.show=false;t.index=undefined}return}if(!r(c)){var T=this._unusedIndexes;var E=T.length;if(E>0){var x=T.pop();c=this._polylineCollection.get(x);t.index=x}else{t.index=this._polylineCollection.length;c=this._polylineCollection.add()}c.id=i;t.polyline=c}var P=v.getValueOrDefault(n._resolution,e,w);c.show=true;c.positions=R(o,s,l,e,this._referenceFrame,P,c.positions.slice());c.material=m.getValue(e,n._material,c.material);c.width=v.getValueOrDefault(n._width,e,C);c.distanceDisplayCondition=v.getValueOrUndefined(n._distanceDisplayCondition,e,c.distanceDisplayCondition)};N.prototype.removeObject=function(e){var t=e.polyline;if(r(t)){this._unusedIndexes.push(e.index);e.polyline=undefined;t.show=false;t.id=undefined;e.index=undefined}};N.prototype.destroy=function(){this._scene.primitives.remove(this._polylineCollection);return i(this)};function k(t,i){if(!r(t)){throw new n("scene is required.")}if(!r(i)){throw new n("entityCollection is required.")}i.collectionChanged.addEventListener(k.prototype._onCollectionChanged,this);this._scene=t;this._updaters={};this._entityCollection=i;this._items=new e;this._onCollectionChanged(i,i.values,[],[])}k.prototype.update=function(e){if(!r(e)){throw new n("time is required.")}var t=this._updaters;for(var i in t){if(t.hasOwnProperty(i)){t[i].update(e)}}var a=this._items.values;for(var o=0,s=a.length;o<s;o++){var u=a[o];var c=u.entity;var d=c._position;var h=u.updater;var p=l.FIXED;if(this._scene.mode===f.SCENE3D){p=d.referenceFrame}var m=this._updaters[p];if(h===m&&r(m)){m.updateObject(e,u);continue}if(r(h)){h.removeObject(u)}if(!r(m)){m=new N(this._scene,p);m.update(e);this._updaters[p]=m}u.updater=m;if(r(m)){m.updateObject(e,u)}}return true};k.prototype.isDestroyed=function(){return false};k.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(k.prototype._onCollectionChanged,this);var e=this._updaters;for(var t in e){if(e.hasOwnProperty(t)){e[t].destroy()}}return i(this)};k.prototype._onCollectionChanged=function(e,t,i,n){var a;var o;var s;var l=this._items;for(a=t.length-1;a>-1;a--){o=t[a];if(r(o._path)&&r(o._position)){l.set(o.id,new x(o))}}for(a=n.length-1;a>-1;a--){o=n[a];if(r(o._path)&&r(o._position)){if(!l.contains(o.id)){l.set(o.id,new x(o))}}else{s=l.get(o.id);if(r(s)){s.updater.removeObject(s);l.remove(o.id)}}}for(a=i.length-1;a>-1;a--){o=i[a];s=l.get(o.id);if(r(s)){if(r(s.updater)){s.updater.removeObject(s)}l.remove(o.id)}}};k._subSample=R;return k});define("DataSources/PointVisualizer",["../Core/AssociativeArray","../Core/Cartesian3","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","./BoundingSphereState","./Property"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";var d=r.WHITE;var f=r.BLACK;var h=0;var p=1;var m=0;var v=new r;var g=new t;var _=new r;var y=new s;var b=new s;var w=new o;function C(e){this.entity=e;this.pointPrimitive=undefined;this.billboard=undefined;this.color=undefined;this.outlineColor=undefined;this.pixelSize=undefined;this.outlineWidth=undefined}function S(t,r){if(!i(t)){throw new a("entityCluster is required.")}if(!i(r)){throw new a("entityCollection is required.")}r.collectionChanged.addEventListener(S.prototype._onCollectionChanged,this);this._cluster=t;this._entityCollection=r;this._items=new e;this._onCollectionChanged(r,r.values,[],[])}S.prototype.update=function(e){if(!i(e)){throw new a("time is required.")}var t=this._items.values;var n=this._cluster;for(var o=0,s=t.length;o<s;o++){var u=t[o];var C=u.entity;var S=C._point;var x=u.pointPrimitive;var P=u.billboard;var A=c.getValueOrDefault(S._heightReference,e,l.NONE);var O=C.isShowing&&C.isAvailable(e)&&c.getValueOrDefault(S._show,e,true);if(O){g=c.getValueOrUndefined(C._position,e,g);O=i(g)}if(!O){T(u,C,n);continue}if(!c.isConstant(C._position)){n._clusterDirty=true}var D=false;if(A!==l.NONE&&!i(P)){if(i(x)){T(u,C,n);x=undefined}P=n.getBillboard(C);P.id=C;P.image=undefined;u.billboard=P;D=true}else if(A===l.NONE&&!i(x)){if(i(P)){T(u,C,n);P=undefined}x=n.getPoint(C);x.id=C;u.pointPrimitive=x}if(i(x)){x.show=true;x.position=g;x.scaleByDistance=c.getValueOrUndefined(S._scaleByDistance,e,y);x.translucencyByDistance=c.getValueOrUndefined(S._translucencyByDistance,e,b);x.color=c.getValueOrDefault(S._color,e,d,v);x.outlineColor=c.getValueOrDefault(S._outlineColor,e,f,_);x.outlineWidth=c.getValueOrDefault(S._outlineWidth,e,h);x.pixelSize=c.getValueOrDefault(S._pixelSize,e,p);x.distanceDisplayCondition=c.getValueOrUndefined(S._distanceDisplayCondition,e,w);x.disableDepthTestDistance=c.getValueOrDefault(S._disableDepthTestDistance,e,m)}else{P.show=true;P.position=g;P.scaleByDistance=c.getValueOrUndefined(S._scaleByDistance,e,y);P.translucencyByDistance=c.getValueOrUndefined(S._translucencyByDistance,e,b);P.distanceDisplayCondition=c.getValueOrUndefined(S._distanceDisplayCondition,e,w);P.disableDepthTestDistance=c.getValueOrDefault(S._disableDepthTestDistance,e,m);P.heightReference=A;var I=c.getValueOrDefault(S._color,e,d,v);var M=c.getValueOrDefault(S._outlineColor,e,f,_);var R=Math.round(c.getValueOrDefault(S._outlineWidth,e,h));var L=Math.max(1,Math.round(c.getValueOrDefault(S._pixelSize,e,p)));if(R>0){P.scale=1;D=D||R!==u.outlineWidth||L!==u.pixelSize||!r.equals(I,u.color)||!r.equals(M,u.outlineColor)}else{P.scale=L/50;L=50;D=D||R!==u.outlineWidth||!r.equals(I,u.color)||!r.equals(M,u.outlineColor)}if(D){u.color=r.clone(I,u.color);u.outlineColor=r.clone(M,u.outlineColor);u.pixelSize=L;u.outlineWidth=R;var N=I.alpha;var k=I.toCssColorString();var F=M.toCssColorString();var B=JSON.stringify([k,L,F,R]);P.setImage(B,E(N,k,F,R,L))}}}return true};S.prototype.getBoundingSphere=function(e,r){if(!i(e)){throw new a("entity is required.")}if(!i(r)){throw new a("result is required.")}var n=this._items.get(e.id);if(!i(n)||!(i(n.pointPrimitive)||i(n.billboard))){return u.FAILED}if(i(n.pointPrimitive)){r.center=t.clone(n.pointPrimitive.position,r.center)}else{var o=n.billboard;if(!i(o._clampedPosition)){return u.PENDING}r.center=t.clone(o._clampedPosition,r.center)}r.radius=0;return u.DONE};S.prototype.isDestroyed=function(){return false};S.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(S.prototype._onCollectionChanged,this);var e=this._entityCollection.values;for(var t=0;t<e.length;t++){this._cluster.removePoint(e[t])}return n(this)};S.prototype._onCollectionChanged=function(e,t,r,n){var a;var o;var s=this._items;var l=this._cluster;for(a=t.length-1;a>-1;a--){o=t[a];if(i(o._point)&&i(o._position)){s.set(o.id,new C(o))}}for(a=n.length-1;a>-1;a--){o=n[a];if(i(o._point)&&i(o._position)){if(!s.contains(o.id)){s.set(o.id,new C(o))}}else{T(s.get(o.id),o,l);s.remove(o.id)}}for(a=r.length-1;a>-1;a--){o=r[a];T(s.get(o.id),o,l);s.remove(o.id)}};function T(e,t,r){if(i(e)){var n=e.pointPrimitive;if(i(n)){e.pointPrimitive=undefined;r.removePoint(t);return}var a=e.billboard;if(i(a)){e.billboard=undefined;r.removeBillboard(t)}}}function E(e,t,r,i,n){return function(a){var o=document.createElement("canvas");var s=n+2*i;o.height=o.width=s;var l=o.getContext("2d");l.clearRect(0,0,s,s);if(i!==0){l.beginPath();l.arc(s/2,s/2,s/2,0,2*Math.PI,true);l.closePath();l.fillStyle=r;l.fill();if(e<1){l.save();l.globalCompositeOperation="destination-out";l.beginPath();l.arc(s/2,s/2,n/2,0,2*Math.PI,true);l.closePath();l.fillStyle="black";l.fill();l.restore()}}l.beginPath();l.arc(s/2,s/2,n/2,0,2*Math.PI,true);l.closePath();l.fillStyle=t;l.fill();return o}}return S});define("DataSources/PolygonGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/isArray","../Core/Iso8601","../Core/oneTimeWarning","../Core/PolygonGeometry","../Core/PolygonHierarchy","../Core/PolygonOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P){"use strict";var A=new S(e.WHITE);var O=new T(true);var D=new T(true);var I=new T(false);var M=new T(e.BLACK);var R=new T(C.DISABLED);var L=new T(new s);var N=new e;function k(e){this.id=e;this.vertexFormat=undefined;this.polygonHierarchy=undefined;this.perPositionHeight=undefined;this.closeTop=undefined;this.closeBottom=undefined;this.height=undefined;this.extrudedHeight=undefined;this.granularity=undefined;this.stRotation=undefined}function F(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(F.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._isClosed=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new u;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._onTerrain=false;this._options=new k(e);this._onEntityPropertyChanged(e,"polygon",e.polygon,undefined)}n(F,{perInstanceColorAppearanceType:{value:b},materialAppearanceType:{value:y}});n(F.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&P.isConstant(this._showProperty)&&P.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&P.isConstant(this._showProperty)&&P.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});F.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};F.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};F.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var u;var d=new g(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var f=this._distanceDisplayConditionProperty.getValue(r);var h=l.fromDistanceDisplayCondition(f);if(this._materialProperty instanceof S){var m=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){m=this._materialProperty.color.getValue(r)}u=t.fromColor(m);s={show:d,distanceDisplayCondition:h,color:u}}else{s={show:d,distanceDisplayCondition:h}}return new c({id:n,geometry:new p(this._options),attributes:s})};F.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=P.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var u=this._distanceDisplayConditionProperty.getValue(r);return new c({id:n,geometry:new v(this._options),attributes:{show:new g(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:l.fromDistanceDisplayCondition(u)}})};F.prototype.isDestroyed=function(){return false};F.prototype.destroy=function(){this._entitySubscription();a(this)};F.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="polygon")){return}var o=this._entity.polygon;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var l=i(s)&&s.isConstant?s.getValue(f.MINIMUM_VALUE):true;var u=o.perPositionHeight;var c=i(u)&&(u.isConstant?u.getValue(f.MINIMUM_VALUE):true);var p=o.outline;var v=i(p);if(v&&p.isConstant){v=p.getValue(f.MINIMUM_VALUE)}if(!l&&!v){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var g=o.hierarchy;var w=o.show;if(i(w)&&w.isConstant&&!w.getValue(f.MINIMUM_VALUE)||!i(g)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var C=r(o.material,A);var T=C instanceof S;this._materialProperty=C;this._fillProperty=r(s,D);this._showProperty=r(w,O);this._showOutlineProperty=r(o.outline,I);this._outlineColorProperty=v?r(o.outlineColor,M):undefined;this._shadowsProperty=r(o.shadows,R);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,L);var E=o.height;var x=o.extrudedHeight;var N=o.granularity;var k=o.stRotation;var F=o.outlineWidth;var B=l&&!i(E)&&!i(x)&&T&&!c&&_.isSupported(this._scene);if(v&&B){h(h.geometryOutlines);v=false}var U=o.perPositionHeight;var V=o.closeTop;var z=o.closeBottom;this._fillEnabled=l;this._onTerrain=B;this._outlineEnabled=v;if(!g.isConstant||!P.isConstant(E)||!P.isConstant(x)||!P.isConstant(N)||!P.isConstant(k)||!P.isConstant(F)||!P.isConstant(u)||!P.isConstant(U)||!P.isConstant(V)||!P.isConstant(z)||B&&!P.isConstant(C)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var q=this._options;q.vertexFormat=T?b.VERTEX_FORMAT:y.MaterialSupport.TEXTURED.vertexFormat;var G=g.getValue(f.MINIMUM_VALUE);if(d(G)){G=new m(G)}var H=P.getValueOrUndefined(E,f.MINIMUM_VALUE);var j=P.getValueOrDefault(V,f.MINIMUM_VALUE,true);var W=P.getValueOrDefault(z,f.MINIMUM_VALUE,true);var Y=P.getValueOrUndefined(x,f.MINIMUM_VALUE);q.polygonHierarchy=G;q.height=H;q.extrudedHeight=Y;q.granularity=P.getValueOrUndefined(N,f.MINIMUM_VALUE);q.stRotation=P.getValueOrUndefined(k,f.MINIMUM_VALUE);q.perPositionHeight=P.getValueOrUndefined(U,f.MINIMUM_VALUE);q.closeTop=j;q.closeBottom=W;this._outlineWidth=P.getValueOrDefault(F,f.MINIMUM_VALUE,1);this._isClosed=i(Y)&&Y!==H&&j&&W;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};F.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new B(e,t,this)};function B(e,t,r){this._primitives=e;this._groundPrimitives=t;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=r;this._options=new k(r._entity)}B.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._geometryUpdater;var a=n._onTerrain;var s=this._primitives;var l=this._groundPrimitives;if(a){l.removeAndDestroy(this._primitive)}else{s.removeAndDestroy(this._primitive);s.removeAndDestroy(this._outlinePrimitive);this._outlinePrimitive=undefined}this._primitive=undefined;var u=n._entity;var f=u.polygon;if(!u.isShowing||!u.isAvailable(r)||!P.getValueOrDefault(f.show,r,true)){return}var h=this._options;var g=P.getValueOrUndefined(f.hierarchy,r);if(!i(g)){return}if(d(g)){h.polygonHierarchy=new m(g)}else{h.polygonHierarchy=g}var C=P.getValueOrDefault(f.closeTop,r,true);var S=P.getValueOrDefault(f.closeBottom,r,true);h.height=P.getValueOrUndefined(f.height,r);h.extrudedHeight=P.getValueOrUndefined(f.extrudedHeight,r);h.granularity=P.getValueOrUndefined(f.granularity,r);h.stRotation=P.getValueOrUndefined(f.stRotation,r);h.perPositionHeight=P.getValueOrUndefined(f.perPositionHeight,r);h.closeTop=C;h.closeBottom=S;var T=this._geometryUpdater.shadowsProperty.getValue(r);if(P.getValueOrDefault(f.fill,r,true)){var E=n.fillMaterialProperty;var A=x.getValue(r,E,this._material);this._material=A;if(a){var O=e.WHITE;if(i(E.color)){O=E.color.getValue(r)}this._primitive=l.add(new _({geometryInstances:new c({id:u,geometry:new p(h),attributes:{color:t.fromColor(O)}}),asynchronous:false,shadows:T}))}else{var D=new y({material:A,translucent:A.isTranslucent(),closed:i(h.extrudedHeight)&&h.extrudedHeight!==h.height&&C&&S});h.vertexFormat=D.vertexFormat;this._primitive=s.add(new w({geometryInstances:new c({id:u,geometry:new p(h)}),appearance:D,asynchronous:false,shadows:T}))}}if(!a&&P.getValueOrDefault(f.outline,r,false)){h.vertexFormat=b.VERTEX_FORMAT;var I=P.getValueOrClonedDefault(f.outlineColor,r,e.BLACK,N);var M=P.getValueOrDefault(f.outlineWidth,r,1);var R=I.alpha!==1;this._outlinePrimitive=s.add(new w({geometryInstances:new c({id:u,geometry:new v(h),attributes:{color:t.fromColor(I)}}),appearance:new b({flat:true,translucent:R,renderState:{lineWidth:n._scene.clampLineWidth(M)}}),asynchronous:false,shadows:T}))}};B.prototype.getBoundingSphere=function(e,t){return E(e,this._primitive,this._outlinePrimitive,t)};B.prototype.isDestroyed=function(){return false};B.prototype.destroy=function(){var e=this._primitives;var t=this._groundPrimitives;if(this._geometryUpdater._onTerrain){t.removeAndDestroy(this._primitive)}else{e.removeAndDestroy(this._primitive)}e.removeAndDestroy(this._outlinePrimitive);a(this)};return F});define("Shaders/Appearances/PolylineColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec4 color;\nattribute float batchId;\n\nvarying vec4 v_color;\n\nvoid main()\n{\n    float expandDir = expandAndWidth.x;\n    float width = abs(expandAndWidth.y) + 0.5;\n    bool usePrev = expandAndWidth.y < 0.0;\n\n    vec4 p = czm_computePosition();\n    vec4 prev = czm_computePrevPosition();\n    vec4 next = czm_computeNextPosition();\n\n    v_color = color;\n\n    float angle;\n    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);\n    gl_Position = czm_viewportOrthographic * positionWC;\n}\n"});define("Scene/PolylineColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PolylineColorAppearanceVS","../Shaders/PolylineCommon","./Appearance"],function(e,t,r,i,n,a,o){"use strict";var s=a+"\n"+n;var l=i;function u(t){t=e(t,e.EMPTY_OBJECT);var r=e(t.translucent,true);var i=false;var n=u.VERTEX_FORMAT;this.material=undefined;this.translucent=r;this._vertexShaderSource=e(t.vertexShaderSource,s);this._fragmentShaderSource=e(t.fragmentShaderSource,l);this._renderState=o.getDefaultRenderState(r,i,t.renderState);this._closed=i;this._vertexFormat=n}t(u.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});u.VERTEX_FORMAT=r.POSITION_ONLY;u.prototype.getFragmentShaderSource=o.prototype.getFragmentShaderSource;u.prototype.isTranslucent=o.prototype.isTranslucent;u.prototype.getRenderState=o.prototype.getRenderState;return u});define("Shaders/Appearances/PolylineMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec2 st;\nattribute float batchId;\n\nvarying float v_width;\nvarying vec2 v_st;\nvarying float v_polylineAngle;\n\nvoid main()\n{\n    float expandDir = expandAndWidth.x;\n    float width = abs(expandAndWidth.y) + 0.5;\n    bool usePrev = expandAndWidth.y < 0.0;\n\n    vec4 p = czm_computePosition();\n    vec4 prev = czm_computePrevPosition();\n    vec4 next = czm_computeNextPosition();\n\n    v_width = width;\n    v_st = st;\n\n    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, v_polylineAngle);\n    gl_Position = czm_viewportOrthographic * positionWC;\n}\n"});define("Scene/PolylineMaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PolylineMaterialAppearanceVS","../Shaders/PolylineCommon","../Shaders/PolylineFS","./Appearance","./Material"],function(e,t,r,i,n,a,o,s,l){"use strict";var u=a+"\n"+n;var c=o;function d(r){r=e(r,e.EMPTY_OBJECT);var i=e(r.translucent,true);var n=false;var a=d.VERTEX_FORMAT;this.material=t(r.material)?r.material:l.fromType(l.ColorType);this.translucent=i;this._vertexShaderSource=e(r.vertexShaderSource,u);this._fragmentShaderSource=e(r.fragmentShaderSource,c);this._renderState=s.getDefaultRenderState(i,n,r.renderState);this._closed=n;this._vertexFormat=a}r(d.prototype,{vertexShaderSource:{get:function(){var e=this._vertexShaderSource;if(this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)!==-1){e="#define POLYLINE_DASH\n"+e}return e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});d.VERTEX_FORMAT=i.POSITION_AND_ST;d.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource;d.prototype.isTranslucent=s.prototype.isTranslucent;d.prototype.getRenderState=s.prototype.getRenderState;return d});define("DataSources/PolylineGeometryUpdater",["../Core/BoundingSphere","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/PolylineGeometry","../Core/PolylinePipeline","../Core/ShowGeometryInstanceAttribute","../Scene/PolylineCollection","../Scene/PolylineColorAppearance","../Scene/PolylineMaterialAppearance","../Scene/ShadowMode","./BoundingSphereState","./ColorMaterialProperty","./ConstantProperty","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T){"use strict";var E={};var x=new w(t.WHITE);var P=new C(true);var A=new C(y.DISABLED);var O=new C(new l);function D(e){this.id=e;this.vertexFormat=undefined;this.positions=undefined;this.width=undefined;this.followSurface=undefined;this.granularity=undefined}function I(e,t){if(!n(e)){throw new s("entity is required")}if(!n(t)){throw new s("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(I.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._geometryChanged=new c;this._showProperty=undefined;this._materialProperty=undefined;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._depthFailMaterialProperty=undefined;this._options=new D(e);this._onEntityPropertyChanged(e,"polyline",e.polyline,undefined)}a(I,{perInstanceColorAppearanceType:{value:g},materialAppearanceType:{value:_}});a(I.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!n(this._entity.availability)&&T.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},depthFailMaterialProperty:{get:function(){return this._depthFailMaterialProperty}},outlineEnabled:{value:false},hasConstantOutline:{value:true},outlineColorProperty:{value:undefined},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:false},geometryChanged:{get:function(){return this._geometryChanged}}});I.prototype.isOutlineVisible=function(e){return false};I.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)};I.prototype.createFillGeometryInstance=function(e){if(!n(e)){throw new s("time is required.")}if(!this._fillEnabled){throw new s("This instance does not represent a filled geometry.")}var i=this._entity;var a=i.isAvailable(e);var o=new m(a&&i.isShowing&&this._showProperty.getValue(e));var l=this._distanceDisplayConditionProperty.getValue(e);var c=u.fromDistanceDisplayCondition(l);var f={show:o,distanceDisplayCondition:c};var p;if(this._materialProperty instanceof w){p=t.WHITE;if(n(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){p=this._materialProperty.color.getValue(e)}f.color=r.fromColor(p)}if(n(this._depthFailMaterialProperty)&&this._depthFailMaterialProperty instanceof w){p=t.WHITE;if(n(this._depthFailMaterialProperty.color)&&(this._depthFailMaterialProperty.color.isConstant||a)){p=this._depthFailMaterialProperty.color.getValue(e)}f.depthFailColor=r.fromColor(p)}return new d({id:i,geometry:new h(this._options),attributes:f})};I.prototype.createOutlineGeometryInstance=function(e){throw new s("This instance does not represent an outlined geometry.")};I.prototype.isDestroyed=function(){return false};I.prototype.destroy=function(){this._entitySubscription();o(this)};I.prototype._onEntityPropertyChanged=function(e,t,r,a){if(!(t==="availability"||t==="polyline")){return}var o=this._entity.polyline;if(!n(o)){if(this._fillEnabled){this._fillEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.positions;var l=o.show;if(n(l)&&l.isConstant&&!l.getValue(f.MINIMUM_VALUE)||!n(s)){if(this._fillEnabled){this._fillEnabled=false;this._geometryChanged.raiseEvent(this)}return}var u=i(o.material,x);var c=u instanceof w;this._materialProperty=u;this._depthFailMaterialProperty=o.depthFailMaterial;this._showProperty=i(l,P);this._shadowsProperty=i(o.shadows,A);this._distanceDisplayConditionProperty=i(o.distanceDisplayCondition,O);this._fillEnabled=true;var d=o.width;var h=o.followSurface;var p=o.granularity;if(!s.isConstant||!T.isConstant(d)||!T.isConstant(h)||!T.isConstant(p)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var m=this._options;var v=s.getValue(f.MINIMUM_VALUE,m.positions);if(!n(v)||v.length<2){if(this._fillEnabled){this._fillEnabled=false;this._geometryChanged.raiseEvent(this)}return}var y;if(c&&(!n(this._depthFailMaterialProperty)||this._depthFailMaterialProperty instanceof w)){y=g.VERTEX_FORMAT}else{y=_.VERTEX_FORMAT}m.vertexFormat=y;m.positions=v;m.width=n(d)?d.getValue(f.MINIMUM_VALUE):undefined;m.followSurface=n(h)?h.getValue(f.MINIMUM_VALUE):undefined;m.granularity=n(p)?p.getValue(f.MINIMUM_VALUE):undefined;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};I.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new s("This instance does not represent dynamic geometry.")}if(!n(e)){throw new s("primitives is required.")}return new R(e,this)};var M={positions:undefined,granularity:undefined,height:undefined,ellipsoid:undefined};function R(e,t){var r=t._scene.id;var i=E[r];if(!n(i)||i.isDestroyed()){i=new v;E[r]=i;e.add(i)}else if(!e.contains(i)){e.add(i)}var a=i.add();a.id=t._entity;this._line=a;this._primitives=e;this._geometryUpdater=t;this._positions=[]}R.prototype.update=function(e){var t=this._geometryUpdater;var r=t._entity;var i=r.polyline;var a=this._line;if(!r.isShowing||!r.isAvailable(e)||!T.getValueOrDefault(i._show,e,true)){a.show=false;return}var o=i.positions;var s=T.getValueOrUndefined(o,e,this._positions);if(!n(s)||s.length<2){a.show=false;return}var l=T.getValueOrDefault(i._followSurface,e,true);var u=t._scene.globe;if(l&&n(u)){M.ellipsoid=u.ellipsoid;M.positions=s;M.granularity=T.getValueOrUndefined(i._granularity,e);M.height=p.extractHeights(s,u.ellipsoid);s=p.generateCartesianArc(M)}a.show=true;a.positions=s.slice();a.material=S.getValue(e,t.fillMaterialProperty,a.material);a.width=T.getValueOrDefault(i._width,e,1);a.distanceDisplayCondition=T.getValueOrUndefined(i._distanceDisplayCondition,e,a.distanceDisplayCondition)};R.prototype.getBoundingSphere=function(t,r){if(!n(t)){throw new s("entity is required.")}if(!n(r)){throw new s("result is required.")}var i=this._line;if(i.show&&i.positions.length>0){e.fromPoints(i.positions,r);return b.DONE}return b.FAILED};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){var e=this._geometryUpdater;var t=e._scene.id;var r=E[t];r.remove(this._line);if(r.length===0){this._primitives.removeAndDestroy(r);delete E[t]}o(this)};return I});define("DataSources/PolylineVolumeGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/PolylineVolumeGeometry","../Core/PolylineVolumeOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S){"use strict";var T=new y(e.WHITE);var E=new b(true);var x=new b(true);var P=new b(false);var A=new b(e.BLACK);var O=new b(_.DISABLED);var D=new b(new s);var I=new e;function M(e){this.id=e;this.vertexFormat=undefined;this.polylinePositions=undefined;this.shapePositions=undefined;this.cornerType=undefined;this.granularity=undefined}function R(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(R.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new u;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new M(e);this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,undefined)}n(R,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:m}});n(R.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:true},geometryChanged:{get:function(){return this._geometryChanged}}});R.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};R.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};R.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var u;var d=new p(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var h=this._distanceDisplayConditionProperty.getValue(r);var m=l.fromDistanceDisplayCondition(h);if(this._materialProperty instanceof y){var v=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){v=this._materialProperty.color.getValue(r)}u=t.fromColor(v);s={show:d,distanceDisplayCondition:m,color:u}}else{s={show:d,distanceDisplayCondition:m}}return new c({id:n,geometry:new f(this._options),attributes:s})};R.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=S.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var u=this._distanceDisplayConditionProperty.getValue(r);return new c({id:n,geometry:new h(this._options),attributes:{show:new p(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:l.fromDistanceDisplayCondition(u)}})};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._entitySubscription();a(this)};R.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="polylineVolume")){return}var o=this._entity.polylineVolume;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var l=i(s)&&s.isConstant?s.getValue(d.MINIMUM_VALUE):true;var u=o.outline;var c=i(u);if(c&&u.isConstant){c=u.getValue(d.MINIMUM_VALUE)}if(!l&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var f=o.positions;var h=o.shape;var p=o.show;if(!i(f)||!i(h)||i(p)&&p.isConstant&&!p.getValue(d.MINIMUM_VALUE)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var g=r(o.material,T);var _=g instanceof y;this._materialProperty=g;this._fillProperty=r(s,x);this._showProperty=r(p,E);this._showOutlineProperty=r(o.outline,P);this._outlineColorProperty=c?r(o.outlineColor,A):undefined;this._shadowsProperty=r(o.shadows,O);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,D);var b=o.granularity;var w=o.outlineWidth;var C=o.cornerType;this._fillEnabled=l;this._outlineEnabled=c;if(!f.isConstant||!h.isConstant||!S.isConstant(b)||!S.isConstant(w)||!S.isConstant(C)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var I=this._options;I.vertexFormat=_?v.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat;I.polylinePositions=f.getValue(d.MINIMUM_VALUE,I.polylinePositions);I.shapePositions=h.getValue(d.MINIMUM_VALUE,I.shape);I.granularity=i(b)?b.getValue(d.MINIMUM_VALUE):undefined;I.cornerType=i(C)?C.getValue(d.MINIMUM_VALUE):undefined;this._outlineWidth=i(w)?w.getValue(d.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};R.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new L(e,this)};function L(e,t){this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new M(t._entity)}L.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._primitives;n.removeAndDestroy(this._primitive);n.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;var a=this._geometryUpdater;var s=a._entity;var l=s.polylineVolume;if(!s.isShowing||!s.isAvailable(r)||!S.getValueOrDefault(l.show,r,true)){return}var u=this._options;var d=S.getValueOrUndefined(l.positions,r,u.polylinePositions);var p=S.getValueOrUndefined(l.shape,r);if(!i(d)||!i(p)){return}u.polylinePositions=d;u.shapePositions=p;u.granularity=S.getValueOrUndefined(l.granularity,r);u.cornerType=S.getValueOrUndefined(l.cornerType,r);var _=this._geometryUpdater.shadowsProperty.getValue(r);if(!i(l.fill)||l.fill.getValue(r)){var y=C.getValue(r,a.fillMaterialProperty,this._material);this._material=y;var b=new m({material:y,translucent:y.isTranslucent(),closed:true});u.vertexFormat=b.vertexFormat;this._primitive=n.add(new g({geometryInstances:new c({id:s,geometry:new f(u)}),appearance:b,asynchronous:false,shadows:_}))}if(i(l.outline)&&l.outline.getValue(r)){u.vertexFormat=v.VERTEX_FORMAT;var w=S.getValueOrClonedDefault(l.outlineColor,r,e.BLACK,I);var T=S.getValueOrDefault(l.outlineWidth,r,1);var E=w.alpha!==1;this._outlinePrimitive=n.add(new g({geometryInstances:new c({id:s,geometry:new h(u),attributes:{color:t.fromColor(w)}}),appearance:new v({flat:true,translucent:E,renderState:{lineWidth:a._scene.clampLineWidth(T)}}),asynchronous:false,shadows:_}))}};L.prototype.getBoundingSphere=function(e,t){return w(e,this._primitive,this._outlinePrimitive,t)};L.prototype.isDestroyed=function(){return false};L.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);a(this)};return R});define("DataSources/RectangleGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/RectangleGeometry","../Core/RectangleOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E){"use strict";var x=new w(e.WHITE);var P=new C(true);var A=new C(true);var O=new C(false);var D=new C(e.BLACK);var I=new C(b.DISABLED);var M=new C(new s);var R=new e;function L(e){this.id=e;this.vertexFormat=undefined;this.rectangle=undefined;this.closeBottom=undefined;this.closeTop=undefined;this.height=undefined;this.extrudedHeight=undefined;this.granularity=undefined;this.stRotation=undefined;this.rotation=undefined}function N(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(N.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._isClosed=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new u;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._onTerrain=false;this._options=new L(e);this._onEntityPropertyChanged(e,"rectangle",e.rectangle,undefined)}n(N,{perInstanceColorAppearanceType:{value:_},materialAppearanceType:{value:g}});n(N.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});N.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};N.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};N.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var u;var d=new m(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var f=this._distanceDisplayConditionProperty.getValue(r);var p=l.fromDistanceDisplayCondition(f);if(this._materialProperty instanceof w){var v=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){v=this._materialProperty.color.getValue(r)}u=t.fromColor(v);s={show:d,distanceDisplayCondition:p,color:u}}else{s={show:d,distanceDisplayCondition:p}}return new c({id:n,geometry:new h(this._options),attributes:s})};N.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=E.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var u=this._distanceDisplayConditionProperty.getValue(r);return new c({id:n,geometry:new p(this._options),attributes:{show:new m(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:l.fromDistanceDisplayCondition(u)}})};N.prototype.isDestroyed=function(){return false};N.prototype.destroy=function(){this._entitySubscription();a(this)};N.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="rectangle")){return}var o=this._entity.rectangle;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var l=i(s)&&s.isConstant?s.getValue(d.MINIMUM_VALUE):true;var u=o.outline;var c=i(u);if(c&&u.isConstant){c=u.getValue(d.MINIMUM_VALUE)}if(!l&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var h=o.coordinates;var p=o.show;if(i(p)&&p.isConstant&&!p.getValue(d.MINIMUM_VALUE)||!i(h)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var m=r(o.material,x);var y=m instanceof w;this._materialProperty=m;this._fillProperty=r(s,A);this._showProperty=r(p,P);this._showOutlineProperty=r(o.outline,O);this._outlineColorProperty=c?r(o.outlineColor,D):undefined;this._shadowsProperty=r(o.shadows,I);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,M);var b=o.height;var C=o.extrudedHeight;var S=o.granularity;var T=o.stRotation;var R=o.rotation;var L=o.outlineWidth;var N=o.closeBottom;var k=o.closeTop;var F=l&&!i(b)&&!i(C)&&y&&v.isSupported(this._scene);if(c&&F){f(f.geometryOutlines);c=false}this._fillEnabled=l;this._onTerrain=F;this._outlineEnabled=c;if(!h.isConstant||!E.isConstant(b)||!E.isConstant(C)||!E.isConstant(S)||!E.isConstant(T)||!E.isConstant(R)||!E.isConstant(L)||!E.isConstant(N)||!E.isConstant(k)||F&&!E.isConstant(m)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var B=this._options;B.vertexFormat=y?_.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat;B.rectangle=h.getValue(d.MINIMUM_VALUE,B.rectangle);B.height=i(b)?b.getValue(d.MINIMUM_VALUE):undefined;B.extrudedHeight=i(C)?C.getValue(d.MINIMUM_VALUE):undefined;B.granularity=i(S)?S.getValue(d.MINIMUM_VALUE):undefined;B.stRotation=i(T)?T.getValue(d.MINIMUM_VALUE):undefined;B.rotation=i(R)?R.getValue(d.MINIMUM_VALUE):undefined;B.closeBottom=i(N)?N.getValue(d.MINIMUM_VALUE):undefined;B.closeTop=i(k)?k.getValue(d.MINIMUM_VALUE):undefined;this._isClosed=i(C)&&i(B.closeTop)&&i(B.closeBottom)&&B.closeTop&&B.closeBottom;this._outlineWidth=i(L)?L.getValue(d.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};N.prototype.createDynamicUpdater=function(e,t){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new k(e,t,this)};function k(e,t,r){this._primitives=e;this._groundPrimitives=t;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=r;this._options=new L(r._entity)}k.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._geometryUpdater;var a=n._onTerrain;var s=this._primitives;var l=this._groundPrimitives;if(a){l.removeAndDestroy(this._primitive)}else{s.removeAndDestroy(this._primitive);s.removeAndDestroy(this._outlinePrimitive);this._outlinePrimitive=undefined}this._primitive=undefined;var u=n._entity;var d=u.rectangle;if(!u.isShowing||!u.isAvailable(r)||!E.getValueOrDefault(d.show,r,true)){return}var f=this._options;var m=E.getValueOrUndefined(d.coordinates,r,f.rectangle);if(!i(m)){return}f.rectangle=m;f.height=E.getValueOrUndefined(d.height,r);f.extrudedHeight=E.getValueOrUndefined(d.extrudedHeight,r);f.granularity=E.getValueOrUndefined(d.granularity,r);f.stRotation=E.getValueOrUndefined(d.stRotation,r);f.rotation=E.getValueOrUndefined(d.rotation,r);f.closeBottom=E.getValueOrUndefined(d.closeBottom,r);f.closeTop=E.getValueOrUndefined(d.closeTop,r);var b=this._geometryUpdater.shadowsProperty.getValue(r);if(E.getValueOrDefault(d.fill,r,true)){var w=n.fillMaterialProperty;var C=T.getValue(r,w,this._material);this._material=C;if(a){var S=e.WHITE;if(i(w.color)){S=w.color.getValue(r)}this._primitive=l.add(new v({geometryInstances:new c({id:u,geometry:new h(f),attributes:{color:t.fromColor(S)}}),asynchronous:false,shadows:b}))}else{var x=new g({material:C,translucent:C.isTranslucent(),closed:i(f.extrudedHeight)});f.vertexFormat=x.vertexFormat;this._primitive=s.add(new y({geometryInstances:new c({id:u,geometry:new h(f)}),appearance:x,asynchronous:false,shadows:b}))}}if(!a&&E.getValueOrDefault(d.outline,r,false)){f.vertexFormat=_.VERTEX_FORMAT;var P=E.getValueOrClonedDefault(d.outlineColor,r,e.BLACK,R);var A=E.getValueOrDefault(d.outlineWidth,r,1);var O=P.alpha!==1;this._outlinePrimitive=s.add(new y({geometryInstances:new c({id:u,geometry:new p(f),attributes:{color:t.fromColor(P)}}),appearance:new _({flat:true,translucent:O,renderState:{lineWidth:n._scene.clampLineWidth(A)}}),asynchronous:false,shadows:b}))}};k.prototype.getBoundingSphere=function(e,t){return S(e,this._primitive,this._outlinePrimitive,t)};k.prototype.isDestroyed=function(){return false};k.prototype.destroy=function(){var e=this._primitives;var t=this._groundPrimitives;if(this._geometryUpdater._onTerrain){t.removeAndDestroy(this._primitive)}else{e.removeAndDestroy(this._primitive)}e.removeAndDestroy(this._outlinePrimitive);a(this)};return N});define("DataSources/WallGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Core/WallGeometry","../Core/WallOutlineGeometry","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S){"use strict";var T=new y(e.WHITE);var E=new b(true);var x=new b(true);var P=new b(false);var A=new b(e.BLACK);var O=new b(_.DISABLED);var D=new b(new s);var I=new e;function M(e){this.id=e;this.vertexFormat=undefined;this.positions=undefined;this.minimumHeights=undefined;this.maximumHeights=undefined;this.granularity=undefined}function R(e,t){if(!i(e)){throw new o("entity is required")}if(!i(t)){throw new o("scene is required")}this._entity=e;this._scene=t;this._entitySubscription=e.definitionChanged.addEventListener(R.prototype._onEntityPropertyChanged,this);this._fillEnabled=false;this._dynamic=false;this._outlineEnabled=false;this._geometryChanged=new u;this._showProperty=undefined;this._materialProperty=undefined;this._hasConstantOutline=true;this._showOutlineProperty=undefined;this._outlineColorProperty=undefined;this._outlineWidth=1;this._shadowsProperty=undefined;this._distanceDisplayConditionProperty=undefined;this._options=new M(e);this._onEntityPropertyChanged(e,"wall",e.wall,undefined)}n(R,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:m}});n(R.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return false}},geometryChanged:{get:function(){return this._geometryChanged}}});R.prototype.isOutlineVisible=function(e){var t=this._entity;return this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)};R.prototype.isFilled=function(e){var t=this._entity;return this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)};R.prototype.createFillGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._fillEnabled){throw new o("This instance does not represent a filled geometry.")}var n=this._entity;var a=n.isAvailable(r);var s;var u;var d=new f(a&&n.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r));var p=this._distanceDisplayConditionProperty.getValue(r);var m=l.fromDistanceDisplayCondition(p);if(this._materialProperty instanceof y){var v=e.WHITE;if(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)){v=this._materialProperty.color.getValue(r)}u=t.fromColor(v);s={show:d,distanceDisplayCondition:m,color:u}}else{s={show:d,distanceDisplayCondition:m}}return new c({id:n,geometry:new h(this._options),attributes:s})};R.prototype.createOutlineGeometryInstance=function(r){if(!i(r)){throw new o("time is required.")}if(!this._outlineEnabled){throw new o("This instance does not represent an outlined geometry.")}var n=this._entity;var a=n.isAvailable(r);var s=S.getValueOrDefault(this._outlineColorProperty,r,e.BLACK);var u=this._distanceDisplayConditionProperty.getValue(r);return new c({id:n,geometry:new p(this._options),attributes:{show:new f(a&&n.isShowing&&this._showProperty.getValue(r)&&this._showOutlineProperty.getValue(r)),color:t.fromColor(s),distanceDisplayCondition:l.fromDistanceDisplayCondition(u)}})};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){this._entitySubscription();a(this)};R.prototype._onEntityPropertyChanged=function(e,t,n,a){if(!(t==="availability"||t==="wall")){return}var o=this._entity.wall;if(!i(o)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var s=o.fill;var l=i(s)&&s.isConstant?s.getValue(d.MINIMUM_VALUE):true;var u=o.outline;var c=i(u);if(c&&u.isConstant){c=u.getValue(d.MINIMUM_VALUE)}if(!l&&!c){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var f=o.positions;var h=o.show;if(i(h)&&h.isConstant&&!h.getValue(d.MINIMUM_VALUE)||!i(f)){if(this._fillEnabled||this._outlineEnabled){this._fillEnabled=false;this._outlineEnabled=false;this._geometryChanged.raiseEvent(this)}return}var p=r(o.material,T);var g=p instanceof y;this._materialProperty=p;this._fillProperty=r(s,x);this._showProperty=r(h,E);this._showOutlineProperty=r(o.outline,P);this._outlineColorProperty=c?r(o.outlineColor,A):undefined;this._shadowsProperty=r(o.shadows,O);this._distanceDisplayConditionProperty=r(o.distanceDisplayCondition,D);var _=o.minimumHeights;var b=o.maximumHeights;var w=o.outlineWidth;var C=o.granularity;this._fillEnabled=l;this._outlineEnabled=c;if(!f.isConstant||!S.isConstant(_)||!S.isConstant(b)||!S.isConstant(w)||!S.isConstant(C)){if(!this._dynamic){this._dynamic=true;this._geometryChanged.raiseEvent(this)}}else{var I=this._options;I.vertexFormat=g?v.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat;I.positions=f.getValue(d.MINIMUM_VALUE,I.positions);I.minimumHeights=i(_)?_.getValue(d.MINIMUM_VALUE,I.minimumHeights):undefined;I.maximumHeights=i(b)?b.getValue(d.MINIMUM_VALUE,I.maximumHeights):undefined;I.granularity=i(C)?C.getValue(d.MINIMUM_VALUE):undefined;this._outlineWidth=i(w)?w.getValue(d.MINIMUM_VALUE):1;this._dynamic=false;this._geometryChanged.raiseEvent(this)}};R.prototype.createDynamicUpdater=function(e){if(!this._dynamic){throw new o("This instance does not represent dynamic geometry.")}if(!i(e)){throw new o("primitives is required.")}return new L(e,this)};function L(e,t){this._primitives=e;this._primitive=undefined;this._outlinePrimitive=undefined;this._geometryUpdater=t;this._options=new M(t._entity)}L.prototype.update=function(r){if(!i(r)){throw new o("time is required.")}var n=this._primitives;n.removeAndDestroy(this._primitive);n.removeAndDestroy(this._outlinePrimitive);this._primitive=undefined;this._outlinePrimitive=undefined;var a=this._geometryUpdater;var s=a._entity;var l=s.wall;if(!s.isShowing||!s.isAvailable(r)||!S.getValueOrDefault(l.show,r,true)){return}var u=this._options;var d=S.getValueOrUndefined(l.positions,r,u.positions);if(!i(d)){return}u.positions=d;u.minimumHeights=S.getValueOrUndefined(l.minimumHeights,r,u.minimumHeights);u.maximumHeights=S.getValueOrUndefined(l.maximumHeights,r,u.maximumHeights);u.granularity=S.getValueOrUndefined(l.granularity,r);var f=this._geometryUpdater.shadowsProperty.getValue(r);if(S.getValueOrDefault(l.fill,r,true)){var _=C.getValue(r,a.fillMaterialProperty,this._material);this._material=_;var y=new m({material:_,translucent:_.isTranslucent(),closed:i(u.extrudedHeight)});u.vertexFormat=y.vertexFormat;this._primitive=n.add(new g({geometryInstances:new c({id:s,geometry:new h(u)}),appearance:y,asynchronous:false,shadows:f}))}if(S.getValueOrDefault(l.outline,r,false)){u.vertexFormat=v.VERTEX_FORMAT;var b=S.getValueOrClonedDefault(l.outlineColor,r,e.BLACK,I);var w=S.getValueOrDefault(l.outlineWidth,r,1);var T=b.alpha!==1;this._outlinePrimitive=n.add(new g({geometryInstances:new c({id:s,geometry:new p(u),attributes:{color:t.fromColor(b)}}),appearance:new v({flat:true,translucent:T,renderState:{lineWidth:a._scene.clampLineWidth(w)}}),asynchronous:false,shadows:f}))}};L.prototype.getBoundingSphere=function(e,t){return w(e,this._primitive,this._outlinePrimitive,t)};L.prototype.isDestroyed=function(){return false};L.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive);e.removeAndDestroy(this._outlinePrimitive);a(this)};return R});define("DataSources/DataSourceDisplay",["../Core/BoundingSphere","../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EventHelper","../Scene/GroundPrimitive","./BillboardVisualizer","./BoundingSphereState","./BoxGeometryUpdater","./CorridorGeometryUpdater","./CustomDataSource","./CylinderGeometryUpdater","./EllipseGeometryUpdater","./EllipsoidGeometryUpdater","./GeometryVisualizer","./LabelVisualizer","./ModelVisualizer","./PathVisualizer","./PointVisualizer","./PolygonGeometryUpdater","./PolylineGeometryUpdater","./PolylineVolumeGeometryUpdater","./RectangleGeometryUpdater","./WallGeometryUpdater"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x){"use strict";function P(e){t.typeOf.object("options",e);t.typeOf.object("options.scene",e.scene);t.typeOf.object("options.dataSourceCollection",e.dataSourceCollection);l.initializeTerrainHeights();var i=e.scene;var n=e.dataSourceCollection;this._eventHelper=new s;this._eventHelper.add(n.dataSourceAdded,this._onDataSourceAdded,this);this._eventHelper.add(n.dataSourceRemoved,this._onDataSourceRemoved,this);this._dataSourceCollection=n;this._scene=i;this._visualizersCallback=r(e.visualizersCallback,P.defaultVisualizersCallback);for(var a=0,o=n.length;a<o;a++){this._onDataSourceAdded(n,n.get(a))}var u=new h;this._onDataSourceAdded(undefined,u);this._defaultDataSource=u;this._ready=false}P.defaultVisualizersCallback=function(e,t,r){var i=r.entities;return[new u(t,i),new g(d,e,i),new g(p,e,i),new g(f,e,i),new g(m,e,i),new g(v,e,i),new g(C,e,i),new g(S,e,i),new g(T,e,i),new g(E,e,i),new g(x,e,i),new _(t,i),new y(e,i),new w(t,i),new b(e,i)]};n(P.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}});P.prototype.isDestroyed=function(){return false};P.prototype.destroy=function(){this._eventHelper.removeAll();var e=this._dataSourceCollection;for(var t=0,r=e.length;t<r;++t){this._onDataSourceRemoved(this._dataSourceCollection,e.get(t))}this._onDataSourceRemoved(undefined,this._defaultDataSource);return a(this)};P.prototype.update=function(e){if(!i(e)){throw new o("time is required.")}if(!l._initialized){this._ready=false;return false}var t=true;var r;var n;var a;var s;var u=this._dataSourceCollection;var c=u.length;for(r=0;r<c;r++){var d=u.get(r);if(i(d.update)){t=d.update(e)&&t}a=d._visualizers;s=a.length;for(n=0;n<s;n++){t=a[n].update(e)&&t}}a=this._defaultDataSource._visualizers;s=a.length;for(n=0;n<s;n++){t=a[n].update(e)&&t}this._ready=t;return t};var A=[];var O=new e;P.prototype.getBoundingSphere=function(t,r,n){if(!i(t)){throw new o("entity is required.")}if(!i(r)){throw new o("allowPartial is required.")}if(!i(n)){throw new o("result is required.")}if(!this._ready){return c.PENDING}var a;var s;var l=this._defaultDataSource;if(!l.entities.contains(t)){l=undefined;var u=this._dataSourceCollection;s=u.length;for(a=0;a<s;a++){var d=u.get(a);if(d.entities.contains(t)){l=d;break}}}if(!i(l)){return c.FAILED}var f=A;var h=O;var p=0;var m=c.DONE;var v=l._visualizers;var g=v.length;for(a=0;a<g;a++){var _=v[a];if(i(_.getBoundingSphere)){m=v[a].getBoundingSphere(t,h);if(!r&&m===c.PENDING){return c.PENDING}else if(m===c.DONE){f[p]=e.clone(h,f[p]);p++}}}if(p===0){return c.FAILED}f.length=p;e.fromBoundingSpheres(f,n);return c.DONE};P.prototype._onDataSourceAdded=function(e,t){var r=this._scene;var i=t.clustering;i._initialize(r);r.primitives.add(i);t._visualizers=this._visualizersCallback(r,i,t)};P.prototype._onDataSourceRemoved=function(e,t){var r=this._scene;var i=t.clustering;r.primitives.remove(i);var n=t._visualizers;var a=n.length;for(var o=0;o<a;o++){n[o].destroy()}t._visualizers=undefined};return P});define("DataSources/DynamicGeometryUpdater",["../Core/DeveloperError"],function(e){"use strict";function t(){e.throwInstantiationError()}t.prototype.update=e.throwInstantiationError;t.prototype.getBoundingSphere=e.throwInstantiationError;t.prototype.isDestroyed=e.throwInstantiationError;t.prototype.destroy=e.throwInstantiationError;return t});define("DataSources/EntityView",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/HeadingPitchRange","../Core/JulianDate","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Transforms","../Scene/SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";var h=new u;var p=new u;var m=new u;var v=new c;var g=new e;var _=new e;var y=new e;var b=new e;var w=new e;var C=new e;var S=new s;var T=1.25;function E(t,i,n,a,o,c,E){var x=t.scene.mode;var P=o.getValue(c,t._lastCartesian);if(r(P)){var A=false;var O=false;var D;var I;var M;if(x===f.SCENE3D){s.addSeconds(c,.001,S);var R=o.getValue(S,g);if(!r(R)){s.addSeconds(c,-.001,S);R=o.getValue(S,g);O=true}if(r(R)){var L=d.computeFixedToIcrfMatrix(c,h);var N=d.computeFixedToIcrfMatrix(S,p);var k;if(!r(L)||!r(N)){k=d.computeTemeToPseudoFixedMatrix(c,m);L=u.transpose(k,h);N=d.computeTemeToPseudoFixedMatrix(S,p);u.transpose(N,N)}else{k=u.transpose(L,m)}var F=u.multiplyByVector(L,P,w);var B=u.multiplyByVector(N,R,C);e.subtract(F,B,b);var U=e.magnitude(b)*1e3;var V=3986004418e5;var z=-V/(U*U-2*V/e.magnitude(F));if(z<0||z>T*E.maximumRadius){D=_;e.normalize(P,D);e.negate(D,D);M=e.clone(e.UNIT_Z,y);I=e.cross(M,D,g);if(e.magnitude(I)>l.EPSILON7){e.normalize(D,D);e.normalize(I,I);M=e.cross(D,I,y);e.normalize(M,M);A=true}}else if(!e.equalsEpsilon(P,R,l.EPSILON7)){M=_;e.normalize(F,M);e.normalize(B,B);I=e.cross(M,B,y);if(O){I=e.multiplyByScalar(I,-1,I)}if(!e.equalsEpsilon(I,e.ZERO,l.EPSILON7)){D=e.cross(I,M,g);u.multiplyByVector(k,D,D);u.multiplyByVector(k,I,I);u.multiplyByVector(k,M,M);e.normalize(D,D);e.normalize(I,I);e.normalize(M,M);A=true}}}}if(r(t.boundingSphere)){P=t.boundingSphere.center}var q;var G;var H;if(a){q=e.clone(i.position,b);G=e.clone(i.direction,w);H=e.clone(i.up,C)}var j=v;if(A){j[0]=D.x;j[1]=D.y;j[2]=D.z;j[3]=0;j[4]=I.x;j[5]=I.y;j[6]=I.z;j[7]=0;j[8]=M.x;j[9]=M.y;j[10]=M.z;j[11]=0;j[12]=P.x;j[13]=P.y;j[14]=P.z;j[15]=0}else{d.eastNorthUpToFixedFrame(P,E,j)}i._setTransform(j);if(a){e.clone(q,i.position);e.clone(G,i.direction);e.clone(H,i.up);e.cross(G,H,i.right)}}if(n){var W=x===f.SCENE2D||e.equals(t._offset3D,e.ZERO)?undefined:t._offset3D;i.lookAtTransform(i.transform,W)}}function x(r,i,n){this.entity=r;this.scene=i;this.ellipsoid=t(n,a.WGS84);this.boundingSphere=undefined;this._lastEntity=undefined;this._mode=undefined;this._lastCartesian=new e;this._defaultOffset3D=undefined;this._offset3D=new e}i(x,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(t){this._defaultOffset3D=e.clone(t,new e)}}});x.defaultOffset3D=new e(-14e3,3500,3500);var P=new o;var A=new e;x.prototype.update=function(t,i){var a=this.scene;var o=this.entity;var s=this.ellipsoid;if(!r(t)){throw new n("time is required.")}if(!r(a)){throw new n("EntityView.scene is required.")}if(!r(o)){throw new n("EntityView.entity is required.")}if(!r(s)){throw new n("EntityView.ellipsoid is required.")}if(!r(o.position)){throw new n("entity.position is required.")}var u=a.mode;if(u===f.MORPHING){return}var c=o.position;var d=o!==this._lastEntity;var h=u!==this._mode;var p=this._offset3D;var m=a.camera;var v=d||h;var g=true;if(d){var _=o.viewFrom;var y=r(_);if(!y&&r(i)){P.pitch=-l.PI_OVER_FOUR;P.range=0;var b=c.getValue(t,A);if(r(b)){var w=2-1/Math.max(1,e.magnitude(b)/s.maximumRadius);P.pitch*=w}m.viewBoundingSphere(i,P);this.boundingSphere=i;v=false;g=false}else if(!y||!r(_.getValue(t,p))){e.clone(x._defaultOffset3D,p)}}else if(!h&&a.mode!==f.MORPHING&&this._mode!==f.SCENE2D){e.clone(m.position,p)}this._lastEntity=o;this._mode=a.mode!==f.MORPHING?a.mode:this._mode;if(a.mode!==f.MORPHING){E(this,m,v,g,c,t,s)}};return x});!function(){var e={version:"1.6.18",mesh:function(e){return s(e,r.apply(this,arguments))},meshArcs:r,merge:function(e){return s(e,i.apply(this,arguments))},mergeArcs:i,feature:a,neighbors:c,presimplify:d};function t(e,t){var r={},i={},n={},a=[],o=-1;t.forEach(function(r,i){var n=e.arcs[r<0?~r:r],a;if(n.length<3&&!n[1][0]&&!n[1][1]){a=t[++o],t[o]=r,t[i]=a}});t.forEach(function(e){var t=s(e),r=t[0],a=t[1],o,l;if(o=n[r]){delete n[o.end];o.push(e);o.end=a;if(l=i[a]){delete i[l.start];var u=l===o?o:o.concat(l);i[u.start=o.start]=n[u.end=l.end]=u}else{i[o.start]=n[o.end]=o}}else if(o=i[a]){delete i[o.start];o.unshift(e);o.start=r;if(l=n[r]){delete n[l.end];var c=l===o?o:l.concat(o);i[c.start=l.start]=n[c.end=o.end]=c}else{i[o.start]=n[o.end]=o}}else{o=[e];i[o.start=r]=n[o.end=a]=o}});function s(t){var r=e.arcs[t<0?~t:t],i=r[0],n;if(e.transform)n=[0,0],r.forEach(function(e){n[0]+=e[0],n[1]+=e[1]});else n=r[r.length-1];return t<0?[n,i]:[i,n]}function l(e,t){for(var i in e){var n=e[i];delete t[n.start];delete n.start;delete n.end;n.forEach(function(e){r[e<0?~e:e]=1});a.push(n)}}l(n,i);l(i,n);t.forEach(function(e){if(!r[e<0?~e:e])a.push([e])});return a}function r(e,r,i){var n=[];if(arguments.length>1){var a=[],o;function s(e){var t=e<0?~e:e;(a[t]||(a[t]=[])).push({i:e,g:o})}function l(e){e.forEach(s)}function u(e){e.forEach(l)}function c(e){if(e.type==="GeometryCollection")e.geometries.forEach(c);else if(e.type in d)o=e,d[e.type](e.arcs)}var d={LineString:l,MultiLineString:u,Polygon:u,MultiPolygon:function(e){e.forEach(u)}};c(r);a.forEach(arguments.length<3?function(e){n.push(e[0].i)}:function(e){if(i(e[0].g,e[e.length-1].g))n.push(e[0].i)})}else{for(var f=0,h=e.arcs.length;f<h;++f)n.push(f)}return{type:"MultiLineString",arcs:t(e,n)}}function i(e,r){var i={},a=[],o=[];r.forEach(function(e){if(e.type==="Polygon")l(e.arcs);else if(e.type==="MultiPolygon")e.arcs.forEach(l)});function l(e){e.forEach(function(t){t.forEach(function(t){(i[t=t<0?~t:t]||(i[t]=[])).push(e)})});a.push(e)}function u(t){return f(s(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}a.forEach(function(e){if(!e._){var t=[],r=[e];e._=1;o.push(t);while(e=r.pop()){t.push(e);e.forEach(function(e){e.forEach(function(e){i[e<0?~e:e].forEach(function(e){if(!e._){e._=1;r.push(e)}})})})}}});a.forEach(function(e){delete e._});return{type:"MultiPolygon",arcs:o.map(function(r){var a=[];r.forEach(function(e){e.forEach(function(e){e.forEach(function(e){if(i[e<0?~e:e].length<2){a.push(e)}})})});a=t(e,a);if((n=a.length)>1){var o=u(r[0][0]);for(var s=0,l;s<n;++s){if(o===u(a[s])){l=a[0],a[0]=a[s],a[s]=l;break}}}return a})}}function a(e,t){return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(t){return o(e,t)})}:o(e,t)}function o(e,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:s(e,t)};if(t.id==null)delete r.id;return r}function s(e,t){var r=v(e.transform),i=e.arcs;function n(e,t){if(t.length)t.pop();for(var n=i[e<0?~e:e],a=0,o=n.length,s;a<o;++a){t.push(s=n[a].slice());r(s,a)}if(e<0)l(t,o)}function a(e){e=e.slice();r(e,0);return e}function o(e){var t=[];for(var r=0,i=e.length;r<i;++r)n(e[r],t);if(t.length<2)t.push(t[0].slice());return t}function s(e){var t=o(e);while(t.length<4)t.push(t[0].slice());return t}function u(e){return e.map(s)}function c(e){var t=e.type;return t==="GeometryCollection"?{type:t,geometries:e.geometries.map(c)}:t in d?{type:t,coordinates:d[t](e)}:null}var d={Point:function(e){return a(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(a)},LineString:function(e){return o(e.arcs)},MultiLineString:function(e){return e.arcs.map(o)},Polygon:function(e){return u(e.arcs)},MultiPolygon:function(e){return e.arcs.map(u)}};return c(t)}function l(e,t){var r,i=e.length,n=i-t;while(n<--i)r=e[n],e[n++]=e[i],e[i]=r}function u(e,t){var r=0,i=e.length;while(r<i){var n=r+i>>>1;if(e[n]<t)r=n+1;else i=n}return r}function c(e){var t={},r=e.map(function(){return[]});function i(e,r){e.forEach(function(e){if(e<0)e=~e;var i=t[e];if(i)i.push(r);else t[e]=[r]})}function n(e,t){e.forEach(function(e){i(e,t)})}function a(e,t){if(e.type==="GeometryCollection")e.geometries.forEach(function(e){a(e,t)});else if(e.type in o)o[e.type](e.arcs,t)}var o={LineString:i,MultiLineString:n,Polygon:n,MultiPolygon:function(e,t){e.forEach(function(e){n(e,t)})}};e.forEach(a);for(var s in t){for(var l=t[s],c=l.length,d=0;d<c;++d){for(var f=d+1;f<c;++f){var h=l[d],p=l[f],m;if((m=r[h])[s=u(m,p)]!==p)m.splice(s,0,p);if((m=r[p])[s=u(m,h)]!==h)m.splice(s,0,h)}}}return r}function d(e,t){var r=v(e.transform),i=g(e.transform),n=m();if(!t)t=h;e.arcs.forEach(function(e){var o=[],s=0,l;for(var u=0,c=e.length,d;u<c;++u){d=e[u];r(e[u]=[d[0],d[1],Infinity],u)}for(var u=1,c=e.length-1;u<c;++u){l=e.slice(u-1,u+2);l[1][2]=t(l);o.push(l);n.push(l)}for(var u=0,c=o.length;u<c;++u){l=o[u];l.previous=o[u-1];l.next=o[u+1]}while(l=n.pop()){var f=l.previous,h=l.next;if(l[1][2]<s)l[1][2]=s;else s=l[1][2];if(f){f.next=h;f[2]=l[2];a(f)}if(h){h.previous=f;h[0]=l[0];a(h)}}e.forEach(i)});function a(e){n.remove(e);e[1][2]=t(e);n.push(e)}return e}function f(e){var t=-1,r=e.length,i,n=e[r-1],a=0;while(++t<r){i=n;n=e[t];a+=i[0]*n[1]-i[1]*n[0]}return a*.5}function h(e){var t=e[0],r=e[1],i=e[2];return Math.abs((t[0]-i[0])*(r[1]-t[1])-(t[0]-r[0])*(i[1]-t[1]))}function p(e,t){return e[1][2]-t[1][2]}function m(){var e={},t=[],r=0;e.push=function(e){i(t[e._=r]=e,r++);return r};e.pop=function(){if(r<=0)return;var e=t[0],i;if(--r>0)i=t[r],n(t[i._=0]=i,0);return e};e.remove=function(e){var a=e._,o;if(t[a]!==e)return;if(a!==--r)o=t[r],(p(o,e)<0?i:n)(t[o._=a]=o,a);return a};function i(e,r){while(r>0){var i=(r+1>>1)-1,n=t[i];if(p(e,n)>=0)break;t[n._=r]=n;t[e._=r=i]=e}}function n(e,i){while(true){var n=i+1<<1,a=n-1,o=i,s=t[o];if(a<r&&p(t[a],s)<0)s=t[o=a];if(n<r&&p(t[n],s)<0)s=t[o=n];if(o===i)break;t[s._=i]=s;t[e._=i=o]=e}}return e}function v(e){if(!e)return _;var t,r,i=e.scale[0],n=e.scale[1],a=e.translate[0],o=e.translate[1];return function(e,s){if(!s)t=r=0;e[0]=(t+=e[0])*i+a;e[1]=(r+=e[1])*n+o}}function g(e){if(!e)return _;var t,r,i=e.scale[0],n=e.scale[1],a=e.translate[0],o=e.translate[1];return function(e,s){if(!s)t=r=0;var l=(e[0]-a)/i|0,u=(e[1]-o)/n|0;e[0]=l-t;e[1]=u-r;t=l;r=u}}function _(){}if(typeof define==="function"&&define.amd)define("ThirdParty/topojson",e);else if(typeof module==="object"&&module.exports)module.exports=e;else this.topojson=e}();define("DataSources/GeoJsonDataSource",["../Core/Cartesian3","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/getFilenameFromUri","../Core/loadJson","../Core/PinBuilder","../Core/PolygonHierarchy","../Core/RuntimeError","../Scene/HeightReference","../Scene/VerticalOrigin","../ThirdParty/topojson","../ThirdParty/when","./BillboardGraphics","./CallbackProperty","./ColorMaterialProperty","./ConstantPositionProperty","./ConstantProperty","./CorridorGraphics","./DataSource","./EntityCluster","./EntityCollection","./PolygonGraphics","./PolylineGraphics"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P){"use strict";function A(t){return e.fromDegrees(t[0],t[1],t[2])}var O={"urn:ogc:def:crs:OGC:1.3:CRS84":A,"EPSG:4326":A,"urn:ogc:def:crs:EPSG::4326":A};var D={};var I={};var M=48;var R;var L=t.ROYALBLUE;var N=t.YELLOW;var k=2;var F=t.fromBytes(255,255,0,100);var B=false;var U={small:24,medium:48,large:64};var V=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function z(e,t){var r="";for(var i in e){if(e.hasOwnProperty(i)){if(i===t||V.indexOf(i)!==-1){continue}var a=e[i];if(n(a)){if(typeof a==="object"){r+="<tr><th>"+i+"</th><td>"+z(a)+"</td></tr>"}else{r+="<tr><th>"+i+"</th><td>"+a+"</td></tr>"}}}}if(r.length>0){r='<table class="cesium-infoBox-defaultTable"><tbody>'+r+"</tbody></table>"}return r}function q(e,t,r){var i;return function(a,o){if(!n(i)){i=e(t,r)}return i}}function G(e,t){return new _(q(z,e,t),true)}function H(e,t,i){var a=e.id;if(!n(a)||e.type!=="Feature"){a=r()}else{var o=2;var s=a;while(n(t.getById(s))){s=a+"_"+o;o++}a=s}var l=t.getOrCreateEntity(a);var u=e.properties;if(n(u)){l.properties=u;var c;var d=u.title;if(n(d)){l.name=d;c="title"}else{var f=Number.MAX_VALUE;for(var h in u){if(u.hasOwnProperty(h)&&u[h]){var p=h.toLowerCase();if(f>1&&p==="title"){f=1;c=h;break}else if(f>2&&p==="name"){f=2;c=h}else if(f>3&&/title/i.test(h)){f=3;c=h}else if(f>4&&/name/i.test(h)){f=4;c=h}}}if(n(c)){l.name=u[c]}}var m=u.description;if(m!==null){l.description=!n(m)?i(u,c):new w(m)}}return l}function j(e,t){var r=new Array(e.length);for(var i=0;i<e.length;i++){r[i]=t(e[i])}return r}var W={Feature:X,FeatureCollection:Q,GeometryCollection:Z,LineString:te,MultiLineString:re,MultiPoint:$,MultiPolygon:ae,Point:J,Polygon:ne,Topology:oe};var Y={GeometryCollection:Z,LineString:te,MultiLineString:re,MultiPoint:$,MultiPolygon:ae,Point:J,Polygon:ne,Topology:oe};function X(e,t,r,i,a){if(t.geometry===null){H(t,e._entityCollection,a.describe);return}if(!n(t.geometry)){throw new f("feature.geometry is required.")}var o=t.geometry.type;var s=Y[o];if(!n(s)){throw new f("Unknown geometry type: "+o)}s(e,t,t.geometry,i,a)}function Q(e,t,r,i,n){var a=t.features;for(var o=0,s=a.length;o<s;o++){X(e,a[o],undefined,i,n)}}function Z(e,t,r,i,a){var o=r.geometries;for(var s=0,l=o.length;s<l;s++){var u=o[s];var c=u.type;var d=Y[c];if(!n(d)){throw new f("Unknown geometry type: "+c)}d(e,t,u,i,a)}}function K(e,r,a,o,s){var l=s.markerSymbol;var u=s.markerColor;var c=s.markerSize;var d=r.properties;if(n(d)){var f=d["marker-color"];if(n(f)){u=t.fromCssColorString(f)}c=i(U[d["marker-size"]],c);var m=d["marker-symbol"];if(n(m)){l=m}}var _;if(n(l)){if(l.length===1){_=e._pinBuilder.fromText(l.toUpperCase(),u,c)}else{_=e._pinBuilder.fromMakiIconId(l,u,c)}}else{_=e._pinBuilder.fromColor(u,c)}var y=new g;y.verticalOrigin=new w(p.BOTTOM);if(o.length===2&&s.clampToGround){y.heightReference=h.CLAMP_TO_GROUND}var C=H(r,e._entityCollection,s.describe);C.billboard=y;C.position=new b(a(o));var S=v(_).then(function(e){y.image=new w(e)}).otherwise(function(){y.image=new w(e._pinBuilder.fromColor(u,c))});e._promises.push(S)}function J(e,t,r,i,n){K(e,t,i,r.coordinates,n)}function $(e,t,r,i,n){var a=r.coordinates;for(var o=0;o<a.length;o++){K(e,t,i,a[o],n)}}function ee(e,r,i,a,o){var s=o.strokeMaterialProperty;var l=o.strokeWidthProperty;var u=r.properties;if(n(u)){var c=u["stroke-width"];if(n(c)){l=new w(c)}var d;var f=u.stroke;if(n(f)){d=t.fromCssColorString(f)}var h=u["stroke-opacity"];if(n(h)&&h!==1){if(!n(d)){d=s.color.clone()}d.alpha=h}if(n(d)){s=new y(d)}}var p=H(r,e._entityCollection,o.describe);var m;if(o.clampToGround){m=new C;p.corridor=m}else{m=new P;p.polyline=m}m.material=s;m.width=l;m.positions=new w(j(a,i))}function te(e,t,r,i,n){ee(e,t,i,r.coordinates,n)}function re(e,t,r,i,n){var a=r.coordinates;for(var o=0;o<a.length;o++){ee(e,t,i,a[o],n)}}function ie(e,r,i,a,o){if(a.length===0||a[0].length===0){return}var s=o.strokeMaterialProperty.color;var l=o.fillMaterialProperty;var u=o.strokeWidthProperty;var c=r.properties;if(n(c)){var f=c["stroke-width"];if(n(f)){u=new w(f)}var h;var p=c.stroke;if(n(p)){h=t.fromCssColorString(p)}var m=c["stroke-opacity"];if(n(m)&&m!==1){if(!n(h)){h=o.strokeMaterialProperty.color.clone()}h.alpha=m}if(n(h)){s=new w(h)}var v;var g=c.fill;if(n(g)){v=t.fromCssColorString(g);v.alpha=l.color.alpha}m=c["fill-opacity"];if(n(m)&&m!==l.color.alpha){if(!n(v)){v=l.color.clone()}v.alpha=m}if(n(v)){l=new y(v)}}var _=new x;_.outline=new w(true);_.outlineColor=s;_.outlineWidth=u;_.material=l;var b=[];for(var C=1,S=a.length;C<S;C++){b.push(new d(j(a[C],i)))}var T=a[0];_.hierarchy=new w(new d(j(T,i),b));if(T[0].length>2){_.perPositionHeight=new w(true)}else if(!o.clampToGround){_.height=0}var E=H(r,e._entityCollection,o.describe);E.polygon=_}function ne(e,t,r,i,n){ie(e,t,i,r.coordinates,n)}function ae(e,t,r,i,n){var a=r.coordinates;for(var o=0;o<a.length;o++){ie(e,t,i,a[o],n)}}function oe(e,t,r,i,n){for(var a in r.objects){if(r.objects.hasOwnProperty(a)){var o=m.feature(r,r.objects[a]);var s=W[o.type];s(e,o,o,i,n)}}}function se(e){this._name=e;this._changed=new s;this._error=new s;this._isLoading=false;this._loading=new s;this._entityCollection=new E(this);this._promises=[];this._pinBuilder=new c;this._entityCluster=new T}se.load=function(e,t){return(new se).load(e,t)};a(se,{markerSize:{get:function(){return M},set:function(e){M=e}},markerSymbol:{get:function(){return R},set:function(e){R=e}},markerColor:{get:function(){return L},set:function(e){L=e}},stroke:{get:function(){return N},set:function(e){N=e}},strokeWidth:{get:function(){return k},set:function(e){k=e}},fill:{get:function(){return F},set:function(e){F=e}},clampToGround:{get:function(){return B},set:function(e){B=e}},crsNames:{get:function(){return O}},crsLinkHrefs:{get:function(){return D}},crsLinkTypes:{get:function(){return I}}});a(se.prototype,{name:{get:function(){return this._name},set:function(e){if(this._name!==e){this._name=e;this._changed.raiseEvent(this)}}},clock:{value:undefined,writable:false},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!n(e)){throw new o("value must be defined.")}this._entityCluster=e}}});se.prototype.load=function(e,t){if(!n(e)){throw new o("data is required.")}S.setLoading(this,true);var r=e;t=i(t,i.EMPTY_OBJECT);var a=t.sourceUri;if(typeof e==="string"){if(!n(a)){a=e}r=u(e)}t={describe:i(t.describe,G),markerSize:i(t.markerSize,M),markerSymbol:i(t.markerSymbol,R),markerColor:i(t.markerColor,L),strokeWidthProperty:new w(i(t.strokeWidth,k)),strokeMaterialProperty:new y(i(t.stroke,N)),fillMaterialProperty:new y(i(t.fill,F)),clampToGround:i(t.clampToGround,B)};var s=this;return v(r,function(e){return le(s,e,t,a)}).otherwise(function(e){S.setLoading(s,false);s._error.raiseEvent(s,e);console.log(e);return v.reject(e)})};function le(e,t,r,i){var a;if(n(i)){a=l(i)}if(n(a)&&e._name!==a){e._name=a;e._changed.raiseEvent(e)}var o=W[t.type];if(!n(o)){throw new f("Unsupported GeoJSON object type: "+t.type)}var s=t.crs;var u=s!==null?A:null;if(n(s)){if(!n(s.properties)){throw new f("crs.properties is undefined.")}var c=s.properties;if(s.type==="name"){u=O[c.name];if(!n(u)){throw new f("Unknown crs name: "+c.name)}}else if(s.type==="link"){var d=D[c.href];if(!n(d)){d=I[c.type]}if(!n(d)){throw new f("Unable to resolve crs link: "+JSON.stringify(c))}u=d(c)}else if(s.type==="EPSG"){u=O["EPSG:"+c.code];if(!n(u)){throw new f("Unknown crs EPSG code: "+c.code)}}else{throw new f("Unknown crs type: "+s.type)}}return v(u,function(i){e._entityCollection.removeAll();if(i!==null){o(e,t,t,i,r)}return v.all(e._promises,function(){e._promises.length=0;S.setLoading(e,false);return e})})}return se});define("DataSources/GeometryUpdater",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(e,r){t.throwInstantiationError()}e(r,{perInstanceColorAppearanceType:{get:t.throwInstantiationError},materialAppearanceType:{get:t.throwInstantiationError}});e(r.prototype,{entity:{get:t.throwInstantiationError},fillEnabled:{get:t.throwInstantiationError},hasConstantFill:{get:t.throwInstantiationError},fillMaterialProperty:{get:t.throwInstantiationError},outlineEnabled:{get:t.throwInstantiationError},hasConstantOutline:{get:t.throwInstantiationError},outlineColorProperty:{get:t.throwInstantiationError},outlineWidth:{get:t.throwInstantiationError},isDynamic:{get:t.throwInstantiationError},isClosed:{get:t.throwInstantiationError},geometryChanged:{get:t.throwInstantiationError}});r.prototype.isOutlineVisible=t.throwInstantiationError;r.prototype.isFilled=t.throwInstantiationError;r.prototype.createFillGeometryInstance=t.throwInstantiationError;r.prototype.createOutlineGeometryInstance=t.throwInstantiationError;r.prototype.isDestroyed=t.throwInstantiationError;r.prototype.destroy=t.throwInstantiationError;r.prototype.createDynamicUpdater=t.throwInstantiationError;return r});(function(e,t){if(typeof define==="function"&&define.amd){define("ThirdParty/Autolinker",[],function(){return e["Autolinker"]=t()})}else if(typeof exports==="object"){module.exports=t()}else{e["Autolinker"]=t()}})(this,function(){var e=function(t){e.Util.assign(this,t);var r=this.hashtag;if(r!==false&&r!=="twitter"&&r!=="facebook"){throw new Error("invalid `hashtag` cfg - see docs")}};e.prototype={constructor:e,urls:true,email:true,twitter:true,phone:true,hashtag:false,newWindow:true,stripPrefix:true,truncate:undefined,className:"",htmlParser:undefined,matchParser:undefined,tagBuilder:undefined,link:function(e){var t=this.getHtmlParser(),r=t.parse(e),i=0,n=[];for(var a=0,o=r.length;a<o;a++){var s=r[a],l=s.getType(),u=s.getText();if(l==="element"){if(s.getTagName()==="a"){if(!s.isClosing()){i++}else{i=Math.max(i-1,0)}}n.push(u)}else if(l==="entity"||l==="comment"){n.push(u)}else{if(i===0){var c=this.linkifyStr(u);n.push(c)}else{n.push(u)}}}return n.join("")},linkifyStr:function(e){return this.getMatchParser().replace(e,this.createMatchReturnVal,this)},createMatchReturnVal:function(t){var r;if(this.replaceFn){r=this.replaceFn.call(this,this,t)}if(typeof r==="string"){return r}else if(r===false){return t.getMatchedText()}else if(r instanceof e.HtmlTag){return r.toAnchorString()}else{var i=this.getTagBuilder(),n=i.build(t);return n.toAnchorString()}},getHtmlParser:function(){var t=this.htmlParser;if(!t){t=this.htmlParser=new e.htmlParser.HtmlParser}return t},getMatchParser:function(){var t=this.matchParser;if(!t){t=this.matchParser=new e.matchParser.MatchParser({urls:this.urls,email:this.email,twitter:this.twitter,phone:this.phone,hashtag:this.hashtag,stripPrefix:this.stripPrefix})}return t},getTagBuilder:function(){var t=this.tagBuilder;if(!t){t=this.tagBuilder=new e.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})}return t}};e.link=function(t,r){var i=new e(r);return i.link(t)};e.match={};e.htmlParser={};e.matchParser={};e.Util={abstractMethod:function(){throw"abstract"},trimRegex:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,assign:function(e,t){for(var r in t){if(t.hasOwnProperty(r)){e[r]=t[r]}}return e},extend:function(t,r){var i=t.prototype;var n=function(){};n.prototype=i;var a;if(r.hasOwnProperty("constructor")){a=r.constructor}else{a=function(){i.constructor.apply(this,arguments)}}var o=a.prototype=new n;o.constructor=a;o.superclass=i;delete r.constructor;e.Util.assign(o,r);return a},ellipsis:function(e,t,r){if(e.length>t){r=r==null?"..":r;e=e.substring(0,t-r.length)+r}return e},indexOf:function(e,t){if(Array.prototype.indexOf){return e.indexOf(t)}else{for(var r=0,i=e.length;r<i;r++){if(e[r]===t)return r}return-1}},splitAndCapture:function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");var r=[],i=0,n;while(n=t.exec(e)){r.push(e.substring(i,n.index));r.push(n[0]);i=n.index+n[0].length}r.push(e.substring(i));return r},trim:function(e){return e.replace(this.trimRegex,"")}};e.HtmlTag=e.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(t){e.Util.assign(this,t);this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(e){this.tagName=e;return this},getTagName:function(){return this.tagName||""},setAttr:function(e,t){var r=this.getAttrs();r[e]=t;return this},getAttr:function(e){return this.getAttrs()[e]},setAttrs:function(t){var r=this.getAttrs();e.Util.assign(r,t);return this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(e){return this.setAttr("class",e)},addClass:function(t){var r=this.getClass(),i=this.whitespaceRegex,n=e.Util.indexOf,a=!r?[]:r.split(i),o=t.split(i),s;while(s=o.shift()){if(n(a,s)===-1){a.push(s)}}this.getAttrs()["class"]=a.join(" ");return this},removeClass:function(t){var r=this.getClass(),i=this.whitespaceRegex,n=e.Util.indexOf,a=!r?[]:r.split(i),o=t.split(i),s;while(a.length&&(s=o.shift())){var l=n(a,s);if(l!==-1){a.splice(l,1)}}this.getAttrs()["class"]=a.join(" ");return this},getClass:function(){return this.getAttrs()["class"]||""},hasClass:function(e){return(" "+this.getClass()+" ").indexOf(" "+e+" ")!==-1},setInnerHtml:function(e){this.innerHtml=e;return this},getInnerHtml:function(){return this.innerHtml||""},toAnchorString:function(){var e=this.getTagName(),t=this.buildAttrsStr();t=t?" "+t:"";return["<",e,t,">",this.getInnerHtml(),"</",e,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var r in e){if(e.hasOwnProperty(r)){t.push(r+'="'+e[r]+'"')}}return t.join(" ")}});e.AnchorTagBuilder=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},build:function(t){var r=new e.HtmlTag({tagName:"a",attrs:this.createAttrs(t.getType(),t.getAnchorHref()),innerHtml:this.processAnchorText(t.getAnchorText())});return r},createAttrs:function(e,t){var r={href:t};var i=this.createCssClass(e);if(i){r["class"]=i}if(this.newWindow){r["target"]="_blank"}return r},createCssClass:function(e){var t=this.className;if(!t)return"";else return t+" "+t+"-"+e},processAnchorText:function(e){e=this.doTruncate(e);return e},doTruncate:function(t){return e.Util.ellipsis(t,this.truncate||Number.POSITIVE_INFINITY)}});e.htmlParser.HtmlParser=e.Util.extend(Object,{htmlRegex:function(){var e=/!--([\s\S]+?)--/,t=/[0-9a-zA-Z][0-9a-zA-Z:]*/,r=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,i=/(?:"[^"]*?"|'[^']*?'|[^'"=<>`\s]+)/,n=r.source+"(?:\\s*=\\s*"+i.source+")?";return new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",n,"|",i.source+")",")*",">",")","|","(?:","<(/)?","(?:",e.source,"|","(?:","("+t.source+")","(?:","\\s+",n,")*","\\s*/?",")",")",">",")"].join(""),"gi")}(),htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,parse:function(e){var t=this.htmlRegex,r,i=0,n,a=[];while((r=t.exec(e))!==null){var o=r[0],s=r[3],l=r[1]||r[4],u=!!r[2],c=e.substring(i,r.index);if(c){n=this.parseTextAndEntityNodes(c);a.push.apply(a,n)}if(s){a.push(this.createCommentNode(o,s))}else{a.push(this.createElementNode(o,l,u))}i=r.index+o.length}if(i<e.length){var d=e.substring(i);if(d){n=this.parseTextAndEntityNodes(d);a.push.apply(a,n)}}return a},parseTextAndEntityNodes:function(t){var r=[],i=e.Util.splitAndCapture(t,this.htmlCharacterEntitiesRegex);for(var n=0,a=i.length;n<a;n+=2){var o=i[n],s=i[n+1];if(o)r.push(this.createTextNode(o));if(s)r.push(this.createEntityNode(s))}return r},createCommentNode:function(t,r){return new e.htmlParser.CommentNode({text:t,comment:e.Util.trim(r)})},createElementNode:function(t,r,i){return new e.htmlParser.ElementNode({text:t,tagName:r.toLowerCase(),closing:i})},createEntityNode:function(t){return new e.htmlParser.EntityNode({text:t})},createTextNode:function(t){return new e.htmlParser.TextNode({text:t})}});e.htmlParser.HtmlNode=e.Util.extend(Object,{text:"",constructor:function(t){e.Util.assign(this,t)},getType:e.Util.abstractMethod,getText:function(){return this.text}});e.htmlParser.CommentNode=e.Util.extend(e.htmlParser.HtmlNode,{comment:"",getType:function(){return"comment"},getComment:function(){return this.comment}});e.htmlParser.ElementNode=e.Util.extend(e.htmlParser.HtmlNode,{tagName:"",closing:false,getType:function(){return"element"},getTagName:function(){return this.tagName},isClosing:function(){return this.closing}});e.htmlParser.EntityNode=e.Util.extend(e.htmlParser.HtmlNode,{getType:function(){return"entity"}});e.htmlParser.TextNode=e.Util.extend(e.htmlParser.HtmlNode,{getType:function(){return"text"}});e.matchParser.MatchParser=e.Util.extend(Object,{urls:true,email:true,twitter:true,phone:true,hashtag:false,stripPrefix:true,matcherRegex:function(){var e=/(^|[^\w])@(\w{1,15})/,t=/(^|[^\w])#(\w{1,15})/,r=/(?:[\-;:&=\+\$,\w\.]+@)/,i=/(?:\+?\d{1,3}[-\s.])?\(?\d{3}\)?[-\s.]?\d{3}[-\s.]\d{4}/,n=/(?:[A-Za-z][-.+A-Za-z0-9]+:(?![A-Za-z][-.+A-Za-z0-9]+:\/\/)(?!\d+\/?)(?:\/\/)?)/,a=/(?:www\.)/,o=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,s=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,l=/[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]?!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]]/;return new RegExp(["(",e.source,")","|","(",r.source,o.source,s.source,")","|","(","(?:","(",n.source,o.source,")","|","(?:","(.?//)?",a.source,o.source,")","|","(?:","(.?//)?",o.source,s.source,")",")","(?:"+l.source+")?",")","|","(",i.source,")","|","(",t.source,")"].join(""),"gi")}(),charBeforeProtocolRelMatchRegex:/^(.)?\/\//,constructor:function(t){e.Util.assign(this,t);this.matchValidator=new e.MatchValidator},replace:function(e,t,r){var i=this;return e.replace(this.matcherRegex,function(e,n,a,o,s,l,u,c,d,f,h,p,m){var v=i.processCandidateMatch(e,n,a,o,s,l,u,c,d,f,h,p,m);if(!v){return e}else{var g=t.call(r,v.match);return v.prefixStr+g+v.suffixStr}})},processCandidateMatch:function(t,r,i,n,a,o,s,l,u,c,d,f,h){var p=l||u,m,v="",g="";if(o&&!this.urls||a&&!this.email||c&&!this.phone||r&&!this.twitter||d&&!this.hashtag||!this.matchValidator.isValidMatch(o,s,p)){return null}if(this.matchHasUnbalancedClosingParen(t)){t=t.substr(0,t.length-1);g=")"}if(a){m=new e.match.Email({matchedText:t,email:a})}else if(r){if(i){v=i;t=t.slice(1)}m=new e.match.Twitter({matchedText:t,twitterHandle:n})}else if(c){var _=t.replace(/\D/g,"");m=new e.match.Phone({matchedText:t,number:_})}else if(d){if(f){v=f;t=t.slice(1)}m=new e.match.Hashtag({matchedText:t,serviceName:this.hashtag,hashtag:h})}else{if(p){var y=p.match(this.charBeforeProtocolRelMatchRegex)[1]||"";if(y){v=y;t=t.slice(1)}}m=new e.match.Url({matchedText:t,url:t,protocolUrlMatch:!!s,protocolRelativeMatch:!!p,stripPrefix:this.stripPrefix})}return{prefixStr:v,suffixStr:g,match:m}},matchHasUnbalancedClosingParen:function(e){var t=e.charAt(e.length-1);if(t===")"){var r=e.match(/\(/g),i=e.match(/\)/g),n=r&&r.length||0,a=i&&i.length||0;if(n<a){return true}}return false}});e.MatchValidator=e.Util.extend(Object,{invalidProtocolRelMatchRegex:/^[\w]\/\//,hasFullProtocolRegex:/^[A-Za-z][-.+A-Za-z0-9]+:\/\//,uriSchemeRegex:/^[A-Za-z][-.+A-Za-z0-9]+:/,hasWordCharAfterProtocolRegex:/:[^\s]*?[A-Za-z]/,isValidMatch:function(e,t,r){if(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)||this.isInvalidProtocolRelativeMatch(r)){return false}return true},isValidUriScheme:function(e){var t=e.match(this.uriSchemeRegex)[0].toLowerCase();return t!=="javascript:"&&t!=="vbscript:"},urlMatchDoesNotHaveProtocolOrDot:function(e,t){return!!e&&(!t||!this.hasFullProtocolRegex.test(t))&&e.indexOf(".")===-1},urlMatchDoesNotHaveAtLeastOneWordChar:function(e,t){if(e&&t){return!this.hasWordCharAfterProtocolRegex.test(e)}else{return false}},isInvalidProtocolRelativeMatch:function(e){return!!e&&this.invalidProtocolRelMatchRegex.test(e)}});e.match.Match=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},getType:e.Util.abstractMethod,getMatchedText:function(){return this.matchedText},getAnchorHref:e.Util.abstractMethod,getAnchorText:e.Util.abstractMethod});e.match.Email=e.Util.extend(e.match.Match,{getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}});e.match.Hashtag=e.Util.extend(e.match.Match,{getType:function(){return"hashtag"},getHashtag:function(){return this.hashtag},getAnchorHref:function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;default:throw new Error("Unknown service name to point hashtag to: ",e)}},getAnchorText:function(){return"#"+this.hashtag}});e.match.Phone=e.Util.extend(e.match.Match,{getType:function(){return"phone"},getNumber:function(){return this.number},getAnchorHref:function(){return"tel:"+this.number},getAnchorText:function(){return this.matchedText}});e.match.Twitter=e.Util.extend(e.match.Match,{getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}});e.match.Url=e.Util.extend(e.match.Match,{urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,protocolPrepended:false,getType:function(){return"url"},getUrl:function(){var e=this.url;if(!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended){e=this.url="http://"+e;this.protocolPrepended=true}return e},getAnchorHref:function(){var e=this.getUrl();return e.replace(/&amp;/g,"&")},getAnchorText:function(){var e=this.getUrl();if(this.protocolRelativeMatch){e=this.stripProtocolRelativePrefix(e)}if(this.stripPrefix){e=this.stripUrlPrefix(e)}e=this.removeTrailingSlash(e);return e},stripUrlPrefix:function(e){return e.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(e){return e.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(e){if(e.charAt(e.length-1)==="/"){e=e.slice(0,-1)}return e}});return e});define("ThirdParty/zip",["../Core/buildModuleUrl","../Core/defineProperties"],function(e,t){var r={};(function(r){var i="File format is not recognized.";var n="File contains encrypted entry.";var a="File is using Zip64 (4gb+ file size).";var o="Error while reading zip file.";var s="Error while writing zip file.";var l="Error while writing file data.";var u="Error while reading file data.";var c="File already exists.";var d=512*1024;var f="inflate.js";var h="deflate.js";var p="text/plain";var m="message";var v;try{v=new Blob([new DataView(new ArrayBuffer(0))]).size===0}catch(e){}function g(){var e=-1,t=this;t.append=function(r){var i,n=t.table;for(i=0;i<r.length;i++)e=e>>>8^n[(e^r[i])&255]};t.get=function(){return~e}}g.prototype.table=function(){var e,t,r,i=[];for(e=0;e<256;e++){r=e;for(t=0;t<8;t++)if(r&1)r=r>>>1^3988292384;else r=r>>>1;i[e]=r}return i}();function _(e,t,r){if(e.slice)return e.slice(t,t+r);else if(e.webkitSlice)return e.webkitSlice(t,t+r);else if(e.mozSlice)return e.mozSlice(t,t+r);else if(e.msSlice)return e.msSlice(t,t+r)}function y(e,t){var r,i;r=new ArrayBuffer(e);i=new Uint8Array(r);if(t)i.set(t,0);return{buffer:r,array:i,view:new DataView(r)}}function b(){}function w(e){var t=this,r;function i(i,n){var a=new Blob([e],{type:p});r=new S(a);r.init(function(){t.size=r.size;i()},n)}function n(e,t,i,n){r.readUint8Array(e,t,i,n)}t.size=0;t.init=i;t.readUint8Array=n}w.prototype=new b;w.prototype.constructor=w;function C(e){var t=this,r;function i(i){var n=e.length;while(e.charAt(n-1)=="=")n--;r=e.indexOf(",")+1;t.size=Math.floor((n-r)*.75);i()}function n(t,i,n){var a,o=y(i);var s=Math.floor(t/3)*4;var l=Math.ceil((t+i)/3)*4;var u=window.atob(e.substring(s+r,l+r));var c=t-Math.floor(s/4)*3;for(a=c;a<c+i;a++)o.array[a-c]=u.charCodeAt(a);n(o.array)}t.size=0;t.init=i;t.readUint8Array=n}C.prototype=new b;C.prototype.constructor=C;function S(e){var t=this;function r(t){this.size=e.size;t()}function i(t,r,i,n){var a=new FileReader;a.onload=function(e){i(new Uint8Array(e.target.result))};a.onerror=n;a.readAsArrayBuffer(_(e,t,r))}t.size=0;t.init=r;t.readUint8Array=i}S.prototype=new b;S.prototype.constructor=S;function T(){}T.prototype.getData=function(e){e(this.data)};function E(e){var t=this,r;function i(e){r=new Blob([],{type:p});e()}function n(e,t){r=new Blob([r,v?e:e.buffer],{type:p});t()}function a(t,i){var n=new FileReader;n.onload=function(e){t(e.target.result)};n.onerror=i;n.readAsText(r,e)}t.init=i;t.writeUint8Array=n;t.getData=a}E.prototype=new T;E.prototype.constructor=E;function x(e){var t=this,r="",i="";function n(t){r+="data:"+(e||"")+";base64,";t()}function a(e,t){var n,a=i.length,o=i;i="";for(n=0;n<Math.floor((a+e.length)/3)*3-a;n++)o+=String.fromCharCode(e[n]);for(;n<e.length;n++)i+=String.fromCharCode(e[n]);if(o.length>2)r+=window.btoa(o);else i=o;t()}function o(e){e(r+window.btoa(i))}t.init=n;t.writeUint8Array=a;t.getData=o}x.prototype=new T;x.prototype.constructor=x;function P(e){var t,r=this;function i(r){t=new Blob([],{type:e});r()}function n(r,i){t=new Blob([t,v?r:r.buffer],{type:e});i()}function a(e){e(t)}r.init=i;r.writeUint8Array=n;r.getData=a}P.prototype=new T;P.prototype.constructor=P;function A(e,t,r,i,n,a,o,s,l,u){var c=0,f,h;function p(){e.removeEventListener(m,v,false);s(h)}function v(e){var t=e.data,i=t.data;if(t.onappend){h+=i.length;r.writeUint8Array(i,function(){a(false,i);g()},u)}if(t.onflush)if(i){h+=i.length;r.writeUint8Array(i,function(){a(false,i);p()},u)}else p();if(t.progress&&o)o(f+t.current,n)}function g(){f=c*d;if(f<n)t.readUint8Array(i+f,Math.min(d,n-f),function(t){e.postMessage({append:true,data:t});c++;if(o)o(f,n);a(true,t)},l);else e.postMessage({flush:true})}h=0;e.addEventListener(m,v,false);g()}function O(e,t,r,i,n,a,o,s,l,u){var c=0,f,h=0;function p(){var m;f=c*d;if(f<n)t.readUint8Array(i+f,Math.min(d,n-f),function(t){var s=e.append(t,function(){if(o)o(i+f,n)});h+=s.length;a(true,t);r.writeUint8Array(s,function(){a(false,s);c++;setTimeout(p,1)},u);if(o)o(f,n)},l);else{m=e.flush();if(m){h+=m.length;r.writeUint8Array(m,function(){a(false,m);s(h)},u)}else s(h)}}p()}function D(e,t,i,n,a,o,s,l,u){var c,d=new g;function h(e,t){if(a&&!e)d.append(t)}function p(e){o(e,d.get())}if(r.zip.useWebWorkers){c=new Worker(r.zip.workerScriptsPath+f);A(c,e,t,i,n,h,s,p,l,u)}else O(new r.zip.Inflater,e,t,i,n,h,s,p,l,u);return c}function I(e,t,i,n,a,o,s){var l,u=new g;function c(e,t){if(e)u.append(t)}function d(e){n(e,u.get())}function f(){l.removeEventListener(m,f,false);A(l,e,t,0,e.size,c,a,d,o,s)}if(r.zip.useWebWorkers){l=new Worker(r.zip.workerScriptsPath+h);l.addEventListener(m,f,false);l.postMessage({init:true,level:i})}else O(new r.zip.Deflater,e,t,0,e.size,c,a,d,o,s);return l}function M(e,t,r,i,n,a,o,s,l){var u=0,c=new g;function f(){var h=u*d;if(h<i)e.readUint8Array(r+h,Math.min(d,i-h),function(e){if(n)c.append(e);if(o)o(h,i,e);t.writeUint8Array(e,function(){u++;f()},l)},s);else a(i,c.get())}f()}function R(e){var t,r="",i,n=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];for(t=0;t<e.length;t++){i=e.charCodeAt(t)&255;if(i>127)r+=n[i-128];else r+=String.fromCharCode(i)}return r}function L(e){return decodeURIComponent(escape(e))}function N(e){var t,r="";for(t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r}function k(e){var t=(e&4294901760)>>16,r=e&65535;try{return new Date(1980+((t&65024)>>9),((t&480)>>5)-1,t&31,(r&63488)>>11,(r&2016)>>5,(r&31)*2,0)}catch(e){}}function F(e,t,r,i,o){e.version=t.view.getUint16(r,true);e.bitFlag=t.view.getUint16(r+2,true);e.compressionMethod=t.view.getUint16(r+4,true);e.lastModDateRaw=t.view.getUint32(r+6,true);e.lastModDate=k(e.lastModDateRaw);if((e.bitFlag&1)===1){o(n);return}if(i||(e.bitFlag&8)!=8){e.crc32=t.view.getUint32(r+10,true);e.compressedSize=t.view.getUint32(r+14,true);e.uncompressedSize=t.view.getUint32(r+18,true)}if(e.compressedSize===4294967295||e.uncompressedSize===4294967295){o(a);return}e.filenameLength=t.view.getUint16(r+22,true);e.extraFieldLength=t.view.getUint16(r+24,true)}function B(e,t){function r(){}r.prototype.getData=function(r,n,a,o){var s=this,c;function d(e,t){if(c)c.terminate();c=null;if(e)e(t)}function f(e){var t=y(4);t.view.setUint32(0,e);return s.crc32==t.view.getUint32(0)}function h(e,t){if(o&&!f(t))p();else r.getData(function(e){d(n,e)})}function p(){d(t,u)}function m(){d(t,l)}e.readUint8Array(s.offset,30,function(n){var l=y(n.length,n),u;if(l.view.getUint32(0)!=1347093252){t(i);return}F(s,l,4,false,t);u=s.offset+30+s.filenameLength+s.extraFieldLength;r.init(function(){if(s.compressionMethod===0)M(e,r,u,s.compressedSize,o,h,a,p,m);else c=D(e,r,u,s.compressedSize,o,h,a,p,m)},m)},p)};function n(r,i){e.readUint8Array(e.size-r,r,function(e){var t=y(e.length,e).view;if(t.getUint32(0)!=1347093766){n(r+1,i)}else{i(t)}},function(){t(o)})}return{getEntries:function(a){if(e.size<22){t(i);return}n(22,function(n){var s,l;s=n.getUint32(16,true);l=n.getUint16(8,true);e.readUint8Array(s,e.size-s,function(e){var n,o=0,s=[],u,c,d,f=y(e.length,e);for(n=0;n<l;n++){u=new r;if(f.view.getUint32(o)!=1347092738){t(i);return}F(u,f,o+6,true,t);u.commentLength=f.view.getUint16(o+32,true);u.directory=(f.view.getUint8(o+38)&16)==16;u.offset=f.view.getUint32(o+42,true);c=N(f.array.subarray(o+46,o+46+u.filenameLength));u.filename=(u.bitFlag&2048)===2048?L(c):R(c);if(!u.directory&&u.filename.charAt(u.filename.length-1)=="/")u.directory=true;d=N(f.array.subarray(o+46+u.filenameLength+u.extraFieldLength,o+46+u.filenameLength+u.extraFieldLength+u.commentLength));u.comment=(u.bitFlag&2048)===2048?L(d):R(d);s.push(u);o+=46+u.filenameLength+u.extraFieldLength+u.commentLength}a(s)},function(){t(o)})})},close:function(e){if(e)e()}}}function U(e){return unescape(encodeURIComponent(e))}function V(e){var t,r=[];for(t=0;t<e.length;t++)r.push(e.charCodeAt(t));return r}function z(e,t,r){var i,n={},a=[],o=0;function l(e,t){if(i)i.terminate();i=null;if(e)e(t)}function d(){l(t,s)}function f(){l(t,u)}return{add:function(s,u,h,p,m){var v,g,_;function b(t){var i;_=m.lastModDate||new Date;v=y(26);n[s]={headerArray:v.array,directory:m.directory,filename:g,offset:o,comment:V(U(m.comment||""))};v.view.setUint32(0,335546376);if(m.version)v.view.setUint8(0,m.version);if(!r&&m.level!==0&&!m.directory)v.view.setUint16(4,2048);v.view.setUint16(6,(_.getHours()<<6|_.getMinutes())<<5|_.getSeconds()/2,true);v.view.setUint16(8,(_.getFullYear()-1980<<4|_.getMonth()+1)<<5|_.getDate(),true);v.view.setUint16(22,g.length,true);i=y(30+g.length);i.view.setUint32(0,1347093252);i.array.set(v.array,4);i.array.set(g,30);o+=i.array.length;e.writeUint8Array(i.array,t,d)}function w(t,r){var i=y(16);o+=t||0;i.view.setUint32(0,1347094280);if(typeof r!="undefined"){v.view.setUint32(10,r,true);i.view.setUint32(4,r,true)}if(u){i.view.setUint32(8,t,true);v.view.setUint32(14,t,true);i.view.setUint32(12,u.size,true);v.view.setUint32(18,u.size,true)}e.writeUint8Array(i.array,function(){o+=16;l(h)},d)}function C(){m=m||{};s=s.trim();if(m.directory&&s.charAt(s.length-1)!="/")s+="/";if(n.hasOwnProperty(s)){t(c);return}g=V(U(s));a.push(s);b(function(){if(u)if(r||m.level===0)M(u,e,0,u.size,true,w,p,f,d);else i=I(u,e,m.level,w,p,f,d);else w()},d)}if(u)u.init(C,f);else C()},close:function(t){var r,i=0,s=0,u,c;for(u=0;u<a.length;u++){c=n[a[u]];i+=46+c.filename.length+c.comment.length}r=y(i+22);for(u=0;u<a.length;u++){c=n[a[u]];r.view.setUint32(s,1347092738);r.view.setUint16(s+4,5120);r.array.set(c.headerArray,s+6);r.view.setUint16(s+32,c.comment.length,true);if(c.directory)r.view.setUint8(s+38,16);r.view.setUint32(s+42,c.offset,true);r.array.set(c.filename,s+46);r.array.set(c.comment,s+46+c.filename.length);s+=46+c.filename.length+c.comment.length}r.view.setUint32(s,1347093766);r.view.setUint16(s+8,a.length,true);r.view.setUint16(s+10,a.length,true);r.view.setUint32(s+12,i,true);r.view.setUint32(s+16,o,true);e.writeUint8Array(r.array,function(){l(function(){e.getData(t)})},d)}}}r.zip={Reader:b,Writer:T,BlobReader:S,Data64URIReader:C,TextReader:w,BlobWriter:P,Data64URIWriter:x,TextWriter:E,createReader:function(e,t,r){e.init(function(){t(B(e,r))},r)},createWriter:function(e,t,r,i){e.init(function(){t(z(e,r,i))},r)},useWebWorkers:true};var q;t(r.zip,{workerScriptsPath:{get:function(){if(typeof q==="undefined"){q=e("ThirdParty/Workers/")}return q}}})})(r);return r.zip});define("DataSources/KmlDataSource",["../Core/AssociativeArray","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/ClockRange","../Core/ClockStep","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/getAbsoluteUri","../Core/getExtensionFromUri","../Core/getFilenameFromUri","../Core/Iso8601","../Core/joinUrls","../Core/JulianDate","../Core/loadBlob","../Core/loadXML","../Core/Math","../Core/NearFarScalar","../Core/objectToQuery","../Core/oneTimeWarning","../Core/PinBuilder","../Core/PolygonHierarchy","../Core/Rectangle","../Core/RuntimeError","../Core/TimeInterval","../Core/TimeIntervalCollection","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/SceneMode","../ThirdParty/Autolinker","../ThirdParty/Uri","../ThirdParty/when","../ThirdParty/zip","./BillboardGraphics","./CompositePositionProperty","./CorridorGraphics","./DataSource","./DataSourceClock","./Entity","./EntityCluster","./EntityCollection","./LabelGraphics","./PathGraphics","./PolygonGraphics","./PolylineGraphics","./PositionPropertyArray","./RectangleGraphics","./ReferenceProperty","./SampledPositionProperty","./ScaledPositionProperty","./TimeIntervalCollectionProperty","./WallGraphics"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U,V,z,q,G,H,j,W,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,ae){"use strict";if(typeof DOMParser==="undefined"){return{}}var oe={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){var t=e.toLowerCase();t=v(t);return oe[t]}};var se=new DOMParser;var le=new F({stripPrefix:false,twitter:false,email:false,replaceFn:function(e,t){if(!t.protocolUrlMatch){return false}}});var ue=32;var ce=2414016;var de=1;var fe=16093e3;var he=.1;function pe(e){var t=e.slice(0,Math.min(4,e.size));var r=U.defer();var i=new FileReader;i.addEventListener("load",function(){r.resolve(new DataView(i.result).getUint32(0,false)===1347093252)});i.addEventListener("error",function(){r.reject(i.error)});i.readAsArrayBuffer(t);return r.promise}function me(e){var t=U.defer();var r=new FileReader;r.addEventListener("load",function(){t.resolve(r.result)});r.addEventListener("error",function(){t.reject(r.error)});r.readAsText(e);return t.promise}function ve(e,t,r,i){t.getData(new V.TextWriter,function(e){r.kml=se.parseFromString(e,"application/xml");i.resolve()})}function ge(e,t,r,i){var n=u(oe.detectFromFilename(t.filename),"application/octet-stream");t.getData(new V.Data64URIWriter(n),function(e){r[t.filename]=e;i.resolve()})}function _e(e,t,r,i){var n=i.keys;var a=new B(".");var o=e.querySelectorAll(t);for(var s=0;s<o.length;s++){var l=o[s];var u=l.getAttribute(r);var c=new B(u).resolve(a).toString();var d=n.indexOf(c);if(d!==-1){var f=n[d];l.setAttribute(r,i[f]);if(t==="a"&&l.getAttribute("download")===null){l.setAttribute("download",f)}}}}function ye(e,t,r,i,n,a){var o=e.querySelectorAll(t);for(var s=0;s<o.length;s++){var l=o[s];var u=l.getAttribute(r);var c=Fe(u,i,n,a);l.setAttribute(r,c)}}function be(e,t,r){if(c(t)){if(new B(e).isAbsolute()){e=t.getURL(e)}}if(c(r)){e=y(e,"?"+r,false)}return e}function we(e,t,r){var i=De(e,"id");i=c(i)&&i.length!==0?i:l();if(c(r)){i=r+i}var n=t.getById(i);if(c(n)){i=l();if(c(r)){i=r+i}}n=t.add(new W({id:i}));if(!c(n.kml)){n.addProperty("kml");n.kml=new Vt}return n}function Ce(e,t){return e==="absolute"||e==="relativeToGround"||t==="relativeToSeaFloor"}function Se(e){if(!c(e)){return i.fromDegrees(0,0,0)}var t=e.match(/[^\s,\n]+/g);if(!c(t)){return i.fromDegrees(0,0,0)}var r=parseFloat(t[0]);var n=parseFloat(t[1]);var a=parseFloat(t[2]);r=isNaN(r)?0:r;n=isNaN(n)?0:n;a=isNaN(a)?0:a;return i.fromDegrees(r,n,a)}function Te(e){if(!c(e)){return undefined}var t=e.textContent.match(/[^\s\n]+/g);if(!c(t)){return undefined}var r=t.length;var i=new Array(r);var n=0;for(var a=0;a<r;a++){i[n++]=Se(t[a])}return i}var Ee=[null,undefined,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"];var xe=["http://www.google.com/kml/ext/2.2"];var Pe=["http://www.w3.org/2005/Atom"];var Ae={kml:Ee,gx:xe,atom:Pe,kmlgx:Ee.concat(xe)};function Oe(e,t){if(!c(e)){return undefined}var r=e.getAttribute(t);if(r!==null){var i=parseFloat(r);return!isNaN(i)?i:undefined}return undefined}function De(e,t){if(!c(e)){return undefined}var r=e.getAttribute(t);return r!==null?r:undefined}function Ie(e,t,r){if(!c(e)){return undefined}var i=e.childNodes;var n=i.length;for(var a=0;a<n;a++){var o=i[a];if(o.localName===t&&r.indexOf(o.namespaceURI)!==-1){return o}}return undefined}function Me(e,t,r){if(!c(e)){return undefined}var i=[];var n=e.getElementsByTagNameNS("*",t);var a=n.length;for(var o=0;o<a;o++){var s=n[o];if(s.localName===t&&r.indexOf(s.namespaceURI)!==-1){i.push(s)}}return i}function Re(e,t,r){if(!c(e)){return[]}var i=[];var n=e.childNodes;var a=n.length;for(var o=0;o<a;o++){var s=n[o];if(s.localName===t&&r.indexOf(s.namespaceURI)!==-1){i.push(s)}}return i}function Le(e,t,r){var i=Ie(e,t,r);if(c(i)){var n=parseFloat(i.textContent);return!isNaN(n)?n:undefined}return undefined}function Ne(e,t,r){var i=Ie(e,t,r);if(c(i)){return i.textContent.trim()}return undefined}function ke(e,t,r){var i=Ie(e,t,r);if(c(i)){var n=i.textContent.trim();return n==="1"||/^true$/i.test(n)}return undefined}function Fe(e,t,r,i,n){if(!c(e)){return undefined}var a=false;if(c(i)){var o=i[e];if(c(o)){a=true;e=o}else{var s=m(e,r);o=i[s];if(c(o)){a=true;e=o}}}if(!a){if(c(r)){e=m(e,m(r))}e=be(e,t,n)}return e}var Be={};function Ue(e,t){if(!c(e)||/^\s*$/gm.test(e)){return undefined}if(e[0]==="#"){e=e.substring(1)}var r=parseInt(e.substring(0,2),16)/255;var i=parseInt(e.substring(2,4),16)/255;var n=parseInt(e.substring(4,6),16)/255;var a=parseInt(e.substring(6,8),16)/255;if(!t){return new s(a,n,i,r)}if(a>0){Be.maximumRed=a}else{Be.red=0}if(n>0){Be.maximumGreen=n}else{Be.green=0}if(i>0){Be.maximumBlue=i}else{Be.blue=0}Be.alpha=r;return s.fromRandom(Be)}function Ve(e,t,r){var i=Ne(e,t,r);if(!c(i)){return undefined}return Ue(i,Ne(e,"colorMode",r)==="random")}function ze(e){var t=Ie(e,"TimeStamp",Ae.kmlgx);var r=Ne(t,"when",Ae.kmlgx);if(!c(t)||!c(r)||r.length===0){return undefined}var i=b.fromIso8601(r);var n=new M;n.addInterval(new I({start:i,stop:_.MAXIMUM_VALUE}));return n}function qe(e){var t=Ie(e,"TimeSpan",Ae.kmlgx);if(!c(t)){return undefined}var r;var i=Ie(t,"begin",Ae.kmlgx);var n=c(i)?b.fromIso8601(i.textContent):undefined;var a=Ie(t,"end",Ae.kmlgx);var o=c(a)?b.fromIso8601(a.textContent):undefined;if(c(n)&&c(o)){if(b.lessThan(o,n)){var s=n;n=o;o=s}r=new M;r.addInterval(new I({start:n,stop:o}))}else if(c(n)){r=new M;r.addInterval(new I({start:n,stop:_.MAXIMUM_VALUE}))}else if(c(o)){r=new M;r.addInterval(new I({start:_.MINIMUM_VALUE,stop:o}))}return r}function Ge(){var e=new z;e.width=ue;e.height=ue;e.scaleByDistance=new T(ce,de,fe,he);e.pixelOffsetScaleByDistance=new T(ce,de,fe,he);return e}function He(){var e=new K;e.outline=true;e.outlineColor=s.WHITE;return e}function je(){var e=new Q;e.translucencyByDistance=new T(3e6,1,5e6,0);e.pixelOffset=new r(17,0);e.horizontalOrigin=L.LEFT;e.font="16px sans-serif";e.style=N.FILL_AND_OUTLINE;return e}function We(e,t,r,i,n,a){var o=Ne(e,"href",Ae.kml);if(!c(o)||o.length===0){return undefined}if(o.indexOf("root://icons/palette-")===0){var s=o.charAt(21);var l=u(Le(e,"x",Ae.gx),0);var d=u(Le(e,"y",Ae.gx),0);l=Math.min(l/32,7);d=7-Math.min(d/32,7);var f=8*d+l;o="https://maps.google.com/mapfiles/kml/pal"+s+"/icon"+f+".png"}o=Fe(o,t._proxy,r,i,a);if(n){var h=Ne(e,"refreshMode",Ae.kml);var p=Ne(e,"viewRefreshMode",Ae.kml);if(h==="onInterval"||h==="onExpire"){x("kml-refreshMode-"+h,"KML - Unsupported Icon refreshMode: "+h)}else if(p==="onStop"||p==="onRegion"){x("kml-refreshMode-"+p,"KML - Unsupported Icon viewRefreshMode: "+p)}var m=u(Ne(e,"viewBoundScale",Ae.kml),1);var v=p==="onStop"?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"";var g=u(Ne(e,"viewFormat",Ae.kml),v);var _=Ne(e,"httpQuery",Ae.kml);var b=Et(g,_);var w=y(o,b,false);return Dt(t._camera,t._canvas,w,m,t._lastCameraView.bbox)}return o}function Ye(e,n,a,o,s,l){var d=Le(n,"scale",Ae.kml);var f=Le(n,"heading",Ae.kml);var h=Ve(n,"color",Ae.kml);var p=Ie(n,"Icon",Ae.kml);var m=We(p,e,o,s,false,l);var v=Le(p,"x",Ae.gx);var g=Le(p,"y",Ae.gx);var _=Le(p,"w",Ae.gx);var y=Le(p,"h",Ae.gx);var b=Ie(n,"hotSpot",Ae.kml);var w=Oe(b,"x");var C=Oe(b,"y");var T=De(b,"xunits");var E=De(b,"yunits");var x=a.billboard;if(!c(x)){x=Ge();a.billboard=x}x.image=m;x.scale=d;x.color=h;if(c(v)||c(g)||c(_)||c(y)){x.imageSubRegion=new t(v,g,_,y)}if(c(f)&&f!==0){x.rotation=S.toRadians(-f);x.alignedAxis=i.UNIT_Z}d=u(d,1);var P;var A;if(c(w)){if(T==="pixels"){P=-w*d}else if(T==="insetPixels"){P=(w-ue)*d}else if(T==="fraction"){P=-w*ue*d}P+=ue*.5*d}if(c(C)){if(E==="pixels"){A=C*d}else if(E==="insetPixels"){A=(-C+ue)*d}else if(E==="fraction"){A=C*ue*d}A-=ue*.5*d}if(c(P)||c(A)){x.pixelOffset=new r(P,A)}}function Xe(e,t,r,i,n,a){for(var o=0,l=t.childNodes.length;o<l;o++){var d=t.childNodes.item(o);if(d.localName==="IconStyle"){Ye(e,d,r,i,n,a)}else if(d.localName==="LabelStyle"){var f=r.label;if(!c(f)){f=je();r.label=f}f.scale=u(Le(d,"scale",Ae.kml),f.scale);f.fillColor=u(Ve(d,"color",Ae.kml),f.fillColor);f.text=r.name}else if(d.localName==="LineStyle"){var h=r.polyline;if(!c(h)){h=new J;r.polyline=h}h.width=Le(d,"width",Ae.kml);h.material=Ve(d,"color",Ae.kml);if(c(Ve(d,"outerColor",Ae.gx))){x("kml-gx:outerColor","KML - gx:outerColor is not supported in a LineStyle")}if(c(Le(d,"outerWidth",Ae.gx))){x("kml-gx:outerWidth","KML - gx:outerWidth is not supported in a LineStyle")}if(c(Le(d,"physicalWidth",Ae.gx))){x("kml-gx:physicalWidth","KML - gx:physicalWidth is not supported in a LineStyle")}if(c(ke(d,"labelVisibility",Ae.gx))){x("kml-gx:labelVisibility","KML - gx:labelVisibility is not supported in a LineStyle")}}else if(d.localName==="PolyStyle"){var p=r.polygon;if(!c(p)){p=He();r.polygon=p}p.material=u(Ve(d,"color",Ae.kml),p.material);p.fill=u(ke(d,"fill",Ae.kml),p.fill);p.outline=u(ke(d,"outline",Ae.kml),p.outline)}else if(d.localName==="BalloonStyle"){var m=u(Ue(Ne(d,"bgColor",Ae.kml)),s.WHITE);var v=u(Ue(Ne(d,"textColor",Ae.kml)),s.BLACK);var g=Ne(d,"text",Ae.kml);r.addProperty("balloonStyle");r.balloonStyle={bgColor:m,textColor:v,text:g}}else if(d.localName==="ListStyle"){var _=Ne(d,"listItemType",Ae.kml);if(_==="radioFolder"||_==="checkOffOnly"){x("kml-listStyle-"+_,"KML - Unsupported ListStyle with listItemType: "+_)}}}}function Qe(e,t,r,i,n,a,o){var s=new W;var l;var u=-1;var d=r.childNodes;var f=d.length;for(var h=0;h<f;h++){var p=d[h];if(p.localName==="Style"||p.localName==="StyleMap"){u=h}}if(u!==-1){var v=d[u];if(v.localName==="Style"){Xe(t,v,s,n,a,o)}else{var g=Re(v,"Pair",Ae.kml);for(var _=0;_<g.length;_++){var y=g[_];var b=Ne(y,"key",Ae.kml);if(b==="normal"){var w=Ne(y,"styleUrl",Ae.kml);if(c(w)){l=i.getById(w);if(!c(l)){l=i.getById("#"+w)}if(c(l)){s.merge(l)}}else{var C=Ie(y,"Style",Ae.kml);Xe(t,C,s,n,a,o)}}else{x("kml-styleMap-"+b,"KML - Unsupported StyleMap key: "+b)}}}}var S=Ne(r,"styleUrl",Ae.kml);if(c(S)){var T=S;if(S[0]!=="#"&&S.indexOf("#")!==-1){var E=S.split("#");var P=E[0];if(c(n)){P=m(P,m(n))}T=P+"#"+E[1]}l=i.getById(T);if(!c(l)){l=i.getById("#"+T)}if(c(l)){s.merge(l)}}return s}function Ze(e,t,r,i){return C(be(t,e._proxy,i)).then(function(i){return Ke(e,i,r,t,true)})}function Ke(e,t,r,i,n,a,o){var s;var l;var u;var d;var f=Me(t,"Style",Ae.kml);if(c(f)){var h=f.length;for(s=0;s<h;s++){d=f[s];l=De(d,"id");if(c(l)){l="#"+l;if(n&&c(i)){l=i+l}if(!c(r.getById(l))){u=new W({id:l});r.add(u);Xe(e,d,u,i,a,o)}}}}var p=Me(t,"StyleMap",Ae.kml);if(c(p)){var v=p.length;for(s=0;s<v;s++){var g=p[s];l=De(g,"id");if(c(l)){var _=Re(g,"Pair",Ae.kml);for(var y=0;y<_.length;y++){var b=_[y];var w=Ne(b,"key",Ae.kml);if(w==="normal"){l="#"+l;if(n&&c(i)){l=i+l}if(!c(r.getById(l))){u=r.getOrCreateEntity(l);var C=Ne(b,"styleUrl",Ae.kml);if(c(C)){if(C[0]!=="#"){C="#"+C}if(n&&c(i)){C=i+C}var S=r.getById(C);if(c(S)){u.merge(S)}}else{d=Ie(b,"Style",Ae.kml);Xe(e,d,u,i,a,o)}}}else{x("kml-styleMap-"+w,"KML - Unsupported StyleMap key: "+w)}}}}}var T={};var E=[];var P=t.getElementsByTagName("styleUrl");var A=P.length;for(s=0;s<A;s++){var O=P[s].textContent;if(O[0]!=="#"){var D=O.split("#");if(D.length===2){var I=D[0];if(!c(T[I])){if(c(i)){I=m(I,m(i))}E.push(Ze(e,I,r,o))}}}}return E}function Je(e,t,r){var i=new te(e,t.id,["position"]);var n=new ie(t.position);t.polyline=c(r.polyline)?r.polyline.clone():new J;t.polyline.positions=new $([i,n])}function $e(e,t){if(!c(e)&&!c(t)||e==="clampToGround"){return R.CLAMP_TO_GROUND}if(e==="relativeToGround"){return R.RELATIVE_TO_GROUND}if(e==="absolute"){return R.NONE}if(t==="clampToSeaFloor"){x("kml-gx:altitudeMode-clampToSeaFloor","KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround.");return R.CLAMP_TO_GROUND}if(t==="relativeToSeaFloor"){x("kml-gx:altitudeMode-relativeToSeaFloor","KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround.");return R.RELATIVE_TO_GROUND}if(c(e)){x("kml-altitudeMode-unknown","KML - Unknown <kml:altitudeMode>:"+e+", using <kml:altitudeMode>:CLAMP_TO_GROUND.")}else{x("kml-gx:altitudeMode-unknown","KML - Unknown <gx:altitudeMode>:"+t+", using <kml:altitudeMode>:CLAMP_TO_GROUND.")}return R.CLAMP_TO_GROUND}function et(e,t,r){if(r==="relativeToSeaFloor"||t==="absolute"||t==="relativeToGround"){return e}if(c(t)&&t!=="clampToGround"||c(r)&&r!=="clampToSeaFloor"){x("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+u(t,r))}return new ie(e)}function tt(e,t,r){if(!c(e)){return undefined}if(r==="relativeToSeaFloor"||t==="absolute"||t==="relativeToGround"){return e}if(c(t)&&t!=="clampToGround"||c(r)&&r!=="clampToSeaFloor"){x("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+u(t,r))}var i=e.length;for(var n=0;n<i;n++){var a=e[n];h.WGS84.scaleToGeodeticSurface(a,a)}return e}function rt(e,t,i,n){var a=t.label;if(!c(a)){a=c(i.label)?i.label.clone():je();t.label=a}a.text=t.name;var o=t.billboard;if(!c(o)){o=c(i.billboard)?i.billboard.clone():Ge();t.billboard=o}if(!c(o.image)){o.image=e._pinBuilder.fromColor(s.YELLOW,64)}var l=1;if(c(o.scale)){l=o.scale.getValue();if(l!==0){a.pixelOffset=new r(l*16+1,0)}else{a.pixelOffset=undefined;a.horizontalOrigin=undefined}}if(c(n)&&e._clampToGround){o.heightReference=n;a.heightReference=n}}function it(e,t,r){var i=t.path;if(!c(i)){i=new Z;i.leadTime=0;t.path=i}var n=r.polyline;if(c(n)){i.material=n.material;i.width=n.width}}function nt(e,t,r,i,n){var a=Ne(r,"coordinates",Ae.kml);var o=Ne(r,"altitudeMode",Ae.kml);var s=Ne(r,"altitudeMode",Ae.gx);var l=ke(r,"extrude",Ae.kml);var u=Se(a);i.position=u;rt(e,i,n,$e(o,s));if(l&&Ce(o,s)){Je(t,i,n)}return true}function at(e,t,r,i,n){var a=Ie(r,"coordinates",Ae.kml);var o=Ne(r,"altitudeMode",Ae.kml);var l=Ne(r,"altitudeMode",Ae.gx);var d=ke(r,"extrude",Ae.kml);var f=ke(r,"tessellate",Ae.kml);var h=Ce(o,l);if(c(Le(r,"drawOrder",Ae.gx))){x("kml-gx:drawOrder","KML - gx:drawOrder is not supported in LineStrings")}var p=Te(a);var m=n.polyline;if(h&&d){var v=new ae;i.wall=v;v.positions=p;var g=n.polygon;if(c(g)){v.fill=g.fill;v.material=g.material}v.outline=true;if(c(m)){v.outlineColor=c(m.material)?m.material.color:s.WHITE;v.outlineWidth=m.width}else if(c(g)){v.outlineColor=c(g.material)?g.material.color:s.WHITE}}else if(e._clampToGround&&!h&&f){var y=new G;i.corridor=y;y.positions=p;if(c(m)){y.material=c(m.material)?m.material.color.getValue(_.MINIMUM_VALUE):s.WHITE;y.width=u(m.width,1)}else{y.material=s.WHITE;y.width=1}}else{m=c(m)?m.clone():new J;i.polyline=m;m.positions=tt(p,o,l);if(!f||h){m.followSurface=false}}return true}function ot(e,t,r,i,n){var a=Ie(r,"outerBoundaryIs",Ae.kml);var o=Ie(a,"LinearRing",Ae.kml);var l=Ie(o,"coordinates",Ae.kml);var u=Te(l);var d=ke(r,"extrude",Ae.kml);var f=Ne(r,"altitudeMode",Ae.kml);var h=Ne(r,"altitudeMode",Ae.gx);var p=Ce(f,h);var m=c(n.polygon)?n.polygon.clone():He();var v=n.polyline;if(c(v)){m.outlineColor=c(v.material)?v.material.color:s.WHITE;m.outlineWidth=v.width}i.polygon=m;if(p){m.perPositionHeight=true;m.extrudedHeight=d?0:undefined}else if(!e._clampToGround){m.height=0}if(c(u)){var g=new A(u);var _=Re(r,"innerBoundaryIs",Ae.kml);for(var y=0;y<_.length;y++){o=Re(_[y],"LinearRing",Ae.kml);for(var b=0;b<o.length;b++){l=Ie(o[b],"coordinates",Ae.kml);u=Te(l);if(c(u)){g.holes.push(new A(u))}}}m.hierarchy=g}return true}function st(e,t,r,i,n){var a=Ne(r,"altitudeMode",Ae.kml);var o=Ne(r,"altitudeMode",Ae.gx);var s=Re(r,"coord",Ae.gx);var l=Re(r,"angles",Ae.gx);var u=Re(r,"when",Ae.kml);var c=ke(r,"extrude",Ae.kml);var d=Ce(a,o);if(l.length>0){x("kml-gx:angles","KML - gx:angles are not supported in gx:Tracks")}var f=Math.min(s.length,u.length);var h=[];var p=[];for(var m=0;m<f;m++){var v=Se(s[m].textContent);h.push(v);p.push(b.fromIso8601(u[m].textContent))}var g=new re;g.addSamples(p,h);i.position=g;rt(e,i,n,$e(a,o));it(e,i,n);i.availability=new M;if(u.length>0){i.availability.addInterval(new I({start:p[0],stop:p[p.length-1]}))}if(d&&c){Je(t,i,n)}return true}function lt(e,t,r,i,n,a,o,s,l){var u=e[0];var c=e[e.length-1];var d=new re;d.addSamples(e,t);r.intervals.addInterval(new I({start:u,stop:c,isStartIncluded:l,isStopIncluded:l,data:et(d,o,s)}));i.addInterval(new I({start:u,stop:c,isStartIncluded:l,isStopIncluded:l}));n.intervals.addInterval(new I({start:u,stop:c,isStartIncluded:l,isStopIncluded:l,data:a}))}function ut(e,t,r,i,n){var a=ke(r,"interpolate",Ae.gx);var o=Re(r,"Track",Ae.gx);var s;var l;var u;var d=false;var f=new ne;var h=new M;var p=new q;for(var m=0,v=o.length;m<v;m++){var g=o[m];var _=Re(g,"when",Ae.kml);var y=Re(g,"coord",Ae.gx);var w=Ne(g,"altitudeMode",Ae.kml);var C=Ne(g,"altitudeMode",Ae.gx);var S=Ce(w,C);var T=ke(g,"extrude",Ae.kml);var E=Math.min(y.length,_.length);var x=[];s=[];for(var P=0;P<E;P++){var A=Se(y[P].textContent);x.push(A);s.push(b.fromIso8601(_[P].textContent))}if(a){if(c(l)){lt([l,s[0]],[u,x[0]],p,h,f,false,"absolute",undefined,false)}l=s[E-1];u=x[x.length-1]}lt(s,x,p,h,f,S&&T,w,C,true);d=d||S&&T}i.availability=h;i.position=p;rt(e,i,n);it(e,i,n);if(d){Je(t,i,n);i.polyline.show=f}return true}var ct={Point:nt,LineString:at,LinearRing:at,Polygon:ot,Track:st,MultiTrack:ut,MultiGeometry:dt,Model:ft};function dt(e,t,r,i,n,a){var o=r.childNodes;var s=false;for(var l=0,u=o.length;l<u;l++){var d=o.item(l);var f=ct[d.localName];if(c(f)){var h=we(d,t,a);h.parent=i;h.name=i.name;h.availability=i.availability;h.description=i.description;h.kml=i.kml;if(f(e,t,d,h,n)){s=true}}}return s}function ft(e,t,r,i,n){x("kml-unsupportedGeometry","KML - Unsupported geometry: "+r.localName);return false}function ht(e,t){var r=Ie(e,"ExtendedData",Ae.kml);if(!c(r)){return undefined}if(c(Ie(r,"SchemaData",Ae.kml))){x("kml-schemaData","KML - SchemaData is unsupported")}if(c(De(r,"xmlns:prefix"))){x("kml-extendedData","KML - ExtendedData with xmlns:prefix is unsupported")}var i={};var n=Re(r,"Data",Ae.kml);if(c(n)){var a=n.length;for(var o=0;o<a;o++){var s=n[o];var l=De(s,"name");if(c(l)){i[l]={displayName:Ne(s,"displayName",Ae.kml),value:Ne(s,"value",Ae.kml)}}}}t.kml.extendedData=i}var pt=document.createElement("div");function mt(e,t,r,i,n,a){var o;var l;var d;var f=t.kml;var h=f.extendedData;var p=Ne(e,"description",Ae.kml);var m=u(t.balloonStyle,r.balloonStyle);var v=s.WHITE;var g=s.BLACK;var _=p;if(c(m)){v=u(m.bgColor,s.WHITE);g=u(m.textColor,s.BLACK);_=u(m.text,p)}var y;if(c(_)){_=_.replace("$[name]",u(t.name,""));_=_.replace("$[description]",u(p,""));_=_.replace("$[address]",u(f.address,""));_=_.replace("$[Snippet]",u(f.snippet,""));_=_.replace("$[id]",t.id);_=_.replace("$[geDirections]","");if(c(h)){var b=_.match(/\$\[.+?\]/g);if(b!==null){for(o=0;o<b.length;o++){var w=b[o];var C=w.substr(2,w.length-3);var S=/\/displayName$/.test(C);C=C.replace(/\/displayName$/,"");y=h[C];if(c(y)){y=S?y.displayName:y.value}if(c(y)){_=_.replace(w,u(y,""))}}}}}else if(c(h)){d=Object.keys(h);if(d.length>0){_='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>';for(o=0;o<d.length;o++){l=d[o];y=h[l];_+="<tr><th>"+u(y.displayName,l)+"</th><td>"+u(y.value,"")+"</td></tr>"}_+="</tbody></table>"}}if(!c(_)){return}_=le.link(_);pt.innerHTML=_;var T=pt.querySelectorAll("a");for(o=0;o<T.length;o++){T[o].setAttribute("target","_blank")}if(c(i)&&i.keys.length>1){_e(pt,"a","href",i);_e(pt,"img","src",i)}ye(pt,"a","href",n,a);ye(pt,"img","src",n,a);var E='<div class="cesium-infoBox-description-lighter" style="';E+="overflow:auto;";E+="word-wrap:break-word;";E+="background-color:"+v.toCssColorString()+";";E+="color:"+g.toCssColorString()+";";E+='">';E+=pt.innerHTML+"</div>";pt.innerHTML="";t.description=E}function vt(e,t,r,i,n,a,o,s,l,d){var f=we(r,i,l);var h=f.kml;var p=Qe(f,e,r,n,a,o,d);var m=Ne(r,"name",Ae.kml);f.name=m;f.parent=t;var v=qe(r);if(!c(v)){v=ze(r)}f.availability=v;Ft(f);function g(e){if(!e){return true}return e.show&&g(e.parent)}var _=ke(r,"visibility",Ae.kml);f.show=g(t)&&u(_,true);var y=Ie(r,"author",Ae.atom);var b=h.author;b.name=Ne(y,"name",Ae.atom);b.uri=Ne(y,"uri",Ae.atom);b.email=Ne(y,"email",Ae.atom);var w=Ie(r,"link",Ae.atom);var C=h.link;C.href=De(w,"href");C.hreflang=De(w,"hreflang");C.rel=De(w,"rel");C.type=De(w,"type");C.title=De(w,"title");C.length=De(w,"length");h.address=Ne(r,"address",Ae.kml);h.phoneNumber=Ne(r,"phoneNumber",Ae.kml);h.snippet=Ne(r,"Snippet",Ae.kml);ht(r,f);mt(r,f,p,o,e._proxy,a);if(c(Ie(r,"Camera",Ae.kml))){x("kml-camera","KML - Unsupported view: Camera")}if(c(Ie(r,"LookAt",Ae.kml))){x("kml-lookAt","KML - Unsupported view: LookAt")}if(c(Ie(r,"Region",Ae.kml))){x("kml-region","KML - Placemark Regions are unsupported")}return{entity:f,styleEntity:p}}var gt={Document:_t,Folder:yt,Placemark:bt,NetworkLink:It,GroundOverlay:wt,PhotoOverlay:Ct,ScreenOverlay:Ct,Tour:Ct};function _t(e,t,r,i,n,a,o,s,l,u){var c=Object.keys(gt);var d=c.length;for(var f=0;f<d;f++){var h=c[f];var p=gt[h];var m=r.childNodes;var v=m.length;for(var g=0;g<v;g++){var _=m[g];if(_.localName===h&&(Ae.kml.indexOf(_.namespaceURI)!==-1||Ae.gx.indexOf(_.namespaceURI)!==-1)){p(e,t,_,i,n,a,o,s,l,u)}}}}function yt(e,t,r,i,n,a,o,s,l,u){var c=vt(e,t,r,i,n,a,o,s,l,u);_t(e,c.entity,r,i,n,a,o,s,l,u)}function bt(e,t,r,i,n,a,o,s,l,u){var d=vt(e,t,r,i,n,a,o,s,l,u);var f=d.entity;var h=d.styleEntity;var p=false;var m=r.childNodes;for(var v=0,g=m.length;v<g&&!p;v++){var _=m.item(v);var y=ct[_.localName];if(c(y)){y(e,i,_,f,h,f.id);p=true}}if(!p){f.merge(h);rt(e,f,h)}}function wt(e,t,r,i,n,a,o,s,l,u){var d=vt(e,t,r,i,n,a,o,s,l,u);var f=d.entity;var h;var p=false;var m=Te(Ie(r,"LatLonQuad",Ae.gx));if(c(m)){h=He();h.hierarchy=new A(m);f.polygon=h;p=true}else{h=new ee;f.rectangle=h;var v=Ie(r,"LatLonBox",Ae.kml);if(c(v)){var g=Le(v,"west",Ae.kml);var _=Le(v,"south",Ae.kml);var y=Le(v,"east",Ae.kml);var b=Le(v,"north",Ae.kml);if(c(g)){g=S.negativePiToPi(S.toRadians(g))}if(c(_)){_=S.clampToLatitudeRange(S.toRadians(_))}if(c(y)){y=S.negativePiToPi(S.toRadians(y))}if(c(b)){b=S.clampToLatitudeRange(S.toRadians(b))}h.coordinates=new O(g,_,y,b);var w=Le(v,"rotation",Ae.kml);if(c(w)){h.rotation=S.toRadians(w)}}}var C=Ie(r,"Icon",Ae.kml);var T=We(C,e,a,o,true,u);if(c(T)){if(p){x("kml-gx:LatLonQuad","KML - gx:LatLonQuad Icon does not support texture projection.")}var E=Le(C,"x",Ae.gx);var P=Le(C,"y",Ae.gx);var D=Le(C,"w",Ae.gx);var I=Le(C,"h",Ae.gx);if(c(E)||c(P)||c(D)||c(I)){x("kml-groundOverlay-xywh","KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays")}h.material=T;h.material.color=Ve(r,"color",Ae.kml);h.material.transparent=true}else{h.material=Ve(r,"color",Ae.kml)}var M=Ne(r,"altitudeMode",Ae.kml);if(c(M)){if(M==="absolute"){h.height=Le(r,"altitude",Ae.kml)}else if(M!=="clampToGround"){x("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+M)}}else{M=Ne(r,"altitudeMode",Ae.gx);if(M==="relativeToSeaFloor"){x("kml-altitudeMode-relativeToSeaFloor","KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute.");h.height=Le(r,"altitude",Ae.kml)}else if(M==="clampToSeaFloor"){x("kml-altitudeMode-clampToSeaFloor","KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround.")}else if(c(M)){x("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+M)}}}function Ct(e,t,r,i,n,a,o,s,l){e._unsupportedNode.raiseEvent(e,t,r,i,n,a,o);x("kml-unsupportedFeature-"+r.nodeName,"KML - Unsupported feature: "+r.nodeName)}var St={INTERVAL:0,EXPIRE:1,STOP:2};function Tt(e){if(!c(e)||e.length===0){return""}var t=e[0];if(t==="&"){e.splice(0,1)}if(t!=="?"){e="?"+e}return e}function Et(e,t){var r="";if(c(e)&&e.length>0||c(t)&&t.length>0){r+=y(Tt(e),Tt(t),false)}return r}var xt=new O;var Pt=new n;var At=new r;var Ot=new i;function Dt(e,t,r,n,a){function o(e){if(e<-S.PI_OVER_TWO){return-S.PI_OVER_TWO}else if(e>S.PI_OVER_TWO){return S.PI_OVER_TWO}return e}function s(e){if(e>S.PI){return e-S.TWO_PI}else if(e<-S.PI){return e+S.TWO_PI}return e}if(c(e)&&e._mode!==k.MORPHING){var l=h.WGS84;var d;var f;a=u(a,xt);if(c(t)){At.x=t.clientWidth*.5;At.y=t.clientHeight*.5;d=e.pickEllipsoid(At,l,Ot)}if(c(d)){f=l.cartesianToCartographic(d,Pt)}else{f=O.center(a,Pt);d=l.cartographicToCartesian(f)}if(c(n)&&!S.equalsEpsilon(n,1,S.EPSILON9)){var p=a.width*n*.5;var m=a.height*n*.5;a=new O(s(f.longitude-p),o(f.latitude-m),s(f.longitude+p),o(f.latitude+m))}r=r.replace("[bboxWest]",S.toDegrees(a.west).toString());r=r.replace("[bboxSouth]",S.toDegrees(a.south).toString());r=r.replace("[bboxEast]",S.toDegrees(a.east).toString());r=r.replace("[bboxNorth]",S.toDegrees(a.north).toString());var v=S.toDegrees(f.longitude).toString();var g=S.toDegrees(f.latitude).toString();r=r.replace("[lookatLon]",v);r=r.replace("[lookatLat]",g);r=r.replace("[lookatTilt]",S.toDegrees(e.pitch).toString());r=r.replace("[lookatHeading]",S.toDegrees(e.heading).toString());r=r.replace("[lookatRange]",i.distance(e.positionWC,d));r=r.replace("[lookatTerrainLon]",v);r=r.replace("[lookatTerrainLat]",g);r=r.replace("[lookatTerrainAlt]",f.height.toString());l.cartesianToCartographic(e.positionWC,Pt);r=r.replace("[cameraLon]",S.toDegrees(Pt.longitude).toString());r=r.replace("[cameraLat]",S.toDegrees(Pt.latitude).toString());r=r.replace("[cameraAlt]",S.toDegrees(Pt.height).toString());var _=e.frustum;var y=_.aspectRatio;var b="";var w="";if(c(y)){var C=S.toDegrees(_.fov);if(y>1){b=C;w=C/y}else{w=C;b=C*y}}r=r.replace("[horizFov]",b.toString());r=r.replace("[vertFov]",w.toString())}else{r=r.replace("[bboxWest]","-180");r=r.replace("[bboxSouth]","-90");r=r.replace("[bboxEast]","180");r=r.replace("[bboxNorth]","90");r=r.replace("[lookatLon]","");r=r.replace("[lookatLat]","");r=r.replace("[lookatRange]","");r=r.replace("[lookatTilt]","");r=r.replace("[lookatHeading]","");r=r.replace("[lookatTerrainLon]","");r=r.replace("[lookatTerrainLat]","");r=r.replace("[lookatTerrainAlt]","");r=r.replace("[cameraLon]","");r=r.replace("[cameraLat]","");r=r.replace("[cameraAlt]","");r=r.replace("[horizFov]","");r=r.replace("[vertFov]","")}if(c(t)){r=r.replace("[horizPixels]",t.clientWidth);r=r.replace("[vertPixels]",t.clientHeight)}else{r=r.replace("[horizPixels]","");r=r.replace("[vertPixels]","")}r=r.replace("[terrainEnabled]","1");r=r.replace("[clientVersion]","1");r=r.replace("[kmlVersion]","2.2");r=r.replace("[clientName]","Cesium");r=r.replace("[language]","English");return r}function It(e,t,r,i,n,a,o,s,d,f){var h=vt(e,t,r,i,n,a,o,s,d,f);var p=h.entity;var v=Ie(r,"Link",Ae.kml);if(!c(v)){v=Ie(r,"Url",Ae.kml)}if(c(v)){var g=Ne(v,"href",Ae.kml);var _;var w;var C;if(c(g)){var S=g;g=Fe(g,undefined,a,o,f);var T;if(/^data:/.test(g)){T=g;if(!/\.kmz/i.test(a)){S=m(S,a)}}else{S=g;_=Ne(v,"viewRefreshMode",Ae.kml);w=u(Ne(v,"viewBoundScale",Ae.kml),1);var E=_==="onStop"?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"";var P=u(Ne(v,"viewFormat",Ae.kml),E);var A=Ne(v,"httpQuery",Ae.kml);C=Et(P,A);T=Dt(e._camera,e._canvas,y(g,C,false),w,e._lastCameraView.bbox)}var O={sourceUri:S,uriResolver:o,context:p.id};var D=new X;var I=Nt(e,D,T,O).then(function(t){var r=e._entityCollection;var i=D.values;r.suspendEvents();for(var n=0;n<i.length;n++){var a=i[n];if(!c(a.parent)){a.parent=p;Ft(a)}r.add(a)}r.resumeEvents();var o=Ne(v,"refreshMode",Ae.kml);var s=u(Le(v,"refreshInterval",Ae.kml),0);if(o==="onInterval"&&s>0||o==="onExpire"||_==="onStop"){var d=Ie(t,"NetworkLinkControl",Ae.kml);var f=c(d);var h=b.now();var m={id:l(),href:g,cookie:"",queryString:C,lastUpdated:h,updating:false,entity:p,viewBoundScale:w,needsUpdate:false,cameraUpdateTime:h};var y=0;if(f){m.cookie=u(Ne(d,"cookie",Ae.kml),"");y=u(Le(d,"minRefreshPeriod",Ae.kml),0)}if(o==="onInterval"){if(f){s=Math.max(y,s)}m.refreshMode=St.INTERVAL;m.time=s}else if(o==="onExpire"){var S;if(f){S=Ne(d,"expires",Ae.kml)}if(c(S)){try{var T=b.fromIso8601(S);var E=b.secondsDifference(T,h);if(E>0&&E<y){b.addSeconds(h,y,T)}m.refreshMode=St.EXPIRE;m.time=T}catch(e){x("kml-refreshMode-onInterval-onExpire","KML - NetworkLinkControl expires is not a valid date")}}else{x("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}}else if(e._camera){m.refreshMode=St.STOP;m.time=u(Le(v,"viewRefreshTime",Ae.kml),0)}else{x("kml-refrehMode-onStop-noCamera","A NetworkLink with viewRefreshMode=onStop requires a camera be passed in when creating the KmlDataSource")}if(c(m.refreshMode)){e._networkLinks.set(m.id,m)}}else if(_==="onRegion"){x("kml-refrehMode-onRegion","KML - Unsupported viewRefreshMode: onRegion")}});s.push(I)}}}function Mt(e,t,r,i,n,a,o,s,l,u){var d=gt[t.localName];if(c(d)){d(e,r,t,i,n,a,o,s,l,u)}else{Ct(e,r,t,i,n,a,o,s,l)}}function Rt(e,t,r,i,n,a,o){t.removeAll();var s=[];var l=r.documentElement;var u=l.localName==="Document"?l:Ie(l,"Document",Ae.kml);var d=Ne(u,"name",Ae.kml);if(!c(d)&&c(i)){d=g(i)}if(!c(e._name)){e._name=d}var f=new X(e);return U.all(Ke(e,r,f,i,false,n,o)).then(function(){var l=r.documentElement;if(l.localName==="kml"){var u=l.childNodes;for(var d=0;d<u.length;d++){var h=u[d];if(c(gt[h.localName])){l=h;break}}}t.suspendEvents();Mt(e,l,undefined,t,f,i,n,s,a,o);t.resumeEvents();return U.all(s).then(function(){return r.documentElement})})}function Lt(e,t,r,i){var n=U.defer();V.createReader(new V.BlobReader(r),function(r){r.getEntries(function(a){var o=[];var s={};var l;var u;for(var d=0;d<a.length;d++){var f=a[d];if(!f.directory){var h=U.defer();o.push(h.promise);if(/\.kml$/i.test(f.filename)){if(!c(l)||!/\//i.test(f.filename)){if(c(l)){ge(r,l,s,u)}l=f;u=h}else{ge(r,f,s,h)}}else{ge(r,f,s,h)}}}if(c(l)){ve(r,l,s,u)}U.all(o).then(function(){r.close();if(!c(s.kml)){n.reject(new D("KMZ file does not contain a KML document."));return}s.keys=Object.keys(s);return Rt(e,t,s.kml,i,s)}).then(n.resolve).otherwise(n.reject)})},function(e){n.reject(e)});return n.promise}function Nt(e,t,r,i){i=u(i,u.EMPTY_OBJECT);var n=i.sourceUri;var a=i.uriResolver;var o=i.context;var s=c(i.query)?E(i.query):undefined;var l=r;if(typeof r==="string"){l=w(be(r,e._proxy,s));n=u(n,r)}return U(l).then(function(r){if(r instanceof Blob){return pe(r).then(function(i){if(i){return Lt(e,t,r,n)}return me(r).then(function(r){var i;var l;try{i=se.parseFromString(r,"application/xml")}catch(e){l=e.toString()}if(c(l)||i.body||i.documentElement.tagName==="parsererror"){var u=c(l)?l:i.documentElement.firstChild.nodeValue;if(!u){u=i.body.innerText}throw new D(u)}return Rt(e,t,i,n,a,o,s)})})}return Rt(e,t,r,n,a,o,s)}).otherwise(function(t){e._error.raiseEvent(e,t);console.log(t);return U.reject(t)})}function kt(t){t=u(t,{});var r=t.camera;var n=t.canvas;if(!c(r)){throw new f("options.camera is required.")}if(!c(n)){throw new f("options.canvas is required.")}this._changed=new p;this._error=new p;this._loading=new p;this._refresh=new p;this._unsupportedNode=new p;this._clock=undefined;this._entityCollection=new X(this);this._name=undefined;this._isLoading=false;this._proxy=t.proxy;this._pinBuilder=new P;this._networkLinks=new e;this._entityCluster=new Y;this._canvas=n;this._camera=r;this._lastCameraView={position:c(r)?i.clone(r.positionWC):undefined,direction:c(r)?i.clone(r.directionWC):undefined,up:c(r)?i.clone(r.upWC):undefined,bbox:c(r)?r.computeViewRectangle():O.clone(O.MAX_VALUE)}}kt.load=function(e,t){t=u(t,u.EMPTY_OBJECT);var r=new kt(t);return r.load(e,t)};d(kt.prototype,{name:{get:function(){return this._name},set:function(e){if(this._name!==e){this._name=e;this._changed.raiseEvent(this)}}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!c(e)){throw new f("value must be defined.")}this._entityCluster=e}}});kt.prototype.load=function(e,t){if(!c(e)){throw new f("data is required.")}t=u(t,{});H.setLoading(this,true);var r=this._name;this._name=undefined;this._clampToGround=u(t.clampToGround,false);var i=this;return Nt(this,this._entityCollection,e,t).then(function(){var e;var t=i._entityCollection.computeAvailability();var n=t.start;var s=t.stop;var l=b.equals(n,_.MINIMUM_VALUE);var u=b.equals(s,_.MAXIMUM_VALUE);if(!l||!u){var c;if(l){c=new Date;c.setHours(0,0,0,0);n=b.fromDate(c)}if(u){c=new Date;c.setHours(24,0,0,0);s=b.fromDate(c)}e=new j;e.startTime=n;e.stopTime=s;e.currentTime=b.clone(n);e.clockRange=a.LOOP_STOP;e.clockStep=o.SYSTEM_CLOCK_MULTIPLIER;e.multiplier=Math.round(Math.min(Math.max(b.secondsDifference(s,n)/60,1),31556900))}var d=false;if(e!==i._clock){i._clock=e;d=true}if(r!==i._name){d=true}if(d){i._changed.raiseEvent(i)}H.setLoading(i,false);return i}).otherwise(function(e){H.setLoading(i,false);i._error.raiseEvent(i,e);console.log(e);return U.reject(e)})};function Ft(e){var t=e.parent;if(c(t)){var r=t.availability;if(c(r)){var i=e.availability;if(c(i)){i.intersect(r)}else{e.availability=r}}}}function Bt(e,t,r,i,n){return function(a){if(!i.contains(t.id)){return}var o=false;var s=Ie(a,"NetworkLinkControl",Ae.kml);var l=c(s);var d=0;if(l){if(c(Ie(s,"Update",Ae.kml))){x("kml-networkLinkControl-update","KML - NetworkLinkControl updates aren't supported.");t.updating=false;i.remove(t.id);return}t.cookie=u(Ne(s,"cookie",Ae.kml),"");d=u(Le(s,"minRefreshPeriod",Ae.kml),0)}var f=b.now();var h=t.refreshMode;if(h===St.INTERVAL){if(c(s)){t.time=Math.max(d,t.time)}}else if(h===St.EXPIRE){var p;if(c(s)){p=Ne(s,"expires",Ae.kml)}if(c(p)){try{var m=b.fromIso8601(p);var v=b.secondsDifference(m,f);if(v>0&&v<d){b.addSeconds(f,d,m)}t.time=m}catch(e){x("kml-networkLinkControl-expires","KML - NetworkLinkControl expires is not a valid date");o=true}}else{x("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element");o=true}}var g=t.entity;var y=e._entityCollection;var w=r.values;function C(e){y.remove(e);var t=e._children;var r=t.length;for(var i=0;i<r;++i){C(t[i])}}y.suspendEvents();var S=y.values.slice();var T;for(T=0;T<S.length;++T){var E=S[T];if(E.parent===g){E.parent=undefined;C(E)}}y.resumeEvents();y.suspendEvents();for(T=0;T<w.length;T++){var P=w[T];if(!c(P.parent)){P.parent=g;Ft(P)}y.add(P)}y.resumeEvents();if(o){i.remove(t.id)}else{t.lastUpdated=f}var A=y.computeAvailability();var O=A.start;var D=A.stop;var I=b.equals(O,_.MINIMUM_VALUE);var M=b.equals(D,_.MAXIMUM_VALUE);if(!I||!M){var R=e._clock;if(R.startTime!==O||R.stopTime!==D){R.startTime=O;R.stopTime=D;e._changed.raiseEvent(e)}}t.updating=false;t.needsUpdate=false;e._refresh.raiseEvent(e,n)}}var Ut=new e;kt.prototype.update=function(t){var r=this._networkLinks;if(r.length===0){return true}var n=b.now();var a=this;Ut.removeAll();function o(e){var t=e._children;var r=t.length;for(var i=0;i<r;++i){var n=t[i];Ut.set(n.id,n);o(n)}}var s=false;var l=this._lastCameraView;var u=this._camera;if(c(u)&&!(u.positionWC.equalsEpsilon(l.position,S.EPSILON7)&&u.directionWC.equalsEpsilon(l.direction,S.EPSILON7)&&u.upWC.equalsEpsilon(l.up,S.EPSILON7))){l.position=i.clone(u.positionWC);l.direction=i.clone(u.directionWC);l.up=i.clone(u.upWC);l.bbox=u.computeViewRectangle();s=true}var d=new e;var f=false;r.values.forEach(function(e){var t=e.entity;if(Ut.contains(t.id)){return}if(!e.updating){var r=false;if(e.refreshMode===St.INTERVAL){if(b.secondsDifference(n,e.lastUpdated)>e.time){r=true}}else if(e.refreshMode===St.EXPIRE){if(b.greaterThan(n,e.time)){r=true}}else if(e.refreshMode===St.STOP){if(s){e.needsUpdate=true;e.cameraUpdateTime=n}if(e.needsUpdate&&b.secondsDifference(n,e.cameraUpdateTime)>=e.time){r=true}}if(r){o(t);e.updating=true;var i=new X;var u=y(e.href,Et(e.cookie,e.queryString),false);u=Dt(a._camera,a._canvas,u,e.viewBoundScale,l.bbox);Nt(a,i,u,{context:t.id}).then(Bt(a,e,i,d,u)).otherwise(function(t){var r="NetworkLink "+e.href+" refresh failed: "+t;console.log(r);a._error.raiseEvent(a,r)});f=true}}d.set(e.id,e)});if(f){this._networkLinks=d;this._changed.raiseEvent(this)}return true};function Vt(){this.author={name:undefined,uri:undefined,email:undefined};this.link={href:undefined,hreflang:undefined,rel:undefined,type:undefined,title:undefined,length:undefined};this.address=undefined;this.phoneNumber=undefined;this.snippet=undefined;this.extendedData=undefined}return kt});define("DataSources/VelocityOrientationProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Ellipsoid","../Core/Event","../Core/Matrix3","../Core/Quaternion","../Core/Transforms","./Property","./VelocityVectorProperty"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";function d(e,r){this._velocityVectorProperty=new c(e,true);this._subscription=undefined;this._ellipsoid=undefined;this._definitionChanged=new a;this.ellipsoid=t(r,n.WGS84);var i=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){i._definitionChanged.raiseEvent(i)})}i(d.prototype,{isConstant:{get:function(){return u.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){var t=this._ellipsoid;if(t!==e){this._ellipsoid=e;this._definitionChanged.raiseEvent(this)}}}});var f=new e;var h=new e;var p=new o;d.prototype.getValue=function(e,t){var i=this._velocityVectorProperty._getValue(e,h,f);if(!r(i)){return undefined}l.rotationMatrixFromPositionVelocity(f,i,this._ellipsoid,p);return s.fromRotationMatrix(p,t)};d.prototype.equals=function(e){return this===e||e instanceof d&&u.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};return d});define("DataSources/Visualizer",["../Core/DeveloperError"],function(e){"use strict";function t(){e.throwInstantiationError()}t.prototype.update=e.throwInstantiationError;t.prototype.getBoundingSphere=e.throwInstantiationError;t.prototype.isDestroyed=e.throwInstantiationError;t.prototype.destroy=e.throwInstantiationError;return t});define("Renderer/ClearCommand",["../Core/Color","../Core/defaultValue","../Core/freezeObject"],function(e,t,r){"use strict";function i(e){e=t(e,t.EMPTY_OBJECT);this.color=e.color;this.depth=e.depth;this.stencil=e.stencil;this.renderState=e.renderState;this.framebuffer=e.framebuffer;this.owner=e.owner;this.pass=e.pass}i.ALL=r(new i({color:new e(0,0,0,0),depth:1,stencil:0}));i.prototype.execute=function(e,t){e.clear(this,t)};return i});define("Renderer/ComputeCommand",["../Core/defaultValue","./Pass"],function(e,t){"use strict";function r(r){r=e(r,e.EMPTY_OBJECT);this.vertexArray=r.vertexArray;this.fragmentShaderSource=r.fragmentShaderSource;this.shaderProgram=r.shaderProgram;this.uniformMap=r.uniformMap;this.outputTexture=r.outputTexture;this.preExecute=r.preExecute;this.postExecute=r.postExecute;this.persists=e(r.persists,false);this.pass=t.COMPUTE;this.owner=r.owner}r.prototype.execute=function(e){e.execute(this)};return r});define("Shaders/ViewportQuadVS",[],function(){"use strict";return"attribute vec4 position;\nattribute vec2 textureCoordinates;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main() \n{\n    gl_Position = position;\n    v_textureCoordinates = textureCoordinates;\n}\n"});define("Renderer/ComputeEngine",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/PrimitiveType","../Shaders/ViewportQuadVS","./ClearCommand","./DrawCommand","./Framebuffer","./RenderState","./ShaderProgram"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(e){this._context=e}var h;var p=new l({primitiveType:a.TRIANGLES});var m=new s({color:new t(0,0,0,0)});function v(e,t){return new u({context:e,colorTextures:[t],destroyAttachments:false})}function g(e,t){return d.fromCache({context:e,vertexShaderSource:o,fragmentShaderSource:t,attributeLocations:{position:0,textureCoordinates:1}})}function _(t,i){if(!r(h)||h.viewport.width!==t||h.viewport.height!==i){h=c.fromCache({viewport:new e(0,0,t,i)})}return h}f.prototype.execute=function(e){if(!r(e)){throw new n("computeCommand is required.")}if(r(e.preExecute)){e.preExecute(e)}if(!r(e.fragmentShaderSource)&&!r(e.shaderProgram)){throw new n("computeCommand.fragmentShaderSource or computeCommand.shaderProgram is required.")}if(!r(e.outputTexture)){throw new n("computeCommand.outputTexture is required.")}var t=e.outputTexture;var i=t.width;var a=t.height;var o=this._context;var s=r(e.vertexArray)?e.vertexArray:o.getViewportQuadVertexArray();var l=r(e.shaderProgram)?e.shaderProgram:g(o,e.fragmentShaderSource);var u=v(o,t);var c=_(i,a);var d=e.uniformMap;var f=m;f.framebuffer=u;f.renderState=c;f.execute(o);var h=p;h.vertexArray=s;h.renderState=c;h.shaderProgram=l;h.uniformMap=d;h.framebuffer=u;h.execute(o);u.destroy();if(!e.persists){l.destroy();if(r(e.vertexArray)){s.destroy()}}if(r(e.postExecute)){e.postExecute(t)}};f.prototype.isDestroyed=function(){return false};f.prototype.destroy=function(){return i(this)};return f});define("Renderer/PassState",[],function(){"use strict";function e(e){this.context=e;this.framebuffer=undefined;this.blendingEnabled=undefined;this.scissorTest=undefined;this.viewport=undefined}return e});define("Renderer/RenderbufferFormat",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var r={RGBA4:t.RGBA4,RGB5_A1:t.RGB5_A1,RGB565:t.RGB565,DEPTH_COMPONENT16:t.DEPTH_COMPONENT16,STENCIL_INDEX8:t.STENCIL_INDEX8,DEPTH_STENCIL:t.DEPTH_STENCIL,validate:function(e){return e===r.RGBA4||e===r.RGB5_A1||e===r.RGB565||e===r.DEPTH_COMPONENT16||e===r.STENCIL_INDEX8||e===r.DEPTH_STENCIL}};return e(r)});define("Renderer/Renderbuffer",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","./ContextLimits","./RenderbufferFormat"],function(e,t,r,i,n,a,o){"use strict";function s(r){r=e(r,e.EMPTY_OBJECT);if(!t(r.context)){throw new n("options.context is required.")}var i=r.context;var s=i._gl;var l=a.maximumRenderbufferSize;var u=e(r.format,o.RGBA4);var c=t(r.width)?r.width:s.drawingBufferWidth;var d=t(r.height)?r.height:s.drawingBufferHeight;if(!o.validate(u)){throw new n("Invalid format.")}if(c<=0){throw new n("Width must be greater than zero.")}if(c>l){throw new n("Width must be less than or equal to the maximum renderbuffer size ("+l+").  Check maximumRenderbufferSize.")}if(d<=0){throw new n("Height must be greater than zero.")}if(d>l){throw new n("Height must be less than or equal to the maximum renderbuffer size ("+l+").  Check maximumRenderbufferSize.")}this._gl=s;this._format=u;this._width=c;this._height=d;this._renderbuffer=this._gl.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,this._renderbuffer);s.renderbufferStorage(s.RENDERBUFFER,u,c,d);s.bindRenderbuffer(s.RENDERBUFFER,null)}r(s.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}});s.prototype._getRenderbuffer=function(){return this._renderbuffer};s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){this._gl.deleteRenderbuffer(this._renderbuffer);return i(this)};return s});define("Renderer/PickFramebuffer",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","./Framebuffer","./PassState","./Renderbuffer","./RenderbufferFormat","./Texture"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(t){var r=new o(t);r.blendingEnabled=false;r.scissorTest={enabled:true,rectangle:new e};r.viewport=new e;this._context=t;this._fb=undefined;this._passState=r;this._width=0;this._height=0}c.prototype.begin=function(t){var r=this._context;var n=r.drawingBufferWidth;var o=r.drawingBufferHeight;e.clone(t,this._passState.scissorTest.rectangle);if(!i(this._fb)||this._width!==n||this._height!==o){this._width=n;this._height=o;this._fb=this._fb&&this._fb.destroy();this._fb=new a({context:r,colorTextures:[new u({context:r,width:n,height:o})],depthStencilRenderbuffer:new s({context:r,format:l.DEPTH_STENCIL})});this._passState.framebuffer=this._fb}this._passState.viewport.width=n;this._passState.viewport.height=o;return this._passState};var d=new t;c.prototype.end=function(e){var n=r(e.width,1);var a=r(e.height,1);var o=this._context;var s=o.readPixels({x:e.x,y:e.y,width:n,height:a,framebuffer:this._fb});var l=Math.max(n,a);var u=l*l;var c=Math.floor(n*.5);var f=Math.floor(a*.5);var h=0;var p=0;var m=0;var v=-1;for(var g=0;g<u;++g){if(-c<=h&&h<=c&&-f<=p&&p<=f){var _=4*((f-p)*n+h+c);d.red=t.byteToFloat(s[_]);d.green=t.byteToFloat(s[_+1]);d.blue=t.byteToFloat(s[_+2]);d.alpha=t.byteToFloat(s[_+3]);var y=o.getObjectByPickColor(d);if(i(y)){return y}}if(h===p||h<0&&-h===p||h>0&&h===1-p){var b=m;m=-v;v=b}h+=m;p+=v}return undefined};c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){this._fb=this._fb&&this._fb.destroy();return n(this)};return c});define("Renderer/ShaderCache",["../Core/defined","../Core/defineProperties","../Core/destroyObject","./ShaderProgram","./ShaderSource"],function(e,t,r,i,n){"use strict";function a(e){this._context=e;this._shaders={};this._numberOfShaders=0;this._shadersToRelease={}}t(a.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}});a.prototype.replaceShaderProgram=function(t){if(e(t.shaderProgram)){t.shaderProgram.destroy()}return this.getShaderProgram(t)};a.prototype.getShaderProgram=function(t){var r=t.vertexShaderSource;var a=t.fragmentShaderSource;var o=t.attributeLocations;if(typeof r==="string"){r=new n({sources:[r]})}if(typeof a==="string"){a=new n({sources:[a]})}var s=r.createCombinedVertexShader(this._context);var l=a.createCombinedFragmentShader(this._context);var u=s+l+JSON.stringify(o);var c;if(e(this._shaders[u])){c=this._shaders[u];delete this._shadersToRelease[u]}else{var d=this._context;var f=new i({gl:d._gl,logShaderCompilation:d.logShaderCompilation,debugShaders:d.debugShaders,vertexShaderSource:r,vertexShaderText:s,fragmentShaderSource:a,fragmentShaderText:l,attributeLocations:o});c={cache:this,shaderProgram:f,keyword:u,derivedKeywords:[],count:0};f._cachedShader=c;this._shaders[u]=c;++this._numberOfShaders}++c.count;return c.shaderProgram};a.prototype.getDerivedShaderProgram=function(t,r){var i=t._cachedShader;var n=r+i.keyword;var a=this._shaders[n];if(!e(a)){return undefined}return a.shaderProgram};a.prototype.createDerivedShaderProgram=function(e,t,r){var a=e._cachedShader;var o=t+a.keyword;var s=r.vertexShaderSource;var l=r.fragmentShaderSource;var u=r.attributeLocations;if(typeof s==="string"){s=new n({sources:[s]})}if(typeof l==="string"){l=new n({sources:[l]})}var c=this._context;var d=s.createCombinedVertexShader(c);var f=l.createCombinedFragmentShader(c);var h=new i({gl:c._gl,logShaderCompilation:c.logShaderCompilation,debugShaders:c.debugShaders,vertexShaderSource:s,vertexShaderText:d,fragmentShaderSource:l,fragmentShaderText:f,attributeLocations:u});var p={cache:this,shaderProgram:h,keyword:o,derivedKeywords:[],count:0};a.derivedKeywords.push(t);h._cachedShader=p;this._shaders[o]=p;return h};function o(e,t){var r=t.derivedKeywords;var i=r.length;for(var n=0;n<i;++n){var a=r[n]+t.keyword;var s=e._shaders[a];o(e,s)}delete e._shaders[t.keyword];t.shaderProgram.finalDestroy()}a.prototype.destroyReleasedShaderPrograms=function(){var e=this._shadersToRelease;for(var t in e){if(e.hasOwnProperty(t)){var r=e[t];o(this,r);--this._numberOfShaders}}this._shadersToRelease={}};a.prototype.releaseShaderProgram=function(t){if(e(t)){var r=t._cachedShader;if(r&&--r.count===0){this._shadersToRelease[r.keyword]=r}}};a.prototype.isDestroyed=function(){return false};a.prototype.destroy=function(){var e=this._shaders;for(var t in e){if(e.hasOwnProperty(t)){e[t].shaderProgram.finalDestroy()}}return r(this)};return a});define("Renderer/UniformState",["./Sampler","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/EncodedCartesian3","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/OrthographicFrustum","../Core/Simon1994PlanetaryPositions","../Core/Transforms","../Scene/SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g){"use strict";function _(){this.globeDepthTexture=undefined;this._viewport=new t;this._viewportCartesian4=new n;this._viewportDirty=false;this._viewportOrthographicMatrix=h.clone(h.IDENTITY);this._viewportTransformation=h.clone(h.IDENTITY);this._model=h.clone(h.IDENTITY);this._view=h.clone(h.IDENTITY);this._inverseView=h.clone(h.IDENTITY);this._projection=h.clone(h.IDENTITY);this._infiniteProjection=h.clone(h.IDENTITY);this._entireFrustum=new r;this._currentFrustum=new r;this._frustumPlanes=new n;this._frameState=undefined;this._temeToPseudoFixed=f.clone(h.IDENTITY);this._view3DDirty=true;this._view3D=new h;this._inverseView3DDirty=true;this._inverseView3D=new h;this._inverseModelDirty=true;this._inverseModel=new h;this._inverseTransposeModelDirty=true;this._inverseTransposeModel=new f;this._viewRotation=new f;this._inverseViewRotation=new f;this._viewRotation3D=new f;this._inverseViewRotation3D=new f;this._inverseProjectionDirty=true;this._inverseProjection=new h;this._modelViewDirty=true;this._modelView=new h;this._modelView3DDirty=true;this._modelView3D=new h;this._modelViewRelativeToEyeDirty=true;this._modelViewRelativeToEye=new h;this._inverseModelViewDirty=true;this._inverseModelView=new h;this._inverseModelView3DDirty=true;this._inverseModelView3D=new h;this._viewProjectionDirty=true;this._viewProjection=new h;this._inverseViewProjectionDirty=true;this._inverseViewProjection=new h;this._modelViewProjectionDirty=true;this._modelViewProjection=new h;this._inverseModelViewProjectionDirty=true;this._inverseModelViewProjection=new h;this._modelViewProjectionRelativeToEyeDirty=true;this._modelViewProjectionRelativeToEye=new h;this._modelViewInfiniteProjectionDirty=true;this._modelViewInfiniteProjection=new h;this._normalDirty=true;this._normal=new f;this._normal3DDirty=true;this._normal3D=new f;this._inverseNormalDirty=true;this._inverseNormal=new f;this._inverseNormal3DDirty=true;this._inverseNormal3D=new f;this._encodedCameraPositionMCDirty=true;this._encodedCameraPositionMC=new c;this._cameraPosition=new i;this._sunPositionWC=new i;this._sunPositionColumbusView=new i;this._sunDirectionWC=new i;this._sunDirectionEC=new i;this._moonDirectionEC=new i;this._pass=undefined;this._mode=undefined;this._mapProjection=undefined;this._cameraDirection=new i;this._cameraRight=new i;this._cameraUp=new i;this._frustum2DWidth=0;this._eyeHeight2D=new r;this._resolutionScale=1;this._orthographicIn3D=false;this._backgroundColor=new o;this._brdfLut=new e;this._environmentMap=new e;this._fogDensity=undefined;this._imagerySplitPosition=0;this._pixelSizePerMeter=undefined;this._geometricToleranceOverMeter=undefined;this._minimumDisableDepthTestDistance=undefined}u(_.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(e){if(!t.equals(e,this._viewport)){t.clone(e,this._viewport);var r=this._viewport;var i=this._viewportCartesian4;i.x=r.x;i.y=r.y;i.z=r.width;i.w=r.height;this._viewportDirty=true}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){P(this);return this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){P(this);return this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){h.clone(e,this._model);this._modelView3DDirty=true;this._inverseModelView3DDirty=true;this._inverseModelDirty=true;this._inverseTransposeModelDirty=true;this._modelViewDirty=true;this._inverseModelViewDirty=true;this._modelViewRelativeToEyeDirty=true;this._inverseModelViewDirty=true;this._modelViewProjectionDirty=true;this._inverseModelViewProjectionDirty=true;this._modelViewProjectionRelativeToEyeDirty=true;this._modelViewInfiniteProjectionDirty=true;this._normalDirty=true;this._inverseNormalDirty=true;this._normal3DDirty=true;this._inverseNormal3DDirty=true;this._encodedCameraPositionMCDirty=true}},inverseModel:{get:function(){if(this._inverseModelDirty){this._inverseModelDirty=false;h.inverse(this._model,this._inverseModel)}return this._inverseModel}},inverseTransposeModel:{get:function(){var e=this._inverseTransposeModel;if(this._inverseTransposeModelDirty){this._inverseTransposeModelDirty=false;h.getRotation(this.inverseModel,e);f.transpose(e,e)}return e}},view:{get:function(){return this._view}},view3D:{get:function(){ee(this);return this._view3D}},viewRotation:{get:function(){ee(this);return this._viewRotation}},viewRotation3D:{get:function(){ee(this);return this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){te(this);return this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){te(this);return this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){A(this);return this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){O(this);return this._modelView}},modelView3D:{get:function(){D(this);return this._modelView3D}},modelViewRelativeToEye:{get:function(){k(this);return this._modelViewRelativeToEye}},inverseModelView:{get:function(){I(this);return this._inverseModelView}},inverseModelView3D:{get:function(){M(this);return this._inverseModelView3D}},viewProjection:{get:function(){R(this);return this._viewProjection}},inverseViewProjection:{get:function(){L(this);return this._inverseViewProjection}},modelViewProjection:{get:function(){N(this);return this._modelViewProjection}},inverseModelViewProjection:{get:function(){F(this);return this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){B(this);return this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){U(this);return this._modelViewInfiniteProjection}},normal:{get:function(){V(this);return this._normal}},normal3D:{get:function(){z(this);return this._normal3D}},inverseNormal:{get:function(){q(this);return this._inverseNormal}},inverseNormal3D:{get:function(){G(this);return this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},encodedCameraPositionMCHigh:{get:function(){j(this);return this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){j(this);return this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},resolutionScale:{get:function(){return this._resolutionScale}},fogDensity:{get:function(){return this._fogDensity}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},imagerySplitPosition:{get:function(){return this._imagerySplitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}}});function y(e,t){h.clone(t,e._view);h.getRotation(t,e._viewRotation);e._view3DDirty=true;e._inverseView3DDirty=true;e._modelViewDirty=true;e._modelView3DDirty=true;e._modelViewRelativeToEyeDirty=true;e._inverseModelViewDirty=true;e._inverseModelView3DDirty=true;e._viewProjectionDirty=true;e._inverseViewProjectionDirty=true;e._modelViewProjectionDirty=true;e._modelViewProjectionRelativeToEyeDirty=true;e._modelViewInfiniteProjectionDirty=true;e._normalDirty=true;e._inverseNormalDirty=true;e._normal3DDirty=true;e._inverseNormal3DDirty=true}function b(e,t){h.clone(t,e._inverseView);h.getRotation(t,e._inverseViewRotation)}function w(e,t){h.clone(t,e._projection);e._inverseProjectionDirty=true;e._viewProjectionDirty=true;e._inverseViewProjectionDirty=true;e._modelViewProjectionDirty=true;e._modelViewProjectionRelativeToEyeDirty=true}function C(e,t){h.clone(t,e._infiniteProjection);e._modelViewInfiniteProjectionDirty=true}function S(e,t){i.clone(t.positionWC,e._cameraPosition);i.clone(t.directionWC,e._cameraDirection);i.clone(t.rightWC,e._cameraRight);i.clone(t.upWC,e._cameraUp);e._encodedCameraPositionMCDirty=true}var T=new f;var E=new a;function x(e,t){if(!l(v.computeIcrfToFixedMatrix(t.time,T))){T=v.computeTemeToPseudoFixedMatrix(t.time,T)}var r=m.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);f.multiplyByVector(T,r,r);i.normalize(r,e._sunDirectionWC);r=f.multiplyByVector(e.viewRotation3D,r,e._sunDirectionEC);i.normalize(r,r);r=m.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC);f.multiplyByVector(T,r,r);f.multiplyByVector(e.viewRotation3D,r,r);i.normalize(r,r);var n=t.mapProjection;var a=n.ellipsoid;var o=a.cartesianToCartographic(e._sunPositionWC,E);n.project(o,e._sunPositionColumbusView)}_.prototype.updateCamera=function(e){y(this,e.viewMatrix);b(this,e.inverseViewMatrix);S(this,e);this._entireFrustum.x=e.frustum.near;this._entireFrustum.y=e.frustum.far;this.updateFrustum(e.frustum);this._orthographicIn3D=this._mode!==g.SCENE2D&&e.frustum instanceof p};_.prototype.updateFrustum=function(e){w(this,e.projectionMatrix);if(l(e.infiniteProjectionMatrix)){C(this,e.infiniteProjectionMatrix)}this._currentFrustum.x=e.near;this._currentFrustum.y=e.far;if(l(e._offCenterFrustum)){e=e._offCenterFrustum}this._frustumPlanes.x=e.top;this._frustumPlanes.y=e.bottom;this._frustumPlanes.z=e.left;this._frustumPlanes.w=e.right};_.prototype.updatePass=function(e){this._pass=e};_.prototype.update=function(e){this._mode=e.mode;this._mapProjection=e.mapProjection;var t=e.context._canvas;this._resolutionScale=t.width/t.clientWidth;var r=e.camera;this.updateCamera(r);if(e.mode===g.SCENE2D){this._frustum2DWidth=r.frustum.right-r.frustum.left;this._eyeHeight2D.x=this._frustum2DWidth*.5;this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x}else{this._frustum2DWidth=0;this._eyeHeight2D.x=0;this._eyeHeight2D.y=0}x(this,e);var i=e.brdfLutGenerator;var n=l(i)?i.colorTexture:undefined;this._brdfLut=n;this._environmentMap=s(e.environmentMap,e.context.defaultCubeMap);this._fogDensity=e.fog.density;this._frameState=e;this._temeToPseudoFixed=v.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed);this._imagerySplitPosition=e.imagerySplitPosition*e.context.drawingBufferWidth;var a=r.frustum.fov;var u=this._viewport;var c;if(u.height>u.width){c=Math.tan(.5*a)*2/u.height}else{c=Math.tan(.5*a)*2/u.width}this._geometricToleranceOverMeter=c*e.maximumScreenSpaceError;o.clone(e.backgroundColor,this._backgroundColor);this._minimumDisableDepthTestDistance=e.minimumDisableDepthTestDistance;this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance;if(this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY){this._minimumDisableDepthTestDistance=-1}};function P(e){if(e._viewportDirty){var t=e._viewport;h.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix);h.computeViewportTransformation(t,0,1,e._viewportTransformation);e._viewportDirty=false}}function A(e){if(e._inverseProjectionDirty){e._inverseProjectionDirty=false;if(e._mode!==g.SCENE2D&&e._mode!==g.MORPHING&&!e._orthographicIn3D){h.inverse(e._projection,e._inverseProjection)}else{h.clone(h.ZERO,e._inverseProjection)}}}function O(e){if(e._modelViewDirty){e._modelViewDirty=false;h.multiplyTransformation(e._view,e._model,e._modelView)}}function D(e){if(e._modelView3DDirty){e._modelView3DDirty=false;h.multiplyTransformation(e.view3D,e._model,e._modelView3D)}}function I(e){if(e._inverseModelViewDirty){e._inverseModelViewDirty=false;h.inverse(e.modelView,e._inverseModelView)}}function M(e){if(e._inverseModelView3DDirty){e._inverseModelView3DDirty=false;h.inverse(e.modelView3D,e._inverseModelView3D)}}function R(e){if(e._viewProjectionDirty){e._viewProjectionDirty=false;h.multiply(e._projection,e._view,e._viewProjection)}}function L(e){if(e._inverseViewProjectionDirty){e._inverseViewProjectionDirty=false;h.inverse(e.viewProjection,e._inverseViewProjection)}}function N(e){if(e._modelViewProjectionDirty){e._modelViewProjectionDirty=false;h.multiply(e._projection,e.modelView,e._modelViewProjection)}}function k(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=false;var t=e.modelView;var r=e._modelViewRelativeToEye;r[0]=t[0];r[1]=t[1];r[2]=t[2];r[3]=t[3];r[4]=t[4];r[5]=t[5];r[6]=t[6];r[7]=t[7];r[8]=t[8];r[9]=t[9];r[10]=t[10];r[11]=t[11];r[12]=0;r[13]=0;r[14]=0;r[15]=t[15]}}function F(e){if(e._inverseModelViewProjectionDirty){e._inverseModelViewProjectionDirty=false;h.inverse(e.modelViewProjection,e._inverseModelViewProjection)}}function B(e){if(e._modelViewProjectionRelativeToEyeDirty){e._modelViewProjectionRelativeToEyeDirty=false;h.multiply(e._projection,e.modelViewRelativeToEye,e._modelViewProjectionRelativeToEye)}}function U(e){if(e._modelViewInfiniteProjectionDirty){e._modelViewInfiniteProjectionDirty=false;h.multiply(e._infiniteProjection,e.modelView,e._modelViewInfiniteProjection)}}function V(e){if(e._normalDirty){e._normalDirty=false;var t=e._normal;h.getRotation(e.inverseModelView,t);f.transpose(t,t)}}function z(e){if(e._normal3DDirty){e._normal3DDirty=false;var t=e._normal3D;h.getRotation(e.inverseModelView3D,t);f.transpose(t,t)}}function q(e){if(e._inverseNormalDirty){e._inverseNormalDirty=false;h.getRotation(e.inverseModelView,e._inverseNormal)}}function G(e){if(e._inverseNormal3DDirty){e._inverseNormal3DDirty=false;h.getRotation(e.inverseModelView3D,e._inverseNormal3D)}}var H=new i;function j(e){if(e._encodedCameraPositionMCDirty){e._encodedCameraPositionMCDirty=false;h.multiplyByPoint(e.inverseModel,e._cameraPosition,H);c.fromCartesian(H,e._encodedCameraPositionMC)}}var W=new i;var Y=new i;var X=new i;var Q=new i;var Z=new a;var K=new i;var J=new h;function $(e,t,r,n,a,o,s,u){var c=W;c.x=e.y;c.y=e.z;c.z=e.x;var f=Y;f.x=r.y;f.y=r.z;f.z=r.x;var p=X;p.x=n.y;p.y=n.z;p.z=n.x;var m=Q;m.x=t.y;m.y=t.z;m.z=t.x;if(o===g.SCENE2D){c.z=a*.5}var _=s.unproject(c,Z);_.longitude=d.clamp(_.longitude,-Math.PI,Math.PI);_.latitude=d.clamp(_.latitude,-d.PI_OVER_TWO,d.PI_OVER_TWO);var y=s.ellipsoid;var b=y.cartographicToCartesian(_,K);var w=v.eastNorthUpToFixedFrame(b,y,J);h.multiplyByPointAsVector(w,f,f);h.multiplyByPointAsVector(w,p,p);h.multiplyByPointAsVector(w,m,m);if(!l(u)){u=new h}u[0]=f.x;u[1]=p.x;u[2]=-m.x;u[3]=0;u[4]=f.y;u[5]=p.y;u[6]=-m.y;u[7]=0;u[8]=f.z;u[9]=p.z;u[10]=-m.z;u[11]=0;u[12]=-i.dot(f,b);u[13]=-i.dot(p,b);u[14]=i.dot(m,b);u[15]=1;return u}function ee(e){if(e._view3DDirty){if(e._mode===g.SCENE3D){h.clone(e._view,e._view3D)}else{$(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D)}h.getRotation(e._view3D,e._viewRotation3D);e._view3DDirty=false}}function te(e){if(e._inverseView3DDirty){h.inverseTransformation(e.view3D,e._inverseView3D);h.getRotation(e._inverseView3D,e._inverseViewRotation3D);e._inverseView3DDirty=false}}return _});define("Renderer/Context",["../Core/clone","../Core/Color","../Core/ComponentDatatype","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/GeometryAttribute","../Core/Matrix4","../Core/PrimitiveType","../Core/RuntimeError","../Core/WebGLConstants","../Shaders/ViewportQuadVS","./BufferUsage","./ClearCommand","./ContextLimits","./CubeMap","./DrawCommand","./PassState","./PickFramebuffer","./RenderState","./ShaderCache","./ShaderProgram","./Texture","./UniformState","./VertexArray"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A){"use strict";function O(e,t){var r="WebGL Error:  ";switch(t){case e.INVALID_ENUM:r+="INVALID_ENUM";break;case e.INVALID_VALUE:r+="INVALID_VALUE";break;case e.INVALID_OPERATION:r+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:r+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:r+="CONTEXT_LOST_WEBGL lost";break;default:r+="Unknown ("+t+")"}return r}function D(e,t,r,i){var n=O(e,i)+": "+t.name+"(";for(var a=0;a<r.length;++a){if(a!==0){n+=", "}n+=r[a]}n+=");";return n}function I(e,t,r){var i=e.getError();if(i!==e.NO_ERROR){throw new h(D(e,t,r,i))}}function M(e,t,r){return{get:function(){var i=e[t];r(e,"get: "+t,i);return e[t]},set:function(i){e[t]=i;r(e,"set: "+t,i)}}}function R(e,t){if(!a(t)){return e}function r(r){return function(){var i=r.apply(e,arguments);t(e,r,arguments);return i}}var i={};for(var n in e){var o=e[n];if(o instanceof Function){i[n]=r(o)}else{Object.defineProperty(i,n,M(e,n,t))}}return i}function L(e,t){var r=t.length;for(var i=0;i<r;++i){var n=e.getExtension(t[i]);if(n){return n}}return undefined}function N(r,o){if(typeof WebGLRenderingContext==="undefined"){throw new h("The browser does not support WebGL.  Visit http://get.webgl.org.")}if(!a(r)){throw new l("canvas is required.")}this._canvas=r;o=e(o,true);o=n(o,{});o.allowTextureFilterAnisotropic=n(o.allowTextureFilterAnisotropic,true);var s=n(o.webgl,{});s.alpha=n(s.alpha,false);s.stencil=n(s.stencil,true);var u=false;var c=u&&typeof WebGL2RenderingContext!=="undefined";var d=false;var f;var m=o.getWebGLStub;if(!a(m)){if(c){f=r.getContext("webgl2",s)||r.getContext("experimental-webgl2",s)||undefined;if(a(f)){d=true}}if(!a(f)){f=r.getContext("webgl",s)||r.getContext("experimental-webgl",s)||undefined}if(!a(f)){throw new h("The browser supports WebGL, but initialization failed.")}}else{f=m(r,s)}this._originalGLContext=f;this._gl=f;this._webgl2=d;this._id=i();this.validateFramebuffer=false;this.validateShaderProgram=false;this.logShaderCompilation=false;this._throwOnWebGLError=false;this._shaderCache=new T(this);var v=f;this._stencilBits=v.getParameter(v.STENCIL_BITS);_._maximumCombinedTextureImageUnits=v.getParameter(v.MAX_COMBINED_TEXTURE_IMAGE_UNITS);_._maximumCubeMapSize=v.getParameter(v.MAX_CUBE_MAP_TEXTURE_SIZE);_._maximumFragmentUniformVectors=v.getParameter(v.MAX_FRAGMENT_UNIFORM_VECTORS);_._maximumTextureImageUnits=v.getParameter(v.MAX_TEXTURE_IMAGE_UNITS);_._maximumRenderbufferSize=v.getParameter(v.MAX_RENDERBUFFER_SIZE);_._maximumTextureSize=v.getParameter(v.MAX_TEXTURE_SIZE);_._maximumVaryingVectors=v.getParameter(v.MAX_VARYING_VECTORS);_._maximumVertexAttributes=v.getParameter(v.MAX_VERTEX_ATTRIBS);_._maximumVertexTextureImageUnits=v.getParameter(v.MAX_VERTEX_TEXTURE_IMAGE_UNITS);_._maximumVertexUniformVectors=v.getParameter(v.MAX_VERTEX_UNIFORM_VECTORS);var g=v.getParameter(v.ALIASED_LINE_WIDTH_RANGE);_._minimumAliasedLineWidth=g[0];_._maximumAliasedLineWidth=g[1];var y=v.getParameter(v.ALIASED_POINT_SIZE_RANGE);_._minimumAliasedPointSize=y[0];_._maximumAliasedPointSize=y[1];var b=v.getParameter(v.MAX_VIEWPORT_DIMS);_._maximumViewportWidth=b[0];_._maximumViewportHeight=b[1];var C=v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.HIGH_FLOAT);_._highpFloatSupported=C.precision!==0;var E=v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.HIGH_INT);_._highpIntSupported=E.rangeMax!==0;this._antialias=v.getContextAttributes().antialias;this._standardDerivatives=!!L(v,["OES_standard_derivatives"]);this._blendMinmax=!!L(v,["EXT_blend_minmax"]);this._elementIndexUint=!!L(v,["OES_element_index_uint"]);this._depthTexture=!!L(v,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]);this._textureFloat=!!L(v,["OES_texture_float"]);this._fragDepth=!!L(v,["EXT_frag_depth"]);this._debugShaders=L(v,["WEBGL_debug_shaders"]);this._colorBufferFloat=this._webgl2&&!!L(v,["EXT_color_buffer_float"]);this._s3tc=!!L(v,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]);this._pvrtc=!!L(v,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]);this._etc1=!!L(v,["WEBGL_compressed_texture_etc1"]);var x=o.allowTextureFilterAnisotropic?L(v,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):undefined;this._textureFilterAnisotropic=x;_._maximumTextureFilterAnisotropy=a(x)?v.getParameter(x.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1;var A;var O;var D;var I;var M;var R;var N;var k;var F;var B;if(d){var U=this;A=function(){return U._gl.createVertexArray()};O=function(e){U._gl.bindVertexArray(e)};D=function(e){U._gl.deleteVertexArray(e)};I=function(e,t,r,i,n){v.drawElementsInstanced(e,t,r,i,n)};M=function(e,t,r,i){v.drawArraysInstanced(e,t,r,i)};R=function(e,t){v.vertexAttribDivisor(e,t)};N=function(e){v.drawBuffers(e)}}else{k=L(v,["OES_vertex_array_object"]);if(a(k)){A=function(){return k.createVertexArrayOES()};O=function(e){k.bindVertexArrayOES(e)};D=function(e){k.deleteVertexArrayOES(e)}}F=L(v,["ANGLE_instanced_arrays"]);if(a(F)){I=function(e,t,r,i,n){F.drawElementsInstancedANGLE(e,t,r,i,n)};M=function(e,t,r,i){F.drawArraysInstancedANGLE(e,t,r,i)};R=function(e,t){F.vertexAttribDivisorANGLE(e,t)}}B=L(v,["WEBGL_draw_buffers"]);if(a(B)){N=function(e){B.drawBuffersWEBGL(e)}}}this.glCreateVertexArray=A;this.glBindVertexArray=O;this.glDeleteVertexArray=D;this.glDrawElementsInstanced=I;this.glDrawArraysInstanced=M;this.glVertexAttribDivisor=R;this.glDrawBuffers=N;this._vertexArrayObject=!!k;this._instancedArrays=!!F;this._drawBuffers=!!B;_._maximumDrawBuffers=this.drawBuffers?v.getParameter(p.MAX_DRAW_BUFFERS):1;_._maximumColorAttachments=this.drawBuffers?v.getParameter(p.MAX_COLOR_ATTACHMENTS):1;this._clearColor=new t(0,0,0,0);this._clearDepth=1;this._clearStencil=0;var V=new P;var z=new w(this);var q=S.fromCache();this._defaultPassState=z;this._defaultRenderState=q;this._defaultTexture=undefined;this._defaultCubeMap=undefined;this._us=V;this._currentRenderState=q;this._currentPassState=z;this._currentFramebuffer=undefined;this._maxFrameTextureUnitIndex=0;this._vertexAttribDivisors=[];this._previousDrawInstanced=false;for(var G=0;G<_._maximumVertexAttributes;G++){this._vertexAttribDivisors.push(0)}this._pickObjects={};this._nextPickColor=new Uint32Array(1);this.options=o;this.cache={};S.apply(v,q,z)}var k={};o(N.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._textureFloat||this._colorBufferFloat}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},etc1:{get:function(){return this._etc1}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e;this._gl=R(this._originalGLContext,e?I:undefined)}},defaultTexture:{get:function(){if(this._defaultTexture===undefined){this._defaultTexture=new x({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])}})}return this._defaultTexture}},defaultCubeMap:{get:function(){if(this._defaultCubeMap===undefined){var e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new y({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e}})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return k}}});function F(e){if(e.validateFramebuffer){var t=e._gl;var r=t.checkFramebufferStatus(t.FRAMEBUFFER);if(r!==t.FRAMEBUFFER_COMPLETE){var i;switch(r){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:i="Framebuffer is not complete.  Incomplete attachment: at least one attachment point with a renderbuffer or texture attached has its attached object no longer in existence or has an attached image with a width or height of zero, or the color attachment point has a non-color-renderable image attached, or the depth attachment point has a non-depth-renderable image attached, or the stencil attachment point has a non-stencil-renderable image attached.  Color-renderable formats include GL_RGBA4, GL_RGB5_A1, and GL_RGB565. GL_DEPTH_COMPONENT16 is the only depth-renderable format. GL_STENCIL_INDEX8 is the only stencil-renderable format.";break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:i="Framebuffer is not complete.  Incomplete dimensions: not all attached images have the same width and height.";break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:i="Framebuffer is not complete.  Missing attachment: no images are attached to the framebuffer.";break;case t.FRAMEBUFFER_UNSUPPORTED:i="Framebuffer is not complete.  Unsupported: the combination of internal formats of the attached images violates an implementation-dependent set of restrictions.";break}throw new l(i)}}}function B(e,t,r,i){var n=e._currentRenderState;var a=e._currentPassState;e._currentRenderState=t;e._currentPassState=r;S.partialApply(e._gl,n,t,a,r,i)}var U;if(typeof WebGLRenderingContext!=="undefined"){U=[p.BACK]}function V(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;var r=U;if(a(t)){t._bind();F(e);r=t._getActiveColorAttachments()}else{var i=e._gl;i.bindFramebuffer(i.FRAMEBUFFER,null)}if(e.drawBuffers){e.glDrawBuffers(r)}}}var z=new g;N.prototype.clear=function(e,r){e=n(e,z);r=n(r,this._defaultPassState);var i=this._gl;var o=0;var s=e.color;var l=e.depth;var u=e.stencil;if(a(s)){if(!t.equals(this._clearColor,s)){t.clone(s,this._clearColor);i.clearColor(s.red,s.green,s.blue,s.alpha)}o|=i.COLOR_BUFFER_BIT}if(a(l)){if(l!==this._clearDepth){this._clearDepth=l;i.clearDepth(l)}o|=i.DEPTH_BUFFER_BIT}if(a(u)){if(u!==this._clearStencil){this._clearStencil=u;i.clearStencil(u)}o|=i.STENCIL_BUFFER_BIT}var c=n(e.renderState,this._defaultRenderState);B(this,c,r,true);var d=n(e.framebuffer,r.framebuffer);V(this,d);i.clear(o)};function q(e,t,r,i){var o=n(r._renderState,e._defaultRenderState);if(a(t)&&o.depthTest){if(o.depthTest.enabled&&!t.hasDepthAttachment){throw new l("The depth test can not be enabled (drawCommand.renderState.depthTest.enabled) because the framebuffer (drawCommand.framebuffer) does not have a depth or depth-stencil renderbuffer.")}}V(e,t);B(e,o,i,false);var s=r._shaderProgram;s._bind();e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,s.maximumTextureUnitIndex)}function G(e,t){var r=t._primitiveType;var i=t._vertexArray;var o=t._offset;var s=t._count;var u=t.instanceCount;if(!f.validate(r)){throw new l("drawCommand.primitiveType is required and must be valid.")}if(!a(i)){throw new l("drawCommand.vertexArray is required.")}if(o<0){throw new l("drawCommand.offset must be greater than or equal to zero.")}if(s<0){throw new l("drawCommand.count must be greater than or equal to zero.")}if(u<0){throw new l("drawCommand.instanceCount must be greater than or equal to zero.")}if(u>0&&!e.instancedArrays){throw new l("Instanced arrays extension is not supported")}e._us.model=n(t._modelMatrix,d.IDENTITY);t._shaderProgram._setUniforms(t._uniformMap,e._us,e.validateShaderProgram);i._bind();var c=i.indexBuffer;if(a(c)){o=o*c.bytesPerIndex;s=n(s,c.numberOfIndices);if(u===0){e._gl.drawElements(r,s,c.indexDatatype,o)}else{e.glDrawElementsInstanced(r,s,c.indexDatatype,o,u)}}else{s=n(s,i.numberOfVertices);if(u===0){e._gl.drawArrays(r,o,s)}else{e.glDrawArraysInstanced(r,o,s,u)}}i._unBind()}N.prototype.draw=function(e,t){if(!a(e)){throw new l("drawCommand is required.")}if(!a(e._shaderProgram)){throw new l("drawCommand.shaderProgram is required.")}t=n(t,this._defaultPassState);var r=n(e._framebuffer,t.framebuffer);q(this,r,e,t);G(this,e)};N.prototype.endFrame=function(){var e=this._gl;e.useProgram(null);this._currentFramebuffer=undefined;e.bindFramebuffer(e.FRAMEBUFFER,null);var t=U;if(this.drawBuffers){this.glDrawBuffers(t)}var r=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(var i=0;i<r;++i){e.activeTexture(e.TEXTURE0+i);e.bindTexture(e.TEXTURE_2D,null);e.bindTexture(e.TEXTURE_CUBE_MAP,null)}};N.prototype.readPixels=function(e){var t=this._gl;e=e||{};var r=Math.max(e.x||0,0);var i=Math.max(e.y||0,0);var n=e.width||t.drawingBufferWidth;var a=e.height||t.drawingBufferHeight;var o=e.framebuffer;if(n<=0){throw new l("readState.width must be greater than zero.")}if(a<=0){throw new l("readState.height must be greater than zero.")}var s=new Uint8Array(4*n*a);V(this,o);t.readPixels(r,i,n,a,t.RGBA,t.UNSIGNED_BYTE,s);return s};var H={position:0,textureCoordinates:1};N.prototype.getViewportQuadVertexArray=function(){var e=this.cache.viewportQuad_vertexArray;if(!a(e)){var t=new u({attributes:{position:new c({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new c({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:f.TRIANGLES});e=A.fromGeometry({context:this,geometry:t,attributeLocations:H,bufferUsage:v.STATIC_DRAW,interleave:true});this.cache.viewportQuad_vertexArray=e}return e};N.prototype.createViewportQuadCommand=function(e,t){t=n(t,n.EMPTY_OBJECT);return new b({vertexArray:this.getViewportQuadVertexArray(),primitiveType:f.TRIANGLES,renderState:t.renderState,shaderProgram:E.fromCache({context:this,vertexShaderSource:m,fragmentShaderSource:e,attributeLocations:H}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer,pass:t.pass})};N.prototype.createPickFramebuffer=function(){return new C(this)};N.prototype.getObjectByPickColor=function(e){if(!a(e)){throw new l("pickColor is required.")}return this._pickObjects[e.toRgba()]};function j(e,t,r){this._pickObjects=e;this.key=t;this.color=r}o(j.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}});j.prototype.destroy=function(){delete this._pickObjects[this.key];return undefined};N.prototype.createPickId=function(e){if(!a(e)){throw new l("object is required.")}++this._nextPickColor[0];var r=this._nextPickColor[0];if(r===0){throw new h("Out of unique Pick IDs.")}this._pickObjects[r]=e;return new j(this._pickObjects,r,t.fromRgba(r))};N.prototype.isDestroyed=function(){return false};N.prototype.destroy=function(){var e=this.cache;for(var t in e){if(e.hasOwnProperty(t)){var r=e[t];if(a(r.destroy)){r.destroy()}}}this._shaderCache=this._shaderCache.destroy();this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy();this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy();return s(this)};return N});define("Renderer/loadCubeMap",["../Core/defined","../Core/DeveloperError","../Core/loadImage","../ThirdParty/when","./CubeMap"],function(e,t,r,i,n){"use strict";function a(a,o,s){if(!e(a)){throw new t("context is required.")}if(!e(o)||!e(o.positiveX)||!e(o.negativeX)||!e(o.positiveY)||!e(o.negativeY)||!e(o.positiveZ)||!e(o.negativeZ)){throw new t("urls is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.")}var l=[r(o.positiveX,s),r(o.negativeX,s),r(o.positiveY,s),r(o.negativeY,s),r(o.positiveZ,s),r(o.negativeZ,s)];return i.all(l,function(e){return new n({context:a,source:{positiveX:e[0],negativeX:e[1],positiveY:e[2],negativeY:e[3],positiveZ:e[4],negativeZ:e[5]}})})}return a});define("Scene/DiscardMissingTileImagePolicy",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/getImagePixels","../Core/loadImageViaBlob","../ThirdParty/when"],function(e,t,r,i,n,a){"use strict";function o(o){o=e(o,e.EMPTY_OBJECT);if(!t(o.missingImageUrl)){throw new r("options.missingImageUrl is required.")}if(!t(o.pixelsToCheck)){throw new r("options.pixelsToCheck is required.")}this._pixelsToCheck=o.pixelsToCheck;this._missingImagePixels=undefined;this._missingImageByteLength=undefined;this._isReady=false;var s=this;function l(e){if(t(e.blob)){s._missingImageByteLength=e.blob.size}var r=i(e);if(o.disableCheckIfAllPixelsAreTransparent){var n=true;var a=e.width;var l=o.pixelsToCheck;for(var u=0,c=l.length;n&&u<c;++u){var d=l[u];var f=d.x*4+d.y*a;var h=r[f+3];if(h>0){n=false}}if(n){r=undefined}}s._missingImagePixels=r;s._isReady=true}function u(){s._missingImagePixels=undefined;s._isReady=true}a(n(o.missingImageUrl),l,u)}o.prototype.isReady=function(){return this._isReady};o.prototype.shouldDiscardImage=function(e){if(!this._isReady){throw new r("shouldDiscardImage must not be called before the discard policy is ready.")}var n=this._pixelsToCheck;var a=this._missingImagePixels;if(!t(a)){return false}if(t(e.blob)&&e.blob.size!==this._missingImageByteLength){return false}var o=i(e);var s=e.width;for(var l=0,u=n.length;l<u;++l){var c=n[l];var d=c.x*4+c.y*s;for(var f=0;f<4;++f){var h=d+f;if(o[h]!==a[h]){return false}}}return true};return o});define("Scene/ImageryLayerFeatureInfo",["../Core/defined"],function(e){"use strict";function t(){this.name=undefined;this.description=undefined;this.position=undefined;this.data=undefined;this.imageryLayer=undefined}t.prototype.configureNameFromProperties=function(t){var r=10;var i;for(var n in t){if(t.hasOwnProperty(n)&&t[n]){var a=n.toLowerCase();if(r>1&&a==="name"){r=1;i=n}else if(r>2&&a==="title"){r=2;i=n}else if(r>3&&/name/i.test(n)){r=3;i=n}else if(r>4&&/title/i.test(n)){r=4;i=n}}}if(e(i)){this.name=t[i]}};t.prototype.configureDescriptionFromProperties=function(t){function r(t){var i='<table class="cesium-infoBox-defaultTable">';for(var n in t){if(t.hasOwnProperty(n)){var a=t[n];if(e(a)){if(typeof a==="object"){i+="<tr><td>"+n+"</td><td>"+r(a)+"</td></tr>"}else{i+="<tr><td>"+n+"</td><td>"+a+"</td></tr>"}}}}i+="</table>";return i}this.description=r(t)};return t});define("Scene/ImageryProvider",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/loadCRN","../Core/loadImage","../Core/loadImageViaBlob","../Core/loadKTX"],function(e,t,r,i,n,a,o){"use strict";function s(){this.defaultAlpha=undefined;this.defaultBrightness=undefined;this.defaultContrast=undefined;this.defaultHue=undefined;this.defaultSaturation=undefined;this.defaultGamma=undefined;r.throwInstantiationError()}t(s.prototype,{ready:{get:r.throwInstantiationError},readyPromise:{get:r.throwInstantiationError},rectangle:{get:r.throwInstantiationError},tileWidth:{get:r.throwInstantiationError},tileHeight:{get:r.throwInstantiationError},maximumLevel:{get:r.throwInstantiationError},minimumLevel:{get:r.throwInstantiationError},tilingScheme:{get:r.throwInstantiationError},tileDiscardPolicy:{get:r.throwInstantiationError},errorEvent:{get:r.throwInstantiationError},credit:{get:r.throwInstantiationError},proxy:{get:r.throwInstantiationError},hasAlphaChannel:{get:r.throwInstantiationError}});s.prototype.getTileCredits=r.throwInstantiationError;s.prototype.requestImage=r.throwInstantiationError;s.prototype.pickFeatures=r.throwInstantiationError;var l=/\.ktx$/i;var u=/\.crn$/i;s.loadImage=function(t,r,s){if(l.test(r)){return o(r,undefined,s)}else if(u.test(r)){return i(r,undefined,s)}else if(e(t.tileDiscardPolicy)){return a(r,s)}return n(r,undefined,s)};return s});define("Scene/ArcGisMapServerImageryProvider",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/loadJson","../Core/loadJsonp","../Core/Math","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorProjection","../Core/WebMercatorTilingScheme","../ThirdParty/when","./DiscardMissingTileImagePolicy","./ImageryLayerFeatureInfo","./ImageryProvider"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w){"use strict";function C(r){r=n(r,{});if(!a(r.url)){throw new s("options.url is required.")}this._url=r.url;this._token=r.token;this._tileDiscardPolicy=r.tileDiscardPolicy;this._proxy=r.proxy;this._tileWidth=n(r.tileWidth,256);this._tileHeight=n(r.tileHeight,256);this._maximumLevel=r.maximumLevel;this._tilingScheme=n(r.tilingScheme,new u({ellipsoid:r.ellipsoid}));this._credit=undefined;this._useTiles=n(r.usePreCachedTilesIfAvailable,true);this._rectangle=n(r.rectangle,this._tilingScheme.rectangle);this._layers=r.layers;this.enablePickFeatures=n(r.enablePickFeatures,true);this._errorEvent=new l;this._ready=false;this._readyPromise=_.defer();var o=this;var c;function f(n){var s=n.tileInfo;if(!a(s)){o._useTiles=false}else{o._tileWidth=s.rows;o._tileHeight=s.cols;if(s.spatialReference.wkid===102100||s.spatialReference.wkid===102113){o._tilingScheme=new g({ellipsoid:r.ellipsoid})}else if(n.tileInfo.spatialReference.wkid===4326){o._tilingScheme=new u({ellipsoid:r.ellipsoid})}else{var l="Tile spatial reference WKID "+n.tileInfo.spatialReference.wkid+" is not supported.";c=m.handleError(c,o,o._errorEvent,l,undefined,undefined,undefined,w);return}o._maximumLevel=n.tileInfo.lods.length-1;if(a(n.fullExtent)){if(a(n.fullExtent.spatialReference)&&a(n.fullExtent.spatialReference.wkid)){if(n.fullExtent.spatialReference.wkid===102100||n.fullExtent.spatialReference.wkid===102113){var d=new v;var f=n.fullExtent;var p=d.unproject(new t(Math.max(f.xmin,-o._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(f.ymin,-o._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));var _=d.unproject(new t(Math.min(f.xmax,o._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(f.ymax,o._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));o._rectangle=new h(p.longitude,p.latitude,_.longitude,_.latitude)}else if(n.fullExtent.spatialReference.wkid===4326){o._rectangle=h.fromDegrees(n.fullExtent.xmin,n.fullExtent.ymin,n.fullExtent.xmax,n.fullExtent.ymax)}else{var b="fullExtent.spatialReference WKID "+n.fullExtent.spatialReference.wkid+" is not supported.";c=m.handleError(c,o,o._errorEvent,b,undefined,undefined,undefined,w);return}}}else{o._rectangle=o._tilingScheme.rectangle}if(!a(o._tileDiscardPolicy)){o._tileDiscardPolicy=new y({missingImageUrl:S(o,0,0,o._maximumLevel),pixelsToCheck:[new e(0,0),new e(200,20),new e(20,200),new e(80,110),new e(160,130)],disableCheckIfAllPixelsAreTransparent:true})}o._useTiles=true}if(a(n.copyrightText)&&n.copyrightText.length>0){o._credit=new i(n.copyrightText)}o._ready=true;o._readyPromise.resolve(true);m.handleSuccess(c)}function b(e){var t="An error occurred while accessing "+o._url+".";c=m.handleError(c,o,o._errorEvent,t,undefined,undefined,undefined,w);o._readyPromise.reject(new p(t))}function w(){var e={f:"json"};if(a(o._token)){e.token=o._token}var t=d(o._url,{parameters:e,proxy:o._proxy});_(t,f,b)}if(this._useTiles){w()}else{this._ready=true;this._readyPromise.resolve(true)}}function S(e,t,r,i){var n;if(e._useTiles){n=e._url+"/tile/"+i+"/"+r+"/"+t}else{var o=e._tilingScheme.tileXYToNativeRectangle(t,r,i);var s=o.west+"%2C"+o.south+"%2C"+o.east+"%2C"+o.north;n=e._url+"/export?";n+="bbox="+s;if(e._tilingScheme instanceof u){n+="&bboxSR=4326&imageSR=4326"}else{n+="&bboxSR=3857&imageSR=3857"}n+="&size="+e._tileWidth+"%2C"+e._tileHeight;n+="&format=png&transparent=true&f=image";if(e.layers){n+="&layers=show:"+e.layers}}var l=e._token;if(a(l)){if(n.indexOf("?")===-1){n+="?"}if(n[n.length-1]!=="?"){n+="&"}n+="token="+l}var c=e._proxy;if(a(c)){n=c.getURL(n)}return n}o(C.prototype,{url:{get:function(){return this._url}},token:{get:function(){return this._token}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this._ready){throw new s("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this._ready){throw new s("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready){throw new s("maximumLevel must not be called before the imagery provider is ready.")}return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready){throw new s("minimumLevel must not be called before the imagery provider is ready.")}return 0}},tilingScheme:{get:function(){if(!this._ready){throw new s("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},rectangle:{get:function(){if(!this._ready){throw new s("rectangle must not be called before the imagery provider is ready.")}return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready){throw new s("tileDiscardPolicy must not be called before the imagery provider is ready.")}return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return true}},layers:{get:function(){return this._layers}}});C.prototype.getTileCredits=function(e,t,r){return undefined};C.prototype.requestImage=function(e,t,r,i){if(!this._ready){throw new s("requestImage must not be called before the imagery provider is ready.")}var n=S(this,e,t,r);return w.loadImage(this,n,i)};C.prototype.pickFeatures=function(e,i,n,o,l){if(!this._ready){throw new s("pickFeatures must not be called before the imagery provider is ready.")}if(!this.enablePickFeatures){return undefined}var d=this._tilingScheme.tileXYToNativeRectangle(e,i,n);var h;var p;var m;if(this._tilingScheme instanceof u){h=f.toDegrees(o);p=f.toDegrees(l);m="4326"}else{var g=this._tilingScheme.projection.project(new r(o,l,0));h=g.x;p=g.y;m="3857"}var _=this._url+"/identify?f=json&tolerance=2&geometryType=esriGeometryPoint";_+="&geometry="+h+","+p;_+="&mapExtent="+d.west+","+d.south+","+d.east+","+d.north;_+="&imageDisplay="+this._tileWidth+","+this._tileHeight+",96";_+="&sr="+m;_+="&layers=visible";if(a(this._layers)){_+=":"+this._layers}if(a(this._token)){_+="&token="+this._token}if(a(this._proxy)){_=this._proxy.getURL(_)}return c(_).then(function(e){var i=[];var n=e.results;if(!a(n)){return i}for(var o=0;o<n.length;++o){var s=n[o];var l=new b;l.data=s;l.name=s.value;l.properties=s.attributes;l.configureDescriptionFromProperties(s.attributes);if(s.geometryType==="esriGeometryPoint"&&s.geometry){var u=s.geometry.spatialReference&&s.geometry.spatialReference.wkid?s.geometry.spatialReference.wkid:4326;if(u===4326||u===4283){l.position=r.fromDegrees(s.geometry.x,s.geometry.y,s.geometry.z)}else if(u===102100||u===900913||u===3857){var c=new v;l.position=c.unproject(new t(s.geometry.x,s.geometry.y,s.geometry.z))}}i.push(l)}return i})};return C});define("Scene/Cesium3DTileColorBlendMode",["../Core/freezeObject"],function(e){"use strict";var t={HIGHLIGHT:0,REPLACE:1,MIX:2};return e(t)});define("Scene/getBinaryAccessor",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/ComponentDatatype","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4"],function(e,t,r,i,n,a,o){"use strict";var s={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};var l={SCALAR:undefined,VEC2:e,VEC3:t,VEC4:r,MAT2:n,MAT3:a,MAT4:o};function u(e){var t=e.componentType;var r;if(typeof t==="string"){r=i.fromName(t)}else{r=t}var n=s[e.type];var a=l[e.type];return{componentsPerAttribute:n,classType:a,createArrayBufferView:function(e,t,a){return i.createArrayBufferView(r,e,t,n*a)}}}return u});define("Scene/Cesium3DTileBatchTable",["../Core/arrayFill","../Core/Cartesian2","../Core/Cartesian4","../Core/Check","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","../Core/RuntimeError","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","./AttributeType","./BlendingState","./Cesium3DTileColorBlendMode","./CullFace","./getBinaryAccessor","./StencilFunction","./StencilOperation"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M){"use strict";var R=a.WHITE;var L=true;function N(e,i,n,a){this.featuresLength=i;this._translucentFeaturesLength=0;this.batchTableJson=n;this.batchTableBinary=a;var o;var s;if(u(n)){o=n.HIERARCHY;if(u(o)){delete n.HIERARCHY;o=k(o,a)}s=N.getBinaryProperties(i,n,a)}this._batchTableHierarchy=o;this._batchTableBinaryProperties=s;this._showAlphaProperties=undefined;this._batchValues=undefined;this._batchValuesDirty=false;this._batchTexture=undefined;this._defaultTexture=undefined;this._pickTexture=undefined;this._pickIds=[];this._content=e;var l;var c;if(i>0){var d=Math.min(i,v.maximumTextureSize);var f=Math.ceil(i/v.maximumTextureSize);var h=1/d;var p=h*.5;var m=1/f;var g=m*.5;l=new t(d,f);c=new r(h,p,m,g)}this._textureDimensions=l;this._textureStep=c}c(N.prototype,{memorySizeInBytes:{get:function(){var e=0;if(u(this._pickTexture)){e+=this._pickTexture.sizeInBytes}if(u(this._batchTexture)){e+=this._batchTexture.sizeInBytes}return e}}});function k(t,r){var i;var n;var a;var c=t.instancesLength;var d=t.classes;var f=t.classIds;var h=t.parentCounts;var p=t.parentIds;var m=c;if(u(f.byteOffset)){f.componentType=l(f.componentType,s.UNSIGNED_SHORT);f.type=x.SCALAR;a=D(f);f=a.createArrayBufferView(r.buffer,r.byteOffset+f.byteOffset,c)}var v;if(u(h)){if(u(h.byteOffset)){h.componentType=l(h.componentType,s.UNSIGNED_SHORT);h.type=x.SCALAR;a=D(h);h=a.createArrayBufferView(r.buffer,r.byteOffset+h.byteOffset,c)}v=new Uint16Array(c);m=0;for(i=0;i<c;++i){v[i]=m;m+=h[i]}}if(u(p)&&u(p.byteOffset)){p.componentType=l(p.componentType,s.UNSIGNED_SHORT);p.type=x.SCALAR;a=D(p);p=a.createArrayBufferView(r.buffer,r.byteOffset+p.byteOffset,m)}var g=d.length;for(i=0;i<g;++i){var _=d[i].length;var y=d[i].instances;var b=N.getBinaryProperties(_,y,r);d[i].instances=o(b,y)}var w=e(new Array(g),0);var C=new Uint16Array(c);for(i=0;i<c;++i){n=f[i];C[i]=w[n];++w[n]}var S={classes:d,classIds:f,classIndexes:C,parentCounts:h,parentIndexes:v,parentIds:p};B(S);return S}var F=[];function B(e){var t=F;t.length=0;var r=e.classIds;var i=r.length;for(var n=0;n<i;++n){U(e,n,t)}}function U(e,t,r){var i=e.parentCounts;var n=e.parentIds;var a=e.parentIndexes;var o=e.classIds;var s=o.length;if(!u(n)){return}if(t>=s){throw new f("Parent index "+t+" exceeds the total number of instances: "+s)}if(r.indexOf(t)>-1){throw new f("Circular dependency detected in the batch table hierarchy.")}r.push(t);var l=u(i)?i[t]:1;var c=u(i)?a[t]:t;for(var d=0;d<l;++d){var h=n[c+d];if(h!==t){U(e,h,r)}}r.pop(t)}N.getBinaryProperties=function(e,t,r){var i;for(var n in t){if(t.hasOwnProperty(n)){var a=t[n];var o=a.byteOffset;if(u(o)){var s=a.componentType;var l=a.type;if(!u(s)){throw new m("componentType is required.")}if(!u(l)){throw new m("type is required.")}if(!u(r)){throw new m("Property "+n+" requires a batch table binary.")}var c=D(a);var d=c.componentsPerAttribute;var f=c.classType;var h=c.createArrayBufferView(r.buffer,r.byteOffset+o,e);if(!u(i)){i={}}i[n]={typedArray:h,componentCount:d,type:f}}}}return i};function V(e){var t=e._textureDimensions;return t.x*t.y*4}function z(t){if(!u(t._batchValues)){var r=V(t);var i=new Uint8Array(r);e(i,255);t._batchValues=i}return t._batchValues}function q(t){if(!u(t._showAlphaProperties)){var r=2*t.featuresLength;var i=new Uint8Array(r);e(i,255);t._showAlphaProperties=i}return t._showAlphaProperties}function G(e,t){if(!u(e)||e<0||e>t){throw new f("batchId is required and between zero and featuresLength - 1 ("+t-+").")}}N.prototype.setShow=function(e,t){G(e,this.featuresLength);i.typeOf.bool("show",t);if(t&&!u(this._showAlphaProperties)){return}var r=q(this);var n=e*2;var a=t?255:0;if(r[n]!==a){r[n]=a;var o=z(this);var s=e*4+3;o[s]=t?r[n+1]:0;this._batchValuesDirty=true}};N.prototype.setAllShow=function(e){i.typeOf.bool("show",e);var t=this.featuresLength;for(var r=0;r<t;++r){this.setShow(r,e)}};N.prototype.getShow=function(e){G(e,this.featuresLength);if(!u(this._showAlphaProperties)){return true}var t=e*2;return this._showAlphaProperties[t]===255};var H=new Array(4);N.prototype.setColor=function(e,t){G(e,this.featuresLength);i.typeOf.object("color",t);if(a.equals(t,R)&&!u(this._batchValues)){return}var r=t.toBytes(H);var n=r[3];var o=z(this);var s=e*4;var l=q(this);var c=e*2;if(o[s]!==r[0]||o[s+1]!==r[1]||o[s+2]!==r[2]||l[c+1]!==n){o[s]=r[0];o[s+1]=r[1];o[s+2]=r[2];var d=l[c+1]!==255;var f=l[c]!==0;o[s+3]=f?n:0;l[c+1]=n;var h=n!==255;if(h&&!d){++this._translucentFeaturesLength}else if(!h&&d){--this._translucentFeaturesLength}this._batchValuesDirty=true}};N.prototype.setAllColor=function(e){i.typeOf.object("color",e);var t=this.featuresLength;for(var r=0;r<t;++r){this.setColor(r,e)}};N.prototype.getColor=function(e,t){G(e,this.featuresLength);i.typeOf.object("result",t);if(!u(this._batchValues)){return a.clone(R,t)}var r=this._batchValues;var n=e*4;var o=this._showAlphaProperties;var s=e*2;return a.fromBytes(r[n],r[n+1],r[n+2],o[s+1],t)};var j=new a;N.prototype.applyStyle=function(e,t){if(!u(t)){this.setAllColor(R);this.setAllShow(true);return}var r=this._content;var i=this.featuresLength;for(var n=0;n<i;++n){var a=r.getFeature(n);var o=u(t.color)?t.color.evaluateColor(e,a,j):R;var s=u(t.show)?t.show.evaluate(e,a):L;this.setColor(n,o);this.setShow(n,s)}};function W(e,t){var r=e.typedArray;var i=e.componentCount;if(i===1){return r[t]}return e.type.unpack(r,t*i)}function Y(e,t,r){var i=e.typedArray;var n=e.componentCount;if(n===1){i[t]=r}else{e.type.pack(r,i,t*n)}}var X=[];var Q=[];var Z=0;function K(e,t,r){var i=e.classIds;var n=e.parentCounts;var a=e.parentIds;var o=e.parentIndexes;var s=i.length;var l=X;l.length=Math.max(l.length,s);var c=++Z;var d=Q;d.length=0;d.push(t);while(d.length>0){t=d.pop();if(l[t]===c){continue}l[t]=c;var f=r(e,t);if(u(f)){return f}var h=n[t];var p=o[t];for(var m=0;m<h;++m){var v=a[p+m];if(v!==t){d.push(v)}}}}function J(e,t,r){var i=true;while(i){var n=r(e,t);if(u(n)){return n}var a=e.parentIds[t];i=a!==t;t=a}}function $(e,t,r){var i=e.parentCounts;var n=e.parentIds;if(!u(n)){return r(e,t)}else if(u(i)){return K(e,t,r)}return J(e,t,r)}function ee(e,t,r){var i=e._batchTableHierarchy;var n=$(i,t,function(e,t){var i=e.classIds[t];var n=e.classes[i].instances;if(u(n[r])){return true}});return u(n)}function te(e,t,r){var i=e._batchTableHierarchy;$(i,t,function(e,t){var i=e.classIds[t];var n=e.classes[i].instances;for(var a in n){if(n.hasOwnProperty(a)){if(r.indexOf(a)===-1){r.push(a)}}}})}function re(e,t,r){var i=e._batchTableHierarchy;return $(i,t,function(e,t){var i=e.classIds[t];var a=e.classes[i];var o=e.classIndexes[t];var s=a.instances[r];if(u(s)){if(u(s.typedArray)){return W(s,o)}return n(s[o],true)}})}function ie(e,t,r,i){var a=e._batchTableHierarchy;var o=$(a,t,function(e,a){var o=e.classIds[a];var s=e.classes[o];var l=e.classIndexes[a];var c=s.instances[r];if(u(c)){if(a!==t){throw new f('Inherited property "'+r+'" is read-only.')}if(u(c.typedArray)){Y(c,l,i)}else{c[l]=n(i,true)}return true}});return u(o)}N.prototype.isClass=function(e,t){G(e,this.featuresLength);i.typeOf.string("className",t);var r=this._batchTableHierarchy;if(!u(r)){return false}var n=$(r,e,function(e,r){var i=e.classIds[r];var n=e.classes[i];if(n.name===t){return true}});return u(n)};N.prototype.isExactClass=function(e,t){i.typeOf.string("className",t);return this.getExactClassName(e)===t};N.prototype.getExactClassName=function(e){G(e,this.featuresLength);var t=this._batchTableHierarchy;if(!u(t)){return undefined}var r=t.classIds[e];var i=t.classes[r];return i.name};N.prototype.hasProperty=function(e,t){G(e,this.featuresLength);i.typeOf.string("name",t);var r=this.batchTableJson;return u(r)&&u(r[t])||u(this._batchTableHierarchy)&&ee(this,e,t)};N.prototype.getPropertyNames=function(e,t){G(e,this.featuresLength);t=u(t)?t:[];t.length=0;var r=this.batchTableJson;for(var i in r){if(r.hasOwnProperty(i)){t.push(i)}}if(u(this._batchTableHierarchy)){te(this,e,t)}return t};N.prototype.getProperty=function(e,t){G(e,this.featuresLength);i.typeOf.string("name",t);if(!u(this.batchTableJson)){return undefined}if(u(this._batchTableBinaryProperties)){var r=this._batchTableBinaryProperties[t];if(u(r)){return W(r,e)}}var a=this.batchTableJson[t];if(u(a)){return n(a[e],true)}if(u(this._batchTableHierarchy)){var o=re(this,e,t);if(u(o)){return o}}return undefined};N.prototype.setProperty=function(e,t,r){var a=this.featuresLength;G(e,a);i.typeOf.string("name",t);if(u(this._batchTableBinaryProperties)){var o=this._batchTableBinaryProperties[t];if(u(o)){Y(o,e,r);return}}if(u(this._batchTableHierarchy)){if(ie(this,e,t,r)){return}}if(!u(this.batchTableJson)){this.batchTableJson={}}var s=this.batchTableJson[t];if(!u(s)){this.batchTableJson[t]=new Array(a);s=this.batchTableJson[t]}s[e]=n(r,true)};function ne(e){if(e._textureDimensions.y===1){return"uniform vec4 tile_textureStep; \n"+"vec2 computeSt(float batchId) \n"+"{ \n"+"    float stepX = tile_textureStep.x; \n"+"    float centerX = tile_textureStep.y; \n"+"    return vec2(centerX + (batchId * stepX), 0.5); \n"+"} \n"}return"uniform vec4 tile_textureStep; \n"+"uniform vec2 tile_textureDimensions; \n"+"vec2 computeSt(float batchId) \n"+"{ \n"+"    float stepX = tile_textureStep.x; \n"+"    float centerX = tile_textureStep.y; \n"+"    float stepY = tile_textureStep.z; \n"+"    float centerY = tile_textureStep.w; \n"+"    float xId = mod(batchId, tile_textureDimensions.x); \n"+"    float yId = floor(batchId / tile_textureDimensions.x); \n"+"    return vec2(centerX + (xId * stepX), 1.0 - (centerY + (yId * stepY))); \n"+"} \n"}N.prototype.getVertexShaderCallback=function(e,t){if(this.featuresLength===0){return}var r=this;return function(i){var n=C.replaceMain(i,"tile_main");var a;if(v.maximumVertexTextureImageUnits>0){a="uniform sampler2D tile_batchTexture; \n"+"uniform bool tile_translucentCommand; \n"+"varying vec4 tile_featureColor; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    vec2 st = computeSt("+t+"); \n"+"    vec4 featureProperties = texture2D(tile_batchTexture, st); \n"+"    float show = ceil(featureProperties.a); \n"+"    gl_Position *= show; \n";if(e){a+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n"+"    if (czm_pass == czm_passTranslucent) \n"+"    { \n"+"        if (!isStyleTranslucent && !tile_translucentCommand) \n"+"        { \n"+"            gl_Position *= 0.0; \n"+"        } \n"+"    } \n"+"    else \n"+"    { \n"+"        if (isStyleTranslucent) \n"+"        { \n"+"            gl_Position *= 0.0; \n"+"        } \n"+"    } \n"}a+="    tile_featureColor = featureProperties; \n"+"}"}else{a="varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    tile_featureSt = computeSt("+t+"); \n"+"}"}return n+"\n"+ne(r)+a}};function ae(e){e=C.replaceMain(e,"tile_main");return e+"void tile_color(vec4 tile_featureColor) \n"+"{ \n"+"    tile_main(); \n"+"    gl_FragColor *= tile_featureColor; \n"+"} \n"}function oe(e,t){if(!u(t)){return ae(e)}var r=new RegExp("uniform\\s+(vec[34]|sampler2D)\\s+"+t+";");var i=e.match(r);if(!u(i)){return ae(e)}var n=i[0];var a=i[1];e=C.replaceMain(e,"tile_main");e=e.replace(n,"");var o="vec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) \n"+"{ \n"+"    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); \n"+"    vec4 diffuse = (tileDiffuse.rgb == vec3(1.0)) ? sourceDiffuse : blendDiffuse; \n"+"    return vec4(diffuse.rgb, sourceDiffuse.a); \n"+"} \n";var s="    gl_FragColor.a *= tile_featureColor.a; \n"+"    float highlight = ceil(tile_colorBlend); \n"+"    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n";var l;if(a==="vec3"||a==="vec4"){var c=a==="vec3"?"vec4("+t+", 1.0)":t;var d=a==="vec3"?"tile_diffuse.xyz":"tile_diffuse";r=new RegExp(t,"g");e=e.replace(r,d);l="    vec4 source = "+c+"; \n"+"    tile_diffuse = tile_diffuse_final(source, tile_featureColor); \n"+"    tile_main(); \n"}else if(a==="sampler2D"){r=new RegExp("texture2D\\("+t+".*?\\)","g");e=e.replace(r,"tile_diffuse_final($&, tile_diffuse)");l="    tile_diffuse = tile_featureColor; \n"+"    tile_main(); \n"}e="uniform float tile_colorBlend; \n"+"vec4 tile_diffuse = vec4(1.0); \n"+o+n+"\n"+e+"\n"+"void tile_color(vec4 tile_featureColor) \n"+"{ \n"+l+s+"} \n";return e}N.prototype.getFragmentShaderCallback=function(e,t){if(this.featuresLength===0){return}return function(r){r=oe(r,t);if(v.maximumVertexTextureImageUnits>0){r+="varying vec4 tile_featureColor; \n"+"void main() \n"+"{ \n"+"    tile_color(tile_featureColor); \n"+"}"}else{r+="uniform sampler2D tile_batchTexture; \n"+"uniform bool tile_translucentCommand; \n"+"varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); \n"+"    if (featureProperties.a == 0.0) { \n"+"        discard; \n"+"    } \n";if(e){r+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n"+"    if (czm_pass == czm_passTranslucent) \n"+"    { \n"+"        if (!isStyleTranslucent && !tile_translucentCommand) \n"+"        { \n"+"            discard; \n"+"        } \n"+"    } \n"+"    else \n"+"    { \n"+"        if (isStyleTranslucent) \n"+"        { \n"+"            discard; \n"+"        } \n"+"    } \n"}r+="    tile_color(featureProperties); \n"+"} \n"}return r}};function se(e){var t=e._content._tileset;var r=t.colorBlendMode;var i=t.colorBlendAmount;if(r===A.HIGHLIGHT){return 0}if(r===A.REPLACE){return 1}if(r===A.MIX){return h.clamp(i,h.EPSILON4,1)}throw new f('Invalid color blend mode "'+r+'".')}N.prototype.getUniformMapCallback=function(){if(this.featuresLength===0){return}var e=this;return function(t){var r={tile_batchTexture:function(){return l(e._batchTexture,e._defaultTexture)},tile_textureDimensions:function(){return e._textureDimensions},tile_textureStep:function(){return e._textureStep},tile_colorBlend:function(){return se(e)}};return o(t,r)}};N.prototype.getPickVertexShaderCallback=function(e){if(this.featuresLength===0){return}var t=this;return function(r){var i=C.replaceMain(r,"tile_main");var n;if(v.maximumVertexTextureImageUnits>0){n="uniform sampler2D tile_batchTexture; \n"+"varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    vec2 st = computeSt("+e+"); \n"+"    vec4 featureProperties = texture2D(tile_batchTexture, st); \n"+"    float show = ceil(featureProperties.a); \n"+"    gl_Position *= show; \n"+"    tile_featureSt = st; \n"+"}"}else{n="varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    tile_featureSt = computeSt("+e+"); \n"+"}"}return i+"\n"+ne(t)+n}};N.prototype.getPickFragmentShaderCallback=function(){if(this.featuresLength===0){return}return function(e){var t=C.replaceMain(e,"tile_main");var r;if(v.maximumVertexTextureImageUnits>0){r="uniform sampler2D tile_pickTexture; \n"+"varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    tile_main(); \n"+"    if (gl_FragColor.a == 0.0) { \n"+"        discard; \n"+"    } \n"+"    gl_FragColor = texture2D(tile_pickTexture, tile_featureSt); \n"+"}"}else{r="uniform sampler2D tile_pickTexture; \n"+"uniform sampler2D tile_batchTexture; \n"+"varying vec2 tile_featureSt; \n"+"void main() \n"+"{ \n"+"    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); \n"+"    if (featureProperties.a == 0.0) { \n"+"        discard; \n"+"    } \n"+"    tile_main(); \n"+"    if (gl_FragColor.a == 0.0) { \n"+"        discard; \n"+"    } \n"+"    gl_FragColor = texture2D(tile_pickTexture, tile_featureSt); \n"+"}"}return t+"\n"+r}};N.prototype.getPickUniformMapCallback=function(){if(this.featuresLength===0){return}var e=this;return function(t){var r={tile_batchTexture:function(){return l(e._batchTexture,e._defaultTexture)},tile_textureDimensions:function(){return e._textureDimensions},tile_textureStep:function(){return e._textureStep},tile_pickTexture:function(){return e._pickTexture}};return o(r,t)}};var le={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};N.prototype.addDerivedCommands=function(e,t){var r=e.commandList;var i=r.length;var n=this._content._tile;var a=n._tileset;var o=a.skipLevelOfDetail&&a._hasMixedContent&&e.context.stencilBuffer;var s=ce(this);for(var l=t;l<i;++l){var c=r[l];var d=c.derivedCommands.tileset;if(!u(d)){d={};c.derivedCommands.tileset=d;d.originalCommand=de(c)}ue(d.originalCommand,c);if(s!==le.ALL_OPAQUE){if(!u(d.translucent)){d.translucent=fe(d.originalCommand)}ue(d.translucent,c)}if(o){if(c.pass!==_.TRANSLUCENT){if(!u(d.zback)){d.zback=he(d.originalCommand)}a._backfaceCommands.push(d.zback)}if(!u(d.stencil)||n._selectionDepth!==n._lastSelectionDepth){d.stencil=pe(d.originalCommand,n._selectionDepth);n._lastSelectionDepth=n._selectionDepth}ue(d.stencil,c)}var f=o?d.stencil:d.originalCommand;var h=d.translucent;if(c.pass!==_.TRANSLUCENT){if(s===le.ALL_OPAQUE){r[l]=f}if(s===le.ALL_TRANSLUCENT){r[l]=h}if(s===le.OPAQUE_AND_TRANSLUCENT){r[l]=f;r.push(h)}}else{r[l]=f}}};function ue(e,t){e.castShadows=t.castShadows;e.receiveShadows=t.receiveShadows;e.primitiveType=t.primitiveType}function ce(e){var t=e._translucentFeaturesLength;if(t===0){return le.ALL_OPAQUE}else if(t===e.featuresLength){return le.ALL_TRANSLUCENT}return le.OPAQUE_AND_TRANSLUCENT}function de(e){var t=g.shallowClone(e);var r=t.pass===_.TRANSLUCENT;t.uniformMap=u(t.uniformMap)?t.uniformMap:{};t.uniformMap.tile_translucentCommand=function(){return r};return t}function fe(e){var t=g.shallowClone(e);t.pass=_.TRANSLUCENT;t.renderState=me(e.renderState);return t}function he(e){var t=g.shallowClone(e);var r=n(t.renderState,true);r.cull.enabled=true;r.cull.face=O.FRONT;t.renderState=b.fromCache(r);t.castShadows=false;t.receiveShadows=false;return t}function pe(e,t){var r=e;if(e.renderState.depthMask){r=g.shallowClone(e);var i=n(r.renderState,true);i.stencilTest.enabled=true;i.stencilTest.reference=t;i.stencilTest.frontFunction=I.GREATER_OR_EQUAL;i.stencilTest.frontOperation.zPass=M.REPLACE;r.renderState=b.fromCache(i)}return r}function me(e){var t=n(e,true);t.cull.enabled=false;t.depthTest.enabled=true;t.depthMask=false;t.blending=P.ALPHA_BLEND;return b.fromCache(t)}function ve(e,t,r){var i=e._textureDimensions;return new S({context:t,pixelFormat:p.RGBA,pixelDatatype:y.UNSIGNED_BYTE,source:{width:i.x,height:i.y,arrayBufferView:r},sampler:new w({minificationFilter:E.NEAREST,magnificationFilter:T.NEAREST})})}function ge(e,t){var r=e.featuresLength;if(!u(e._pickTexture)&&r>0){var i=e._pickIds;var n=V(e);var o=new Uint8Array(n);var s=e._content;for(var l=0;l<r;++l){var c=t.createPickId(s.getFeature(l));i.push(c);var d=c.color;var f=l*4;o[f]=a.floatToByte(d.red);o[f+1]=a.floatToByte(d.green);o[f+2]=a.floatToByte(d.blue);o[f+3]=a.floatToByte(d.alpha)}e._pickTexture=ve(e,t,o);s._tileset._statistics.batchTableByteLength+=e._pickTexture.sizeInBytes}}function _e(e){var t=e._textureDimensions;e._batchTexture.copyFrom({width:t.x,height:t.y,arrayBufferView:e._batchValues})}N.prototype.update=function(e,t){var r=t.context;this._defaultTexture=r.defaultTexture;if(t.passes.pick){ge(this,r)}if(this._batchValuesDirty){this._batchValuesDirty=false;if(!u(this._batchTexture)){this._batchTexture=ve(this,r,this._batchValues);e._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes}_e(this)}};N.prototype.isDestroyed=function(){return false};N.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy();this._pickTexture=this._pickTexture&&this._pickTexture.destroy();var e=this._pickIds;var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}return d(this)};return N});define("Scene/Cesium3DTileFeature",["../Core/Color","../Core/defined","../Core/defineProperties"],function(e,t,r){"use strict";function i(e,t,r){this._content=t;this._batchId=r;this._color=undefined}r(i.prototype,{show:{get:function(){return this._content.batchTable.getShow(this._batchId)},set:function(e){this._content.batchTable.setShow(this._batchId,e)}},color:{get:function(){if(!t(this._color)){this._color=new e}return this._content.batchTable.getColor(this._batchId,this._color)},set:function(e){this._content.batchTable.setColor(this._batchId,e)}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}}});i.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)};i.prototype.getPropertyNames=function(e){return this._content.batchTable.getPropertyNames(this._batchId,e)};i.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)};i.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t);this._content.featurePropertiesDirty=true};i.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)};i.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)};i.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};return i});define("Scene/Cesium3DTileFeatureTable",["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined"],function(e,t,r){"use strict";function i(e,t){this.json=e;this.buffer=t;this._cachedTypedArrays={};this.featuresLength=0}function n(t,i,n,a,o,s){var l=t._cachedTypedArrays;var u=l[i];if(!r(u)){u=e.createArrayBufferView(n,t.buffer.buffer,t.buffer.byteOffset+s,o*a);l[i]=u}return u}function a(t,i,n,a){var o=t._cachedTypedArrays;var s=o[i];if(!r(s)){s=e.createTypedArray(n,a);o[i]=s}return s}i.prototype.getGlobalProperty=function(i,a,o){var s=this.json[i];if(!r(s)){return undefined}if(r(s.byteOffset)){a=t(a,e.UNSIGNED_INT);o=t(o,1);return n(this,i,a,o,1,s.byteOffset)}return s};i.prototype.getPropertyArray=function(t,i,o){var s=this.json[t];if(!r(s)){return undefined}if(r(s.byteOffset)){if(r(s.componentType)){i=e.fromName(s.componentType)}return n(this,t,i,o,this.featuresLength,s.byteOffset)}return a(this,t,i,s)};i.prototype.getProperty=function(e,t,i,n,a){var o=this.json[e];if(!r(o)){return undefined}var s=this.getPropertyArray(e,t,i);if(i===1){return s[n]}for(var l=0;l<i;++l){a[l]=s[i*n+l]}return a};return i});define("Scene/Batched3DModel3DTileContent",["../Core/Check","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/getAbsoluteUri","../Core/getBaseUri","../Core/getStringFromTypedArray","../Core/RequestType","../Core/RuntimeError","../Renderer/Pass","./Cesium3DTileBatchTable","./Cesium3DTileFeature","./Cesium3DTileFeatureTable","./getAttributeOrUniformBySemantic","./Model"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y){"use strict";if(!l.supportsTypedArrays()){return{}}function b(e,t,r,i,n){this._tileset=e;this._tile=t;this._url=r;this._model=undefined;this._batchTable=undefined;this._features=undefined;this.featurePropertiesDirty=false;x(this,i,n)}b._deprecationWarning=a;n(b.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return this._model.trianglesLength}},geometryByteLength:{get:function(){return this._model.geometryByteLength}},texturesByteLength:{get:function(){return this._model.texturesByteLength}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){return undefined}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._url}},batchTable:{get:function(){return this._batchTable}}});var w=Uint32Array.BYTES_PER_ELEMENT;function C(e){var t=_(e,"_BATCHID");if(!i(t)){t=_(e,"BATCHID");if(i(t)){b._deprecationWarning("b3dm-legacy-batchid","The glTF in this b3dm uses the semantic `BATCHID`. Application-specific semantics should be prefixed with an underscore: `_BATCHID`.")}}return t}function S(e){return function(t){var r=e._batchTable;var n=e._model.gltf;var a=C(n);var o=r.getVertexShaderCallback(true,a);return i(o)?o(t):t}}function T(e){return function(t){var r=e._batchTable;var n=e._model.gltf;var a=C(n);var o=r.getPickVertexShaderCallback(a);return i(o)?o(t):t}}function E(e){return function(t){var r=e._batchTable;var n=e._model.gltf;var a=_(n,"_3DTILESDIFFUSE");var o=r.getFragmentShaderCallback(true,a);return i(o)?o(t):t}}function x(e,t,i){var n=e._tileset;var a=e._tile;var o=u(c(e._url,true));var s=r(i,0);i=s;var l=new Uint8Array(t);var v=new DataView(t);i+=w;var _=v.getUint32(i,true);if(_!==1){throw new h("Only Batched 3D Model version 1 is supported.  Version "+_+" is not.")}i+=w;var C=v.getUint32(i,true);i+=w;var x=v.getUint32(i,true);i+=w;var P=v.getUint32(i,true);i+=w;var A=v.getUint32(i,true);i+=w;var O=v.getUint32(i,true);i+=w;var D;if(A>=570425344){i-=w*2;D=x;A=P;O=0;x=0;P=0;b._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/AnalyticalGraphicsInc/3d-tiles/blob/master/TileFormats/Batched3DModel/README.md.")}else if(O>=570425344){i-=w;D=A;A=x;O=P;x=0;P=0;b._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/AnalyticalGraphicsInc/3d-tiles/blob/master/TileFormats/Batched3DModel/README.md.")}var I;if(x===0){I={BATCH_LENGTH:r(D,0)}}else{var M=d(l,i,x);I=JSON.parse(M);i+=x}var R=new Uint8Array(t,i,P);i+=P;var L=new g(I,R);D=L.getGlobalProperty("BATCH_LENGTH");L.featuresLength=D;var N;var k;if(A>0){var F=d(l,i,A);N=JSON.parse(F);i+=A;if(O>0){k=new Uint8Array(t,i,O);k=new Uint8Array(k);i+=O}}var B=new m(e,D,N,k);e._batchTable=B;var U=s+C-i;if(U===0){throw new h("glTF byte length must be greater than 0.")}var V;if(i%4===0){V=new Uint8Array(t,i,U)}else{b._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary.");V=new Uint8Array(l.subarray(i,i+U))}var z={content:e,primitive:n};e._model=new y({gltf:V,cull:false,releaseGltfJson:true,opaquePass:p.CESIUM_3D_TILE,basePath:o,requestType:f.TILES3D,modelMatrix:a.computedTransform,upAxis:n._gltfUpAxis,shadows:n.shadows,debugWireframe:n.debugWireframe,incrementallyLoadTextures:false,vertexShaderLoaded:S(e),fragmentShaderLoaded:E(e),uniformMapLoaded:B.getUniformMapCallback(),pickVertexShaderLoaded:T(e),pickFragmentShaderLoaded:B.getPickFragmentShaderCallback(),pickUniformMapLoaded:B.getPickUniformMapCallback(),addBatchIdToGeneratedShaders:D>0,pickObject:z})}function P(e){var t=e._tileset;var r=e.featuresLength;if(!i(e._features)&&r>0){var n=new Array(r);for(var a=0;a<r;++a){n[a]=new v(t,e,a)}e._features=n}}b.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)};b.prototype.getFeature=function(e){var t=this.featuresLength;if(!i(e)||e<0||e>=t){throw new s("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").")}P(this);return this._features[e]};b.prototype.applyDebugSettings=function(e,r){r=e?r:t.WHITE;if(this.featuresLength===0){this._model.color=r}else{this._batchTable.setAllColor(r)}};b.prototype.applyStyle=function(e,t){this._batchTable.applyStyle(e,t)};b.prototype.update=function(e,t){var r=t.commandList.length;this._batchTable.update(e,t);this._model.modelMatrix=this._tile.computedTransform;this._model.shadows=this._tileset.shadows;this._model.debugWireframe=this._tileset.debugWireframe;this._model.update(t);var i=t.commandList.length;if(r<i&&t.passes.render){this._batchTable.addDerivedCommands(t,r)}};b.prototype.isDestroyed=function(){return false};b.prototype.destroy=function(){this._model=this._model&&this._model.destroy();this._batchTable=this._batchTable&&this._batchTable.destroy();return o(this)};return b});define("Scene/BingMapsStyle",["../Core/freezeObject"],function(e){"use strict";var t={AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",ROAD:"Road",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"};return e(t)});define("Scene/BingMapsImageryProvider",["../Core/BingMapsApi","../Core/Cartesian2","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/loadJsonp","../Core/Math","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./BingMapsStyle","./DiscardMissingTileImagePolicy","./ImageryProvider"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g){"use strict";function _(a){a=i(a,{});if(!n(a.url)){throw new o("options.url is required.")}this._key=e.getKey(a.key);this._keyErrorCredit=e.getErrorCredit(a.key);this._url=a.url;this._tileProtocol=a.tileProtocol;this._mapStyle=i(a.mapStyle,m.AERIAL);this._culture=i(a.culture,"");this._tileDiscardPolicy=a.tileDiscardPolicy;this._proxy=a.proxy;this._credit=new r("Bing Imagery",_._logoData,"http://www.bing.com");this.defaultGamma=1;this._tilingScheme=new h({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:a.ellipsoid});this._tileWidth=undefined;this._tileHeight=undefined;this._maximumLevel=undefined;this._imageUrlTemplate=undefined;this._imageUrlSubdomains=undefined;this._errorEvent=new s;this._ready=false;this._readyPromise=p.defer();var g=this._url+"/REST/v1/Imagery/Metadata/"+this._mapStyle+"?incl=ImageryProviders&key="+this._key;var y=this;var w;function C(e){var i=e.resourceSets[0].resources[0];y._tileWidth=i.imageWidth;y._tileHeight=i.imageHeight;y._maximumLevel=i.zoomMax-1;y._imageUrlSubdomains=i.imageUrlSubdomains;y._imageUrlTemplate=i.imageUrl.replace("{culture}",y._culture);var a=y._tileProtocol;if(!n(a)){var o=document.location.protocol;a=/^http/.test(o)?o:"http:"}y._imageUrlTemplate=y._imageUrlTemplate.replace(/^http:/,a);if(!n(y._tileDiscardPolicy)){y._tileDiscardPolicy=new v({missingImageUrl:b(y,0,0,y._maximumLevel),pixelsToCheck:[new t(0,0),new t(120,140),new t(130,160),new t(200,50),new t(200,200)],disableCheckIfAllPixelsAreTransparent:true})}var s=y._attributionList=i.imageryProviders;if(!s){s=y._attributionList=[]}for(var l=0,d=s.length;l<d;++l){var h=s[l];h.credit=new r(h.attribution);var p=h.coverageAreas;for(var m=0,g=h.coverageAreas.length;m<g;++m){var _=p[m];var C=_.bbox;_.bbox=new c(u.toRadians(C[1]),u.toRadians(C[0]),u.toRadians(C[3]),u.toRadians(C[2]))}}y._ready=true;y._readyPromise.resolve(true);f.handleSuccess(w)}function S(e){var t="An error occurred while accessing "+g+".";w=f.handleError(w,y,y._errorEvent,t,undefined,undefined,undefined,T);y._readyPromise.reject(new d(t))}function T(){var e=l(g,{callbackParameterName:"jsonp",proxy:y._proxy});p(e,C,S)}T()}a(_.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){if(!this._ready){throw new o("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this._ready){throw new o("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready){throw new o("maximumLevel must not be called before the imagery provider is ready.")}return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready){throw new o("minimumLevel must not be called before the imagery provider is ready.")}return 0}},tilingScheme:{get:function(){if(!this._ready){throw new o("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},rectangle:{get:function(){if(!this._ready){throw new o("rectangle must not be called before the imagery provider is ready.")}return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready){throw new o("tileDiscardPolicy must not be called before the imagery provider is ready.")}return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return false}}});var y=new c;_.prototype.getTileCredits=function(e,t,r){if(!this._ready){throw new o("getTileCredits must not be called before the imagery provider is ready.")}var i=this._tilingScheme.tileXYToRectangle(e,t,r,y);var a=C(this._attributionList,r,i);if(n(this._keyErrorCredit)){a.push(this._keyErrorCredit)}return a};_.prototype.requestImage=function(e,t,r,i){if(!this._ready){throw new o("requestImage must not be called before the imagery provider is ready.")}var n=b(this,e,t,r);return g.loadImage(this,n,i)};_.prototype.pickFeatures=function(e,t,r,i,n){return undefined};_._logoData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAAaCAYAAAAEy1RnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3gIDEgcPTMnXOQAAClZJREFUWMPdWGtsFNcV/u689uH1+sXaONhlWQzBENtxiUFBpBSLd60IpXHSNig4URtSYQUkRJNSi0igViVVVBJBaBsiAgKRQJSG8AgEHCCWU4iBCprY2MSgXfOI16y9D3s9Mzsztz9yB12WNU2i9Ecy0tHOzN4793zn3POdcy7BnRfJ8I7iB3SRDPeEExswLz8Y0DZIAYDIRGAgLQAm+7Xle31J3L3Anp1MZPY+BUBjorN332vgYhpgV1FRUd6TTz45ubq6OtDV1SXpuu5g//Oept9wNwlMyAi8IXDjyF245TsDTdivDMATCATGNDU1/WbhwoWPTZs2bWx1dXWhx+Oxrl+/PqTrus5t9W8KWEzjinTAYhro/xuBStwiIgBnJBLxKIoy1u/3V/r9/krDMMz3339/Z3t7e38ikUgCMDLEt8W+Q0cAI3McYTDDmZxh7DESG5Ni43jg9Gsa+X+OsxWxPSJTSj3JZFK5ZRVJErOzs8e6XC4fgGwALhbzDgAKU1hK28KEA6PMmTMn56233qpevnz5PQDcbJ7EzVUAuMrLy3MBeABkcWOEDELSyFe4y7iMoHkriZZlKYZh8ASHZDKpJJPJHAC5APIA5APIAeBlCjo5TwlpXnbOmTPHP3fu3KZVq1atZKBcDJQ9x7V48WJfc3Pzhp6enj+tXLnyR8w4MjdG4gyVDk7KICMClzKlLUrpbQMNw5AkScppbGz8cWdn57WjR4/2caw+DEBlYjO8wX1foZQWuN3uKZIklQD4G+fhlG0Yl8uVm5WVVW6app6dne0D0G8vnxbjJntHubCUOK/badZICyWanrJuAaeUknTQpmlKkUhEWbx48U8LCwtHhUKha+fPn+85fPhwV0tLyzUACSZx9jvMFhIByNFoVDEMw/qKB5HPvJfkUqBr9+7deklJyZ/j8bi5ffv2OAslieMLsG+m2DybT2QuzEQOsF5SUqJfvXo1yc2l6Xn6rgSRSCSEc+fOhVeuXLmwoqJixvTp0wcWLFgQ7unpudHR0dF97ty5z/fu3XseQJh5adjeerquy5ZlCalUivh8Pt8HH3ywzOPxyD09PZ81NjZ+2NnZaQEQx40b54vFYqaqquEVK1b4a2tr/WvWrDn18ssv144fP36SqqoD69ev371nz57rDLwAwHHkyJGfjRs3rtowDOv06dOnu7q6rs6bN2/s7Nmz9zIjDKenWoFZKg/AlMLCwl82Nzf/m3LX22+/fXb06NF/ALC8u7u7m6ZdkUhksL29/UpLS0vzunXrVgAoBzAaQBGAiY2NjUui0ei1RCLRFwwG/9PX19cVi8WCqqoOdHd3HysrK6sDMCccDl8IBoOtiqIsOnbs2D+i0eiV3t7ez8Ph8GeRSKRT07TB/v7+i1OnTp0HYBqABzs7O/+paVo0Fot1RyKRi/F4/Gp/f39XIpHoZnoUMn6wU+ZtRDaymwmxZFk2AWjvvvvuJ/F4PMn/n5+fn1VeXu6fOXNmbU1NzUOM4Bz8QqIoyg6HwxuLxfq3bdu2a+vWrW/09/dfKy0tffDVV199BEC20+n0ud3uQgBup9Pp83g8JYqieE+ePPnxxo0bt33xxRen8/Ly7n3hhRcWASh47bXX5pWVldWFw+GuXbt27XjzzTd3BoPBDq/XG1AUZRRHmAKPVfqaoKkgCCkA+oYNG84Eg0FHTU1N5ezZs8eWlJQ4CSF8/LvZYhJPQoQQpFKpwcrKyo1su9HBwUF99erVv588eXINgOOmacIwDEopdaZSKUIpxYkTJz6sr68/BMBav379RcMwZk2aNOl+AP+qq6t7xDTNVEVFxR+j0WgSAJk4ceKlTz/9tNzpdHpZvIvpjVW6pykhhBJCbkvwgiAQQogEQL558ybdtGlTsLm5OWJZdxZmlmWll5OUEEJN0zSGhob6GcOrALSzZ8/2apqWcLlc2axGACNRkRAimqaph0Kh68xIwwB0y7IMSZKcABz5+fkl8Xj8y2g0apOb5na7rYGBgS/JV54Q0qpAAoBKaS0jBWClg1ZVFeFw2AlgVF1dXeDpp5+eWVFRUVpcXOzgvQwAbrcbDJhdudlGpKZpGtx6JCcnRxIEQbQsS2PjbjM+AMvlchnMSBaXkr7ymCCIhmEYfMoVRVESBEHI0CaTTNubssUsQRBuubCtra33pZdeCk6YMCGwZs2aipqaGn9paWmuJEl3JP0bN258eeTIkRMABrm0YomiaImiKGVlZeWxLecAgBkzZvgdDkfWjRs3ggA0bpfpoiiahBCqKEqKAy2yULMA6MlkMp6Xl3cP1x2SWCwmFhQU+CmlFhfHNFOevpX4LcvSJUkyAeDQoUOh119//fpTTz01Zf78+UWBQCBHUZQ7yE/TNGPfvn0n33vvvSP79+//BECMeZsCMGRZNgRBgNPpHHXx4sVVDQ0Nf1+wYMGYJ554YikAevDgwUMA4oIgQJZlSggZdDqdBiGEZGdn6ww0tQlJURTT4/EMHz9+/MCjjz7622AwuHbZsmVbiouLvWvXrm1wOp3ZqVRqaKQTIInf1gAMl8ulU0q1CxcuBGOxmL5u3bryQCDgycrKEjORXGtra8eOHTsOHz169OyVK1cuA+hlRYrGlNRkWR7UNO2mYRiaz+cb3dLS8gYhhOi6Hj116tSOVatWHQNALcsaME0zLghClBDSZ9+zQsZ2SoJS2udwOKLPPffcvsrKyrJAIPDQ/v37txiGofX19V3r7e29UlBQMHqEVpjwnrYA6PF4PK6q6s2qqqqpZWVlitvtljOB7enpiWzbtu3wgQMHTre1tV0E0MeKkkGuIhMAqHv37u30er3Px+NxlyiKygMPPOAnhFiXLl0Kbd68uYPNsXbu3Lk6mUwaqqr2btmyZUdtbe3hd955pwvAEFNcO3jw4K/b2tqiqqpGIpGI4/HHH/9rQ0PDCa/XOyoSidDLly8PNTU1PcZ4QuNK1ju6NYHFRAGASXPnzv1Fa2vrxzTDpapqateuXR/Nnz+/SVGUhwFMBzCBFSLZLF75DsrJGpXRAH4EIABgPIBxAEoBFAPwARjFif1sNzZ25+VlOhaxufcCqAFQC+BhAPVLliz5XSqVUkOhUAuAKWnFyR3dlsw+fg+A+8eMGfPzTZs2bY9GozEb8JkzZ9qXLl36l+Li4l8B+AmAyQDGsGrOzfXNPGPawG2l85jksmcPm+vihH+2W1iF3bvZPN+sWbPuGx4eDrW3t+85fvz41o6OjmZN04Y0TYvV19cvYIbN5QqUjG2mwj5YAqDK4XDMe+aZZ55vbW09+sorr2yuqqpqYFatAuBn3uB7XzJCY297XeaUd2RoGzOJmHb6IjFj5D777LP3DQwMfDw8PBxSVbUvkUj0hEKhj1588cXH2O7zMSPdplumoxveMx5Zlj3jx4/39vb26gMDA4MsvgYZo+p8Pr7LqQX5Ds/U7d0jFxUVZS1atKg4Nzc317Isp67rZldXV6y5ufkmI78hFtcmrx8ZweMit6XsUs4+6kmlgbW+peLf9gyMZNCR374G0y/FxEzX8b/8+bkXEBxKFwAAAABJRU5ErkJggg==";_.tileXYToQuadKey=function(e,t,r){var i="";for(var n=r;n>=0;--n){var a=1<<n;var o=0;if((e&a)!==0){o|=1}if((t&a)!==0){o|=2}i+=o}return i};_.quadKeyToTileXY=function(e){var t=0;var r=0;var i=e.length-1;for(var n=i;n>=0;--n){var a=1<<n;var o=+e[i-n];if((o&1)!==0){t|=a}if((o&2)!==0){r|=a}}return{x:t,y:r,level:i}};function b(e,t,r,i){var a=e._imageUrlTemplate;var o=_.tileXYToQuadKey(t,r,i);a=a.replace("{quadkey}",o);var s=e._imageUrlSubdomains;var l=(t+r+i)%s.length;a=a.replace("{subdomain}",s[l]);var u=e._proxy;if(n(u)){a=u.getURL(a)}return a}var w=new c;function C(e,t,r){++t;var i=[];for(var a=0,o=e.length;a<o;++a){var s=e[a];var l=s.coverageAreas;var u=false;for(var d=0,f=s.coverageAreas.length;!u&&d<f;++d){var h=l[d];if(t>=h.zoomMin&&t<=h.zoomMax){var p=c.intersection(r,h.bbox,w);if(n(p)){u=true}}}if(u){i.push(s.credit)}}return i}return _});define("Scene/BoxEmitter",["../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/defineProperties","../Core/Math"],function(e,t,r,i,n){"use strict";var a=new e(1,1,1);function o(i){i=r(i,a);t.defined("dimensions",i);t.typeOf.number.greaterThanOrEquals("dimensions.x",i.x,0);t.typeOf.number.greaterThanOrEquals("dimensions.y",i.y,0);t.typeOf.number.greaterThanOrEquals("dimensions.z",i.z,0);this._dimensions=e.clone(i)}i(o.prototype,{dimensions:{get:function(){return this._dimensions},set:function(r){t.defined("value",r);t.typeOf.number.greaterThanOrEquals("value.x",r.x,0);t.typeOf.number.greaterThanOrEquals("value.y",r.y,0);t.typeOf.number.greaterThanOrEquals("value.z",r.z,0);e.clone(r,this._dimensions)}}});var s=new e;o.prototype.emit=function(t){var r=this._dimensions;var i=e.multiplyByScalar(r,.5,s);var a=n.randomBetween(-i.x,i.x);var o=n.randomBetween(-i.y,i.y);var l=n.randomBetween(-i.z,i.z);t.position=e.fromElements(a,o,l,t.position);t.velocity=e.normalize(t.position,t.velocity)};return o});define("Shaders/BrdfLutGeneratorFS",[],function(){"use strict";return"varying vec2 v_textureCoordinates;\nconst float M_PI = 3.141592653589793;\n\nfloat vdcRadicalInverse(int i)\n{\n    float r;\n    float base = 2.0;\n    float value = 0.0;\n    float invBase = 1.0 / base;\n    float invBi = invBase;\n    for (int x = 0; x < 100; x++)\n    {\n        if (i <= 0)\n        {\n            break;\n        }\n        r = mod(float(i), base);\n        value += r * invBi;\n        invBi *= invBase;\n        i = int(float(i) * invBase);\n    }\n    return value;\n}\n\nvec2 hammersley2D(int i, int N)\n{\n    return vec2(float(i) / float(N), vdcRadicalInverse(i));\n}\n\nvec3 importanceSampleGGX(vec2 xi, float roughness, vec3 N)\n{\n    float a = roughness * roughness;\n    float phi = 2.0 * M_PI * xi.x;\n    float cosTheta = sqrt((1.0 - xi.y) / (1.0 + (a * a - 1.0) * xi.y));\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\n    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, N));\n    vec3 tangentY = cross(N, tangentX);\n    return tangentX * H.x + tangentY * H.y + N * H.z;\n}\n\nfloat G1_Smith(float NdotV, float k)\n{\n    return NdotV / (NdotV * (1.0 - k) + k);\n}\n\nfloat G_Smith(float roughness, float NdotV, float NdotL)\n{\n    float k = roughness * roughness / 2.0;\n    return G1_Smith(NdotV, k) * G1_Smith(NdotL, k);\n}\n\nvec2 integrateBrdf(float roughness, float NdotV)\n{\n    vec3 V = vec3(sqrt(1.0 - NdotV * NdotV), 0.0, NdotV);\n    float A = 0.0;\n    float B = 0.0;\n    const int NumSamples = 1024;\n    for (int i = 0; i < NumSamples; i++)\n    {\n        vec2 xi = hammersley2D(i, NumSamples);\n        vec3 H = importanceSampleGGX(xi, roughness, vec3(0.0, 0.0, 1.0));\n        vec3 L = 2.0 * dot(V, H) * H - V;\n        float NdotL = clamp(L.z, 0.0, 1.0);\n        float NdotH = clamp(H.z, 0.0, 1.0);\n        float VdotH = clamp(dot(V, H), 0.0, 1.0);\n        if (NdotL > 0.0)\n        {\n            float G = G_Smith(roughness, NdotV, NdotL);\n            float G_Vis = G * VdotH / (NdotH * NdotV);\n            float Fc = pow(1.0 - VdotH, 5.0);\n            A += (1.0 - Fc) * G_Vis;\n            B += Fc * G_Vis;\n        }\n    }\n    return vec2(A, B) / float(NumSamples);\n}\n\nvoid main()\n{\n    gl_FragColor = vec4(integrateBrdf(1.0 - v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0);\n}\n"});define("Scene/BrdfLutGenerator",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/PixelFormat","../Renderer/Framebuffer","../Renderer/Pass","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Shaders/BrdfLutGeneratorFS"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";function g(){this._framebuffer=undefined;this._colorTexture=undefined;this._drawCommand=undefined}i(g.prototype,{colorTexture:{get:function(){return this._colorTexture}}});function _(t,r){var i=t._framebuffer;var n=r.createViewportQuadCommand(v,{framebuffer:i,renderState:u.fromCache({viewport:new e(0,0,256,256)})});t._drawCommand=n}function y(e,t){var r=new f({context:t,width:256,height:256,pixelFormat:a.RGBA,pixelDatatype:l.UNSIGNED_BYTE,sampler:new c({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:p.NEAREST,magnificationFilter:h.NEAREST})});e._colorTexture=r;var i=new o({context:t,colorTextures:[r],destroyAttachments:false});e._framebuffer=i}g.prototype.update=function(e){if(!r(this._colorTexture)){var t=e.context;y(this,t);_(this,t);this._drawCommand.execute(t);this._framebuffer=this._framebuffer&&this._framebuffer.destroy();this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}};g.prototype.isDestroyed=function(){return false};g.prototype.destroy=function(){this._colorTexture=this._colorTexture&&this._colorTexture.destroy();return n(this)};return g});define("Scene/CameraFlightPath",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/EasingFunction","../Core/Math","../Core/PerspectiveFrustum","../Core/PerspectiveOffCenterFrustum","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";var d={};function f(e,t,r){var i;var n;var a;if(e instanceof l){var o=Math.tan(.5*e.fovy);i=e.near;n=e.near*o;a=e.aspectRatio*n;return Math.max(t*i/a,r*i/n)}else if(e instanceof u){i=e.near;n=e.top;a=e.right;return Math.max(t*i/a,r*i/n)}return Math.max(t,r)}var h=new t;var p=new t;function m(e,t,r,i){if(n(i)&&r(.5)>i){var a=r(0);var o=r(1);var l=r(.5);var u=l-a;var c=l-o;return function(i){var n=r(i);if(i<=.5){var l=(n-a)/u;return s.lerp(e,-s.PI_OVER_TWO,l)}var d=(n-o)/c;return s.lerp(-s.PI_OVER_TWO,t,1-d)}}return function(r){return s.lerp(e,t,r)}}function v(e,r,i,a,o){var l=o;var u=Math.max(i,a);if(!n(l)){var c=e.position;var d=r;var m=e.up;var v=e.right;var g=e.frustum;var _=t.subtract(c,d,h);var y=t.magnitude(t.multiplyByScalar(m,t.dot(_,m),p));var b=t.magnitude(t.multiplyByScalar(v,t.dot(_,v),p));l=Math.min(f(g,y,b)*.2,1e9)}if(u<l){var w=8;var C=1e6;var S=-Math.pow((l-i)*C,1/w);var T=Math.pow((l-a)*C,1/w);return function(e){var t=e*(T-S)+S;return-Math.pow(t,w)/C+l}}return function(e){return s.lerp(i,a,e)}}function g(e,t){if(s.equalsEpsilon(e,s.TWO_PI,s.EPSILON11)){e=0}if(t>e+Math.PI){e+=s.TWO_PI}else if(t<e-Math.PI){e-=s.TWO_PI}return e}var _=new t;function y(r,i,n,a,o,l,u){var c=r.camera;var d=t.clone(c.position,_);var f=c.pitch;var h=g(c.heading,a);var p=g(c.roll,l);var m=v(c,n,d.z,n.z,u);function y(t){var r=t.time/i;c.setView({orientation:{heading:s.lerp(h,a,r),pitch:s.lerp(f,o,r),roll:s.lerp(p,l,r)}});e.lerp(d,n,r,c.position);c.position.z=m(r)}return y}function b(e,t){if(e.longitude<t.longitude){e.longitude+=s.TWO_PI}else{t.longitude+=s.TWO_PI}}function w(e,t){var r=e.longitude-t.longitude;if(r<-s.PI){e.longitude+=s.TWO_PI}else if(r>s.PI){t.longitude+=s.TWO_PI}}var C=new r;var S=new r;function T(e,i,a,o,l,u,c,d,f,h){var p=e.camera;var _=e.mapProjection;var y=_.ellipsoid;var T=r.clone(p.positionCartographic,C);var E=p.pitch;var x=g(p.heading,o);var P=g(p.roll,u);var A=y.cartesianToCartographic(a,S);T.longitude=s.zeroToTwoPi(T.longitude);A.longitude=s.zeroToTwoPi(A.longitude);var O=false;if(n(d)){var D=s.zeroToTwoPi(d);var I=Math.min(T.longitude,A.longitude);var M=Math.max(T.longitude,A.longitude);var R=D>=I&&D<=M;if(n(f)){var L=Math.abs(T.longitude-A.longitude);var N=s.TWO_PI-L;var k=R?L:N;var F=R?N:L;if(k<F*f&&!R){O=true}}else if(!R){O=true}}if(O){b(T,A)}else{w(T,A)}var B=v(p,a,T.height,A.height,c);var U=m(E,l,B,h);function V(){var e=T.longitude;var r=A.longitude;var n=T.latitude;var a=A.latitude;return function l(c){var d=c.time/i;var f=t.fromRadians(s.lerp(e,r,d),s.lerp(n,a,d),B(d));p.setView({destination:f,orientation:{heading:s.lerp(x,o,d),pitch:U(d),roll:s.lerp(P,u,d)}})}}return V()}function E(r,i,n,a,o,l,u){var c=r.camera;var d=t.clone(c.position,_);var f=g(c.heading,a);var h=c.frustum.right-c.frustum.left;var p=v(c,n,h,n.z,u);function m(t){var r=t.time/i;c.setView({orientation:{heading:s.lerp(f,a,r)}});e.lerp(d,n,r,c.position);var o=p(r);var l=c.frustum;var u=l.top/l.right;var h=(o-(l.right-l.left))*.5;l.right+=h;l.left-=h;l.top=u*l.right;l.bottom=-l.top}return m}var x=new r;var P=new t;function A(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}function O(e,t){function r(){if(typeof t==="function"){t()}e.enableInputs=true}return r}d.createTween=function(r,l){l=i(l,i.EMPTY_OBJECT);var u=l.destination;if(!n(r)){throw new a("scene is required.")}if(!n(u)){throw new a("destination is required.")}var d=r.mode;if(d===c.MORPHING){return A()}var f=i(l.convert,true);var h=r.mapProjection;var p=h.ellipsoid;var m=l.maximumHeight;var v=l.flyOverLongitude;var g=l.flyOverLongitudeWeight;var _=l.pitchAdjustHeight;var b=l.easingFunction;if(f&&d!==c.SCENE3D){p.cartesianToCartographic(u,x);u=h.project(x,P)}var w=r.camera;var C=l.endTransform;if(n(C)){w._setTransform(C)}var S=l.duration;if(!n(S)){S=Math.ceil(t.distance(w.position,u)/1e6)+2;S=Math.min(S,3)}var D=i(l.heading,0);var I=i(l.pitch,-s.PI_OVER_TWO);var M=i(l.roll,0);var R=r.screenSpaceCameraController;R.enableInputs=false;var L=O(R,l.complete);var N=O(R,l.cancel);var k=w.frustum;var F=r.mode===c.SCENE2D;F=F&&e.equalsEpsilon(w.position,u,s.EPSILON6);F=F&&s.equalsEpsilon(Math.max(k.right-k.left,k.top-k.bottom),u.z,s.EPSILON6);F=F||r.mode!==c.SCENE2D&&t.equalsEpsilon(u,w.position,s.EPSILON10);F=F&&s.equalsEpsilon(s.negativePiToPi(D),s.negativePiToPi(w.heading),s.EPSILON10)&&s.equalsEpsilon(s.negativePiToPi(I),s.negativePiToPi(w.pitch),s.EPSILON10)&&s.equalsEpsilon(s.negativePiToPi(M),s.negativePiToPi(w.roll),s.EPSILON10);if(F){return A(L,N)}var B=new Array(4);B[c.SCENE2D]=E;B[c.SCENE3D]=T;B[c.COLUMBUS_VIEW]=y;if(S<=0){var U=function(){var e=B[d](r,1,u,D,I,M,m,v,g,_);e({time:1});if(typeof L==="function"){L()}};return A(U,N)}var V=B[d](r,S,u,D,I,M,m,v,g,_);if(!n(b)){var z=w.positionCartographic.height;var q=d===c.SCENE3D?p.cartesianToCartographic(u).height:u.z;if(z>q&&z>11500){b=o.CUBIC_OUT}else{b=o.QUINTIC_IN_OUT}}return{duration:S,easingFunction:b,startObject:{time:0},stopObject:{time:S},update:V,complete:L,cancel:N}};return d});define("Scene/MapMode2D",["../Core/freezeObject"],function(e){"use strict";var t={ROTATE:0,INFINITE_SCROLL:1};return e(t)});define("Scene/Camera",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/EasingFunction","../Core/Ellipsoid","../Core/EllipsoidGeodesic","../Core/Event","../Core/HeadingPitchRange","../Core/HeadingPitchRoll","../Core/Intersect","../Core/IntersectionTests","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/Quaternion","../Core/Ray","../Core/Rectangle","../Core/Transforms","./CameraFlightPath","./MapMode2D","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O){"use strict";function D(e){if(!o(e)){throw new l("scene is required.")}this._scene=e;this._transform=y.clone(y.IDENTITY);this._invTransform=y.clone(y.IDENTITY);this._actualTransform=y.clone(y.IDENTITY);this._actualInvTransform=y.clone(y.IDENTITY);this._transformChanged=false;this.position=new r;this._position=new r;this._positionWC=new r;this._positionCartographic=new n;this.direction=new r;this._direction=new r;this._directionWC=new r;this.up=new r;this._up=new r;this._upWC=new r;this.right=new r;this._right=new r;this._rightWC=new r;this.frustum=new C;this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight;this.frustum.fov=g.toRadians(60);this.defaultMoveAmount=1e5;this.defaultLookAmount=Math.PI/60;this.defaultRotateAmount=Math.PI/3600;this.defaultZoomAmount=1e5;this.constrainedAxis=undefined;this.maximumZoomFactor=1.5;this._moveStart=new f;this._moveEnd=new f;this._changed=new f;this._changedPosition=undefined;this._changedDirection=undefined;this._changedFrustum=undefined;this.percentageChanged=.5;this._viewMatrix=new y;this._invViewMatrix=new y;I(this);this._mode=O.SCENE3D;this._modeChanged=true;var t=e.mapProjection;this._projection=t;this._maxCoord=t.project(new n(Math.PI,g.PI_OVER_TWO));this._max2Dfrustum=undefined;this._suspendTerrainAdjustment=false;$e(this,D.DEFAULT_VIEW_RECTANGLE,this.position,true);var i=r.magnitude(this.position);i+=i*D.DEFAULT_VIEW_FACTOR;r.normalize(this.position,this.position);r.multiplyByScalar(this.position,i,this.position)}D.TRANSFORM_2D=new y(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);D.TRANSFORM_2D_INVERSE=y.inverseTransformation(D.TRANSFORM_2D,new y);D.DEFAULT_VIEW_RECTANGLE=E.fromDegrees(-60,-20,-75,90);D.DEFAULT_VIEW_FACTOR=.5;D.DEFAULT_OFFSET=new h(0,-g.PI_OVER_FOUR,0);function I(e){y.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix);y.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix);y.inverseTransformation(e._viewMatrix,e._invViewMatrix)}D.prototype._updateCameraChanged=function(){var e=this;if(e._changed.numberOfListeners===0){return}var t=e.percentageChanged;if(e._mode===O.SCENE2D){if(!o(e._changedFrustum)){e._changedPosition=r.clone(e.position,e._changedPosition);e._changedFrustum=e.frustum.clone();return}var i=e.position;var n=e._changedPosition;var a=e.frustum;var s=e._changedFrustum;var l=i.x+a.left;var u=i.x+a.right;var c=n.x+s.left;var d=n.x+s.right;var f=i.y+a.bottom;var h=i.y+a.top;var p=n.y+s.bottom;var m=n.y+s.top;var v=Math.max(l,c);var _=Math.min(u,d);var y=Math.max(f,p);var b=Math.min(h,m);var w;if(v>=_||y>=h){w=1}else{var C=s;if(l<c&&u>d&&f<p&&h>m){C=a}w=1-(_-v)*(b-y)/((C.right-C.left)*(C.top-C.bottom))}if(w>t){e._changed.raiseEvent(w);e._changedPosition=r.clone(e.position,e._changedPosition);e._changedFrustum=e.frustum.clone(e._changedFrustum)}return}if(!o(e._changedDirection)){e._changedPosition=r.clone(e.positionWC,e._changedPosition);e._changedDirection=r.clone(e.directionWC,e._changedDirection);return}var S=g.acosClamped(r.dot(e.directionWC,e._changedDirection));var T;if(o(e.frustum.fovy)){T=S/(e.frustum.fovy*.5)}else{T=S}var E=r.distance(e.positionWC,e._changedPosition);var x=E/e.positionCartographic.height;if(T>t||x>t){e._changed.raiseEvent(Math.max(T,x));e._changedPosition=r.clone(e.positionWC,e._changedPosition);e._changedDirection=r.clone(e.directionWC,e._changedDirection)}};var M=new y;var R=new n;D.prototype._adjustHeightForTerrain=function(){var e=this._scene;var t=e.screenSpaceCameraController;var i=t.enableCollisionDetection;var n=t.minimumCollisionTerrainHeight;var a=t.minimumZoomDistance;if(this._suspendTerrainAdjustment||!i){return}var s=this._mode;var l=e.globe;if(!o(l)||s===O.SCENE2D||s===O.MORPHING){return}var u=l.ellipsoid;var c=e.mapProjection;var d;var f;if(!y.equals(this.transform,y.IDENTITY)){d=y.clone(this.transform,M);f=r.magnitude(this.position);this._setTransform(y.IDENTITY)}var h=R;if(s===O.SCENE3D){u.cartesianToCartographic(this.position,h)}else{c.unproject(this.position,h)}var p=false;if(h.height<n){var m=l.getHeight(h);if(o(m)){m+=a;if(h.height<m){h.height=m;if(s===O.SCENE3D){u.cartographicToCartesian(h,this.position)}else{c.project(h,this.position)}p=true}}}if(o(d)){this._setTransform(d);if(p){r.normalize(this.position,this.position);r.negate(this.position,this.direction);r.multiplyByScalar(this.position,Math.max(f,a),this.position);r.normalize(this.direction,this.direction);r.cross(this.direction,this.up,this.right);r.cross(this.right,this.direction,this.up)}}};function L(e){x.basisTo2D(e._projection,e._transform,e._actualTransform)}var N=new n;var k=new r;var F=new r;var B=new i;var U=new i;var V=new i;var z=new i;var q=new i;function G(e){var t=e._projection;var n=t.ellipsoid;var a=y.getColumn(e._transform,3,B);var o=n.cartesianToCartographic(a,N);var s=t.project(o,k);var l=U;l.x=s.z;l.y=s.x;l.z=s.y;l.w=1;var u=i.clone(i.UNIT_X,q);var c=i.add(y.getColumn(e._transform,0,F),a,F);n.cartesianToCartographic(c,o);t.project(o,s);var d=V;d.x=s.z;d.y=s.x;d.z=s.y;d.w=0;r.subtract(d,l,d);d.x=0;var f=z;if(r.magnitudeSquared(d)>g.EPSILON10){r.cross(u,d,f)}else{var h=i.add(y.getColumn(e._transform,1,F),a,F);n.cartesianToCartographic(h,o);t.project(o,s);f.x=s.z;f.y=s.x;f.z=s.y;f.w=0;r.subtract(f,l,f);f.x=0;if(r.magnitudeSquared(f)<g.EPSILON10){i.clone(i.UNIT_Y,d);i.clone(i.UNIT_Z,f)}}r.cross(f,u,d);r.normalize(d,d);r.cross(u,d,f);r.normalize(f,f);y.setColumn(e._actualTransform,0,d,e._actualTransform);y.setColumn(e._actualTransform,1,f,e._actualTransform);y.setColumn(e._actualTransform,2,u,e._actualTransform);y.setColumn(e._actualTransform,3,l,e._actualTransform)}var H=new r;function j(e){var t=e._mode;var i=false;var n=0;if(t===O.SCENE2D){n=e.frustum.right-e.frustum.left;i=n!==e._positionCartographic.height}var a=e._position;var o=!r.equals(a,e.position)||i;if(o){a=r.clone(e.position,e._position)}var s=e._direction;var l=!r.equals(s,e.direction);if(l){r.normalize(e.direction,e.direction);s=r.clone(e.direction,e._direction)}var u=e._up;var c=!r.equals(u,e.up);if(c){r.normalize(e.up,e.up);u=r.clone(e.up,e._up)}var d=e._right;var f=!r.equals(d,e.right);if(f){r.normalize(e.right,e.right);d=r.clone(e.right,e._right)}var h=e._transformChanged||e._modeChanged;e._transformChanged=false;if(h){y.inverseTransformation(e._transform,e._invTransform);if(e._mode===O.COLUMBUS_VIEW||e._mode===O.SCENE2D){if(y.equals(y.IDENTITY,e._transform)){y.clone(D.TRANSFORM_2D,e._actualTransform)}else if(e._mode===O.COLUMBUS_VIEW){L(e)}else{G(e)}}else{y.clone(e._transform,e._actualTransform)}y.inverseTransformation(e._actualTransform,e._actualInvTransform);e._modeChanged=false}var p=e._actualTransform;if(o||h){e._positionWC=y.multiplyByPoint(p,a,e._positionWC);if(t===O.SCENE3D||t===O.MORPHING){e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic)}else{var m=H;m.x=e._positionWC.y;m.y=e._positionWC.z;m.z=e._positionWC.x;if(t===O.SCENE2D){m.z=n}e._projection.unproject(m,e._positionCartographic)}}if(l||c||f){var v=r.dot(s,r.cross(u,d,H));if(Math.abs(1-v)>g.EPSILON2){var _=1/r.magnitudeSquared(u);var b=r.dot(u,s)*_;var w=r.multiplyByScalar(s,b,H);u=r.normalize(r.subtract(u,w,e._up),e._up);r.clone(u,e.up);d=r.cross(s,u,e._right);r.clone(d,e.right)}}if(l||h){e._directionWC=y.multiplyByPointAsVector(p,s,e._directionWC);r.normalize(e._directionWC,e._directionWC)}if(c||h){e._upWC=y.multiplyByPointAsVector(p,u,e._upWC);r.normalize(e._upWC,e._upWC)}if(f||h){e._rightWC=y.multiplyByPointAsVector(p,d,e._rightWC);r.normalize(e._rightWC,e._rightWC)}if(o||l||c||f||h){I(e)}}function W(e,t){var r;if(!g.equalsEpsilon(Math.abs(e.z),1,g.EPSILON3)){r=Math.atan2(e.y,e.x)-g.PI_OVER_TWO}else{r=Math.atan2(t.y,t.x)-g.PI_OVER_TWO}return g.TWO_PI-g.zeroToTwoPi(r)}function Y(e){return g.PI_OVER_TWO-g.acosClamped(e.z)}function X(e,t,r){var i=0;if(!g.equalsEpsilon(Math.abs(e.z),1,g.EPSILON3)){i=Math.atan2(-r.z,t.z);i=g.zeroToTwoPi(i+g.TWO_PI)}return i}var Q=new y;var Z=new y;s(D.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){j(this);return this._invTransform}},viewMatrix:{get:function(){j(this);return this._viewMatrix}},inverseViewMatrix:{get:function(){j(this);return this._invViewMatrix}},positionCartographic:{get:function(){j(this);return this._positionCartographic}},positionWC:{get:function(){j(this);return this._positionWC}},directionWC:{get:function(){j(this);return this._directionWC}},upWC:{get:function(){j(this);return this._upWC}},rightWC:{get:function(){j(this);return this._rightWC}},heading:{get:function(){if(this._mode!==O.MORPHING){var e=this._projection.ellipsoid;var t=y.clone(this._transform,Q);var r=x.eastNorthUpToFixedFrame(this.positionWC,e,Z);this._setTransform(r);var i=W(this.direction,this.up);this._setTransform(t);return i}return undefined}},pitch:{get:function(){if(this._mode!==O.MORPHING){var e=this._projection.ellipsoid;var t=y.clone(this._transform,Q);var r=x.eastNorthUpToFixedFrame(this.positionWC,e,Z);this._setTransform(r);var i=Y(this.direction);this._setTransform(t);return i}return undefined}},roll:{get:function(){if(this._mode!==O.MORPHING){var e=this._projection.ellipsoid;var t=y.clone(this._transform,Q);var r=x.eastNorthUpToFixedFrame(this.positionWC,e,Z);this._setTransform(r);var i=X(this.direction,this.up,this.right);this._setTransform(t);return i}return undefined}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}});D.prototype.update=function(e){if(!o(e)){throw new l("mode is required.")}if(e===O.SCENE2D&&!(this.frustum instanceof w)){throw new l("An OrthographicOffCenterFrustum is required in 2D.")}if((e===O.SCENE3D||e===O.COLUMBUS_VIEW)&&(!(this.frustum instanceof C)&&!(this.frustum instanceof b))){throw new l("A PerspectiveFrustum or OrthographicFrustum is required in 3D and Columbus view")}var t=false;if(e!==this._mode){this._mode=e;this._modeChanged=e!==O.MORPHING;t=this._mode===O.SCENE2D}if(t){var r=this._max2Dfrustum=this.frustum.clone();if(!(r instanceof w)){throw new l("The camera frustum is expected to be orthographic for 2D camera control.")}var i=2;var n=r.top/r.right;r.right=this._maxCoord.x*i;r.left=-r.right;r.top=n*r.right;r.bottom=-r.top}if(this._mode===O.SCENE2D){be(this,this.position)}var a=this._scene.globe;var s=!o(a)||a._surface.tileProvider.ready&&a._surface._tileLoadQueueHigh.length===0&&a._surface._tileLoadQueueMedium.length===0&&a._surface._tileLoadQueueLow.length===0&&a._surface._debug.tilesWaitingForChildren===0;if(this._suspendTerrainAdjustment){this._suspendTerrainAdjustment=!s}this._adjustHeightForTerrain()};var K=new r;var J=new r;var $=new r;D.prototype._setTransform=function(e){var t=r.clone(this.positionWC,K);var i=r.clone(this.upWC,J);var n=r.clone(this.directionWC,$);y.clone(e,this._transform);this._transformChanged=true;j(this);var a=this._actualInvTransform;y.multiplyByPoint(a,t,this.position);y.multiplyByPointAsVector(a,n,this.direction);y.multiplyByPointAsVector(a,i,this.up);r.cross(this.direction,this.up,this.right);j(this)};var ee=new t;var te=new T;var re=new r;var ie=new r;D.prototype._adjustOrthographicFrustum=function(e){if(!(this.frustum instanceof b)){return}if(!e&&this._positionCartographic.height<15e4){return}if(!y.equals(y.IDENTITY,this.transform)){this.frustum.width=r.magnitude(this.position);return}var t=this._scene;var i=t._globe;var n;var a;if(o(i)){var s=ee;s.x=t.drawingBufferWidth/2;s.y=t.drawingBufferHeight/2;var l=this.getPickRay(s,te);n=i.pick(l,t,re);if(t.pickPositionSupported){a=t.pickPositionWorldCoordinates(s,ie)}if(o(n)&&o(a)){var u=o(a)?r.distance(a,this.positionWC):Number.POSITIVE_INFINITY;var c=o(n)?r.distance(n,this.positionWC):Number.POSITIVE_INFINITY;this.frustum.width=Math.min(u,c)}else if(o(a)){this.frustum.width=r.distance(a,this.positionWC)}else if(o(n)){this.frustum.width=r.distance(n,this.positionWC)}}if(!o(i)||!o(n)&&!o(a)){var d=Math.max(this.positionCartographic.height,0);this.frustum.width=d}};var ne=new r;var ae=new y;var oe=new y;var se=new S;var le=new _;var ue=new n;function ce(e,t,i){var n=y.clone(e.transform,ae);var a=x.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,oe);e._setTransform(a);r.clone(r.ZERO,e.position);i.heading=i.heading-g.PI_OVER_TWO;var o=S.fromHeadingPitchRoll(i,se);var s=_.fromQuaternion(o,le);_.getColumn(s,0,e.direction);_.getColumn(s,2,e.up);r.cross(e.direction,e.up,e.right);e._setTransform(n);e._adjustOrthographicFrustum(true)}function de(e,t,i,n){var a=y.clone(e.transform,ae);e._setTransform(y.IDENTITY);if(!r.equals(t,e.positionWC)){if(n){var o=e._projection;var s=o.ellipsoid.cartesianToCartographic(t,ue);t=o.project(s,ne)}r.clone(t,e.position)}i.heading=i.heading-g.PI_OVER_TWO;var l=S.fromHeadingPitchRoll(i,se);var u=_.fromQuaternion(l,le);_.getColumn(u,0,e.direction);_.getColumn(u,2,e.up);r.cross(e.direction,e.up,e.right);e._setTransform(a);e._adjustOrthographicFrustum(true)}function fe(e,i,n,a){var o=y.clone(e.transform,ae);e._setTransform(y.IDENTITY);if(!r.equals(i,e.positionWC)){if(a){var s=e._projection;var l=s.ellipsoid.cartesianToCartographic(i,ue);i=s.project(l,ne)}t.clone(i,e.position);var u=-i.z*.5;var c=-u;var d=e.frustum;if(c>u){var f=d.top/d.right;d.right=c;d.left=u;d.top=d.right*f;d.bottom=-d.top}}if(e._scene.mapMode2D===A.ROTATE){n.heading=n.heading-g.PI_OVER_TWO;n.pitch=-g.PI_OVER_TWO;n.roll=0;var h=S.fromHeadingPitchRoll(n,se);var p=_.fromQuaternion(h,le);_.getColumn(p,2,e.up);r.cross(e.direction,e.up,e.right)}e._setTransform(o)}var he=new r;var pe=new r;var me=new r;function ve(e,t,i,n){var a=r.clone(i.direction,he);var o=r.clone(i.up,pe);if(e._scene.mode===O.SCENE3D){var s=e._projection.ellipsoid;var l=x.eastNorthUpToFixedFrame(t,s,Q);var u=y.inverseTransformation(l,Z);y.multiplyByPointAsVector(u,a,a);y.multiplyByPointAsVector(u,o,o)}var c=r.cross(a,o,me);n.heading=W(a,o);n.pitch=Y(a);n.roll=X(a,o,c);return n}var ge={destination:undefined,orientation:{direction:undefined,up:undefined,heading:undefined,pitch:undefined,roll:undefined},convert:undefined,endTransform:undefined};var _e=new p;D.prototype.setView=function(e){e=a(e,a.EMPTY_OBJECT);var t=a(e.orientation,a.EMPTY_OBJECT);var i=this._mode;if(i===O.MORPHING){return}if(o(e.endTransform)){this._setTransform(e.endTransform)}var n=a(e.convert,true);var s=a(e.destination,r.clone(this.positionWC,ne));if(o(s)&&o(s.west)){s=this.getRectangleCameraCoordinates(s,ne);n=false}if(o(t.direction)){t=ve(this,s,t,ge.orientation)}_e.heading=a(t.heading,0);_e.pitch=a(t.pitch,-g.PI_OVER_TWO);_e.roll=a(t.roll,0);this._suspendTerrainAdjustment=true;if(i===O.SCENE3D){ce(this,s,_e)}else if(i===O.SCENE2D){fe(this,s,_e,n)}else{de(this,s,_e,n)}};var ye=new r;D.prototype.flyHome=function(e){var t=this._mode;if(t===O.MORPHING){this._scene.completeMorph()}if(t===O.SCENE2D){this.flyTo({destination:D.DEFAULT_VIEW_RECTANGLE,duration:e,endTransform:y.IDENTITY})}else if(t===O.SCENE3D){var i=this.getRectangleCameraCoordinates(D.DEFAULT_VIEW_RECTANGLE);var n=r.magnitude(i);n+=n*D.DEFAULT_VIEW_FACTOR;r.normalize(i,i);r.multiplyByScalar(i,n,i);this.flyTo({destination:i,duration:e,endTransform:y.IDENTITY})}else if(t===O.COLUMBUS_VIEW){var a=this._projection.ellipsoid.maximumRadius;var o=new r(0,-1,1);o=r.multiplyByScalar(r.normalize(o,o),5*a,o);this.flyTo({destination:o,duration:e,orientation:{heading:0,pitch:-Math.acos(r.normalize(o,ye).z),roll:0},endTransform:y.IDENTITY,convert:false})}};D.prototype.worldToCameraCoordinates=function(e,t){if(!o(e)){throw new l("cartesian is required.")}if(!o(t)){t=new i}j(this);return y.multiplyByVector(this._actualInvTransform,e,t)};D.prototype.worldToCameraCoordinatesPoint=function(e,t){if(!o(e)){throw new l("cartesian is required.")}if(!o(t)){t=new r}j(this);return y.multiplyByPoint(this._actualInvTransform,e,t)};D.prototype.worldToCameraCoordinatesVector=function(e,t){if(!o(e)){throw new l("cartesian is required.")}if(!o(t)){t=new r}j(this);return y.multiplyByPointAsVector(this._actualInvTransform,e,t)};D.prototype.cameraToWorldCoordinates=function(e,t){if(!o(e)){throw new l("cartesian is required.")}if(!o(t)){t=new i}j(this);return y.multiplyByVector(this._actualTransform,e,t)};D.prototype.cameraToWorldCoordinatesPoint=function(e,t){if(!o(e)){throw new l("cartesian is required.")}if(!o(t)){t=new r}j(this);return y.multiplyByPoint(this._actualTransform,e,t)};D.prototype.cameraToWorldCoordinatesVector=function(e,t){if(!o(e)){throw new l("cartesian is required.")}if(!o(t)){t=new r}j(this);return y.multiplyByPointAsVector(this._actualTransform,e,t)};function be(e,t){var r=e._scene.mapMode2D===A.ROTATE;var i=e._maxCoord.x;var n=e._maxCoord.y;var a;var o;if(r){o=i;a=-o}else{o=t.x-i*2;a=t.x+i*2}if(t.x>i){t.x=o}if(t.x<-i){t.x=a}if(t.y>n){t.y=n}if(t.y<-n){t.y=-n}}var we=new r;D.prototype.move=function(e,t){if(!o(e)){throw new l("direction is required.")}var i=this.position;r.multiplyByScalar(e,t,we);r.add(i,we,i);if(this._mode===O.SCENE2D){be(this,i)}this._adjustOrthographicFrustum(true)};D.prototype.moveForward=function(e){e=a(e,this.defaultMoveAmount);this.move(this.direction,e)};D.prototype.moveBackward=function(e){e=a(e,this.defaultMoveAmount);this.move(this.direction,-e)};D.prototype.moveUp=function(e){e=a(e,this.defaultMoveAmount);this.move(this.up,e)};D.prototype.moveDown=function(e){e=a(e,this.defaultMoveAmount);this.move(this.up,-e)};D.prototype.moveRight=function(e){e=a(e,this.defaultMoveAmount);this.move(this.right,e)};D.prototype.moveLeft=function(e){e=a(e,this.defaultMoveAmount);this.move(this.right,-e)};D.prototype.lookLeft=function(e){e=a(e,this.defaultLookAmount);this.look(this.up,-e)};D.prototype.lookRight=function(e){e=a(e,this.defaultLookAmount);this.look(this.up,e)};D.prototype.lookUp=function(e){e=a(e,this.defaultLookAmount);this.look(this.right,-e)};D.prototype.lookDown=function(e){e=a(e,this.defaultLookAmount);this.look(this.right,e)};var Ce=new S;var Se=new _;D.prototype.look=function(e,t){if(!o(e)){throw new l("axis is required.")}var r=a(t,this.defaultLookAmount);var i=S.fromAxisAngle(e,-r,Ce);var n=_.fromQuaternion(i,Se);var s=this.direction;var u=this.up;var c=this.right;_.multiplyByVector(n,s,s);_.multiplyByVector(n,u,u);_.multiplyByVector(n,c,c)};D.prototype.twistLeft=function(e){e=a(e,this.defaultLookAmount);this.look(this.direction,e)};D.prototype.twistRight=function(e){e=a(e,this.defaultLookAmount);this.look(this.direction,-e)};var Te=new S;var Ee=new _;D.prototype.rotate=function(e,t){if(!o(e)){throw new l("axis is required.")}var i=a(t,this.defaultRotateAmount);var n=S.fromAxisAngle(e,-i,Te);var s=_.fromQuaternion(n,Ee);_.multiplyByVector(s,this.position,this.position);_.multiplyByVector(s,this.direction,this.direction);_.multiplyByVector(s,this.up,this.up);r.cross(this.direction,this.up,this.right);r.cross(this.right,this.direction,this.up);this._adjustOrthographicFrustum(false)};D.prototype.rotateDown=function(e){e=a(e,this.defaultRotateAmount);De(this,e)};D.prototype.rotateUp=function(e){e=a(e,this.defaultRotateAmount);De(this,-e)};var xe=new r;var Pe=new r;var Ae=new r;var Oe=new r;function De(e,t){var i=e.position;var n=r.normalize(i,xe);if(o(e.constrainedAxis)){var a=r.equalsEpsilon(n,e.constrainedAxis,g.EPSILON2);var s=r.equalsEpsilon(n,r.negate(e.constrainedAxis,Oe),g.EPSILON2);if(!a&&!s){var l=r.normalize(e.constrainedAxis,Pe);var u=r.dot(n,l);var c=g.acosClamped(u);if(t>0&&t>c){t=c-g.EPSILON4}u=r.dot(n,r.negate(l,Oe));c=g.acosClamped(u);if(t<0&&-t>c){t=-c+g.EPSILON4}var d=r.cross(l,n,Ae);e.rotate(d,t)}else if(a&&t<0||s&&t>0){e.rotate(e.right,t)}}else{e.rotate(e.right,t)}}D.prototype.rotateRight=function(e){e=a(e,this.defaultRotateAmount);Ie(this,-e)};D.prototype.rotateLeft=function(e){e=a(e,this.defaultRotateAmount);Ie(this,e)};function Ie(e,t){if(o(e.constrainedAxis)){e.rotate(e.constrainedAxis,t)}else{e.rotate(e.up,t)}}function Me(e,t){var r=e.frustum;if(!(r instanceof w)||!o(r.left)||!o(r.right)||!o(r.bottom)||!o(r.top)){throw new l("The camera frustum is expected to be orthographic for 2D camera control.")}var i;t=t*.5;if(Math.abs(r.top)+Math.abs(r.bottom)>Math.abs(r.left)+Math.abs(r.right)){var n=r.top-t;var a=r.bottom+t;var s=e._maxCoord.y;if(e._scene.mapMode2D===A.ROTATE){s*=e.maximumZoomFactor}if(a>s){a=s;n=-s}if(n<=a){n=1;a=-1}i=r.right/r.top;r.top=n;r.bottom=a;r.right=r.top*i;r.left=-r.right}else{var u=r.right-t;var c=r.left+t;var d=e._maxCoord.x;if(e._scene.mapMode2D===A.ROTATE){d*=e.maximumZoomFactor}if(u>d){u=d;c=-d}if(u<=c){u=1;c=-1}i=r.top/r.right;r.right=u;r.left=c;r.top=r.right*i;r.bottom=-r.top}}function Re(e,t){e.move(e.direction,t)}D.prototype.zoomIn=function(e){e=a(e,this.defaultZoomAmount);if(this._mode===O.SCENE2D){Me(this,e)}else{Re(this,e)}};D.prototype.zoomOut=function(e){e=a(e,this.defaultZoomAmount);if(this._mode===O.SCENE2D){Me(this,-e)}else{Re(this,-e)}};D.prototype.getMagnitude=function(){if(this._mode===O.SCENE3D){return r.magnitude(this.position)}else if(this._mode===O.COLUMBUS_VIEW){return Math.abs(this.position.z)}else if(this._mode===O.SCENE2D){return Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom)}};var Le=new y;D.prototype.lookAt=function(e,t){if(!o(e)){throw new l("target is required")}if(!o(t)){throw new l("offset is required")}if(this._mode===O.MORPHING){throw new l("lookAt is not supported while morphing.")}var r=x.eastNorthUpToFixedFrame(e,c.WGS84,Le);this.lookAtTransform(r,t)};var Ne=new r;var ke=new S;var Fe=new S;var Be=new _;function Ue(e,t,i){t=g.clamp(t,-g.PI_OVER_TWO,g.PI_OVER_TWO);e=g.zeroToTwoPi(e)-g.PI_OVER_TWO;var n=S.fromAxisAngle(r.UNIT_Y,-t,ke);var a=S.fromAxisAngle(r.UNIT_Z,-e,Fe);var o=S.multiply(a,n,a);var s=_.fromQuaternion(o,Be);var l=r.clone(r.UNIT_X,Ne);_.multiplyByVector(s,l,l);r.negate(l,l);r.multiplyByScalar(l,i,l);return l}D.prototype.lookAtTransform=function(e,i){if(!o(e)){throw new l("transform is required")}if(this._mode===O.MORPHING){throw new l("lookAtTransform is not supported while morphing.")}this._setTransform(e);if(!o(i)){return}var n;if(o(i.heading)){n=Ue(i.heading,i.pitch,i.range)}else{n=i}if(this._mode===O.SCENE2D){t.clone(t.ZERO,this.position);r.negate(n,this.up);this.up.z=0;if(r.magnitudeSquared(this.up)<g.EPSILON10){r.clone(r.UNIT_Y,this.up)}r.normalize(this.up,this.up);this._setTransform(y.IDENTITY);r.negate(r.UNIT_Z,this.direction);r.cross(this.direction,this.up,this.right);r.normalize(this.right,this.right);var a=this.frustum;var s=a.top/a.right;a.right=r.magnitude(n)*.5;a.left=-a.right;a.top=s*a.right;a.bottom=-a.top;this._setTransform(e);return}r.clone(n,this.position);r.negate(this.position,this.direction);r.normalize(this.direction,this.direction);r.cross(this.direction,r.UNIT_Z,this.right);if(r.magnitudeSquared(this.right)<g.EPSILON10){r.clone(r.UNIT_X,this.right)}r.normalize(this.right,this.right);r.cross(this.right,this.direction,this.up);r.normalize(this.up,this.up);this._adjustOrthographicFrustum(true)};var Ve=new n;var ze=new n;var qe=new r;var Ge=new r;var He=new r;var je=new r;var We=new r;var Ye=new r;var Xe=new r;var Qe=new r;var Ze={direction:new r,right:new r,up:new r};var Ke;function Je(e,t,i,n){var a=Math.abs(r.dot(t,i));return a/n-r.dot(e,i)}function $e(e,t,i,n){var a=e._projection.ellipsoid;var s=n?e:Ze;var l=t.north;var u=t.south;var c=t.east;var f=t.west;if(f>c){c+=g.TWO_PI}var h=(f+c)*.5;var p;if(u<-g.PI_OVER_TWO+g.RADIANS_PER_DEGREE&&l>g.PI_OVER_TWO-g.RADIANS_PER_DEGREE){p=0}else{var m=Ve;m.longitude=h;m.latitude=l;m.height=0;var v=ze;v.longitude=h;v.latitude=u;v.height=0;var _=Ke;if(!o(_)||_.ellipsoid!==a){Ke=_=new d(undefined,undefined,a)}_.setEndPoints(m,v);p=_.interpolateUsingFraction(.5,Ve).latitude}var y=Ve;y.longitude=h;y.latitude=p;y.height=0;var w=a.cartographicToCartesian(y,Xe);var C=Ve;C.longitude=c;C.latitude=l;var S=a.cartographicToCartesian(C,qe);C.longitude=f;var T=a.cartographicToCartesian(C,He);C.longitude=h;var E=a.cartographicToCartesian(C,We);C.latitude=u;var x=a.cartographicToCartesian(C,Ye);C.longitude=c;var P=a.cartographicToCartesian(C,je);C.longitude=f;var A=a.cartographicToCartesian(C,Ge);r.subtract(T,w,T);r.subtract(P,w,P);r.subtract(S,w,S);r.subtract(A,w,A);r.subtract(E,w,E);r.subtract(x,w,x);var O=a.geodeticSurfaceNormal(w,s.direction);r.negate(O,O);var D=r.cross(O,r.UNIT_Z,s.right);r.normalize(D,D);var I=r.cross(D,O,s.up);var M;if(e.frustum instanceof b){var R=Math.max(r.distance(S,T),r.distance(P,A));var L=Math.max(r.distance(S,P),r.distance(T,A));var N;var k;var F=e.frustum._offCenterFrustum.right/e.frustum._offCenterFrustum.top;var B=L*F;if(R>B){N=R;k=N/F}else{k=L;N=B}M=Math.max(N,k)}else{var U=Math.tan(e.frustum.fovy*.5);var V=e.frustum.aspectRatio*U;M=Math.max(Je(O,I,T,U),Je(O,I,P,U),Je(O,I,S,U),Je(O,I,A,U),Je(O,I,E,U),Je(O,I,x,U),Je(O,D,T,V),Je(O,D,P,V),Je(O,D,S,V),Je(O,D,A,V),Je(O,D,E,V),Je(O,D,x,V));if(u<0&&l>0){var z=Ve;z.longitude=f;z.latitude=0;z.height=0;var q=a.cartographicToCartesian(z,Qe);r.subtract(q,w,q);M=Math.max(M,Je(O,I,q,U),Je(O,D,q,V));z.longitude=c;q=a.cartographicToCartesian(z,Qe);r.subtract(q,w,q);M=Math.max(M,Je(O,I,q,U),Je(O,D,q,V))}}return r.add(w,r.multiplyByScalar(O,-M,Qe),i)}var et=new n;var tt=new r;var rt=new r;function it(e,t,r){var i=e._projection;if(t.west>t.east){t=E.MAX_VALUE}var n=e._actualTransform;var a=e._actualInvTransform;var s=et;s.longitude=t.east;s.latitude=t.north;var l=i.project(s,tt);y.multiplyByPoint(n,l,l);y.multiplyByPoint(a,l,l);s.longitude=t.west;s.latitude=t.south;var u=i.project(s,rt);y.multiplyByPoint(n,u,u);y.multiplyByPoint(a,u,u);r.x=(l.x-u.x)*.5+u.x;r.y=(l.y-u.y)*.5+u.y;if(o(e.frustum.fovy)){var c=Math.tan(e.frustum.fovy*.5);var d=e.frustum.aspectRatio*c;r.z=Math.max((l.x-u.x)/d,(l.y-u.y)/c)*.5}else{var f=l.x-u.x;var h=l.y-u.y;r.z=Math.max(f,h)}return r}var nt=new n;var at=new r;var ot=new r;function st(e,t,r){var i=e._projection;if(t.west>t.east){t=E.MAX_VALUE}var n=nt;n.longitude=t.east;n.latitude=t.north;var a=i.project(n,at);n.longitude=t.west;n.latitude=t.south;var o=i.project(n,ot);var s=Math.abs(a.x-o.x)*.5;var l=Math.abs(a.y-o.y)*.5;var u,c;var d=e.frustum.right/e.frustum.top;var f=l*d;if(s>f){u=s;c=u/d}else{c=l;u=f}l=Math.max(2*u,2*c);r.x=(a.x-o.x)*.5+o.x;r.y=(a.y-o.y)*.5+o.y;n=i.unproject(r,n);n.height=l;r=i.project(n,r);return r}D.prototype.getRectangleCameraCoordinates=function(e,t){if(!o(e)){throw new l("rectangle is required")}var i=this._mode;if(!o(t)){t=new r}if(i===O.SCENE3D){return $e(this,e,t)}else if(i===O.COLUMBUS_VIEW){return it(this,e,t)}else if(i===O.SCENE2D){return st(this,e,t)}return undefined};var lt=new T;function ut(e,t,r,i){r=a(r,c.WGS84);var n=e.getPickRay(t,lt);var o=v.rayEllipsoid(n,r);if(!o){return undefined}var s=o.start>0?o.start:o.stop;return T.getPoint(n,s,i)}var ct=new T;function dt(e,t,r,i){var n=e.getPickRay(t,ct);var a=n.origin;a.z=0;var o=r.unproject(a);if(o.latitude<-g.PI_OVER_TWO||o.latitude>g.PI_OVER_TWO){return undefined}return r.ellipsoid.cartographicToCartesian(o,i)}var ft=new T;function ht(e,t,i,n){var a=e.getPickRay(t,ft);var o=-a.origin.x/a.direction.x;T.getPoint(a,o,n);var s=i.unproject(new r(n.y,n.z,0));if(s.latitude<-g.PI_OVER_TWO||s.latitude>g.PI_OVER_TWO||s.longitude<-Math.PI||s.longitude>Math.PI){return undefined}return i.ellipsoid.cartographicToCartesian(s,n)}D.prototype.pickEllipsoid=function(e,t,i){if(!o(e)){throw new l("windowPosition is required.")}var n=this._scene.canvas;if(n.clientWidth===0||n.clientHeight===0){return undefined}if(!o(i)){i=new r}t=a(t,c.WGS84);if(this._mode===O.SCENE3D){i=ut(this,e,t,i)}else if(this._mode===O.SCENE2D){i=dt(this,e,this._projection,i)}else if(this._mode===O.COLUMBUS_VIEW){i=ht(this,e,this._projection,i)}else{return undefined}return i};var pt=new r;var mt=new r;var vt=new r;function gt(e,t,i){var n=e._scene.canvas;var a=n.clientWidth;var o=n.clientHeight;var s=Math.tan(e.frustum.fovy*.5);var l=e.frustum.aspectRatio*s;var u=e.frustum.near;var c=2/a*t.x-1;var d=2/o*(o-t.y)-1;var f=e.positionWC;r.clone(f,i.origin);var h=r.multiplyByScalar(e.directionWC,u,pt);r.add(f,h,h);var p=r.multiplyByScalar(e.rightWC,c*u*l,mt);var m=r.multiplyByScalar(e.upWC,d*u*s,vt);var v=r.add(h,p,i.direction);r.add(v,m,v);r.subtract(v,f,v);r.normalize(v,v);return i}var _t=new r;function yt(e,t,i){var n=e._scene.canvas;var a=n.clientWidth;var s=n.clientHeight;var l=e.frustum;if(o(l._offCenterFrustum)){l=l._offCenterFrustum}var u=2/a*t.x-1;u*=(l.right-l.left)*.5;var c=2/s*(s-t.y)-1;c*=(l.top-l.bottom)*.5;var d=i.origin;r.clone(e.position,d);r.multiplyByScalar(e.right,u,_t);r.add(_t,d,d);r.multiplyByScalar(e.up,c,_t);r.add(_t,d,d);r.clone(e.directionWC,i.direction);if(e._mode===O.COLUMBUS_VIEW){r.fromElements(i.origin.z,i.origin.x,i.origin.y,i.origin)}return i}D.prototype.getPickRay=function(e,t){if(!o(e)){throw new l("windowPosition is required.")}if(!o(t)){t=new T}var r=this.frustum;if(o(r.aspectRatio)&&o(r.fov)&&o(r.near)){return gt(this,e,t)}return yt(this,e,t)};var bt=new r;var wt=new r;D.prototype.distanceToBoundingSphere=function(e){if(!o(e)){throw new l("boundingSphere is required.")}var t=r.subtract(this.positionWC,e.center,bt);var i=r.multiplyByScalar(this.directionWC,r.dot(t,this.directionWC),wt);return Math.max(0,r.magnitude(i)-e.radius)};var Ct=new t;D.prototype.getPixelSize=function(e,t,r){if(!o(e)){throw new l("boundingSphere is required.")}if(!o(t)){throw new l("drawingBufferWidth is required.")}if(!o(r)){throw new l("drawingBufferHeight is required.")}var i=this.distanceToBoundingSphere(e);var n=this.frustum.getPixelDimensions(t,r,i,Ct);return Math.max(n.x,n.y)};function St(e,t,i,n,a,o){var s=r.clone(t);if(i.y>n){s.y-=i.y-n}else if(i.y<-n){s.y+=-n-i.y}if(i.z>a){s.z-=i.z-a}else if(i.z<-a){s.z+=-a-i.z}function l(i){var n=r.lerp(t,s,i.time,new r);e.worldToCameraCoordinatesPoint(n,e.position)}return{easingFunction:u.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:o,update:l}}var Tt=new r;var Et=new r;var xt=new r;var Pt=new r;function At(e,t){var i=e.position;var n=e.direction;var a=e.worldToCameraCoordinatesVector(r.UNIT_X,Tt);var o=-r.dot(a,i)/r.dot(a,n);var s=r.add(i,r.multiplyByScalar(n,o,Et),Et);e.cameraToWorldCoordinatesPoint(s,s);i=e.cameraToWorldCoordinatesPoint(e.position,xt);var l=Math.tan(e.frustum.fovy*.5);var u=e.frustum.aspectRatio*l;var c=r.magnitude(r.subtract(i,s,Pt));var d=u*c;var f=l*c;var h=e._maxCoord.x;var p=e._maxCoord.y;var m=Math.max(d-h,h);var v=Math.max(f-p,p);if(i.z<-m||i.z>m||i.y<-v||i.y>v){var g=s.y<-m||s.y>m;var _=s.z<-v||s.z>v;if(g||_){return St(e,i,s,m,v,t)}}return undefined}D.prototype.createCorrectPositionTween=function(e){if(!o(e)){throw new l("duration is required.")}if(this._mode===O.COLUMBUS_VIEW){return At(this,e)}return undefined};var Ot=new r;var Dt={destination:undefined,heading:undefined,pitch:undefined,roll:undefined,duration:undefined,complete:undefined,cancel:undefined,endTransform:undefined,maximumHeight:undefined,easingFunction:undefined};D.prototype.cancelFlight=function(){if(o(this._currentFlight)){this._currentFlight.cancelTween();this._currentFlight=undefined}};D.prototype.flyTo=function(e){e=a(e,a.EMPTY_OBJECT);var t=e.destination;if(!o(t)){throw new l("destination is required.")}var r=this._mode;if(r===O.MORPHING){return}this.cancelFlight();var i=a(e.orientation,a.EMPTY_OBJECT);if(o(i.direction)){i=ve(this,t,i,ge.orientation)}if(o(e.duration)&&e.duration<=0){var n=ge;n.destination=e.destination;n.orientation.heading=i.heading;n.orientation.pitch=i.pitch;n.orientation.roll=i.roll;n.convert=e.convert;n.endTransform=e.endTransform;this.setView(n);if(typeof e.complete==="function"){e.complete()}return}var s=o(t.west);if(s){t=this.getRectangleCameraCoordinates(t,Ot)}var u=this;var c;Dt.destination=t;Dt.heading=i.heading;Dt.pitch=i.pitch;Dt.roll=i.roll;Dt.duration=e.duration;Dt.complete=function(){if(c===u._currentFlight){u._currentFlight=undefined}if(o(e.complete)){e.complete()}};Dt.cancel=e.cancel;Dt.endTransform=e.endTransform;Dt.convert=s?false:e.convert;Dt.maximumHeight=e.maximumHeight;Dt.pitchAdjustHeight=e.pitchAdjustHeight;Dt.flyOverLongitude=e.flyOverLongitude;Dt.flyOverLongitudeWeight=e.flyOverLongitudeWeight;Dt.easingFunction=e.easingFunction;var d=this._scene;c=d.tweens.add(P.createTween(d,Dt));this._currentFlight=c};function It(e,t){var r=e.frustum;var i=Math.tan(r.fovy*.5);var n=r.aspectRatio*i;return Math.max(t/n,t/i)}function Mt(e,t){var r=e.frustum;if(o(r._offCenterFrustum)){r=r._offCenterFrustum}var i,n;var a=r.right/r.top;var s=t*a;if(t>s){i=t;n=i/a}else{n=t;i=s}return Math.max(i,n)*1.5}var Rt=100;function Lt(e,t,r){if(!o(r)){r=h.clone(D.DEFAULT_OFFSET)}var i=e._scene.screenSpaceCameraController.minimumZoomDistance;var n=e._scene.screenSpaceCameraController.maximumZoomDistance;var a=r.range;if(!o(a)||a===0){var s=t.radius;if(s===0){r.range=Rt}else if(e.frustum instanceof b||e._mode===O.SCENE2D){r.range=Mt(e,s)}else{r.range=It(e,s)}r.range=g.clamp(r.range,i,n)}return r}D.prototype.viewBoundingSphere=function(e,t){if(!o(e)){throw new l("boundingSphere is required.")}if(this._mode===O.MORPHING){throw new l("viewBoundingSphere is not supported while morphing.")}t=Lt(this,e,t);this.lookAt(e.center,t)};var Nt=new y;var kt=new r;var Ft=new r;var Bt=new r;var Ut=new r;var Vt=new i;var zt=new S;var qt=new _;D.prototype.flyToBoundingSphere=function(e,t){if(!o(e)){throw new l("boundingSphere is required.")}t=a(t,a.EMPTY_OBJECT);var i=this._mode===O.SCENE2D||this._mode===O.COLUMBUS_VIEW;this._setTransform(y.IDENTITY);var n=Lt(this,e,t.offset);var s;if(i){s=r.multiplyByScalar(r.UNIT_Z,n.range,kt)}else{s=Ue(n.heading,n.pitch,n.range)}var u=x.eastNorthUpToFixedFrame(e.center,c.WGS84,Nt);y.multiplyByPoint(u,s,s);var d;var f;if(!i){d=r.subtract(e.center,s,Ft);r.normalize(d,d);f=y.multiplyByPointAsVector(u,r.UNIT_Z,Bt);if(1-Math.abs(r.dot(d,f))<g.EPSILON6){var h=S.fromAxisAngle(d,n.heading,zt);var p=_.fromQuaternion(h,qt);r.fromCartesian4(y.getColumn(u,1,Vt),f);_.multiplyByVector(p,f,f)}var m=r.cross(d,f,Ut);r.cross(m,d,f);r.normalize(f,f)}this.flyTo({destination:s,orientation:{direction:d,up:f},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction,flyOverLongitude:t.flyOverLongitude,flyOverLongitudeWeight:t.flyOverLongitudeWeight,pitchAdjustHeight:t.pitchAdjustHeight})};var Gt=new r;var Ht=new r;var jt=new r;var Wt=new r;var Yt=[new r,new r,new r,new r];function Xt(e,t){var i=t.radii;var n=e.positionWC;var a=r.multiplyComponents(t.oneOverRadii,n,Gt);var o=r.magnitude(a);var s=r.normalize(a,Ht);var l;var u;if(r.equalsEpsilon(s,r.UNIT_Z,g.EPSILON10)){l=new r(0,1,0);u=new r(0,0,1)}else{l=r.normalize(r.cross(r.UNIT_Z,s,jt),jt);u=r.normalize(r.cross(s,l,Wt),Wt)}var c=Math.sqrt(r.magnitudeSquared(a)-1);var d=r.multiplyByScalar(s,1/o,Gt);var f=c/o;var h=r.multiplyByScalar(l,f,Ht);var p=r.multiplyByScalar(u,f,jt);var m=r.add(d,p,Yt[0]);r.subtract(m,h,m);r.multiplyComponents(i,m,m);var v=r.subtract(d,p,Yt[1]);r.subtract(v,h,v);r.multiplyComponents(i,v,v);var _=r.subtract(d,p,Yt[2]);r.add(_,h,_);r.multiplyComponents(i,_,_);var y=r.add(d,p,Yt[3]);r.add(y,h,y);r.multiplyComponents(i,y,y);return Yt}var Qt=new t;var Zt=new r;var Kt=[new n,new n,new n,new n];function Jt(e,t,r,i,n,a){Qt.x=e;Qt.y=t;var s=i.pickEllipsoid(Qt,n,Zt);if(o(s)){Kt[r]=n.cartesianToCartographic(s,Kt[r]);return 1}Kt[r]=n.cartesianToCartographic(a[r],Kt[r]);return 0}D.prototype.computeViewRectangle=function(t,i){t=a(t,c.WGS84);var n=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC);var o=new e(r.ZERO,t.maximumRadius);var s=n.computeVisibility(o);if(s===m.OUTSIDE){return undefined}var l=this._scene.canvas;var u=l.clientWidth;var d=l.clientHeight;var f=0;var h=Xt(this,t);f+=Jt(0,0,0,this,t,h);f+=Jt(0,d,1,this,t,h);f+=Jt(u,d,2,this,t,h);f+=Jt(u,0,3,this,t,h);if(f<2){return E.MAX_VALUE}i=E.fromCartographicArray(Kt,i);var p=0;var v=Kt[3].longitude;for(var _=0;_<4;++_){var y=Kt[_].longitude;var b=Math.abs(y-v);if(b>g.PI){p+=g.TWO_PI-b}else{p+=b}v=y}if(g.equalsEpsilon(Math.abs(p),g.TWO_PI,g.EPSILON9)){i.west=-g.PI;i.east=g.PI;if(Kt[0].latitude>=0){i.north=g.PI_OVER_TWO}else{i.south=-g.PI_OVER_TWO}}return i};D.prototype.switchToPerspectiveFrustum=function(){if(this._mode===O.SCENE2D||this.frustum instanceof C){return}var e=this._scene;this.frustum=new C;this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight;this.frustum.fov=g.toRadians(60)};D.prototype.switchToOrthographicFrustum=function(){if(this._mode===O.SCENE2D||this.frustum instanceof b){return}var e=this._scene;this.frustum=new b;this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight;this.frustum.width=r.magnitude(this.position);var t=this.frustum.projectionMatrix;if(o(t)){this._adjustOrthographicFrustum(true)}};D.clone=function(e,t){if(!o(t)){t=new D(e._scene)}r.clone(e.position,t.position);r.clone(e.direction,t.direction);r.clone(e.up,t.up);r.clone(e.right,t.right);y.clone(e._transform,t.transform);t._transformChanged=true;return t};return D});define("Scene/CameraEventType",["../Core/freezeObject"],function(e){"use strict";var t={LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4};return e(t)});define("Scene/CameraEventAggregator",["../Core/Cartesian2","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/KeyboardEventModifier","../Core/Math","../Core/ScreenSpaceEventHandler","../Core/ScreenSpaceEventType","./CameraEventType"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e,r){var i=e;if(t(r)){i+="+"+r}return i}function d(t,r){e.clone(t.distance.startPosition,r.distance.startPosition);e.clone(t.distance.endPosition,r.distance.endPosition);e.clone(t.angleAndHeight.startPosition,r.angleAndHeight.startPosition);e.clone(t.angleAndHeight.endPosition,r.angleAndHeight.endPosition)}function f(r,i,n){var a=c(u.PINCH,i);var o=r._update;var s=r._isDown;var f=r._eventStartPosition;var h=r._pressTime;var p=r._releaseTime;o[a]=true;s[a]=false;f[a]=new e;var m=r._movement[a];if(!t(m)){m=r._movement[a]={}}m.distance={startPosition:new e,endPosition:new e};m.angleAndHeight={startPosition:new e,endPosition:new e};m.prevAngle=0;r._eventHandler.setInputAction(function(t){r._buttonsDown++;s[a]=true;h[a]=new Date;e.lerp(t.position1,t.position2,.5,f[a])},l.PINCH_START,i);r._eventHandler.setInputAction(function(){r._buttonsDown=Math.max(r._buttonsDown-1,0);s[a]=false;p[a]=new Date},l.PINCH_END,i);r._eventHandler.setInputAction(function(t){if(s[a]){if(!o[a]){e.clone(t.distance.endPosition,m.distance.endPosition);e.clone(t.angleAndHeight.endPosition,m.angleAndHeight.endPosition)}else{d(t,m);o[a]=false;m.prevAngle=m.angleAndHeight.startPosition.x}var r=m.angleAndHeight.endPosition.x;var i=m.prevAngle;var l=Math.PI*2;while(r>=i+Math.PI){r-=l}while(r<i-Math.PI){r+=l}m.angleAndHeight.endPosition.x=-r*n.clientWidth/12;m.angleAndHeight.startPosition.x=-i*n.clientWidth/12}},l.PINCH_MOVE,i)}function h(r,i){var n=c(u.WHEEL,i);var a=r._update;a[n]=true;var s=r._movement[n];if(!t(s)){s=r._movement[n]={}}s.startPosition=new e;s.endPosition=new e;r._eventHandler.setInputAction(function(t){var r=15*o.toRadians(t);if(!a[n]){s.endPosition.y=s.endPosition.y+r}else{e.clone(e.ZERO,s.startPosition);s.endPosition.x=0;s.endPosition.y=r;a[n]=false}},l.WHEEL,i)}function p(r,i,n){var a=c(n,i);var o=r._isDown;var s=r._eventStartPosition;var d=r._pressTime;var f=r._releaseTime;o[a]=false;s[a]=new e;var h=r._lastMovement[a];if(!t(h)){h=r._lastMovement[a]={startPosition:new e,endPosition:new e,valid:false}}var p;var m;if(n===u.LEFT_DRAG){p=l.LEFT_DOWN;m=l.LEFT_UP}else if(n===u.RIGHT_DRAG){p=l.RIGHT_DOWN;m=l.RIGHT_UP}else if(n===u.MIDDLE_DRAG){p=l.MIDDLE_DOWN;m=l.MIDDLE_UP}r._eventHandler.setInputAction(function(t){r._buttonsDown++;h.valid=false;o[a]=true;d[a]=new Date;e.clone(t.position,s[a])},p,i);r._eventHandler.setInputAction(function(){r._buttonsDown=Math.max(r._buttonsDown-1,0);o[a]=false;f[a]=new Date},m,i)}function m(t,r){e.clone(t.startPosition,r.startPosition);e.clone(t.endPosition,r.endPosition)}function v(r,i){var n=r._update;var a=r._movement;var o=r._lastMovement;var s=r._isDown;for(var d in u){if(u.hasOwnProperty(d)){var f=u[d];if(t(f)){var h=c(f,i);n[h]=true;if(!t(r._lastMovement[h])){r._lastMovement[h]={startPosition:new e,endPosition:new e,valid:false}}if(!t(r._movement[h])){r._movement[h]={startPosition:new e,endPosition:new e}}}}}r._eventHandler.setInputAction(function(l){for(var d in u){if(u.hasOwnProperty(d)){var f=u[d];if(t(f)){var h=c(f,i);if(s[h]){if(!n[h]){e.clone(l.endPosition,a[h].endPosition)}else{m(a[h],o[h]);o[h].valid=true;m(l,a[h]);n[h]=false}}}}}e.clone(l.endPosition,r._currentMousePosition)},l.MOUSE_MOVE,i)}function g(r){if(!t(r)){throw new n("canvas is required.")}this._eventHandler=new s(r,true);this._update={};this._movement={};this._lastMovement={};this._isDown={};this._eventStartPosition={};this._pressTime={};this._releaseTime={};this._buttonsDown=0;this._currentMousePosition=new e;h(this,undefined);f(this,undefined,r);p(this,undefined,u.LEFT_DRAG);p(this,undefined,u.RIGHT_DRAG);p(this,undefined,u.MIDDLE_DRAG);v(this,undefined);for(var i in a){if(a.hasOwnProperty(i)){var o=a[i];if(t(o)){h(this,o);f(this,o,r);p(this,o,u.LEFT_DRAG);p(this,o,u.RIGHT_DRAG);p(this,o,u.MIDDLE_DRAG);v(this,o)}}}}r(g.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){var e=!this._update[c(u.WHEEL)]||!this._update[c(u.WHEEL,a.SHIFT)]||!this._update[c(u.WHEEL,a.CTRL)]||!this._update[c(u.WHEEL,a.ALT)];return this._buttonsDown>0||e}}});g.prototype.isMoving=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);return!this._update[i]};g.prototype.getMovement=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);var a=this._movement[i];return a};g.prototype.getLastMovement=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);var a=this._lastMovement[i];if(a.valid){return a}return undefined};g.prototype.isButtonDown=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);return this._isDown[i]};g.prototype.getStartMousePosition=function(e,r){if(!t(e)){throw new n("type is required.")}if(e===u.WHEEL){return this._currentMousePosition}var i=c(e,r);return this._eventStartPosition[i]};g.prototype.getButtonPressTime=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);return this._pressTime[i]};g.prototype.getButtonReleaseTime=function(e,r){if(!t(e)){throw new n("type is required.")}var i=c(e,r);return this._releaseTime[i]};g.prototype.reset=function(){for(var e in this._update){if(this._update.hasOwnProperty(e)){this._update[e]=true}}};g.prototype.isDestroyed=function(){return false};g.prototype.destroy=function(){this._eventHandler=this._eventHandler&&this._eventHandler.destroy();return i(this)};return g});define("Scene/Cesium3DTileChildrenVisibility",["../Core/freezeObject"],function(e){"use strict";var t={NONE:0,VISIBLE:1,IN_REQUEST_VOLUME:2,VISIBLE_IN_REQUEST_VOLUME:4,VISIBLE_NOT_IN_REQUEST_VOLUME:8};return e(t)});define("Scene/Composite3DTileContent",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/FeatureDetection","../Core/getMagic","../Core/RuntimeError","../ThirdParty/when"],function(e,t,r,i,n,a,o,s){"use strict";if(!n.supportsTypedArrays()){return{}}function l(e,t,r,i,n,a){this._tileset=e;this._tile=t;this._url=r;this._contents=[];this._readyPromise=s.defer();c(this,i,n,a)}r(l.prototype,{featurePropertiesDirty:{get:function(){var e=this._contents;var t=e.length;for(var r=0;r<t;++r){if(e[r].featurePropertiesDirty){return true}}return false},set:function(e){var t=this._contents;var r=t.length;for(var i=0;i<r;++i){t[i].featurePropertiesDirty=e}}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._url}},batchTable:{get:function(){return undefined}}});var u=Uint32Array.BYTES_PER_ELEMENT;function c(r,i,n,l){n=e(n,0);var c=new Uint8Array(i);var d=new DataView(i);n+=u;var f=d.getUint32(n,true);if(f!==1){throw new o("Only Composite Tile version 1 is supported. Version "+f+" is not.")}n+=u;n+=u;var h=d.getUint32(n,true);n+=u;var p=[];for(var m=0;m<h;++m){var v=a(c,n);var g=d.getUint32(n+u*2,true);var _=l[v];if(t(_)){var y=_(r._tileset,r._tile,r._url,i,n);r._contents.push(y);p.push(y.readyPromise)}else{throw new o("Unknown tile content type, "+v+", inside Composite tile")}n+=g}s.all(p).then(function(){r._readyPromise.resolve(r)}).otherwise(function(e){r._readyPromise.reject(e)})}l.prototype.hasProperty=function(e,t){return false};l.prototype.getFeature=function(e){return undefined};l.prototype.applyDebugSettings=function(e,t){var r=this._contents;var i=r.length;for(var n=0;n<i;++n){r[n].applyDebugSettings(e,t)}};l.prototype.applyStyle=function(e,t){var r=this._contents;var i=r.length;for(var n=0;n<i;++n){r[n].applyStyle(e,t)}};l.prototype.update=function(e,t){var r=this._contents;var i=r.length;for(var n=0;n<i;++n){r[n].update(e,t)}};l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){var e=this._contents;var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}return i(this)};return l});define("Scene/ModelInstance",["../Core/defineProperties","../Core/Matrix4"],function(e,t){"use strict";function r(e,r,i){this.primitive=e;this._modelMatrix=t.clone(r);this._instanceId=i}e(r.prototype,{instanceId:{get:function(){return this._instanceId}},model:{get:function(){return this.primitive._model}},modelMatrix:{get:function(){return t.clone(this._modelMatrix)},set:function(e){t.clone(e,this._modelMatrix);this.primitive.expandBoundingSphere(this._modelMatrix);this.primitive._dirty=true}}});return r});define("Scene/ModelInstanceCollection",["../Core/BoundingSphere","../Core/Cartesian3","../Core/clone","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/PrimitiveType","../Core/RuntimeError","../Core/Transforms","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/ShaderSource","../ThirdParty/when","./getAttributeOrUniformBySemantic","./Model","./ModelInstance","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T){"use strict";var E={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};function x(e){e=a(e,a.EMPTY_OBJECT);if(!o(e.gltf)&&!o(e.url)){throw new u("Either options.gltf or options.url is required.")}if(o(e.gltf)&&o(e.url)){throw new u("Cannot pass in both options.gltf and options.url.")}this.show=a(e.show,true);this._instancingSupported=false;this._dynamic=a(e.dynamic,false);this._allowPicking=a(e.allowPicking,true);this._ready=false;this._readyPromise=y.defer();this._state=E.NEEDS_LOAD;this._dirty=false;this._cull=a(e.cull,true);this._opaquePass=a(e.opaquePass,g.OPAQUE);this._instances=P(this,e.instances);this._batchTable=e.batchTable;this._model=undefined;this._vertexBufferTypedArray=undefined;this._vertexBuffer=undefined;this._batchIdBuffer=undefined;this._instancedUniformsByProgram=undefined;this._drawCommands=[];this._pickCommands=[];this._modelCommands=undefined;this._boundingSphere=A(this);this._center=t.clone(this._boundingSphere.center);this._rtcTransform=new c;this._rtcModelView=new c;this._mode=undefined;this.modelMatrix=c.clone(c.IDENTITY);this._modelMatrix=c.clone(this.modelMatrix);this._url=e.url;this._headers=e.headers;this._requestType=e.requestType;this._gltf=e.gltf;this._basePath=e.basePath;this._asynchronous=e.asynchronous;this._incrementallyLoadTextures=e.incrementallyLoadTextures;this._upAxis=e.upAxis;this.shadows=a(e.shadows,T.ENABLED);this._shadows=this.shadows;this.debugShowBoundingVolume=a(e.debugShowBoundingVolume,false);this._debugShowBoundingVolume=false;this.debugWireframe=a(e.debugWireframe,false);this._debugWireframe=false}s(x.prototype,{allowPicking:{get:function(){return this._allowPicking}},length:{get:function(){return this._instances.length}},activeAnimations:{get:function(){return this._model.activeAnimations}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});function P(e,t){t=a(t,[]);var r=t.length;var i=new Array(r);for(var n=0;n<r;++n){var o=t[n];var s=o.modelMatrix;var l=a(o.batchId,n);i[n]=new C(e,s,l)}return i}function A(r){var i=r.length;var n=new Array(i);for(var a=0;a<i;++a){n[a]=c.getTranslation(r._instances[a]._modelMatrix,new t)}return e.fromPoints(n)}var O=new t;var D=new c;x.prototype.expandBoundingSphere=function(t){var r=c.getTranslation(t,O);e.expand(this._boundingSphere,r,this._boundingSphere)};function I(e,t){if(o(e._instancedUniformsByProgram)){return e._instancedUniformsByProgram[t]}var r={};e._instancedUniformsByProgram=r;var i=["MODEL","MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELINVERSE","MODELVIEWINVERSE","MODELVIEWPROJECTIONINVERSE","MODELINVERSETRANSPOSE","MODELVIEWINVERSETRANSPOSE"];var n=["MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELVIEWINVERSETRANSPOSE"];var a=e._model.gltf;var s=a.techniques;for(var l in s){if(s.hasOwnProperty(l)){var u=s[l];var c=u.parameters;var d=u.uniforms;var h=u.program;if(!o(r[h])){var p={};r[h]=p;for(var m in d){if(d.hasOwnProperty(m)){var v=d[m];var g=c[v];var _=g.semantic;if(o(_)&&i.indexOf(_)>-1){if(n.indexOf(_)>-1){p[m]=_}else{throw new f("Shader program cannot be optimized for instancing. "+'Parameter "'+g+'" in program "'+t+'" uses unsupported semantic "'+_+'"')}}}}}}}return r[t]}var M;function R(e){return function(t,r){var i=I(e,r);var n=o(e._batchTable);var a=_.replaceMain(t,"czm_instancing_main");var s="";var l="";for(var u in i){if(i.hasOwnProperty(u)){var c=i[u];var d;if(c==="MODELVIEW"||c==="CESIUM_RTC_MODELVIEW"){d="czm_instanced_modelView"}else if(c==="MODELVIEWPROJECTION"){d="czm_instanced_modelViewProjection";s+="mat4 czm_instanced_modelViewProjection;\n";l+="czm_instanced_modelViewProjection = czm_projection * czm_instanced_modelView;\n"}else if(c==="MODELVIEWINVERSETRANSPOSE"){d="czm_instanced_modelViewInverseTranspose";s+="mat3 czm_instanced_modelViewInverseTranspose;\n";l+="czm_instanced_modelViewInverseTranspose = mat3(czm_instanced_modelView);\n"}var f=new RegExp("uniform.*"+u+".*");a=a.replace(f,"");f=new RegExp(u+"\\b","g");a=a.replace(f,d)}}var h="uniform mat4 czm_instanced_modifiedModelView;\n"+"uniform mat4 czm_instanced_nodeTransform;\n";var p=n?"attribute float a_batchId;\n":"";var m=h+s+"mat4 czm_instanced_modelView;\n"+"attribute vec4 czm_modelMatrixRow0;\n"+"attribute vec4 czm_modelMatrixRow1;\n"+"attribute vec4 czm_modelMatrixRow2;\n"+p+a+"void main()\n"+"{\n"+"    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0, czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0);\n"+"    czm_instanced_modelView = czm_instanced_modifiedModelView * czm_instanced_model * czm_instanced_nodeTransform;\n"+l+"    czm_instancing_main();\n"+"}";M=m;if(n){m=e._batchTable.getVertexShaderCallback(true,"a_batchId")(m)}return m}}function L(e){return function(t){var r=e._batchTable;if(o(r)){var i=e._model.gltf;var n=b(i,"_3DTILESDIFFUSE");t=r.getFragmentShaderCallback(true,n)(t)}return t}}function N(e){return function(t){t=M;var r=o(e._batchTable);var i=e._allowPicking;if(r){t=e._batchTable.getPickVertexShaderCallback("a_batchId")(t)}else if(i){t=_.createPickVertexShaderSource(t)}return t}}function k(e){return function(t){var r=o(e._batchTable);var i=e._allowPicking;if(r){t=e._batchTable.getPickFragmentShaderCallback()(t)}else if(i){t=_.createPickFragmentShaderSource(t,"varying")}return t}}function F(e,t){return function(){return c.multiply(t.uniformState.view,e._rtcTransform,e._rtcModelView)}}function B(e){return function(){return e.computedMatrix}}function U(e,t){return function(i,n,a){i=r(i);i.czm_instanced_modifiedModelView=F(e,t);i.czm_instanced_nodeTransform=B(a);var s=I(e,n);for(var l in s){if(s.hasOwnProperty(l)){delete i[l]}}if(o(e._batchTable)){i=e._batchTable.getUniformMapCallback()(i)}return i}}function V(e){return function(t){if(o(e._batchTable)){t=e._batchTable.getPickUniformMapCallback()(t)}return t}}function z(e){return function(t){if(o(e._batchTable)){t=e._batchTable.getVertexShaderCallback(true,"a_batchId")(t);t="uniform float a_batchId\n;"+t}return t}}function q(e){return function(t){if(o(e._batchTable)){t=e._batchTable.getPickVertexShaderCallback("a_batchId")(t);t="uniform float a_batchId\n;"+t}return t}}function G(e){return function(t){var r=o(e._batchTable);var i=e._allowPicking;if(r){t=e._batchTable.getPickFragmentShaderCallback()(t)}else if(i){t=_.createPickFragmentShaderSource(t,"uniform")}return t}}function H(e){return function(t){if(o(e._batchTable)){t=e._batchTable.getUniformMapCallback()(t)}return t}}function j(e){var t=e._instances;var r=e.length;var i=e._center;var n=12;var a=e._vertexBufferTypedArray;if(!o(a)){a=new Float32Array(r*n)}if(e._dynamic){e._vertexBufferTypedArray=a}for(var s=0;s<r;++s){var l=t[s]._modelMatrix;var u=c.clone(l,D);u[12]-=i.x;u[13]-=i.y;u[14]-=i.z;var d=s*n;a[d+0]=u[0];a[d+1]=u[4];a[d+2]=u[8];a[d+3]=u[12];a[d+4]=u[1];a[d+5]=u[5];a[d+6]=u[9];a[d+7]=u[13];a[d+8]=u[2];a[d+9]=u[6];a[d+10]=u[10];a[d+11]=u[14]}return a}function W(e,t){var r;var n=e._instances;var a=e.length;var s=e._dynamic;var l=o(e._batchTable);var u=e._allowPicking;if(l){var c=new Uint16Array(a);for(r=0;r<a;++r){c[r]=n[r]._instanceId}e._batchIdBuffer=p.createVertexBuffer({context:t,typedArray:c,usage:m.STATIC_DRAW})}if(u&&!l){var d=new Uint8Array(a*4);for(r=0;r<a;++r){var f=e._pickIds[r];var h=f.color;var v=r*4;d[v]=i.floatToByte(h.red);d[v+1]=i.floatToByte(h.green);d[v+2]=i.floatToByte(h.blue);d[v+3]=i.floatToByte(h.alpha)}e._pickIdBuffer=p.createVertexBuffer({context:t,typedArray:d,usage:m.STATIC_DRAW})}var g=j(e);e._vertexBuffer=p.createVertexBuffer({context:t,typedArray:g,usage:s?m.STREAM_DRAW:m.STATIC_DRAW})}function Y(e){var t=j(e);e._vertexBuffer.copyFromArrayView(t)}function X(e,t){var r=e._instances;var i=r.length;var n=new Array(i);for(var a=0;a<i;++a){n[a]=t.createPickId(r[a])}return n}function Q(e,t){var r=e._instancingSupported;var i=o(e._batchTable);var a=e._allowPicking;var s={url:e._url,headers:e._headers,requestType:e._requestType,gltf:e._gltf,basePath:e._basePath,shadows:e._shadows,cacheKey:undefined,asynchronous:e._asynchronous,allowPicking:a,incrementallyLoadTextures:e._incrementallyLoadTextures,upAxis:e._upAxis,precreatedAttributes:undefined,vertexShaderLoaded:undefined,fragmentShaderLoaded:undefined,uniformMapLoaded:undefined,pickVertexShaderLoaded:undefined,pickFragmentShaderLoaded:undefined,pickUniformMapLoaded:undefined,ignoreCommands:true,opaquePass:e._opaquePass};if(a&&!i){e._pickIds=X(e,t)}if(r){W(e,t);var l=12;var u=n.getSizeInBytes(n.FLOAT);var c={czm_modelMatrixRow0:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:n.FLOAT,normalize:false,offsetInBytes:0,strideInBytes:u*l,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:n.FLOAT,normalize:false,offsetInBytes:u*4,strideInBytes:u*l,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:n.FLOAT,normalize:false,offsetInBytes:u*8,strideInBytes:u*l,instanceDivisor:1}};if(i){c.a_batchId={index:0,vertexBuffer:e._batchIdBuffer,componentsPerAttribute:1,componentDatatype:n.UNSIGNED_SHORT,normalize:false,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}}if(a&&!i){c.pickColor={index:0,vertexBuffer:e._pickIdBuffer,componentsPerAttribute:4,componentDatatype:n.UNSIGNED_BYTE,normalize:true,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}}s.precreatedAttributes=c;s.vertexShaderLoaded=R(e);s.fragmentShaderLoaded=L(e);s.uniformMapLoaded=U(e,t);s.pickVertexShaderLoaded=N(e);s.pickFragmentShaderLoaded=k(e);s.pickUniformMapLoaded=V(e);if(o(e._url)){s.cacheKey=e._url+"#instanced"}}else{s.vertexShaderLoaded=z(e);s.fragmentShaderLoaded=L(e);s.uniformMapLoaded=H(e,t);s.pickVertexShaderLoaded=q(e);s.pickFragmentShaderLoaded=G(e);s.pickUniformMapLoaded=V(e)}if(o(e._url)){e._model=w.fromGltf(s)}else{e._model=new w(s)}}function Z(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;var t=e.debugWireframe?d.LINES:d.TRIANGLES;var r=e._drawCommands;var i=r.length;for(var n=0;n<i;++n){r[n].primitiveType=t}}}function K(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;var t=e._drawCommands;var r=t.length;for(var i=0;i<r;++i){t[i].debugShowBoundingVolume=e.debugShowBoundingVolume}}}function J(e,t,r){var i=t.length;var n=e.length;var a=e.allowPicking;var o=e._boundingSphere;var s=e._cull;for(var l=0;l<i;++l){var u=v.shallowClone(t[l]);u.instanceCount=n;u.boundingVolume=o;u.cull=s;e._drawCommands.push(u);if(a){var c=v.shallowClone(r[l]);c.instanceCount=n;c.boundingVolume=o;c.cull=s;e._pickCommands.push(c)}}}function $(e){return function(){return e}}function ee(e){return function(){return e}}function te(t,i,n){var a=t._instances;var s=i.length;var l=t.length;var u=t.allowPicking;var d=o(t._batchTable);var f=t._cull;for(var h=0;h<s;++h){for(var p=0;p<l;++p){var m=v.shallowClone(i[h]);m.modelMatrix=new c;m.boundingVolume=new e;m.cull=f;m.uniformMap=r(m.uniformMap);if(d){m.uniformMap.a_batchId=$(a[p]._instanceId)}t._drawCommands.push(m);if(u){var g=v.shallowClone(n[h]);g.modelMatrix=new c;g.boundingVolume=new e;g.cull=f;g.uniformMap=r(g.uniformMap);if(d){g.uniformMap.a_batchId=$(a[p]._instanceId)}else if(u){var _=t._pickIds[p];g.uniformMap.czm_pickColor=ee(_.color)}t._pickCommands.push(g)}}}}function re(t){var r=t._modelCommands;var i=r.length;var n=t.length;var a=t.allowPicking;var o=t._rtcTransform;var s=t._center;for(var l=0;l<i;++l){var u=r[l];for(var d=0;d<n;++d){var f=l*n+d;var h=t._drawCommands[f];var p=c.clone(t._instances[d]._modelMatrix,D);p[12]-=s.x;p[13]-=s.y;p[14]-=s.z;p=c.multiply(o,p,D);var m=u.modelMatrix;var v=h.modelMatrix;c.multiply(p,m,v);var g=u.boundingVolume;var _=h.boundingVolume;e.transform(g,p,_);if(a){var y=t._pickCommands[f];c.clone(v,y.modelMatrix);e.clone(_,y.boundingVolume)}}}}function ie(e){var t=e._nodeCommands;var r=t.length;var i=[];var n=[];for(var a=0;a<r;++a){var o=t[a];if(o.show){i.push(o.command);n.push(o.pickCommand)}}return{draw:i,pick:n}}function ne(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;var t=T.castShadows(e.shadows);var r=T.receiveShadows(e.shadows);var i=e._drawCommands;var n=i.length;for(var a=0;a<n;++a){var o=i[a];o.castShadows=t;o.receiveShadows=r}}}x.prototype.update=function(e){if(e.mode===S.MORPHING){return}if(!this.show){return}if(this.length===0){return}var r=e.context;if(this._state===E.NEEDS_LOAD){this._state=E.LOADING;this._instancingSupported=r.instancedArrays;Q(this,r);var i=this;this._model.readyPromise.otherwise(function(e){i._state=E.FAILED;i._readyPromise.reject(e)})}var n=this._instancingSupported;var a=this._model;a.update(e);if(a.ready&&this._state===E.LOADING){this._state=E.LOADED;this._ready=true;var o=a.boundingSphere.radius+t.magnitude(a.boundingSphere.center);this._boundingSphere.radius+=o;var s=ie(a);this._modelCommands=s.draw;if(n){J(this,s.draw,s.pick)}else{te(this,s.draw,s.pick);re(this)}this._readyPromise.resolve(this);return}if(this._state!==E.LOADED){return}var l=e.mode!==this._mode;var u=this.modelMatrix;var d=!c.equals(this._modelMatrix,u);if(l||d){this._mode=e.mode;c.clone(u,this._modelMatrix);var f=c.multiplyByTranslation(this._modelMatrix,this._center,this._rtcTransform);if(this._mode!==S.SCENE3D){f=h.basisTo2D(e.mapProjection,f,f)}c.getTranslation(f,this._boundingSphere.center)}if(n&&this._dirty){this._dynamic=true;this._dirty=false;Y(this)}if(!n&&(a.dirty||this._dirty||l||d)){re(this)}ne(this);Z(this);K(this);var p=e.passes;var m=e.commandList;var v=p.render?this._drawCommands:this._pickCommands;var g=v.length;for(var _=0;_<g;++_){m.push(v[_])}};x.prototype.isDestroyed=function(){return false};x.prototype.destroy=function(){this._model=this._model&&this._model.destroy();var e=this._pickIds;if(o(e)){var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}}return l(this)};return x});define("Scene/Instanced3DModel3DTileContent",["../Core/AttributeCompression","../Core/Cartesian3","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/getAbsoluteUri","../Core/getBaseUri","../Core/getStringFromTypedArray","../Core/joinUrls","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/RequestType","../Core/RuntimeError","../Core/Transforms","../Core/TranslationRotationScale","../Renderer/Pass","./Cesium3DTileBatchTable","./Cesium3DTileFeature","./Cesium3DTileFeatureTable","./ModelInstanceCollection"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P){"use strict";if(!d.supportsTypedArrays()){return{}}function A(e,t,r,i,n){this._tileset=e;this._tile=t;this._url=r;this._modelInstanceCollection=undefined;this._batchTable=undefined;this._features=undefined;this.featurePropertiesDirty=false;M(this,i,n)}A._deprecationWarning=s;o(A.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){var e=this._modelInstanceCollection._model;if(a(e)){return e.trianglesLength}return 0}},geometryByteLength:{get:function(){var e=this._modelInstanceCollection._model;if(a(e)){return e.geometryByteLength}return 0}},texturesByteLength:{get:function(){var e=this._modelInstanceCollection._model;if(a(e)){return e.texturesByteLength}return 0}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){return undefined}},readyPromise:{get:function(){return this._modelInstanceCollection.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._url}},batchTable:{get:function(){return this._batchTable}}});var O=Uint32Array.BYTES_PER_ELEMENT;var D=new Array(4);var I=new Array(4);function M(r,o,s){var l=n(s,0);s=l;var u=new Uint8Array(o);var d=new DataView(o);s+=O;var E=d.getUint32(s,true);if(E!==1){throw new b("Only Instanced 3D Model version 1 is supported. Version "+E+" is not.")}s+=O;var M=d.getUint32(s,true);s+=O;var R=d.getUint32(s,true);if(R===0){throw new b("featureTableJsonByteLength is zero, the feature table must be defined.")}s+=O;var L=d.getUint32(s,true);s+=O;var N=d.getUint32(s,true);s+=O;var k=d.getUint32(s,true);s+=O;var F=d.getUint32(s,true);if(F!==1&&F!==0){throw new b("Only glTF format 0 (uri) or 1 (embedded) are supported. Format "+F+" is not.")}s+=O;var B=p(u,s,R);var U=JSON.parse(B);s+=R;var V=new Uint8Array(o,s,L);s+=L;var z=new x(U,V);var q=z.getGlobalProperty("INSTANCES_LENGTH");z.featuresLength=q;if(!a(q)){throw new b("Feature table global property: INSTANCES_LENGTH must be defined")}var G;var H;if(N>0){var j=p(u,s,N);G=JSON.parse(j);s+=N;if(k>0){H=new Uint8Array(o,s,k);H=new Uint8Array(H);s+=k}}r._batchTable=new T(r,q,G,H);var W=l+M-s;if(W===0){throw new b("glTF byte length is zero, i3dm must have a glTF to instance.")}var Y;if(s%4===0){Y=new Uint8Array(o,s,W)}else{A._deprecationWarning("i3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary.");Y=new Uint8Array(u.subarray(s,s+W))}var X={instances:new Array(q),batchTable:r._batchTable,cull:false,url:undefined,requestType:y.TILES3D,gltf:undefined,basePath:undefined,incrementallyLoadTextures:false,upAxis:r._tileset._gltfUpAxis,opaquePass:S.CESIUM_3D_TILE};if(F===0){var Q=p(Y);Q=Q.replace(/[\s\0]+$/,"");X.url=f(m(h(r._url,true),Q))}else{X.gltf=Y;X.basePath=f(h(r._url,true))}var Z=z.getGlobalProperty("EAST_NORTH_UP");var K;var J=z.getGlobalProperty("RTC_CENTER",i.FLOAT,3);if(a(J)){K=t.unpack(J)}var $=X.instances;var ee=new t;var te=new Array(3);var re=new t;var ie=new t;var ne=new t;var ae=new v;var oe=new _;var se=new t;var le=new C;var ue=new g;for(var ce=0;ce<q;ce++){var de=z.getProperty("POSITION",i.FLOAT,3,ce,D);if(!a(de)){de=te;var fe=z.getProperty("POSITION_QUANTIZED",i.UNSIGNED_SHORT,3,ce,D);if(!a(fe)){throw new b("Either POSITION or POSITION_QUANTIZED must be defined for each instance.")}var he=z.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",i.FLOAT,3);if(!a(he)){throw new b("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.")}var pe=z.getGlobalProperty("QUANTIZED_VOLUME_SCALE",i.FLOAT,3);if(!a(pe)){throw new b("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.")}for(var me=0;me<3;me++){de[me]=fe[me]/65535*pe[me]+he[me]}}t.unpack(de,0,ee);if(a(K)){t.add(ee,K,ee)}le.translation=ee;var ve=z.getProperty("NORMAL_UP",i.FLOAT,3,ce,D);var ge=z.getProperty("NORMAL_RIGHT",i.FLOAT,3,ce,I);var _e=false;if(a(ve)){if(!a(ge)){throw new b("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.")}t.unpack(ve,0,ie);t.unpack(ge,0,re);_e=true}else{var ye=z.getProperty("NORMAL_UP_OCT32P",i.UNSIGNED_SHORT,2,ce,D);var be=z.getProperty("NORMAL_RIGHT_OCT32P",i.UNSIGNED_SHORT,2,ce,I);if(a(ye)){if(!a(be)){throw new b("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.")}e.octDecodeInRange(ye[0],ye[1],65535,ie);e.octDecodeInRange(be[0],be[1],65535,re);_e=true}else if(Z){w.eastNorthUpToFixedFrame(ee,c.WGS84,ue);g.getRotation(ue,ae)}else{v.clone(v.IDENTITY,ae)}}if(_e){t.cross(re,ie,ne);t.normalize(ne,ne);v.setColumn(ae,0,re,ae);v.setColumn(ae,1,ie,ae);v.setColumn(ae,2,ne,ae)}_.fromRotationMatrix(ae,oe);le.rotation=oe;se=t.fromElements(1,1,1,se);var we=z.getProperty("SCALE",i.FLOAT,1,ce);if(a(we)){t.multiplyByScalar(se,we,se)}var Ce=z.getProperty("SCALE_NON_UNIFORM",i.FLOAT,3,ce,D);if(a(Ce)){se.x*=Ce[0];se.y*=Ce[1];se.z*=Ce[2]}le.scale=se;var Se=z.getProperty("BATCH_ID",i.UNSIGNED_SHORT,1,ce);if(!a(Se)){Se=ce}g.fromTranslationRotationScale(le,ue);var Te=ue.clone();$[ce]={modelMatrix:Te,batchId:Se}}r._modelInstanceCollection=new P(X)}function R(e){var t=e._tileset;var r=e.featuresLength;if(!a(e._features)&&r>0){var i=new Array(r);for(var n=0;n<r;++n){i[n]=new E(t,e,n)}e._features=i}}A.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)};A.prototype.getFeature=function(e){var t=this.featuresLength;if(!a(e)||e<0||e>=t){throw new u("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").")}R(this);return this._features[e]};A.prototype.applyDebugSettings=function(e,t){t=e?t:r.WHITE;this._batchTable.setAllColor(t)};A.prototype.applyStyle=function(e,t){this._batchTable.applyStyle(e,t)};A.prototype.update=function(e,t){var r=t.commandList.length;this._batchTable.update(e,t);this._modelInstanceCollection.modelMatrix=this._tile.computedTransform;this._modelInstanceCollection.shadows=this._tileset.shadows;this._modelInstanceCollection.debugWireframe=this._tileset.debugWireframe;this._modelInstanceCollection.update(t);var i=t.commandList.length;if(r<i&&t.passes.render){this._batchTable.addDerivedCommands(t,r)}};A.prototype.isDestroyed=function(){return false};A.prototype.destroy=function(){this._modelInstanceCollection=this._modelInstanceCollection&&this._modelInstanceCollection.destroy();this._batchTable=this._batchTable&&this._batchTable.destroy();return l(this)};return A});define("Scene/PointCloud3DTileContent",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/getStringFromTypedArray","../Core/Matrix4","../Core/oneTimeWarning","../Core/PrimitiveType","../Core/RuntimeError","../Core/Transforms","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../ThirdParty/when","./BlendingState","./Cesium3DTileBatchTable","./Cesium3DTileFeature","./Cesium3DTileFeatureTable","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M){"use strict";if(!d.supportsTypedArrays()){return{}}function R(e,t,r,n,a){this._tileset=e;this._tile=t;this._url=r;this._parsedContent=undefined;this._drawCommand=undefined;this._pickCommand=undefined;this._pickId=undefined;this._isTranslucent=false;this._styleTranslucent=false;this._constantColor=i.clone(i.WHITE);this._rtcCenter=undefined;this._batchTable=undefined;this._styleableShaderAttributes=undefined;this._isQuantized=false;this._isOctEncoded16P=false;this._isRGB565=false;this._hasColors=false;this._hasNormals=false;this._hasBatchIds=false;this.backFaceCulling=false;this._backFaceCulling=false;this._opaqueRenderState=undefined;this._translucentRenderState=undefined;this._highlightColor=i.clone(i.WHITE);this._pointSize=1;this._quantizedVolumeScale=undefined;this._quantizedVolumeOffset=undefined;this._modelMatrix=h.clone(h.IDENTITY);this._mode=undefined;this._readyPromise=x.defer();this._pointsLength=0;this._geometryByteLength=0;this._features=undefined;this.featurePropertiesDirty=false;N(this,n,a)}l(R.prototype,{featuresLength:{get:function(){if(s(this._batchTable)){return this._batchTable.featuresLength}return 0}},pointsLength:{get:function(){return this._pointsLength}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){if(s(this._batchTable)){return this._batchTable.memorySizeInBytes}return 0}},innerContents:{get:function(){return undefined}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._url}},batchTable:{get:function(){return this._batchTable}}});var L=Uint32Array.BYTES_PER_ELEMENT;function N(e,r,n){n=o(n,0);var l=new Uint8Array(r);var u=new DataView(r);n+=L;var c=u.getUint32(n,true);if(c!==1){throw new v("Only Point Cloud tile version 1 is supported.  Version "+c+" is not.")}n+=L;n+=L;var d=u.getUint32(n,true);if(d===0){throw new v("Feature table must have a byte length greater than zero")}n+=L;var h=u.getUint32(n,true);n+=L;var m=u.getUint32(n,true);n+=L;var g=u.getUint32(n,true);n+=L;var _=f(l,n,d);var y=JSON.parse(_);n+=d;var b=new Uint8Array(r,n,h);n+=h;var w;var C;if(m>0){var S=f(l,n,m);w=JSON.parse(S);n+=m;if(g>0){C=new Uint8Array(r,n,g);n+=g}}var T=new D(y,b);var E=T.getGlobalProperty("POINTS_LENGTH");T.featuresLength=E;if(!s(E)){throw new v("Feature table global property: POINTS_LENGTH must be defined")}var x;var P=false;if(s(y.POSITION)){x=T.getPropertyArray("POSITION",a.FLOAT,3);var O=T.getGlobalProperty("RTC_CENTER",a.FLOAT,3);if(s(O)){e._rtcCenter=t.unpack(O)}}else if(s(y.POSITION_QUANTIZED)){x=T.getPropertyArray("POSITION_QUANTIZED",a.UNSIGNED_SHORT,3);P=true;var I=T.getGlobalProperty("QUANTIZED_VOLUME_SCALE",a.FLOAT,3);if(!s(I)){throw new v("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.")}e._quantizedVolumeScale=t.unpack(I);var M=T.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",a.FLOAT,3);if(!s(M)){throw new v("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.")}e._quantizedVolumeOffset=t.unpack(M)}if(!s(x)){throw new v("Either POSITION or POSITION_QUANTIZED must be defined.")}var R;var N=false;var k=false;if(s(y.RGBA)){R=T.getPropertyArray("RGBA",a.UNSIGNED_BYTE,4);N=true}else if(s(y.RGB)){R=T.getPropertyArray("RGB",a.UNSIGNED_BYTE,3)}else if(s(y.RGB565)){R=T.getPropertyArray("RGB565",a.UNSIGNED_SHORT,1);k=true}else if(s(y.CONSTANT_RGBA)){var F=T.getGlobalProperty("CONSTANT_RGBA",a.UNSIGNED_BYTE,4);e._constantColor=i.fromBytes(F[0],F[1],F[2],F[3],e._constantColor)}else{e._constantColor=i.clone(i.DARKGRAY,e._constantColor)}e._isTranslucent=N;var B;var U=false;if(s(y.NORMAL)){B=T.getPropertyArray("NORMAL",a.FLOAT,3)}else if(s(y.NORMAL_OCT16P)){B=T.getPropertyArray("NORMAL_OCT16P",a.UNSIGNED_BYTE,2);U=true}var V;if(s(y.BATCH_ID)){V=T.getPropertyArray("BATCH_ID",a.UNSIGNED_SHORT,1);var z=T.getGlobalProperty("BATCH_LENGTH");if(!s(z)){throw new v("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.")}if(s(C)){C=new Uint8Array(C)}e._batchTable=new A(e,z,w,C)}var q;if(!s(V)&&s(C)){q=A.getBinaryProperties(E,w,C);for(var G in q){if(q.hasOwnProperty(G)){var H=q[G];var j=H.typedArray;var W=a.fromTypedArray(j);if(W===a.INT||W===a.UNSIGNED_INT||W===a.DOUBLE){p("Cast pnts property to floats",'Point cloud property "'+G+'" will be casted to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.');H.typedArray=new Float32Array(j)}}}}e._parsedContent={positions:x,colors:R,normals:B,batchIds:V,styleableProperties:q};e._pointsLength=E;e._isQuantized=P;e._isOctEncoded16P=U;e._isRGB565=k;e._hasColors=s(R);e._hasNormals=s(B);e._hasBatchIds=s(V)}var k=new e;var F=0;var B=1;var U=2;var V=3;var z=4;function q(e,t){var r=t.context;var i=e._parsedContent;var o=e._pointsLength;var l=i.positions;var u=i.colors;var c=i.normals;var d=i.batchIds;var f=i.styleableProperties;var p=s(f);var v=e._isQuantized;var g=e._isOctEncoded16P;var S=e._isRGB565;var T=e._isTranslucent;var x=e._hasColors;var A=e._hasNormals;var O=e._hasBatchIds;var D=e._batchTable;var I=s(D);var M=[];var R={};e._styleableShaderAttributes=R;if(p){var L=z;for(var N in f){if(f.hasOwnProperty(N)){var q=f[N];var G=q.typedArray;var H=q.componentCount;var j=a.fromTypedArray(G);var W=_.createVertexBuffer({context:r,typedArray:q.typedArray,usage:y.STATIC_DRAW});e._geometryByteLength+=W.sizeInBytes;var Y={index:L,vertexBuffer:W,componentsPerAttribute:H,componentDatatype:j,normalize:false,offsetInBytes:0,strideInBytes:0};M.push(Y);R[N]={location:L,componentCount:H};++L}}}var X={u_pointSizeAndTilesetTime:function(){k.x=e._pointSize;k.y=e._tileset.timeSinceLoad;return k},u_highlightColor:function(){return e._highlightColor},u_constantColor:function(){return e._constantColor}};if(v){X=n(X,{u_quantizedVolumeScale:function(){return e._quantizedVolumeScale}})}var Q=_.createVertexBuffer({context:r,typedArray:l,usage:y.STATIC_DRAW});e._geometryByteLength+=Q.sizeInBytes;var Z;if(x){Z=_.createVertexBuffer({context:r,typedArray:u,usage:y.STATIC_DRAW});e._geometryByteLength+=Z.sizeInBytes}var K;if(A){K=_.createVertexBuffer({context:r,typedArray:c,usage:y.STATIC_DRAW});e._geometryByteLength+=K.sizeInBytes}var J;if(O){J=_.createVertexBuffer({context:r,typedArray:d,usage:y.STATIC_DRAW});e._geometryByteLength+=J.sizeInBytes}var $=[];if(v){$.push({index:F,vertexBuffer:Q,componentsPerAttribute:3,componentDatatype:a.UNSIGNED_SHORT,normalize:true,offsetInBytes:0,strideInBytes:0})}else{$.push({index:F,vertexBuffer:Q,componentsPerAttribute:3,componentDatatype:a.FLOAT,normalize:false,offsetInBytes:0,strideInBytes:0})}if(x){if(S){$.push({index:B,vertexBuffer:Z,componentsPerAttribute:1,componentDatatype:a.UNSIGNED_SHORT,normalize:false,offsetInBytes:0,strideInBytes:0})}else{var ee=T?4:3;$.push({index:B,vertexBuffer:Z,componentsPerAttribute:ee,componentDatatype:a.UNSIGNED_BYTE,normalize:true,offsetInBytes:0,strideInBytes:0})}}if(A){if(g){$.push({index:U,vertexBuffer:K,componentsPerAttribute:2,componentDatatype:a.UNSIGNED_BYTE,normalize:false,offsetInBytes:0,strideInBytes:0})}else{$.push({index:U,vertexBuffer:K,componentsPerAttribute:3,componentDatatype:a.FLOAT,normalize:false,offsetInBytes:0,strideInBytes:0})}}if(O){$.push({index:V,vertexBuffer:J,componentsPerAttribute:1,componentDatatype:a.fromTypedArray(d),normalize:false,offsetInBytes:0,strideInBytes:0})}if(p){$=$.concat(M)}var te=new E({context:r,attributes:$});var re=X;if(I){re=D.getUniformMapCallback()(X)}var ie;if(I){ie=D.getPickUniformMapCallback()(X)}else{e._pickId=r.createPickId({primitive:e._tileset,content:e});ie=n(X,{czm_pickColor:function(){return e._pickId.color}})}e._opaqueRenderState=C.fromCache({depthTest:{enabled:true}});e._translucentRenderState=C.fromCache({depthTest:{enabled:true},depthMask:false,blending:P.ALPHA_BLEND});e._drawCommand=new b({boundingVolume:undefined,cull:false,modelMatrix:new h,primitiveType:m.POINTS,vertexArray:te,count:o,shaderProgram:undefined,uniformMap:re,renderState:T?e._translucentRenderState:e._opaqueRenderState,pass:T?w.TRANSLUCENT:w.CESIUM_3D_TILE,owner:e,castShadows:false,receiveShadows:false});e._pickCommand=new b({boundingVolume:undefined,cull:false,modelMatrix:new h,primitiveType:m.POINTS,vertexArray:te,count:o,shaderProgram:undefined,uniformMap:ie,renderState:T?e._translucentRenderState:e._opaqueRenderState,pass:T?w.TRANSLUCENT:w.CESIUM_3D_TILE,owner:e})}var G=["POSITION","COLOR","NORMAL","POSITION_ABSOLUTE"];function H(e,t){var r=/czm_tiles3d_style_(\w+)/g;var i=r.exec(e);while(i!==null){var n=i[1];if(t.indexOf(n)===-1){t.push(n)}i=r.exec(e)}}function j(e,t){var r=e.numberOfAttributes;for(var i=0;i<r;++i){var n=e.getAttribute(i);if(n.index===t){return n}}}function W(e){var t=G.length;for(var r=0;r<t;++r){var i=G[r];var n="czm_tiles3d_style_"+i;var a=i.toLowerCase();e=e.replace(new RegExp(n+"(\\W)","g"),a+"$1")}return e.replace("()","(vec3 position, vec3 position_absolute, vec4 color, vec3 normal)")}function Y(e,t,r){var i;var n;var a;var o=t.context;var l=e._batchTable;var u=s(l);var c=s(r);var d=e._isQuantized;var f=e._isOctEncoded16P;var h=e._isRGB565;var p=e._isTranslucent;var m=e._hasColors;var g=e._hasNormals;var _=e._hasBatchIds;var y=e._backFaceCulling;var b=e._drawCommand.vertexArray;var w;var C;var E;var x=p;if(u){c=false}if(c){var P={translucent:false};w=r.getColorShaderFunction("getColorFromStyle","czm_tiles3d_style_",P);C=r.getShowShaderFunction("getShowFromStyle","czm_tiles3d_style_",P);E=r.getPointSizeShaderFunction("getPointSizeFromStyle","czm_tiles3d_style_",P);if(s(w)&&P.translucent){x=true}}e._styleTranslucent=x;var A=s(w);var O=s(C);var D=s(E);var I=[];if(A){H(w,I);w=W(w)}if(O){H(C,I);C=W(C)}if(D){H(E,I);E=W(E)}var M=I.indexOf("COLOR")>=0;var R=I.indexOf("NORMAL")>=0;var L=I.filter(function(e){return G.indexOf(e)===-1});if(R&&!g){throw new v("Style references the NORMAL semantic but the point cloud does not have normals")}var N=e._styleableShaderAttributes;for(n in N){if(N.hasOwnProperty(n)){a=N[n];var k=L.indexOf(n)>=0;var z=j(b,a.location);z.enabled=k}}var q=m&&(!A||M);if(m){var Y=j(b,B);Y.enabled=q}var X={a_position:F};if(q){X.a_color=B}if(g){X.a_normal=U}if(_){X.a_batchId=V}var Q="";var Z=L.length;for(i=0;i<Z;++i){n=L[i];a=N[n];if(!s(a)){throw new v('Style references a property "'+n+'" that does not exist or is not styleable.')}var K=a.componentCount;var J="czm_tiles3d_style_"+n;var $;if(K===1){$="float"}else{$="vec"+K}Q+="attribute "+$+" "+J+"; \n";X[J]=a.location}var ee="attribute vec3 a_position; \n"+"varying vec4 v_color; \n"+"uniform vec2 u_pointSizeAndTilesetTime; \n"+"uniform vec4 u_constantColor; \n"+"uniform vec4 u_highlightColor; \n"+"float u_pointSize; \n"+"float u_tilesetTime; \n";ee+=Q;if(q){if(p){ee+="attribute vec4 a_color; \n"}else if(h){ee+="attribute float a_color; \n"+"const float SHIFT_RIGHT_11 = 1.0 / 2048.0; \n"+"const float SHIFT_RIGHT_5 = 1.0 / 32.0; \n"+"const float SHIFT_LEFT_11 = 2048.0; \n"+"const float SHIFT_LEFT_5 = 32.0; \n"+"const float NORMALIZE_6 = 1.0 / 64.0; \n"+"const float NORMALIZE_5 = 1.0 / 32.0; \n"}else{ee+="attribute vec3 a_color; \n"}}if(g){if(f){ee+="attribute vec2 a_normal; \n"}else{ee+="attribute vec3 a_normal; \n"}}if(_){ee+="attribute float a_batchId; \n"}if(d){ee+="uniform vec3 u_quantizedVolumeScale; \n"}if(A){ee+=w}if(O){ee+=C}if(D){ee+=E}ee+="void main() \n"+"{ \n"+"    u_pointSize = u_pointSizeAndTilesetTime.x; \n"+"    u_tilesetTime = u_pointSizeAndTilesetTime.y; \n";if(q){if(p){ee+="    vec4 color = a_color; \n"}else if(h){ee+="    float compressed = a_color; \n"+"    float r = floor(compressed * SHIFT_RIGHT_11); \n"+"    compressed -= r * SHIFT_LEFT_11; \n"+"    float g = floor(compressed * SHIFT_RIGHT_5); \n"+"    compressed -= g * SHIFT_LEFT_5; \n"+"    float b = compressed; \n"+"    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); \n"+"    vec4 color = vec4(rgb, 1.0); \n"}else{ee+="    vec4 color = vec4(a_color, 1.0); \n"}}else{ee+="    vec4 color = u_constantColor; \n"}if(d){ee+="    vec3 position = a_position * u_quantizedVolumeScale; \n"}else{ee+="    vec3 position = a_position; \n"}ee+="    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); \n";if(g){if(f){ee+="    vec3 normal = czm_octDecode(a_normal); \n"}else{ee+="    vec3 normal = a_normal; \n"}}else{ee+="    vec3 normal = vec3(1.0); \n"}if(A){ee+="    color = getColorFromStyle(position, position_absolute, color, normal); \n"}if(O){ee+="    float show = float(getShowFromStyle(position, position_absolute, color, normal)); \n"}if(D){ee+="    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal); \n"}else{ee+="    gl_PointSize = u_pointSize; \n"}ee+="    color = color * u_highlightColor; \n";if(g){ee+="    normal = czm_normal * normal; \n"+"    float diffuseStrength = czm_getLambertDiffuse(czm_sunDirectionEC, normal); \n"+"    diffuseStrength = max(diffuseStrength, 0.4); \n"+"    color *= diffuseStrength; \n"}ee+="    v_color = color; \n"+"    gl_Position = czm_modelViewProjection * vec4(position, 1.0); \n";if(g&&y){ee+="    float visible = step(-normal.z, 0.0); \n"+"    gl_Position *= visible; \n"}if(O){ee+="    gl_Position *= show; \n"}ee+="} \n";var te="varying vec4 v_color; \n"+"void main() \n"+"{ \n"+"    gl_FragColor = v_color; \n"+"} \n";var re=ee;var ie=te;if(u){re=l.getVertexShaderCallback(false,"a_batchId")(re);ie=l.getFragmentShaderCallback(false,undefined)(ie)}var ne=ee;var ae=te;if(u){ne=l.getPickVertexShaderCallback("a_batchId")(ne);ae=l.getPickFragmentShaderCallback()(ae)}else{ae=T.createPickFragmentShaderSource(ae,"uniform")}var oe=e._drawCommand;if(s(oe.shaderProgram)){oe.shaderProgram.destroy()}oe.shaderProgram=S.fromCache({context:o,vertexShaderSource:re,fragmentShaderSource:ie,attributeLocations:X});var se=e._pickCommand;if(s(se.shaderProgram)){se.shaderProgram.destroy()}se.shaderProgram=S.fromCache({context:o,vertexShaderSource:ne,fragmentShaderSource:ae,attributeLocations:X});try{oe.shaderProgram._bind()}catch(e){throw new v("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}function X(e){var t=e._tileset;var r=e.featuresLength;if(!s(e._features)&&r>0){var i=new Array(r);for(var n=0;n<r;++n){i[n]=new O(t,e,n)}e._features=i}}R.prototype.hasProperty=function(e,t){if(s(this._batchTable)){return this._batchTable.hasProperty(e,t)}return false};R.prototype.getFeature=function(e){if(!s(this._batchTable)){return undefined}var t=this.featuresLength;if(!s(e)||e<0||e>=t){throw new c("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").")}X(this);return this._features[e]};R.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:i.WHITE};R.prototype.applyStyle=function(e,t){if(s(this._batchTable)){this._batchTable.applyStyle(e,t)}else{Y(this,e,t)}};var Q=new r;var Z=new h;R.prototype.update=function(e,t){var i=this._tile.computedTransform;var n=!h.equals(this._modelMatrix,i);var a=n||this._mode!==t.mode;this._mode=t.mode;if(!s(this._drawCommand)){q(this,t);Y(this,t,e.style);a=true;this._readyPromise.resolve(this);this._parsedContent=undefined}if(a){h.clone(i,this._modelMatrix);if(s(this._rtcCenter)){h.multiplyByTranslation(i,this._rtcCenter,this._drawCommand.modelMatrix)}else if(s(this._quantizedVolumeOffset)){h.multiplyByTranslation(i,this._quantizedVolumeOffset,this._drawCommand.modelMatrix)}else{h.clone(i,this._drawCommand.modelMatrix)}if(t.mode!==I.SCENE3D){var o=t.mapProjection;i=this._drawCommand.modelMatrix;var l=h.getColumn(i,3,Q);if(!r.equals(l,r.UNIT_W)){g.basisTo2D(o,i,i)}else{var u=this._tile.boundingSphere.center;var c=g.wgs84To2DModelMatrix(o,u,Z);h.multiply(c,i,i)}}h.clone(this._drawCommand.modelMatrix,this._pickCommand.modelMatrix);var d;if(s(this._tile._contentBoundingVolume)){d=this._mode===I.SCENE3D?this._tile._contentBoundingVolume.boundingSphere:this._tile._contentBoundingVolume2D.boundingSphere}else{d=this._mode===I.SCENE3D?this._tile._boundingVolume.boundingSphere:this._tile._boundingVolume2D.boundingSphere}this._drawCommand.boundingVolume=d;this._pickCommand.boundingVolume=d}this._drawCommand.castShadows=M.castShadows(e.shadows);this._drawCommand.receiveShadows=M.receiveShadows(e.shadows);if(this.backFaceCulling!==this._backFaceCulling){this._backFaceCulling=this.backFaceCulling;Y(this,t,e.style)}var f=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=f?this._translucentRenderState:this._opaqueRenderState;this._drawCommand.pass=f?w.TRANSLUCENT:w.CESIUM_3D_TILE;if(s(this._batchTable)){this._batchTable.update(e,t)}var p=t.commandList;var m=t.passes;if(m.render){p.push(this._drawCommand)}if(m.pick){p.push(this._pickCommand)}};R.prototype.isDestroyed=function(){return false};R.prototype.destroy=function(){var e=this._drawCommand;var t=this._pickCommand;if(s(e)){e.vertexArray=e.vertexArray&&e.vertexArray.destroy();e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy();t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}this._batchTable=this._batchTable&&this._batchTable.destroy();return u(this)};return R});define("Scene/Tileset3DTileContent",["../Core/defaultValue","../Core/defineProperties","../Core/destroyObject","../Core/getStringFromTypedArray","../Core/RuntimeError","../ThirdParty/when"],function(e,t,r,i,n,a){"use strict";function o(e,t,r,i,n){this._tileset=e;this._tile=t;this._url=r;this._readyPromise=a.defer();this.featurePropertiesDirty=false;s(this,i,n)}t(o.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return undefined}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._url}},batchTable:{get:function(){return undefined}}});function s(t,r,a){a=e(a,0);var o=new Uint8Array(r);var s=i(o,a);var l;try{l=JSON.parse(s)}catch(e){t._readyPromise.reject(new n("Invalid tile content."));return}t._tileset.loadTileset(t._url,l,t._tile);t._readyPromise.resolve(t)}o.prototype.hasProperty=function(e,t){return false};o.prototype.getFeature=function(e){return undefined};o.prototype.applyDebugSettings=function(e,t){};o.prototype.applyStyle=function(e,t){};o.prototype.update=function(e,t){};o.prototype.isDestroyed=function(){return false};o.prototype.destroy=function(){return r(this)};return o});define("Scene/Cesium3DTileContentFactory",["./Batched3DModel3DTileContent","./Composite3DTileContent","./Instanced3DModel3DTileContent","./PointCloud3DTileContent","./Tileset3DTileContent"],function(e,t,r,i,n){"use strict";var a={b3dm:function(t,r,i,n,a){return new e(t,r,i,n,a)},pnts:function(e,t,r,n,a){return new i(e,t,r,n,a)},i3dm:function(e,t,i,n,a){return new r(e,t,i,n,a)},cmpt:function(e,r,i,n,o){return new t(e,r,i,n,o,a)},json:function(e,t,r,i,a){return new n(e,t,r,i,a)}};return a});define("Scene/Cesium3DTileContentState",["../Core/freezeObject"],function(e){"use strict";var t={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5};return e(t)});define("Scene/Cesium3DTileOptimizationHint",["../Core/freezeObject"],function(e){"use strict";var t={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};return e(t)});define("Scene/Cesium3DTileRefine",["../Core/freezeObject"],function(e){"use strict";var t={ADD:0,REPLACE:1};return e(t)});define("Scene/Empty3DTileContent",["../Core/defineProperties","../Core/destroyObject"],function(e,t){"use strict";function r(e,t){this._tileset=e;this._tile=t;this.featurePropertiesDirty=false}e(r.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return undefined}},readyPromise:{get:function(){return undefined}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return undefined}},batchTable:{get:function(){return undefined}}});r.prototype.hasProperty=function(e,t){return false};r.prototype.getFeature=function(e){return undefined};r.prototype.applyDebugSettings=function(e,t){};r.prototype.applyStyle=function(e,t){};r.prototype.update=function(e,t){};r.prototype.isDestroyed=function(){return false};r.prototype.destroy=function(){return t(this)};return r});define("Scene/TileBoundingRegion",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartographic","../Core/Check","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defineProperties","../Core/Ellipsoid","../Core/GeometryInstance","../Core/IntersectionTests","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/Plane","../Core/Ray","../Core/Rectangle","../Core/RectangleOutlineGeometry","./PerInstanceColorAppearance","./Primitive","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_){"use strict";function y(r){i.typeOf.object("options",r);i.typeOf.object("options.rectangle",r.rectangle);this.rectangle=p.clone(r.rectangle);this.minimumHeight=a(r.minimumHeight,0);this.maximumHeight=a(r.maximumHeight,0);this.southwestCornerCartesian=new t;this.northeastCornerCartesian=new t;this.westNormal=new t;this.southNormal=new t;this.eastNormal=new t;this.northNormal=new t;var n=a(r.ellipsoid,s.WGS84);O(this,r.rectangle,n);this._orientedBoundingBox=d.fromRectangle(this.rectangle,this.minimumHeight,this.maximumHeight,n);this._boundingSphere=e.fromOrientedBoundingBox(this._orientedBoundingBox)}o(y.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});var b=new t;var w=new t;var C=new t;var S=new t;var T=new t;var E=new t;var x=new r;var P=new f(t.UNIT_X,0);var A=new h;function O(e,r,i){i.cartographicToCartesian(p.southwest(r),e.southwestCornerCartesian);i.cartographicToCartesian(p.northeast(r),e.northeastCornerCartesian);x.longitude=r.west;x.latitude=(r.south+r.north)*.5;x.height=0;var n=i.cartographicToCartesian(x,T);var a=t.cross(n,t.UNIT_Z,b);t.normalize(a,e.westNormal);x.longitude=r.east;var o=i.cartographicToCartesian(x,E);var s=t.cross(t.UNIT_Z,o,b);t.normalize(s,e.eastNormal);var l=t.subtract(n,o,b);var c=t.normalize(l,S);var d=r.south;var h;if(d>0){x.longitude=(r.west+r.east)*.5;x.latitude=d;var m=i.cartographicToCartesian(x,A.origin);t.clone(c,A.direction);var v=f.fromPointNormal(e.southwestCornerCartesian,e.westNormal,P);u.rayPlane(A,v,e.southwestCornerCartesian);h=i.geodeticSurfaceNormal(m,w)}else{h=i.geodeticSurfaceNormalCartographic(p.southeast(r),w)}var g=t.cross(h,l,C);t.normalize(g,e.southNormal);var _=r.north;var y;if(_<0){x.longitude=(r.west+r.east)*.5;x.latitude=_;var O=i.cartographicToCartesian(x,A.origin);t.negate(c,A.direction);var D=f.fromPointNormal(e.northeastCornerCartesian,e.eastNormal,P);u.rayPlane(A,D,e.northeastCornerCartesian);y=i.geodeticSurfaceNormal(O,w)}else{y=i.geodeticSurfaceNormalCartographic(p.northwest(r),w)}var I=t.cross(l,y,C);t.normalize(I,e.northNormal)}var D=new t;var I=new t;var M=new t(0,-1,0);var R=new t(0,0,-1);var L=new t;y.prototype.distanceToCamera=function(e){i.defined("frameState",e);var r=e.camera;var n=r.positionWC;var a=r.positionCartographic;var o=0;if(!p.contains(this.rectangle,a)){var s=this.southwestCornerCartesian;var l=this.northeastCornerCartesian;var u=this.westNormal;var c=this.southNormal;var d=this.eastNormal;var f=this.northNormal;if(e.mode!==_.SCENE3D){s=e.mapProjection.project(p.southwest(this.rectangle),D);s.z=s.y;s.y=s.x;s.x=0;l=e.mapProjection.project(p.northeast(this.rectangle),I);l.z=l.y;l.y=l.x;l.x=0;u=M;d=t.UNIT_Y;c=R;f=t.UNIT_Z}var h=t.subtract(n,s,L);var m=t.dot(h,u);var v=t.dot(h,c);var g=t.subtract(n,l,L);var y=t.dot(g,d);var b=t.dot(g,f);if(m>0){o+=m*m}else if(y>0){o+=y*y}if(v>0){o+=v*v}else if(b>0){o+=b*b}}var w;if(e.mode===_.SCENE3D){w=a.height}else{w=n.x}var C=e.mode===_.SCENE3D?this.maximumHeight:0;var S=w-C;if(S>0){o+=S*S}return Math.sqrt(o)};y.prototype.intersectPlane=function(e){i.defined("plane",e);return this._orientedBoundingBox.intersectPlane(e)};y.prototype.createDebugVolume=function(e){i.defined("color",e);var t=new c.clone(c.IDENTITY);var r=new m({rectangle:this.rectangle,height:this.minimumHeight,extrudedHeight:this.maximumHeight});var a=new l({geometry:r,modelMatrix:t,attributes:{color:n.fromColor(e)}});return new g({geometryInstances:a,appearance:new v({translucent:false,flat:true}),asynchronous:false})};return y});define("Scene/TileBoundingSphere",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Check","../Core/ColorGeometryInstanceAttribute","../Core/defineProperties","../Core/GeometryInstance","../Core/Matrix4","../Core/SphereOutlineGeometry","./PerInstanceColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(t,r){this._boundingSphere=new e(t,r)}n(c.prototype,{center:{get:function(){return this._boundingSphere.center}},radius:{get:function(){return this._boundingSphere.radius}},boundingVolume:{get:function(){return this._boundingSphere}},boundingSphere:{get:function(){return this._boundingSphere}}});c.prototype.distanceToCamera=function(e){r.defined("frameState",e);var i=this._boundingSphere;return Math.max(0,t.distance(i.center,e.camera.positionWC)-i.radius)};c.prototype.intersectPlane=function(t){r.defined("plane",t);return e.intersectPlane(this._boundingSphere,t)};c.prototype.update=function(e,r){t.clone(e,this._boundingSphere.center);this._boundingSphere.radius=r};c.prototype.createDebugVolume=function(e){r.defined("color",e);var t=new s({radius:this.radius});var n=o.fromTranslation(this.center,new o.clone(o.IDENTITY));var c=new a({geometry:t,modelMatrix:n,attributes:{color:i.fromColor(e)}});return new u({geometryInstances:c,appearance:new l({translucent:false,flat:true}),asynchronous:false})};return c});define("Scene/TileOrientedBoundingBox",["../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian3","../Core/Check","../Core/ColorGeometryInstanceAttribute","../Core/defineProperties","../Core/GeometryInstance","../Core/Matrix3","../Core/Matrix4","../Core/OrientedBoundingBox","./PerInstanceColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(t,r){this._orientedBoundingBox=new u(t,r);this._boundingSphere=e.fromOrientedBoundingBox(this._orientedBoundingBox)}a(f.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});f.prototype.distanceToCamera=function(e){i.defined("frameState",e);return Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC))};f.prototype.intersectPlane=function(e){i.defined("plane",e);return this._orientedBoundingBox.intersectPlane(e)};f.prototype.update=function(t,i){r.clone(t,this._orientedBoundingBox.center);s.clone(i,this._orientedBoundingBox.halfAxes);e.fromOrientedBoundingBox(this._orientedBoundingBox,this._boundingSphere)};f.prototype.createDebugVolume=function(e){i.defined("color",e);var a=new t({minimum:new r(-1,-1,-1),maximum:new r(1,1,1)});var s=l.fromRotationTranslation(this.boundingVolume.halfAxes,this.boundingVolume.center);var u=new o({geometry:a,modelMatrix:s,attributes:{color:n.fromColor(e)}});return new d({geometryInstances:u,appearance:new c({translucent:false,flat:true}),asynchronous:false})};return f});define("Scene/Cesium3DTile",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/deprecationWarning","../Core/destroyObject","../Core/getMagic","../Core/Intersect","../Core/joinUrls","../Core/JulianDate","../Core/loadArrayBuffer","../Core/Matrix3","../Core/Matrix4","../Core/Rectangle","../Core/Request","../Core/RequestScheduler","../Core/RequestState","../Core/RequestType","../Core/RuntimeError","../ThirdParty/when","./Cesium3DTileChildrenVisibility","./Cesium3DTileContentFactory","./Cesium3DTileContentState","./Cesium3DTileOptimizationHint","./Cesium3DTileRefine","./Empty3DTileContent","./SceneMode","./TileBoundingRegion","./TileBoundingSphere","./TileOrientedBoundingBox"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I){"use strict";function M(e,t,i,a){this._tileset=e;this._header=i;var o=i.content;this.transform=n(i.transform)?p.unpack(i.transform):p.clone(p.IDENTITY);var s=n(a)?a.computedTransform:e.modelMatrix;var l=p.multiply(s,this.transform,new p);this.computedTransform=l;this._boundingVolume=this.createBoundingVolume(i.boundingVolume,l);this._boundingVolume2D=undefined;var u;if(n(o)&&n(o.boundingVolume)){u=this.createBoundingVolume(o.boundingVolume,l)}this._contentBoundingVolume=u;this._contentBoundingVolume2D=undefined;var f;if(n(i.viewerRequestVolume)){f=this.createBoundingVolume(i.viewerRequestVolume,l)}this._viewerRequestVolume=f;this.geometricError=i.geometricError;if(!n(this.geometricError)){this.geometricError=n(a)?a.geometricError:e._geometricError;M._deprecationWarning("geometricErrorUndefined","Required property geometricError is undefined for this tile. Using parent's geometric error instead.")}var h;if(n(i.refine)){if(i.refine==="replace"||i.refine==="add"){M._deprecationWarning("lowercase-refine",'This tile uses a lowercase refine "'+i.refine+'". Instead use "'+i.refine.toUpperCase()+'".')}h=i.refine.toUpperCase()==="REPLACE"?x.REPLACE:x.ADD}else if(n(a)){h=a.refine}else{h=x.REPLACE}this.refine=h;this.children=[];this.parent=a;var m;var v;var _;var y;var b;if(n(o)){v=false;_=T.UNLOADED;y=c(t,o.url);b=g.getServerKey(y)}else{m=new P(e,this);v=true;_=T.READY}this._content=m;this._contentUrl=y;this._contentState=_;this._contentReadyToProcessPromise=undefined;this._contentReadyPromise=undefined;this._expiredContent=undefined;this._serverKey=b;this.hasEmptyContent=v;this.hasRenderableContent=false;this.hasTilesetContent=false;this.replacementNode=undefined;var w=i.expire;var S;var A;if(n(w)){S=w.duration;if(n(w.date)){A=d.fromIso8601(w.date)}}this.expireDuration=S;this.expireDate=A;this.selected=false;this.lastStyleTime=0;this._optimChildrenWithinParent=E.NOT_COMPUTED;this._distanceToCamera=0;this._visibilityPlaneMask=0;this._childrenVisibility=C.VISIBLE;this._lastSelectedFrameNumber=-1;this._screenSpaceError=0;this._screenSpaceErrorComputedFrame=-1;this._finalResolution=true;this._depth=0;this._centerZDepth=0;this._stackLength=0;this._selectedFrame=-1;this._selectionDepth=0;this._lastSelectionDepth=undefined;this._requestedFrame=undefined;this._lastVisitedFrame=undefined;this._ancestorWithContent=undefined;this._ancestorWithLoadedContent=undefined;this._debugBoundingVolume=undefined;this._debugContentBoundingVolume=undefined;this._debugViewerRequestVolume=undefined;this._debugColor=r.fromRandom({alpha:1});this._debugColorizeTiles=false;this._commandsLength=0;this._color=undefined;this._colorDirty=false}M._deprecationWarning=o;a(M.prototype,{tileset:{get:function(){return this._tileset}},content:{get:function(){return this._content}},contentBoundingVolume:{get:function(){return i(this._contentBoundingVolume,this._boundingVolume)}},boundingSphere:{get:function(){return this._boundingVolume.boundingSphere}},color:{get:function(){if(!n(this._color)){this._color=new r}return r.clone(this._color)},set:function(e){this._color=r.clone(e,this._color);this._colorDirty=true}},contentAvailable:{get:function(){return this.contentReady||n(this._expiredContent)&&this._contentState!==T.FAILED}},contentReady:{get:function(){return this._contentState===T.READY}},contentUnloaded:{get:function(){return this._contentState===T.UNLOADED}},contentExpired:{get:function(){return this._contentState===T.EXPIRED}},contentReadyToProcessPromise:{get:function(){if(n(this._contentReadyToProcessPromise)){return this._contentReadyToProcessPromise.promise}}},contentReadyPromise:{get:function(){if(n(this._contentReadyPromise)){return this._contentReadyPromise.promise}}},commandsLength:{get:function(){return this._commandsLength}}});var R=new d;M.prototype.updateExpiration=function(){if(n(this.expireDate)&&this.contentReady&&!this.hasEmptyContent){var e=d.now(R);if(d.lessThan(this.expireDate,e)){this._contentState=T.EXPIRED;this._expiredContent=this._content}}};function L(e){if(n(e.expireDuration)){var t=d.now(R);d.addSeconds(t,e.expireDuration,t);if(n(e.expireDate)){if(d.lessThan(e.expireDate,t)){d.clone(t,e.expireDate)}}else{e.expireDate=d.clone(t)}}}function N(e){return function(t){e._contentState=T.FAILED;e._contentReadyPromise.reject(t);e._contentReadyToProcessPromise.reject(t)}}function k(e){return function(){return e._distanceToCamera}}M.prototype.requestContent=function(){var e=this;var t=this._tileset;if(this.hasEmptyContent){return false}var r=this._contentUrl;var i=this.contentExpired;if(i){var a="?expired="+this.expireDate.toString();r=c(r,a,false)}var o=new v({throttle:true,throttleByServer:true,type:y.TILES3D,priorityFunction:k(this),serverKey:this._serverKey});var s=f(r,undefined,o);if(!n(s)){return false}var u=this._contentState;this._contentState=T.LOADING;this._contentReadyToProcessPromise=w.defer();this._contentReadyPromise=w.defer();if(i){this.expireDate=undefined}var d=N(this);s.then(function(r){if(e.isDestroyed()){d();return}var i=new Uint8Array(r);var a=l(i);var o=S[a];var s;if(n(o)){s=o(t,e,e._contentUrl,r,0);e.hasRenderableContent=true}else{s=S.json(t,e,e._contentUrl,r,0);e.hasTilesetContent=true}e._content=s;e._contentState=T.PROCESSING;e._contentReadyToProcessPromise.resolve(s);return s.readyPromise.then(function(t){if(e.isDestroyed()){d();return}L(e);e.lastStyleTime=0;e._contentState=T.READY;e._contentReadyPromise.resolve(t)})}).otherwise(function(r){if(o.state===_.CANCELLED){e._contentState=u;--t.statistics.numberOfPendingRequests;++t.statistics.numberOfAttemptedRequests;return}d(r)});return true};M.prototype.unloadContent=function(){if(!this.hasRenderableContent){return}this._content=this._content&&this._content.destroy();this._contentState=T.UNLOADED;this._contentReadyToProcessPromise=undefined;this._contentReadyPromise=undefined;this.replacementNode=undefined;this.lastStyleTime=0;this._debugColorizeTiles=false;this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy();this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy();this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()};var F=new e;function B(t,r){if(r.mode!==A.SCENE3D&&!n(t._boundingVolume2D)){var i=t._boundingVolume.boundingSphere;var a=e.projectTo2D(i,r.mapProjection,F);t._boundingVolume2D=new D(a.center,a.radius)}return r.mode!==A.SCENE3D?t._boundingVolume2D:t._boundingVolume}function U(t,r){if(r.mode!==A.SCENE3D&&!n(t._contentBoundingVolume2D)){var i=t._contentBoundingVolume.boundingSphere;var a=e.projectTo2D(i,r.mapProjection,F);t._contentBoundingVolume2D=new D(a.center,a.radius)}return r.mode!==A.SCENE3D?t._contentBoundingVolume2D:t._contentBoundingVolume}M.prototype.visibility=function(e,t){var r=e.cullingVolume;var i=B(this,e);return r.computeVisibilityWithPlaneMask(i,t)};M.prototype.contentVisibility=function(e){if(!n(this._contentBoundingVolume)){return u.INSIDE}var t=e.cullingVolume;var r=U(this,e);return t.computeVisibility(r)};M.prototype.distanceToTile=function(e){var t=B(this,e);return t.distanceToCamera(e)};var V=new t;M.prototype.distanceToTileCenter=function(e){var r=B(this,e);var i=r.boundingVolume;var n=t.subtract(i.center,e.camera.positionWC,V);var a=t.magnitude(n);t.divideByScalar(n,a,n);var o=t.dot(e.camera.directionWC,n);return a*o};M.prototype.insideViewerRequestVolume=function(e){var t=this._viewerRequestVolume;return!n(t)||t.distanceToCamera(e)===0};var z=new h;var q=new t;var G=new h;var H=new t;var j=new m;function W(e,r,i){var a=t.fromElements(e[0],e[1],e[2],H);var o=h.fromArray(e,3,G);a=p.multiplyByPoint(r,a,a);var s=p.getRotation(r,z);o=h.multiply(s,o,o);if(n(i)){i.update(a,o);return i}return new I(a,o)}function Y(e,t){var r=m.unpack(e,0,j);if(n(t)){return t}return new O({rectangle:r,minimumHeight:e[4],maximumHeight:e[5]})}function X(e,r,i){var a=t.fromElements(e[0],e[1],e[2],H);var o=e[3];a=p.multiplyByPoint(r,a,a);var s=p.getScale(r,q);var l=t.maximumComponent(s);o*=l;if(n(i)){i.update(a,o);return i}return new D(a,o)}M.prototype.createBoundingVolume=function(e,t,r){if(!n(e)){throw new b("boundingVolume must be defined")}if(n(e.box)){return W(e.box,t,r)}if(n(e.region)){return Y(e.region,r)}if(n(e.sphere)){return X(e.sphere,t,r)}throw new b("boundingVolume must contain a sphere, region, or box")};var Q=new p;M.prototype.updateTransform=function(e){e=i(e,p.IDENTITY);var t=p.multiply(e,this.transform,Q);var r=!p.equals(t,this.computedTransform);if(!r){return}p.clone(t,this.computedTransform);var a=this._header;var o=this._header.content;this._boundingVolume=this.createBoundingVolume(a.boundingVolume,t,this._boundingVolume);if(n(this._contentBoundingVolume)){this._contentBoundingVolume=this.createBoundingVolume(o.boundingVolume,t,this._contentBoundingVolume)}if(n(this._viewerRequestVolume)){this._viewerRequestVolume=this.createBoundingVolume(a.viewerRequestVolume,t,this._viewerRequestVolume)}this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy();this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy();this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()};function Z(e,t,i){var a=n(e._header.content)&&n(e._header.content.boundingVolume);var o=t.debugShowBoundingVolume||t.debugShowContentBoundingVolume&&!a;if(o){if(!n(e._debugBoundingVolume)){var s=e._finalResolution?a?r.WHITE:r.RED:r.YELLOW;e._debugBoundingVolume=e._boundingVolume.createDebugVolume(s)}e._debugBoundingVolume.update(i)}else if(!o&&n(e._debugBoundingVolume)){e._debugBoundingVolume=e._debugBoundingVolume.destroy()}if(t.debugShowContentBoundingVolume&&a){if(!n(e._debugContentBoundingVolume)){e._debugContentBoundingVolume=e._contentBoundingVolume.createDebugVolume(r.BLUE)}e._debugContentBoundingVolume.update(i)}else if(!t.debugShowContentBoundingVolume&&n(e._debugContentBoundingVolume)){e._debugContentBoundingVolume=e._debugContentBoundingVolume.destroy()}if(t.debugShowViewerRequestVolume&&n(e._viewerRequestVolume)){if(!n(e._debugViewerRequestVolume)){e._debugViewerRequestVolume=e._viewerRequestVolume.createDebugVolume(r.YELLOW)}e._debugViewerRequestVolume.update(i)}else if(!t.debugShowViewerRequestVolume&&n(e._debugViewerRequestVolume)){e._debugViewerRequestVolume=e._debugViewerRequestVolume.destroy()}var l=t.debugColorizeTiles&&!e._debugColorizeTiles;var u=!t.debugColorizeTiles&&e._debugColorizeTiles;if(l){e._debugColorizeTiles=true;e.color=e._debugColor}else if(u){e._debugColorizeTiles=false;e.color=r.WHITE}if(e._colorDirty){e._colorDirty=false;e._content.applyDebugSettings(true,e._color)}if(u){t.makeStyleDirty()}}function K(e,t,r){var i=e._content;var a=e._expiredContent;if(n(a)){if(!e.contentReady){a.update(t,r);return}e._expiredContent.destroy();e._expiredContent=undefined}i.update(t,r)}M.prototype.update=function(e,t){var r=t.commandList.length;Z(this,e,t);K(this,e,t);this._commandsLength=t.commandList.length-r};var J=[];M.prototype.process=function(e,t){var r=t.commandList;t.commandList=J;this._content.update(e,t);J.length=0;t.commandList=r};M.prototype.isDestroyed=function(){return false};M.prototype.destroy=function(){this._content=this._content&&this._content.destroy();this._expiredContent=this._expiredContent&&!this._expiredContent.isDestroyed()&&this._expiredContent.destroy();this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy();this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy();this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy();return s(this)};return M});define("Scene/Cesium3DTileContent",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(e,t,r,i,n){this.featurePropertiesDirty=false}e(r.prototype,{featuresLength:{get:function(){t.throwInstantiationError()}},pointsLength:{get:function(){t.throwInstantiationError()}},trianglesLength:{get:function(){t.throwInstantiationError()}},geometryByteLength:{get:function(){t.throwInstantiationError()}},texturesByteLength:{get:function(){t.throwInstantiationError()}},batchTableByteLength:{get:function(){t.throwInstantiationError()}},innerContents:{get:function(){t.throwInstantiationError()}},readyPromise:{get:function(){t.throwInstantiationError()}},tileset:{get:function(){t.throwInstantiationError()}},tile:{get:function(){t.throwInstantiationError()}},url:{get:function(){t.throwInstantiationError()}},batchTable:{get:function(){t.throwInstantiationError()}}});r.prototype.hasProperty=function(e,r){t.throwInstantiationError()};r.prototype.getFeature=function(e){t.throwInstantiationError()};r.prototype.applyDebugSettings=function(e,r){t.throwInstantiationError()};r.prototype.applyStyle=function(e,r){t.throwInstantiationError()};r.prototype.update=function(e,r){t.throwInstantiationError()};r.prototype.isDestroyed=function(){t.throwInstantiationError()};r.prototype.destroy=function(){t.throwInstantiationError()};return r});define("Scene/Cesium3DTileOptimizations",["../Core/Cartesian3","../Core/Check","./Cesium3DTileOptimizationHint","./TileBoundingRegion","./TileOrientedBoundingBox"],function(e,t,r,i,n){"use strict";var a={};var o=new e;a.checkChildrenWithinParent=function(a){t.typeOf.object("tile",a);var s=a.children;var l=s.length;var u=a._boundingVolume;if(u instanceof n||u instanceof i){var c=u._orientedBoundingBox;a._optimChildrenWithinParent=r.USE_OPTIMIZATION;for(var d=0;d<l;++d){var f=s[d];var h=f._boundingVolume;if(!(h instanceof n||h instanceof i)){a._optimChildrenWithinParent=r.SKIP_OPTIMIZATION;break}var p=h._orientedBoundingBox;var m=e.subtract(p.center,c.center,o);var v=e.magnitude(m);e.divideByScalar(m,v,m);var g=Math.abs(c.halfAxes[0]*m.x)+Math.abs(c.halfAxes[1]*m.y)+Math.abs(c.halfAxes[2]*m.z)+Math.abs(c.halfAxes[3]*m.x)+Math.abs(c.halfAxes[4]*m.y)+Math.abs(c.halfAxes[5]*m.z)+Math.abs(c.halfAxes[6]*m.x)+Math.abs(c.halfAxes[7]*m.y)+Math.abs(c.halfAxes[8]*m.z);var _=Math.abs(p.halfAxes[0]*m.x)+Math.abs(p.halfAxes[1]*m.y)+Math.abs(p.halfAxes[2]*m.z)+Math.abs(p.halfAxes[3]*m.x)+Math.abs(p.halfAxes[4]*m.y)+Math.abs(p.halfAxes[5]*m.z)+Math.abs(p.halfAxes[6]*m.x)+Math.abs(p.halfAxes[7]*m.y)+Math.abs(p.halfAxes[8]*m.z);if(g<=_+v){a._optimChildrenWithinParent=r.SKIP_OPTIMIZATION;break}}}return a._optimChildrenWithinParent===r.USE_OPTIMIZATION};return a});define("Scene/Cesium3DTilesetStatistics",["../Core/defined"],function(e){"use strict";function t(){this.selected=0;this.visited=0;this.numberOfCommands=0;this.numberOfAttemptedRequests=0;this.numberOfPendingRequests=0;this.numberOfTilesProcessing=0;this.numberOfTilesWithContentReady=0;this.numberOfTilesTotal=0;this.numberOfFeaturesSelected=0;this.numberOfFeaturesLoaded=0;this.numberOfPointsSelected=0;this.numberOfPointsLoaded=0;this.numberOfTrianglesSelected=0;this.numberOfTilesStyled=0;this.numberOfFeaturesStyled=0;this.numberOfTilesCulledWithChildrenUnion=0;this.geometryByteLength=0;this.texturesByteLength=0;this.batchTableByteLength=0}t.prototype.clear=function(){this.selected=0;this.visited=0;this.numberOfCommands=0;this.numberOfAttemptedRequests=0;this.numberOfFeaturesSelected=0;this.numberOfPointsSelected=0;this.numberOfTrianglesSelected=0;this.numberOfTilesStyled=0;this.numberOfFeaturesStyled=0;this.numberOfTilesCulledWithChildrenUnion=0};function r(t,i,n,a){var o=i.innerContents;var s=i.pointsLength;var l=i.trianglesLength;var u=i.featuresLength;var c=i.geometryByteLength;var d=i.texturesByteLength;var f=i.batchTableByteLength;if(a){t.numberOfFeaturesLoaded+=n?-u:u;t.numberOfPointsLoaded+=n?-s:s;t.geometryByteLength+=n?-c:c;t.texturesByteLength+=n?-d:d;t.batchTableByteLength+=n?-f:f}else{t.numberOfFeaturesSelected+=n?-u:u;t.numberOfPointsSelected+=n?-s:s;t.numberOfTrianglesSelected+=n?-l:l}if(e(o)){var h=o.length;for(var p=0;p<h;++p){r(t,o[p],n,a)}}}t.prototype.incrementSelectionCounts=function(e){r(this,e,false,false)};t.prototype.incrementLoadCounts=function(e){r(this,e,false,true)};t.prototype.decrementLoadCounts=function(e){r(this,e,true,true)};t.clone=function(e,t){t.selected=e.selected;t.visited=e.visited;t.numberOfCommands=e.numberOfCommands;t.selected=e.selected;t.numberOfAttemptedRequests=e.numberOfAttemptedRequests;t.numberOfPendingRequests=e.numberOfPendingRequests;t.numberOfTilesProcessing=e.numberOfTilesProcessing;t.numberOfTilesWithContentReady=e.numberOfTilesWithContentReady;t.numberOfTilesTotal=e.numberOfTilesTotal;t.numberOfFeaturesSelected=e.numberOfFeaturesSelected;t.numberOfFeaturesLoaded=e.numberOfFeaturesLoaded;t.numberOfPointsSelected=e.numberOfPointsSelected;t.numberOfPointsLoaded=e.numberOfPointsLoaded;t.numberOfTrianglesSelected=e.numberOfTrianglesSelected;t.numberOfTilesStyled=e.numberOfTilesStyled;t.numberOfFeaturesStyled=e.numberOfFeaturesStyled;t.numberOfTilesCulledWithChildrenUnion=e.numberOfTilesCulledWithChildrenUnion;t.geometryByteLength=e.geometryByteLength;t.texturesByteLength=e.texturesByteLength;t.batchTableByteLength=e.batchTableByteLength};return t});define("Scene/Cesium3DTilesetTraversal",["../Core/CullingVolume","../Core/defined","../Core/freezeObject","../Core/Intersect","../Core/ManagedArray","../Core/Math","../Core/OrthographicFrustum","./Cesium3DTileChildrenVisibility","./Cesium3DTileRefine","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u){"use strict";var c={};function d(t,r,i){if(t.debugFreezeFrame){return}var n=t._maximumScreenSpaceError;t._desiredTiles.length=0;t._selectedTiles.length=0;t._requestedTiles.length=0;t._selectedTilesToStyle.length=0;t._hasMixedContent=false;var a=t._replacementList;a.splice(a.tail,t._replacementSentinel);var o=t._root;o.updateTransform(t._modelMatrix);if(!o.insideViewerRequestVolume(r)){return}o._distanceToCamera=o.distanceToTile(r);if(M(t,t._geometricError,o,r)<=n){return}o._visibilityPlaneMask=o.visibility(r,e.MASK_INDETERMINATE);if(o._visibilityPlaneMask===e.MASK_OUTSIDE){return}D(t,o,r);if(!t.skipLevelOfDetail){t._baseTraversal.execute(t,o,n,r,i);var s=t._baseTraversal.leaves;var l=s.length;for(var u=0;u<l;++u){t._desiredTiles.push(s.get(u))}}else if(t.immediatelyLoadDesiredLevelOfDetail){t._skipTraversal.execute(t,o,r,i)}else{t._baseTraversal.leaves=t._skipTraversal.queue1;t._baseTraversal.execute(t,o,t.baseScreenSpaceError,r,i);t._skipTraversal.execute(t,undefined,r,i)}h(t,r,i);v(t,o,r);t._desiredTiles.trim()}var f=[];function h(e,r,i){var n=e._desiredTiles;var a=n.length;for(var o=0;o<a;++o){var s=n.get(o);if(F(s)){s.selected=true;s._selectedFrame=r.frameNumber;continue}var u=s._ancestorWithLoadedContent;if(s.hasRenderableContent&&s.contentAvailable){u=s}if(t(u)){u.selected=true;u._selectedFrame=r.frameNumber}else{f.push(s);while(f.length>0){var c=f.pop();var d=c.children;var h=d.length;for(var p=0;p<h;++p){var m=d[p];A(e,m,i);if(m.contentAvailable){m.selected=true;m._finalResolution=true;m._selectedFrame=r.frameNumber}if(m._depth-s._depth<2){if(!m.contentAvailable||m.refine===l.ADD){f.push(m)}}}}}}}var p=[];var m=[];function v(e,r,i){var n=p;var a=m;var o;n.push(r);while(n.length>0||a.length>0){if(a.length>0){var s=a[a.length-1];if(s._stackLength===n.length){a.pop();if(s===o){s._finalResolution=true}g(e,s,i);continue}}var u=n.pop();if(!t(u)||!x(u,i)){continue}var c=u.selected&&u._selectedFrame===i.frameNumber&&u.hasRenderableContent;var d=u.children;var f=d.length;d.sort(_);if(c){if(u.refine===l.ADD){u._finalResolution=true;g(e,u,i)}else{u._selectionDepth=a.length;if(u._selectionDepth>0){e._hasMixedContent=true}o=u;if(f===0){u._finalResolution=true;g(e,u,i);continue}a.push(u);u._stackLength=n.length}}for(var h=0;h<f;++h){var v=d[h];n.push(v)}}}function g(t,r,n){if(r.contentAvailable&&(r._visibilityPlaneMask===e.MASK_INSIDE||r.contentVisibility(n)!==i.OUTSIDE)){t._selectedTiles.push(r);var a=r.content;if(a.featurePropertiesDirty){a.featurePropertiesDirty=false;r.lastStyleTime=0;t._selectedTilesToStyle.push(r)}else if(r._lastSelectedFrameNumber!==n.frameNumber-1||r.lastStyleTime===0){t._selectedTilesToStyle.push(r)}r._lastSelectedFrameNumber=n.frameNumber}}function _(e,t){if(t._distanceToCamera===0&&e._distanceToCamera===0){return t._centerZDepth-e._centerZDepth}return t._distanceToCamera-e._distanceToCamera}var y=r([]);function b(){this.tileset=undefined;this.frameState=undefined;this.outOfCore=undefined;this.stack=new n;this.leaves=new n;this.baseScreenSpaceError=undefined;this.internalDFS=new C}b.prototype.execute=function(e,t,r,i,n){this.tileset=e;this.frameState=i;this.outOfCore=n;this.leaves.length=0;this.baseScreenSpaceError=Math.max(r,this.tileset._maximumScreenSpaceError);this.internalDFS.tileset=this.tileset;this.internalDFS.frameState=this.frameState;this.internalDFS.outOfCore=this.outOfCore;this.internalDFS.baseScreenSpaceError=this.baseScreenSpaceError;B(t,this)};b.prototype.visitStart=function(e){if(!x(e,this.frameState)){P(this.tileset,e,this.frameState,this.outOfCore)}};b.prototype.visitEnd=function(e){e._lastVisitedFrame=this.frameState.frameNumber};b.prototype.getChildren=function(e){var t=this.tileset;var r=this.outOfCore;var i=this.frameState;if(!w(t,e,this.baseScreenSpaceError,i)){return y}var n=e.children;var a=n.length;var o=true;var s=e.refine===l.REPLACE&&e.hasRenderableContent;for(var u=0;u<a;++u){var c=n[u];D(t,c,i);A(t,c,r);if(s){if(!c.hasEmptyContent){o=o&&c.contentAvailable}else{o=o&&this.internalDFS.execute(c)}}}if(o){return n}return y};function w(e,r,i,n){if(F(r)){e._desiredTiles.push(r)}if(r.hasTilesetContent&&r.contentExpired){return false}if(r._screenSpaceError<=i&&!r.hasTilesetContent){E(r,n);return false}var a=E(r,n);var o=r.refine===l.ADD;var u=r.refine===l.REPLACE&&(a&s.VISIBLE_IN_REQUEST_VOLUME)!==0;return o||u||r.hasTilesetContent||!t(r._ancestorWithContent)}b.prototype.shouldVisit=function(e){return N(e._visibilityPlaneMask)};b.prototype.leafHandler=function(e){if(this.tileset.skipLevelOfDetail||!F(e)){if(e.refine===l.REPLACE&&!k(e)){++this.tileset._statistics.numberOfTilesCulledWithChildrenUnion;return}this.leaves.push(e)}};function C(){this.tileset=undefined;this.frameState=undefined;this.outOfCore=undefined;this.baseScreenSpaceError=undefined;this.stack=new n;this.allLoaded=undefined}C.prototype.execute=function(e){this.allLoaded=true;B(e,this);return this.allLoaded};C.prototype.visitStart=function(e){if(!x(e,this.frameState)){P(this.tileset,e,this.frameState,this.outOfCore)}};C.prototype.visitEnd=b.prototype.visitEnd;C.prototype.shouldVisit=function(e){return!e.hasRenderableContent&&N(e._visibilityPlaneMask)};C.prototype.getChildren=function(e){var t=this.tileset;var r=this.frameState;var i=this.outOfCore;if(!w(t,e,this.baseScreenSpaceError,r)){return y}var n=e.children;var a=n.length;for(var o=0;o<a;++o){var s=n[o];D(t,s,r);A(t,s,i);if(!e.contentAvailable){this.allLoaded=false}}return n};C.prototype.updateAndCheckChildren=b.prototype.updateAndCheckChildren;function S(e){this.tileset=undefined;this.frameState=undefined;this.outOfCore=undefined;this.queue1=new n;this.queue2=new n;this.internalDFS=new T(e.selectionHeuristic);this.maxChildrenLength=0;this.scratchQueue=new n}S.prototype.execute=function(e,t,r,i){this.tileset=e;this.frameState=r;this.outOfCore=i;this.internalDFS.frameState=r;this.internalDFS.outOfCore=i;this.maxChildrenLength=0;U(t,this);this.queue1.length=0;this.queue2.length=0;this.scratchQueue.length=0;this.scratchQueue.trim(this.maxChildrenLength)};S.prototype.visitStart=function(e){if(!x(e,this.frameState)){P(this.tileset,e,this.frameState,this.outOfCore)}};S.prototype.visitEnd=b.prototype.visitEnd;S.prototype.getChildren=function(e){this.scratchQueue.length=0;this.internalDFS.execute(e,this.scratchQueue);this.maxChildrenLength=Math.max(this.maxChildrenLength,this.scratchQueue.length);return this.scratchQueue};S.prototype.leafHandler=function(e){if(!F(e)&&!x(e,this.frameState)){this.tileset._desiredTiles.push(e)}};function T(e){this.selectionHeuristic=e;this.tileset=undefined;this.frameState=undefined;this.outOfCore=undefined;this.root=undefined;this.queue=undefined;this.stack=new n}T.prototype.execute=function(e,t){this.tileset=e._tileset;this.root=e;this.queue=t;B(e,this)};T.prototype.visitStart=function(e){if(!x(e,this.frameState)){P(this.tileset,e,this.frameState,this.outOfCore)}};T.prototype.visitEnd=b.prototype.visitEnd;T.prototype.getChildren=function(e){var r=this.tileset;var i=r._maximumScreenSpaceError;if(e.hasTilesetContent&&e.contentExpired){return y}if(!e.hasTilesetContent){if(F(e)){r._desiredTiles.push(e)}if(e._screenSpaceError<=i){E(e,this.frameState);return y}if(!e.hasEmptyContent&&e.contentUnloaded&&t(e._ancestorWithLoadedContent)&&this.selectionHeuristic(r,e._ancestorWithLoadedContent,e)){E(e,this.frameState);return y}}var n=E(e,this.frameState);var a=e.refine===l.ADD&&e._screenSpaceError>i;var o=e.refine===l.REPLACE&&(n&s.VISIBLE_IN_REQUEST_VOLUME)!==0;if(n&s.VISIBLE_NOT_IN_REQUEST_VOLUME&&e.refine===l.REPLACE){this.tileset._desiredTiles.push(e)}if(a||o||e.hasTilesetContent){var u=e.children;var c=u.length;for(var d=0;d<c;++d){A(r,u[d],this.outOfCore)}return u}return y};T.prototype.shouldVisit=function(e){var r=this.tileset._maximumScreenSpaceError;var i=e.parent;if(!t(i)){return N(e._visibilityPlaneMask)}var n=i.refine===l.ADD&&i._screenSpaceError>r;return N(e._visibilityPlaneMask)&&(!n||M(this.tileset,i.geometricError,e,this.frameState)>r)};T.prototype.leafHandler=function(e){if(e!==this.root){if(e.refine===l.REPLACE&&!k(e)){++this.tileset._statistics.numberOfTilesCulledWithChildrenUnion;return}if(!e.hasEmptyContent){if(this.tileset.loadSiblings){var t=e.parent;var r=t.children;var i=r.length;for(var n=0;n<i;++n){D(this.tileset,r[n],this.frameState);A(this.tileset,r[n],this.outOfCore)}}else{D(this.tileset,e,this.frameState);A(this.tileset,e,this.outOfCore)}}this.queue.push(e)}else if(!F(e)){this.tileset._desiredTiles.push(e)}};function E(e,t){if(x(e,t)){return e._childrenVisibility}var r=e.children;L(r,e.computedTransform);R(r,t);return I(e,t)}function x(e,t){return e._lastVisitedFrame===t.frameNumber}function P(e,r,i,n){++e._statistics.visited;r.selected=false;r._finalResolution=false;O(r,i);A(e,r,n);r.updateExpiration();r._ancestorWithContent=undefined;r._ancestorWithLoadedContent=undefined;var a=r.parent;if(t(a)){var o=a.refine===l.REPLACE;r._ancestorWithContent=o&&a.hasRenderableContent?a:a._ancestorWithContent;r._ancestorWithLoadedContent=o&&a.hasRenderableContent&&a.contentAvailable?a:a._ancestorWithLoadedContent}}function A(e,r,i){if(!i){return}var n=r.replacementNode;if(t(n)){e._replacementList.splice(e._replacementSentinel,n)}}function O(e,t){if(e._screenSpaceErrorComputedFrame!==t.frameNumber){e._screenSpaceErrorComputedFrame=t.frameNumber;e._screenSpaceError=M(e._tileset,e.geometricError,e,t)}}function D(e,t,r){if((t.contentUnloaded||t.contentExpired)&&t._requestedFrame!==r.frameNumber){t._requestedFrame=r.frameNumber;e._requestedTiles.push(t)}}function I(t,r){var i=s.NONE;var n=t.children;var a=n.length;var o=t._visibilityPlaneMask;for(var l=0;l<a;++l){var u=n[l];var c=u.visibility(r,o);if(N(c)){i|=s.VISIBLE}if(!u.insideViewerRequestVolume(r)){if(N(c)){i|=s.VISIBLE_NOT_IN_REQUEST_VOLUME}c=e.MASK_OUTSIDE}else{i|=s.IN_REQUEST_VOLUME;if(N(c)){i|=s.VISIBLE_IN_REQUEST_VOLUME}}u._visibilityPlaneMask=c}t._childrenVisibility=i;return i}function M(e,r,i,n){if(r===0){return 0}var s=n.camera;var l=s.frustum;var c=n.context;var d=c.drawingBufferHeight;var f;if(n.mode===u.SCENE2D||l instanceof o){if(t(l._offCenterFrustum)){l=l._offCenterFrustum}var h=c.drawingBufferWidth;var p=Math.max(l.top-l.bottom,l.right-l.left)/Math.max(h,d);f=r/p}else{var m=Math.max(i._distanceToCamera,a.EPSILON7);var v=s.frustum.sseDenominator;f=r*d/(m*v);if(e.dynamicScreenSpaceError){var g=e._dynamicScreenSpaceErrorComputedDensity;var _=e.dynamicScreenSpaceErrorFactor;var y=a.fog(m,g)*_;f-=y}}return f}function R(e,t){var r=e.length;for(var i=0;i<r;++i){var n=e[i];n._distanceToCamera=n.distanceToTile(t);n._centerZDepth=n.distanceToTileCenter(t)}}function L(e,t){var r=e.length;for(var i=0;i<r;++i){var n=e[i];n.updateTransform(t)}}function N(t){return t!==e.MASK_OUTSIDE}function k(e){return e.refine===l.ADD||e.children.length===0||e._childrenVisibility&s.VISIBLE!==0}function F(e){return e.refine===l.ADD&&e.hasRenderableContent}function B(e,r){var i=r.stack;if(t(e)&&(!t(r.shouldVisit)||r.shouldVisit(e))){i.push(e)}var n=0;while(i.length>0){n=Math.max(n,i.length);var a=i.pop();r.visitStart(a);var o=r.getChildren(a);var s=!t(o.get);var l=o.length;for(var u=0;u<l;++u){var c=s?o[u]:o.get(u);if(!t(r.shouldVisit)||r.shouldVisit(c)){i.push(c)}}if(l===0&&t(r.leafHandler)){r.leafHandler(a)}r.visitEnd(a)}i.trim(n)}function U(e,r){var i=r.queue1;var n=r.queue2;if(t(e)&&(!t(r.shouldVisit)||r.shouldVisit(e))){i.push(e)}var a=0;while(i.length>0){var o=i.length;a=Math.max(a,o);for(var s=0;s<o;++s){var l=i.get(s);r.visitStart(l);var u=r.getChildren(l);var c=!t(u.get);var d=u.length;for(var f=0;f<d;++f){var h=c?u[f]:u.get(f);if(!t(r.shouldVisit)||r.shouldVisit(h)){n.push(h)}}if(d===0&&t(r.leafHandler)){r.leafHandler(l)}r.visitEnd(l)}i.length=0;var p=i;i=n;n=p;r.queue1=i;r.queue2=n}i.length=0;n.length=0;i.trim(a);n.trim(a)}c.selectTiles=d;c.BaseTraversal=b;c.SkipTraversal=S;return c});define("Scene/Cesium3DTileStyleEngine",["../Core/defined","../Core/defineProperties"],function(e,t){"use strict";function r(){this._style=undefined;this._styleDirty=false;this._lastStyleTime=0}t(r.prototype,{style:{get:function(){return this._style},set:function(e){this._style=e;this._styleDirty=true}}});r.prototype.makeDirty=function(){this._styleDirty=true};r.prototype.applyStyle=function(t,r){if(!t.ready){return}if(e(this._style)&&!this._style.ready){return}var i=this._styleDirty;if(r.passes.render){this._styleDirty=false}if(i){++this._lastStyleTime}var n=this._lastStyleTime;var a=t._statistics;var o=i?t._selectedTiles:t._selectedTilesToStyle;var s=o.length;for(var l=0;l<s;++l){var u=o[l];if(u.selected&&u.lastStyleTime!==n){var c=u.content;u.lastStyleTime=n;c.applyStyle(r,this._style);a.numberOfFeaturesStyled+=c.featuresLength;++a.numberOfTilesStyled}}};return r});define("Scene/Cesium3DTileset",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DoublyLinkedList","../Core/Event","../Core/getBaseUri","../Core/getExtensionFromUri","../Core/Heap","../Core/isDataUri","../Core/joinUrls","../Core/JulianDate","../Core/loadJson","../Core/ManagedArray","../Core/Math","../Core/Matrix4","../Core/RuntimeError","../Renderer/ClearCommand","../Renderer/Pass","../ThirdParty/when","./Axis","./Cesium3DTile","./Cesium3DTileColorBlendMode","./Cesium3DTileOptimizations","./Cesium3DTileRefine","./Cesium3DTilesetStatistics","./Cesium3DTilesetTraversal","./Cesium3DTileStyleEngine","./LabelCollection","./SceneMode","./ShadowMode","./TileBoundingRegion","./TileBoundingSphere","./TileOrientedBoundingBox"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B){"use strict";function U(e){e=n(e,n.EMPTY_OBJECT);var t=e.url;i.typeOf.string("options.url",t);var r;var o;if(f(t)==="json"){r=t;o=d(t,true)}else if(p(t)){r=t;o=""}else{o=t;r=m(o,"tileset.json")}this._url=t;this._basePath=o;this._tilesetUrl=r;this._root=undefined;this._asset=undefined;this._properties=undefined;this._geometricError=undefined;this._gltfUpAxis=undefined;this._processingQueue=[];this._selectedTiles=[];this._requestedTiles=[];this._desiredTiles=new _;this._selectedTilesToStyle=[];this._loadTimestamp=undefined;this._timeSinceLoad=0;var s=new u;this._replacementList=s;this._replacementSentinel=s.add();this._trimTiles=false;this._cullWithChildrenBounds=n(e.cullWithChildrenBounds,true);this._hasMixedContent=false;this._baseTraversal=new I.BaseTraversal;this._skipTraversal=new I.SkipTraversal({selectionHeuristic:Y});this._backfaceCommands=new _;this._maximumScreenSpaceError=n(e.maximumScreenSpaceError,16);this._maximumMemoryUsage=n(e.maximumMemoryUsage,512);this._styleEngine=new M;this._modelMatrix=a(e.modelMatrix)?b.clone(e.modelMatrix):b.clone(b.IDENTITY);this._statistics=new D;this._statisticsLastColor=new D;this._statisticsLastPick=new D;this._tilesLoaded=false;this._tileDebugLabels=undefined;this._readyPromise=T.defer();this.dynamicScreenSpaceError=n(e.dynamicScreenSpaceError,false);this.dynamicScreenSpaceErrorDensity=.00278;this.dynamicScreenSpaceErrorFactor=4;this.dynamicScreenSpaceErrorHeightFalloff=.25;this._dynamicScreenSpaceErrorComputedDensity=0;this.shadows=n(e.shadows,N.ENABLED);this.show=n(e.show,true);this.colorBlendMode=P.HIGHLIGHT;this.colorBlendAmount=.5;this.loadProgress=new c;this.allTilesLoaded=new c;this.tileLoad=new c;this.tileUnload=new c;this.tileVisible=new c;this.skipLevelOfDetail=n(e.skipLevelOfDetail,true);this.baseScreenSpaceError=n(e.baseScreenSpaceError,1024);this.skipScreenSpaceErrorFactor=n(e.skipScreenSpaceErrorFactor,16);this.skipLevels=n(e.skipLevels,1);this.immediatelyLoadDesiredLevelOfDetail=n(e.immediatelyLoadDesiredLevelOfDetail,false);this.loadSiblings=n(e.loadSiblings,false);this.debugFreezeFrame=n(e.debugFreezeFrame,false);this.debugColorizeTiles=n(e.debugColorizeTiles,false);this.debugWireframe=n(e.debugWireframe,false);this.debugShowBoundingVolume=n(e.debugShowBoundingVolume,false);this.debugShowContentBoundingVolume=n(e.debugShowContentBoundingVolume,false);this.debugShowViewerRequestVolume=n(e.debugShowViewerRequestVolume,false);this._tileDebugLabels=undefined;this.debugPickedTileLabelOnly=false;this.debugPickedTile=undefined;this.debugPickPosition=undefined;this.debugShowGeometricError=n(e.debugShowGeometricError,false);this.debugShowRenderingStatistics=n(e.debugShowRenderingStatistics,false);this.debugShowMemoryUsage=n(e.debugShowMemoryUsage,false);this.debugShowUrl=n(e.debugShowUrl,false);var l=this;U.loadJson(r).then(function(e){l._root=l.loadTileset(r,e);var t=a(e.asset.gltfUpAxis)?E.fromName(e.asset.gltfUpAxis):E.Y;l._asset=e.asset;l._properties=e.properties;l._geometricError=e.geometricError;l._gltfUpAxis=t;l._readyPromise.resolve(l)}).otherwise(function(e){l._readyPromise.reject(e)})}o(U.prototype,{asset:{get:function(){if(!this.ready){throw new l("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.")}return this._asset}},properties:{get:function(){if(!this.ready){throw new l("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.")}return this._properties}},ready:{get:function(){return a(this._root)}},readyPromise:{get:function(){return this._readyPromise.promise}},tilesLoaded:{get:function(){return this._tilesLoaded}},url:{get:function(){return this._url}},basePath:{get:function(){return this._basePath}},style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){i.typeOf.number.greaterThanOrEquals("maximumScreenSpaceError",e,0);this._maximumScreenSpaceError=e}},maximumMemoryUsage:{get:function(){return this._maximumMemoryUsage},set:function(e){i.typeOf.number.greaterThanOrEquals("value",e,0);this._maximumMemoryUsage=e}},boundingSphere:{get:function(){if(!this.ready){throw new l("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.")}return this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=b.clone(e,this._modelMatrix);if(a(this._root)){this._root.updateTransform(this._modelMatrix)}}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},totalMemoryUsageInBytes:{get:function(){var e=this._statistics;return e.texturesByteLength+e.geometryByteLength+e.batchTableByteLength}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}}});U.loadJson=function(e){return g(e)};U.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()};U.prototype.loadTileset=function(e,t,r){var i=t.asset;if(!a(i)){throw new w("Tileset must have an asset property.")}if(i.version!=="0.0"&&i.version!=="1.0"){throw new w("The tileset must be 3D Tiles version 0.0 or 1.0.  See https://github.com/AnalyticalGraphicsInc/3d-tiles#spec-status")}var o=this._statistics;var s=/[?&]v=/.test(e);if(!s){var l="?v="+n(i.tilesetVersion,"0.0");this._basePath=m(this._basePath,l);e=m(e,l,false)}var u=d(e,true);var c=new x(this,u,t.root,r);if(a(r)){r.children.push(c);c._depth=r._depth+1}++o.numberOfTilesTotal;var f=[];f.push({header:t.root,tile3D:c});while(f.length>0){var h=f.pop();var p=h.tile3D;var v=h.header.children;if(a(v)){var g=v.length;for(var _=0;_<g;++_){var y=v[_];var b=new x(this,u,y,p);p.children.push(b);b._depth=p._depth+1;++o.numberOfTilesTotal;f.push({header:y,tile3D:b})}}if(this._cullWithChildrenBounds){A.checkChildrenWithinParent(p)}}return c};var V=new t;var z=new r;var q=new b;var G=new t;var H=new t;var j=new t;function W(e,i){var n;var a;var o;var s;var l;var u=i.camera;var c=e._root;var d=c.contentBoundingVolume;if(d instanceof k){n=t.normalize(u.positionWC,V);a=u.directionWC;o=u.positionCartographic.height;s=d.minimumHeight;l=d.maximumHeight}else{var f=b.inverseTransformation(c.computedTransform,q);var h=i.mapProjection.ellipsoid;var p=d.boundingVolume;var m=b.multiplyByPoint(f,p.center,G);if(t.magnitude(m)>h.minimumRadius){var v=r.fromCartesian(m,h,z);n=t.normalize(u.positionWC,V);a=u.directionWC;o=u.positionCartographic.height;s=0;l=v.height*2}else{var g=b.multiplyByPoint(f,u.positionWC,H);n=t.UNIT_Z;a=b.multiplyByPointAsVector(f,u.directionWC,j);a=t.normalize(a,a);o=g.z;if(d instanceof B){var _=c._header.boundingVolume.box[11];s=m.z-_;l=m.z+_}else if(d instanceof F){var w=p.radius;s=m.z-w;l=m.z+w}}}var C=e.dynamicScreenSpaceErrorHeightFalloff;var S=s+(l-s)*C;var T=l;var E=y.clamp((o-S)/(T-S),0,1);var x=Math.abs(t.dot(a,n));var P=1-x;P=P*(1-E);var A=e.dynamicScreenSpaceErrorDensity;A*=P;e._dynamicScreenSpaceErrorComputedDensity=A}function Y(e,t,r){var i=e.skipLevelOfDetail?e.skipLevels:0;var n=e.skipLevelOfDetail?e.skipScreenSpaceErrorFactor:1;return t!==r&&!r.hasEmptyContent&&!e.immediatelyLoadDesiredLevelOfDetail&&r._screenSpaceError<t._screenSpaceError/n&&r._depth>t._depth+i}function X(e,t){if(t.hasEmptyContent){return}var r=e._statistics;var i=t.contentExpired;var n=t.requestContent();if(!n){++r.numberOfAttemptedRequests;return}if(i){if(t.hasRenderableContent){r.decrementLoadCounts(t.content);--e._statistics.numberOfTilesWithContentReady}else if(t.hasTilesetContent){le(e,t)}}++r.numberOfPendingRequests;var a=K(e,t);t.contentReadyToProcessPromise.then(Z(e,t));t.contentReadyPromise.then(function(){a();e.tileLoad.raiseEvent(t)}).otherwise(a)}function Q(e,t){if(!t){return}var r=e._requestedTiles;var i=r.length;for(var n=0;n<i;++n){X(e,r[n])}}function Z(e,t){return function(){e._processingQueue.push(t);--e._statistics.numberOfPendingRequests;++e._statistics.numberOfTilesProcessing}}function K(e,t){return function(){var r=e._processingQueue.indexOf(t);if(r===-1){--e._statistics.numberOfPendingRequests;return}e._processingQueue.splice(r,1);--e._statistics.numberOfTilesProcessing;if(t.hasRenderableContent){e._statistics.incrementLoadCounts(t.content);++e._statistics.numberOfTilesWithContentReady;if(!a(t.replacementNode)){t.replacementNode=e._replacementList.add(t)}}}}function J(e,t){var r=e._processingQueue;var i=r.length;for(var n=i-1;n>=0;--n){r[n].process(e,t)}}var $=new t;var ee={maximumFractionDigits:3};function te(e){var t=e/1048576;if(t<1){return t.toLocaleString(undefined,ee)}return Math.round(t).toLocaleString()}function re(e){var r=e._boundingVolume.boundingVolume;var i=r.halfAxes;var n=r.radius;var o=t.clone(r.center,$);if(a(i)){o.x+=.75*(i[0]+i[3]+i[6]);o.y+=.75*(i[1]+i[4]+i[7]);o.z+=.75*(i[2]+i[5]+i[8])}else if(a(n)){var s=t.normalize(r.center,$);s=t.multiplyByScalar(s,.75*n,$);o=t.add(s,r.center,$)}return o}function ie(e,t,r){var i="";var n=0;if(t.debugShowGeometricError){i+="\nGeometric error: "+e.geometricError;n++}if(t.debugShowRenderingStatistics){i+="\nCommands: "+e.commandsLength;n++;var a=e.content.pointsLength;if(a>0){i+="\nPoints: "+e.content.pointsLength;n++}var o=e.content.trianglesLength;if(o>0){i+="\nTriangles: "+e.content.trianglesLength;n++}i+="\nFeatures: "+e.content.featuresLength;n++}if(t.debugShowMemoryUsage){i+="\nTexture Memory: "+te(e.content.texturesByteLength);i+="\nGeometry Memory: "+te(e.content.geometryByteLength);n+=2}if(t.debugShowUrl){i+="\nUrl: "+e._header.content.url;n++}var s={text:i.substring(1),position:r,font:19-n+"px sans-serif",showBackground:true,disableDepthTestDistance:Number.POSITIVE_INFINITY};return t._tileDebugLabels.add(s)}function ne(t,r){var i=t._selectedTiles;var n=i.length;t._tileDebugLabels.removeAll();if(t.debugPickedTileLabelOnly){if(a(t.debugPickedTile)){var o=a(t.debugPickPosition)?t.debugPickPosition:re(t.debugPickedTile);var s=ie(t.debugPickedTile,t,o);s.pixelOffset=new e(15,-15)}}else{for(var l=0;l<n;++l){var u=i[l];ie(u,t,re(u))}}t._tileDebugLabels.update(r)}var ae=new C({stencil:0,pass:S.CESIUM_3D_TILE});function oe(e,t){e._styleEngine.applyStyle(e,t);var r=e._statistics;var i=t.commandList;var n=i.length;var o=e._selectedTiles;var s=o.length;var l=e.tileVisible;var u;var c=e.skipLevelOfDetail&&e._hasMixedContent&&t.context.stencilBuffer&&s>0;e._backfaceCommands.length=0;if(c){i.push(ae)}var d=i.length;for(u=0;u<s;++u){var f=o[u];if(f.selected){l.raiseEvent(f);f.update(e,t);r.incrementSelectionCounts(f.content);++r.selected}}var h=i.length;e._backfaceCommands.trim();if(c){var p=e._backfaceCommands.values;var m=h-d;var v=p.length;i.length+=p.length;for(u=m-1;u>=0;--u){i[d+v+u]=i[d+u]}for(u=0;u<v;++u){i[d+u]=p[u]}}r.numberOfCommands=i.length-n;if(e.debugShowGeometricError||e.debugShowRenderingStatistics||e.debugShowMemoryUsage||e.debugShowUrl){if(!a(e._tileDebugLabels)){e._tileDebugLabels=new R}ne(e,t)}else{e._tileDebugLabels=e._tileDebugLabels&&e._tileDebugLabels.destroy()}}var se=[];function le(e,t){var r=t;var i=e._statistics;var n=se;n.push(t);while(n.length>0){t=n.pop();var a=t.children;var o=a.length;for(var s=0;s<o;++s){n.push(a[s])}if(t!==r){ue(e,t);t.destroy();--i.numberOfTilesTotal}}r.children=[]}function ue(e,t){var r=t.replacementNode;if(!a(r)){return}var i=e._statistics;var n=e._replacementList;var o=e.tileUnload;o.raiseEvent(t);n.remove(r);i.decrementLoadCounts(t.content);--i.numberOfTilesWithContentReady}function ce(e){var t=e._trimTiles;e._trimTiles=false;var r=e._replacementList;var i=e.totalMemoryUsageInBytes;var n=e._maximumMemoryUsage*1024*1024;var a=e._replacementSentinel;var o=r.head;while(o!==a&&(i>n||t)){var s=o.item;o=o.next;ue(e,s);s.unloadContent();i=e.totalMemoryUsageInBytes}}U.prototype.trimLoadedTiles=function(){this._trimTiles=true};function de(e,t){var r=e._statistics;var i=e._statisticsLastColor;var n=r.numberOfPendingRequests;var a=r.numberOfTilesProcessing;var o=i.numberOfPendingRequests;var s=i.numberOfTilesProcessing;var l=n!==o||a!==s;if(l){t.afterRender.push(function(){e.loadProgress.raiseEvent(n,a)})}e._tilesLoaded=r.numberOfPendingRequests===0&&r.numberOfTilesProcessing===0&&r.numberOfAttemptedRequests===0;if(l&&e._tilesLoaded){t.afterRender.push(function(){e.allTilesLoaded.raiseEvent()})}}U.prototype.update=function(e){if(e.mode===L.MORPHING){return}if(!this.show||!this.ready){return}if(!a(this._loadTimestamp)){this._loadTimestamp=v.clone(e.time)}this._timeSinceLoad=Math.max(v.secondsDifference(e.time,this._loadTimestamp)*1e3,0);var t=e.passes;var r=t.pick&&!t.render;var i=!r;var n=this._statistics;n.clear();if(i){J(this,e)}if(this.dynamicScreenSpaceError){W(this,e)}I.selectTiles(this,e,i);Q(this,i);oe(this,e);if(i){ce(this)}de(this,e);var o=r?this._statisticsLastPick:this._statisticsLastColor;D.clone(n,o)};U.prototype.isDestroyed=function(){return false};U.prototype.destroy=function(){this._tileDebugLabels=this._tileDebugLabels&&this._tileDebugLabels.destroy();if(a(this._root)){var e=se;e.push(this._root);while(e.length>0){var t=e.pop();t.destroy();var r=t.children;var i=r.length;for(var n=0;n<i;++n){e.push(r[n])}}}this._root=undefined;return s(this)};return U});define("ThirdParty/jsep",[],function(){(function(e){"use strict";var t="Compound",r="Identifier",i="MemberExpression",n="Literal",a="ThisExpression",o="CallExpression",s="UnaryExpression",l="BinaryExpression",u="LogicalExpression",c="ConditionalExpression",d="ArrayExpression",f=46,h=44,p=39,m=34,v=40,g=41,_=91,y=93,b=63,w=59,C=58,S=function(e,t){var r=new Error(e+" at character "+t);r.index=t;r.description=e;throw r},T=true,E={"-":T,"!":T,"~":T,"+":T},x={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},P=function(e){var t=0,r;for(var i in e){if((r=i.length)>t&&e.hasOwnProperty(i)){t=r}}return t},A=P(E),O=P(x),D={true:true,false:false,null:null},I="this",M=function(e){return x[e]||0},R=function(e,t,r){var i=e==="||"||e==="&&"?u:l;return{type:i,operator:e,left:t,right:r}},L=function(e){return e>=48&&e<=57},N=function(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=128&&!x[String.fromCharCode(e)]},k=function(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e>=128&&!x[String.fromCharCode(e)]},F=function(e){var l=0,u=e.charAt,T=e.charCodeAt,P=function(t){return u.call(e,t)},F=function(t){return T.call(e,t)},B=e.length,U=function(){var e=F(l);while(e===32||e===9){e=F(++l)}},V=function(){var e=q(),t,r;U();if(F(l)===b){l++;t=V();if(!t){S("Expected expression",l)}U();if(F(l)===C){l++;r=V();if(!r){S("Expected expression",l)}return{type:c,test:e,consequent:t,alternate:r}}else{S("Expected :",l)}}else{return e}},z=function(){U();var t,r=e.substr(l,O),i=r.length;while(i>0){if(x.hasOwnProperty(r)){l+=i;return r}r=r.substr(0,--i)}return false},q=function(){var e,t,r,i,n,a,o,s,u;o=G();r=z();if(!r){return o}a={value:r,prec:M(r)};s=G();if(!s){S("Expected expression after "+r,l)}n=[o,a,s];while(r=z()){i=M(r);if(i===0){break}a={value:r,prec:i};while(n.length>2&&i<=n[n.length-2].prec){s=n.pop();r=n.pop().value;o=n.pop();t=R(r,o,s);n.push(t)}t=G();if(!t){S("Expected expression after "+r,l)}n.push(a,t)}u=n.length-1;t=n[u];while(u>1){t=R(n[u-1].value,n[u-2],t);u-=2}return t},G=function(){var t,r,i;U();t=F(l);if(L(t)||t===f){return H()}else if(t===p||t===m){return j()}else if(N(t)||t===v){return X()}else if(t===_){return Z()}else{r=e.substr(l,A);i=r.length;while(i>0){if(E.hasOwnProperty(r)){l+=i;return{type:s,operator:r,argument:G(),prefix:true}}r=r.substr(0,--i)}return false}},H=function(){var e="",t,r;while(L(F(l))){e+=P(l++)}if(F(l)===f){e+=P(l++);while(L(F(l))){e+=P(l++)}}t=P(l);if(t==="e"||t==="E"){e+=P(l++);t=P(l);if(t==="+"||t==="-"){e+=P(l++)}while(L(F(l))){e+=P(l++)}if(!L(F(l-1))){S("Expected exponent ("+e+P(l)+")",l)}}r=F(l);if(N(r)){S("Variable names cannot start with a number ("+e+P(l)+")",l)}else if(r===f){S("Unexpected period",l)}return{type:n,value:parseFloat(e),raw:e}},j=function(){var e="",t=P(l++),r=false,i;while(l<B){i=P(l++);if(i===t){r=true;break}else if(i==="\\"){i=P(l++);switch(i){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+="\\"+i}}else{e+=i}}if(!r){S('Unclosed quote after "'+e+'"',l)}return{type:n,value:e,raw:t+e+t}},W=function(){var t=F(l),i=l,o;if(N(t)){l++}else{S("Unexpected "+P(l),l)}while(l<B){t=F(l);if(k(t)){l++}else{break}}o=e.slice(i,l);if(D.hasOwnProperty(o)){return{type:n,value:D[o],raw:o}}else if(o===I){return{type:a}}else{return{type:r,name:o}}},Y=function(e){var r,i=[],n,a=false;while(l<B){U();r=F(l);if(r===e){a=true;l++;break}else if(r===h){l++}else{n=V();if(!n||n.type===t){S("Expected comma",l)}i.push(n)}}if(!a){S("Expected "+String.fromCharCode(e),l)}return i},X=function(){var e,t;e=F(l);if(e===v){t=Q()}else{t=W()}U();e=F(l);while(e===f||e===_||e===v){l++;if(e===f){U();t={type:i,computed:false,object:t,property:W()}}else if(e===_){t={type:i,computed:true,object:t,property:V()};U();e=F(l);if(e!==y){S("Unclosed [",l)}l++}else if(e===v){t={type:o,arguments:Y(g),callee:t}}U();e=F(l)}return t},Q=function(){l++;var e=V();U();if(F(l)===g){l++;return e}else{S("Unclosed (",l)}},Z=function(){l++;return{type:d,elements:Y(y)}},K=[],J,$;while(l<B){J=F(l);if(J===w||J===h){l++}else{if($=V()){K.push($)}else if(l<B){S('Unexpected "'+P(l)+'"',l)}}}if(K.length===1){return K[0]}else{return{type:t,body:K}}};F.version="0.3.1";F.toString=function(){return"JavaScript Expression Parser (JSEP) v"+F.version};F.addUnaryOp=function(e){A=Math.max(e.length,A);E[e]=T;return this};F.addBinaryOp=function(e,t){O=Math.max(e.length,O);x[e]=t;return this};F.addLiteral=function(e,t){D[e]=t;return this};F.removeUnaryOp=function(e){delete E[e];if(e.length===A){A=P(E)}return this};F.removeAllUnaryOps=function(){E={};A=0;return this};F.removeBinaryOp=function(e){delete x[e];if(e.length===O){O=P(x)}return this};F.removeAllBinaryOps=function(){x={};O=0;return this};F.removeLiteral=function(e){delete D[e];return this};F.removeAllLiterals=function(){D={};return this};if(typeof exports==="undefined"){var B=e.jsep;e.jsep=F;F.noConflict=function(){if(e.jsep===F){e.jsep=B}return F}}else{if(typeof module!=="undefined"&&module.exports){exports=module.exports=F}else{exports.parse=F}}})(this);if(typeof jsep!=="undefined"){return jsep.noConflict()}});define("Scene/ExpressionNodeType",["../Core/freezeObject"],function(e){"use strict";var t={VARIABLE:0,UNARY:1,BINARY:2,TERNARY:3,CONDITIONAL:4,MEMBER:5,FUNCTION_CALL:6,ARRAY:7,REGEX:8,VARIABLE_IN_STRING:9,LITERAL_NULL:10,LITERAL_BOOLEAN:11,LITERAL_NUMBER:12,LITERAL_STRING:13,LITERAL_COLOR:14,LITERAL_VECTOR:15,LITERAL_REGEX:16,LITERAL_UNDEFINED:17,BUILTIN_VARIABLE:18};return e(t)});define("Scene/Expression",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Check","../Core/Color","../Core/defined","../Core/defineProperties","../Core/isArray","../Core/Math","../Core/RuntimeError","../ThirdParty/jsep","./ExpressionNodeType"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(e,t){i.typeOf.string("expression",e);this._expression=e;e=k(e,t);e=U(F(e));c.addBinaryOp("=~",0);c.addBinaryOp("!~",0);var r;try{r=c(e)}catch(e){throw new u(e)}this._runtimeAst=Q(this,r)}o(f.prototype,{expression:{get:function(){return this._expression}}});var h={arrayIndex:0,arrayArray:[[]],cartesian2Index:0,cartesian3Index:0,cartesian4Index:0,cartesian2Array:[new e],cartesian3Array:[new t],cartesian4Array:[new r],reset:function(){this.arrayIndex=0;this.cartesian2Index=0;this.cartesian3Index=0;this.cartesian4Index=0},getArray:function(){if(this.arrayIndex>=this.arrayArray.length){this.arrayArray.push([])}var e=this.arrayArray[this.arrayIndex++];e.length=0;return e},getCartesian2:function(){if(this.cartesian2Index>=this.cartesian2Array.length){this.cartesian2Array.push(new e)}return this.cartesian2Array[this.cartesian2Index++]},getCartesian3:function(){if(this.cartesian3Index>=this.cartesian3Array.length){this.cartesian3Array.push(new t)}return this.cartesian3Array[this.cartesian3Index++]},getCartesian4:function(){if(this.cartesian4Index>=this.cartesian4Array.length){this.cartesian4Array.push(new r)}return this.cartesian4Array[this.cartesian4Index++]}};f.prototype.evaluate=function(i,a,o){h.reset();var s=this._runtimeAst.evaluate(i,a);if(o instanceof n&&s instanceof r){return n.fromCartesian4(s,o)}if(s instanceof e||s instanceof t||s instanceof r){return s.clone(o)}return s};f.prototype.evaluateColor=function(e,t,r){h.reset();var i=this._runtimeAst.evaluate(e,t);return n.fromCartesian4(i,r)};f.prototype.getShaderFunction=function(e,t,r,i){var n=this.getShaderExpression(t,r);n=i+" "+e+"() \n"+"{ \n"+"    return "+n+"; \n"+"} \n";return n};f.prototype.getShaderExpression=function(e,t){return this._runtimeAst.getShaderExpression(e,t)};var p=["!","-","+"];var m=["+","-","*","/","%","===","!==",">",">=","<","<=","&&","||","!~","=~"];var v=/\${(.*?)}/g;var g=/\\/g;var _="@#%";var y=/@#%/g;var b=new n;var w={abs:P(Math.abs),sqrt:P(Math.sqrt),cos:P(Math.cos),sin:P(Math.sin),tan:P(Math.tan),acos:P(Math.acos),asin:P(Math.asin),atan:P(Math.atan),radians:P(l.toRadians),degrees:P(l.toDegrees),sign:P(l.sign),floor:P(Math.floor),ceil:P(Math.ceil),round:P(Math.round),exp:P(Math.exp),exp2:P(E),log:P(Math.log),log2:P(x),fract:P(T),length:D,normalize:I};var C={atan2:A(Math.atan2,false),pow:A(Math.pow,false),min:A(Math.min,true),max:A(Math.max,true),distance:M,dot:R,cross:L};var S={clamp:O(l.clamp,true),mix:O(l.lerp,true)};function T(e){return e-Math.floor(e)}function E(e){return Math.pow(2,e)}function x(e){return l.logBase(e,2)}function P(i){return function(n,a){if(typeof a==="number"){return i(a)}else if(a instanceof e){return e.fromElements(i(a.x),i(a.y),h.getCartesian2())}else if(a instanceof t){return t.fromElements(i(a.x),i(a.y),i(a.z),h.getCartesian3())}else if(a instanceof r){return r.fromElements(i(a.x),i(a.y),i(a.z),i(a.w),h.getCartesian4())}throw new u('Function "'+n+'" requires a vector or number argument. Argument is '+a+".")}}function A(i,n){return function(a,o,s){if(n&&typeof s==="number"){if(typeof o==="number"){return i(o,s)}else if(o instanceof e){return e.fromElements(i(o.x,s),i(o.y,s),h.getCartesian2())}else if(o instanceof t){return t.fromElements(i(o.x,s),i(o.y,s),i(o.z,s),h.getCartesian3())}else if(o instanceof r){return r.fromElements(i(o.x,s),i(o.y,s),i(o.z,s),i(o.w,s),h.getCartesian4())}}if(typeof o==="number"&&typeof s==="number"){return i(o,s)}else if(o instanceof e&&s instanceof e){return e.fromElements(i(o.x,s.x),i(o.y,s.y),h.getCartesian2())}else if(o instanceof t&&s instanceof t){return t.fromElements(i(o.x,s.x),i(o.y,s.y),i(o.z,s.z),h.getCartesian3())}else if(o instanceof r&&s instanceof r){return r.fromElements(i(o.x,s.x),i(o.y,s.y),i(o.z,s.z),i(o.w,s.w),h.getCartesian4())}throw new u('Function "'+a+'" requires vector or number arguments of matching types. Arguments are '+o+" and "+s+".")}}function O(i,n){return function(a,o,s,l){if(n&&typeof l==="number"){if(typeof o==="number"&&typeof s==="number"){return i(o,s,l)}else if(o instanceof e&&s instanceof e){return e.fromElements(i(o.x,s.x,l),i(o.y,s.y,l),h.getCartesian2())}else if(o instanceof t&&s instanceof t){return t.fromElements(i(o.x,s.x,l),i(o.y,s.y,l),i(o.z,s.z,l),h.getCartesian3())}else if(o instanceof r&&s instanceof r){return r.fromElements(i(o.x,s.x,l),i(o.y,s.y,l),i(o.z,s.z,l),i(o.w,s.w,l),h.getCartesian4())}}if(typeof o==="number"&&typeof s==="number"&&typeof l==="number"){return i(o,s,l)}else if(o instanceof e&&s instanceof e&&l instanceof e){return e.fromElements(i(o.x,s.x,l.x),i(o.y,s.y,l.y),h.getCartesian2())}else if(o instanceof t&&s instanceof t&&l instanceof t){return t.fromElements(i(o.x,s.x,l.x),i(o.y,s.y,l.y),i(o.z,s.z,l.z),h.getCartesian3())}else if(o instanceof r&&s instanceof r&&l instanceof r){return r.fromElements(i(o.x,s.x,l.x),i(o.y,s.y,l.y),i(o.z,s.z,l.z),i(o.w,s.w,l.w),h.getCartesian4())}throw new u('Function "'+a+'" requires vector or number arguments of matching types. Arguments are '+o+", "+s+", and "+l+".")}}function D(i,n){if(typeof n==="number"){return Math.abs(n)}else if(n instanceof e){return e.magnitude(n)}else if(n instanceof t){return t.magnitude(n)}else if(n instanceof r){return r.magnitude(n)}throw new u('Function "'+i+'" requires a vector or number argument. Argument is '+n+".")}function I(i,n){if(typeof n==="number"){return 1}else if(n instanceof e){return e.normalize(n,h.getCartesian2())}else if(n instanceof t){return t.normalize(n,h.getCartesian3())}else if(n instanceof r){return r.normalize(n,h.getCartesian4())}throw new u('Function "'+i+'" requires a vector or number argument. Argument is '+n+".")}function M(i,n,a){if(typeof n==="number"&&typeof a==="number"){return Math.abs(n-a)}else if(n instanceof e&&a instanceof e){return e.distance(n,a)}else if(n instanceof t&&a instanceof t){return t.distance(n,a)}else if(n instanceof r&&a instanceof r){return r.distance(n,a)}throw new u('Function "'+i+'" requires vector or number arguments of matching types. Arguments are '+n+" and "+a+".")}function R(i,n,a){if(typeof n==="number"&&typeof a==="number"){return n*a}else if(n instanceof e&&a instanceof e){return e.dot(n,a)}else if(n instanceof t&&a instanceof t){return t.dot(n,a)}else if(n instanceof r&&a instanceof r){return r.dot(n,a)}throw new u('Function "'+i+'" requires vector or number arguments of matching types. Arguments are '+n+" and "+a+".")}function L(e,r,i){if(r instanceof t&&i instanceof t){return t.cross(r,i,h.getCartesian3())}throw new u('Function "'+e+'" requires vec3 arguments. Arguments are '+r+" and "+i+".")}function N(e,t,r,i,n){this._type=e;this._value=t;this._left=r;this._right=i;this._test=n;this.evaluate=undefined;Z(this)}function k(e,t){if(!a(t)){return e}for(var r in t){if(t.hasOwnProperty(r)){var i=new RegExp("\\$\\{"+r+"\\}","g");var n="("+t[r]+")";if(a(n)){e=e.replace(i,n)}}}return e}function F(e){return e.replace(g,_)}function B(e){return e.replace(y,"\\")}function U(e){var t=e;var r="";var i=t.indexOf("${");while(i>=0){var n=t.indexOf("'");var a=t.indexOf('"');var o;if(n>=0&&n<i){o=t.indexOf("'",n+1);r+=t.substr(0,o+1);t=t.substr(o+1);i=t.indexOf("${")}else if(a>=0&&a<i){o=t.indexOf('"',a+1);r+=t.substr(0,o+1);t=t.substr(o+1);i=t.indexOf("${")}else{r+=t.substr(0,i);var s=t.indexOf("}");if(s<0){throw new u("Unmatched {.")}r+="czm_"+t.substr(i+2,s-(i+2));t=t.substr(s+1);i=t.indexOf("${")}}r+=t;return r}function V(e){var t=typeof e.value;if(e.value===null){return new N(d.LITERAL_NULL,null)}else if(t==="boolean"){return new N(d.LITERAL_BOOLEAN,e.value)}else if(t==="number"){return new N(d.LITERAL_NUMBER,e.value)}else if(t==="string"){if(e.value.indexOf("${")>=0){return new N(d.VARIABLE_IN_STRING,e.value)}return new N(d.LITERAL_STRING,B(e.value))}}function z(e,t){var r=t.arguments;var i=r.length;var n;var o,s,l;if(t.callee.type==="MemberExpression"){n=t.callee.property.name;var c=t.callee.object;if(n==="test"||n==="exec"){if(c.callee.name!=="regExp"){throw new u(n+" is not a function.")}if(i===0){if(n==="test"){return new N(d.LITERAL_BOOLEAN,false)}return new N(d.LITERAL_NULL,null)}s=Q(e,c);l=Q(e,r[0]);return new N(d.FUNCTION_CALL,n,s,l)}else if(n==="toString"){o=Q(e,c);return new N(d.FUNCTION_CALL,n,o)}throw new u('Unexpected function call "'+n+'".')}n=t.callee.name;if(n==="color"){if(i===0){return new N(d.LITERAL_COLOR,n)}o=Q(e,r[0]);if(a(r[1])){var f=Q(e,r[1]);return new N(d.LITERAL_COLOR,n,[o,f])}return new N(d.LITERAL_COLOR,n,[o])}else if(n==="rgb"||n==="hsl"){if(i<3){throw new u(n+" requires three arguments.")}o=[Q(e,r[0]),Q(e,r[1]),Q(e,r[2])];return new N(d.LITERAL_COLOR,n,o)}else if(n==="rgba"||n==="hsla"){if(i<4){throw new u(n+" requires four arguments.")}o=[Q(e,r[0]),Q(e,r[1]),Q(e,r[2]),Q(e,r[3])];return new N(d.LITERAL_COLOR,n,o)}else if(n==="vec2"||n==="vec3"||n==="vec4"){o=new Array(i);for(var h=0;h<i;++h){o[h]=Q(e,r[h])}return new N(d.LITERAL_VECTOR,n,o)}else if(n==="isNaN"||n==="isFinite"){if(i===0){if(n==="isNaN"){return new N(d.LITERAL_BOOLEAN,true)}return new N(d.LITERAL_BOOLEAN,false)}o=Q(e,r[0]);return new N(d.UNARY,n,o)}else if(n==="isExactClass"||n==="isClass"){if(i<1||i>1){throw new u(n+" requires exactly one argument.")}o=Q(e,r[0]);return new N(d.UNARY,n,o)}else if(n==="getExactClassName"){if(i>0){throw new u(n+" does not take any argument.")}return new N(d.UNARY,n)}else if(a(w[n])){if(i!==1){throw new u(n+" requires exactly one argument.")}o=Q(e,r[0]);return new N(d.UNARY,n,o)}else if(a(C[n])){if(i!==2){throw new u(n+" requires exactly two arguments.")}s=Q(e,r[0]);l=Q(e,r[1]);return new N(d.BINARY,n,s,l)}else if(a(S[n])){if(i!==3){throw new u(n+" requires exactly three arguments.")}s=Q(e,r[0]);l=Q(e,r[1]);var p=Q(e,r[2]);return new N(d.TERNARY,n,s,l,p)}else if(n==="Boolean"){if(i===0){return new N(d.LITERAL_BOOLEAN,false)}o=Q(e,r[0]);return new N(d.UNARY,n,o)}else if(n==="Number"){if(i===0){return new N(d.LITERAL_NUMBER,0)}o=Q(e,r[0]);return new N(d.UNARY,n,o)}else if(n==="String"){if(i===0){return new N(d.LITERAL_STRING,"")}o=Q(e,r[0]);return new N(d.UNARY,n,o)}else if(n==="regExp"){return q(e,t)}throw new u('Unexpected function call "'+n+'".')}function q(e,t){var r=t.arguments;if(r.length===0){return new N(d.LITERAL_REGEX,new RegExp)}var i=Q(e,r[0]);var n;if(r.length>1){var a=Q(e,r[1]);if(W(i)&&W(a)){try{n=new RegExp(B(String(i._value)),a._value)}catch(e){throw new u(e)}return new N(d.LITERAL_REGEX,n)}return new N(d.REGEX,i,a)}if(W(i)){try{n=new RegExp(B(String(i._value)))}catch(e){throw new u(e)}return new N(d.LITERAL_REGEX,n)}return new N(d.REGEX,i)}function G(e){if(Y(e.name)){var t=X(e.name);if(t.substr(0,8)==="tiles3d_"){return new N(d.BUILTIN_VARIABLE,t)}return new N(d.VARIABLE,t)}else if(e.name==="NaN"){return new N(d.LITERAL_NUMBER,NaN)}else if(e.name==="Infinity"){return new N(d.LITERAL_NUMBER,Infinity)}else if(e.name==="undefined"){return new N(d.LITERAL_UNDEFINED,undefined)}throw new u(e.name+" is not defined.")}function H(e){var t=e.property.name;if(t==="PI"){return new N(d.LITERAL_NUMBER,Math.PI)}else if(t==="E"){return new N(d.LITERAL_NUMBER,Math.E)}}function j(e,t){if(t.object.name==="Math"){return H(t)}var r;var i=Q(e,t.object);if(t.computed){r=Q(e,t.property);return new N(d.MEMBER,"brackets",i,r)}r=new N(d.LITERAL_STRING,t.property.name);return new N(d.MEMBER,"dot",i,r)}function W(e){return e._type>=d.LITERAL_NULL}function Y(e){return e.substr(0,4)==="czm_"}function X(e){return e.substr(4)}function Q(e,t){var r;var i;var n;var a;if(t.type==="Literal"){r=V(t)}else if(t.type==="CallExpression"){r=z(e,t)}else if(t.type==="Identifier"){r=G(t)}else if(t.type==="UnaryExpression"){i=t.operator;var o=Q(e,t.argument);if(p.indexOf(i)>-1){r=new N(d.UNARY,i,o)}else{throw new u('Unexpected operator "'+i+'".')}}else if(t.type==="BinaryExpression"){i=t.operator;n=Q(e,t.left);a=Q(e,t.right);if(m.indexOf(i)>-1){r=new N(d.BINARY,i,n,a)}else{throw new u('Unexpected operator "'+i+'".')}}else if(t.type==="LogicalExpression"){i=t.operator;n=Q(e,t.left);a=Q(e,t.right);if(m.indexOf(i)>-1){r=new N(d.BINARY,i,n,a)}}else if(t.type==="ConditionalExpression"){var s=Q(e,t.test);n=Q(e,t.consequent);a=Q(e,t.alternate);r=new N(d.CONDITIONAL,"?",n,a,s)}else if(t.type==="MemberExpression"){r=j(e,t)}else if(t.type==="ArrayExpression"){var l=[];for(var c=0;c<t.elements.length;c++){l[c]=Q(e,t.elements[c])}r=new N(d.ARRAY,l)}else if(t.type==="Compound"){throw new u("Provide exactly one expression.")}else{throw new u("Cannot parse expression.")}return r}function Z(e){if(e._type===d.CONDITIONAL){e.evaluate=e._evaluateConditional}else if(e._type===d.FUNCTION_CALL){if(e._value==="test"){e.evaluate=e._evaluateRegExpTest}else if(e._value==="exec"){e.evaluate=e._evaluateRegExpExec}else if(e._value==="toString"){e.evaluate=e._evaluateToString}}else if(e._type===d.UNARY){if(e._value==="!"){e.evaluate=e._evaluateNot}else if(e._value==="-"){e.evaluate=e._evaluateNegative}else if(e._value==="+"){e.evaluate=e._evaluatePositive}else if(e._value==="isNaN"){e.evaluate=e._evaluateNaN}else if(e._value==="isFinite"){e.evaluate=e._evaluateIsFinite}else if(e._value==="isExactClass"){e.evaluate=e._evaluateIsExactClass}else if(e._value==="isClass"){e.evaluate=e._evaluateIsClass}else if(e._value==="getExactClassName"){e.evaluate=e._evaluategetExactClassName}else if(e._value==="Boolean"){e.evaluate=e._evaluateBooleanConversion}else if(e._value==="Number"){e.evaluate=e._evaluateNumberConversion}else if(e._value==="String"){e.evaluate=e._evaluateStringConversion}else if(a(w[e._value])){e.evaluate=J(e._value)}}else if(e._type===d.BINARY){if(e._value==="+"){e.evaluate=e._evaluatePlus}else if(e._value==="-"){e.evaluate=e._evaluateMinus}else if(e._value==="*"){e.evaluate=e._evaluateTimes}else if(e._value==="/"){e.evaluate=e._evaluateDivide}else if(e._value==="%"){e.evaluate=e._evaluateMod}else if(e._value==="==="){e.evaluate=e._evaluateEqualsStrict}else if(e._value==="!=="){e.evaluate=e._evaluateNotEqualsStrict}else if(e._value==="<"){e.evaluate=e._evaluateLessThan}else if(e._value==="<="){e.evaluate=e._evaluateLessThanOrEquals}else if(e._value===">"){e.evaluate=e._evaluateGreaterThan}else if(e._value===">="){e.evaluate=e._evaluateGreaterThanOrEquals}else if(e._value==="&&"){e.evaluate=e._evaluateAnd}else if(e._value==="||"){e.evaluate=e._evaluateOr}else if(e._value==="=~"){e.evaluate=e._evaluateRegExpMatch}else if(e._value==="!~"){e.evaluate=e._evaluateRegExpNotMatch}else if(a(C[e._value])){e.evaluate=$(e._value)}}else if(e._type===d.TERNARY){e.evaluate=ee(e._value)}else if(e._type===d.MEMBER){if(e._value==="brackets"){e.evaluate=e._evaluateMemberBrackets}else{e.evaluate=e._evaluateMemberDot}}else if(e._type===d.ARRAY){e.evaluate=e._evaluateArray}else if(e._type===d.VARIABLE){e.evaluate=e._evaluateVariable}else if(e._type===d.VARIABLE_IN_STRING){e.evaluate=e._evaluateVariableString}else if(e._type===d.LITERAL_COLOR){e.evaluate=e._evaluateLiteralColor}else if(e._type===d.LITERAL_VECTOR){e.evaluate=e._evaluateLiteralVector}else if(e._type===d.LITERAL_STRING){e.evaluate=e._evaluateLiteralString}else if(e._type===d.REGEX){e.evaluate=e._evaluateRegExp}else if(e._type===d.BUILTIN_VARIABLE){if(e._value==="tiles3d_tileset_time"){e.evaluate=K}}else{e.evaluate=e._evaluateLiteral}}function K(e,t){return t.content.tileset.timeSinceLoad}function J(e){var t=w[e];return function(r,i){var n=this._left.evaluate(r,i);return t(e,n)}}function $(e){var t=C[e];return function(r,i){var n=this._left.evaluate(r,i);var a=this._right.evaluate(r,i);return t(e,n,a)}}function ee(e){var t=S[e];return function(r,i){var n=this._left.evaluate(r,i);var a=this._right.evaluate(r,i);var o=this._test.evaluate(r,i);return t(e,n,a,o)}}N.prototype._evaluateLiteral=function(e,t){return this._value};N.prototype._evaluateLiteralColor=function(e,t){var i=b;var o=this._left;if(this._value==="color"){if(!a(o)){n.fromBytes(255,255,255,255,i)}else if(o.length>1){n.fromCssColorString(o[0].evaluate(e,t),i);i.alpha=o[1].evaluate(e,t)}else{n.fromCssColorString(o[0].evaluate(e,t),i)}}else if(this._value==="rgb"){n.fromBytes(o[0].evaluate(e,t),o[1].evaluate(e,t),o[2].evaluate(e,t),255,i)}else if(this._value==="rgba"){var s=o[3].evaluate(e,t)*255;n.fromBytes(o[0].evaluate(e,t),o[1].evaluate(e,t),o[2].evaluate(e,t),s,i)}else if(this._value==="hsl"){n.fromHsl(o[0].evaluate(e,t),o[1].evaluate(e,t),o[2].evaluate(e,t),1,i)}else if(this._value==="hsla"){n.fromHsl(o[0].evaluate(e,t),o[1].evaluate(e,t),o[2].evaluate(e,t),o[3].evaluate(e,t),i)}return r.fromColor(i,h.getCartesian4())};N.prototype._evaluateLiteralVector=function(i,n){var a=h.getArray();var o=this._value;var s=this._left;var l=s.length;for(var c=0;c<l;++c){var d=s[c].evaluate(i,n);if(typeof d==="number"){a.push(d)}else if(d instanceof e){a.push(d.x,d.y)}else if(d instanceof t){a.push(d.x,d.y,d.z)}else if(d instanceof r){a.push(d.x,d.y,d.z,d.w)}else{throw new u(o+" argument must be a vector or number. Argument is "+d+".")}}var f=a.length;var p=parseInt(o.charAt(3));if(f===0){throw new u("Invalid "+o+" constructor. No valid arguments.")}else if(f<p&&f>1){throw new u("Invalid "+o+" constructor. Not enough arguments.")}else if(f>p&&l>1){throw new u("Invalid "+o+" constructor. Too many arguments.")}if(f===1){var m=a[0];a.push(m,m,m)}if(o==="vec2"){return e.fromArray(a,0,h.getCartesian2())}else if(o==="vec3"){return t.fromArray(a,0,h.getCartesian3())}else if(o==="vec4"){return r.fromArray(a,0,h.getCartesian4())}};N.prototype._evaluateLiteralString=function(e,t){return this._value};N.prototype._evaluateVariableString=function(e,t){var r=this._value;var i=v.exec(r);while(i!==null){var n=i[0];var o=i[1];var s=t.getProperty(o);if(!a(s)){s=""}r=r.replace(n,s);i=v.exec(r)}return r};N.prototype._evaluateVariable=function(e,t){return t.getProperty(this._value)};function te(e){return e._value==="feature"}N.prototype._evaluateMemberDot=function(i,n){if(te(this._left)){return n.getProperty(this._right.evaluate(i,n))}var o=this._left.evaluate(i,n);if(!a(o)){return undefined}var s=this._right.evaluate(i,n);if(o instanceof e||o instanceof t||o instanceof r){if(s==="r"){return o.x}else if(s==="g"){return o.y}else if(s==="b"){return o.z}else if(s==="a"){return o.w}}return o[s]};N.prototype._evaluateMemberBrackets=function(i,n){if(te(this._left)){return n.getProperty(this._right.evaluate(i,n))}var o=this._left.evaluate(i,n);if(!a(o)){return undefined}var s=this._right.evaluate(i,n);if(o instanceof e||o instanceof t||o instanceof r){if(s===0||s==="r"){return o.x}else if(s===1||s==="g"){return o.y}else if(s===2||s==="b"){return o.z}else if(s===3||s==="a"){return o.w}}return o[s]};N.prototype._evaluateArray=function(e,t){var r=[];for(var i=0;i<this._value.length;i++){r[i]=this._value[i].evaluate(e,t)}return r};N.prototype._evaluateNot=function(e,t){var r=this._left.evaluate(e,t);if(typeof r!=="boolean"){throw new u('Operator "!" requires a boolean argument. Argument is '+r+".")}return!r};N.prototype._evaluateNegative=function(i,n){var a=this._left.evaluate(i,n);if(a instanceof e){return e.negate(a,h.getCartesian2())}else if(a instanceof t){return t.negate(a,h.getCartesian3())}else if(a instanceof r){return r.negate(a,h.getCartesian4())}else if(typeof a==="number"){return-a}throw new u('Operator "-" requires a vector or number argument. Argument is '+a+".")};N.prototype._evaluatePositive=function(i,n){var a=this._left.evaluate(i,n);if(!(a instanceof e||a instanceof t||a instanceof r||typeof a==="number")){throw new u('Operator "+" requires a vector or number argument. Argument is '+a+".")}return a};N.prototype._evaluateLessThan=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(typeof r!=="number"||typeof i!=="number"){throw new u('Operator "<" requires number arguments. Arguments are '+r+" and "+i+".")}return r<i};N.prototype._evaluateLessThanOrEquals=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(typeof r!=="number"||typeof i!=="number"){throw new u('Operator "<=" requires number arguments. Arguments are '+r+" and "+i+".")}return r<=i};N.prototype._evaluateGreaterThan=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(typeof r!=="number"||typeof i!=="number"){throw new u('Operator ">" requires number arguments. Arguments are '+r+" and "+i+".")}return r>i};N.prototype._evaluateGreaterThanOrEquals=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(typeof r!=="number"||typeof i!=="number"){throw new u('Operator ">=" requires number arguments. Arguments are '+r+" and "+i+".")}return r>=i};N.prototype._evaluateOr=function(e,t){var r=this._left.evaluate(e,t);if(typeof r!=="boolean"){throw new u('Operator "||" requires boolean arguments. First argument is '+r+".")}if(r){return true}var i=this._right.evaluate(e,t);if(typeof i!=="boolean"){throw new u('Operator "||" requires boolean arguments. Second argument is '+i+".")}return r||i};N.prototype._evaluateAnd=function(e,t){var r=this._left.evaluate(e,t);if(typeof r!=="boolean"){throw new u('Operator "&&" requires boolean arguments. First argument is '+r+".")}if(!r){return false}var i=this._right.evaluate(e,t);if(typeof i!=="boolean"){throw new u('Operator "&&" requires boolean arguments. Second argument is '+i+".")}return r&&i};N.prototype._evaluatePlus=function(i,n){var a=this._left.evaluate(i,n);var o=this._right.evaluate(i,n);if(o instanceof e&&a instanceof e){return e.add(a,o,h.getCartesian2())}else if(o instanceof t&&a instanceof t){return t.add(a,o,h.getCartesian3())}else if(o instanceof r&&a instanceof r){return r.add(a,o,h.getCartesian4())}else if(typeof a==="string"||typeof o==="string"){return a+o}else if(typeof a==="number"&&typeof o==="number"){return a+o}throw new u('Operator "+" requires vector or number arguments of matching types, or at least one string argument. Arguments are '+a+" and "+o+".")};N.prototype._evaluateMinus=function(i,n){var a=this._left.evaluate(i,n);var o=this._right.evaluate(i,n);if(o instanceof e&&a instanceof e){return e.subtract(a,o,h.getCartesian2())}else if(o instanceof t&&a instanceof t){return t.subtract(a,o,h.getCartesian3())}else if(o instanceof r&&a instanceof r){return r.subtract(a,o,h.getCartesian4())}else if(typeof a==="number"&&typeof o==="number"){return a-o}throw new u('Operator "-" requires vector or number arguments of matching types. Arguments are '+a+" and "+o+".")};N.prototype._evaluateTimes=function(i,n){var a=this._left.evaluate(i,n);var o=this._right.evaluate(i,n);if(o instanceof e&&a instanceof e){return e.multiplyComponents(a,o,h.getCartesian2())}else if(o instanceof e&&typeof a==="number"){return e.multiplyByScalar(o,a,h.getCartesian2())}else if(a instanceof e&&typeof o==="number"){return e.multiplyByScalar(a,o,h.getCartesian2())}else if(o instanceof t&&a instanceof t){return t.multiplyComponents(a,o,h.getCartesian3())}else if(o instanceof t&&typeof a==="number"){return t.multiplyByScalar(o,a,h.getCartesian3())}else if(a instanceof t&&typeof o==="number"){return t.multiplyByScalar(a,o,h.getCartesian3())}else if(o instanceof r&&a instanceof r){return r.multiplyComponents(a,o,h.getCartesian4())}else if(o instanceof r&&typeof a==="number"){return r.multiplyByScalar(o,a,h.getCartesian4())}else if(a instanceof r&&typeof o==="number"){return r.multiplyByScalar(a,o,h.getCartesian4())}else if(typeof a==="number"&&typeof o==="number"){return a*o}throw new u('Operator "*" requires vector or number arguments. If both arguments are vectors they must be matching types. Arguments are '+a+" and "+o+".")};N.prototype._evaluateDivide=function(i,n){var a=this._left.evaluate(i,n);var o=this._right.evaluate(i,n);if(o instanceof e&&a instanceof e){return e.divideComponents(a,o,h.getCartesian2())}else if(a instanceof e&&typeof o==="number"){return e.divideByScalar(a,o,h.getCartesian2())}else if(o instanceof t&&a instanceof t){return t.divideComponents(a,o,h.getCartesian3())}else if(a instanceof t&&typeof o==="number"){return t.divideByScalar(a,o,h.getCartesian3())}else if(o instanceof r&&a instanceof r){return r.divideComponents(a,o,h.getCartesian4())}else if(a instanceof r&&typeof o==="number"){return r.divideByScalar(a,o,h.getCartesian4())}else if(typeof a==="number"&&typeof o==="number"){return a/o}throw new u('Operator "/" requires vector or number arguments of matching types, or a number as the second argument. Arguments are '+a+" and "+o+".")};N.prototype._evaluateMod=function(i,n){var a=this._left.evaluate(i,n);var o=this._right.evaluate(i,n);if(o instanceof e&&a instanceof e){return e.fromElements(a.x%o.x,a.y%o.y,h.getCartesian2())}else if(o instanceof t&&a instanceof t){return t.fromElements(a.x%o.x,a.y%o.y,a.z%o.z,h.getCartesian3())}else if(o instanceof r&&a instanceof r){return r.fromElements(a.x%o.x,a.y%o.y,a.z%o.z,a.w%o.w,h.getCartesian4())}else if(typeof a==="number"&&typeof o==="number"){return a%o}throw new u('Operator "%" requires vector or number arguments of matching types. Arguments are '+a+" and "+o+".")};N.prototype._evaluateEqualsStrict=function(i,n){var a=this._left.evaluate(i,n);var o=this._right.evaluate(i,n);if(o instanceof e&&a instanceof e||o instanceof t&&a instanceof t||o instanceof r&&a instanceof r){return a.equals(o)}return a===o};N.prototype._evaluateNotEqualsStrict=function(i,n){var a=this._left.evaluate(i,n);var o=this._right.evaluate(i,n);if(o instanceof e&&a instanceof e||o instanceof t&&a instanceof t||o instanceof r&&a instanceof r){return!a.equals(o)}return a!==o};N.prototype._evaluateConditional=function(e,t){var r=this._test.evaluate(e,t);if(typeof r!=="boolean"){throw new u("Conditional argument of conditional expression must be a boolean. Argument is "+r+".")}if(r){return this._left.evaluate(e,t)}return this._right.evaluate(e,t)};N.prototype._evaluateNaN=function(e,t){return isNaN(this._left.evaluate(e,t))};N.prototype._evaluateIsFinite=function(e,t){return isFinite(this._left.evaluate(e,t))};N.prototype._evaluateIsExactClass=function(e,t){return t.isExactClass(this._left.evaluate(e,t))};N.prototype._evaluateIsClass=function(e,t){return t.isClass(this._left.evaluate(e,t))};N.prototype._evaluategetExactClassName=function(e,t){return t.getExactClassName()};N.prototype._evaluateBooleanConversion=function(e,t){return Boolean(this._left.evaluate(e,t))};N.prototype._evaluateNumberConversion=function(e,t){return Number(this._left.evaluate(e,t))};N.prototype._evaluateStringConversion=function(e,t){return String(this._left.evaluate(e,t))};N.prototype._evaluateRegExp=function(e,t){var r=this._value.evaluate(e,t);var i="";if(a(this._left)){i=this._left.evaluate(e,t)}var n;try{n=new RegExp(r,i)}catch(e){throw new u(e)}return n};N.prototype._evaluateRegExpTest=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(!(r instanceof RegExp&&typeof i==="string")){throw new u("RegExp.test requires the first argument to be a RegExp and the second argument to be a string. Arguments are "+r+" and "+i+".")}return r.test(i)};N.prototype._evaluateRegExpMatch=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(r instanceof RegExp&&typeof i==="string"){return r.test(i)}else if(i instanceof RegExp&&typeof r==="string"){return i.test(r)}throw new u('Operator "=~" requires one RegExp argument and one string argument. Arguments are '+r+" and "+i+".")};N.prototype._evaluateRegExpNotMatch=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(r instanceof RegExp&&typeof i==="string"){return!r.test(i)}else if(i instanceof RegExp&&typeof r==="string"){return!i.test(r)}throw new u('Operator "!~" requires one RegExp argument and one string argument. Arguments are '+r+" and "+i+".")};N.prototype._evaluateRegExpExec=function(e,t){var r=this._left.evaluate(e,t);var i=this._right.evaluate(e,t);if(!(r instanceof RegExp&&typeof i==="string")){throw new u("RegExp.exec requires the first argument to be a RegExp and the second argument to be a string. Arguments are "+r+" and "+i+".")}var n=r.exec(i);if(!a(n)){return null}return n[1]};N.prototype._evaluateToString=function(i,n){var a=this._left.evaluate(i,n);if(a instanceof RegExp||a instanceof e||a instanceof t||a instanceof r){return String(a)}throw new u('Unexpected function call "'+this._value+'".')};function re(e){var t=e._left;var r=t.length;for(var i=0;i<r;++i){if(t[i]._type!==d.LITERAL_NUMBER){return undefined}}var a=t[0]._value;var o=t[1]._value;var s=t[2]._value;var l=r===4?t[3]._value:1;return n.fromHsl(a,o,s,l,b)}function ie(e){var t=e._left;var r=t.length;for(var i=0;i<r;++i){if(t[i]._type!==d.LITERAL_NUMBER){return undefined}}var n=b;n.red=t[0]._value/255;n.green=t[1]._value/255;n.blue=t[2]._value/255;n.alpha=r===4?t[3]._value:1;return n}function ne(e){if(e%1===0){return e.toFixed(1)}return e.toString()}function ae(e){var t=ne(e.red);var r=ne(e.green);var i=ne(e.blue);return"vec3("+t+", "+r+", "+i+")"}function oe(e){var t=ne(e.red);var r=ne(e.green);var i=ne(e.blue);var n=ne(e.alpha);return"vec4("+t+", "+r+", "+i+", "+n+")"}function se(e,t,r,i){var n=e.length;var a=new Array(n);for(var o=0;o<n;++o){a[o]=e[o].getShaderExpression(t,r,i)}return a}N.prototype.getShaderExpression=function(e,t,r){var i;var o;var l;var c;var f=this._type;var h=this._value;if(a(this._left)){if(s(this._left)){o=se(this._left,e,t,this)}else{o=this._left.getShaderExpression(e,t,this)}}if(a(this._right)){l=this._right.getShaderExpression(e,t,this)}if(a(this._test)){c=this._test.getShaderExpression(e,t,this)}if(s(this._value)){h=se(this._value,e,t,this)}switch(f){case d.VARIABLE:return e+h;case d.UNARY:if(h==="Boolean"){return"bool("+o+")"}else if(h==="Number"){return"float("+o+")"}else if(h==="round"){return"floor("+o+" + 0.5)"}else if(a(w[h])){return h+"("+o+")"}else if(h==="isNaN"||h==="isFinite"||h==="String"||h==="isExactClass"||h==="isClass"||h==="getExactClassName"){throw new u('Error generating style shader: "'+h+'" is not supported.')}else if(a(w[h])){return h+"("+o+")"}return h+o;case d.BINARY:if(h==="%"){return"mod("+o+", "+l+")"}else if(h==="==="){return"("+o+" == "+l+")"}else if(h==="!=="){return"("+o+" != "+l+")"}else if(h==="atan2"){return"atan("+o+", "+l+")"}else if(a(C[h])){return h+"("+o+", "+l+")"}return"("+o+" "+h+" "+l+")";case d.TERNARY:if(a(S[h])){return h+"("+o+", "+l+", "+c+")"}break;case d.CONDITIONAL:return"("+c+" ? "+o+" : "+l+")";case d.MEMBER:if(l==="r"||l==="x"||l==="0.0"){return o+"[0]"}else if(l==="g"||l==="y"||l==="1.0"){return o+"[1]"}else if(l==="b"||l==="z"||l==="2.0"){return o+"[2]"}else if(l==="a"||l==="w"||l==="3.0"){return o+"[3]"}return o+"[int("+l+")]";case d.FUNCTION_CALL:throw new u('Error generating style shader: "'+h+'" is not supported.');case d.ARRAY:if(h.length===4){return"vec4("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"}else if(h.length===3){return"vec3("+h[0]+", "+h[1]+", "+h[2]+")"}else if(h.length===2){return"vec2("+h[0]+", "+h[1]+")"}throw new u("Error generating style shader: Invalid array length. Array length should be 2, 3, or 4.");case d.REGEX:throw new u("Error generating style shader: Regular expressions are not supported.");case d.VARIABLE_IN_STRING:throw new u("Error generating style shader: Converting a variable to a string is not supported.");case d.LITERAL_NULL:throw new u("Error generating style shader: null is not supported.");case d.LITERAL_BOOLEAN:return h?"true":"false";case d.LITERAL_NUMBER:return ne(h);case d.LITERAL_STRING:if(a(r)&&r._type===d.MEMBER){if(h==="r"||h==="g"||h==="b"||h==="a"||h==="x"||h==="y"||h==="z"||h==="w"){return h}}i=n.fromCssColorString(h,b);if(a(i)){return ae(i)}throw new u("Error generating style shader: String literals are not supported.");case d.LITERAL_COLOR:var p=o;if(h==="color"){if(!a(p)){return"vec4(1.0)"}else if(p.length>1){var m=p[0];var v=p[1];if(v!=="1.0"){t.translucent=true}return"vec4("+m+", "+v+")"}return"vec4("+p[0]+", 1.0)"}else if(h==="rgb"){i=ie(this);if(a(i)){return oe(i)}return"vec4("+p[0]+" / 255.0, "+p[1]+" / 255.0, "+p[2]+" / 255.0, 1.0)"}else if(h==="rgba"){if(p[3]!=="1.0"){t.translucent=true}i=ie(this);if(a(i)){return oe(i)}return"vec4("+p[0]+" / 255.0, "+p[1]+" / 255.0, "+p[2]+" / 255.0, "+p[3]+")"}else if(h==="hsl"){i=re(this);if(a(i)){return oe(i)}return"vec4(czm_HSLToRGB(vec3("+p[0]+", "+p[1]+", "+p[2]+")), 1.0)"}else if(h==="hsla"){i=re(this);if(a(i)){if(i.alpha!==1){t.translucent=true}return oe(i)}if(p[3]!=="1.0"){t.translucent=true}return"vec4(czm_HSLToRGB(vec3("+p[0]+", "+p[1]+", "+p[2]+")), "+p[3]+")"}break;case d.LITERAL_VECTOR:var g=o.length;var _=h+"(";for(var y=0;y<g;++y){_+=o[y];if(y<g-1){_+=", "}}_+=")";return _;case d.LITERAL_REGEX:throw new u("Error generating style shader: Regular expressions are not supported.");case d.LITERAL_UNDEFINED:throw new u("Error generating style shader: undefined is not supported.");case d.BUILTIN_VARIABLE:if(h==="tiles3d_tileset_time"){return"u_tilesetTime"}}};return f});define("Scene/ConditionsExpression",["../Core/clone","../Core/defined","../Core/defineProperties","./Expression"],function(e,t,r,i){"use strict";function n(t,r){this._conditionsExpression=e(t,true);this._conditions=t.conditions;this._runtimeConditions=undefined;o(this,r)}r(n.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}});function a(e,t){this.condition=e;this.expression=t}function o(e,r){var n=[];var o=e._conditions;if(!t(o)){return}var s=o.length;for(var l=0;l<s;++l){var u=o[l];var c=String(u[0]);var d=String(u[1]);n.push(new a(new i(c,r),new i(d,r)))}e._runtimeConditions=n}n.prototype.evaluate=function(e,r,i){var n=this._runtimeConditions;if(!t(n)){return undefined}var a=n.length;for(var o=0;o<a;++o){var s=n[o];if(s.condition.evaluate(e,r)){return s.expression.evaluate(e,r,i)}}};n.prototype.evaluateColor=function(e,r,i){var n=this._runtimeConditions;if(!t(n)){return undefined}var a=n.length;for(var o=0;o<a;++o){var s=n[o];if(s.condition.evaluate(e,r)){return s.expression.evaluateColor(e,r,i)}}};n.prototype.getShaderFunction=function(e,r,i,n){var a=this._runtimeConditions;if(!t(a)||a.length===0){return undefined}var o="";var s=a.length;for(var l=0;l<s;++l){var u=a[l];var c=u.condition.getShaderExpression(r,i);var d=u.expression.getShaderExpression(r,i);o+="    "+(l===0?"if":"else if")+" ("+c+") \n"+"    { \n"+"        return "+d+"; \n"+"    } \n"}o=n+" "+e+"() \n"+"{ \n"+o+"    return "+n+"(1.0); \n"+"} \n";return o};return n});define("Scene/Cesium3DTileStyle",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/loadJson","../Core/RequestScheduler","../ThirdParty/when","./ConditionsExpression","./Expression"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e){this._style=undefined;this._ready=false;this._color=undefined;this._show=undefined;this._pointSize=undefined;this._meta=undefined;this._colorShaderFunction=undefined;this._showShaderFunction=undefined;this._pointSizeShaderFunction=undefined;this._colorShaderFunctionReady=false;this._showShaderFunctionReady=false;this._pointSizeShaderFunctionReady=false;var t;if(typeof e==="string"){t=a(e)}else{t=s.resolve(e)}var r=this;this._readyPromise=t.then(function(e){d(r,e);return r})}function d(i,n){i._style=e(n,true);n=t(n,t.EMPTY_OBJECT);i.color=n.color;i.show=n.show;i.pointSize=n.pointSize;var a={};if(r(n.meta)){var o=n.defines;var s=t(n.meta,t.EMPTY_OBJECT);for(var l in s){if(s.hasOwnProperty(l)){a[l]=new u(s[l],o)}}}i._meta=a;i._ready=true}i(c.prototype,{style:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._style}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},show:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._show},set:function(e){var i=t(this._style,t.EMPTY_OBJECT).defines;if(!r(e)){this._show=undefined}else if(typeof e==="boolean"){this._show=new u(String(e))}else if(typeof e==="string"){this._show=new u(e,i)}else if(r(e.conditions)){this._show=new l(e,i)}else{this._show=e}this._showShaderFunctionReady=false}},color:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._color},set:function(e){var i=t(this._style,t.EMPTY_OBJECT).defines;if(!r(e)){this._color=undefined}else if(typeof e==="string"){this._color=new u(e,i)}else if(r(e.conditions)){this._color=new l(e,i)}else{this._color=e}this._colorShaderFunctionReady=false}},pointSize:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._pointSize},set:function(e){var i=t(this._style,t.EMPTY_OBJECT).defines;if(!r(e)){this._pointSize=undefined}else if(typeof e==="number"){this._pointSize=new u(String(e))}else if(typeof e==="string"){this._pointSize=new u(e,i)}else if(r(e.conditions)){this._pointSize=new l(e,i)}else{this._pointSize=e}this._pointSizeShaderFunctionReady=false}},meta:{get:function(){if(!this._ready){throw new n("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.")}return this._meta},set:function(e){this._meta=e}}});c.prototype.getColorShaderFunction=function(e,t,i){if(this._colorShaderFunctionReady){return this._colorShaderFunction}this._colorShaderFunctionReady=true;this._colorShaderFunction=r(this.color)?this.color.getShaderFunction(e,t,i,"vec4"):undefined;return this._colorShaderFunction};c.prototype.getShowShaderFunction=function(e,t,i){if(this._showShaderFunctionReady){return this._showShaderFunction}this._showShaderFunctionReady=true;this._showShaderFunction=r(this.show)?this.show.getShaderFunction(e,t,i,"bool"):undefined;return this._showShaderFunction};c.prototype.getPointSizeShaderFunction=function(e,t,i){if(this._pointSizeShaderFunctionReady){return this._pointSizeShaderFunction}this._pointSizeShaderFunctionReady=true;this._pointSizeShaderFunction=r(this.pointSize)?this.pointSize.getShaderFunction(e,t,i,"float"):undefined;return this._pointSizeShaderFunction};return c});define("Scene/CircleEmitter",["../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/defineProperties","../Core/Math"],function(e,t,r,i,n){"use strict";function a(e){e=r(e,1);t.typeOf.number.greaterThan("radius",e,0);this._radius=r(e,1)}i(a.prototype,{radius:{get:function(){return this._radius},set:function(e){t.typeOf.number.greaterThan("value",e,0);this._radius=e}}});a.prototype.emit=function(t){var r=n.randomBetween(0,n.TWO_PI);var i=n.randomBetween(0,this._radius);var a=i*Math.cos(r);var o=i*Math.sin(r);var s=0;t.position=e.fromElements(a,o,s,t.position);t.velocity=e.clone(e.UNIT_Z,t.velocity)};return a});define("Scene/ConeEmitter",["../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/defineProperties","../Core/Math"],function(e,t,r,i,n){"use strict";var a=n.toRadians(30);function o(e){this._angle=r(e,a)}i(o.prototype,{angle:{get:function(){return this._angle},set:function(e){t.typeOf.number("value",e);this._angle=e}}});o.prototype.emit=function(t){var r=Math.tan(this._angle);var i=n.randomBetween(0,n.TWO_PI);var a=n.randomBetween(0,r);var o=a*Math.cos(i);var s=a*Math.sin(i);var l=1;t.velocity=e.fromElements(o,s,l,t.velocity);e.normalize(t.velocity,t.velocity);t.position=e.clone(e.ZERO,t.position)};return o});define("Scene/UrlTemplateImageryProvider",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/combine","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/isArray","../Core/loadJson","../Core/loadText","../Core/loadWithXhr","../Core/loadXML","../Core/Math","../Core/Rectangle","../Core/WebMercatorTilingScheme","../ThirdParty/when","./ImageryProvider"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b){"use strict";function w(e){if(!o(e)){throw new l("options is required.")}if(!y.isPromise(e)&&!o(e.url)){throw new l("options is required.")}this._errorEvent=new u;this._url=undefined;this._urlSchemeZeroPadding=undefined;this._pickFeaturesUrl=undefined;this._proxy=undefined;this._tileWidth=undefined;this._tileHeight=undefined;this._maximumLevel=undefined;this._minimumLevel=undefined;this._tilingScheme=undefined;this._rectangle=undefined;this._tileDiscardPolicy=undefined;this._credit=undefined;this._hasAlphaChannel=undefined;this._readyPromise=undefined;this.enablePickFeatures=true;this.reinitialize(e)}s(w.prototype,{url:{get:function(){return this._url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesUrl}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this.ready){throw new l("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this.ready){throw new l("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this.ready){throw new l("maximumLevel must not be called before the imagery provider is ready.")}return this._maximumLevel}},minimumLevel:{get:function(){if(!this.ready){throw new l("minimumLevel must not be called before the imagery provider is ready.")}return this._minimumLevel}},tilingScheme:{get:function(){if(!this.ready){throw new l("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},rectangle:{get:function(){if(!this.ready){throw new l("rectangle must not be called before the imagery provider is ready.")}return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this.ready){throw new l("tileDiscardPolicy must not be called before the imagery provider is ready.")}return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return o(this._urlParts)}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){if(!this.ready){throw new l("credit must not be called before the imagery provider is ready.")}return this._credit}},hasAlphaChannel:{get:function(){if(!this.ready){throw new l("hasAlphaChannel must not be called before the imagery provider is ready.")}return this._hasAlphaChannel}}});w.prototype.reinitialize=function(e){var t=this;t._readyPromise=y(e).then(function(e){if(!o(e)){throw new l("options is required.")}if(!o(e.url)){throw new l("options.url is required.")}t.enablePickFeatures=a(e.enablePickFeatures,t.enablePickFeatures);t._url=e.url;t._urlSchemeZeroPadding=a(e.urlSchemeZeroPadding,t.urlSchemeZeroPadding);t._pickFeaturesUrl=e.pickFeaturesUrl;t._proxy=e.proxy;t._tileDiscardPolicy=e.tileDiscardPolicy;t._getFeatureInfoFormats=e.getFeatureInfoFormats;t._subdomains=e.subdomains;if(d(t._subdomains)){t._subdomains=t._subdomains.slice()}else if(o(t._subdomains)&&t._subdomains.length>0){t._subdomains=t._subdomains.split("")}else{t._subdomains=["a","b","c"]}t._tileWidth=a(e.tileWidth,256);t._tileHeight=a(e.tileHeight,256);t._minimumLevel=a(e.minimumLevel,0);t._maximumLevel=e.maximumLevel;t._tilingScheme=a(e.tilingScheme,new _({ellipsoid:e.ellipsoid}));t._rectangle=a(e.rectangle,t._tilingScheme.rectangle);t._rectangle=g.intersection(t._rectangle,t._tilingScheme.rectangle);t._hasAlphaChannel=a(e.hasAlphaChannel,true);var r=e.credit;if(typeof r==="string"){r=new n(r)}t._credit=r;t._urlParts=M(t._url,he);t._pickFeaturesUrlParts=M(t._pickFeaturesUrl,pe);return true})};w.prototype.getTileCredits=function(e,t,r){if(!this.ready){throw new l("getTileCredits must not be called before the imagery provider is ready.")}return undefined};w.prototype.requestImage=function(e,t,r,i){if(!this.ready){throw new l("requestImage must not be called before the imagery provider is ready.")}var n=x(this,e,t,r);return b.loadImage(this,n,i)};w.prototype.pickFeatures=function(e,t,r,i,n){if(!this.ready){throw new l("pickFeatures must not be called before the imagery provider is ready.")}if(!this.enablePickFeatures||!o(this._pickFeaturesUrl)||this._getFeatureInfoFormats.length===0){return undefined}var a=0;var s=this;function u(e,t){return e.callback(t)}function c(){if(a>=s._getFeatureInfoFormats.length){return y([])}var o=s._getFeatureInfoFormats[a];var l=D(s,e,t,r,i,n,o.format);++a;if(o.type==="json"){return f(l).then(o.callback).otherwise(c)}else if(o.type==="xml"){return m(l).then(o.callback).otherwise(c)}else if(o.type==="text"||o.type==="html"){return h(l).then(o.callback).otherwise(c)}return p({url:l,responseType:o.format}).then(u.bind(undefined,o)).otherwise(c)}return c()};var C=false;var S=new g;var T=false;var E=new g;function x(e,t,r,i){C=false;T=false;return I(e,e._urlParts,function(n){return n(e,t,r,i)})}var P=false;var A=new e;var O=false;function D(e,t,r,i,n,a,o){C=false;T=false;P=false;O=false;return I(e,e._pickFeaturesUrlParts,function(s){return s(e,t,r,i,n,a,o)})}function I(e,t,r){var i="";for(var n=0;n<t.length;++n){var a=t[n];if(typeof a==="string"){i+=a}else{i+=encodeURIComponent(r(a))}}var s=e._proxy;if(o(s)){i=s.getURL(i)}return i}function M(e,t){if(!o(e)){return undefined}var r=[];var i=0;var n;var a;var s=Object.keys(t);while(i<e.length){n=Number.MAX_VALUE;a=undefined;for(var l=0;l<s.length;++l){var u=e.indexOf(s[l],i);if(u>=0&&u<n){n=u;a=s[l]}}if(!o(a)){r.push(e.substring(i));i=e.length}else{if(i<n){r.push(e.substring(i,n))}r.push(t[a]);i=n+a.length}}return r}function R(e,t,r){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){var i=e.urlSchemeZeroPadding[t];if(typeof i==="string"){var n=i.length;if(n>1){r=r.length>=n?r:new Array(n-r.toString().length+1).join("0")+r}}}return r}function L(e,t,r,i){return R(e,"{x}",t)}function N(e,t,r,i){var n=e.tilingScheme.getNumberOfXTilesAtLevel(i)-t-1;return R(e,"{reverseX}",n)}function k(e,t,r,i){return R(e,"{y}",r)}function F(e,t,r,i){var n=e.tilingScheme.getNumberOfYTilesAtLevel(i)-r-1;return R(e,"{reverseY}",n)}function B(e,t,r,i){var n=e.maximumLevel;var a=o(n)&&i<n?n-i-1:i;return R(e,"{reverseZ}",a)}function U(e,t,r,i){return R(e,"{z}",i)}function V(e,t,r,i){var n=(t+r+i)%e._subdomains.length;return e._subdomains[n]}function z(e,t,r,i){if(C){return}e.tilingScheme.tileXYToRectangle(t,r,i,S);S.west=v.toDegrees(S.west);S.south=v.toDegrees(S.south);S.east=v.toDegrees(S.east);S.north=v.toDegrees(S.north);C=true}function q(e,t,r,i){z(e,t,r,i);return S.west}function G(e,t,r,i){z(e,t,r,i);return S.south}function H(e,t,r,i){z(e,t,r,i);return S.east}function j(e,t,r,i){z(e,t,r,i);return S.north}function W(e,t,r,i){if(T){return}e.tilingScheme.tileXYToNativeRectangle(t,r,i,E);T=true}function Y(e,t,r,i){W(e,t,r,i);return E.west}function X(e,t,r,i){W(e,t,r,i);return E.south}function Q(e,t,r,i){W(e,t,r,i);return E.east}function Z(e,t,r,i){W(e,t,r,i);return E.north}function K(e,t,r,i){return e.tileWidth}function J(e,t,r,i){return e.tileHeight}function $(e,t,r,i,n,a,o){ae(e,t,r,i,n,a);return A.x}function ee(e,t,r,i,n,a,o){ae(e,t,r,i,n,a);return A.y}function te(e,t,r,i,n,a,o){ae(e,t,r,i,n,a);return e.tileWidth-A.x-1}function re(e,t,r,i,n,a,o){ae(e,t,r,i,n,a);return e.tileHeight-A.y-1}var ie=new g;var ne=new t;function ae(e,t,r,i,n,a,o){if(P){return}de(e,t,r,i,n,a);var s=ne;var l=e.tilingScheme.tileXYToNativeRectangle(t,r,i,ie);A.x=e.tileWidth*(s.x-l.west)/l.width|0;A.y=e.tileHeight*(l.north-s.y)/l.height|0;P=true}function oe(e,t,r,i,n,a,o){return v.toDegrees(n)}function se(e,t,r,i,n,a,o){return v.toDegrees(a)}function le(e,t,r,i,n,a,o){de(e,t,r,i,n,a);return ne.x}function ue(e,t,r,i,n,a,o){de(e,t,r,i,n,a);return ne.y}var ce=new r;function de(e,t,r,i,n,a,o){if(O){return}if(e.tilingScheme instanceof c){ne.x=v.toDegrees(n);ne.y=v.toDegrees(a)}else{var s=ce;s.longitude=n;s.latitude=a;e.tilingScheme.projection.project(s,ne)}O=true}function fe(e,t,r,i,n,a,o){return o}var he={"{x}":L,"{y}":k,"{z}":U,"{s}":V,"{reverseX}":N,"{reverseY}":F,"{reverseZ}":B,"{westDegrees}":q,"{southDegrees}":G,"{eastDegrees}":H,"{northDegrees}":j,"{westProjected}":Y,"{southProjected}":X,"{eastProjected}":Q,"{northProjected}":Z,"{width}":K,"{height}":J};var pe=i(he,{"{i}":$,"{j}":ee,"{reverseI}":te,"{reverseJ}":re,"{longitudeDegrees}":oe,"{latitudeDegrees}":se,"{longitudeProjected}":le,"{latitudeProjected}":ue,"{format}":fe});return w});define("Scene/createOpenStreetMapImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/DeveloperError","../Core/Rectangle","../Core/WebMercatorTilingScheme","./UrlTemplateImageryProvider"],function(e,t,r,i,n,a){"use strict";var o=/\/$/;var s=new e("MapQuest, Open Street Map and contributors, CC-BY-SA");function l(l){l=t(l,{});var u=t(l.url,"https://a.tile.openstreetmap.org/");if(!o.test(u)){u=u+"/"}var c=t(l.fileExtension,"png");var d=new n({ellipsoid:l.ellipsoid});var f=256;var h=256;var p=t(l.minimumLevel,0);var m=l.maximumLevel;var v=t(l.rectangle,d.rectangle);var g=d.positionToTileXY(i.southwest(v),p);var _=d.positionToTileXY(i.northeast(v),p);var y=(Math.abs(_.x-g.x)+1)*(Math.abs(_.y-g.y)+1);if(y>4){throw new r("The rectangle and minimumLevel indicate that there are "+y+" tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.")}var b=t(l.credit,s);if(typeof b==="string"){b=new e(b)}var w=u+"{z}/{x}/{y}."+c;return new a({url:w,proxy:l.proxy,credit:b,tilingScheme:d,tileWidth:f,tileHeight:h,minimumLevel:p,maximumLevel:m,rectangle:v})}return l});define("Scene/createTangentSpaceDebugPrimitive",["../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/Matrix4","./PerInstanceColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(u){u=t(u,t.EMPTY_OBJECT);var c=[];var d=u.geometry;if(!r(d)){throw new i("options.geometry is required.")}if(!r(d.attributes)||!r(d.primitiveType)){d=d.constructor.createGeometry(d)}var f=d.attributes;var h=o.clone(t(u.modelMatrix,o.IDENTITY));var p=t(u.length,1e4);if(r(f.normal)){c.push(new n({geometry:a.createLineSegmentsForVectors(d,"normal",p),attributes:{color:new e(1,0,0,1)},modelMatrix:h}))}if(r(f.tangent)){c.push(new n({geometry:a.createLineSegmentsForVectors(d,"tangent",p),attributes:{color:new e(0,1,0,1)},modelMatrix:h}))}if(r(f.bitangent)){c.push(new n({geometry:a.createLineSegmentsForVectors(d,"bitangent",p),attributes:{color:new e(0,0,1,1)},modelMatrix:h}))}if(c.length>0){return new l({asynchronous:false,geometryInstances:c,appearance:new s({flat:true,translucent:false})})}return undefined}return u});define("Scene/createTileMapServiceImageryProvider",["../Core/Cartesian2","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/GeographicTilingScheme","../Core/joinUrls","../Core/loadXML","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./UrlTemplateImageryProvider"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";function p(p){p=r(p,{});if(!i(p.url)){throw new n("options.url is required.")}var m=p.url;var v=f.defer();var g=new h(v.promise);var _;function y(n){var s=/tileformat/i;var f=/tileset/i;var h=/tilesets/i;var y=/boundingbox/i;var b,C,S;var T=[];var E=n.childNodes[0].childNodes;for(var x=0;x<E.length;x++){if(s.test(E.item(x).nodeName)){b=E.item(x)}else if(h.test(E.item(x).nodeName)){S=E.item(x);var P=E.item(x).childNodes;for(var A=0;A<P.length;A++){if(f.test(P.item(A).nodeName)){T.push(P.item(A))}}}else if(y.test(E.item(x).nodeName)){C=E.item(x)}}var O=r(p.fileExtension,b.getAttribute("extension"));var D=r(p.tileWidth,parseInt(b.getAttribute("width"),10));var I=r(p.tileHeight,parseInt(b.getAttribute("height"),10));var M=r(p.minimumLevel,parseInt(T[0].getAttribute("order"),10));var R=r(p.maximumLevel,parseInt(T[T.length-1].getAttribute("order"),10));var L=S.getAttribute("profile");var N=p.tilingScheme;if(!i(N)){if(L==="geodetic"||L==="global-geodetic"){N=new a({ellipsoid:p.ellipsoid})}else if(L==="mercator"||L==="global-mercator"){N=new d({ellipsoid:p.ellipsoid})}else{var k=o(m,"tilemapresource.xml")+"specifies an unsupported profile attribute, "+L+".";_=c.handleError(_,g,g.errorEvent,k,undefined,undefined,undefined,w);if(!_.retry){v.reject(new u(k))}return}}var F=l.clone(p.rectangle);if(!i(F)){var B;var U;var V;var z;var q=r(p.flipXY,false);if(q){V=new e(parseFloat(C.getAttribute("miny")),parseFloat(C.getAttribute("minx")));z=new e(parseFloat(C.getAttribute("maxy")),parseFloat(C.getAttribute("maxx")))}else{V=new e(parseFloat(C.getAttribute("minx")),parseFloat(C.getAttribute("miny")));z=new e(parseFloat(C.getAttribute("maxx")),parseFloat(C.getAttribute("maxy")))}var G=L==="geodetic"||L==="mercator";if(N instanceof a||G){B=t.fromDegrees(V.x,V.y);U=t.fromDegrees(z.x,z.y)}else{var H=N.projection;B=H.unproject(V);U=H.unproject(z)}F=new l(B.longitude,B.latitude,U.longitude,U.latitude)}if(F.west<N.rectangle.west){F.west=N.rectangle.west}if(F.east>N.rectangle.east){F.east=N.rectangle.east}if(F.south<N.rectangle.south){F.south=N.rectangle.south}if(F.north>N.rectangle.north){F.north=N.rectangle.north}var j=N.positionToTileXY(l.southwest(F),M);var W=N.positionToTileXY(l.northeast(F),M);var Y=(Math.abs(W.x-j.x)+1)*(Math.abs(W.y-j.y)+1);if(Y>4){M=0}var X=o(m,"{z}/{x}/{reverseY}."+O);v.resolve({url:X,tilingScheme:N,rectangle:F,tileWidth:D,tileHeight:I,minimumLevel:M,maximumLevel:R,proxy:p.proxy,tileDiscardPolicy:p.tileDiscardPolicy,credit:p.credit})}function b(e){var t=r(p.fileExtension,"png");var n=r(p.tileWidth,256);var a=r(p.tileHeight,256);var s=r(p.minimumLevel,0);var l=p.maximumLevel;var u=i(p.tilingScheme)?p.tilingScheme:new d({ellipsoid:p.ellipsoid});var c=r(p.rectangle,u.rectangle);var f=o(m,"{z}/{x}/{reverseY}."+t);v.resolve({url:f,tilingScheme:u,rectangle:c,tileWidth:n,tileHeight:a,minimumLevel:s,maximumLevel:l,proxy:p.proxy,tileDiscardPolicy:p.tileDiscardPolicy,credit:p.credit})}function w(){var e=o(m,"tilemapresource.xml");var t=p.proxy;if(i(t)){e=t.getURL(e)}s(e).then(y).otherwise(b)}w();return g}return p});define("Scene/CreditDisplay",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError"],function(e,t,r,i,n){"use strict";function a(e,t,i){if(!r(e.element)){var n=e.text;var a=e.link;var o=document.createElement("span");if(e.hasLink()){var s=document.createElement("a");s.textContent=n;s.href=a;s.target="_blank";o.appendChild(s)}else{o.textContent=n}o.className="cesium-credit-text";e.element=o}if(t.hasChildNodes()){var l=document.createElement("span");l.textContent=i;l.className="cesium-credit-delimiter";t.appendChild(l)}t.appendChild(e.element)}function o(e,t){if(!r(e.element)){var i=e.text;var n=e.link;var a=document.createElement("span");var o=document.createElement("img");o.src=e.imageUrl;o.style["vertical-align"]="bottom";if(r(i)){o.alt=i;o.title=i}if(e.hasLink()){var s=document.createElement("a");s.appendChild(o);s.href=n;s.target="_blank";a.appendChild(s)}else{a.appendChild(o)}a.className="cesium-credit-image";e.element=a}t.appendChild(e.element)}function s(t,r){var i=t.length;for(var n=0;n<i;n++){var a=t[n];if(e.equals(a,r)){return true}}return false}function l(e){var t=e.element;if(r(t)){var i=t.parentNode;if(!e.hasImage()){var n=t.previousSibling;if(n===null){n=t.nextSibling}if(n!==null){i.removeChild(n)}}i.removeChild(t)}}function u(e,t){var i;var n;var o;var s=e._displayedCredits.textCredits;for(i=0;i<t.length;i++){o=t[i];if(r(o)){n=s.indexOf(o);if(n===-1){a(o,e._textContainer,e._delimiter)}else{s.splice(n,1)}}}for(i=0;i<s.length;i++){o=s[i];if(r(o)){l(o)}}}function c(e,t){var i;var n;var a;var s=e._displayedCredits.imageCredits;for(i=0;i<t.length;i++){a=t[i];if(r(a)){n=s.indexOf(a);if(n===-1){o(a,e._imageContainer)}else{s.splice(n,1)}}}for(i=0;i<s.length;i++){a=s[i];if(r(a)){l(a)}}}function d(e,i){if(!r(e)){throw new n("credit container is required")}var a=document.createElement("span");a.className="cesium-credit-imageContainer";var o=document.createElement("span");o.className="cesium-credit-textContainer";e.appendChild(a);e.appendChild(o);this._delimiter=t(i," • ");this._textContainer=o;this._imageContainer=a;this._defaultImageCredits=[];this._defaultTextCredits=[];this._displayedCredits={imageCredits:[],textCredits:[]};this._currentFrameCredits={imageCredits:[],textCredits:[]};this.container=e}d.prototype.addCredit=function(e){if(!r(e)){throw new n("credit must be defined")}if(e.hasImage()){var t=this._currentFrameCredits.imageCredits;if(!s(this._defaultImageCredits,e)){t[e.id]=e}}else{var i=this._currentFrameCredits.textCredits;if(!s(this._defaultTextCredits,e)){i[e.id]=e}}};d.prototype.addDefaultCredit=function(e){if(!r(e)){throw new n("credit must be defined")}if(e.hasImage()){var t=this._defaultImageCredits;if(!s(t,e)){t.push(e)}}else{var i=this._defaultTextCredits;if(!s(i,e)){i.push(e)}}};d.prototype.removeDefaultCredit=function(e){if(!r(e)){throw new n("credit must be defined")}var t;if(e.hasImage()){t=this._defaultImageCredits.indexOf(e);if(t!==-1){this._defaultImageCredits.splice(t,1)}}else{t=this._defaultTextCredits.indexOf(e);if(t!==-1){this._defaultTextCredits.splice(t,1)}}};d.prototype.beginFrame=function(){this._currentFrameCredits.imageCredits.length=0;this._currentFrameCredits.textCredits.length=0};d.prototype.endFrame=function(){var e=this._defaultTextCredits.concat(this._currentFrameCredits.textCredits);var t=this._defaultImageCredits.concat(this._currentFrameCredits.imageCredits);u(this,e);c(this,t);this._displayedCredits.textCredits=e;this._displayedCredits.imageCredits=t};d.prototype.destroy=function(){this.container.removeChild(this._textContainer);this.container.removeChild(this._imageContainer);return i(this)};d.prototype.isDestroyed=function(){return false};return d});define("Scene/DebugAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./Appearance"],function(e,t,r,i,n){"use strict";function a(r){r=e(r,e.EMPTY_OBJECT);var a=r.attributeName;var o=r.perInstanceAttribute;if(!t(a)){throw new i("options.attributeName is required.")}if(!t(o)){o=false}var s=e(r.glslDatatype,"vec3");var l="v_"+a;var u;if(a==="normal"||a==="tangent"||a==="bitangent"){u="vec4 getColor() { return vec4(("+l+" + vec3(1.0)) * 0.5, 1.0); }\n"}else{if(a==="st"){s="vec2"}switch(s){case"float":u="vec4 getColor() { return vec4(vec3("+l+"), 1.0); }\n";break;case"vec2":u="vec4 getColor() { return vec4("+l+", 0.0, 1.0); }\n";break;case"vec3":u="vec4 getColor() { return vec4("+l+", 1.0); }\n";break;case"vec4":u="vec4 getColor() { return "+l+"; }\n";break;default:throw new i("options.glslDatatype must be float, vec2, vec3, or vec4.")}}var c="attribute vec3 position3DHigh;\n"+"attribute vec3 position3DLow;\n"+"attribute float batchId;\n"+(o?"":"attribute "+s+" "+a+";\n")+"varying "+s+" "+l+";\n"+"void main()\n"+"{\n"+"vec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\n"+(o?l+" = czm_batchTable_"+a+"(batchId);\n":l+" = "+a+";\n")+"gl_Position = czm_modelViewProjectionRelativeToEye * p;\n"+"}";var d="varying "+s+" "+l+";\n"+u+"\n"+"void main()\n"+"{\n"+"gl_FragColor = getColor();\n"+"}";this.material=undefined;this.translucent=e(r.translucent,false);this._vertexShaderSource=e(r.vertexShaderSource,c);this._fragmentShaderSource=e(r.fragmentShaderSource,d);this._renderState=n.getDefaultRenderState(false,false,r.renderState);this._closed=e(r.closed,false);this._attributeName=a;this._glslDatatype=s}r(a.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},attributeName:{get:function(){return this._attributeName}},glslDatatype:{get:function(){return this._glslDatatype}}});a.prototype.getFragmentShaderSource=n.prototype.getFragmentShaderSource;a.prototype.isTranslucent=n.prototype.isTranslucent;a.prototype.getRenderState=n.prototype.getRenderState;return a});define("Scene/DebugCameraPrimitive",["../Core/Cartesian3","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/FrustumGeometry","../Core/FrustumOutlineGeometry","../Core/GeometryInstance","../Core/Matrix3","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/PerspectiveOffCenterFrustum","../Core/Quaternion","./PerInstanceColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g){"use strict";function _(e){e=i(e,i.EMPTY_OBJECT);if(!n(e.camera)){throw new o("options.camera is required.")}this._camera=e.camera;this._color=i(e.color,t.CYAN);this._updateOnChange=i(e.updateOnChange,true);this.show=i(e.show,true);this.id=e.id;this._id=undefined;this._outlinePrimitives=[];this._planesPrimitives=[]}var y=new e;var b=new c;var w=new m;var C=new h;var S=new p;var T=new d;var E=new f;var x=new t;var P=[1,1e5];_.prototype.update=function(i){if(!this.show){return}var n=this._planesPrimitives;var a=this._outlinePrimitives;var o;var f;if(this._updateOnChange){f=n.length;for(o=0;o<f;++o){a[o]=a[o]&&a[o].destroy();n[o]=n[o]&&n[o].destroy()}n.length=0;a.length=0}if(n.length===0){var _=this._camera;var A=_.frustum;var O;if(A instanceof h){O=C}else if(A instanceof p){O=S}else if(A instanceof d){O=T}else{O=E}O=A.clone(O);var D=i.frustumSplits;var I=D.length-1;if(I<=0){D=P;D[0]=this._camera.frustum.near;D[1]=this._camera.frustum.far;I=1}var M=_.positionWC;var R=_.directionWC;var L=_.upWC;var N=_.rightWC;N=e.negate(N,y);var k=b;c.setColumn(k,0,N,k);c.setColumn(k,1,L,k);c.setColumn(k,2,R,k);var F=m.fromRotationMatrix(k,w);n.length=a.length=I;for(o=0;o<I;++o){O.near=D[o];O.far=D[o+1];n[o]=new g({geometryInstances:new u({geometry:new s({origin:M,orientation:F,frustum:O,_drawNearPlane:o===0}),attributes:{color:r.fromColor(t.fromAlpha(this._color,.1,x))},id:this.id,pickPrimitive:this}),appearance:new v({translucent:true,flat:true}),asynchronous:false});a[o]=new g({geometryInstances:new u({geometry:new l({origin:M,orientation:F,frustum:O,_drawNearPlane:o===0}),attributes:{color:r.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new v({translucent:false,flat:true}),asynchronous:false})}}f=n.length;for(o=0;o<f;++o){a[o].update(i);n[o].update(i)}};_.prototype.isDestroyed=function(){return false};_.prototype.destroy=function(){var e=this._planesPrimitives.length;for(var t=0;t<e;++t){this._outlinePrimitives[t]=this._outlinePrimitives[t]&&this._outlinePrimitives[t].destroy();this._planesPrimitives[t]=this._planesPrimitives[t]&&this._planesPrimitives[t].destroy()}return a(this)};return _});define("Scene/DebugModelMatrixPrimitive",["../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/GeometryInstance","../Core/Matrix4","../Core/PolylineGeometry","./PolylineColorAppearance","./Primitive"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(e){e=r(e,r.EMPTY_OBJECT);this.length=r(e.length,1e7);this._length=undefined;this.width=r(e.width,2);this._width=undefined;this.show=r(e.show,true);this.modelMatrix=o.clone(r(e.modelMatrix,o.IDENTITY));this._modelMatrix=new o;this.id=e.id;this._id=undefined;this._primitive=undefined}c.prototype.update=function(r){if(!this.show){return}if(!i(this._primitive)||!o.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=o.clone(this.modelMatrix,this._modelMatrix);this._length=this.length;this._width=this.width;this._id=this.id;if(i(this._primitive)){this._primitive.destroy()}if(this.modelMatrix[12]===0&&this.modelMatrix[13]===0&&this.modelMatrix[14]===0){this.modelMatrix[14]=.01}var n=new a({geometry:new s({positions:[e.ZERO,e.UNIT_X],width:this.width,vertexFormat:l.VERTEX_FORMAT,colors:[t.RED,t.RED],followSurface:false}),modelMatrix:o.multiplyByUniformScale(this.modelMatrix,this.length,new o),id:this.id,pickPrimitive:this});var c=new a({geometry:new s({positions:[e.ZERO,e.UNIT_Y],width:this.width,vertexFormat:l.VERTEX_FORMAT,colors:[t.GREEN,t.GREEN],followSurface:false}),modelMatrix:o.multiplyByUniformScale(this.modelMatrix,this.length,new o),id:this.id,pickPrimitive:this});var d=new a({geometry:new s({positions:[e.ZERO,e.UNIT_Z],width:this.width,vertexFormat:l.VERTEX_FORMAT,colors:[t.BLUE,t.BLUE],followSurface:false}),modelMatrix:o.multiplyByUniformScale(this.modelMatrix,this.length,new o),id:this.id,pickPrimitive:this});this._primitive=new u({geometryInstances:[n,c,d],appearance:new l,asynchronous:false})}this._primitive.update(r)};c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){this._primitive=this._primitive&&this._primitive.destroy();return n(this)};return c});define("Shaders/DepthPlaneFS",[],function(){"use strict";return"varying vec4 positionEC;\n\nvoid main()\n{\n    // TODO: make arbitrary ellipsoid\n    czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n    \n    vec3 direction = normalize(positionEC.xyz);\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n    \n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\n    if (!czm_isEmpty(intersection))\n    {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n    }\n    else\n    {\n        discard;\n    }\n}\n"});define("Shaders/DepthPlaneVS",[],function(){"use strict";return"attribute vec4 position;\n\nvarying vec4 positionEC;\n\nvoid main()\n{\n    positionEC = czm_modelView * position;\n    gl_Position = czm_projection * positionEC;\n}\n"});define("Scene/DepthPlane",["../Core/BoundingSphere","../Core/Cartesian3","../Core/ComponentDatatype","../Core/defined","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/PrimitiveType","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/VertexArray","../Shaders/DepthPlaneFS","../Shaders/DepthPlaneVS","./DepthFunction","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g){"use strict";function _(){this._rs=undefined;this._sp=undefined;this._va=undefined;this._command=undefined;this._mode=undefined}var y=n.supportsTypedArrays()?new Float32Array(12):[];var b=new t;var w=new t;var C=new t;var S=new t;function T(e,r){var i=e.radii;var n=r.camera.positionWC;var a=t.multiplyComponents(e.oneOverRadii,n,b);var o=t.magnitude(a);var s=t.normalize(a,w);var l=t.normalize(t.cross(t.UNIT_Z,a,C),C);var u=t.normalize(t.cross(s,l,S),S);var c=Math.sqrt(t.magnitudeSquared(a)-1);var d=t.multiplyByScalar(s,1/o,b);var f=c/o;var h=t.multiplyByScalar(l,f,w);var p=t.multiplyByScalar(u,f,C);var m=t.add(d,p,S);t.subtract(m,h,m);t.multiplyComponents(i,m,m);t.pack(m,y,0);var v=t.subtract(d,p,S);t.subtract(v,h,v);t.multiplyComponents(i,v,v);t.pack(v,y,3);var g=t.add(d,p,S);t.add(g,h,g);t.multiplyComponents(i,g,g);t.pack(g,y,6);var _=t.subtract(d,p,S);t.add(_,h,_);t.multiplyComponents(i,_,_);t.pack(_,y,9);return y}_.prototype.update=function(n){this._mode=n.mode;if(n.mode!==g.SCENE3D){return}var _=n.context;var y=n.mapProjection.ellipsoid;if(!i(this._command)){this._rs=d.fromCache({cull:{enabled:true},depthTest:{enabled:true,func:v.ALWAYS},colorMask:{red:false,green:false,blue:false,alpha:false}});this._sp=f.fromCache({context:_,vertexShaderSource:m,fragmentShaderSource:p,attributeLocations:{position:0}});this._command=new u({renderState:this._rs,shaderProgram:this._sp,boundingVolume:new e(t.ZERO,y.maximumRadius),pass:c.OPAQUE,owner:this})}var b=T(y,n);if(!i(this._va)){var w=new a({attributes:{position:new o({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:b})},indices:[0,1,2,2,1,3],primitiveType:s.TRIANGLES});this._va=h.fromGeometry({context:_,geometry:w,attributeLocations:{position:0},bufferUsage:l.DYNAMIC_DRAW});this._command.vertexArray=this._va}else{this._va.getAttribute(0).vertexBuffer.copyFromArrayView(b)}};_.prototype.execute=function(e,t){if(this._mode===g.SCENE3D){this._command.execute(e,t)}};_.prototype.isDestroyed=function(){return false};_.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy();this._va=this._va&&this._va.destroy()};return _});define("Scene/DeviceOrientationCameraController",["../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/Matrix3","../Core/Quaternion"],function(e,t,r,i,n,a){"use strict";function o(t){if(!e(t)){throw new r("scene is required.")}this._scene=t;this._lastAlpha=undefined;this._lastBeta=undefined;this._lastGamma=undefined;this._alpha=undefined;this._beta=undefined;this._gamma=undefined;var n=this;function a(t){var r=t.alpha;if(!e(r)){n._alpha=undefined;n._beta=undefined;n._gamma=undefined;return}n._alpha=i.toRadians(r);n._beta=i.toRadians(t.beta);n._gamma=i.toRadians(t.gamma)}window.addEventListener("deviceorientation",a,false);this._removeListener=function(){window.removeEventListener("deviceorientation",a,false)}}var s=new a;var l=new a;var u=new n;function c(e,t,r,i){var o=e.direction;var c=e.right;var d=e.up;var f=a.fromAxisAngle(o,r,l);var h=a.fromAxisAngle(c,i,s);var p=a.multiply(h,f,h);var m=a.fromAxisAngle(d,t,l);a.multiply(m,p,p);var v=n.fromQuaternion(p,u);n.multiplyByVector(v,c,c);n.multiplyByVector(v,d,d);n.multiplyByVector(v,o,o)}o.prototype.update=function(){if(!e(this._alpha)){return}if(!e(this._lastAlpha)){this._lastAlpha=this._alpha;this._lastBeta=this._beta;this._lastGamma=this._gamma}var t=this._lastAlpha-this._alpha;var r=this._lastBeta-this._beta;var i=this._lastGamma-this._gamma;c(this._scene.camera,-t,r,i);this._lastAlpha=this._alpha;this._lastBeta=this._beta;this._lastGamma=this._gamma};o.prototype.isDestroyed=function(){return false};o.prototype.destroy=function(){this._removeListener();return t(this)};return o});define("Shaders/EllipsoidFS",[],function(){"use strict";return"#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#endif\n\nuniform vec3 u_radii;\nuniform vec3 u_oneOverEllipsoidRadiiSquared;\n\nvarying vec3 v_positionEC;\n\nvec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)\n{\n    vec3 positionEC = czm_pointAlongRay(ray, intersection);\n    vec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;\n    vec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));\n    vec3 sphericalNormal = normalize(positionMC / u_radii);\n    vec3 normalMC = geodeticNormal * side;              // normalized surface normal (always facing the viewer) in model coordinates\n    vec3 normalEC = normalize(czm_normal * normalMC);   // normalized surface normal in eye coordiantes\n\n    vec2 st = czm_ellipsoidWgs84TextureCoordinates(sphericalNormal);\n    vec3 positionToEyeEC = -positionEC;\n\n    czm_materialInput materialInput;\n    materialInput.s = st.s;\n    materialInput.st = st;\n    materialInput.str = (positionMC + u_radii) / u_radii;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef ONLY_SUN_LIGHTING\n    return czm_private_phong(normalize(positionToEyeEC), material);\n#else\n    return czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n\nvoid main()\n{\n    // PERFORMANCE_TODO: When dynamic branching is available, compute ratio of maximum and minimum radii\n    // in the vertex shader. Only when it is larger than some constant, march along the ray.\n    // Otherwise perform one intersection test which will be the common case.\n    \n    // Test if the ray intersects a sphere with the ellipsoid's maximum radius.\n    // For very oblate ellipsoids, using the ellipsoid's radii for an intersection test\n    // may cause false negatives. This will discard fragments before marching the ray forward.\n    float maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;\n    vec3 direction = normalize(v_positionEC);\n    vec3 ellipsoidCenter = czm_modelView[3].xyz;\n    \n    float t1 = -1.0;\n    float t2 = -1.0;\n    \n    float b = -2.0 * dot(direction, ellipsoidCenter);\n    float c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;\n\n    float discriminant = b * b - 4.0 * c;\n    if (discriminant >= 0.0) {\n        t1 = (-b - sqrt(discriminant)) * 0.5;\n        t2 = (-b + sqrt(discriminant)) * 0.5;\n    }\n    \n    if (t1 < 0.0 && t2 < 0.0) {\n        discard;\n    }\n    \n    float t = min(t1, t2);\n    if (t < 0.0) {\n        t = 0.0;\n    }\n    \n    // March ray forward to intersection with larger sphere and find\n    // actual intersection point with ellipsoid.\n    czm_ellipsoid ellipsoid = czm_ellipsoidNew(ellipsoidCenter, u_radii);\n    czm_ray ray = czm_ray(t * direction, direction);\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\n    \n    if (czm_isEmpty(intersection))\n    {\n        discard;\n    }\n\n    // If the viewer is outside, compute outsideFaceColor, with normals facing outward.\n    vec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);\n\n    // If the viewer either is inside or can see inside, compute insideFaceColor, with normals facing inward.\n    vec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);\n\n    gl_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);\n    gl_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);\n    \n#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n    t = (intersection.start != 0.0) ? intersection.start : intersection.stop;\n    vec3 positionEC = czm_pointAlongRay(ray, t);\n    vec4 positionCC = czm_projection * vec4(positionEC, 1.0);\n    float z = positionCC.z / positionCC.w;\n    \n    float n = czm_depthRange.near;\n    float f = czm_depthRange.far;\n    \n    gl_FragDepthEXT = (z * (f - n) + f + n) * 0.5;\n#endif\n#endif\n}\n"});define("Shaders/EllipsoidVS",[],function(){"use strict";return"attribute vec3 position;\n\nuniform vec3 u_radii;\n\nvarying vec3 v_positionEC;\n\nvoid main() \n{\n    // In the vertex data, the cube goes from (-1.0, -1.0, -1.0) to (1.0, 1.0, 1.0) in model coordinates.\n    // Scale to consider the radii.  We could also do this once on the CPU when using the BoxGeometry,\n    // but doing it here allows us to change the radii without rewriting the vertex data, and\n    // allows all ellipsoids to reuse the same vertex data.\n    vec4 p = vec4(u_radii * position, 1.0);\n\n    v_positionEC = (czm_modelView * p).xyz;     // position in eye coordinates\n    gl_Position = czm_modelViewProjection * p;  // position in clip coordinates\n\n    // With multi-frustum, when the ellipsoid primitive is positioned on the intersection of two frustums \n    // and close to terrain, the terrain (writes depth) in the closest frustum can overwrite part of the \n    // ellipsoid (does not write depth) that was rendered in the farther frustum.\n    //\n    // Here, we clamp the depth in the vertex shader to avoid being overwritten; however, this creates\n    // artifacts since some fragments can be alpha blended twice.  This is solved by only rendering\n    // the ellipsoid in the closest frustum to the viewer.\n    gl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);\n}\n"});define("Scene/EllipsoidPrimitive",["../Core/BoundingSphere","../Core/BoxGeometry","../Core/Cartesian3","../Core/combine","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/EllipsoidFS","../Shaders/EllipsoidVS","./BlendingState","./CullFace","./Material","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C){"use strict";var S={position:0};function T(t){t=n(t,n.EMPTY_OBJECT);this.center=r.clone(n(t.center,r.ZERO));this._center=new r;this.radii=r.clone(t.radii);this._radii=new r;this._oneOverEllipsoidRadiiSquared=new r;this._boundingSphere=new e;this.modelMatrix=l.clone(n(t.modelMatrix,l.IDENTITY));this._modelMatrix=new l;this._computedModelMatrix=new l;this.show=n(t.show,true);this.material=n(t.material,w.fromType(w.ColorType));this._material=undefined;this._translucent=undefined;this.id=t.id;this._id=undefined;this.debugShowBoundingVolume=n(t.debugShowBoundingVolume,false);this.onlySunLighting=n(t.onlySunLighting,false);this._onlySunLighting=false;this._depthTestEnabled=n(t.depthTestEnabled,true);this._sp=undefined;this._rs=undefined;this._va=undefined;this._pickSP=undefined;this._pickId=undefined;this._colorCommand=new d({owner:n(t._owner,this)});this._pickCommand=new d({owner:n(t._owner,this)});var i=this;this._uniforms={u_radii:function(){return i.radii},u_oneOverEllipsoidRadiiSquared:function(){return i._oneOverEllipsoidRadiiSquared}};this._pickUniforms={czm_pickColor:function(){return i._pickId.color}}}function E(e){var i=e.cache.ellipsoidPrimitive_vertexArray;if(a(i)){return i}var n=t.createGeometry(t.fromDimensions({dimensions:new r(2,2,2),vertexFormat:u.POSITION_ONLY}));i=v.fromGeometry({context:e,geometry:n,attributeLocations:S,bufferUsage:c.STATIC_DRAW,interleave:true});e.cache.ellipsoidPrimitive_vertexArray=i;return i}T.prototype.update=function(t){if(!this.show||t.mode!==C.SCENE3D||!a(this.center)||!a(this.radii)){return}if(!a(this.material)){throw new s("this.material must be defined.")}var n=t.context;var o=this.material.isTranslucent();var u=this._translucent!==o;if(!a(this._rs)||u){this._translucent=o;this._rs=h.fromCache({cull:{enabled:true,face:b.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!o&&n.fragmentDepth,blending:o?y.ALPHA_BLEND:undefined})}if(!a(this._va)){this._va=E(n)}var c=false;var d=this.radii;if(!r.equals(this._radii,d)){r.clone(d,this._radii);var v=this._oneOverEllipsoidRadiiSquared;v.x=1/(d.x*d.x);v.y=1/(d.y*d.y);v.z=1/(d.z*d.z);c=true}if(!l.equals(this.modelMatrix,this._modelMatrix)||!r.equals(this.center,this._center)){l.clone(this.modelMatrix,this._modelMatrix);r.clone(this.center,this._center);l.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix);c=true}if(c){r.clone(r.ZERO,this._boundingSphere.center);this._boundingSphere.radius=r.maximumComponent(d);e.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere)}var w=this._material!==this.material;this._material=this.material;this._material.update(n);var T=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;var x=this._colorCommand;var P;if(w||T||u){P=new m({sources:[this.material.shaderSource,g]});if(this.onlySunLighting){P.defines.push("ONLY_SUN_LIGHTING")}if(!o&&n.fragmentDepth){P.defines.push("WRITE_DEPTH")}this._sp=p.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:_,fragmentShaderSource:P,attributeLocations:S});x.vertexArray=this._va;x.renderState=this._rs;x.shaderProgram=this._sp;x.uniformMap=i(this._uniforms,this.material._uniforms);x.executeInClosestFrustum=o}var A=t.commandList;var O=t.passes;if(O.render){x.boundingVolume=this._boundingSphere;x.debugShowBoundingVolume=this.debugShowBoundingVolume;x.modelMatrix=this._computedModelMatrix;x.pass=o?f.TRANSLUCENT:f.OPAQUE;A.push(x)}if(O.pick){var D=this._pickCommand;if(!a(this._pickId)||this._id!==this.id){this._id=this.id;this._pickId=this._pickId&&this._pickId.destroy();this._pickId=n.createPickId({primitive:this,id:this.id})}if(w||T||!a(this._pickSP)){P=new m({sources:[this.material.shaderSource,g],pickColorQualifier:"uniform"});if(this.onlySunLighting){P.defines.push("ONLY_SUN_LIGHTING")}if(!o&&n.fragmentDepth){P.defines.push("WRITE_DEPTH")}this._pickSP=p.replaceCache({context:n,shaderProgram:this._pickSP,vertexShaderSource:_,fragmentShaderSource:P,attributeLocations:S});D.vertexArray=this._va;D.renderState=this._rs;D.shaderProgram=this._pickSP;D.uniformMap=i(i(this._uniforms,this._pickUniforms),this.material._uniforms);D.executeInClosestFrustum=o}D.boundingVolume=this._boundingSphere;D.modelMatrix=this._computedModelMatrix;D.pass=o?f.TRANSLUCENT:f.OPAQUE;A.push(D)}};T.prototype.isDestroyed=function(){return false};T.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy();this._pickSP=this._pickSP&&this._pickSP.destroy();this._pickId=this._pickId&&this._pickId.destroy();return o(this)};return T});define("Shaders/Appearances/EllipsoidSurfaceAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    czm_materialInput materialInput;\n    \n    vec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n    \n    materialInput.s = v_st.s;\n    materialInput.st = v_st;\n    materialInput.str = vec3(v_st, 0.0);\n    \n    // Convert tangent space material normal to eye space\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\n    \n    // Convert view vector to world space\n    vec3 positionToEyeEC = -v_positionEC; \n    materialInput.positionToEyeEC = positionToEyeEC;\n\n    czm_material material = czm_getMaterial(materialInput);\n    \n#ifdef FLAT    \n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"});define("Shaders/Appearances/EllipsoidSurfaceAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec2 st;\nattribute float batchId;\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\n\nvoid main() \n{\n    vec4 p = czm_computePosition();\n\n    v_positionMC = position3DHigh + position3DLow;           // position in model coordinates\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;     // position in eye coordinates\n    v_st = st;\n    \n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"});define("Scene/EllipsoidSurfaceAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/EllipsoidSurfaceAppearanceFS","../Shaders/Appearances/EllipsoidSurfaceAppearanceVS","./Appearance","./Material"],function(e,t,r,i,n,a,o,s){"use strict";function l(r){r=e(r,e.EMPTY_OBJECT);var i=e(r.translucent,true);var l=e(r.aboveGround,false);this.material=t(r.material)?r.material:s.fromType(s.ColorType);this.translucent=e(r.translucent,true);this._vertexShaderSource=e(r.vertexShaderSource,a);this._fragmentShaderSource=e(r.fragmentShaderSource,n);this._renderState=o.getDefaultRenderState(i,!l,r.renderState);this._closed=false;this._flat=e(r.flat,false);this._faceForward=e(r.faceForward,l);this._aboveGround=l}r(l.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return l.VERTEX_FORMAT}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}},aboveGround:{get:function(){return this._aboveGround}}});l.VERTEX_FORMAT=i.POSITION_AND_ST;l.prototype.getFragmentShaderSource=o.prototype.getFragmentShaderSource;l.prototype.isTranslucent=o.prototype.isTranslucent;l.prototype.getRenderState=o.prototype.getRenderState;return l});define("Scene/Fog",["../Core/Cartesian3","../Core/defined","../Core/Math","./SceneMode"],function(e,t,r,i){"use strict";function n(){this.enabled=true;this.density=2e-4;this.screenSpaceErrorFactor=2}var a=[359.393,800.749,1275.6501,2151.1192,3141.7763,4777.5198,6281.2493,12364.307,15900.765,49889.0549,78026.8259,99260.7344,120036.3873,151011.0158,156091.1953,203849.3112,274866.9803,319916.3149,493552.0528,628733.5874];var o=[2e-5,2e-4,1e-4,7e-5,5e-5,4e-5,3e-5,19e-6,1e-5,85e-7,62e-7,58e-7,53e-7,52e-7,51e-7,42e-7,4e-6,34e-7,26e-7,22e-7];for(var s=0;s<o.length;++s){o[s]*=1e6}var l=o[1];var u=o[o.length-1];for(var c=0;c<o.length;++c){o[c]=(o[c]-u)/(l-u)}var d=0;function f(e){var t=a;var r=t.length;if(e<t[0]){d=0;return d}else if(e>t[r-1]){d=r-2;return d}if(e>=t[d]){if(d+1<r&&e<t[d+1]){return d}else if(d+2<r&&e<t[d+2]){++d;return d}}else if(d-1>=0&&e>=t[d-1]){--d;return d}var i;for(i=0;i<r-2;++i){if(e>=t[i]&&e<t[i+1]){break}}d=i;return d}var h=new e;n.prototype.update=function(n){var s=n.fog.enabled=this.enabled;if(!s){return}var c=n.camera;var d=c.positionCartographic;if(!t(d)||d.height>8e5||n.mode!==i.SCENE3D){n.fog.enabled=false;return}var p=d.height;var m=f(p);var v=r.clamp((p-a[m])/(a[m+1]-a[m]),0,1);var g=r.lerp(o[m],o[m+1],v);var _=this.density*1e6;var y=_/l*u;g=g*(_-y)*1e-6;var b=e.normalize(c.positionWC,h);var w=Math.abs(e.dot(c.directionWC,b));g*=1-w;n.fog.density=g;n.fog.sse=this.screenSpaceErrorFactor};return n});define("Scene/FrameRateMonitor",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/getTimestamp","../Core/TimeConstants"],function(e,t,r,i,n,a,o,s){"use strict";function l(r){if(!t(r)||!t(r.scene)){throw new n("options.scene is required.")}this._scene=r.scene;this.samplingWindow=e(r.samplingWindow,l.defaultSettings.samplingWindow);this.quietPeriod=e(r.quietPeriod,l.defaultSettings.quietPeriod);this.warmupPeriod=e(r.warmupPeriod,l.defaultSettings.warmupPeriod);this.minimumFrameRateDuringWarmup=e(r.minimumFrameRateDuringWarmup,l.defaultSettings.minimumFrameRateDuringWarmup);this.minimumFrameRateAfterWarmup=e(r.minimumFrameRateAfterWarmup,l.defaultSettings.minimumFrameRateAfterWarmup);this._lowFrameRate=new a;this._nominalFrameRate=new a;this._frameTimes=[];this._needsQuietPeriod=true;this._quietPeriodEndTime=0;this._warmupPeriodEndTime=0;this._frameRateIsLow=false;this._lastFramesPerSecond=undefined;this._pauseCount=0;var i=this;this._preRenderRemoveListener=this._scene.preRender.addEventListener(function(e,t){u(i,t)});this._hiddenPropertyName=document.hidden!==undefined?"hidden":document.mozHidden!==undefined?"mozHidden":document.msHidden!==undefined?"msHidden":document.webkitHidden!==undefined?"webkitHidden":undefined;var o=document.hidden!==undefined?"visibilitychange":document.mozHidden!==undefined?"mozvisibilitychange":document.msHidden!==undefined?"msvisibilitychange":document.webkitHidden!==undefined?"webkitvisibilitychange":undefined;function s(){c(i)}this._visibilityChangeRemoveListener=undefined;if(t(o)){document.addEventListener(o,s,false);this._visibilityChangeRemoveListener=function(){document.removeEventListener(o,s,false)}}}l.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8};l.fromScene=function(e){if(!t(e)){throw new n("scene is required.")}if(!t(e._frameRateMonitor)||e._frameRateMonitor.isDestroyed()){e._frameRateMonitor=new l({scene:e})}return e._frameRateMonitor};r(l.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}});l.prototype.pause=function(){++this._pauseCount;if(this._pauseCount===1){this._frameTimes.length=0;this._lastFramesPerSecond=undefined}};l.prototype.unpause=function(){--this._pauseCount;if(this._pauseCount<=0){this._pauseCount=0;this._needsQuietPeriod=true}};l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){this._preRenderRemoveListener();if(t(this._visibilityChangeRemoveListener)){this._visibilityChangeRemoveListener()}return i(this)};function u(e,t){if(e._pauseCount>0){return}var r=o();if(e._needsQuietPeriod){e._needsQuietPeriod=false;e._frameTimes.length=0;e._quietPeriodEndTime=r+e.quietPeriod/s.SECONDS_PER_MILLISECOND;e._warmupPeriodEndTime=e._quietPeriodEndTime+(e.warmupPeriod+e.samplingWindow)/s.SECONDS_PER_MILLISECOND}else if(r>=e._quietPeriodEndTime){e._frameTimes.push(r);var i=r-e.samplingWindow/s.SECONDS_PER_MILLISECOND;if(e._frameTimes.length>=2&&e._frameTimes[0]<=i){while(e._frameTimes.length>=2&&e._frameTimes[1]<i){e._frameTimes.shift()}var n=(r-e._frameTimes[0])/(e._frameTimes.length-1);e._lastFramesPerSecond=1e3/n;var a=1e3/(r>e._warmupPeriodEndTime?e.minimumFrameRateAfterWarmup:e.minimumFrameRateDuringWarmup);if(n>a){if(!e._frameRateIsLow){e._frameRateIsLow=true;e._needsQuietPeriod=true;e.lowFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)}}else if(e._frameRateIsLow){e._frameRateIsLow=false;e._needsQuietPeriod=true;e.nominalFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)}}}}function c(e){if(document[e._hiddenPropertyName]){e.pause()}else{e.unpause()}}return l});define("Scene/FrameState",["./SceneMode"],function(e){"use strict";function t(t,r,i){this.context=t;this.commandList=[];this.shadowMaps=[];this.brdfLutGenerator=undefined;this.environmentMap=undefined;this.mode=e.SCENE3D;this.morphTime=e.getMorphTime(e.SCENE3D);this.frameNumber=0;this.time=undefined;this.jobScheduler=i;this.mapProjection=undefined;this.camera=undefined;this.cullingVolume=undefined;this.occluder=undefined;this.maximumScreenSpaceError=undefined;this.passes={render:false,pick:false,depth:false};this.creditDisplay=r;this.afterRender=[];this.scene3DOnly=false;this.fog={enabled:false,density:undefined,sse:undefined};this.terrainExaggeration=1;this.shadowHints={shadowsEnabled:true,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:true};this.imagerySplitPosition=0;this.frustumSplits=[];this.backgroundColor=undefined;this.minimumDisableDepthTestDistance=undefined}return t});define("Scene/FrustumCommands",["../Core/defaultValue","../Renderer/Pass"],function(e,t){"use strict";function r(r,i){this.near=e(r,0);this.far=e(i,0);var n=t.NUMBER_OF_PASSES;var a=new Array(n);var o=new Array(n);for(var s=0;s<n;++s){a[s]=[];o[s]=0}this.commands=a;this.indices=o}return r});define("Shaders/PostProcessFilters/FXAA",[],function(){"use strict";return"varying vec2 v_textureCoordinates;\n\nuniform sampler2D u_texture;\nuniform vec2 u_fxaaQualityRcpFrame;\n\nconst float fxaaQualitySubpix = 0.5;\nconst float fxaaQualityEdgeThreshold = 0.125;\nconst float fxaaQualityEdgeThresholdMin = 0.0833;\n\nvoid main()\n{\n    vec4 color = FxaaPixelShader(\n        v_textureCoordinates,\n        u_texture,\n        u_fxaaQualityRcpFrame,\n        fxaaQualitySubpix,\n        fxaaQualityEdgeThreshold,\n        fxaaQualityEdgeThresholdMin);\n    float alpha = texture2D(u_texture, v_textureCoordinates).a;\n    gl_FragColor = vec4(color.rgb, alpha);\n}\n"});define("ThirdParty/Shaders/FXAA3_11",[],function(){"use strict";return"/**\n * @license\n * Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *  * Neither the name of NVIDIA CORPORATION nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n// NVIDIA GameWorks Graphics Samples GitHub link: https://github.com/NVIDIAGameWorks/GraphicsSamples\n// Original FXAA 3.11 shader link: https://github.com/NVIDIAGameWorks/GraphicsSamples/blob/master/samples/es3-kepler/FXAA/FXAA3_11.h\n\n// Steps used to integrate into Cesium:\n// * The following defines are set:\n//       #define FXAA_PC 1\n//       #define FXAA_WEBGL_1 1\n//       #define FXAA_GREEN_AS_LUMA 1\n//       #define FXAA_EARLY_EXIT 1\n//       #define FXAA_GLSL_120 1\n// * All other preprocessor directives besides the FXAA_QUALITY__P* directives were removed.\n// * Double underscores are invalid for preprocessor directives so replace them with a single underscore. Replace\n//   /FXAA_QUALITY__P(.*)/g with /FXAA_QUALITY__P$1/.\n// * There are no implicit conversions from ivec* to vec* so replace:\n//       #define FxaaInt2 ivec2\n//           with\n//       #define FxaaInt2 vec2\n// * The texture2DLod function is only available in vertex shaders so replace:\n//       #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)\n//       #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)\n//           with\n//       #define FxaaTexTop(t, p) texture2D(t, p)\n//       #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n// * FXAA_QUALITY_PRESET is prepended in the javascript code. We may want to expose that setting in the future.\n// * The following parameters to FxaaPixelShader are unused and can be removed:\n//       fxaaConsolePosPos\n//       fxaaConsoleRcpFrameOpt\n//       fxaaConsoleRcpFrameOpt2\n//       fxaaConsole360RcpFrameOpt2\n//       fxaaConsoleEdgeSharpness\n//       fxaaConsoleEdgeThreshold\n//       fxaaConsoleEdgeThresholdMi\n//       fxaaConsole360ConstDir\n\n//\n// Choose the quality preset.\n// This needs to be compiled into the shader as it effects code.\n// Best option to include multiple presets is to\n// in each shader define the preset, then include this file.\n//\n// OPTIONS\n// -----------------------------------------------------------------------\n// 10 to 15 - default medium dither (10=fastest, 15=highest quality)\n// 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)\n// 39       - no dither, very expensive\n//\n// NOTES\n// -----------------------------------------------------------------------\n// 12 = slightly faster then FXAA 3.9 and higher edge quality (default)\n// 13 = about same speed as FXAA 3.9 and better than 12\n// 23 = closest to FXAA 3.9 visually and performance wise\n//  _ = the lowest digit is directly related to performance\n// _  = the highest digit is directly related to style\n//\n//#define FXAA_QUALITY_PRESET 12\n\n\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture2D(t, p)\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n\nFxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\n\nFxaaFloat4 FxaaPixelShader(\n    //\n    // Use noperspective interpolation here (turn off perspective interpolation).\n    // {xy} = center of pixel\n    FxaaFloat2 pos,\n    //\n    // Input color texture.\n    // {rgb_} = color in linear or perceptual color space\n    // if (FXAA_GREEN_AS_LUMA == 0)\n    //     {___a} = luma in perceptual color space (not linear)\n    FxaaTex tex,\n    //\n    // Only used on FXAA Quality.\n    // This must be from a constant/uniform.\n    // {x_} = 1.0/screenWidthInPixels\n    // {_y} = 1.0/screenHeightInPixels\n    FxaaFloat2 fxaaQualityRcpFrame,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_SUBPIX define.\n    // It is here now to allow easier tuning.\n    // Choose the amount of sub-pixel aliasing removal.\n    // This can effect sharpness.\n    //   1.00 - upper limit (softer)\n    //   0.75 - default amount of filtering\n    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)\n    //   0.25 - almost off\n    //   0.00 - completely off\n    FxaaFloat fxaaQualitySubpix,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.\n    // It is here now to allow easier tuning.\n    // The minimum amount of local contrast required to apply algorithm.\n    //   0.333 - too little (faster)\n    //   0.250 - low quality\n    //   0.166 - default\n    //   0.125 - high quality\n    //   0.063 - overkill (slower)\n    FxaaFloat fxaaQualityEdgeThreshold,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.\n    // It is here now to allow easier tuning.\n    // Trims the algorithm from processing darks.\n    //   0.0833 - upper limit (default, the start of visible unfiltered edges)\n    //   0.0625 - high quality (faster)\n    //   0.0312 - visible limit (slower)\n    // Special notes when using FXAA_GREEN_AS_LUMA,\n    //   Likely want to set this to zero.\n    //   As colors that are mostly not-green\n    //   will appear very dark in the green channel!\n    //   Tune by looking at mostly non-green content,\n    //   then start at zero and increase until aliasing is a problem.\n    FxaaFloat fxaaQualityEdgeThresholdMin\n) {\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n    #define lumaM rgbyM.y\n    FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n/*--------------------------------------------------------------------------*/\n    if(earlyExit)\n        return rgbyM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n/*--------------------------------------------------------------------------*/\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\n/*--------------------------------------------------------------------------*/\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n/*--------------------------------------------------------------------------*/\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n/*--------------------------------------------------------------------------*/\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n/*--------------------------------------------------------------------------*/\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n/*--------------------------------------------------------------------------*/\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n    #endif\n/*--------------------------------------------------------------------------*/\n                        }\n                        #endif\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n/*--------------------------------------------------------------------------*/\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n/*--------------------------------------------------------------------------*/\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n/*--------------------------------------------------------------------------*/\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\n}\n"});define("Scene/FXAA",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Shaders/PostProcessFilters/FXAA","../ThirdParty/Shaders/FXAA3_11"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_){"use strict";function y(){this._texture=undefined;this._depthStencilTexture=undefined;this._depthStencilRenderbuffer=undefined;this._fbo=undefined;this._command=undefined;this._viewport=new e;this._rs=undefined;this._useScissorTest=false;this._scissorRectangle=undefined;var t=new o({color:new r(0,0,0,0),depth:1,owner:this});this._clearCommand=t;this._qualityPreset=39}function b(e){e._fbo=e._fbo&&e._fbo.destroy();e._texture=e._texture&&e._texture.destroy();e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy();e._depthStencilRenderbuffer=e._depthStencilRenderbuffer&&e._depthStencilRenderbuffer.destroy();e._fbo=undefined;e._texture=undefined;e._depthStencilTexture=undefined;e._depthStencilRenderbuffer=undefined;if(i(e._command)){e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy();e._command=undefined}}y.prototype.update=function(r,n){var o=r.drawingBufferWidth;var y=r.drawingBufferHeight;var b=this._texture;var w=!i(b)||b.width!==o||b.height!==y;if(w){this._texture=this._texture&&this._texture.destroy();this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy();this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy();this._texture=new h({context:r,width:o,height:y,pixelFormat:a.RGBA,pixelDatatype:l.UNSIGNED_BYTE,sampler:new f({wrapS:v.CLAMP_TO_EDGE,wrapT:v.CLAMP_TO_EDGE,minificationFilter:m.LINEAR,magnificationFilter:p.LINEAR})});if(r.depthTexture){this._depthStencilTexture=new h({context:r,width:o,height:y,pixelFormat:a.DEPTH_STENCIL,pixelDatatype:l.UNSIGNED_INT_24_8})}else{this._depthStencilRenderbuffer=new u({context:r,width:o,height:y,format:c.DEPTH_STENCIL})}}if(!i(this._fbo)||w){this._fbo=this._fbo&&this._fbo.destroy();this._fbo=new s({context:r,colorTextures:[this._texture],depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:false})}if(!i(this._command)){var C="#define FXAA_QUALITY_PRESET "+this._qualityPreset+"\n"+_+"\n"+g;this._command=r.createViewportQuadCommand(C,{owner:this})}this._viewport.width=o;this._viewport.height=y;var S=!e.equals(this._viewport,n.viewport);var T=S!==this._useScissorTest;this._useScissorTest=S;if(!e.equals(this._scissorRectangle,n.viewport)){this._scissorRectangle=e.clone(n.viewport,this._scissorRectangle);T=true}if(!i(this._rs)||!e.equals(this._rs.viewport,this._viewport)||T){this._rs=d.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})}this._command.renderState=this._rs;if(w){var E=this;var x=new t(1/this._texture.width,1/this._texture.height);this._command.uniformMap={u_texture:function(){return E._texture},u_fxaaQualityRcpFrame:function(){return x}}}};y.prototype.execute=function(e,t){this._command.execute(e,t)};y.prototype.clear=function(e,t,i){var n=t.framebuffer;t.framebuffer=this._fbo;r.clone(i,this._clearCommand.color);this._clearCommand.execute(e,t);t.framebuffer=n};y.prototype.getColorFramebuffer=function(){return this._fbo};y.prototype.isDestroyed=function(){return false};y.prototype.destroy=function(){b(this);return n(this)};return y});define("Scene/GetFeatureInfoFormat",["../Core/Cartographic","../Core/defined","../Core/DeveloperError","../Core/RuntimeError","./ImageryLayerFeatureInfo"],function(e,t,r,i,n){"use strict";function a(e,i,n){if(!t(e)){throw new r("type is required.")}this.type=e;if(!t(i)){if(e==="json"){i="application/json"}else if(e==="xml"){i="text/xml"}else if(e==="html"){i="text/html"}else if(e==="text"){i="text/plain"}else{throw new r('format is required when type is not "json", "xml", "html", or "text".')}}this.format=i;if(!t(n)){if(e==="json"){n=o}else if(e==="xml"){n=d}else if(e==="html"){n=C}else if(e==="text"){n=C}else{throw new r('callback is required when type is not "json", "xml", "html", or "text".')}}this.callback=n}function o(r){var i=[];var a=r.features;for(var o=0;o<a.length;++o){var s=a[o];var l=new n;l.data=s;l.properties=s.properties;l.configureNameFromProperties(s.properties);l.configureDescriptionFromProperties(s.properties);if(t(s.geometry)&&s.geometry.type==="Point"){var u=s.geometry.coordinates[0];var c=s.geometry.coordinates[1];l.position=e.fromDegrees(u,c)}i.push(l)}return i}var s="http://www.mapinfo.com/mxp";var l="http://www.esri.com/wms";var u="http://www.opengis.net/wfs";var c="http://www.opengis.net/gml";function d(e){var t=e.documentElement;if(t.localName==="MultiFeatureCollection"&&t.namespaceURI===s){return f(e)}else if(t.localName==="FeatureInfoResponse"&&t.namespaceURI===l){return h(e)}else if(t.localName==="FeatureCollection"&&t.namespaceURI===u){return p(e)}else if(t.localName==="ServiceExceptionReport"){throw new i((new XMLSerializer).serializeToString(t))}else if(t.localName==="msGMLOutput"){return m(e)}else{return _(e)}}function f(e){var t=[];var r=e.documentElement;var i=r.getElementsByTagNameNS(s,"Feature");for(var a=0;a<i.length;++a){var o=i[a];var l={};var u=o.getElementsByTagNameNS(s,"Val");for(var c=0;c<u.length;++c){var d=u[c];if(d.hasAttribute("ref")){var f=d.getAttribute("ref");var h=d.textContent.trim();l[f]=h}}var p=new n;p.data=o;p.properties=l;p.configureNameFromProperties(l);p.configureDescriptionFromProperties(l);t.push(p)}return t}function h(e){var t=e.documentElement;var r=[];var i;var n=t.getElementsByTagNameNS("*","FIELDS");if(n.length>0){for(var a=0;a<n.length;++a){var o=n[a];i={};var s=o.attributes;for(var l=0;l<s.length;++l){var u=s[l];i[u.name]=u.value}r.push(g(o,i))}}else{var c=t.getElementsByTagNameNS("*","FeatureInfo");for(var d=0;d<c.length;++d){var f=c[d];i={};var h=f.childNodes;for(var p=0;p<h.length;++p){var m=h[p];if(m.nodeType===Node.ELEMENT_NODE){i[m.localName]=m.textContent}}r.push(g(f,i))}}return r}function p(e){var t=[];var r=e.documentElement;var i=r.getElementsByTagNameNS(c,"featureMember");for(var n=0;n<i.length;++n){var a=i[n];var o={};v(a,o);t.push(g(a,o))}return t}function m(e){var t=[];var r;var i=e.documentElement.childNodes;for(var n=0;n<i.length;n++){if(i[n].nodeType===Node.ELEMENT_NODE){r=i[n];break}}var a=r.childNodes;for(var o=0;o<a.length;++o){var s=a[o];if(s.nodeType===Node.ELEMENT_NODE){var l={};v(s,l);t.push(g(s,l))}}return t}function v(e,t){var r=true;for(var i=0;i<e.childNodes.length;++i){var n=e.childNodes[i];if(n.nodeType===Node.ELEMENT_NODE){r=false}if(n.localName==="Point"||n.localName==="LineString"||n.localName==="Polygon"||n.localName==="boundedBy"){continue}if(n.hasChildNodes()&&v(n,t)){t[n.localName]=n.textContent}}return r}function g(e,t){var r=new n;r.data=e;r.properties=t;r.configureNameFromProperties(t);r.configureDescriptionFromProperties(t);return r}function _(e){var t=(new XMLSerializer).serializeToString(e);var r=document.createElement("div");var i=document.createElement("pre");i.textContent=t;r.appendChild(i);var a=new n;a.data=e;a.description=r.innerHTML;return[a]}var y=/<body>\s*<\/body>/im;var b=/<ServiceExceptionReport([\s\S]*)<\/ServiceExceptionReport>/im;var w=/<title>([\s\S]*)<\/title>/im;function C(e){if(y.test(e)){return undefined}if(b.test(e)){return undefined}var t;var r=w.exec(e);if(r&&r.length>1){t=r[1]}var i=new n;i.name=t;i.description=e;i.data=e;return[i]}return a});define("Shaders/GlobeFS",[],function(){"use strict";return"//#define SHOW_TILE_BOUNDARIES\n\nuniform vec4 u_initialColor;\n\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SPLIT\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\n\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n\n#ifdef ENABLE_DAYNIGHT_SHADING\nuniform vec2 u_lightingFadeDistance;\n#endif\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n\n#ifdef FOG\nvarying float v_distance;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\n#endif\n\nvec4 sampleAndBlend(\n    vec4 previousColor,\n    sampler2D textureToSample,\n    vec2 tileTextureCoordinates,\n    vec4 textureCoordinateRectangle,\n    vec4 textureCoordinateTranslationAndScale,\n    float textureAlpha,\n    float textureBrightness,\n    float textureContrast,\n    float textureHue,\n    float textureSaturation,\n    float textureOneOverGamma,\n    float split)\n{\n    // This crazy step stuff sets the alpha to 0.0 if this following condition is true:\n    //    tileTextureCoordinates.s < textureCoordinateRectangle.s ||\n    //    tileTextureCoordinates.s > textureCoordinateRectangle.p ||\n    //    tileTextureCoordinates.t < textureCoordinateRectangle.t ||\n    //    tileTextureCoordinates.t > textureCoordinateRectangle.q\n    // In other words, the alpha is zero if the fragment is outside the rectangle\n    // covered by this texture.  Would an actual 'if' yield better performance?\n    vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    vec2 translation = textureCoordinateTranslationAndScale.xy;\n    vec2 scale = textureCoordinateTranslationAndScale.zw;\n    vec2 textureCoordinates = tileTextureCoordinates * scale + translation;\n    vec4 value = texture2D(textureToSample, textureCoordinates);\n    vec3 color = value.rgb;\n    float alpha = value.a;\n\n#ifdef APPLY_SPLIT\n    float splitPosition = czm_imagerySplitPosition;\n    // Split to the left\n    if (split < 0.0 && gl_FragCoord.x > splitPosition) {\n       alpha = 0.0;\n    }\n    // Split to the right\n    else if (split > 0.0 && gl_FragCoord.x < splitPosition) {\n       alpha = 0.0;\n    }\n#endif\n\n#ifdef APPLY_BRIGHTNESS\n    color = mix(vec3(0.0), color, textureBrightness);\n#endif\n\n#ifdef APPLY_CONTRAST\n    color = mix(vec3(0.5), color, textureContrast);\n#endif\n\n#ifdef APPLY_HUE\n    color = czm_hue(color, textureHue);\n#endif\n\n#ifdef APPLY_SATURATION\n    color = czm_saturation(color, textureSaturation);\n#endif\n\n#ifdef APPLY_GAMMA\n    color = pow(color, vec3(textureOneOverGamma));\n#endif\n\n    float sourceAlpha = alpha * textureAlpha;\n    float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\n    vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\n    return vec4(outColor, outAlpha);\n}\n\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue);\n\nvoid main()\n{\n    // The clamp below works around an apparent bug in Chrome Canary v23.0.1241.0\n    // where the fragment shader sees textures coordinates < 0.0 and > 1.0 for the\n    // fragments on the edges of tiles even though the vertex shader is outputting\n    // coordinates strictly in the 0-1 range.\n    vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0));\n\n#ifdef SHOW_TILE_BOUNDARIES\n    if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\n        v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n    {\n        color = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n#endif\n\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING)\n    vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));   // normalized surface normal in model coordinates\n    vec3 normalEC = czm_normal3D * normalMC;                                         // normalized surface normal in eye coordiantes\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n    vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\n    vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\n    vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\n\n    float mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\n\n    if (mask > 0.0)\n    {\n        mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\n\n        vec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\n        vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\n\n        vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\n\n        color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask);\n    }\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalize(v_normalEC)) * 0.9 + 0.3, 0.0, 1.0);\n    vec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\n    float cameraDist = length(czm_view[3]);\n    float fadeOutDist = u_lightingFadeDistance.x;\n    float fadeInDist = u_lightingFadeDistance.y;\n    float t = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n    diffuseIntensity = mix(1.0, diffuseIntensity, t);\n    vec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#else\n    vec4 finalColor = color;\n#endif\n\n\n#ifdef FOG\n    const float fExposure = 2.0;\n    vec3 fogColor = v_mieColor + finalColor.rgb * v_rayleighColor;\n    fogColor = vec3(1.0) - exp(-fExposure * fogColor);\n\n    gl_FragColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor), finalColor.a);\n#else\n    gl_FragColor = finalColor;\n#endif\n}\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n\nfloat waveFade(float edge0, float edge1, float x)\n{\n    float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return pow(1.0 - y, 5.0);\n}\n\nfloat linearFade(float edge0, float edge1, float x)\n{\n    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\n\n// Based on water rendering by Jonas Wagner:\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\n// low altitude wave settings\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\n\n// high altitude wave settings\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\n\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue)\n{\n    vec3 positionToEyeEC = -positionEyeCoordinates;\n    float positionToEyeECLength = length(positionToEyeEC);\n\n    // The double normalize below works around a bug in Firefox on Android devices.\n    vec3 normalizedpositionToEyeEC = normalize(normalize(positionToEyeEC));\n\n    // Fade out the waves as the camera moves far from the surface.\n    float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n\n#ifdef SHOW_OCEAN_WAVES\n    // high altitude waves\n    float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\n    vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\n    vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\n\n    // low altitude waves\n    time = czm_frameNumber * oceanAnimationSpeedLowAltitude;\n    noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\n    vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\n\n    // blend the 2 wave layers based on distance to surface\n    float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\n    float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\n    vec3 normalTangentSpace =\n        (highAltitudeFade * normalTangentSpaceHighAltitude) +\n        (lowAltitudeFade * normalTangentSpaceLowAltitude);\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // fade out the normal perturbation as we move farther from the water surface\n    normalTangentSpace.xy *= waveIntensity;\n    normalTangentSpace = normalize(normalTangentSpace);\n#else\n    vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\n\n    vec3 normalEC = enuToEye * normalTangentSpace;\n\n    const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\n\n    // Use diffuse light to highlight the waves\n    float diffuseIntensity = czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * maskValue;\n    vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity;\n\n#ifdef SHOW_OCEAN_WAVES\n    // Where diffuse light is low or non-existent, use wave highlights based solely on\n    // the wave bumpiness and no particular light direction.\n    float tsPerturbationRatio = normalTangentSpace.z;\n    vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\n    vec3 nonDiffuseHighlight = vec3(0.0);\n#endif\n\n    // Add specular highlights in 3D, and in all modes when zoomed in.\n    float specularIntensity = czm_getSpecular(czm_sunDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0) + 0.25 * czm_getSpecular(czm_moonDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0);\n    float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\n    float specular = specularIntensity * surfaceReflectance;\n\n    return vec4(imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular, imageryColor.a);\n}\n\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n"});define("Shaders/GlobeVS",[],function(){"use strict";return"#ifdef QUANTIZATION_BITS12\nattribute vec4 compressed0;\nattribute float compressed1;\n#else\nattribute vec4 position3DAndHeight;\nattribute vec4 textureCoordAndEncodedNormals;\n#endif\n\nuniform vec3 u_center3D;\nuniform mat4 u_modifiedModelView;\nuniform mat4 u_modifiedModelViewProjection;\nuniform vec4 u_tileRectangle;\n\n// Uniforms for 2D Mercator projection\nuniform vec2 u_southAndNorthLatitude;\nuniform vec2 u_southMercatorYAndOneOverHeight;\n\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\n\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n\n#ifdef FOG\nvarying float v_distance;\nvarying vec3 v_mieColor;\nvarying vec3 v_rayleighColor;\n#endif\n\n// These functions are generated at runtime.\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates);\nfloat get2DYPositionFraction(vec2 textureCoordinates);\n\nvec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return u_modifiedModelViewProjection * vec4(position, 1.0);\n}\n\nfloat get2DMercatorYPositionFraction(vec2 textureCoordinates)\n{\n    // The width of a tile at level 11, in radians and assuming a single root tile, is\n    //   2.0 * czm_pi / pow(2.0, 11.0)\n    // We want to just linearly interpolate the 2D position from the texture coordinates\n    // when we're at this level or higher.  The constant below is the expression\n    // above evaluated and then rounded up at the 4th significant digit.\n    const float maxTileWidth = 0.003068;\n    float positionFraction = textureCoordinates.y;\n    float southLatitude = u_southAndNorthLatitude.x;\n    float northLatitude = u_southAndNorthLatitude.y;\n    if (northLatitude - southLatitude > maxTileWidth)\n    {\n        float southMercatorY = u_southMercatorYAndOneOverHeight.x;\n        float oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;\n\n        float currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);\n        currentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);\n        positionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);\n    }\n    return positionFraction;\n}\n\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates)\n{\n    return textureCoordinates.y;\n}\n\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)\n{\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    return u_modifiedModelViewProjection * rtcPosition2D;\n}\n\nvec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, 0.0, textureCoordinates);\n}\n\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, height, textureCoordinates);\n}\n\nvec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    // We do not do RTC while morphing, so there is potential for jitter.\n    // This is unlikely to be noticeable, though.\n    vec3 position3DWC = position + u_center3D;\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    vec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);\n    return czm_modelViewProjection * morphPosition;\n}\n\n#ifdef QUANTIZATION_BITS12\nuniform vec2 u_minMaxHeight;\nuniform mat4 u_scaleAndBias;\n#endif\n\nvoid main()\n{\n#ifdef QUANTIZATION_BITS12\n    vec2 xy = czm_decompressTextureCoordinates(compressed0.x);\n    vec2 zh = czm_decompressTextureCoordinates(compressed0.y);\n    vec3 position = vec3(xy, zh.x);\n    float height = zh.y;\n    vec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);\n\n    height = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;\n    position = (u_scaleAndBias * vec4(position, 1.0)).xyz;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = compressed1;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = 0.0;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = compressed0.w;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#else\n    // A single float per element\n    vec3 position = position3DAndHeight.xyz;\n    float height = position3DAndHeight.w;\n    vec2 textureCoordinates = textureCoordAndEncodedNormals.xy;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = textureCoordAndEncodedNormals.w;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = textureCoordAndEncodedNormals.z;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = 0.0;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#endif\n\n    vec3 position3DWC = position + u_center3D;\n    gl_Position = getPosition(position, height, textureCoordinates);\n\n    v_textureCoordinates = vec3(textureCoordinates, webMercatorT);\n\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\n    v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\n    v_positionMC = position3DWC;                                 // position in model coordinates\n    v_normalMC = czm_octDecode(encodedNormal);\n    v_normalEC = czm_normal3D * v_normalMC;\n#elif defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(GENERATE_POSITION)\n    v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\n    v_positionMC = position3DWC;                                 // position in model coordinates\n#endif\n\n#ifdef FOG\n    AtmosphereColor atmosColor = computeGroundAtmosphereFromSpace(position3DWC);\n    v_mieColor = atmosColor.mie;\n    v_rayleighColor = atmosColor.rayleigh;\n    v_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);\n#endif\n}\n"});define("Shaders/GroundAtmosphere",[],function(){"use strict";return"/*!\n * Atmosphere code:\n *\n * Copyright (c) 2000-2005, Sean O'Neil (s_p_oneil@hotmail.com)\n * All rights reserved.\n * \n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * \n * * Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n * * Neither the name of the project nor the names of its contributors may be\n *   used to endorse or promote products derived from this software without\n *   specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Modifications made by Analytical Graphics, Inc.\n */\n \n // Atmosphere:\n //   Code:  http://sponeil.net/\n //   GPU Gems 2 Article:  http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n\nconst float fInnerRadius = 6378137.0;\nconst float fOuterRadius = 6378137.0 * 1.025;\nconst float fOuterRadius2 = fOuterRadius * fOuterRadius;\n\nconst float Kr = 0.0025;\nconst float Km = 0.0015;\nconst float ESun = 15.0;\n\nconst float fKrESun = Kr * ESun;\nconst float fKmESun = Km * ESun;\nconst float fKr4PI = Kr * 4.0 * czm_pi;\nconst float fKm4PI = Km * 4.0 * czm_pi;\n\nconst float fScale = 1.0 / (fOuterRadius - fInnerRadius);\nconst float fScaleDepth = 0.25;\nconst float fScaleOverScaleDepth = fScale / fScaleDepth;\n\nstruct AtmosphereColor\n{\n    vec3 mie;\n    vec3 rayleigh;\n};\n\nconst int nSamples = 2;\nconst float fSamples = 2.0;\n\nfloat scale(float fCos)\n{\n    float x = 1.0 - fCos;\n    return fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\n\nAtmosphereColor computeGroundAtmosphereFromSpace(vec3 v3Pos)\n{\n\tvec3 v3InvWavelength = vec3(1.0 / pow(0.650, 4.0), 1.0 / pow(0.570, 4.0), 1.0 / pow(0.475, 4.0));\n\n    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n    vec3 v3Ray = v3Pos - czm_viewerPositionWC;\n    float fFar = length(v3Ray);\n    v3Ray /= fFar;\n    \n    float fCameraHeight = length(czm_viewerPositionWC);\n    float fCameraHeight2 = fCameraHeight * fCameraHeight;\n\n    // This next line is an ANGLE workaround. It is equivalent to B = 2.0 * dot(czm_viewerPositionWC, v3Ray), \n    // which is what it should be, but there are problems at the poles.\n    float B = 2.0 * length(czm_viewerPositionWC) * dot(normalize(czm_viewerPositionWC), v3Ray);\n    float C = fCameraHeight2 - fOuterRadius2;\n    float fDet = max(0.0, B*B - 4.0 * C);\n    float fNear = 0.5 * (-B - sqrt(fDet));\n\n    // Calculate the ray's starting position, then calculate its scattering offset\n    vec3 v3Start = czm_viewerPositionWC + v3Ray * fNear;\n    fFar -= fNear;\n    float fDepth = exp((fInnerRadius - fOuterRadius) / fScaleDepth);\n    \n    // The light angle based on the sun position would be:\n    //    dot(czm_sunDirectionWC, v3Pos) / length(v3Pos);\n    // We want the atmosphere to be uniform over the globe so it is set to 1.0.\n    float fLightAngle = 1.0;\n    float fCameraAngle = dot(-v3Ray, v3Pos) / length(v3Pos);\n    float fCameraScale = scale(fCameraAngle);\n    float fLightScale = scale(fLightAngle);\n    float fCameraOffset = fDepth*fCameraScale;\n    float fTemp = (fLightScale + fCameraScale);\n\n    // Initialize the scattering loop variables\n    float fSampleLength = fFar / fSamples;\n    float fScaledLength = fSampleLength * fScale;\n    vec3 v3SampleRay = v3Ray * fSampleLength;\n    vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\n\n    // Now loop through the sample rays\n    vec3 v3FrontColor = vec3(0.0);\n    vec3 v3Attenuate = vec3(0.0);\n    for(int i=0; i<nSamples; i++)\n    {\n        float fHeight = length(v3SamplePoint);\n        float fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\n        float fScatter = fDepth*fTemp - fCameraOffset;\n        v3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));\n        v3FrontColor += v3Attenuate * (fDepth * fScaledLength);\n        v3SamplePoint += v3SampleRay;\n    }\n    \n    AtmosphereColor color;\n    color.mie = v3FrontColor * (v3InvWavelength * fKrESun + fKmESun);\n    color.rayleigh = v3Attenuate; // Calculate the attenuation factor for the ground\n    \n    return color;\n}\n\n"});define("Scene/GlobeSurfaceShaderSet",["../Core/defined","../Core/destroyObject","../Core/TerrainQuantization","../Renderer/ShaderProgram","../Scene/SceneMode"],function(e,t,r,i,n){"use strict";function a(e,t,r){this.numberOfDayTextures=e;this.flags=t;this.shaderProgram=r}function o(){this.baseVertexShaderSource=undefined;this.baseFragmentShaderSource=undefined;this._shadersByTexturesFlags=[];this._pickShaderPrograms=[]}function s(e){var t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";var r="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";var i="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }";var a;switch(e){case n.SCENE3D:a=t;break;case n.SCENE2D:case n.COLUMBUS_VIEW:a=r;break;case n.MORPHING:a=i;break}return a}function l(e){var t="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }";var r="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }";return e?r:t}o.prototype.getShaderProgram=function(t,n,o,u,c,d,f,h,p,m,v,g,_,y,b,w){var C=0;var S="";var T=n.pickTerrain.mesh.encoding;var E=T.quantization;if(E===r.BITS12){C=1;S="QUANTIZATION_BITS12"}var x=t.mode;var P=x|u<<2|c<<3|d<<4|f<<5|h<<6|p<<7|v<<8|g<<9|_<<10|y<<11|b<<12|w<<13|C<<14|m<<15;var A=n.surfaceShader;if(e(A)&&A.numberOfDayTextures===o&&A.flags===P){return A.shaderProgram}var O=this._shadersByTexturesFlags[o];if(!e(O)){O=this._shadersByTexturesFlags[o]=[]}A=O[P];if(!e(A)){var D=this.baseVertexShaderSource.clone();var I=this.baseFragmentShaderSource.clone();D.defines.push(S);I.defines.push("TEXTURE_UNITS "+o);if(u){I.defines.push("APPLY_BRIGHTNESS")}if(c){I.defines.push("APPLY_CONTRAST")}if(d){I.defines.push("APPLY_HUE")}if(f){I.defines.push("APPLY_SATURATION")}if(h){I.defines.push("APPLY_GAMMA")}if(p){I.defines.push("APPLY_ALPHA")}if(v){I.defines.push("SHOW_REFLECTIVE_OCEAN");D.defines.push("SHOW_REFLECTIVE_OCEAN")}if(g){I.defines.push("SHOW_OCEAN_WAVES")}if(_){if(y){D.defines.push("ENABLE_VERTEX_LIGHTING");I.defines.push("ENABLE_VERTEX_LIGHTING")}else{D.defines.push("ENABLE_DAYNIGHT_SHADING");I.defines.push("ENABLE_DAYNIGHT_SHADING")}}D.defines.push("INCLUDE_WEB_MERCATOR_Y");I.defines.push("INCLUDE_WEB_MERCATOR_Y");if(w){D.defines.push("FOG");I.defines.push("FOG")}if(m){I.defines.push("APPLY_SPLIT")}var M="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates)\n    {\n        vec4 color = initialColor;\n";for(var R=0;R<o;++R){M+="    color = sampleAndBlend(\n        color,\n        u_dayTextures["+R+"],\n        u_dayTextureUseWebMercatorT["+R+"] ? textureCoordinates.xz : textureCoordinates.xy,\n        u_dayTextureTexCoordsRectangle["+R+"],\n        u_dayTextureTranslationAndScale["+R+"],\n        "+(p?"u_dayTextureAlpha["+R+"]":"1.0")+",\n        "+(u?"u_dayTextureBrightness["+R+"]":"0.0")+",\n        "+(c?"u_dayTextureContrast["+R+"]":"0.0")+",\n        "+(d?"u_dayTextureHue["+R+"]":"0.0")+",\n        "+(f?"u_dayTextureSaturation["+R+"]":"0.0")+",\n        "+(h?"u_dayTextureOneOverGamma["+R+"]":"0.0")+",\n        "+(m?"u_dayTextureSplit["+R+"]":"0.0")+"\n    );\n"}M+="        return color;\n    }";I.sources.push(M);D.sources.push(s(x));D.sources.push(l(b));var L=i.fromCache({context:t.context,vertexShaderSource:D,fragmentShaderSource:I,attributeLocations:T.getAttributeLocations()});A=O[P]=new a(o,P,L)}n.surfaceShader=A;return A.shaderProgram};o.prototype.getPickShaderProgram=function(t,n,a){var o=0;var u="";var c=n.pickTerrain.mesh.encoding;var d=c.quantization;if(d===r.BITS12){o=1;u="QUANTIZATION_BITS12"}var f=t.mode;var h=f|a<<2|o<<3;var p=this._pickShaderPrograms[h];if(!e(p)){var m=this.baseVertexShaderSource.clone();m.defines.push(u);m.sources.push(s(f));m.sources.push(l(a));var v="void main()\n"+"{\n"+"    gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n"+"}\n";p=this._pickShaderPrograms[h]=i.fromCache({context:t.context,vertexShaderSource:m,fragmentShaderSource:v,attributeLocations:c.getAttributeLocations()})}return p};o.prototype.destroy=function(){var r;var i;var n=this._shadersByTexturesFlags;for(var a in n){if(n.hasOwnProperty(a)){var o=n[a];if(!e(o)){continue}for(r in o){if(o.hasOwnProperty(r)){i=o[r];if(e(i)){i.shaderProgram.destroy()}}}}}var s=this._pickShaderPrograms;for(r in s){if(s.hasOwnProperty(r)){i=s[r];i.destroy()}}return t(this)};return o});define("Scene/ImageryState",["../Core/freezeObject"],function(e){"use strict";var t={UNLOADED:0,TRANSITIONING:1,RECEIVED:2,TEXTURE_LOADED:3,READY:4,FAILED:5,INVALID:6,PLACEHOLDER:7};return e(t)});define("Scene/QuadtreeTileLoadState",["../Core/freezeObject"],function(e){"use strict";var t={START:0,LOADING:1,DONE:2,FAILED:3};return e(t)});define("Scene/TerrainState",["../Core/freezeObject"],function(e){"use strict";var t={FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6};return e(t)});define("Scene/TileTerrain",["../Core/BoundingSphere","../Core/Cartesian3","../Core/defined","../Core/DeveloperError","../Core/IndexDatatype","../Core/OrientedBoundingBox","../Core/Request","../Core/RequestState","../Core/RequestType","../Core/TileProviderError","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/VertexArray","../ThirdParty/when","./TerrainState"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";function m(e){this.state=p.UNLOADED;this.data=undefined;this.mesh=undefined;this.vertexArray=undefined;this.upsampleDetails=e;this.request=undefined}m.prototype.freeResources=function(){this.state=p.UNLOADED;this.data=undefined;this.mesh=undefined;if(r(this.vertexArray)){var e=this.vertexArray.indexBuffer;this.vertexArray.destroy();this.vertexArray=undefined;if(!e.isDestroyed()&&r(e.referenceCount)){--e.referenceCount;if(e.referenceCount===0){e.destroy()}}}};m.prototype.publishToTile=function(r){var i=r.data;var n=this.mesh;t.clone(n.center,i.center);i.minimumHeight=n.minimumHeight;i.maximumHeight=n.maximumHeight;i.boundingSphere3D=e.clone(n.boundingSphere3D,i.boundingSphere3D);i.orientedBoundingBox=a.clone(n.orientedBoundingBox,i.orientedBoundingBox);i.tileBoundingRegion.minimumHeight=n.minimumHeight;i.tileBoundingRegion.maximumHeight=n.maximumHeight;r.data.occludeePointInScaledSpace=t.clone(n.occludeePointInScaledSpace,i.occludeePointInScaledSpace)};m.prototype.processLoadStateMachine=function(e,t,r,i,n,a){if(this.state===p.UNLOADED){v(this,t,r,i,n,a)}if(this.state===p.RECEIVED){g(this,e,t,r,i,n)}if(this.state===p.TRANSFORMED){_(this,e.context,t,r,i,n)}};function v(e,t,i,n,a,c){function d(t){e.data=t;e.state=p.RECEIVED;e.request=undefined}function f(){if(e.request.state===s.CANCELLED){e.data=undefined;e.state=p.UNLOADED;e.request=undefined;return}e.state=p.FAILED;e.request=undefined;var r="Failed to obtain terrain tile X: "+i+" Y: "+n+" Level: "+a+".";t._requestError=u.handleError(t._requestError,t,t.errorEvent,r,i,n,a,m)}function m(){var s=new o({throttle:true,throttleByServer:true,type:l.TERRAIN,priorityFunction:c});e.request=s;e.data=t.requestTileGeometry(i,n,a,s);if(r(e.data)){e.state=p.RECEIVING;h(e.data,d,f)}else{e.state=p.UNLOADED;e.request=undefined}}m()}m.prototype.processUpsampleStateMachine=function(e,t,n,a,o){if(this.state===p.UNLOADED){var s=this.upsampleDetails;if(!r(s)){throw new i("TileTerrain cannot upsample unless provided upsampleDetails.")}var l=s.data;var u=s.x;var c=s.y;var d=s.level;this.data=l.upsample(t.tilingScheme,u,c,d,n,a,o);if(!r(this.data)){return}this.state=p.RECEIVING;var f=this;h(this.data,function(e){f.data=e;f.state=p.RECEIVED},function(){f.state=p.FAILED})}if(this.state===p.RECEIVED){g(this,e,t,n,a,o)}if(this.state===p.TRANSFORMED){_(this,e.context,t,n,a,o)}};function g(e,t,i,n,a,o){var s=i.tilingScheme;var l=e.data;var u=l.createMesh(s,n,a,o,t.terrainExaggeration);if(!r(u)){return}e.state=p.TRANSFORMING;h(u,function(t){e.mesh=t;e.state=p.TRANSFORMED},function(){e.state=p.FAILED})}function _(e,t,i,a,o,s){var l=e.mesh.vertices;var u=c.createVertexBuffer({context:t,typedArray:l,usage:d.STATIC_DRAW});var h=e.mesh.encoding.getAttributes(u);var m=e.mesh.indices.indexBuffers||{};var v=m[t.id];if(!r(v)||v.isDestroyed()){var g=e.mesh.indices;var _=g.BYTES_PER_ELEMENT===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;v=c.createIndexBuffer({context:t,typedArray:g,usage:d.STATIC_DRAW,indexDatatype:_});v.vertexArrayDestroyable=false;v.referenceCount=1;m[t.id]=v;e.mesh.indices.indexBuffers=m}else{++v.referenceCount}e.vertexArray=new f({context:t,attributes:h,indexBuffer:v});e.state=p.READY}return m});define("Scene/GlobeSurfaceTile",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/IntersectionTests","../Core/PixelFormat","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","./ImageryState","./QuadtreeTileLoadState","./SceneMode","./TerrainState","./TileBoundingRegion","./TileTerrain"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y){"use strict";function b(){this.imagery=[];this.waterMaskTexture=undefined;this.waterMaskTranslationAndScale=new r(0,0,1,1);this.terrainData=undefined;this.center=new t;this.vertexArray=undefined;this.minimumHeight=0;this.maximumHeight=0;this.boundingSphere3D=new e;this.boundingSphere2D=new e;this.orientedBoundingBox=undefined;this.tileBoundingRegion=undefined;this.occludeePointInScaledSpace=new t;this.loadedTerrain=undefined;this.upsampledTerrain=undefined;this.pickBoundingSphere=new e;this.pickTerrain=undefined;this.surfaceShader=undefined}a(b.prototype,{eligibleForUnloading:{get:function(){var e=this.loadedTerrain;var t=n(e)&&(e.state===g.RECEIVING||e.state===g.TRANSFORMING);var r=this.upsampledTerrain;var i=n(r)&&(r.state===g.RECEIVING||r.state===g.TRANSFORMING);var a=!t&&!i;var o=this.imagery;for(var s=0,l=o.length;a&&s<l;++s){var u=o[s];a=!n(u.loadingImagery)||u.loadingImagery.state!==p.TRANSITIONING}return a}}});function w(e,r,i,a,o,s){e.decodePosition(a,o,s);if(n(r)&&r!==v.SCENE3D){var l=i.ellipsoid;var u=l.cartesianToCartographic(s);i.project(u,s);t.fromElements(s.z,s.x,s.y,s)}return s}var C=new t;var S=new t;var T=new t;var E=new t;b.prototype.pick=function(e,r,i,a,s){var l=this.pickTerrain;if(!n(l)){return undefined}var u=l.mesh;if(!n(u)){return undefined}var c=u.vertices;var d=u.indices;var f=u.encoding;var h=d.length;for(var p=0;p<h;p+=3){var m=d[p];var v=d[p+1];var g=d[p+2];var _=w(f,r,i,c,m,C);var y=w(f,r,i,c,v,S);var b=w(f,r,i,c,g,T);var x=o.rayTriangle(e,_,y,b,a,E);if(n(x)){return t.clone(x,s)}}return undefined};b.prototype.freeResources=function(){if(n(this.waterMaskTexture)){--this.waterMaskTexture.referenceCount;if(this.waterMaskTexture.referenceCount===0){this.waterMaskTexture.destroy()}this.waterMaskTexture=undefined}this.terrainData=undefined;if(n(this.loadedTerrain)){this.loadedTerrain.freeResources();this.loadedTerrain=undefined}if(n(this.upsampledTerrain)){this.upsampledTerrain.freeResources();this.upsampledTerrain=undefined}if(n(this.pickTerrain)){this.pickTerrain.freeResources();this.pickTerrain=undefined}var e,t;var r=this.imagery;for(e=0,t=r.length;e<t;++e){r[e].freeResources()}this.imagery.length=0;this.freeVertexArray()};b.prototype.freeVertexArray=function(){var e;if(n(this.vertexArray)){e=this.vertexArray.indexBuffer;this.vertexArray=this.vertexArray.destroy();if(!e.isDestroyed()&&n(e.referenceCount)){--e.referenceCount;if(e.referenceCount===0){e.destroy()}}}if(n(this.wireframeVertexArray)){e=this.wireframeVertexArray.indexBuffer;this.wireframeVertexArray=this.wireframeVertexArray.destroy();if(!e.isDestroyed()&&n(e.referenceCount)){--e.referenceCount;if(e.referenceCount===0){e.destroy()}}}};function x(e){var t;var r;if(n(e.parent)&&n(e.parent.data)){t=e.parent.data.minimumHeight;r=e.parent.data.maximumHeight}return new _({rectangle:e.rectangle,ellipsoid:e.tilingScheme.ellipsoid,minimumHeight:t,maximumHeight:r})}function P(e,t){return function(){return e.tileBoundingRegion.distanceToCamera(t)}}b.processStateMachine=function(e,t,r,i,a){var o=e.data;if(!n(o)){o=e.data=new b;o.tileBoundingRegion=x(e)}if(!n(e._priorityFunction)){e._priorityFunction=P(o,t)}if(e.state===m.START){A(e,r,i);e.state=m.LOADING}if(e.state===m.LOADING){O(e,t,r,a)}var s=n(o.vertexArray);var l=!n(o.loadedTerrain)&&!n(o.upsampledTerrain);var u=n(o.terrainData)&&o.terrainData.wasCreatedByUpsampling();var c=o.imagery;var d,f;for(d=0,f=c.length;d<f;++d){var h=c[d];if(!n(h.loadingImagery)){u=false;continue}if(h.loadingImagery.state===p.PLACEHOLDER){var v=h.loadingImagery.imageryLayer;if(v.imageryProvider.ready){h.freeResources();c.splice(d,1);v._createTileImagerySkeletons(e,r,d);--d;f=c.length;continue}else{u=false}}var g=h.processStateMachine(e,t);l=l&&g;s=s&&(g||n(h.readyImagery));u=u&&n(h.loadingImagery)&&(h.loadingImagery.state===p.FAILED||h.loadingImagery.state===p.INVALID)}e.upsampledFromParent=u;if(d===f){if(s){e.renderable=true}if(l){var _=[];e._loadedCallbacks.forEach(function(t){if(!t(e)){_.push(t)}});e._loadedCallbacks=_;e.state=m.DONE;e._priorityFunction=undefined}}};function A(e,t,r){var i=e.data;var a=D(e);if(n(a)){i.upsampledTerrain=new y(a)}if(N(e,t)){i.loadedTerrain=new y}for(var o=0,s=r.length;o<s;++o){var l=r.get(o);if(l.show){l._createTileImagerySkeletons(e,t)}}}function O(e,t,r,a){var o=e.data;var s=o.loadedTerrain;var l=o.upsampledTerrain;var u=false;if(n(s)){s.processLoadStateMachine(t,r,e.x,e.y,e.level,e._priorityFunction);if(s.state>=g.RECEIVED){if(o.terrainData!==s.data){o.terrainData=s.data;F(t.context,o);R(e)}u=true}if(s.state===g.READY){s.publishToTile(e);if(n(e.data.vertexArray)){a.push(e.data.vertexArray)}e.data.vertexArray=s.vertexArray;s.vertexArray=undefined;o.pickTerrain=i(o.loadedTerrain,o.upsampledTerrain);o.loadedTerrain=undefined;o.upsampledTerrain=undefined}else if(s.state===g.FAILED){o.loadedTerrain=undefined}}if(!u&&n(l)){l.processUpsampleStateMachine(t,r,e.x,e.y,e.level);if(l.state>=g.RECEIVED){if(o.terrainData!==l.data){o.terrainData=l.data;if(r.hasWaterMask){B(e)}I(e)}}if(l.state===g.READY){l.publishToTile(e);if(n(e.data.vertexArray)){a.push(e.data.vertexArray)}e.data.vertexArray=l.vertexArray;l.vertexArray=undefined;o.pickTerrain=o.upsampledTerrain;o.upsampledTerrain=undefined}else if(l.state===g.FAILED){o.upsampledTerrain=undefined}}}function D(e){var t=e.parent;while(n(t)&&n(t.data)&&!n(t.data.terrainData)){t=t.parent}if(!n(t)||!n(t.data)){return undefined}return{data:t.data.terrainData,x:t.x,y:t.y,level:t.level}}function I(e){M(e,e._southwestChild);M(e,e._southeastChild);M(e,e._northwestChild);M(e,e._northeastChild)}function M(e,t){if(n(t)&&t.state!==m.START){var r=t.data;if(n(r.terrainData)&&!r.terrainData.wasCreatedByUpsampling()){return}if(n(r.upsampledTerrain)){r.upsampledTerrain.freeResources()}r.upsampledTerrain=new y({data:e.data.terrainData,x:e.x,y:e.y,level:e.level});t.state=m.LOADING}}function R(e){var t=e.data;L(e,t,e.southwestChild);L(e,t,e.southeastChild);L(e,t,e.northwestChild);L(e,t,e.northeastChild)}function L(e,t,r){if(r.state!==m.START){var i=r.data;if(n(i.terrainData)&&!i.terrainData.wasCreatedByUpsampling()){return}if(n(i.upsampledTerrain)){i.upsampledTerrain.freeResources()}i.upsampledTerrain=new y({data:t.terrainData,x:e.x,y:e.y,level:e.level});if(t.terrainData.isChildAvailable(e.x,e.y,r.x,r.y)){if(!n(i.loadedTerrain)){i.loadedTerrain=new y}}r.state=m.LOADING}}function N(e,t){var r=t.getTileDataAvailable(e.x,e.y,e.level);if(n(r)){return r}var i=e.parent;if(!n(i)){return true}if(!n(i.data)||!n(i.data.terrainData)){return false}return i.data.terrainData.isChildAvailable(i.x,i.y,e.x,e.y)}function k(e){var t=e.cache.tile_waterMaskData;if(!n(t)){var r=new c({context:e,pixelFormat:s.LUMINANCE,pixelDatatype:l.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});r.referenceCount=1;var i=new u({wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,minificationFilter:f.LINEAR,magnificationFilter:d.LINEAR});t={allWaterTexture:r,sampler:i,destroy:function(){this.allWaterTexture.destroy()}};e.cache.tile_waterMaskData=t}return t}function F(e,t){var i=t.waterMaskTexture;if(n(i)){--i.referenceCount;if(i.referenceCount===0){i.destroy()}t.waterMaskTexture=undefined}var a=t.terrainData.waterMask;if(!n(a)){return}var o=k(e);var u;var d=a.length;if(d===1){if(a[0]!==0){u=o.allWaterTexture}else{return}}else{var f=Math.sqrt(d);u=new c({context:e,pixelFormat:s.LUMINANCE,pixelDatatype:l.UNSIGNED_BYTE,source:{width:f,height:f,arrayBufferView:a},sampler:o.sampler});u.referenceCount=0}++u.referenceCount;t.waterMaskTexture=u;r.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}function B(e){var t=e.data;var r=e.parent;while(n(r)&&!n(r.data.terrainData)||r.data.terrainData.wasCreatedByUpsampling()){r=r.parent}if(!n(r)||!n(r.data.waterMaskTexture)){return}t.waterMaskTexture=r.data.waterMaskTexture;++t.waterMaskTexture.referenceCount;var i=r.rectangle;var a=e.rectangle;var o=a.width;var s=a.height;var l=o/i.width;var u=s/i.height;t.waterMaskTranslationAndScale.x=l*(a.west-i.west)/o;t.waterMaskTranslationAndScale.y=u*(a.south-i.south)/s;t.waterMaskTranslationAndScale.z=l;t.waterMaskTranslationAndScale.w=u}return b});define("Shaders/ReprojectWebMercatorFS",[],function(){"use strict";return"uniform sampler2D u_texture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    gl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"});define("Shaders/ReprojectWebMercatorVS",[],function(){"use strict";return"attribute vec4 position;\nattribute float webMercatorT;\n\nuniform vec2 u_textureDimensions;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    v_textureCoordinates = vec2(position.x, webMercatorT);\n    gl_Position = czm_viewportOrthographic * (position * vec4(u_textureDimensions, 1.0, 1.0));\n}\n"});define("Scene/Imagery",["../Core/defined","../Core/destroyObject","../Core/RequestState","./ImageryState"],function(e,t,r,i){"use strict";function n(t,r,n,a,o){this.imageryLayer=t;this.x=r;this.y=n;this.level=a;this.request=undefined;if(a!==0){var s=r/2|0;var l=n/2|0;var u=a-1;this.parent=t.getImageryFromCache(s,l,u)}this.state=i.UNLOADED;this.imageUrl=undefined;this.image=undefined;this.texture=undefined;this.textureWebMercator=undefined;this.credits=undefined;this.referenceCount=0;if(!e(o)&&t.imageryProvider.ready){var c=t.imageryProvider.tilingScheme;o=c.tileXYToRectangle(r,n,a)}this.rectangle=o}n.createPlaceholder=function(e){var t=new n(e,0,0,0);t.addReference();t.state=i.PLACEHOLDER;return t};n.prototype.addReference=function(){++this.referenceCount};n.prototype.releaseReference=function(){--this.referenceCount;if(this.referenceCount===0){this.imageryLayer.removeImageryFromCache(this);if(e(this.parent)){this.parent.releaseReference()}if(e(this.image)&&e(this.image.destroy)){this.image.destroy()}if(e(this.texture)){this.texture.destroy()}if(e(this.textureWebMercator)&&this.texture!==this.textureWebMercator){this.textureWebMercator.destroy()}t(this);return 0}return this.referenceCount};n.prototype.processStateMachine=function(e,t,r){if(this.state===i.UNLOADED){this.state=i.TRANSITIONING;this.imageryLayer._requestImagery(this,r)}if(this.state===i.RECEIVED){this.state=i.TRANSITIONING;this.imageryLayer._createTexture(e.context,this)}var n=this.state===i.READY&&t&&!this.texture;if(this.state===i.TEXTURE_LOADED||n){this.state=i.TRANSITIONING;this.imageryLayer._reprojectTexture(e,this,t)}};return n});define("Scene/ImagerySplitDirection",["../Core/freezeObject"],function(e){"use strict";var t={LEFT:-1,NONE:0,RIGHT:1};return e(t)});define("Scene/TileImagery",["../Core/defined","./ImageryState"],function(e,t){"use strict";function r(e,t,r){this.readyImagery=undefined;this.loadingImagery=e;this.textureCoordinateRectangle=t;this.textureTranslationAndScale=undefined;this.useWebMercatorT=r}r.prototype.freeResources=function(){if(e(this.readyImagery)){this.readyImagery.releaseReference()}if(e(this.loadingImagery)){this.loadingImagery.releaseReference()}};r.prototype.processStateMachine=function(r,i){var n=this.loadingImagery;var a=n.imageryLayer;n.processStateMachine(i,!this.useWebMercatorT,r._priorityFunction);if(n.state===t.READY){if(e(this.readyImagery)){this.readyImagery.releaseReference()}this.readyImagery=this.loadingImagery;this.loadingImagery=undefined;this.textureTranslationAndScale=a._calculateTextureTranslationAndScale(r,this);return true}var o=n.parent;var s;while(e(o)&&(o.state!==t.READY||!this.useWebMercatorT&&!e(o.texture))){if(o.state!==t.FAILED&&o.state!==t.INVALID){s=s||o}o=o.parent}if(this.readyImagery!==o){if(e(this.readyImagery)){this.readyImagery.releaseReference()}this.readyImagery=o;if(e(o)){o.addReference();this.textureTranslationAndScale=a._calculateTextureTranslationAndScale(r,this)}}if(n.state===t.FAILED||n.state===t.INVALID){if(e(s)){s.processStateMachine(i,!this.useWebMercatorT,r._priorityFunction);return false}return true}return false};return r});define("Scene/ImageryLayer",["../Core/Cartesian2","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/FeatureDetection","../Core/GeographicTilingScheme","../Core/IndexDatatype","../Core/Math","../Core/PixelFormat","../Core/Rectangle","../Core/Request","../Core/RequestState","../Core/RequestType","../Core/TerrainProvider","../Core/TileProviderError","../Core/WebMercatorProjection","../Core/WebMercatorTilingScheme","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ComputeCommand","../Renderer/ContextLimits","../Renderer/MipmapHint","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/VertexArray","../Shaders/ReprojectWebMercatorFS","../Shaders/ReprojectWebMercatorVS","../ThirdParty/when","./Imagery","./ImagerySplitDirection","./ImageryState","./TileImagery"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B){"use strict";function U(e,t){this._imageryProvider=e;t=r(t,{});this.alpha=r(t.alpha,r(e.defaultAlpha,1));this.brightness=r(t.brightness,r(e.defaultBrightness,U.DEFAULT_BRIGHTNESS));this.contrast=r(t.contrast,r(e.defaultContrast,U.DEFAULT_CONTRAST));this.hue=r(t.hue,r(e.defaultHue,U.DEFAULT_HUE));this.saturation=r(t.saturation,r(e.defaultSaturation,U.DEFAULT_SATURATION));this.gamma=r(t.gamma,r(e.defaultGamma,U.DEFAULT_GAMMA));this.splitDirection=r(t.splitDirection,r(e.defaultSplit,U.DEFAULT_SPLIT));this.show=r(t.show,true);this._minimumTerrainLevel=t.minimumTerrainLevel;this._maximumTerrainLevel=t.maximumTerrainLevel;this._rectangle=r(t.rectangle,d.MAX_VALUE);this._maximumAnisotropy=t.maximumAnisotropy;this._imageryCache={};this._skeletonPlaceholder=new B(N.createPlaceholder(this));this._show=true;this._layerIndex=-1;this._isBaseLayer=false;this._requestImageError=undefined;this._reprojectComputeCommands=[]}n(U.prototype,{imageryProvider:{get:function(){return this._imageryProvider}},rectangle:{get:function(){return this._rectangle}}});U.DEFAULT_BRIGHTNESS=1;U.DEFAULT_CONTRAST=1;U.DEFAULT_HUE=0;U.DEFAULT_SATURATION=1;U.DEFAULT_GAMMA=1;U.DEFAULT_SPLIT=k.NONE;U.prototype.isBaseLayer=function(){return this._isBaseLayer};U.prototype.isDestroyed=function(){return false};U.prototype.destroy=function(){return a(this)};var V=new d;var z=new d;var q=new d;var G=new d;U.prototype.getViewableRectangle=function(){var e=this._imageryProvider;var t=this._rectangle;return e.readyPromise.then(function(){return d.intersection(e.rectangle,t)})};U.prototype._createTileImagerySkeletons=function(e,r,n){var a=e.data;if(i(this._minimumTerrainLevel)&&e.level<this._minimumTerrainLevel){return false}if(i(this._maximumTerrainLevel)&&e.level>this._maximumTerrainLevel){return false}var o=this._imageryProvider;if(!i(n)){n=a.imagery.length}if(!o.ready){this._skeletonPlaceholder.loadingImagery.addReference();a.imagery.splice(n,0,this._skeletonPlaceholder);return true}var s=o.tilingScheme instanceof _&&e.rectangle.north<g.MaximumLatitude&&e.rectangle.south>-g.MaximumLatitude;var l=d.intersection(o.rectangle,this._rectangle,V);var u=d.intersection(e.rectangle,l,z);if(!i(u)){if(!this.isBaseLayer()){return false}var c=l;var f=e.rectangle;u=z;if(f.south>=c.north){u.north=u.south=c.north}else if(f.north<=c.south){u.north=u.south=c.south}else{u.south=Math.max(f.south,c.south);u.north=Math.min(f.north,c.north)}if(f.west>=c.east){u.west=u.east=c.east}else if(f.east<=c.west){u.west=u.east=c.west}else{u.west=Math.max(f.west,c.west);u.east=Math.min(f.east,c.east)}}var h=0;if(u.south>0){h=u.south}else if(u.north<0){h=u.north}var p=1;var m=p*r.getLevelMaximumGeometricError(e.level);var v=Q(this,m,h);v=Math.max(0,v);var y=o.maximumLevel;if(v>y){v=y}if(i(o.minimumLevel)){var b=o.minimumLevel;if(v<b){v=b}}var w=o.tilingScheme;var C=w.positionToTileXY(d.northwest(u),v);var S=w.positionToTileXY(d.southeast(u),v);var T=e.rectangle.width/512;var E=e.rectangle.height/512;var x=w.tileXYToRectangle(C.x,C.y,v);if(Math.abs(x.south-e.rectangle.north)<E&&C.y<S.y){++C.y}if(Math.abs(x.east-e.rectangle.west)<T&&C.x<S.x){++C.x}var P=w.tileXYToRectangle(S.x,S.y,v);if(Math.abs(P.north-e.rectangle.south)<E&&S.y>C.y){--S.y}if(Math.abs(P.west-e.rectangle.east)<T&&S.x>C.x){--S.x}var A=d.clone(e.rectangle,G);var O=w.tileXYToRectangle(C.x,C.y,v);var D=d.intersection(O,l,q);var I;if(s){w.rectangleToNativeRectangle(A,A);w.rectangleToNativeRectangle(O,O);w.rectangleToNativeRectangle(D,D);w.rectangleToNativeRectangle(l,l);I=w.tileXYToNativeRectangle.bind(w);T=A.width/512;E=A.height/512}else{I=w.tileXYToRectangle.bind(w)}var M;var R=0;var L=1;var N;if(!this.isBaseLayer()&&Math.abs(D.west-A.west)>=T){R=Math.min(1,(D.west-A.west)/A.width)}if(!this.isBaseLayer()&&Math.abs(D.north-A.north)>=E){L=Math.max(0,(D.north-A.south)/A.height)}var k=L;for(var F=C.x;F<=S.x;F++){M=R;O=I(F,C.y,v);D=d.simpleIntersection(O,l,q);if(!i(D)){continue}R=Math.min(1,(D.east-A.west)/A.width);if(F===S.x&&(this.isBaseLayer()||Math.abs(D.east-A.east)<T)){R=1}L=k;for(var U=C.y;U<=S.y;U++){N=L;O=I(F,U,v);D=d.simpleIntersection(O,l,q);if(!i(D)){continue}L=Math.max(0,(D.south-A.south)/A.height);if(U===S.y&&(this.isBaseLayer()||Math.abs(D.south-A.south)<E)){L=0}var H=new t(M,L,R,N);var j=this.getImageryFromCache(F,U,v);a.imagery.splice(n,0,new B(j,H,s));++n}}return true};U.prototype._calculateTextureTranslationAndScale=function(e,r){var i=r.readyImagery.rectangle;var n=e.rectangle;if(r.useWebMercatorT){var a=r.readyImagery.imageryLayer.imageryProvider.tilingScheme;i=a.rectangleToNativeRectangle(i,V);n=a.rectangleToNativeRectangle(n,G)}var o=n.width;var s=n.height;var l=o/i.width;var u=s/i.height;return new t(l*(n.west-i.west)/o,u*(n.south-i.south)/s,l,u)};U.prototype._requestImagery=function(e,t){var r=this._imageryProvider;var n=this;function a(t){if(!i(t)){return o()}e.image=t;e.state=F.RECEIVED;e.request=undefined;v.handleSuccess(n._requestImageError)}function o(t){if(e.request.state===h.CANCELLED){e.state=F.UNLOADED;e.request=undefined;return}e.state=F.FAILED;e.request=undefined;var i="Failed to obtain image tile X: "+e.x+" Y: "+e.y+" Level: "+e.level+".";n._requestImageError=v.handleError(n._requestImageError,r,r.errorEvent,i,e.x,e.y,e.level,s,t)}function s(){var n=new f({throttle:true,throttleByServer:true,type:p.IMAGERY,priorityFunction:t});e.request=n;e.state=F.TRANSITIONING;var s=r.requestImage(e.x,e.y,e.level,n);if(!i(s)){e.state=F.UNLOADED;e.request=undefined;return}if(i(r.getTileCredits)){e.credits=r.getTileCredits(e.x,e.y,e.level)}L(s,a,o)}s()};U.prototype._createTexture=function(e,t){var r=this._imageryProvider;var n=t.image;if(i(r.tileDiscardPolicy)){var a=r.tileDiscardPolicy;if(i(a)){if(!a.isReady()){t.state=F.RECEIVED;return}if(a.shouldDiscardImage(n)){t.state=F.INVALID;return}}}var o;if(i(n.internalFormat)){o=new P({context:e,pixelFormat:n.internalFormat,width:n.width,height:n.height,source:{arrayBufferView:n.bufferView}})}else{o=new P({context:e,source:n,pixelFormat:r.hasAlphaChannel?c.RGBA:c.RGB})}if(r.tilingScheme instanceof _){t.textureWebMercator=o}else{t.texture=o}t.image=undefined;t.state=F.TEXTURE_LOADED};function H(e,t,n,a){if(!c.isCompressedFormat(a.pixelFormat)&&u.isPowerOfTwo(a.width)&&u.isPowerOfTwo(a.height)){var o=t.cache.imageryLayer_mipmapSampler;if(!i(o)){var s=C.maximumTextureFilterAnisotropy;o=t.cache.imageryLayer_mipmapSampler=new T({wrapS:D.CLAMP_TO_EDGE,wrapT:D.CLAMP_TO_EDGE,minificationFilter:O.LINEAR_MIPMAP_LINEAR,magnificationFilter:A.LINEAR,maximumAnisotropy:Math.min(s,r(e._maximumAnisotropy,s))})}a.generateMipmap(S.NICEST);a.sampler=o}else{var l=t.cache.imageryLayer_nonMipmapSampler;if(!i(l)){l=t.cache.imageryLayer_nonMipmapSampler=new T({wrapS:D.CLAMP_TO_EDGE,wrapT:D.CLAMP_TO_EDGE,minificationFilter:O.LINEAR,magnificationFilter:A.LINEAR})}a.sampler=l}n.state=F.READY}U.prototype._reprojectTexture=function(e,t,i){var n=t.textureWebMercator||t.texture;var a=t.rectangle;var o=e.context;i=r(i,true);if(i&&!(this._imageryProvider.tilingScheme instanceof s)&&a.width/n.width>1e-5){var l=this;t.addReference();var u=new w({persists:true,owner:this,preExecute:function(e){X(e,o,n,t.rectangle)},postExecute:function(e){t.texture=e;H(l,o,t,e);t.releaseReference()}});this._reprojectComputeCommands.push(u)}else{if(i){t.texture=n}H(this,o,t,n)}};U.prototype.queueReprojectionCommands=function(e){var t=this._reprojectComputeCommands;var r=t.length;for(var i=0;i<r;++i){e.commandList.push(t[i])}t.length=0};U.prototype.cancelReprojections=function(){this._reprojectComputeCommands.length=0};U.prototype.getImageryFromCache=function(e,t,r,n){var a=j(e,t,r);var o=this._imageryCache[a];if(!i(o)){o=new N(this,e,t,r,n);this._imageryCache[a]=o}o.addReference();return o};U.prototype.removeImageryFromCache=function(e){var t=j(e.x,e.y,e.level);delete this._imageryCache[t]};function j(e,t,r){return JSON.stringify([e,t,r])}var W={u_textureDimensions:function(){return this.textureDimensions},u_texture:function(){return this.texture},textureDimensions:new e,texture:undefined};var Y=o.supportsTypedArrays()?new Float32Array(2*64):undefined;function X(e,t,r,n){var a=t.cache.imageryLayer_reproject;if(!i(a)){a=t.cache.imageryLayer_reproject={vertexArray:undefined,shaderProgram:undefined,sampler:undefined,destroy:function(){if(i(this.framebuffer)){this.framebuffer.destroy()}if(i(this.vertexArray)){this.vertexArray.destroy()}if(i(this.shaderProgram)){this.shaderProgram.destroy()}}};var o=new Float32Array(2*64*2);var s=0;for(var c=0;c<64;++c){var d=c/63;o[s++]=0;o[s++]=d;o[s++]=1;o[s++]=d}var f={position:0,webMercatorT:1};var h=m.getRegularGridIndices(2,64);var p=y.createIndexBuffer({context:t,typedArray:h,usage:b.STATIC_DRAW,indexDatatype:l.UNSIGNED_SHORT});a.vertexArray=new I({context:t,attributes:[{index:f.position,vertexBuffer:y.createVertexBuffer({context:t,typedArray:o,usage:b.STATIC_DRAW}),componentsPerAttribute:2},{index:f.webMercatorT,vertexBuffer:y.createVertexBuffer({context:t,sizeInBytes:64*2*4,usage:b.STREAM_DRAW}),componentsPerAttribute:1}],indexBuffer:p});var v=new x({sources:[R]});a.shaderProgram=E.fromCache({context:t,vertexShaderSource:v,fragmentShaderSource:M,attributeLocations:f});a.sampler=new T({wrapS:D.CLAMP_TO_EDGE,wrapT:D.CLAMP_TO_EDGE,minificationFilter:O.LINEAR,magnificationFilter:A.LINEAR})}r.sampler=a.sampler;var g=r.width;var _=r.height;W.textureDimensions.x=g;W.textureDimensions.y=_;W.texture=r;var w=Math.sin(n.south);var C=.5*Math.log((1+w)/(1-w));w=Math.sin(n.north);var L=.5*Math.log((1+w)/(1-w));var N=1/(L-C);var k=new P({context:t,width:g,height:_,pixelFormat:r.pixelFormat,pixelDatatype:r.pixelDatatype,preMultiplyAlpha:r.preMultiplyAlpha});if(u.isPowerOfTwo(g)&&u.isPowerOfTwo(_)){k.generateMipmap(S.NICEST)}var F=n.south;var B=n.north;var U=Y;var V=0;for(var z=0;z<64;++z){var q=z/63;var G=u.lerp(F,B,q);w=Math.sin(G);var H=.5*Math.log((1+w)/(1-w));var j=(H-C)*N;U[V++]=j;U[V++]=j}a.vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(U);e.shaderProgram=a.shaderProgram;e.outputTexture=k;e.uniformMap=W;e.vertexArray=a.vertexArray}function Q(e,t,r){var i=e._imageryProvider;var n=i.tilingScheme;var a=n.ellipsoid;var o=!(e._imageryProvider.tilingScheme instanceof s)?Math.cos(r):1;var l=n.rectangle;var u=a.maximumRadius*l.width*o/(i.tileWidth*n.getNumberOfXTilesAtLevel(0));var c=u/t;var d=Math.log(c)/Math.log(2);var f=Math.round(d);return f|0}return U});define("Scene/GlobeSurfaceTileProvider",["../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/OrthographicFrustum","../Core/PrimitiveType","../Core/Rectangle","../Core/SphereOutlineGeometry","../Core/TerrainQuantization","../Core/Visibility","../Core/WebMercatorProjection","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/VertexArray","../Scene/BlendingState","../Scene/DepthFunction","../Scene/PerInstanceColorAppearance","../Scene/Primitive","./GlobeSurfaceTile","./ImageryLayer","./QuadtreeTileLoadState","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U,V,z,q){"use strict";function G(e){if(!l(e)){throw new d("options is required.")}if(!l(e.terrainProvider)){throw new d("options.terrainProvider is required.")}else if(!l(e.imageryLayers)){throw new d("options.imageryLayers is required.")}else if(!l(e.surfaceShaderSet)){throw new d("options.surfaceShaderSet is required.")}this.lightingFadeOutDistance=65e5;this.lightingFadeInDistance=9e6;this.hasWaterMask=false;this.oceanNormalMap=undefined;this.zoomedOutOceanSpecularIntensity=.5;this.enableLighting=false;this.shadows=q.RECEIVE_ONLY;this._quadtree=undefined;this._terrainProvider=e.terrainProvider;this._imageryLayers=e.imageryLayers;this._surfaceShaderSet=e.surfaceShaderSet;this._renderState=undefined;this._blendRenderState=undefined;this._pickRenderState=undefined;this._errorEvent=new f;this._imageryLayers.layerAdded.addEventListener(G.prototype._onLayerAdded,this);this._imageryLayers.layerRemoved.addEventListener(G.prototype._onLayerRemoved,this);this._imageryLayers.layerMoved.addEventListener(G.prototype._onLayerMoved,this);this._imageryLayers.layerShownOrHidden.addEventListener(G.prototype._onLayerShownOrHidden,this);this._layerOrderChanged=false;this._tilesToRenderByTextureCount=[];this._drawCommands=[];this._uniformMaps=[];this._pickCommands=[];this._usedDrawCommands=0;this._usedPickCommands=0;this._vertexArraysToDestroy=[];this._debug={wireframe:false,boundingSphereTile:undefined};this._baseColor=undefined;this._firstPassInitialColor=undefined;this.baseColor=new a(0,0,.5,1)}u(G.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){if(!l(e)){throw new d("value is required.")}this._baseColor=e;this._firstPassInitialColor=n.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){if(!l(e)){throw new d("value is required.")}this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(this._imageryLayers.length===0||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){if(this._terrainProvider===e){return}if(!l(e)){throw new d("terrainProvider is required.")}this._terrainProvider=e;if(l(this._quadtree)){this._quadtree.invalidateAllTiles()}}}});function H(e,t){var r=e.loadingImagery;if(!l(r)){r=e.readyImagery}var i=t.loadingImagery;if(!l(i)){i=t.readyImagery}return r.imageryLayer._layerIndex-i.imageryLayer._layerIndex}function j(e){var t=e.indexBuffer;e.destroy();if(!t.isDestroyed()&&l(t.referenceCount)){--t.referenceCount;if(t.referenceCount===0){t.destroy()}}}G.prototype.initialize=function(e){var t=this._imageryLayers;t._update();t.queueReprojectionCommands(e);if(this._layerOrderChanged){this._layerOrderChanged=false;this._quadtree.forEachLoadedTile(function(e){e.data.imagery.sort(H)})}var r=e.creditDisplay;if(this._terrainProvider.ready&&l(this._terrainProvider.credit)){r.addCredit(this._terrainProvider.credit)}for(var i=0,n=t.length;i<n;++i){var a=t.get(i).imageryProvider;if(a.ready&&l(a.credit)){r.addCredit(a.credit)}}var o=this._vertexArraysToDestroy;var s=o.length;for(var u=0;u<s;++u){j(o[u])}o.length=0};G.prototype.beginUpdate=function(e){var t=this._tilesToRenderByTextureCount;for(var r=0,i=t.length;r<i;++r){var n=t[r];if(l(n)){n.length=0}}this._usedDrawCommands=0};G.prototype.endUpdate=function(e){if(!l(this._renderState)){this._renderState=M.fromCache({cull:{enabled:true},depthTest:{enabled:true,func:N.LESS}});this._blendRenderState=M.fromCache({cull:{enabled:true},depthTest:{enabled:true,func:N.LESS_OR_EQUAL},blending:L.ALPHA_BLEND})}var t=this._tilesToRenderByTextureCount;for(var r=0,i=t.length;r<i;++r){var n=t[r];if(!l(n)){continue}for(var a=0,o=n.length;a<o;++a){le(this,n[a],e)}}};G.prototype.updateForPick=function(e){if(!l(this._pickRenderState)){this._pickRenderState=M.fromCache({colorMask:{red:false,green:false,blue:false,alpha:false},depthTest:{enabled:true}})}this._usedPickCommands=0;var t=this._drawCommands;for(var r=0,i=this._usedDrawCommands;r<i;++r){ue(this,t[r],e)}};G.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()};G.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)};G.prototype.loadTile=function(e,t){B.processStateMachine(t,e,this._terrainProvider,this._imageryLayers,this._vertexArraysToDestroy)};var W=new e;G.prototype.computeTileVisibility=function(t,r,n){var a=this.computeDistanceToTile(t,r);t._distance=a;if(r.fog.enabled){if(g.fog(a,r.fog.density)>=1){return E.NONE}}var o=t.data;var u=r.cullingVolume;var c=s(o.orientedBoundingBox,o.boundingSphere3D);if(r.mode!==z.SCENE3D){c=W;e.fromRectangleWithHeights2D(t.rectangle,r.mapProjection,o.minimumHeight,o.maximumHeight,c);i.fromElements(c.center.z,c.center.x,c.center.y,c.center);if(r.mode===z.MORPHING){c=e.union(o.boundingSphere3D,c,c)}}var d=u.computeVisibility(c);if(d===v.OUTSIDE){return E.NONE}var f=r.mode===z.SCENE3D&&r.camera.frustum instanceof b;if(r.mode===z.SCENE3D&&!f){var h=o.occludeePointInScaledSpace;if(!l(h)){return d}if(n.ellipsoid.isScaledSpacePointVisible(h)){return d}return E.NONE}return d};var Y=new _;var X=new _;var Q=new n;var Z=new i;var K=new i;var J=new i;var $=new i;G.prototype.showTileThisFrame=function(e,t){var r=0;var i=e.data.imagery;for(var n=0,a=i.length;n<a;++n){var o=i[n];if(l(o.readyImagery)&&o.readyImagery.imageryLayer.alpha!==0){++r}}var s=this._tilesToRenderByTextureCount[r];if(!l(s)){s=[];this._tilesToRenderByTextureCount[r]=s}s.push(e);var u=this._debug;++u.tilesRendered;u.texturesRendered+=r};G.prototype.computeDistanceToTile=function(e,t){var r=e.data;var i=r.tileBoundingRegion;return i.distanceToCamera(t)};G.prototype.isDestroyed=function(){return false};G.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy();return c(this)};function ee(e,t,r){return function(i){var n;var a;var o=-1;var u=i.data.imagery;var c=u.length;var d;for(d=0;d<c;++d){n=u[d];a=s(n.readyImagery,n.loadingImagery);if(a.imageryLayer===t){o=d;break}}if(o!==-1){var f=o+e;n=u[f];a=l(n)?s(n.readyImagery,n.loadingImagery):undefined;if(!l(a)||a.imageryLayer!==t){return!t._createTileImagerySkeletons(i,r,f)}for(d=o;d<f;++d){u[d].freeResources()}u.splice(o,e)}return true}}G.prototype._onLayerAdded=function(e,t){if(e.show){var r=this._terrainProvider;var i=this;var n=e.imageryProvider;n._reload=function(){e._imageryCache={};i._quadtree.forEachLoadedTile(function(t){if(t.state!==V.DONE){return}var i;var n=t.data.imagery;var a=n.length;var o=-1;var l=0;for(i=0;i<a;++i){var u=n[i];var c=s(u.readyImagery,u.loadingImagery);if(c.imageryLayer===e){if(o===-1){o=i}++l}else if(o!==-1){break}}if(o===-1){return}var d=o+l;if(e._createTileImagerySkeletons(t,r,d)){t._loadedCallbacks.push(ee(l,e,r));t.state=V.LOADING}})};this._quadtree.forEachLoadedTile(function(t){if(e._createTileImagerySkeletons(t,r)){t.state=V.LOADING}});this._layerOrderChanged=true}};G.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile(function(t){var r=t.data.imagery;var i=-1;var n=0;for(var a=0,o=r.length;a<o;++a){var s=r[a];var u=s.loadingImagery;if(!l(u)){u=s.readyImagery}if(u.imageryLayer===e){if(i===-1){i=a}s.freeResources();++n}else if(i!==-1){break}}if(i!==-1){r.splice(i,n)}});if(l(e.imageryProvider)){e.imageryProvider._reload=undefined}};G.prototype._onLayerMoved=function(e,t,r){this._layerOrderChanged=true};G.prototype._onLayerShownOrHidden=function(e,t,r){if(r){this._onLayerAdded(e,t)}else{this._onLayerRemoved(e,t)}};function te(e){var t={u_initialColor:function(){return this.properties.initialColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_center3D:function(){return this.properties.center3D},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){var t=e.context.uniformState.view;var r=_.multiplyByPoint(t,this.properties.rtc,K);_.setTranslation(t,r,Y);return Y},u_modifiedModelViewProjection:function(){var t=e.context.uniformState.view;var r=e.context.uniformState.projection;var i=_.multiplyByPoint(t,this.properties.rtc,K);_.setTranslation(t,i,X);_.multiply(r,X,X);return X},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},properties:{initialColor:new n(0,0,.5,1),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:undefined,lightingFadeDistance:new r(65e5,9e6),center3D:undefined,rtc:new i,modifiedModelView:new _,tileRectangle:new n,dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayIntensity:0,southAndNorthLatitude:new r,southMercatorYAndOneOverHeight:new r,waterMask:undefined,waterMaskTranslationAndScale:new n,minMaxHeight:new r,scaleAndBias:new _}};return t}function re(e,t,r){var i=r.data;if(l(i.wireframeVertexArray)){return}if(!l(i.terrainData)||!l(i.terrainData._mesh)){return}i.wireframeVertexArray=ie(e,i.vertexArray,i.terrainData._mesh)}function ie(e,t,r){var i={indices:r.indices,primitiveType:w.TRIANGLES};p.toWireframe(i);var n=i.indices;var a=P.createIndexBuffer({context:e,typedArray:n,usage:A.STATIC_DRAW,indexDatatype:m.UNSIGNED_SHORT});return new R({context:e,attributes:t._attributes,indexBuffer:a})}var ne;var ae;var oe;(function(){var e=new h({geometry:t.fromDimensions({dimensions:new i(2,2,2)})});var r=new h({geometry:new S({radius:1})});var n=new _;var a;var s;function u(e){return new F({geometryInstances:e,appearance:new k({translucent:false,flat:true}),asynchronous:false})}ne=function(t,r){if(t===a){return s}oe();a=t;n=_.fromRotationTranslation(t.halfAxes,t.center,n);e.modelMatrix=n;e.attributes.color=o.fromColor(r);s=u(e);return s};ae=function(e,t){if(e===a){return s}oe();a=e;n=_.fromTranslation(e.center,n);n=_.multiplyByUniformScale(n,e.radius,n);r.modelMatrix=n;r.attributes.color=o.fromColor(t);s=u(r);return s};oe=function(){if(l(s)){s.destroy();s=undefined;a=undefined}}})();var se=new n(0,0,0,0);function le(t,r,o){var s=r.data;var u=o.creditDisplay;var c=s.terrainData;if(l(c)&&l(c.credits)){var f=c.credits;for(var h=0,p=f.length;h<p;++h){u.addCredit(f[h])}}var m=O.maximumTextureImageUnits;var v=s.waterMaskTexture;var b=t.hasWaterMask&&l(v);var S=t.oceanNormalMap;var E=b&&l(S);var P=t.terrainProvider.ready&&t.terrainProvider.hasVertexNormals;var A=o.fog.enabled;var M=q.castShadows(t.shadows);var R=q.receiveShadows(t.shadows);if(b){--m}if(E){--m}var L=s.center;var N=s.pickTerrain.mesh.encoding;var k=Q;var F=0;var B=0;var V=0;var G=0;var H=false;if(o.mode!==z.SCENE3D){var j=o.mapProjection;var W=j.project(C.southwest(r.rectangle),J);var Y=j.project(C.northeast(r.rectangle),$);k.x=W.x;k.y=W.y;k.z=Y.x;k.w=Y.y;if(o.mode!==z.MORPHING){L=Z;L.x=0;L.y=(k.z+k.x)*.5;L.z=(k.w+k.y)*.5;k.x-=L.y;k.y-=L.z;k.z-=L.y;k.w-=L.z}if(o.mode===z.SCENE2D&&N.quantization===T.BITS12){var X=1/(Math.pow(2,12)-1)*.5;var K=(k.z-k.x)*X;var ee=(k.w-k.y)*X;k.x-=K;k.y-=ee;k.z+=K;k.w+=ee}if(j instanceof x){F=r.rectangle.south;B=r.rectangle.north;V=x.geodeticLatitudeToMercatorAngle(F);G=1/(x.geodeticLatitudeToMercatorAngle(B)-V);H=true}}var ie=s.imagery;var le=0;var ue=ie.length;var ce=t._renderState;var de=t._blendRenderState;var fe=ce;var he=t._firstPassInitialColor;var pe=o.context;if(!l(t._debug.boundingSphereTile)){oe()}do{var me=0;var ve;var ge;if(t._drawCommands.length<=t._usedDrawCommands){ve=new D;ve.owner=r;ve.cull=false;ve.boundingVolume=new e;ve.orientedBoundingBox=undefined;ge=te(o);t._drawCommands.push(ve);t._uniformMaps.push(ge)}else{ve=t._drawCommands[t._usedDrawCommands];ge=t._uniformMaps[t._usedDrawCommands]}ve.owner=r;++t._usedDrawCommands;if(r===t._debug.boundingSphereTile){if(l(s.orientedBoundingBox)){ne(s.orientedBoundingBox,a.RED).update(o)}else if(l(s.boundingSphere3D)){ae(s.boundingSphere3D,a.RED).update(o)}}var _e=ge.properties;n.clone(he,_e.initialColor);_e.oceanNormalMap=S;_e.lightingFadeDistance.x=t.lightingFadeOutDistance;_e.lightingFadeDistance.y=t.lightingFadeInDistance;_e.zoomedOutOceanSpecularIntensity=t.zoomedOutOceanSpecularIntensity;_e.center3D=s.center;i.clone(L,_e.rtc);n.clone(k,_e.tileRectangle);_e.southAndNorthLatitude.x=F;_e.southAndNorthLatitude.y=B;_e.southMercatorYAndOneOverHeight.x=V;_e.southMercatorYAndOneOverHeight.y=G;var ye=A&&g.fog(r._distance,o.fog.density)>g.EPSILON3;var be=false;var we=false;var Ce=false;var Se=false;var Te=false;var Ee=false;var xe=false;while(me<m&&le<ue){var Pe=ie[le];var Ae=Pe.readyImagery;++le;if(!l(Ae)||Ae.imageryLayer.alpha===0){continue}var Oe=Pe.useWebMercatorT?Ae.textureWebMercator:Ae.texture;if(!l(Oe)){throw new d("readyImagery is not actually ready!")}var De=Ae.imageryLayer;if(!l(Pe.textureTranslationAndScale)){Pe.textureTranslationAndScale=De._calculateTextureTranslationAndScale(r,Pe)}_e.dayTextures[me]=Oe;_e.dayTextureTranslationAndScale[me]=Pe.textureTranslationAndScale;_e.dayTextureTexCoordsRectangle[me]=Pe.textureCoordinateRectangle;_e.dayTextureUseWebMercatorT[me]=Pe.useWebMercatorT;_e.dayTextureAlpha[me]=De.alpha;Ee=Ee||_e.dayTextureAlpha[me]!==1;_e.dayTextureBrightness[me]=De.brightness;be=be||_e.dayTextureBrightness[me]!==U.DEFAULT_BRIGHTNESS;_e.dayTextureContrast[me]=De.contrast;we=we||_e.dayTextureContrast[me]!==U.DEFAULT_CONTRAST;_e.dayTextureHue[me]=De.hue;Ce=Ce||_e.dayTextureHue[me]!==U.DEFAULT_HUE;_e.dayTextureSaturation[me]=De.saturation;Se=Se||_e.dayTextureSaturation[me]!==U.DEFAULT_SATURATION;_e.dayTextureOneOverGamma[me]=1/De.gamma;Te=Te||_e.dayTextureOneOverGamma[me]!==1/U.DEFAULT_GAMMA;_e.dayTextureSplit[me]=De.splitDirection;xe=xe||_e.dayTextureSplit[me]!==0;if(l(Ae.credits)){var Ie=Ae.credits;for(var Me=0,Re=Ie.length;Me<Re;++Me){u.addCredit(Ie[Me])}}++me}_e.dayTextures.length=me;_e.waterMask=v;n.clone(s.waterMaskTranslationAndScale,_e.waterMaskTranslationAndScale);_e.minMaxHeight.x=N.minimumHeight;_e.minMaxHeight.y=N.maximumHeight;_.clone(N.matrix,_e.scaleAndBias);ve.shaderProgram=t._surfaceShaderSet.getShaderProgram(o,s,me,be,we,Ce,Se,Te,Ee,xe,b,E,t.enableLighting,P,H,ye);ve.castShadows=M;ve.receiveShadows=R;ve.renderState=fe;ve.primitiveType=w.TRIANGLES;ve.vertexArray=s.vertexArray;ve.uniformMap=ge;ve.pass=I.GLOBE;if(t._debug.wireframe){re(pe,t,r);if(l(s.wireframeVertexArray)){ve.vertexArray=s.wireframeVertexArray;ve.primitiveType=w.LINES}}var Le=ve.boundingVolume;var Ne=ve.orientedBoundingBox;if(o.mode!==z.SCENE3D){e.fromRectangleWithHeights2D(r.rectangle,o.mapProjection,s.minimumHeight,s.maximumHeight,Le);i.fromElements(Le.center.z,Le.center.x,Le.center.y,Le.center);if(o.mode===z.MORPHING){Le=e.union(s.boundingSphere3D,Le,Le)}}else{ve.boundingVolume=e.clone(s.boundingSphere3D,Le);ve.orientedBoundingBox=y.clone(s.orientedBoundingBox,Ne)}o.commandList.push(ve);fe=de;he=se}while(le<ue)}function ue(e,t,r){var i;if(e._pickCommands.length<=e._usedPickCommands){i=new D;i.cull=false;e._pickCommands.push(i)}else{i=e._pickCommands[e._usedPickCommands]}++e._usedPickCommands;var n=t.owner.data;var a=r.projection instanceof x;i.shaderProgram=e._surfaceShaderSet.getPickShaderProgram(r,n,a);i.renderState=e._pickRenderState;i.owner=t.owner;i.primitiveType=t.primitiveType;i.vertexArray=t.vertexArray;i.uniformMap=t.uniformMap;i.boundingVolume=t.boundingVolume;i.orientedBoundingBox=t.orientedBoundingBox;i.pass=t.pass;r.commandList.push(i)}return G});define("Scene/ImageryLayerCollection",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/Math","../Core/Rectangle","../ThirdParty/when","./ImageryLayer"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(){this._layers=[];this.layerAdded=new a;this.layerRemoved=new a;this.layerMoved=new a;this.layerShownOrHidden=new a}r(c.prototype,{length:{get:function(){return this._layers.length}}});c.prototype.add=function(e,r){var i=t(r);if(!t(e)){throw new n("layer is required.")}if(i){if(r<0){throw new n("index must be greater than or equal to zero.")}else if(r>this._layers.length){throw new n("index must be less than or equal to the number of layers.")}}if(!i){r=this._layers.length;this._layers.push(e)}else{this._layers.splice(r,0,e)}this._update();this.layerAdded.raiseEvent(e,r)};c.prototype.addImageryProvider=function(e,r){if(!t(e)){throw new n("imageryProvider is required.")}var i=new u(e);this.add(i,r);return i};c.prototype.remove=function(t,r){r=e(r,true);var i=this._layers.indexOf(t);if(i!==-1){this._layers.splice(i,1);this._update();this.layerRemoved.raiseEvent(t,i);if(r){t.destroy()}return true}return false};c.prototype.removeAll=function(t){t=e(t,true);var r=this._layers;for(var i=0,n=r.length;i<n;i++){var a=r[i];this.layerRemoved.raiseEvent(a,i);if(t){a.destroy()}}this._layers=[]};c.prototype.contains=function(e){return this.indexOf(e)!==-1};c.prototype.indexOf=function(e){return this._layers.indexOf(e)};c.prototype.get=function(e){if(!t(e)){throw new n("index is required.","index")}return this._layers[e]};function d(e,r){if(!t(r)){throw new n("layer is required.")}var i=e.indexOf(r);if(i===-1){throw new n("layer is not in this collection.")}return i}function f(e,t,r){var i=e._layers;t=o.clamp(t,0,i.length-1);r=o.clamp(r,0,i.length-1);if(t===r){return}var n=i[t];i[t]=i[r];i[r]=n;e._update();e.layerMoved.raiseEvent(n,r,t)}c.prototype.raise=function(e){var t=d(this._layers,e);f(this,t,t+1)};c.prototype.lower=function(e){var t=d(this._layers,e);f(this,t,t-1)};c.prototype.raiseToTop=function(e){var t=d(this._layers,e);if(t===this._layers.length-1){return}this._layers.splice(t,1);this._layers.push(e);this._update();this.layerMoved.raiseEvent(e,this._layers.length-1,t)};c.prototype.lowerToBottom=function(e){var t=d(this._layers,e);if(t===0){return}this._layers.splice(t,1);this._layers.splice(0,0,e);this._update();this.layerMoved.raiseEvent(e,0,t)};var h=new s;c.prototype.pickImageryLayerFeatures=function(e,r){var i=r.globe.pick(e,r);if(!t(i)){return undefined}var n=r.globe.ellipsoid.cartesianToCartographic(i);var a=r.globe._surface._tilesToRender;var u;for(var c=0;!t(u)&&c<a.length;++c){var d=a[c];if(s.contains(d.rectangle,n)){u=d}}if(!t(u)){return undefined}var f=u.data.imagery;var p=[];var m=[];for(var v=f.length-1;v>=0;--v){var g=f[v];var _=g.readyImagery;if(!t(_)){continue}var y=_.imageryLayer.imageryProvider;if(!t(y.pickFeatures)){continue}if(!s.contains(_.rectangle,n)){continue}var b=h;var w=1/1024;b.west=o.lerp(u.rectangle.west,u.rectangle.east,g.textureCoordinateRectangle.x-w);b.east=o.lerp(u.rectangle.west,u.rectangle.east,g.textureCoordinateRectangle.z+w);b.south=o.lerp(u.rectangle.south,u.rectangle.north,g.textureCoordinateRectangle.y-w);b.north=o.lerp(u.rectangle.south,u.rectangle.north,g.textureCoordinateRectangle.w+w);if(!s.contains(b,n)){continue}var C=y.pickFeatures(_.x,_.y,_.level,n.longitude,n.latitude);if(!t(C)){continue}p.push(C);m.push(_.imageryLayer)}if(p.length===0){return undefined}return l.all(p,function(e){var r=[];for(var i=0;i<e.length;++i){var a=e[i];var o=m[i];if(t(a)&&a.length>0){for(var s=0;s<a.length;++s){var l=a[s];l.imageryLayer=o;if(!t(l.position)){l.position=n}r.push(l)}}}return r})};c.prototype.queueReprojectionCommands=function(e){var t=this._layers;for(var r=0,i=t.length;r<i;++r){t[r].queueReprojectionCommands(e)}};c.prototype.cancelReprojections=function(){var e=this._layers;for(var t=0,r=e.length;t<r;++t){e[t].cancelReprojections()}};c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){this.removeAll(true);return i(this)};c.prototype._update=function(){var e=true;var r=this._layers;var i;var n;var a,o;for(a=0,o=r.length;a<o;++a){n=r[a];n._layerIndex=a;if(n.show){n._isBaseLayer=e;e=false}else{n._isBaseLayer=false}if(n.show!==n._show){if(t(n._show)){if(!t(i)){i=[]}i.push(n)}n._show=n.show}}if(t(i)){for(a=0,o=i.length;a<o;++a){n=i[a];this.layerShownOrHidden.raiseEvent(n,n._layerIndex,n.show)}}};return c});define("Scene/QuadtreeOccluders",["../Core/Cartesian3","../Core/defineProperties","../Core/EllipsoidalOccluder"],function(e,t,r){"use strict";function i(t){this._ellipsoid=new r(t.ellipsoid,e.ZERO)}t(i.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});return i});define("Scene/QuadtreeTile",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Rectangle","./QuadtreeTileLoadState"],function(e,t,r,i,n){"use strict";function a(t){if(!e(t)){throw new r("options is required.")}if(!e(t.x)){throw new r("options.x is required.")}else if(!e(t.y)){throw new r("options.y is required.")}else if(t.x<0||t.y<0){throw new r("options.x and options.y must be greater than or equal to zero.")}if(!e(t.level)){throw new r("options.level is required and must be greater than or equal to zero.")}if(!e(t.tilingScheme)){throw new r("options.tilingScheme is required.")}this._tilingScheme=t.tilingScheme;this._x=t.x;this._y=t.y;this._level=t.level;this._parent=t.parent;this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level);this._southwestChild=undefined;this._southeastChild=undefined;this._northwestChild=undefined;this._northeastChild=undefined;this._replacementPrevious=undefined;this._replacementNext=undefined;this._distance=0;this._priorityFunction=undefined;this._customData=[];this._frameUpdated=undefined;this._frameRendered=undefined;this._loadedCallbacks=[];this.state=n.START;this.renderable=false;this.upsampledFromParent=false;this.data=undefined}a.createLevelZeroTiles=function(t){if(!e(t)){throw new r("tilingScheme is required.")}var i=t.getNumberOfXTilesAtLevel(0);var n=t.getNumberOfYTilesAtLevel(0);var o=new Array(i*n);var s=0;for(var l=0;l<n;++l){for(var u=0;u<i;++u){o[s++]=new a({tilingScheme:t,x:u,y:l,level:0})}}return o};a.prototype._updateCustomData=function(t,r,n){var a=this.customData;var o;var s;var l;if(e(r)&&e(n)){a=a.filter(function(e){return n.indexOf(e)===-1});this._customData=a;l=this._rectangle;for(o=0;o<r.length;++o){s=r[o];if(i.contains(l,s.positionCartographic)){a.push(s)}}this._frameUpdated=t}else{var u=this._parent;if(e(u)&&this._frameUpdated!==u._frameUpdated){a.length=0;l=this._rectangle;var c=u.customData;for(o=0;o<c.length;++o){s=c[o];if(i.contains(l,s.positionCartographic)){a.push(s)}}this._frameUpdated=u._frameUpdated}}};t(a.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){if(!e(this._southwestChild)){this._southwestChild=new a({tilingScheme:this.tilingScheme,x:this.x*2,y:this.y*2+1,level:this.level+1,parent:this})}return this._southwestChild}},southeastChild:{get:function(){if(!e(this._southeastChild)){this._southeastChild=new a({tilingScheme:this.tilingScheme,x:this.x*2+1,y:this.y*2+1,level:this.level+1,parent:this})}return this._southeastChild}},northwestChild:{get:function(){if(!e(this._northwestChild)){this._northwestChild=new a({tilingScheme:this.tilingScheme,x:this.x*2,y:this.y*2,level:this.level+1,parent:this})}return this._northwestChild}},northeastChild:{get:function(){if(!e(this._northeastChild)){this._northeastChild=new a({tilingScheme:this.tilingScheme,x:this.x*2+1,y:this.y*2,level:this.level+1,parent:this})}return this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<n.DONE}},eligibleForUnloading:{get:function(){var t=true;if(e(this.data)){t=this.data.eligibleForUnloading;if(!e(t)){t=true}}return t}}});a.prototype.freeResources=function(){this.state=n.START;this.renderable=false;this.upsampledFromParent=false;if(e(this.data)&&e(this.data.freeResources)){this.data.freeResources()}o(this._southwestChild);this._southwestChild=undefined;o(this._southeastChild);this._southeastChild=undefined;o(this._northwestChild);this._northwestChild=undefined;o(this._northeastChild);this._northeastChild=undefined};function o(t){if(e(t)){t.freeResources()}}return a});define("Scene/TileReplacementQueue",["../Core/defined"],function(e){"use strict";function t(){this.head=undefined;this.tail=undefined;this.count=0;this._lastBeforeStartOfFrame=undefined}t.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head};t.prototype.trimTiles=function(t){var i=this.tail;var n=true;while(n&&e(this._lastBeforeStartOfFrame)&&this.count>t&&e(i)){n=i!==this._lastBeforeStartOfFrame;var a=i.replacementPrevious;if(i.eligibleForUnloading){i.freeResources();r(this,i)}i=a}};function r(e,t){var r=t.replacementPrevious;var i=t.replacementNext;if(t===e._lastBeforeStartOfFrame){e._lastBeforeStartOfFrame=i}if(t===e.head){e.head=i}else{r.replacementNext=i}if(t===e.tail){e.tail=r}else{i.replacementPrevious=r}t.replacementPrevious=undefined;t.replacementNext=undefined;--e.count}t.prototype.markTileRendered=function(t){var i=this.head;if(i===t){if(t===this._lastBeforeStartOfFrame){this._lastBeforeStartOfFrame=t.replacementNext}return}++this.count;if(!e(i)){t.replacementPrevious=undefined;t.replacementNext=undefined;this.head=t;this.tail=t;return}if(e(t.replacementPrevious)||e(t.replacementNext)){r(this,t)}t.replacementPrevious=undefined;t.replacementNext=i;i.replacementPrevious=t;this.head=t};return t});define("Scene/QuadtreePrimitive",["../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/getTimestamp","../Core/Math","../Core/OrthographicFrustum","../Core/Ray","../Core/Rectangle","../Core/Visibility","./QuadtreeOccluders","./QuadtreeTile","./QuadtreeTileLoadState","./SceneMode","./TileReplacementQueue"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g){"use strict";function _(e){if(!i(e)||!i(e.tileProvider)){throw new a("options.tileProvider is required.")}if(i(e.tileProvider.quadtree)){throw new a("A QuadtreeTileProvider can only be used with a single QuadtreePrimitive")}this._tileProvider=e.tileProvider;this._tileProvider.quadtree=this;this._debug={enableDebugOutput:false,maxDepth:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:false};var t=this._tileProvider.tilingScheme;var n=t.ellipsoid;this._tilesToRender=[];this._tileLoadQueueHigh=[];this._tileLoadQueueMedium=[];this._tileLoadQueueLow=[];this._tileReplacementQueue=new g;this._levelZeroTiles=undefined;this._loadQueueTimeSlice=5;this._addHeightCallbacks=[];this._removeHeightCallbacks=[];this._tileToUpdateHeights=[];this._lastTileIndex=0;this._updateHeightsTimeSlice=2;this.maximumScreenSpaceError=r(e.maximumScreenSpaceError,2);this.tileCacheSize=r(e.tileCacheSize,100);this._occluders=new h({ellipsoid:n});this._tileLoadProgressEvent=new o;this._lastTileLoadQueueLength=0}n(_.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}}});_.prototype.invalidateAllTiles=function(){var e=this._tileReplacementQueue;e.head=undefined;e.tail=undefined;e.count=0;var t=this._levelZeroTiles;if(i(t)){for(var r=0;r<t.length;++r){var n=t[r];var a=n.customData;var o=a.length;for(var s=0;s<o;++s){var l=a[s];l.level=0;this._addHeightCallbacks.push(l)}t[r].freeResources()}}this._levelZeroTiles=undefined;this._tileProvider.cancelReprojections()};_.prototype.forEachLoadedTile=function(e){var t=this._tileReplacementQueue.head;while(i(t)){if(t.state!==m.START){e(t)}t=t.replacementNext}};_.prototype.forEachRenderedTile=function(e){var t=this._tilesToRender;for(var r=0,i=t.length;r<i;++r){e(t[r])}};_.prototype.updateHeight=function(e,t){var r=this;var i={positionOnEllipsoidSurface:undefined,positionCartographic:e,level:-1,callback:t};i.removeFunc=function(){var e=r._addHeightCallbacks;var t=e.length;for(var n=0;n<t;++n){if(e[n]===i){e.splice(n,1);break}}r._removeHeightCallbacks.push(i)};r._addHeightCallbacks.push(i);return i.removeFunc};_.prototype.beginFrame=function(e){var t=e.passes;if(!t.render){return}this._tileProvider.initialize(e);var r=this._debug;if(r.suspendLodUpdate){return}r.maxDepth=0;r.tilesVisited=0;r.tilesCulled=0;r.tilesRendered=0;r.tilesWaitingForChildren=0;this._tileLoadQueueHigh.length=0;this._tileLoadQueueMedium.length=0;this._tileLoadQueueLow.length=0;this._tileReplacementQueue.markStartOfRenderFrame()};_.prototype.update=function(e){var t=e.passes;if(t.render){this._tileProvider.beginUpdate(e);C(this,e);U(this,e);this._tileProvider.endUpdate(e)}if(t.pick&&this._tilesToRender.length>0){this._tileProvider.updateForPick(e)}};_.prototype.endFrame=function(e){var t=e.passes;if(!t.render||e.mode===v.MORPHING){return}R(this,e);B(this,e);var r=this._debug;if(r.suspendLodUpdate){return}if(r.enableDebugOutput){if(r.tilesVisited!==r.lastTilesVisited||r.tilesRendered!==r.lastTilesRendered||r.tilesCulled!==r.lastTilesCulled||r.maxDepth!==r.lastMaxDepth||r.tilesWaitingForChildren!==r.lastTilesWaitingForChildren){console.log("Visited "+r.tilesVisited+", Rendered: "+r.tilesRendered+", Culled: "+r.tilesCulled+", Max Depth: "+r.maxDepth+", Waiting for children: "+r.tilesWaitingForChildren);r.lastTilesVisited=r.tilesVisited;r.lastTilesRendered=r.tilesRendered;r.lastTilesCulled=r.tilesCulled;r.lastMaxDepth=r.maxDepth;r.lastTilesWaitingForChildren=r.tilesWaitingForChildren}}};_.prototype.isDestroyed=function(){return false};_.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var y;var b=new t;function w(e,t){var r=d.center(e.rectangle,b);var i=r.longitude-y.longitude;var n=r.latitude-y.latitude;r=d.center(t.rectangle,b);var a=r.longitude-y.longitude;var o=r.latitude-y.latitude;return i*i+n*n-(a*a+o*o)}function C(e,t){var r=e._debug;if(r.suspendLodUpdate){return}var n;var a;var o=e._tilesToRender;o.length=0;if(!i(e._levelZeroTiles)){if(e._tileProvider.ready){var s=e._tileProvider.tilingScheme;e._levelZeroTiles=p.createLevelZeroTiles(s)}else{return}}e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;var l=e._tileProvider;var u=e._occluders;var c;var d=e._levelZeroTiles;y=t.camera.positionCartographic;d.sort(w);var h=e._addHeightCallbacks;var m=e._removeHeightCallbacks;var v=t.frameNumber;if(h.length>0||m.length>0){for(n=0,a=d.length;n<a;++n){c=d[n];c._updateCustomData(v,h,m)}h.length=0;m.length=0}for(n=0,a=d.length;n<a;++n){c=d[n];e._tileReplacementQueue.markTileRendered(c);if(!c.renderable){if(c.needsLoading){e._tileLoadQueueHigh.push(c)}++r.tilesWaitingForChildren}else if(l.computeTileVisibility(c,t,u)!==f.NONE){T(e,t,c)}else{if(c.needsLoading){e._tileLoadQueueLow.push(c)}++r.tilesCulled}}t.afterRender.push(S(e))}function S(e){return function(){O(e)}}function T(e,t,r){var i=e._debug;++i.tilesVisited;e._tileReplacementQueue.markTileRendered(r);r._updateCustomData(t.frameNumber);if(r.level>i.maxDepth){i.maxDepth=r.level}if(D(e,t,r)<e.maximumScreenSpaceError){if(r.needsLoading){e._tileLoadQueueMedium.push(r)}M(e,r);return}var n=r.southwestChild;var a=r.southeastChild;var o=r.northwestChild;var s=r.northeastChild;var l=n.renderable&&a.renderable&&o.renderable&&s.renderable;var u=n.upsampledFromParent&&a.upsampledFromParent&&o.upsampledFromParent&&s.upsampledFromParent;if(l){if(u){M(e,r);E(e,t.camera.positionCartographic,n,a,o,s);if(r.needsLoading){e._tileLoadQueueMedium.push(r)}}else{P(e,n,a,o,s,t);if(r.needsLoading){e._tileLoadQueueLow.push(r)}}}else{E(e,t.camera.positionCartographic,n,a,o,s);M(e,r);if(r.needsLoading){e._tileLoadQueueLow.push(r)}}}function E(e,t,r,i,n,a){if(t.longitude<r.east){if(t.latitude<r.north){x(e,r);x(e,i);x(e,n);x(e,a)}else{x(e,n);x(e,r);x(e,a);x(e,i)}}else if(t.latitude<r.north){x(e,i);x(e,r);x(e,a);x(e,n)}else{x(e,a);x(e,n);x(e,i);x(e,r)}}function x(e,t){e._tileReplacementQueue.markTileRendered(t);if(t.needsLoading){if(t.renderable){e._tileLoadQueueLow.push(t)}else{e._tileLoadQueueHigh.push(t)}}}function P(e,t,r,i,n,a){var o=a.camera.positionCartographic;var s=e._tileProvider;var l=e._occluders;if(o.longitude<t.rectangle.east){if(o.latitude<t.rectangle.north){A(e,t,s,a,l);A(e,r,s,a,l);A(e,i,s,a,l);A(e,n,s,a,l)}else{A(e,i,s,a,l);A(e,t,s,a,l);A(e,n,s,a,l);A(e,r,s,a,l)}}else if(o.latitude<t.rectangle.north){A(e,r,s,a,l);A(e,t,s,a,l);A(e,n,s,a,l);A(e,i,s,a,l)}else{A(e,n,s,a,l);A(e,i,s,a,l);A(e,r,s,a,l);A(e,t,s,a,l)}}function A(e,t,r,i,n){if(r.computeTileVisibility(t,i,n)!==f.NONE){T(e,i,t)}else{++e._debug.tilesCulled;e._tileReplacementQueue.markTileRendered(t)}}function O(e){var t=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;if(t!==e._lastTileLoadQueueLength){e._tileLoadProgressEvent.raiseEvent(t);e._lastTileLoadQueueLength=t}}function D(e,t,r){if(t.mode===v.SCENE2D||t.camera.frustum instanceof u){return I(e,t,r)}var i=e._tileProvider.getLevelMaximumGeometricError(r.level);var n=r._distance;var a=t.context.drawingBufferHeight;var o=t.camera.frustum.sseDenominator;var s=i*a/(n*o);if(t.fog.enabled){s=s-l.fog(n,t.fog.density)*t.fog.sse}return s}function I(e,t,r){var n=t.camera;var a=n.frustum;if(i(a._offCenterFrustum)){a=a._offCenterFrustum}var o=t.context;var s=o.drawingBufferWidth;var u=o.drawingBufferHeight;var c=e._tileProvider.getLevelMaximumGeometricError(r.level);var d=Math.max(a.top-a.bottom,a.right-a.left)/Math.max(s,u);var f=c/d;if(t.fog.enabled&&t.mode!==v.SCENE2D){f=f-l.fog(r._distance,t.fog.density)*t.fog.sse}return f}function M(e,t){e._tilesToRender.push(t);++e._debug.tilesRendered}function R(e,t){var r=e._tileLoadQueueHigh;var i=e._tileLoadQueueMedium;var n=e._tileLoadQueueLow;var a=e._tileProvider;if(r.length===0&&i.length===0&&n.length===0){return}e._tileReplacementQueue.trimTiles(e.tileCacheSize);var o=s()+e._loadQueueTimeSlice;L(e,t,a,o,r);L(e,t,a,o,i);L(e,t,a,o,n)}function L(e,t,r,i,n){for(var a=0,o=n.length;a<o&&s()<i;++a){var l=n[a];e._tileReplacementQueue.markTileRendered(l);r.loadTile(t,l)}}var N=new c;var k=new t;var F=new e;function B(n,a){var o=n._tileToUpdateHeights;var l=n._tileProvider.terrainProvider;var u=s();var c=n._updateHeightsTimeSlice;var f=u+c;var h=a.mode;var p=a.mapProjection;var m=p.ellipsoid;while(o.length>0){var g=o[0];var _=g.customData;var y=_.length;var b=false;var w;for(w=n._lastTileIndex;w<y;++w){var C=_[w];if(g.level>C.level){if(!i(C.positionOnEllipsoidSurface)){C.positionOnEllipsoidSurface=e.fromRadians(C.positionCartographic.longitude,C.positionCartographic.latitude,0,m)}if(h===v.SCENE3D){var S=m.geodeticSurfaceNormal(C.positionOnEllipsoidSurface,N.direction);var T=m.getSurfaceNormalIntersectionWithZAxis(C.positionOnEllipsoidSurface,11500,N.origin);if(!i(T)){var E=Math.min(r(g.data.minimumHeight,0),-11500);var x=e.multiplyByScalar(S,Math.abs(E)+1,F);e.subtract(C.positionOnEllipsoidSurface,x,N.origin)}}else{t.clone(C.positionCartographic,k);k.height=-11500;p.project(k,F);e.fromElements(F.z,F.x,F.y,F);e.clone(F,N.origin);e.clone(e.UNIT_X,N.direction)}var P=g.data.pick(N,h,p,false,F);if(i(P)){C.callback(P)}C.level=g.level}else if(g.level===C.level){var A=g.children;var O=A.length;var D;for(var I=0;I<O;++I){D=A[I];if(d.contains(D.rectangle,C.positionCartographic)){break}}var M=l.getTileDataAvailable(D.x,D.y,D.level);var R=g.parent;if(i(M)&&!M||i(R)&&i(R.data)&&i(R.data.terrainData)&&!R.data.terrainData.isChildAvailable(R.x,R.y,D.x,D.y)){C.removeFunc()}}if(s()>=f){b=true;break}}if(b){n._lastTileIndex=w;break}else{n._lastTileIndex=0;o.shift()}}}function U(e,t){var r=e._tileProvider;var i=e._tilesToRender;var n=e._tileToUpdateHeights;for(var a=0,o=i.length;a<o;++a){var s=i[a];r.showTileThisFrame(s,t);if(s._frameRendered!==t.frameNumber-1){n.push(s)}s._frameRendered=t.frameNumber}}return _});define("Scene/Globe",["../Core/BoundingSphere","../Core/buildModuleUrl","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/EllipsoidTerrainProvider","../Core/Event","../Core/IntersectionTests","../Core/loadImage","../Core/Ray","../Core/Rectangle","../Renderer/ShaderSource","../Renderer/Texture","../Shaders/GlobeFS","../Shaders/GlobeVS","../Shaders/GroundAtmosphere","../ThirdParty/when","./GlobeSurfaceShaderSet","./GlobeSurfaceTileProvider","./ImageryLayerCollection","./QuadtreePrimitive","./SceneMode","./ShadowMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P){"use strict";function A(e){e=n(e,u.WGS84);var r=new c({ellipsoid:e});var i=new T;this._ellipsoid=e;this._imageryLayerCollection=i;this._surfaceShaderSet=new C;this._surfaceShaderSet.baseVertexShaderSource=new v({sources:[b,y]});this._surfaceShaderSet.baseFragmentShaderSource=new v({sources:[_]});this._surface=new E({tileProvider:new S({terrainProvider:r,imageryLayers:i,surfaceShaderSet:this._surfaceShaderSet})});this._terrainProvider=r;this._terrainProviderChanged=new d;this.show=true;this.oceanNormalMapUrl=t("Assets/Textures/waterNormalsSmall.jpg");this._oceanNormalMapUrl=undefined;this.maximumScreenSpaceError=2;this.tileCacheSize=100;this.enableLighting=false;this.lightingFadeOutDistance=65e5;this.lightingFadeInDistance=9e6;this.showWaterEffect=true;this.depthTestAgainstTerrain=false;this.shadows=P.RECEIVE_ONLY;this._oceanNormalMap=undefined;this._zoomedOutOceanSpecularIntensity=.5}o(A.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){if(e!==this._terrainProvider){this._terrainProvider=e;this._terrainProviderChanged.raiseEvent(e)}}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}}});function O(t){return function(r,i){var n=e.distanceSquaredTo(r.pickBoundingSphere,t);var a=e.distanceSquaredTo(i.pickBoundingSphere,t);return n-a}}var D=[];var I={start:0,stop:0};A.prototype.pick=function(t,i,n){if(!a(t)){throw new l("ray is required")}if(!a(i)){throw new l("scene is required")}var o=i.mode;var s=i.mapProjection;var u=D;u.length=0;var c=this._surface._tilesToRender;var d=c.length;var h;var p;for(p=0;p<d;++p){h=c[p];var m=h.data;if(!a(m)){continue}var v=m.pickBoundingSphere;if(o!==x.SCENE3D){e.fromRectangleWithHeights2D(h.rectangle,s,m.minimumHeight,m.maximumHeight,v);r.fromElements(v.center.z,v.center.x,v.center.y,v.center)}else{e.clone(m.boundingSphere3D,v)}var g=f.raySphere(t,v,I);if(a(g)){u.push(m)}}u.sort(O(t.origin));var _;d=u.length;for(p=0;p<d;++p){_=u[p].pick(t,i.mode,i.mapProjection,true,n);if(a(_)){break}}return _};var M=new r;var R=new r;var L=new i;var N=new p;function k(e,t){return m.contains(e.rectangle,t)?e:undefined}A.prototype.getHeight=function(e){if(!a(e)){throw new l("cartographic is required")}var t=this._surface._levelZeroTiles;if(!a(t)){return}var i;var o;var s=t.length;for(o=0;o<s;++o){i=t[o];if(m.contains(i.rectangle,e)){break}}if(!a(i)||!m.contains(i.rectangle,e)){return undefined}while(i.renderable){i=k(i.southwestChild,e)||k(i.southeastChild,e)||k(i.northwestChild,e)||i.northeastChild}while(a(i)&&(!a(i.data)||!a(i.data.pickTerrain))){i=i.parent}if(!a(i)){return undefined}var u=this._surface._tileProvider.tilingScheme.ellipsoid;var c=r.fromRadians(e.longitude,e.latitude,0,u,M);var d=N;var f=u.geodeticSurfaceNormal(c,d.direction);var h=u.getSurfaceNormalIntersectionWithZAxis(c,11500,d.origin);if(!a(h)){var p=Math.min(n(i.data.minimumHeight,0),-11500);var v=r.multiplyByScalar(f,Math.abs(p)+1,R);r.subtract(c,v,d.origin)}var g=i.data.pick(d,undefined,undefined,false,R);if(!a(g)){return undefined}return u.cartesianToCartographic(g,L).height};A.prototype.beginFrame=function(e){if(!this.show){return}var t=this._surface;var r=t.tileProvider;var i=this.terrainProvider;var n=this.showWaterEffect&&i.ready&&i.hasWaterMask;if(n&&this.oceanNormalMapUrl!==this._oceanNormalMapUrl){var o=this.oceanNormalMapUrl;this._oceanNormalMapUrl=o;if(a(o)){var s=this;w(h(o),function(t){if(o!==s.oceanNormalMapUrl){return}s._oceanNormalMap=s._oceanNormalMap&&s._oceanNormalMap.destroy();s._oceanNormalMap=new g({context:e.context,source:t})})}else{this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}}var l=e.mode;var u=e.passes;if(u.render){if(l===x.SCENE3D){this._zoomedOutOceanSpecularIntensity=.5}else{this._zoomedOutOceanSpecularIntensity=0}t.maximumScreenSpaceError=this.maximumScreenSpaceError;t.tileCacheSize=this.tileCacheSize;r.terrainProvider=this.terrainProvider;r.lightingFadeOutDistance=this.lightingFadeOutDistance;r.lightingFadeInDistance=this.lightingFadeInDistance;r.zoomedOutOceanSpecularIntensity=this._zoomedOutOceanSpecularIntensity;r.hasWaterMask=n;r.oceanNormalMap=this._oceanNormalMap;r.enableLighting=this.enableLighting;r.shadows=this.shadows;t.beginFrame(e)}};A.prototype.update=function(e){if(!this.show){return}var t=this._surface;var r=e.passes;if(r.render){t.update(e)}if(r.pick){t.update(e)}};A.prototype.endFrame=function(e){if(!this.show){return}if(e.passes.render){this._surface.endFrame(e)}};A.prototype.isDestroyed=function(){return false};A.prototype.destroy=function(){this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy();this._surface=this._surface&&this._surface.destroy();this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy();return s(this)};return A});define("Shaders/PostProcessFilters/PassThrough",[],function(){"use strict";return"uniform sampler2D u_texture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main() \n{\n    gl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"});define("Scene/GlobeDepth",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/PassThrough"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";function d(){this._colorTexture=undefined;this._depthStencilTexture=undefined;this._globeDepthTexture=undefined;this.framebuffer=undefined;this._copyDepthFramebuffer=undefined;this._clearColorCommand=undefined;this._copyColorCommand=undefined;this._copyDepthCommand=undefined;this._viewport=new e;this._rs=undefined;this._useScissorTest=false;this._scissorRectangle=undefined;this._debugGlobeDepthViewportCommand=undefined}function f(e,t,i){if(!r(e._debugGlobeDepthViewportCommand)){var n="uniform sampler2D u_texture;\n"+"varying vec2 v_textureCoordinates;\n"+"void main()\n"+"{\n"+"    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n"+"    float n_range = czm_depthRange.near;\n"+"    float f_range = czm_depthRange.far;\n"+"    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n"+"    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n"+"    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n"+"}\n";e._debugGlobeDepthViewportCommand=t.createViewportQuadCommand(n,{uniformMap:{u_texture:function(){return e._globeDepthTexture}},owner:e})}e._debugGlobeDepthViewportCommand.execute(t,i)}function h(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy();e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy();e._globeDepthTexture=e._globeDepthTexture&&!e._globeDepthTexture.isDestroyed()&&e._globeDepthTexture.destroy()}function p(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy();e._copyDepthFramebuffer=e._copyDepthFramebuffer&&!e._copyDepthFramebuffer.isDestroyed()&&e._copyDepthFramebuffer.destroy()}function m(e,t,r,i){e._colorTexture=new u({context:t,width:r,height:i,pixelFormat:n.RGBA,pixelDatatype:s.UNSIGNED_BYTE});e._depthStencilTexture=new u({context:t,width:r,height:i,pixelFormat:n.DEPTH_STENCIL,pixelDatatype:s.UNSIGNED_INT_24_8});e._globeDepthTexture=new u({context:t,width:r,height:i,pixelFormat:n.RGBA,pixelDatatype:s.UNSIGNED_BYTE})}function v(e,t){e.framebuffer=new o({context:t,colorTextures:[e._colorTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:false});e._copyDepthFramebuffer=new o({context:t,colorTextures:[e._globeDepthTexture],destroyAttachments:false})}function g(e,t,i,n){var a=e._colorTexture;var o=!r(a)||a.width!==i||a.height!==n;if(!r(e.framebuffer)||o){h(e);p(e);m(e,t,i,n);v(e,t)}}function _(i,n,o,s,u){i._viewport.width=o;i._viewport.height=s;var d=!e.equals(i._viewport,u.viewport);var f=d!==i._useScissorTest;i._useScissorTest=d;if(!e.equals(i._scissorRectangle,u.viewport)){i._scissorRectangle=e.clone(u.viewport,i._scissorRectangle);f=true}if(!r(i._rs)||!e.equals(i._viewport,i._rs.viewport)||f){i._rs=l.fromCache({viewport:i._viewport,scissorTest:{enabled:i._useScissorTest,rectangle:i._scissorRectangle}})}if(!r(i._copyDepthCommand)){var h="uniform sampler2D u_texture;\n"+"varying vec2 v_textureCoordinates;\n"+"void main()\n"+"{\n"+"    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n"+"}\n";i._copyDepthCommand=n.createViewportQuadCommand(h,{uniformMap:{u_texture:function(){return i._depthStencilTexture}},owner:i})}i._copyDepthCommand.framebuffer=i._copyDepthFramebuffer;if(!r(i._copyColorCommand)){i._copyColorCommand=n.createViewportQuadCommand(c,{uniformMap:{u_texture:function(){return i._colorTexture}},owner:i})}i._copyDepthCommand.renderState=i._rs;i._copyColorCommand.renderState=i._rs;if(!r(i._clearColorCommand)){i._clearColorCommand=new a({color:new t(0,0,0,0),stencil:0,owner:i})}i._clearColorCommand.framebuffer=i.framebuffer}d.prototype.executeDebugGlobeDepth=function(e,t){f(this,e,t)};d.prototype.update=function(e,t){var r=e.drawingBufferWidth;var i=e.drawingBufferHeight;g(this,e,r,i);_(this,e,r,i,t);e.uniformState.globeDepthTexture=undefined};d.prototype.executeCopyDepth=function(e,t){if(r(this._copyDepthCommand)){this._copyDepthCommand.execute(e,t);e.uniformState.globeDepthTexture=this._globeDepthTexture}};d.prototype.executeCopyColor=function(e,t){if(r(this._copyColorCommand)){this._copyColorCommand.execute(e,t)}};d.prototype.clear=function(e,i,n){var a=this._clearColorCommand;if(r(a)){t.clone(n,a.color);a.execute(e,i)}};d.prototype.isDestroyed=function(){return false};d.prototype.destroy=function(){h(this);p(this);if(r(this._copyColorCommand)){this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()}if(r(this._copyDepthCommand)){this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy()}var e=this._debugGlobeDepthViewportCommand;if(r(e)){e.shaderProgram=e.shaderProgram.destroy()}return i(this)};return d});define("Scene/GoogleEarthEnterpriseImageryProvider",["../Core/Credit","../Core/decodeGoogleEarthEnterpriseData","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/GoogleEarthEnterpriseMetadata","../Core/loadArrayBuffer","../Core/loadImageFromTypedArray","../Core/Math","../Core/Rectangle","../Core/Request","../Core/RequestType","../Core/RuntimeError","../Core/TileProviderError","../ThirdParty/protobuf-minimal","../ThirdParty/when"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_){"use strict";function y(){this._image=new Image}y.prototype.isReady=function(){return true};y.prototype.shouldDiscardImage=function(e){return e===this._image};function b(t){t=r(t,r.EMPTY_OBJECT);if(!(i(t.url)||i(t.metadata))){throw new a("options.url or options.metadata is required.")}var n;if(i(t.metadata)){n=this._metadata=t.metadata}else{n=this._metadata=new l({url:t.url,proxy:t.proxy})}this._tileDiscardPolicy=t.tileDiscardPolicy;this._proxy=r(t.proxy,this._metadata.proxy);this._tilingScheme=new s({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new f(-d.PI,-d.PI,d.PI,d.PI),ellipsoid:t.ellipsoid});var u=t.credit;if(typeof u==="string"){u=new e(u)}this._credit=u;this._tileWidth=256;this._tileHeight=256;this._maximumLevel=23;if(!i(this._tileDiscardPolicy)){this._tileDiscardPolicy=new y}this._errorEvent=new o;this._ready=false;var c=this;var h;this._readyPromise=n.readyPromise.then(function(e){if(!n.imageryPresent){var t=new m("The server "+n.url+" doesn't have imagery");h=v.handleError(h,c,c._errorEvent,t.message,undefined,undefined,undefined,t);return _.reject(t)}v.handleSuccess(h);c._ready=e;return e}).otherwise(function(e){h=v.handleError(h,c,c._errorEvent,e.message,undefined,undefined,undefined,e);return _.reject(e)})}n(b.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this._ready){throw new a("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this._ready){throw new a("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready){throw new a("maximumLevel must not be called before the imagery provider is ready.")}return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready){throw new a("minimumLevel must not be called before the imagery provider is ready.")}return 0}},tilingScheme:{get:function(){if(!this._ready){throw new a("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},rectangle:{get:function(){if(!this._ready){throw new a("rectangle must not be called before the imagery provider is ready.")}return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready){throw new a("tileDiscardPolicy must not be called before the imagery provider is ready.")}return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return false}}});b.prototype.getTileCredits=function(e,t,r){if(!this._ready){throw new a("getTileCredits must not be called before the imagery provider is ready.")}var n=this._metadata;var o=n.getTileInformation(e,t,r);if(i(o)){var s=n.providers[o.imageryProvider];if(i(s)){return[s]}}return undefined};b.prototype.requestImage=function(e,r,n,o){if(!this._ready){throw new a("requestImage must not be called before the imagery provider is ready.")}var s=this._tileDiscardPolicy._image;var d=this._metadata;var f=l.tileXYToQuadKey(e,r,n);var p=d.getTileInformation(e,r,n);if(!i(p)){if(d.isValid(f)){var m=new h({throttle:o.throttle,throttleByServer:o.throttleByServer,type:o.type,priorityFunction:o.priorityFunction});d.populateSubtree(e,r,n,m);return undefined}return s}if(!p.hasImagery()){return s}var v=w(this,p,e,r,n);var g=u(v,undefined,o);if(!i(g)){return undefined}return g.then(function(e){t(d.key,e);var r=new Uint8Array(e);var n;var a=d.protoImagery;if(!i(a)||!a){n=C(r)}if(!i(n)&&(!i(a)||a)){var o=S(r);n=o.imageType;r=o.imageData}if(!i(n)||!i(r)){return s}return c(r,n)})};b.prototype.pickFeatures=function(e,t,r,i,n){return undefined};function w(e,t,r,n,a){var o=l.tileXYToQuadKey(r,n,a);var s=t.imageryVersion;s=i(s)&&s>0?s:1;var u=e.url+"flatfile?f1-0"+o+"-i."+s.toString();var c=e._proxy;if(i(c)){u=c.getURL(u)}return u}function C(e){var t="JFIF";if(e[6]===t.charCodeAt(0)&&e[7]===t.charCodeAt(1)&&e[8]===t.charCodeAt(2)&&e[9]===t.charCodeAt(3)){return"image/jpeg"}var r="PNG";if(e[1]===r.charCodeAt(0)&&e[2]===r.charCodeAt(1)&&e[3]===r.charCodeAt(2)){return"image/png"}return undefined}function S(e){var t=g.Reader.create(e);var r=t.len;var n={};while(t.pos<r){var a=t.uint32();switch(a>>>3){case 1:n.imageType=t.uint32();break;case 2:n.imageData=t.bytes();break;case 3:n.alphaType=t.uint32();break;case 4:n.imageAlpha=t.bytes();break;case 5:var o=n.copyrightIds;if(!i(o)){o=n.copyrightIds=[]}if((a&7)===2){var s=t.uint32()+t.pos;while(t.pos<s){o.push(t.uint32())}}else{o.push(t.uint32())}break;default:t.skipType(a&7);break}}var l=n.imageType;if(i(l)){switch(l){case 0:n.imageType="image/jpeg";break;case 4:n.imageType="image/png";break;default:throw new m("GoogleEarthEnterpriseImageryProvider: Unsupported image type.")}}var u=n.alphaType;if(i(u)&&u!==0){console.log("GoogleEarthEnterpriseImageryProvider: External alpha not supported.");delete n.alphaType;delete n.imageAlpha}return n}return b});define("Scene/GoogleEarthEnterpriseMapsProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/loadText","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./ImageryProvider"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";function p(i){i=t(i,{});if(!r(i.url)){throw new n("options.url is required.")}if(!r(i.channel)){throw new n("options.channel is required.")}this._url=i.url;this._path=t(i.path,"/default_map");this._tileDiscardPolicy=i.tileDiscardPolicy;this._proxy=i.proxy;this._channel=i.channel;this._requestType="ImageryMaps";this._credit=new e("Google Imagery",p._logoData,"http://www.google.com/enterprise/mapsearth/products/earthenterprise.html");this.defaultGamma=1.9;this._tilingScheme=undefined;this._version=undefined;this._tileWidth=256;this._tileHeight=256;this._maximumLevel=i.maximumLevel;this._imageUrlTemplate=this._url+this._path+"/query?request={request}&channel={channel}&version={version}&x={x}&y={y}&z={zoom}";this._errorEvent=new a;this._ready=false;this._readyPromise=f.defer();var h=this._url+this._path+"/query?request=Json&vars=geeServerDefs&is2d=t";var m=this;var v;function g(e){var t;try{t=JSON.parse(e)}catch(r){t=JSON.parse(e.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}var n;for(var a=0;a<t.layers.length;a++){if(t.layers[a].id===m._channel){n=t.layers[a];break}}var s;if(!r(n)){s="Could not find layer with channel (id) of "+m._channel+".";v=c.handleError(v,m,m._errorEvent,s,undefined,undefined,undefined,y);throw new u(s)}if(!r(n.version)){s="Could not find a version in channel (id) "+m._channel+".";v=c.handleError(v,m,m._errorEvent,s,undefined,undefined,undefined,y);throw new u(s)}m._version=n.version;if(r(t.projection)&&t.projection==="flat"){m._tilingScheme=new o({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new l(-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:i.ellipsoid})}else if(!r(t.projection)||t.projection==="mercator"){m._tilingScheme=new d({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:i.ellipsoid})}else{s="Unsupported projection "+t.projection+".";v=c.handleError(v,m,m._errorEvent,s,undefined,undefined,undefined,y);throw new u(s)}m._imageUrlTemplate=m._imageUrlTemplate.replace("{request}",m._requestType).replace("{channel}",m._channel).replace("{version}",m._version);m._ready=true;m._readyPromise.resolve(true);c.handleSuccess(v)}function _(e){var t="An error occurred while accessing "+h+".";v=c.handleError(v,m,m._errorEvent,t,undefined,undefined,undefined,y);m._readyPromise.reject(new u(t))}function y(){var e=!r(m._proxy)?h:m._proxy.getURL(h);var t=s(e);f(t,g,_)}y()}i(p.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){if(!this._ready){throw new n("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this._ready){throw new n("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready){throw new n("maximumLevel must not be called before the imagery provider is ready.")}return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready){throw new n("minimumLevel must not be called before the imagery provider is ready.")}return 0}},tilingScheme:{get:function(){if(!this._ready){throw new n("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},version:{get:function(){if(!this._ready){throw new n("version must not be called before the imagery provider is ready.")}return this._version}},requestType:{get:function(){if(!this._ready){throw new n("requestType must not be called before the imagery provider is ready.")}return this._requestType}},rectangle:{get:function(){if(!this._ready){throw new n("rectangle must not be called before the imagery provider is ready.")}return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready){throw new n("tileDiscardPolicy must not be called before the imagery provider is ready.")}return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return true}}});p.prototype.getTileCredits=function(e,t,r){return undefined};p.prototype.requestImage=function(e,t,r,i){if(!this._ready){throw new n("requestImage must not be called before the imagery provider is ready.")}var a=m(this,e,t,r);return h.loadImage(this,a,i)};p.prototype.pickFeatures=function(e,t,r,i,n){return undefined};p._logoData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAAnCAYAAACmP2LfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAHdElNRQfcDB4TJDr1mp5kAAAAGnRFWHRTb2Z0d2FyZQBQYWludC5ORVQgdjMuNS4xMDD0cqEAAB1zSURBVHhe7ZwHeFTFFsf/u+l9N70npOxuSAKEFFIhCSH0qhEQUHkgKCgWUFGBB6IoCAoo0ntooaRvEkIIBBBpoYSa3nvvfd+5u4sQUigPfMX8v2/Y3Tkzs3fv/d0z58zcgF69Ql1SY+MM1wQJem44ZeiJk8beEOqPwG6uC7ZqyElb9eo/JZEIkH2nRQkBIlNMauuPCS3uGN/kjkmNDghoskBAgzrZ2NLmf1+JwIKQpYsoxdmIV9+N07onCegzBPM9bOdmYKnazF6g/1N6UySPqSJzvCaaiLHtP8G/Phq+FRfgU5ogKWUXMLT6Mvzqr2BE40mMadqO8c3zMabBC6PqDDC8SlY60t9HByCLVTKu+ERmHr5TWI9wjVxEaOZivWo1pil8D1tZeWnLXv1l8iZ3PF2kjymiWRgvCoJv5U243IyAXcQq8A9Mg9W+4bDe6wv+kVGwCZkL+4Sf4ZR+BZ5VGQR3EkbWn8Hopm3wq54Lz2JD6ah/P21XGopQ9Qoc16jGSqVyTJWbQbUsibFXf42mihTwZpsvAtp3k0dOhFOSEH1+ngaDefrgjFCgFkxY8fCisCBvKgODzxRh9qslBFGfYmDGLbiV5mBwRRo8KtPhVBgPu8teMP7u73chD6kMRYRGBY5xqrFKqQwz5SdTbS/Qf5mmUYw8rf01CjHC4VP7AHZxO6E3qy9ZZCQNnio2rE/4o9/tkxiQUYp+KRXgx8XC5FsXcLz/hkCrDUU4pxLHuDVYpdwL9F+qqSJZKlPwenskfOoI5tN7YPCJGVme7wKYr5EBXzgYfW+mwTI0Gjrznaj2WW+I/y8dVPdDGLcKRzXrsEqlHO8oTKHaXqAZWe9hQXCi63NhHWYI3ilfWIW/YLjqL2JRiOFBJRz+LffhcPs09D+0J8vzn3zXdBnYnp8Mi6NboTWzH9X8fVc+DhDQodxqAroe36lU9AJNWr4cEAjNwI8OAC9cT1rbUfzwGeCfKiL7dGnNc+q1NiO80b4BY1oT4V6WDcsdc6j2xbyq4wMWrA9rQmeWFn36ey/jBaoPQ4hmLYI0G/AtAf22fC/QDols8ITrIYi/Bl6knbS2o3gRbxHQxQQ0k0S/gCa2v4OJovPwacqAQ1ICjL40klr+UrWoQbFBETo18jCpZsOoFODkvuCNJYoHW3QKXFEM7ETRcKfiQe8d6NVIFImXvg4skhY40mxnQYVRIIeA1qrHEc1GrFSpxFtP99AiFbDbNKDZpAzzGkVYVcvBuBJQEo/9/6C+dyjPitwLwak74D8V6Bfw0P5VShjXFoTR7TfhUZkL29M/wfATJan1lauWC3aDOgyaVDCuTgbf1bFkfmtkye1ogsK2asivLYfCglIoD8qCknI2NHuG4QSVGMgQyMbt0fioRYh9VYcRU7QX55uDcaHtFOJEsThMtmWtQgxsDodsWaC0c3ea3MzGBJEqxrfbYmzr6xjfPAeTmt5HQPO7eK1xDibUz8eY+k8xtHYJPCtXwvHOu7AXMrMTsF/TH8HajTis1YwVqpWY0TXQDKy1OpBr5EJA52Fukxx+bmKxtjWx2DuaWawNlZD5qhzyo9KhpHAbKpJO/6t65UCPbPHA2PYrGNacgkElabCJJDev/MpDhUKKnuq44LRoYEK1IiswkS1zYCfk5y+F0qjvoTwqBOof34dGeAnUL1ZCLboEnJ9zoe0QD/Nuj00UBVXRabzVLETM3S0ICfwA8yc7Y6C3ANYbZsA7aQ1W1xzEfZEQ6dT2BkG9pP4ouo7jGE1u42JS20QMrzkCr4xwuN4+AM+cYII3EaNar2J86zmMrP8DHulCON4NhU3YWuhOYy6SZENpH9cfx7WacFC7BSvUqjBDsRPQIiugURvazeqYVaqAw6dYrJ9WQy7gayj4nYDy3HtQOVQGpYRqKEWXQf2HdGha/AFdae9Xr4czz0ubISRA75ECbSut7agegO75OLxpahze8j5GtifBpzEDLiV30Dd2mNT6StWiCbVmLt5rUkBQCEt2zWzIMSA8HgrIBkLD+Sp0jhHISYXQ/KMYukfvQ3fQxq68XCTBHId/tMTg7LV1CFs4BszJ6hBarBgHlcRv8H7tbuSKQpFPYGe0BmND+nZ0npECaPKf0r4UIxsuoF/IMpitsAVnrA4s15uh3x8fwLXkLobUZGJIXTqcUzbDaJE5FAVq0t4S7dEcjqMEc6B2K5arVWN6Z6AbdOmm5mJelQKOHWSxF44Cy4CqxW0s6RwchCovFRohdGNfLgX3WiZ0N4aD++y7jfwYJUrAPCle/ZjKV+BFTSegrGAZIm3QjXhBytTWB3zhByzryMUU986jz16wD+96ijCNUIAgmkc3tS6G7GERjCbgR82B4OTbEESqIiCIcqsIYzoGGyrBEMSmgh8xBoIIAR2fAHZhj8Z9DOhl9FHeKkSDvn809fuc+iyCddRYaiOZBTvIt1YJfs0b4N+WDO+GHPLQN2Ab7S61vjJV60C9SRPvNSqzTpxlyQfS1dGUmjppK7gW16B/LhN6abnQu5cDwzO3YNhhqqK4WJY887sEdGzWFpxfOxmDpKZOOvgWFB8sx9L6nShvP4FyUQjKGg5gScpGKEqbUE7RxiGYv6QQ4zIG/r4D2m88sjEy/EIW/a6+TQ4gHe5VhXCvy4JL7gLYnesI2i6t4Tii04r92u1YKt767gB0ozrkGzmY26zEOh7Hkt+kAKhLTX9qOVVdg9aoNOjcToR+wUVKLYKgN0Zq7l7884wn9CKgr4AfWw/B6SwqKQRKOdXVghe9CpbherASSjtIpGpxRIHFjwygNreoXy0lb+lU7lHJBP9kPcGXQnBNghUB/Lh44fbUp5JA+5Hs71LbPPLCVRDEJZDNGIJgeQI6mG6KegKzldq1U7tGKjQmHR8vwl86kgRoAQN0xBw6ztn0nQ/ocxEdQ7L4d/BjG6g+m8aZTL/xsXPuW82Fb8t+DG1Ox5D6XAwqvQ67OA+p9ZWoUQPsei78mjSwNU9GLmEzVGZJTd3qFPTn3YZhXgYMMjNhlHsDxms/hNWfoUdrNPgEc2h7BG5d/Bo7Blt0BuNxXf4MVmXrkdRyEHWiY6hr2oc7mevRX2wc18gioEeI1+N9a+/CNnImVAZ0mhEoNOPAJT8MHjUF8KTiWhqHgbfMpVaJdhLQh3XasU9bJAZ6ekeg6zQwgEKuLSWysmd3QGmatLqD8qDNug3dCX/AIPk4jGr2wDB/JXTmkan70IvmZTY/rB9BdZlKLkG0lG0d5klAObKsw1+jzyFiWPnRawiaDrMYwTyMwMwh220WP2IWFVfqN4CKO8E3n0C6R/ZUej9Y2kUiMdDRFTRePH3nA3q/m7xpAEtAXl0QrkTwscnmS/3eptdzNEYevZLnZ5booqk8tuYs9tAny+n1LL1mghezlcULH0VtHamOZhvhIvoNOXQsd2EZIbluYnlWaMO75TCFG9kYXJ8H14o76H/10Z3yClSrCm6jGtbWK7LC7kIlYRfUmY2XHnUa+mbXYRSfCuNCptyE6b1jMBD/EPKwchQPLxGdxOWWI8iKXYBPqLozgI8pfA5YBWvxbfMeNLUfRmPTLjRnr8YKsdGvRQ5j2zZTSSRQ78H+7GhxfScFAINypsG9ukDspZ0LKKE+O0pqlGi71ggcIqD3dga6RhFKjSqYT+VEFkvu/E9Q+HNWKaE2VVDgVkPFqwAaay5CN3En9M59BM2vfKDs7AvljjPGE5LlharQdL+LoCmhOHU0rIUyD+NgVTOa+q2iVQiIcAKpHtbhXuJOjPqeVCRYThNE6VTvKNs3hM3cHGIxntxKyCbP7Erj1lHZJbVIJAG6iiCroZCAPGukvOyASJbvCgoaAoKoAQ1kHcGC7nmZDkmhBR2PfSQLtkcl4zCSAE2eO6qExYuYxrE4KqdvelBiM4+ncYQy1IY8d0wbhUSLJAZGbsUceNYdwJCGPAyuy4NbZToG3JoO1Qk9AvHvqF4ejo0KCKlisyl04Jw+AE1ma71HRUJP+QqM1t2HcVEyTEoSYVYQCuN3HenCt4XDhGA+KorAnYZ9KIj5ELOl3XpU/k/wrt+OmraDaG7cjpacbxFvYAAZDG5Vw/DWCxjRdp+ATsWAS6+D69H1+XDNsoVb1T06b0VwzCmBIOYdqUWibTojcFBH1CXQctBtUcA6Oh/RmVC4sBmKA5j6erC1qqE4sRpqG25A43QIOHuXgvOmP5R4ZH6m5UY2L9SSLjZ5sKjjsI/o8olH8ngjCZoSgmw9DMIl3t42Up0g+pq89/sEjLK47knZhSkSuDepJP4JOyNJyEFAR8VQKMOR1nbWM69yxNJYwh+VLE90ffPyxLE3EwL9Jq0huWQqwL1iA7zq8+FVl0+epgBO6T+gb2TH+OglqgastxtZrNNlkLt8E5oJx6HZdab7mFZBk3UZRjMewCT7HkzLfodZxREYr5sBjiIBPYiAPt8ehvSGPSg5vwjzpd16VNkmmDTswp22QDTXbkJrxhJkzHGDFoUQmvBpvo2hrZl0TnLhlLIYfUO7nt7dSg3hURcP1/JiDEgphuXBqVKLRFsfA3oJAf3mI6Cr2OjTwGYdqWGzzmZD6WoYVCfehdqsZKjuuwS1oB1Q+5piHac3oaxBzZ9vLZ4nHEeesoXg6niDPSYWP9yUgD5PHu48eKE64krHcErchHIEuRysTpAXjObQWIYEHiV4EQYEojp5aEoyY+IIpOQugKYYOnIdJXrdJ63PtWwXMQM6m6SVT4gfZkbHV0XHsVtaQ3K8yoJr0YfwoHDDq5ZiQSqDik/B4Q9taYtn18gyNia1qGJsmTrGlUjK2FJ1jCjRwOASDnkxDvN95ZD/og5yl0qgfCMJ2leDoeksHaFHXYOJVyrMkm/DrPwMzGr2wmjnLGipthyHL0W7t9pDkduwF2U3lmGFtvbTdyirt0OreT+iWwPRUrUBbSkLkT/fCUZwKVYikBMwpDlPXNzLwuAQ2rWX8KzUh2dDDJyLSmB7/S5Mf3WRWiR6CPSezkCXQs6qBnLCKsheyoXqnTCoL9oOFd9/Qtl9KJT6UJMX3/zhCz8iuCjhiviSYtMx3ZTJBN8lCE7eIRgF0p6krRRaRBDskTTGySBKws5SuUjJHYUiMQdpzCUE0Q3y5MnSDhJJQg5JUvjSgO5hHZofaioGmvc40IycMgbRtJktjgOZ5Ma9irzSg46xYHcaVEZevkgBHqUWGFK+FENKQ+BdGAq/wiMYWbwHI6h4FwTDOes0BMKFMHxPNg9qn1dANakYanfuQSs5FJoTpaP1qBswsSGgb9+EeUU0Af0LDH4dBhXlmv3wajuOpPYQFDcEojxtNQ6sn9ZzUsiofjfUWg/iYOt+tJatRtvN95DqZgxNuKTKwLV4Jdyqc8Wz1uCGTLjmDIVDQqewQ8anwpJi6GsYkF4Ey2O/QvsfXKlJIgboAwT07s5AZ0G1TylUIsuhdKMI6vcuQ3PVAqg+9UZ8JvGEywiuNoIwD4IzaV2X+HSa1otgE3+NwJImVkycG0kx8snfyUZJW+QFApeSu+hN9BpIn6n+ZBp9bqDv+C8Fum+8IpzzJNOmR3UhTaGFcC07iAHXmamuZw28C/S/aIt+CcthF7+ToN0EQdhqOFzcBu/Sm/ApvAGX3DzYXIiF9jtWTJf74L6ZC83UfGg8SId2xnloSZKxp+gWjC0J6KSrMK8KhmnlSugtInpkCzaBV78Hl5oPoaLpECrLt+Bi4jfgS7t1q+YDUGsPwj5KDFsLlqD97JuIpmpZmP+TftM1ezjlxsOllM4H3eReDWHwKrOBW84jqMeK5OBTv4Bu6HxxgqU1s/N3MkAHSoH+ioCe+gjoJHB0s8ENLID6/UJo3E+GVlwoNEwY278tXhR50RhmeexzgmM8JXjdF36MHwEoiXn70Csv6gxBm8PiRc6gJFD1HDzFpq1cP0omo5QJZAfqQzH0f6uHZjQgeR4cC/IJZCnUtSkYVPAWBiX2/CdU/S7Ql+9TgtFCTaiP0qAEXA2yRsqwuzECziWZcM4tgv2DSljF7ID+l+JNh9+hY38HuvcYmLOhk5EEnVPfQOmpW+33YGaXhj53E2BWuxvGebOh5cPUX/sWSgXrsa9mB2qaDqCK4C7I2IA3jn8u7tat2g6D034MIbWb0fZgHlr2DscXUhNNuYdkYRPrg/7JiXDMLYBrZS6GNEZgVJM/JjWY4I16G4xr/BCDq2nKjjoAvY+Zpwo7eXBskQK9Swr0lEdAn4a2wk3o/DMNWmn54KYUQIuZsebGQuXFQ42H4kfNk4QckSOkNZ1lGkGAUoInOKkAm2jJsVtH+om9Nj9ytZxNcNdhljXByo+JJXj/i4G2u2xM02YInPJLxFB7VudTPH0ZHkWu0hbPpwHpfnAszoFDVgVsb1fDMmoL9L8S7wTFQE/1AvR33oB+QSp0czKgl34B2iO9uwJCKib5SGaZjbqLPlkhMG1YDr1gQyioSs24vQTDitagsnIL6loCUVu9C2EJK9FjYtsWBNP2Q7hb9A155zdwY5mTeGexo0w32hEcy2F7JQaOqZfgk38KY6rDMKFBiGHNt+iGPgCNYd0/s/sbAb2fgN5JQC9Wq8bkR0AzioOOx3Xo30mGbnY+tNMKoJOQCm03qfnFxRf6E1yUFAqZJcyuZRWuQmB+TWHJcgJfkjPxImcSSIUsXviMx/O9DvqfALrPDjb6nhuBAWkZ5JFKKTYuIqhz4FUdAo9CGwzO7Ra2LjUg0w9OxdlwyKxAXzHQm8lDi4HeAT1WMPSHnYXR7aswKE6Gfl4K9PdfgZ6+uG8XSmMbKyXD/LsEmFduglH2NHA7rA3Hvg+Ve1/gYO4KNFRvQUPLQVRU7MG4yn1dJ4eiULAo3JhW9xsa77+Hml8GY8FQ425uAM5wRRivNoPlTjs4XhoH35oLGFZ/S/wglyDkbWmrrsUAvY+A3kHlSwJ6ihKzCvLnuQyElmIs9LdfhmHxA+jn5kI3jcrRFOjxU6DTbTx9DybsOBh0f034EeYEVyaFD0IYhnQ9y1pTIsiPvU5AnKYkUBL78yKmQhDLgDRPSWtPp/HFkFtHqFCfRBr73wX67qsD+qFsEubCnqKBAZllcCkkT12RjSHVMfApH0bJXfcH+aQGZg6FU1EWeeoK2NwgoMM3Q++zP/fq/Smf2g392ZEwzk2Acfl9GBHURmuSYPyn132oHBizH8B8wjX0SadQI2cWtOZZQbHTdEgRn8XN93EiczFayn5GU3Mg7lJMPab5SEeoCWZZ0TF4Ne/A/ZSPUbXdDz9Qdddrrk/KtcwR7jX34VXDzGCFGFT0GzyLu922x069kdiv145tOu34jlOHBWoz4arUAZQt0LYOhmFcHJ2H6zAsYnZDc2FwKhv60+m9UQrLUJ4hSYQAVhpM1O6jj30EDD33Q6frZyoY8cMVaWZZR560kuB5V9H6iVUas+Py5L1/IHsT2ZldR4nEkMdkUd8Y8tYd43mLIMhYhenDWvgjQSQiGFOkiEv0rEAzK2u8yG10M2WwBWFdb6q9NKDNd6rCOuYD9L2VI/57QMfcEniU5cCnJgG+lR9haAnz4MzT5ZjmA4e8HBqnGtYXamF+nK7bpx0uwHxoqGyE3sKD5HHjYVJ1C6Z5qTD5Ph2G1hnQEV/0LBhxU2E+4yYsbgTCJGsuNBfYQrnjA0CPxDo2CRYJ0xGesgD1ZWvQ3LQbKeSJ54uC0UcUDVVRGExFR/FB2y7cSf4C+Zv9sXSUeQ9P2z2pQdnmBHQsPKqKqFCyWJsM75o1GMw8O/iEhFZs/KK9CD9wRfhCTYTP1dqwnBOHrQYz8IuuH5ZxxI/MLQZH5kfoeu6D4cVQGNecgXHFbRgXZsD4Xg5MjqfDeE0KTBbRDLXsLiwOR8HkxCJoOs+Eavdr08ZBBGdYP7rYzAZILsH3LYUYtgSsAXlYRwLqW0r8Ksl2id4/Onaz47IE+kayUfwddYhsgwkqXRrLgOpHEuyhVF9B7ytoTAL//qNjeFagGfGEi5nvYPEifqOx/ek4p1J/8aKBWC8N6Icy2+oL6zOhECTmw46SuoHZpXBn/pK7/DK8K1bCp3Q0vAv7wqfIBD55OuS9teFVYASPfAFccseThw+E4Ho5LOMqYB6ZCeOdK6H1bleJH2sOOPZradqlC3otDqY5F2GafQmmCZdgFnMBZteEML2yCnprh0CZWVp66gbDuD5Q2uSLUacm43jSB0gq+h55JeuRX7wRqUUbkJL8DS4GTcPqCdZgduZ6XiZjgvcp9fIY3aAH/yY+3KvcMDBjLSXQBXDML4VbaQG8a9PgUxcOzyIneKY/Or6FHDO8q7INY+RiMFJaJijE4i2VeEylej/FDs99TAPH8Dvofv8bDK/vhVHxMRhX0W+vOgXTijiY5UXANGkNnYeRUGN2VrsPNx6XVaQNgRNM03sBgUjeOKJJ/Cr+LNzFsg61YB5/elyKtic0qM031CaZAG0gqJnVEuYBIoI49gy9D6DXrQR3GoU2j3YE+WE2FI9TGBG1FLywnhNbPt1Y/OhY+o5iGqsGNmdLaVxfqZUB+g0Iztwi2AOkNZ3FCzOm30bHeHK9tKYHKfPZMFhlAtM9c2EpjALv93zY3qlE/8xyOOUVUTiSBrfy83CvDIdbRZC4uJSGwzHzd0qgkmEVfRnGW/dC79vPobtkFLRmm0HDpVt43MnrzoOm/dfQeeOf0P3wB+guJogXrIDuhHfAsdOFbKdQ5GkaYQbNNYNht2c8/AOnYNKB6Ri//Q14zRwIuohdPC76pCbWKGFCkx9GNC7B0NZD8CiJh8Odi7A59zud7EuwvU4hVUYZBhUXwqsqA56V0RiUM1Dam36UoiyFuprQhc6fRZuKKhV5+rcLKD2hrPQ+NPsvgNb0j6C9eCG0v/kU2l9/BK0ZM8EdRJQ833noG8Qib6lDkA0lYD6i8GIJlffZ/IhhbJtQjW4TP164EiWWztTnH9T+a4L/MxpjAn02hWWYDAQnefSZzm7Io7zDOpiSzGh3grwPwd3zDccPZdH4phBEkXcWBrD4wlE07qObw5pmBUGsK43T/YPfgmAFWEe5U2EeCXhGcV5nQ3u2KrTf6w+jdTNhtud7mB/ZC4vg43QAwbAMDYLF0e3os+8HGP80D7oLx0F9dD+oj9AGZ4Y85K0Yj/Vs3kQiFgeybFPIySiDzdwAz9O3JzHjPNtYk8gjv948FOOatlGodR0Dk07Bau9n0F8wFBp+luBO1CXeuDD51Q3830PRP7UIzgUlcC0vhHPRSdic6eI53ecT3W0sKyjI2EFRxhzyz3sOO8voBkEUTclYhAyshCwr642PR79diwlbBOEs8vLMFjgbbuelhpeoz5rEDxsNNl/+9ON5RWJOLsXCysQdh5IhWWbzhUmoel6v/l/RxGpZTKgbh3EtEZQMp5AX2ASd2f3AVu7695ky/7nOuc2U/BZSCFIGp+I82F/rfprsVa/+Mk0sZ2F0tTvGNZ+gRO8B7C/HQ92beWine+/IDWDBbJUmbBN/hUNOGRyyStH34vfQeP3ZV4R61atXIu9Kefg1rIB/XRJciwso9nymLXmxbP+wxcCsVAxIKwfv1AZoDH96jN6rXr1SuVeowKsuFINrs+BSXATbc59JLU/XwCwdDMw7B/vUEpgHfQYZ7v9HCNar/2E55ynDpSwYrhXF4uKUeQiY0/Oy3kM555nCITcJgmvp0F30Yo8L9KpXL1X9E2XhkPoVBuYWwbmolKDOhmv+WHiXyGNkgbTRE1pOublXkRycCz+AfUoRzPdsgKJN1w/19KpXf7n6xlnCPikE/SkWdswrozDkNoZUfIWhFTYYWaPy4a6NkgSR2XAZXSOLIWUWcCv7FP1T7sH8wFZwp7ycxz971auXIm4AG+b77MFLEKLv7ULJMy0FefCsPAOv0t0YUrIMg0s+gVfxYrgVbIJLUSzsrl2F2ZZl4L7J/Pdp/956ca969UrEna0O41/HwSJ4F3in42Fz5Trsbt5Bv3u30e9uImyvnoV15GGY/LIA6kOZP1966pZ8r3r1n5eqhwZ0F/aB4ToHGK9zh/FPHjD60RE6H1tDaaA2cdy7mvFfI+BffksPNrEksu0AAAAASUVORK5CYII=";function m(e,t,i,n){var a=e._imageUrlTemplate;a=a.replace("{x}",t);a=a.replace("{y}",i);a=a.replace("{zoom}",n+1);var o=e._proxy;if(r(o)){a=o.getURL(a)}return a}return p});define("Scene/GoogleEarthImageryProvider",["../Core/deprecationWarning","./GoogleEarthEnterpriseMapsProvider"],function(e,t){"use strict";function r(r){e("GoogleEarthImageryProvider","GoogleEarthImageryProvider was deprecated in Cesium 1.35, it will be removed in 1.37. Use GoogleEarthEnterpriseMapsProvider instead.");return new t(r)}return r});define("Scene/GridImageryProvider",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/GeographicTilingScheme","../ThirdParty/when"],function(e,t,r,i,n,a,o){"use strict";var s=new e(1,1,1,.4);var l=new e(0,1,0,.05);var u=new e(0,.5,0,.2);function c(e){e=t(e,t.EMPTY_OBJECT);this._tilingScheme=r(e.tilingScheme)?e.tilingScheme:new a({ellipsoid:e.ellipsoid});this._cells=t(e.cells,8);this._color=t(e.color,s);this._glowColor=t(e.glowColor,l);this._glowWidth=t(e.glowWidth,6);this._backgroundColor=t(e.backgroundColor,u);this._errorEvent=new n;this._tileWidth=t(e.tileWidth,256);this._tileHeight=t(e.tileHeight,256);this._canvasSize=t(e.canvasSize,256);this._canvas=this._createGridCanvas();this._readyPromise=o.resolve(true)}i(c.prototype,{proxy:{get:function(){return undefined}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return undefined}},minimumLevel:{get:function(){return undefined}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return undefined}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return true}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return undefined}},hasAlphaChannel:{get:function(){return true}}});c.prototype._drawGrid=function(e){var t=0;var r=this._canvasSize;for(var i=0;i<=this._cells;++i){var n=i/this._cells;var a=1+n*(r-1);e.moveTo(a,t);e.lineTo(a,r);e.moveTo(t,a);e.lineTo(r,a)}e.stroke()};c.prototype._createGridCanvas=function(){var e=document.createElement("canvas");e.width=this._canvasSize;e.height=this._canvasSize;var t=0;var r=this._canvasSize;var i=e.getContext("2d");var n=this._backgroundColor.toCssColorString();i.fillStyle=n;i.fillRect(t,t,r,r);var a=this._glowColor.toCssColorString();i.strokeStyle=a;i.lineWidth=this._glowWidth;i.strokeRect(t,t,r,r);this._drawGrid(i);i.lineWidth=this._glowWidth*.5;i.strokeRect(t,t,r,r);this._drawGrid(i);var o=this._color.toCssColorString();i.strokeStyle=o;i.lineWidth=2;i.strokeRect(t,t,r,r);i.lineWidth=1;this._drawGrid(i);return e};c.prototype.getTileCredits=function(e,t,r){return undefined};c.prototype.requestImage=function(e,t,r,i){return this._canvas};c.prototype.pickFeatures=function(e,t,r,i,n){return undefined};return c});define("Scene/JobScheduler",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/getTimestamp","./JobType"],function(e,t,r,i,n){"use strict";function a(e){this._total=e;this.usedThisFrame=0;this.stolenFromMeThisFrame=0;this.starvedThisFrame=false;this.starvedLastFrame=false}t(a.prototype,{total:{get:function(){return this._total}}});function o(t){if(e(t)&&t.length!==n.NUMBER_OF_JOB_TYPES){throw new r("A budget must be specified for each job type; budgets.length should equal JobType.NUMBER_OF_JOB_TYPES.")}var i=new Array(n.NUMBER_OF_JOB_TYPES);i[n.TEXTURE]=new a(e(t)?t[n.TEXTURE]:10);i[n.PROGRAM]=new a(e(t)?t[n.PROGRAM]:10);i[n.BUFFER]=new a(e(t)?t[n.BUFFER]:30);var o=i.length;var s;var l=0;for(s=0;s<o;++s){l+=i[s].total}var u=new Array(o);for(s=0;s<o;++s){u[s]=false}this._totalBudget=l;this._totalUsedThisFrame=0;this._budgets=i;this._executedThisFrame=u}o.getTimestamp=i;t(o.prototype,{totalBudget:{get:function(){return this._totalBudget}}});o.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget};o.prototype.resetBudgets=function(){var e=this._budgets;var t=e.length;for(var r=0;r<t;++r){var i=e[r];i.starvedLastFrame=i.starvedThisFrame;i.starvedThisFrame=false;i.usedThisFrame=0;i.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0};o.prototype.execute=function(e,t){var r=this._budgets;var i=r[t];var n=this._executedThisFrame[t];if(this._totalUsedThisFrame>=this._totalBudget&&n){i.starvedThisFrame=true;return false}var a;if(i.usedThisFrame+i.stolenFromMeThisFrame>=i.total){var s=r.length;var l;for(l=0;l<s;++l){a=r[l];if(a.usedThisFrame+a.stolenFromMeThisFrame<a.total&&!a.starvedLastFrame){break}}if(l===s&&n){return false}if(n){i.starvedThisFrame=true}}var u=o.getTimestamp();e.execute();var c=o.getTimestamp()-u;this._totalUsedThisFrame+=c;if(a){a.stolenFromMeThisFrame+=c}else{i.usedThisFrame+=c}this._executedThisFrame[t]=true;return true};return o});define("Scene/MapboxImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/MapboxApi","./UrlTemplateImageryProvider"],function(e,t,r,i,n,a,o){"use strict";var s=/\/$/;var l=new e("© Mapbox © OpenStreetMap",undefined,"https://www.mapbox.com/about/maps/");var u=[new e("Improve this map",undefined,"https://www.mapbox.com/map-feedback/")];function c(i){i=t(i,t.EMPTY_OBJECT);var c=i.mapId;if(!r(c)){throw new n("options.mapId is required.")}var d=t(i.url,"https://api.mapbox.com/v4/");this._url=d;this._mapId=c;this._accessToken=a.getAccessToken(i.accessToken);this._accessTokenErrorCredit=a.getErrorCredit(i.accessToken);var f=t(i.format,"png");if(!/\./.test(f)){f="."+f}this._format=f;var h=d;if(!s.test(d)){h+="/"}h+=c+"/{z}/{x}/{y}"+this._format;if(r(this._accessToken)){h+="?access_token="+this._accessToken}if(r(i.credit)){var p=i.credit;if(typeof p==="string"){p=new e(p)}l=p;u.length=0}this._imageryProvider=new o({url:h,proxy:i.proxy,credit:l,ellipsoid:i.ellipsoid,minimumLevel:i.minimumLevel,maximumLevel:i.maximumLevel,rectangle:i.rectangle})}i(c.prototype,{url:{get:function(){return this._url}},ready:{get:function(){return this._imageryProvider.ready}},readyPromise:{get:function(){return this._imageryProvider.readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}});c.prototype.getTileCredits=function(e,t,i){var n=u.slice();if(r(this._accessTokenErrorCredit)){n.push(this._accessTokenErrorCredit)}return n};c.prototype.requestImage=function(e,t,r,i){return this._imageryProvider.requestImage(e,t,r,i)};c.prototype.pickFeatures=function(e,t,r,i,n){return this._imageryProvider.pickFeatures(e,t,r,i,n)};return c});define("Scene/Moon",["../Core/buildModuleUrl","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/IauOrientationAxes","../Core/Matrix3","../Core/Matrix4","../Core/Simon1994PlanetaryPositions","../Core/Transforms","./EllipsoidPrimitive","./Material"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h){"use strict";function p(t){t=r(t,r.EMPTY_OBJECT);var n=t.textureUrl;if(!i(n)){n=e("Assets/Textures/moonSmall.jpg")}this.show=r(t.show,true);this.textureUrl=n;this._ellipsoid=r(t.ellipsoid,o.MOON);this.onlySunLighting=r(t.onlySunLighting,true);this._ellipsoidPrimitive=new f({radii:this.ellipsoid.radii,material:h.fromType(h.ImageType),depthTestEnabled:false,_owner:this});this._ellipsoidPrimitive.material.translucent=false;this._axes=new s}n(p.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var m=new l;var v=new l;var g=new t;var _=[];p.prototype.update=function(e){if(!this.show){return}var t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl;t.onlySunLighting=this.onlySunLighting;var r=e.time;if(!i(d.computeIcrfToFixedMatrix(r,m))){d.computeTemeToPseudoFixedMatrix(r,m)}var n=this._axes.evaluate(r,v);l.transpose(n,n);l.multiply(m,n,n);var a=c.computeMoonPositionInEarthInertialFrame(r,g);l.multiplyByVector(m,a,a);u.fromRotationTranslation(n,a,t.modelMatrix);var o=e.commandList;e.commandList=_;_.length=0;t.update(e);e.commandList=o;return _.length===1?_[0]:undefined};p.prototype.isDestroyed=function(){return false};p.prototype.destroy=function(){this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy();return a(this)};return p});define("Scene/NeverTileDiscardPolicy",[],function(){"use strict";function e(e){}e.prototype.isReady=function(){return true};e.prototype.shouldDiscardImage=function(e){return false};return e});define("Shaders/AdjustTranslucentFS",[],function(){"use strict";return"#ifdef MRT\n#extension GL_EXT_draw_buffers : enable\n#endif\n\nuniform vec4 u_bgColor;\nuniform sampler2D u_depthTexture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    if (texture2D(u_depthTexture, v_textureCoordinates).r < 1.0)\n    {\n#ifdef MRT\n        gl_FragData[0] = u_bgColor;\n        gl_FragData[1] = vec4(u_bgColor.a);\n#else\n        gl_FragColor = u_bgColor;\n#endif\n        return;\n    }\n    \n    discard;\n}\n"});define("Shaders/CompositeOITFS",[],function(){"use strict";return"/**\n * Compositing for Weighted Blended Order-Independent Transparency. See:\n * - http://jcgt.org/published/0002/02/09/\n * - http://casual-effects.blogspot.com/2014/03/weighted-blended-order-independent.html\n */\n\nuniform sampler2D u_opaque;\nuniform sampler2D u_accumulation;\nuniform sampler2D u_revealage;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 opaque = texture2D(u_opaque, v_textureCoordinates);\n    vec4 accum = texture2D(u_accumulation, v_textureCoordinates);\n    float r = texture2D(u_revealage, v_textureCoordinates).r;\n\n#ifdef MRT\n    vec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);\n#else\n    vec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\n#endif\n\n    gl_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;\n\n    if (opaque != czm_backgroundColor)\n    {\n        gl_FragColor.a = 1.0;\n    }\n}\n"});define("Scene/OIT",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Core/WebGLConstants","../Renderer/ClearCommand","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/ShaderSource","../Renderer/Texture","../Shaders/AdjustTranslucentFS","../Shaders/CompositeOITFS","./BlendEquation","./BlendFunction"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v){"use strict";function g(r){this._translucentMultipassSupport=false;this._translucentMRTSupport=false;var i=r.floatingPointTexture&&r.depthTexture;this._translucentMRTSupport=r.drawBuffers&&i;this._translucentMultipassSupport=!this._translucentMRTSupport&&i;this._opaqueFBO=undefined;this._opaqueTexture=undefined;this._depthStencilTexture=undefined;this._accumulationTexture=undefined;this._translucentFBO=undefined;this._alphaFBO=undefined;this._adjustTranslucentFBO=undefined;this._adjustAlphaFBO=undefined;this._opaqueClearCommand=new o({color:new t(0,0,0,0),owner:this});this._translucentMRTClearCommand=new o({color:new t(0,0,0,1),owner:this});this._translucentMultipassClearCommand=new o({color:new t(0,0,0,0),owner:this});this._alphaClearCommand=new o({color:new t(1,1,1,1),owner:this});this._translucentRenderStateCache={};this._alphaRenderStateCache={};this._compositeCommand=undefined;this._adjustTranslucentCommand=undefined;this._adjustAlphaCommand=undefined;this._viewport=new e;this._rs=undefined;this._useScissorTest=false;this._scissorRectangle=undefined}function _(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy();e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function y(e){e._translucentFBO=e._translucentFBO&&!e._translucentFBO.isDestroyed()&&e._translucentFBO.destroy();e._alphaFBO=e._alphaFBO&&!e._alphaFBO.isDestroyed()&&e._alphaFBO.destroy();e._adjustTranslucentFBO=e._adjustTranslucentFBO&&!e._adjustTranslucentFBO.isDestroyed()&&e._adjustTranslucentFBO.destroy();e._adjustAlphaFBO=e._adjustAlphaFBO&&!e._adjustAlphaFBO.isDestroyed()&&e._adjustAlphaFBO.destroy()}function b(e){_(e);y(e)}function w(e,t,r,i){_(e);var a=new Float32Array(r*i*4);e._accumulationTexture=new f({context:t,pixelFormat:n.RGBA,pixelDatatype:u.FLOAT,source:{arrayBufferView:a,width:r,height:i}});e._revealageTexture=new f({context:t,pixelFormat:n.RGBA,pixelDatatype:u.FLOAT,source:{arrayBufferView:a,width:r,height:i}})}function C(e,t){y(e);var r=a.FRAMEBUFFER_COMPLETE;var i=true;if(e._translucentMRTSupport){e._translucentFBO=new l({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:false});e._adjustTranslucentFBO=new l({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],destroyAttachments:false});if(e._translucentFBO.status!==r||e._adjustTranslucentFBO.status!==r){y(e);e._translucentMRTSupport=false}}if(!e._translucentMRTSupport){e._translucentFBO=new l({context:t,colorTextures:[e._accumulationTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:false});e._alphaFBO=new l({context:t,colorTextures:[e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:false});e._adjustTranslucentFBO=new l({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:false});e._adjustAlphaFBO=new l({context:t,colorTextures:[e._revealageTexture],destroyAttachments:false});var n=e._translucentFBO.status===r;var o=e._alphaFBO.status===r;var s=e._adjustTranslucentFBO.status===r;var u=e._adjustAlphaFBO.status===r;if(!n||!o||!s||!u){b(e);e._translucentMultipassSupport=false;i=false}}return i}g.prototype.update=function(t,i,n){if(!this.isSupported()){return}this._opaqueFBO=n;this._opaqueTexture=n.getColorTexture(0);this._depthStencilTexture=n.depthStencilTexture;var a=this._opaqueTexture.width;var o=this._opaqueTexture.height;var s=this._accumulationTexture;var l=!r(s)||s.width!==a||s.height!==o;if(l){w(this,t,a,o)}if(!r(this._translucentFBO)||l){if(!C(this,t)){return}}var u=this;var f;var m;if(!r(this._compositeCommand)){f=new d({sources:[p]});if(this._translucentMRTSupport){f.defines.push("MRT")}m={u_opaque:function(){return u._opaqueTexture},u_accumulation:function(){return u._accumulationTexture},u_revealage:function(){return u._revealageTexture}};this._compositeCommand=t.createViewportQuadCommand(f,{uniformMap:m,owner:this})}if(!r(this._adjustTranslucentCommand)){if(this._translucentMRTSupport){f=new d({defines:["MRT"],sources:[h]});m={u_bgColor:function(){return u._translucentMRTClearCommand.color},u_depthTexture:function(){return u._depthStencilTexture}};this._adjustTranslucentCommand=t.createViewportQuadCommand(f,{uniformMap:m,owner:this})}else if(this._translucentMultipassSupport){f=new d({sources:[h]});m={u_bgColor:function(){return u._translucentMultipassClearCommand.color},u_depthTexture:function(){return u._depthStencilTexture}};this._adjustTranslucentCommand=t.createViewportQuadCommand(f,{uniformMap:m,owner:this});m={u_bgColor:function(){return u._alphaClearCommand.color},u_depthTexture:function(){return u._depthStencilTexture}};this._adjustAlphaCommand=t.createViewportQuadCommand(f,{uniformMap:m,owner:this})}}this._viewport.width=a;this._viewport.height=o;var v=!e.equals(this._viewport,i.viewport);var g=v!==this._useScissorTest;this._useScissorTest=v;if(!e.equals(this._scissorRectangle,i.viewport)){this._scissorRectangle=e.clone(i.viewport,this._scissorRectangle);g=true}if(!r(this._rs)||!e.equals(this._viewport,this._rs.viewport)||g){this._rs=c.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})}if(r(this._compositeCommand)){this._compositeCommand.renderState=this._rs}if(this._adjustTranslucentCommand){this._adjustTranslucentCommand.renderState=this._rs}if(r(this._adjustAlphaCommand)){this._adjustAlphaCommand.renderState=this._rs}};var S={enabled:true,color:new t(0,0,0,0),equationRgb:m.ADD,equationAlpha:m.ADD,functionSourceRgb:v.ONE,functionDestinationRgb:v.ONE,functionSourceAlpha:v.ZERO,functionDestinationAlpha:v.ONE_MINUS_SOURCE_ALPHA};var T={enabled:true,color:new t(0,0,0,0),equationRgb:m.ADD,equationAlpha:m.ADD,functionSourceRgb:v.ONE,functionDestinationRgb:v.ONE,functionSourceAlpha:v.ONE,functionDestinationAlpha:v.ONE};var E={enabled:true,color:new t(0,0,0,0),equationRgb:m.ADD,equationAlpha:m.ADD,functionSourceRgb:v.ZERO,functionDestinationRgb:v.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:v.ZERO,functionDestinationAlpha:v.ONE_MINUS_SOURCE_ALPHA};function x(e,t,i,n){var a=i[n.id];if(!r(a)){var o=c.getState(n);o.depthMask=false;o.blending=t;a=c.fromCache(o);i[n.id]=a}return a}function P(e,t,r){return x(t,S,e._translucentRenderStateCache,r)}function A(e,t,r){return x(t,T,e._translucentRenderStateCache,r)}function O(e,t,r){return x(t,E,e._alphaRenderStateCache,r)}var D="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n"+"    float ai = czm_gl_FragColor.a;\n"+"    float wzi = czm_alphaWeight(ai);\n"+"    gl_FragData[0] = vec4(Ci * wzi, ai);\n"+"    gl_FragData[1] = vec4(ai * wzi);\n";var I="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n"+"    float ai = czm_gl_FragColor.a;\n"+"    float wzi = czm_alphaWeight(ai);\n"+"    gl_FragColor = vec4(Ci, ai) * wzi;\n";var M="    float ai = czm_gl_FragColor.a;\n"+"    gl_FragColor = vec4(ai);\n";function R(e,t,i,n){var a=e.shaderCache.getDerivedShaderProgram(t,i);if(!r(a)){var o=t._attributeLocations;var s=t.fragmentShaderSource.clone();s.sources=s.sources.map(function(e){e=d.replaceMain(e,"czm_translucent_main");e=e.replace(/gl_FragColor/g,"czm_gl_FragColor");e=e.replace(/\bdiscard\b/g,"czm_discard = true");e=e.replace(/czm_phong/g,"czm_translucentPhong");return e});s.sources.splice(0,0,(n.indexOf("gl_FragData")!==-1?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\n"+"bool czm_discard = false;\n");s.sources.push("void main()\n"+"{\n"+"    czm_translucent_main();\n"+"    if (czm_discard)\n"+"    {\n"+"        discard;\n"+"    }\n"+n+"}\n");a=e.shaderCache.createDerivedShaderProgram(t,i,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:s,attributeLocations:o})}return a}function L(e,t){return R(e,t,"translucentMRT",D)}function N(e,t){return R(e,t,"translucentMultipass",I)}function k(e,t){return R(e,t,"alphaMultipass",M)}g.prototype.createDerivedCommands=function(e,t,i){if(!r(i)){i={}}if(this._translucentMRTSupport){var n;var a;if(r(i.translucentCommand)){n=i.translucentCommand.shaderProgram;a=i.translucentCommand.renderState}i.translucentCommand=s.shallowClone(e,i.translucentCommand);if(!r(n)||i.shaderProgramId!==e.shaderProgram.id){i.translucentCommand.shaderProgram=L(t,e.shaderProgram);i.translucentCommand.renderState=P(this,t,e.renderState);i.shaderProgramId=e.shaderProgram.id}else{i.translucentCommand.shaderProgram=n;i.translucentCommand.renderState=a}}else{var o;var l;var u;var c;if(r(i.translucentCommand)){o=i.translucentCommand.shaderProgram;l=i.translucentCommand.renderState;u=i.alphaCommand.shaderProgram;c=i.alphaCommand.renderState}i.translucentCommand=s.shallowClone(e,i.translucentCommand);i.alphaCommand=s.shallowClone(e,i.alphaCommand);if(!r(o)||i.shaderProgramId!==e.shaderProgram.id){i.translucentCommand.shaderProgram=N(t,e.shaderProgram);i.translucentCommand.renderState=A(this,t,e.renderState);i.alphaCommand.shaderProgram=k(t,e.shaderProgram);i.alphaCommand.renderState=O(this,t,e.renderState);i.shaderProgramId=e.shaderProgram.id}else{i.translucentCommand.shaderProgram=o;i.translucentCommand.renderState=l;i.alphaCommand.shaderProgram=u;i.alphaCommand.renderState=c}}return i};function F(e,t,r,i,n){var a;var o;var s;var l=t.context;var u=i.framebuffer;var c=n.length;var d=t.frameState.shadowHints.shadowsEnabled;i.framebuffer=e._adjustTranslucentFBO;e._adjustTranslucentCommand.execute(l,i);i.framebuffer=e._adjustAlphaFBO;e._adjustAlphaCommand.execute(l,i);var f=e._opaqueFBO;i.framebuffer=e._translucentFBO;for(s=0;s<c;++s){a=n[s];o=d&&a.receiveShadows?a.derivedCommands.oit.shadows.translucentCommand:a.derivedCommands.oit.translucentCommand;r(o,t,l,i,f)}i.framebuffer=e._alphaFBO;for(s=0;s<c;++s){a=n[s];o=d&&a.receiveShadows?a.derivedCommands.oit.shadows.alphaCommand:a.derivedCommands.oit.alphaCommand;r(o,t,l,i,f)}i.framebuffer=u}function B(e,t,r,i,n){var a=t.context;var o=i.framebuffer;var s=n.length;var l=t.frameState.shadowHints.shadowsEnabled;i.framebuffer=e._adjustTranslucentFBO;e._adjustTranslucentCommand.execute(a,i);var u=e._opaqueFBO;i.framebuffer=e._translucentFBO;for(var c=0;c<s;++c){var d=n[c];var f=l&&d.receiveShadows?d.derivedCommands.oit.shadows.translucentCommand:d.derivedCommands.oit.translucentCommand;r(f,t,a,i,u)}i.framebuffer=o}g.prototype.executeCommands=function(e,t,r,i){if(this._translucentMRTSupport){B(this,e,t,r,i);return}F(this,e,t,r,i)};g.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)};g.prototype.clear=function(e,r,i){var n=r.framebuffer;r.framebuffer=this._opaqueFBO;t.clone(i,this._opaqueClearCommand.color);this._opaqueClearCommand.execute(e,r);r.framebuffer=this._translucentFBO;var a=this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand;a.execute(e,r);if(this._translucentMultipassSupport){r.framebuffer=this._alphaFBO;this._alphaClearCommand.execute(e,r)}r.framebuffer=n};g.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport};g.prototype.isDestroyed=function(){return false};g.prototype.destroy=function(){b(this);if(r(this._compositeCommand)){this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()}if(r(this._adjustTranslucentCommand)){this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()}if(r(this._adjustAlphaCommand)){this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()}return i(this)};return g});define("Scene/Particle",["../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties"],function(e,t,r,i,n,a){"use strict";var o=new e(1,1);function s(n){n=i(n,i.EMPTY_OBJECT);this.mass=i(n.mass,1);this.position=t.clone(i(n.position,t.ZERO));this.velocity=t.clone(i(n.velocity,t.ZERO));this.life=i(n.life,Number.MAX_VALUE);this.image=n.image;this.startColor=r.clone(i(n.startColor,r.WHITE));this.endColor=r.clone(i(n.endColor,r.WHITE));this.startScale=i(n.startScale,1);this.endScale=i(n.endScale,1);this.size=e.clone(i(n.size,o));this._age=0;this._normalizedAge=0;this._billboard=undefined}a(s.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});var l=new t;s.prototype.update=function(e,r){t.multiplyByScalar(this.velocity,e,l);t.add(this.position,l,this.position);if(n(r)){var i=r.length;for(var a=0;a<i;++a){var o=r[a];if(typeof o==="function"){o(this,e)}}}this._age+=e;if(this.life===Number.MAX_VALUE){this._normalizedAge=0}else{this._normalizedAge=this._age/this.life}return this._age<=this.life};return s});define("Scene/ParticleBurst",["../Core/defaultValue","../Core/defineProperties"],function(e,t){"use strict";function r(t){t=e(t,e.EMPTY_OBJECT);this.time=e(t.time,0);this.minimum=e(t.minimum,0);this.maximum=e(t.maximum,50);this._complete=false}t(r.prototype,{complete:{get:function(){return this._complete}}});return r});define("Scene/ParticleEmitter",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(e){throw new t("This type should not be instantiated directly.  Instead, use BoxEmitter, CircleEmitter, ConeEmitter or SphereEmitter.")}r.prototype.emit=function(e){t.throwInstantiationError()};return r});define("Scene/ParticleSystem",["../Core/Cartesian2","../Core/Cartesian3","../Core/Check","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Event","../Core/JulianDate","../Core/Math","../Core/Matrix4","./BillboardCollection","./CircleEmitter","./Particle"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p){"use strict";function m(e){e=n(e,n.EMPTY_OBJECT);this.show=n(e.show,true);this.forces=e.forces;this.loop=n(e.loop,true);this.image=n(e.image,undefined);var t=e.emitter;if(!a(t)){t=new h(.5)}this._emitter=t;this._bursts=e.bursts;this._modelMatrix=d.clone(n(e.modelMatrix,d.IDENTITY));this._emitterModelMatrix=d.clone(n(e.emitterModelMatrix,d.IDENTITY));this._matrixDirty=true;this._combinedMatrix=new d;this._startColor=i.clone(n(e.startColor,i.WHITE));this._endColor=i.clone(n(e.endColor,i.WHITE));this._startScale=n(e.startScale,1);this._endScale=n(e.endScale,1);this._rate=n(e.rate,5);this._minimumSpeed=n(e.speed,n(e.minimumSpeed,1));this._maximumSpeed=n(e.speed,n(e.maximumSpeed,1));this._minimumLife=n(e.life,n(e.minimumLife,5));this._maximumLife=n(e.life,n(e.maximumLife,5));this._minimumMass=n(e.mass,n(e.minimumMass,1));this._maximumMass=n(e.mass,n(e.maximumMass,1));this._minimumWidth=n(e.width,n(e.minimumWidth,1));this._maximumWidth=n(e.width,n(e.maximumWidth,1));this._minimumHeight=n(e.height,n(e.minimumHeight,1));this._maximumHeight=n(e.height,n(e.maximumHeight,1));this._lifeTime=n(e.lifeTime,Number.MAX_VALUE);this._billboardCollection=undefined;this._particles=[];this._particlePool=[];this._previousTime=undefined;this._currentTime=0;this._carryOver=0;this._complete=new l;this._isComplete=false;this._updateParticlePool=true;this._particleEstimate=0}o(m.prototype,{emitter:{get:function(){return this._emitter},set:function(e){r.defined("value",e);this._emitter=e}},bursts:{get:function(){return this._bursts},set:function(e){this._bursts=e;this._updateParticlePool=true}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){r.defined("value",e);this._matrixDirty=this._matrixDirty||!d.equals(this._modelMatrix,e);d.clone(e,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(e){r.defined("value",e);this._matrixDirty=this._matrixDirty||!d.equals(this._emitterModelMatrix,e);d.clone(e,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(e){r.defined("value",e);i.clone(e,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(e){r.defined("value",e);i.clone(e,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._startScale=e}},endScale:{get:function(){return this._endScale},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._endScale=e}},rate:{get:function(){return this._rate},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._rate=e;this._updateParticlePool=true}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._minimumSpeed=e}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._maximumSpeed=e}},minimumLife:{get:function(){return this._minimumLife},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._minimumLife=e}},maximumLife:{get:function(){return this._maximumLife},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._maximumLife=e;this._updateParticlePool=true}},minimumMass:{get:function(){return this._minimumMass},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._minimumMass=e}},maximumMass:{get:function(){return this._maximumMass},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._maximumMass=e}},minimumWidth:{get:function(){return this._minimumWidth},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._minimumWidth=e}},maximumWidth:{get:function(){return this._maximumWidth},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._maximumWidth=e}},minimumHeight:{get:function(){return this._minimumHeight},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._minimumHeight=e}},maximumHeight:{get:function(){return this._maximumHeight},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._maximumHeight=e}},lifeTime:{get:function(){return this._lifeTime},set:function(e){r.typeOf.number.greaterThanOrEquals("value",e,0);this._lifeTime=e}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});function v(e){var t=e._rate;var r=e._maximumLife;var i=0;var n=e._bursts;if(a(n)){var o=n.length;for(var s=0;s<o;++s){i+=n[s].maximum}}var l=e._billboardCollection;var u=e.image;var c=Math.ceil(t*r+i);var d=e._particles;var f=e._particlePool;var h=Math.max(c-d.length-f.length,0);for(var m=0;m<h;++m){var v=new p;v._billboard=l.add({image:u});f.push(v)}e._particleEstimate=c}function g(e){var t=e._particlePool.pop();if(!a(t)){t=new p}return t}function _(e,t){e._particlePool.push(t)}function y(e){var t=e._particles;var r=e._particlePool;var i=e._billboardCollection;var n=t.length;var a=r.length;var o=e._particleEstimate;var s=a-Math.max(o-n-a,0);for(var l=s;l<a;++l){var u=r[l];i.remove(u._billboard)}r.length=s}function b(e){if(a(e._billboard)){e._billboard.show=false}}function w(e,t){var r=t._billboard;if(!a(r)){r=t._billboard=e._billboardCollection.add({image:t.image})}r.width=t.size.x;r.height=t.size.y;r.position=t.position;r.show=true;var n=c.lerp(t.startColor.red,t.endColor.red,t.normalizedAge);var o=c.lerp(t.startColor.green,t.endColor.green,t.normalizedAge);var s=c.lerp(t.startColor.blue,t.endColor.blue,t.normalizedAge);var l=c.lerp(t.startColor.alpha,t.endColor.alpha,t.normalizedAge);r.color=new i(n,o,s,l);var u=c.lerp(t.startScale,t.endScale,t.normalizedAge);r.scale=u}function C(r,n){n.startColor=i.clone(r._startColor,n.startColor);n.endColor=i.clone(r._endColor,n.endColor);n.startScale=r._startScale;n.endScale=r._endScale;n.image=r.image;n.life=c.randomBetween(r._minimumLife,r._maximumLife);n.mass=c.randomBetween(r._minimumMass,r._maximumMass);var a=c.randomBetween(r._minimumWidth,r._maximumWidth);var o=c.randomBetween(r._minimumHeight,r._maximumHeight);n.size=e.fromElements(a,o,n.size);n._normalizedAge=0;n._age=0;var s=c.randomBetween(r._minimumSpeed,r._maximumSpeed);t.multiplyByScalar(n.velocity,s,n.velocity);r._particles.push(n)}function S(e,t){if(e._isComplete){return 0}t=c.mod(t,e._lifeTime);var r=t*e._rate;var i=Math.floor(r);e._carryOver+=r-i;if(e._carryOver>1){i++;e._carryOver-=1}if(a(e.bursts)){var n=e.bursts.length;for(var o=0;o<n;o++){var s=e.bursts[o];var l=e._currentTime;if(a(s)&&!s._complete&&l>s.time){i+=c.randomBetween(s.minimum,s.maximum);s._complete=true}}}return i}var T=new t;m.prototype.update=function(e){if(!this.show){return}if(!a(this._billboardCollection)){this._billboardCollection=new f}if(this._updateParticlePool){v(this);this._updateParticlePool=false}var r=0;if(this._previousTime){r=u.secondsDifference(e.time,this._previousTime)}if(r<0){r=0}var i=this._particles;var n=this._emitter;var o=this.forces;var s;var l;var h=i.length;for(s=0;s<h;++s){l=i[s];if(!l.update(r,o)){b(l);_(this,l);i[s]=i[h-1];--s;--h}else{w(this,l)}}i.length=h;var p=S(this,r);if(p>0&&a(n)){if(this._matrixDirty){this._combinedMatrix=d.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix);this._matrixDirty=false}var m=this._combinedMatrix;for(s=0;s<p;s++){l=g(this);this._emitter.emit(l);t.add(l.position,l.velocity,T);d.multiplyByPoint(m,T,T);l.position=d.multiplyByPoint(m,l.position,l.position);t.subtract(T,l.position,l.velocity);t.normalize(l.velocity,l.velocity);C(this,l);w(this,l)}}this._billboardCollection.update(e);this._previousTime=u.clone(e.time,this._previousTime);this._currentTime+=r;if(this._lifeTime!==Number.MAX_VALUE&&this._currentTime>this._lifeTime){if(this.loop){this._currentTime=c.mod(this._currentTime,this._lifeTime);if(this.bursts){var E=this.bursts.length;for(s=0;s<E;s++){this.bursts[s]._complete=false}}}else{this._isComplete=true;this._complete.raiseEvent(this)}}if(e.frameNumber%120===0){y(this)}};m.prototype.isDestroyed=function(){return false};m.prototype.destroy=function(){this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy();return s(this)};return m});define("Widgets/getElement",["../Core/DeveloperError"],function(e){"use strict";function t(t){if(typeof t==="string"){var r=document.getElementById(t);if(r===null){throw new e('Element with id "'+t+'" does not exist in the document.')}t=r}return t}return t});define("Scene/PerformanceDisplay",["../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/getTimestamp","../Widgets/getElement"],function(e,t,r,i,n,a){"use strict";function o(r){r=e(r,e.EMPTY_OBJECT);var o=a(r.container);if(!t(o)){throw new i("container is required")}this._container=o;var s=document.createElement("div");s.className="cesium-performanceDisplay";var l=document.createElement("div");l.className="cesium-performanceDisplay-fps";this._fpsText=document.createTextNode("");l.appendChild(this._fpsText);var u=document.createElement("div");u.className="cesium-performanceDisplay-ms";this._msText=document.createTextNode("");u.appendChild(this._msText);s.appendChild(u);s.appendChild(l);this._container.appendChild(s);this._lastFpsSampleTime=n();this._lastMsSampleTime=n();this._fpsFrameCount=0;this._msFrameCount=0}o.prototype.update=function(){var e=n();this._fpsFrameCount++;var t=e-this._lastFpsSampleTime;if(t>1e3){var r=this._fpsFrameCount*1e3/t|0;this._fpsText.nodeValue=r+" FPS";this._lastFpsSampleTime=e;this._fpsFrameCount=0}this._msFrameCount++;var i=e-this._lastMsSampleTime;if(i>200){this._msText.nodeValue=(i/this._msFrameCount).toFixed(2)+" MS";this._lastMsSampleTime=e;this._msFrameCount=0}};o.prototype.destroy=function(){return r(this)};return o});define("Scene/PickDepth",["../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Texture"],function(e,t,r,i,n,a,o){"use strict";function s(){this.framebuffer=undefined;this._depthTexture=undefined;this._textureToCopy=undefined;this._copyDepthCommand=undefined;this._debugPickDepthViewportCommand=undefined}function l(t,r,i){if(!e(t._debugPickDepthViewportCommand)){var n="uniform sampler2D u_texture;\n"+"varying vec2 v_textureCoordinates;\n"+"void main()\n"+"{\n"+"    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n"+"    float n_range = czm_depthRange.near;\n"+"    float f_range = czm_depthRange.far;\n"+"    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n"+"    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n"+"    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n"+"}\n";t._debugPickDepthViewportCommand=r.createViewportQuadCommand(n,{uniformMap:{u_texture:function(){return t._depthTexture}},owner:t})}t._debugPickDepthViewportCommand.execute(r,i)}function u(e){e._depthTexture=e._depthTexture&&!e._depthTexture.isDestroyed()&&e._depthTexture.destroy()}function c(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy()}function d(e,t,i,a){e._depthTexture=new o({context:t,width:i,height:a,pixelFormat:r.RGBA,pixelDatatype:n.UNSIGNED_BYTE})}function f(e,t,r,n){u(e);c(e);d(e,t,r,n);e.framebuffer=new i({context:t,colorTextures:[e._depthTexture],destroyAttachments:false})}function h(t,r,i){var n=i.width;var a=i.height;var o=t._depthTexture;var s=!e(o)||o.width!==n||o.height!==a;if(!e(t.framebuffer)||s){f(t,r,n,a)}}function p(t,r,i){if(!e(t._copyDepthCommand)){var n="uniform sampler2D u_texture;\n"+"varying vec2 v_textureCoordinates;\n"+"void main()\n"+"{\n"+"    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n"+"}\n";t._copyDepthCommand=r.createViewportQuadCommand(n,{renderState:a.fromCache(),uniformMap:{u_texture:function(){return t._textureToCopy}},owner:t})}t._textureToCopy=i;t._copyDepthCommand.framebuffer=t.framebuffer}s.prototype.executeDebugPickDepth=function(e,t){l(this,e,t)};s.prototype.update=function(e,t){h(this,e,t);p(this,e,t)};s.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)};s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){u(this);c(this);this._copyDepthCommand.shaderProgram=e(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy();return t(this)};return s});define("Scene/PrimitiveCollection",["../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError"],function(e,t,r,i,n,a){"use strict";function o(r){r=t(r,t.EMPTY_OBJECT);this._primitives=[];this._guid=e();this.show=t(r.show,true);this.destroyPrimitives=t(r.destroyPrimitives,true)}i(o.prototype,{length:{get:function(){return this._primitives.length}}});o.prototype.add=function(e){if(!r(e)){throw new a("primitive is required.")}var t=e._external=e._external||{};var i=t._composites=t._composites||{};i[this._guid]={collection:this};this._primitives.push(e);return e};o.prototype.remove=function(e){if(this.contains(e)){var t=this._primitives.indexOf(e);if(t!==-1){this._primitives.splice(t,1);delete e._external._composites[this._guid];if(this.destroyPrimitives){e.destroy()}return true}}return false};o.prototype.removeAndDestroy=function(e){var t=this.remove(e);if(t&&!this.destroyPrimitives){e.destroy()}return t};o.prototype.removeAll=function(){if(this.destroyPrimitives){var e=this._primitives;var t=e.length;for(var r=0;r<t;++r){e[r].destroy()}}this._primitives=[]};o.prototype.contains=function(e){return!!(r(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])};function s(e,t){if(!e.contains(t)){throw new a("primitive is not in this collection.")}return e._primitives.indexOf(t)}o.prototype.raise=function(e){if(r(e)){var t=s(this,e);var i=this._primitives;if(t!==i.length-1){var n=i[t];i[t]=i[t+1];i[t+1]=n}}};o.prototype.raiseToTop=function(e){if(r(e)){var t=s(this,e);var i=this._primitives;if(t!==i.length-1){i.splice(t,1);i.push(e)}}};o.prototype.lower=function(e){if(r(e)){var t=s(this,e);var i=this._primitives;if(t!==0){var n=i[t];i[t]=i[t-1];i[t-1]=n}}};o.prototype.lowerToBottom=function(e){if(r(e)){var t=s(this,e);var i=this._primitives;if(t!==0){i.splice(t,1);i.unshift(e)}}};o.prototype.get=function(e){if(!r(e)){throw new a("index is required.")}return this._primitives[e]};o.prototype.update=function(e){if(!this.show){return}var t=this._primitives;for(var r=0;r<t.length;++r){t[r].update(e)}};o.prototype.isDestroyed=function(){return false};o.prototype.destroy=function(){this.removeAll();return n(this)};return o});define("Scene/QuadtreeTileProvider",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function r(){t.throwInstantiationError()}r.computeDefaultLevelZeroMaximumGeometricError=function(e){return e.ellipsoid.maximumRadius*2*Math.PI*.25/(65*e.getNumberOfXTilesAtLevel(0))};e(r.prototype,{quadtree:{get:t.throwInstantiationError,set:t.throwInstantiationError},ready:{get:t.throwInstantiationError},tilingScheme:{get:t.throwInstantiationError},errorEvent:{get:t.throwInstantiationError}});r.prototype.beginUpdate=t.throwInstantiationError;r.prototype.endUpdate=t.throwInstantiationError;r.prototype.getLevelMaximumGeometricError=t.throwInstantiationError;r.prototype.loadTile=t.throwInstantiationError;r.prototype.computeTileVisibility=t.throwInstantiationError;r.prototype.showTileThisFrame=t.throwInstantiationError;r.prototype.computeDistanceToTile=t.throwInstantiationError;r.prototype.isDestroyed=t.throwInstantiationError;r.prototype.destroy=t.throwInstantiationError;return r});define("Scene/SceneTransitioner",["../Core/Cartesian3","../Core/Cartographic","../Core/Check","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/EasingFunction","../Core/Math","../Core/Matrix4","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/Ray","../Core/ScreenSpaceEventHandler","../Core/ScreenSpaceEventType","../Core/Transforms","./Camera","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g){"use strict";function _(e){r.typeOf.object("scene",e);this._scene=e;this._currentTweens=[];this._morphHandler=undefined;this._morphCancelled=false;this._completeMorph=undefined;this._morphToOrthographic=false}_.prototype.completeMorph=function(){if(i(this._completeMorph)){this._completeMorph()}};_.prototype.morphTo2D=function(e,t){if(i(this._completeMorph)){this._completeMorph()}var r=this._scene;this._previousMode=r.mode;this._morphToOrthographic=r.camera.frustum instanceof u;if(this._previousMode===g.SCENE2D||this._previousMode===g.MORPHING){return}this._scene.morphStart.raiseEvent(this,this._previousMode,g.SCENE2D,true);r._mode=g.MORPHING;r.camera._setTransform(l.IDENTITY);if(this._previousMode===g.COLUMBUS_VIEW){fe(this,e)}else{be(this,e,t)}if(e===0&&i(this._completeMorph)){this._completeMorph()}};var y=new e;var b=new e;var w=new e;var C=new e;var S=new e;var T=new e;var E=new e;var x=new t;var P=new l;var A=new d;var O=new u;var D={position:undefined,direction:undefined,up:undefined,position2D:undefined,direction2D:undefined,up2D:undefined,frustum:undefined};_.prototype.morphToColumbusView=function(t,r){if(i(this._completeMorph)){this._completeMorph()}var n=this._scene;this._previousMode=n.mode;if(this._previousMode===g.COLUMBUS_VIEW||this._previousMode===g.MORPHING){return}this._scene.morphStart.raiseEvent(this,this._previousMode,g.COLUMBUS_VIEW,true);n.camera._setTransform(l.IDENTITY);var a=y;var o=b;var u=w;if(t>0){a.x=0;a.y=-1;a.z=1;a=e.multiplyByScalar(e.normalize(a,a),5*r.maximumRadius,a);e.negate(e.normalize(a,o),o);e.cross(e.UNIT_X,o,u)}else{var c=n.camera;if(this._previousMode===g.SCENE2D){e.clone(c.position,a);a.z=c.frustum.right-c.frustum.left;e.negate(e.UNIT_Z,o);e.clone(e.UNIT_Y,u)}else{e.clone(c.positionWC,a);e.clone(c.directionWC,o);e.clone(c.upWC,u);var d=r.scaleToGeodeticSurface(a,E);var f=m.eastNorthUpToFixedFrame(d,r,P);l.inverseTransformation(f,f);n.mapProjection.project(r.cartesianToCartographic(a,x),a);l.multiplyByPointAsVector(f,o,o);l.multiplyByPointAsVector(f,u,u)}}var h;if(this._morphToOrthographic){h=O;h.width=n.camera.frustum.right-n.camera.frustum.left;h.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight}else{h=A;h.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight;h.fov=s.toRadians(60)}var p=D;p.position=a;p.direction=o;p.up=u;p.frustum=h;var _=Pe(p);R(this,_);if(this._previousMode===g.SCENE2D){Ce(this,t,p,_)}else{p.position2D=l.multiplyByPoint(v.TRANSFORM_2D,a,C);p.direction2D=l.multiplyByPointAsVector(v.TRANSFORM_2D,o,S);p.up2D=l.multiplyByPointAsVector(v.TRANSFORM_2D,u,T);n._mode=g.MORPHING;Se(this,t,p,_)}if(t===0&&i(this._completeMorph)){this._completeMorph()}};var I={position:new e,direction:new e,up:new e,frustum:undefined};var M=new d;_.prototype.morphTo3D=function(t,r){if(i(this._completeMorph)){this._completeMorph()}var n=this._scene;this._previousMode=n.mode;if(this._previousMode===g.SCENE3D||this._previousMode===g.MORPHING){return}this._scene.morphStart.raiseEvent(this,this._previousMode,g.SCENE3D,true);n._mode=g.MORPHING;n.camera._setTransform(l.IDENTITY);if(this._previousMode===g.SCENE2D){$(this,t,r)}else{var a;if(t>0){a=I;e.fromDegrees(0,0,5*r.maximumRadius,r,a.position);e.negate(a.position,a.direction);e.normalize(a.direction,a.direction);e.clone(e.UNIT_Z,a.up)}else{a=B(this,r)}var o;var c=n.camera;if(c.frustum instanceof u){o=c.frustum.clone()}else{o=M;o.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight;o.fov=s.toRadians(60)}a.frustum=o;var d=Ee(a);R(this,d);j(this,t,a,d)}if(t===0&&i(this._completeMorph)){this._completeMorph()}};_.prototype.isDestroyed=function(){return false};_.prototype.destroy=function(){L(this);return n(this)};function R(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new h(e._scene.canvas,false);var r=function(){e._morphCancelled=true;t(e)};e._completeMorph=r;e._morphHandler.setInputAction(r,p.LEFT_DOWN);e._morphHandler.setInputAction(r,p.MIDDLE_DOWN);e._morphHandler.setInputAction(r,p.RIGHT_DOWN);e._morphHandler.setInputAction(r,p.WHEEL)}}function L(e){var t=e._currentTweens;for(var r=0;r<t.length;++r){t[r].cancelTween()}e._currentTweens.length=0;e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}var N=new t;var k=new e;var F=new l;function B(e,t){var r=e._scene;var i=r.camera;var n=I;var a=n.position;var o=n.direction;var s=n.up;var u=r.mapProjection.unproject(i.position,N);t.cartographicToCartesian(u,a);var c=t.scaleToGeodeticSurface(a,k);var d=m.eastNorthUpToFixedFrame(c,t,F);l.multiplyByPointAsVector(d,i.direction,o);l.multiplyByPointAsVector(d,i.up,s);return n}var U=new e;var V=new e;var z=new e;var q=new e;var G=new e;var H=new e;function j(t,r,i,n){r*=.5;var a=t._scene;var s=a.camera;var u=e.clone(s.position,U);var c=e.clone(s.direction,V);var d=e.clone(s.up,z);var f=l.multiplyByPoint(v.TRANSFORM_2D_INVERSE,i.position,q);var h=l.multiplyByPointAsVector(v.TRANSFORM_2D_INVERSE,i.direction,G);var p=l.multiplyByPointAsVector(v.TRANSFORM_2D_INVERSE,i.up,H);function m(t){ee(u,f,t.time,s.position);ee(c,h,t.time,s.direction);ee(d,p,t.time,s.up);e.cross(s.direction,s.up,s.right);e.normalize(s.right,s.right)}var g=a.tweens.add({duration:r,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:m,complete:function(){Te(t,a,0,1,r,n)}});t._currentTweens.push(g)}var W=new u;var Y=new e;var X=new e;var Q=new e;var Z=new e;var K=new e;var J=new e;function $(t,r,i){r/=3;var n=t._scene;var a=n.camera;var l;if(r>0){l=I;e.fromDegrees(0,0,5*i.maximumRadius,i,l.position);e.negate(l.position,l.direction);e.normalize(l.direction,l.direction);e.clone(e.UNIT_Z,l.up)}else{a.position.z=a.frustum.right-a.frustum.left;l=B(t,i)}var u;if(t._morphToOrthographic){u=W;u.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight;u.width=a.frustum.right-a.frustum.left}else{u=M;u.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight;u.fov=s.toRadians(60)}l.frustum=u;var c=Ee(l);R(t,c);var d=e.clone(a.position,Y);var f=e.clone(a.direction,X);var h=e.clone(a.up,Q);var p=e.fromElements(0,0,5*i.maximumRadius,Z);var m=e.negate(e.UNIT_Z,K);var v=e.clone(e.UNIT_Y,J);var _=a.frustum.right;var y=p.z*.5;function b(t){ee(d,p,t.time,a.position);ee(f,m,t.time,a.direction);ee(h,v,t.time,a.up);e.cross(a.direction,a.up,a.right);e.normalize(a.right,a.right);var r=a.frustum;r.right=s.lerp(_,y,t.time);r.left=-r.right;r.top=r.right*(n.drawingBufferHeight/n.drawingBufferWidth);r.bottom=-r.top;a.position.z=2*n.mapProjection.ellipsoid.maximumRadius}var w;if(t._morphToOrthographic){w=function(){j(t,r,l,c)}}else{w=function(){we(t,r,l,function(){j(t,r,l,c)})}}if(r>0){var C=n.tweens.add({duration:r,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:b,complete:function(){n._mode=g.MORPHING;w()}});t._currentTweens.push(C)}else{w()}}function ee(t,r,i,n){return e.lerp(t,r,i,n)}function te(e,t,r,i,n){var a=e._scene;var l=a.camera;if(l.frustum instanceof u){return}var c=l.frustum.fov;var d=s.RADIANS_PER_DEGREE*.5;var f=r.position.z*Math.tan(c*.5);l.frustum.far=f/Math.tan(d*.5)+1e7;function h(e){l.frustum.fov=s.lerp(c,d,e.time);var t=f/Math.tan(l.frustum.fov*.5);i(l,t)}var p=a.tweens.add({duration:t,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:h,complete:function(){l.frustum=r.frustum.clone();n(e)}});e._currentTweens.push(p)}var re=new e;var ie=new e;var ne=new e;var ae=new e;var oe=new e;var se=new e;var le=new c;var ue=new f;var ce=new e;var de={position:undefined,direction:undefined,up:undefined,frustum:undefined};function fe(t,r){r*=.5;var n=t._scene;var a=n.camera;var s=e.clone(a.position,re);var u=e.clone(a.direction,ie);var c=e.clone(a.up,ne);var d=e.negate(e.UNIT_Z,oe);var f=e.clone(e.UNIT_Y,se);var h=ae;if(r>0){e.clone(e.ZERO,ae);h.z=5*n.mapProjection.ellipsoid.maximumRadius}else{e.clone(s,ae);var p=ue;l.multiplyByPoint(v.TRANSFORM_2D,s,p.origin);l.multiplyByPointAsVector(v.TRANSFORM_2D,u,p.direction);var m=n.globe;if(i(m)){var g=m.pick(p,n,ce);if(i(g)){l.multiplyByPoint(v.TRANSFORM_2D_INVERSE,g,h);h.z+=e.distance(s,h)}}}var _=le;_.right=h.z*.5;_.left=-_.right;_.top=_.right*(n.drawingBufferHeight/n.drawingBufferWidth);_.bottom=-_.top;var y=de;y.position=h;y.direction=d;y.up=f;y.frustum=_;var b=xe(y);R(t,b);function w(t){ee(s,h,t.time,a.position);ee(u,d,t.time,a.direction);ee(c,f,t.time,a.up);e.cross(a.direction,a.up,a.right);e.normalize(a.right,a.right);a._adjustOrthographicFrustum(true)}function C(e,t){e.position.z=t}var S=n.tweens.add({duration:r,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:w,complete:function(){te(t,r,y,C,b)}});t._currentTweens.push(S)}var he=new t;var pe={position:new e,direction:new e,up:new e,position2D:new e,direction2D:new e,up2D:new e,frustum:new c};var me={position:new e,direction:new e,up:new e,frustum:undefined};var ve=new e;var ge=new f;var _e=new l;var ye=new e;function be(t,r,n){r*=.5;var a=t._scene;var o=a.camera;var s=pe;if(r>0){e.clone(e.ZERO,s.position);s.position.z=5*n.maximumRadius;e.negate(e.UNIT_Z,s.direction);e.clone(e.UNIT_Y,s.up)}else{n.cartesianToCartographic(o.positionWC,he);a.mapProjection.project(he,s.position);e.negate(e.UNIT_Z,s.direction);e.clone(e.UNIT_Y,s.up);var u=ge;e.clone(s.position2D,u.origin);var c=e.clone(o.directionWC,u.direction);var d=n.scaleToGeodeticSurface(o.positionWC,ye);var f=m.eastNorthUpToFixedFrame(d,n,_e);l.inverseTransformation(f,f);l.multiplyByPointAsVector(f,c,c);l.multiplyByPointAsVector(v.TRANSFORM_2D,c,c);var h=a.globe;if(i(h)){var p=h.pick(u,a,ve);if(i(p)){var g=e.distance(s.position2D,p);p.x+=g;e.clone(p,s.position2D)}}}function _(e,t){e.position.x=t}l.multiplyByPoint(v.TRANSFORM_2D,s.position,s.position2D);l.multiplyByPointAsVector(v.TRANSFORM_2D,s.direction,s.direction2D);l.multiplyByPointAsVector(v.TRANSFORM_2D,s.up,s.up2D);var y=s.frustum;y.right=s.position.z*.5;y.left=-y.right;y.top=y.right*(a.drawingBufferHeight/a.drawingBufferWidth);y.bottom=-y.top;var b=me;l.multiplyByPoint(v.TRANSFORM_2D_INVERSE,s.position2D,b.position);e.clone(s.direction,b.direction);e.clone(s.up,b.up);b.frustum=y;var w=xe(b);R(t,w);function C(){te(t,r,s,_,w)}Se(t,r,s,C)}function we(e,t,r,i){var n=e._scene;var a=n.camera;var l=a.frustum.right-a.frustum.left;a.frustum=r.frustum.clone();var u=a.frustum.fov;var c=s.RADIANS_PER_DEGREE*.5;var d=l*Math.tan(u*.5);a.frustum.far=d/Math.tan(c*.5)+1e7;a.frustum.fov=c;function f(e){a.frustum.fov=s.lerp(c,u,e.time);a.position.z=d/Math.tan(a.frustum.fov*.5)}var h=n.tweens.add({duration:t,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:f,complete:function(){i(e)}});e._currentTweens.push(h)}function Ce(t,r,i,n){r*=.5;var a=t._scene;var s=a.camera;var l=e.clone(i.position,Z);var u=e.clone(i.direction,K);var c=e.clone(i.up,J);a._mode=g.MORPHING;function d(){s.frustum=i.frustum.clone();var d=e.clone(s.position,Y);var f=e.clone(s.direction,X);var h=e.clone(s.up,Q);d.z=l.z;function p(t){ee(d,l,t.time,s.position);ee(f,u,t.time,s.direction);ee(h,c,t.time,s.up);e.cross(s.direction,s.up,s.right);e.normalize(s.right,s.right)}var m=a.tweens.add({duration:r,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:p,complete:function(){n(t)}});t._currentTweens.push(m)}if(t._morphToOrthographic){d()}else{we(t,0,i,d)}}function Se(t,r,i,n){var a=t._scene;var s=a.camera;var l=e.clone(s.position,Y);var u=e.clone(s.direction,X);var c=e.clone(s.up,Q);var d=e.clone(i.position2D,Z);var f=e.clone(i.direction2D,K);var h=e.clone(i.up2D,J);function p(t){ee(l,d,t.time,s.position);ee(u,f,t.time,s.direction);ee(c,h,t.time,s.up);e.cross(s.direction,s.up,s.right);e.normalize(s.right,s.right);s._adjustOrthographicFrustum(true)}var m=a.tweens.add({duration:r,easingFunction:o.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:p,complete:function(){Te(t,a,1,0,r,n)}});t._currentTweens.push(m)}function Te(e,t,r,n,a,s){var l={object:t,property:"morphTime",startValue:r,stopValue:n,duration:a,easingFunction:o.QUARTIC_OUT};if(i(s)){l.complete=function(){s(e)}}var u=t.tweens.addProperty(l);e._currentTweens.push(u)}function Ee(t){return function(r){var n=r._scene;n._mode=g.SCENE3D;n.morphTime=g.getMorphTime(g.SCENE3D);L(r);if(r._previousMode!==g.MORPHING||r._morphCancelled){r._morphCancelled=false;var a=n.camera;e.clone(t.position,a.position);e.clone(t.direction,a.direction);e.clone(t.up,a.up);e.cross(a.direction,a.up,a.right);e.normalize(a.right,a.right);a.frustum=t.frustum.clone()}var o=i(r._completeMorph);r._completeMorph=undefined;n.camera.update(n.mode);r._scene.morphComplete.raiseEvent(r,r._previousMode,g.SCENE3D,o)}}function xe(t){return function(r){var n=r._scene;n._mode=g.SCENE2D;n.morphTime=g.getMorphTime(g.SCENE2D);L(r);var a=n.camera;e.clone(t.position,a.position);a.position.z=n.mapProjection.ellipsoid.maximumRadius*2;e.clone(t.direction,a.direction);e.clone(t.up,a.up);e.cross(a.direction,a.up,a.right);e.normalize(a.right,a.right);a.frustum=t.frustum.clone();var o=i(r._completeMorph);r._completeMorph=undefined;n.camera.update(n.mode);r._scene.morphComplete.raiseEvent(r,r._previousMode,g.SCENE2D,o)}}function Pe(t){return function(r){var n=r._scene;n._mode=g.COLUMBUS_VIEW;n.morphTime=g.getMorphTime(g.COLUMBUS_VIEW);L(r);if(r._previousModeMode!==g.MORPHING||r._morphCancelled){r._morphCancelled=false;var a=n.camera;e.clone(t.position,a.position);e.clone(t.direction,a.direction);e.clone(t.up,a.up);e.cross(a.direction,a.up,a.right);e.normalize(a.right,a.right)}var o=i(r._completeMorph);r._completeMorph=undefined;n.camera.update(n.mode);r._scene.morphComplete.raiseEvent(r,r._previousMode,g.COLUMBUS_VIEW,o)}}return _});define("Scene/TweenCollection",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/EasingFunction","../Core/getTimestamp","../Core/TimeConstants","../ThirdParty/Tween"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(t,r,i,n,a,o,s,l,u,c){this._tweens=t;this._tweenjs=r;this._startObject=e(i);this._stopObject=e(n);this._duration=a;this._delay=o;this._easingFunction=s;this._update=l;this._complete=u;this.cancel=c;this.needsStart=true}i(u.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}});u.prototype.cancelTween=function(){this._tweens.remove(this)};function c(){this._tweens=[]}i(c.prototype,{length:{get:function(){return this._tweens.length}}});c.prototype.add=function(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.startObject)||!r(i.stopObject)){throw new n("options.startObject and options.stopObject are required.")}if(!r(i.duration)||i.duration<0){throw new n("options.duration is required and must be positive.")}if(i.duration===0){if(r(i.complete)){i.complete()}return new u(this)}var o=i.duration/s.SECONDS_PER_MILLISECOND;var c=t(i.delay,0);var d=c/s.SECONDS_PER_MILLISECOND;var f=t(i.easingFunction,a.LINEAR_NONE);var h=i.startObject;var p=new l.Tween(h);p.to(e(i.stopObject),o);p.delay(d);p.easing(f);if(r(i.update)){p.onUpdate(function(){i.update(h)})}p.onComplete(t(i.complete,null));p.repeat(t(i._repeat,0));var m=new u(this,p,i.startObject,i.stopObject,i.duration,c,f,i.update,i.complete,i.cancel);this._tweens.push(m);return m};c.prototype.addProperty=function(e){e=t(e,t.EMPTY_OBJECT);var i=e.object;var a=e.property;var o=e.startValue;var s=e.stopValue;if(!r(i)||!r(e.property)){throw new n("options.object and options.property are required.")}if(!r(i[a])){throw new n("options.object must have the specified property.")}if(!r(o)||!r(s)){throw new n("options.startValue and options.stopValue are required.")}function l(e){i[a]=e.value}return this.add({startObject:{value:o},stopObject:{value:s},duration:t(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:l,complete:e.complete,cancel:e.cancel,_repeat:e._repeat})};c.prototype.addAlpha=function(e){e=t(e,t.EMPTY_OBJECT);var i=e.material;if(!r(i)){throw new n("options.material is required.")}var a=[];for(var o in i.uniforms){if(i.uniforms.hasOwnProperty(o)&&r(i.uniforms[o])&&r(i.uniforms[o].alpha)){a.push(o)}}if(a.length===0){throw new n("material has no properties with alpha components.")}function s(e){var t=a.length;for(var r=0;r<t;++r){i.uniforms[a[r]].alpha=e.alpha}}return this.add({startObject:{alpha:t(e.startValue,0)},stopObject:{alpha:t(e.stopValue,1)},duration:t(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:s,complete:e.complete,cancel:e.cancel})};c.prototype.addOffsetIncrement=function(e){e=t(e,t.EMPTY_OBJECT);var i=e.material;if(!r(i)){throw new n("material is required.")}if(!r(i.uniforms.offset)){throw new n("material.uniforms must have an offset property.")}var a=i.uniforms;return this.addProperty({object:a,property:"offset",startValue:a.offset,stopValue:a.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:Infinity})};c.prototype.remove=function(e){if(!r(e)){return false}var t=this._tweens.indexOf(e);if(t!==-1){e.tweenjs.stop();if(r(e.cancel)){e.cancel()}this._tweens.splice(t,1);return true}return false};c.prototype.removeAll=function(){var e=this._tweens;for(var t=0;t<e.length;++t){var i=e[t];i.tweenjs.stop();if(r(i.cancel)){i.cancel()}}e.length=0};c.prototype.contains=function(e){return r(e)&&this._tweens.indexOf(e)!==-1};c.prototype.get=function(e){if(!r(e)){throw new n("index is required.")}return this._tweens[e]};c.prototype.update=function(e){var t=this._tweens;var i=0;e=r(e)?e/s.SECONDS_PER_MILLISECOND:o();while(i<t.length){var n=t[i];var a=n.tweenjs;if(n.needsStart){n.needsStart=false;a.start(e)}else if(a.update(e)){i++}else{a.stop();t.splice(i,1)}}};return c});define("Scene/ScreenSpaceCameraController",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/IntersectionTests","../Core/isArray","../Core/KeyboardEventModifier","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/OrthographicFrustum","../Core/Plane","../Core/Quaternion","../Core/Ray","../Core/Transforms","./CameraEventAggregator","./CameraEventType","./MapMode2D","./SceneMode","./SceneTransforms","./TweenCollection"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E){"use strict";function x(r){if(!a(r)){throw new s("scene is required.")}this.enableInputs=true;this.enableTranslate=true;this.enableZoom=true;this.enableRotate=true;this.enableTilt=true;this.enableLook=true;this.inertiaSpin=.9;this.inertiaTranslate=.9;this.inertiaZoom=.8;this.maximumMovementRatio=.1;this.bounceAnimationTime=3;this.minimumZoomDistance=1;this.maximumZoomDistance=Number.POSITIVE_INFINITY;this.translateEventTypes=w.LEFT_DRAG;this.zoomEventTypes=[w.RIGHT_DRAG,w.WHEEL,w.PINCH];this.rotateEventTypes=w.LEFT_DRAG;this.tiltEventTypes=[w.MIDDLE_DRAG,w.PINCH,{eventType:w.LEFT_DRAG,modifier:d.CTRL},{eventType:w.RIGHT_DRAG,modifier:d.CTRL}];this.lookEventTypes={eventType:w.LEFT_DRAG,modifier:d.SHIFT};this.minimumPickingTerrainHeight=15e4;this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight;this.minimumCollisionTerrainHeight=15e3;this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight;this.minimumTrackBallHeight=75e5;this._minimumTrackBallHeight=this.minimumTrackBallHeight;this.enableCollisionDetection=true;this._scene=r;this._globe=undefined;this._ellipsoid=undefined;this._aggregator=new b(r.canvas);this._lastInertiaSpinMovement=undefined;this._lastInertiaZoomMovement=undefined;this._lastInertiaTranslateMovement=undefined;this._lastInertiaTiltMovement=undefined;this._tweens=new E;this._tween=undefined;this._horizontalRotationAxis=undefined;this._tiltCenterMousePosition=new e(-1,-1);this._tiltCenter=new t;this._rotateMousePosition=new e(-1,-1);this._rotateStartPosition=new t;this._strafeStartPosition=new t;this._zoomMouseStart=new e(-1,-1);this._zoomWorldPosition=new t;this._useZoomWorldPosition=false;this._tiltCVOffMap=false;this._looking=false;this._rotating=false;this._strafing=false;this._zoomingOnVector=false;this._rotatingZoom=false;var n=r.mapProjection;this._maxCoord=n.project(new i(Math.PI,f.PI_OVER_TWO));this._zoomFactor=5;this._rotateFactor=undefined;this._rotateRateRangeAdjustment=undefined;this._maximumRotateRate=1.77;this._minimumRotateRate=1/5e3;this._minimumZoomRate=20;this._maximumZoomRate=5906376272e3}function P(e,t){if(e<0){return 0}var r=(1-t)*25;return Math.exp(-r*e)}function A(t){return e.equalsEpsilon(t.startPosition,t.endPosition,f.EPSILON14)}var O=.4;function D(t,r,i,n,o,s,l){var u=s[l];if(!a(u)){u=s[l]={startPosition:new e,endPosition:new e,motion:new e,active:false}}var c=t.getButtonPressTime(r,i);var d=t.getButtonReleaseTime(r,i);var f=c&&d&&(d.getTime()-c.getTime())/1e3;var h=new Date;var p=d&&(h.getTime()-d.getTime())/1e3;if(c&&d&&f<O){var m=P(p,n);if(!u.active){var v=t.getLastMovement(r,i);if(!a(v)||A(v)){return}u.motion.x=(v.endPosition.x-v.startPosition.x)*.5;u.motion.y=(v.endPosition.y-v.startPosition.y)*.5;u.startPosition=e.clone(v.startPosition,u.startPosition);u.endPosition=e.multiplyByScalar(u.motion,m,u.endPosition);u.endPosition=e.add(u.startPosition,u.endPosition,u.endPosition);u.active=true}else{u.startPosition=e.clone(u.endPosition,u.startPosition);u.endPosition=e.multiplyByScalar(u.motion,m,u.endPosition);u.endPosition=e.add(u.startPosition,u.endPosition,u.endPosition);u.motion=e.clone(e.ZERO,u.motion)}if(isNaN(u.endPosition.x)||isNaN(u.endPosition.y)||e.distance(u.startPosition,u.endPosition)<.5){u.active=false;return}if(!t.isButtonDown(r,i)){var g=t.getStartMousePosition(r,i);o(s,g,u)}}else{u.active=false}}var I=[];function M(e,t,r,i,n,o){if(!a(r)){return}var s=e._aggregator;if(!c(r)){I[0]=r;r=I}var l=r.length;for(var u=0;u<l;++u){var d=r[u];var f=a(d.eventType)?d.eventType:d;var h=d.modifier;var p=s.isMoving(f,h)&&s.getMovement(f,h);var m=s.getStartMousePosition(f,h);if(e.enableInputs&&t){if(p){i(e,m,p)}else if(n<1){D(s,f,h,n,i,e,o)}}}}var R=new _;var L=new t;var N=new e;var k=new t;var F=new e;var B=new t;var U=new t;var V=new t;var z=new t;var q=new t;var G=new t;var H=new t;var j=new t;var W=new t;var Y=new t;var X=new t;var Q=new t;var Z=new t;var K=new t;var J=new t;var $=new t;var ee=new t;var te=new t;function re(r,i,n,o,s,l){var u=1;if(a(l)){u=f.clamp(Math.abs(l),.25,1)}var c=r.minimumZoomDistance*u;var d=r.maximumZoomDistance;var h=s-c;var p=o*h;p=f.clamp(p,r._minimumZoomRate,r._maximumZoomRate);var v=n.endPosition.y-n.startPosition.y;var g=v/r._scene.canvas.clientHeight;g=Math.min(g,r.maximumMovementRatio);var _=p*g;if(_>0&&Math.abs(s-c)<1){return}if(_<0&&Math.abs(s-d)<1){return}if(s-_<c){_=s-c-1}else if(s-_>d){_=s-d}var y=r._scene;var b=y.camera;var w=y.mode;if(b.frustum instanceof m){if(Math.abs(_)>0){b.zoomIn(_);b._adjustOrthographicFrustum()}return}var C=e.equals(i,r._zoomMouseStart);var E=r._zoomingOnVector;var x=r._rotatingZoom;var P;if(!C){r._zoomMouseStart=e.clone(i,r._zoomMouseStart);if(a(r._globe)){P=w!==S.SCENE2D?ve(r,i,L):b.getPickRay(i,R).origin}if(a(P)){r._useZoomWorldPosition=true;r._zoomWorldPosition=t.clone(P,r._zoomWorldPosition)}else{r._useZoomWorldPosition=false}E=r._zoomingOnVector=false;x=r._rotatingZoom=false}if(!r._useZoomWorldPosition){b.zoomIn(_);return}var A=w===S.COLUMBUS_VIEW;if(b.positionCartographic.height<2e6){x=true}if(!C||x){if(w===S.SCENE2D){var O=r._zoomWorldPosition;var D=b.position;if(!t.equals(O,D)&&b.positionCartographic.height<r._maxCoord.x*2){var I=b.position.x;var M=t.subtract(O,D,k);t.normalize(M,M);var re=t.distance(O,D)*_/(b.getMagnitude()*.5);b.move(M,re*.5);if(b.position.x<0&&I>0||b.position.x>0&&I<0){P=b.getPickRay(i,R).origin;r._zoomWorldPosition=t.clone(P,r._zoomWorldPosition)}}}else if(w===S.SCENE3D){var ie=t.normalize(b.position,q);if(b.positionCartographic.height<3e3&&Math.abs(t.dot(b.direction,ie))<.6){A=true}else{var ne=y.canvas;var ae=F;ae.x=ne.clientWidth/2;ae.y=ne.clientHeight/2;var oe=ve(r,ae,B);if(a(oe)&&b.positionCartographic.height<1e6){var se=H;t.clone(b.position,se);var le=r._zoomWorldPosition;var ue=G;ue=t.normalize(le,ue);if(t.dot(ue,ie)<0){return}var ce=J;var de=Y;t.clone(b.direction,de);t.add(se,t.multiplyByScalar(de,1e3,$),ce);var fe=X;var he=Q;t.subtract(le,se,fe);t.normalize(fe,he);var pe=t.dot(ie,he);if(pe>=0){r._zoomMouseStart.x=-1;return}var me=Math.acos(-pe);var ge=t.magnitude(se);var _e=t.magnitude(le);var ye=ge-_;var be=t.magnitude(fe);var we=Math.asin(f.clamp(be/_e*Math.sin(me),-1,1));var Ce=Math.asin(f.clamp(ye/_e*Math.sin(me),-1,1));var Se=we-Ce+me;var Te=j;t.normalize(se,Te);var Ee=W;Ee=t.cross(he,Te,Ee);Ee=t.normalize(Ee,Ee);t.normalize(t.cross(Te,Ee,$),de);t.multiplyByScalar(t.normalize(ce,$),t.magnitude(ce)-_,ce);t.normalize(se,se);t.multiplyByScalar(se,ye,se);var xe=Z;t.multiplyByScalar(t.add(t.multiplyByScalar(Te,Math.cos(Se)-1,ee),t.multiplyByScalar(de,Math.sin(Se),te),$),ye,xe);t.add(se,xe,se);t.normalize(ce,Te);t.normalize(t.cross(Te,Ee,$),de);var Pe=K;t.multiplyByScalar(t.add(t.multiplyByScalar(Te,Math.cos(Se)-1,ee),t.multiplyByScalar(de,Math.sin(Se),te),$),t.magnitude(ce),Pe);t.add(ce,Pe,ce);t.clone(se,b.position);t.normalize(t.subtract(ce,se,$),b.direction);t.clone(b.direction,b.direction);t.cross(b.direction,b.up,b.right);t.cross(b.right,b.direction,b.up);return}if(a(oe)){var Ae=t.normalize(oe,U);var Oe=t.normalize(r._zoomWorldPosition,V);var De=t.dot(Oe,Ae);if(De>0&&De<1){var Ie=f.acosClamped(De);var Me=t.cross(Oe,Ae,z);var Re=Math.abs(Ie)>f.toRadians(20)?b.positionCartographic.height*.75:b.positionCartographic.height-_;var Le=_/Re;b.rotate(Me,Ie*Le)}}else{A=true}}}r._rotatingZoom=!A}if(!C&&A||E){var Ne;var ke=T.wgs84ToWindowCoordinates(y,r._zoomWorldPosition,N);if(w!==S.COLUMBUS_VIEW&&e.equals(i,r._zoomMouseStart)&&a(ke)){Ne=b.getPickRay(ke,R)}else{Ne=b.getPickRay(i,R)}var Fe=Ne.direction;if(w===S.COLUMBUS_VIEW){t.fromElements(Fe.y,Fe.z,Fe.x,Fe)}b.move(Fe,_);r._zoomingOnVector=true}else{b.zoomIn(_)}}var ie=new _;var ne=new _;var ae=new t;function oe(e,r,i){var n=e._scene;var a=n.camera;var o=a.getPickRay(i.startPosition,ie).origin;var s=a.getPickRay(i.endPosition,ne).origin;var l=t.subtract(o,s,ae);var u=t.magnitude(l);if(u>0){t.normalize(l,l);a.move(l,u)}}function se(e,t,r){if(a(r.distance)){r=r.distance}var i=e._scene;var n=i.camera;re(e,t,r,e._zoomFactor,n.getMagnitude())}var le=new e;var ue=new e;function ce(t,r,i){if(a(i.angleAndHeight)){de(t,r,i.angleAndHeight);return}var n=t._scene;var o=n.camera;var s=n.canvas;var l=s.clientWidth;var u=s.clientHeight;var c=le;c.x=2/l*i.startPosition.x-1;c.y=2/u*(u-i.startPosition.y)-1;c=e.normalize(c,c);var d=ue;d.x=2/l*i.endPosition.x-1;d.y=2/u*(u-i.endPosition.y)-1;d=e.normalize(d,d);var h=f.acosClamped(c.x);if(c.y<0){h=f.TWO_PI-h}var p=f.acosClamped(d.x);if(d.y<0){p=f.TWO_PI-p}var m=p-h;o.twistRight(m)}function de(e,t,r){var i=e._rotateFactor*e._rotateRateRangeAdjustment;if(i>e._maximumRotateRate){i=e._maximumRotateRate}if(i<e._minimumRotateRate){i=e._minimumRotateRate}var n=e._scene;var a=n.camera;var o=n.canvas;var s=(r.endPosition.x-r.startPosition.x)/o.clientWidth;s=Math.min(s,e.maximumMovementRatio);var l=i*s*Math.PI*4;a.twistRight(l)}function fe(e){var t=e._scene.mapMode2D===C.ROTATE;if(!p.equals(p.IDENTITY,e._scene.camera.transform)){M(e,e.enableZoom,e.zoomEventTypes,se,e.inertiaZoom,"_lastInertiaZoomMovement");if(t){M(e,e.enableRotate,e.translateEventTypes,ce,e.inertiaSpin,"_lastInertiaSpinMovement")}}else{M(e,e.enableTranslate,e.translateEventTypes,oe,e.inertiaTranslate,"_lastInertiaTranslateMovement");M(e,e.enableZoom,e.zoomEventTypes,se,e.inertiaZoom,"_lastInertiaZoomMovement");if(t){M(e,e.enableRotate,e.tiltEventTypes,ce,e.inertiaSpin,"_lastInertiaTiltMovement")}}}var he=new _;var pe=new t;var me=new t;function ve(e,r,i){var n=e._scene;var o=e._globe;var s=n.camera;if(!a(o)){return undefined}var l;if(n.pickPositionSupported){l=n.pickPositionWorldCoordinates(r,pe)}var u=s.getPickRay(r,he);var c=o.pick(u,n,me);var d=a(l)?t.distance(l,s.positionWC):Number.POSITIVE_INFINITY;var f=a(c)?t.distance(c,s.positionWC):Number.POSITIVE_INFINITY;if(d<f){return t.clone(l,i)}return t.clone(c,i)}var ge=new _;var _e=new _;var ye=new t;var be=new t;var we=new t;var Ce=new t;var Se=new v(t.UNIT_X,0);var Te=new e;var Ee=new e;function xe(r,i,n){if(!t.equals(i,r._translateMousePosition)){r._looking=false}if(!t.equals(i,r._strafeMousePosition)){r._strafing=false}if(r._looking){zt(r,i,n);return}if(r._strafing){et(r,i,n);return}var o=r._scene;var s=o.camera;var l=e.clone(n.startPosition,Te);var c=e.clone(n.endPosition,Ee);var d=s.getPickRay(l,ge);var h=t.clone(t.ZERO,Ce);var p=t.UNIT_X;var m;if(s.position.z<r._minimumPickingTerrainHeight){m=ve(r,l,ye);if(a(m)){h.x=m.x}}if(h.x>s.position.z&&a(m)){t.clone(m,r._strafeStartPosition);r._strafing=true;et(r,i,n);r._strafeMousePosition=e.clone(i,r._strafeMousePosition);return}var g=v.fromPointNormal(h,p,Se);d=s.getPickRay(l,ge);var _=u.rayPlane(d,g,ye);var y=s.getPickRay(c,_e);var b=u.rayPlane(y,g,be);if(!a(_)||!a(b)){r._looking=true;zt(r,i,n);e.clone(i,r._translateMousePosition);return}var w=t.subtract(_,b,we);var C=w.x;w.x=w.y;w.y=w.z;w.z=C;var S=t.magnitude(w);if(S>f.EPSILON6){t.normalize(w,w);s.move(w,S)}}var Pe=new e;var Ae=new _;var Oe=new t;var De=new t;var Ie=new p;var Me=new p;var Re=new t;var Le=new v(t.UNIT_X,0);var Ne=new t;var ke=new i;var Fe=new p;var Be=new g;var Ue=new h;var Ve=new t;function ze(t,r,i){if(a(i.angleAndHeight)){i=i.angleAndHeight}if(!e.equals(r,t._tiltCenterMousePosition)){t._tiltCVOffMap=false;t._looking=false}if(t._looking){zt(t,r,i);return}var n=t._scene;var o=n.camera;var s=t._maxCoord;var l=Math.abs(o.position.x)-s.x<0&&Math.abs(o.position.y)-s.y<0;if(t._tiltCVOffMap||!l||o.position.z>t._minimumPickingTerrainHeight){t._tiltCVOffMap=true;qe(t,r,i)}else{Ge(t,r,i)}}function qe(r,i,n){var o=r._scene;var s=o.camera;var u=o.canvas;var c=Pe;c.x=u.clientWidth/2;c.y=u.clientHeight/2;var d=s.getPickRay(c,Ae);var h=t.UNIT_X;var m=d.origin;var v=d.direction;var g;var _=t.dot(h,v);if(Math.abs(_)>f.EPSILON6){g=-t.dot(h,m)/_}if(!a(g)||g<=0){r._looking=true;zt(r,i,n);e.clone(i,r._tiltCenterMousePosition);return}var b=t.multiplyByScalar(v,g,Oe);t.add(m,b,b);var w=o.mapProjection;var C=w.ellipsoid;t.fromElements(b.y,b.z,b.x,b);var S=w.unproject(b,ke);C.cartographicToCartesian(S,b);var T=y.eastNorthUpToFixedFrame(b,C,Ie);var E=r._globe;var x=r._ellipsoid;r._globe=undefined;r._ellipsoid=l.UNIT_SPHERE;r._rotateFactor=1;r._rotateRateRangeAdjustment=1;var P=p.clone(s.transform,Fe);s._setTransform(T);st(r,i,n,t.UNIT_Z);s._setTransform(P);r._globe=E;r._ellipsoid=x;var A=x.maximumRadius;r._rotateFactor=1/A;r._rotateRateRangeAdjustment=A}function Ge(r,i,n){var o=r._scene;var s=o.camera;var c;var d;var m=t.UNIT_X;if(e.equals(i,r._tiltCenterMousePosition)){c=t.clone(r._tiltCenter,Oe)}else{if(s.position.z<r._minimumPickingTerrainHeight){c=ve(r,i,Oe)}if(!a(c)){d=s.getPickRay(i,Ae);var _=d.origin;var b=d.direction;var w;var C=t.dot(m,b);if(Math.abs(C)>f.EPSILON6){w=-t.dot(m,_)/C}if(!a(w)||w<=0){r._looking=true;zt(r,i,n);e.clone(i,r._tiltCenterMousePosition);return}c=t.multiplyByScalar(b,w,Oe);t.add(_,c,c)}e.clone(i,r._tiltCenterMousePosition);t.clone(c,r._tiltCenter)}var S=o.canvas;var T=Pe;T.x=S.clientWidth/2;T.y=r._tiltCenterMousePosition.y;d=s.getPickRay(T,Ae);var E=t.clone(t.ZERO,Re);E.x=c.x;var x=v.fromPointNormal(E,m,Le);var P=u.rayPlane(d,x,De);var A=s._projection;var O=A.ellipsoid;t.fromElements(c.y,c.z,c.x,c);var D=A.unproject(c,ke);O.cartographicToCartesian(D,c);var I=y.eastNorthUpToFixedFrame(c,O,Ie);var M;if(a(P)){t.fromElements(P.y,P.z,P.x,P);D=A.unproject(P,ke);O.cartographicToCartesian(D,P);M=y.eastNorthUpToFixedFrame(P,O,Me)}else{M=I}var R=r._globe;var L=r._ellipsoid;r._globe=undefined;r._ellipsoid=l.UNIT_SPHERE;r._rotateFactor=1;r._rotateRateRangeAdjustment=1;var N=t.UNIT_Z;var k=p.clone(s.transform,Fe);s._setTransform(I);var F=t.cross(t.UNIT_Z,t.normalize(s.position,Ne),Ne);var B=t.dot(s.right,F);st(r,i,n,N,false,true);s._setTransform(M);if(B<0){if(n.startPosition.y>n.endPosition.y){N=undefined}var U=s.constrainedAxis;s.constrainedAxis=undefined;st(r,i,n,N,true,false);s.constrainedAxis=U}else{st(r,i,n,N,true,false)}if(a(s.constrainedAxis)){var V=t.cross(s.direction,s.constrainedAxis,Ve);if(!t.equalsEpsilon(V,t.ZERO,f.EPSILON6)){if(t.dot(V,s.right)<0){t.negate(V,V)}t.cross(V,s.direction,s.up);t.cross(s.direction,s.up,s.right);t.normalize(s.up,s.up);t.normalize(s.right,s.right)}}s._setTransform(k);r._globe=R;r._ellipsoid=L;var z=L.maximumRadius;r._rotateFactor=1/z;r._rotateRateRangeAdjustment=z;var q=t.clone(s.positionWC,Ne);s._adjustHeightForTerrain();if(!t.equals(s.positionWC,q)){s._setTransform(M);s.worldToCameraCoordinatesPoint(q,q);var G=t.magnitudeSquared(q);if(t.magnitudeSquared(s.position)>G){t.normalize(s.position,s.position);t.multiplyByScalar(s.position,Math.sqrt(G),s.position)}var H=t.angleBetween(q,s.position);var j=t.cross(q,s.position,q);t.normalize(j,j);var W=g.fromAxisAngle(j,H,Be);var Y=h.fromQuaternion(W,Ue);h.multiplyByVector(Y,s.direction,s.direction);h.multiplyByVector(Y,s.up,s.up);t.cross(s.direction,s.up,s.right);t.cross(s.right,s.direction,s.up);s._setTransform(k)}}var He=new e;var je=new _;var We=new t;function Ye(e,r,i){if(a(i.distance)){i=i.distance}var n=e._scene;var o=n.camera;var s=n.canvas;var l=He;l.x=s.clientWidth/2;l.y=s.clientHeight/2;var u=o.getPickRay(l,je);var c;if(o.position.z<e._minimumPickingTerrainHeight){c=ve(e,l,We)}var d;if(a(c)){d=t.distance(u.origin,c)}else{var f=t.UNIT_X;var h=u.origin;var p=u.direction;d=-t.dot(f,h)/t.dot(f,p)}re(e,r,i,e._zoomFactor,d)}function Xe(e){var t=e._scene;var r=t.camera;if(!p.equals(p.IDENTITY,r.transform)){M(e,e.enableRotate,e.rotateEventTypes,st,e.inertiaSpin,"_lastInertiaSpinMovement");M(e,e.enableZoom,e.zoomEventTypes,yt,e.inertiaZoom,"_lastInertiaZoomMovement")}else{var i=e._tweens;if(e._aggregator.anyButtonDown){i.removeAll()}M(e,e.enableTilt,e.tiltEventTypes,ze,e.inertiaSpin,"_lastInertiaTiltMovement");M(e,e.enableTranslate,e.translateEventTypes,xe,e.inertiaTranslate,"_lastInertiaTranslateMovement");M(e,e.enableZoom,e.zoomEventTypes,Ye,e.inertiaZoom,"_lastInertiaZoomMovement");M(e,e.enableLook,e.lookEventTypes,zt);if(!e._aggregator.anyButtonDown&&(!a(e._lastInertiaZoomMovement)||!e._lastInertiaZoomMovement.active)&&(!a(e._lastInertiaTranslateMovement)||!e._lastInertiaTranslateMovement.active)&&!i.contains(e._tween)){var n=r.createCorrectPositionTween(e.bounceAnimationTime);if(a(n)){e._tween=i.add(n)}}i.update()}}var Qe=new _;var Ze=new v(t.UNIT_X,0);var Ke=new t;var Je=new t;var $e=new t;function et(e,r,i){var n=e._scene;var o=n.camera;var s=ve(e,i.startPosition,$e);if(!a(s)){return}var l=i.endPosition;var c=o.getPickRay(l,Qe);var d=t.clone(o.direction,Je);if(n.mode===S.COLUMBUS_VIEW){t.fromElements(d.z,d.x,d.y,d)}var f=v.fromPointNormal(s,d,Ze);var h=u.rayPlane(c,f,Ke);if(!a(h)){return}d=t.subtract(s,h,d);if(n.mode===S.COLUMBUS_VIEW){t.fromElements(d.y,d.z,d.x,d)}t.add(o.position,d,o.position)}var tt=new t;var rt=new i;var it=new t;var nt=new l;var at=new t;function ot(r,i,n){var o=r._scene;var s=o.camera;if(!p.equals(s.transform,p.IDENTITY)){st(r,i,n);return}var u;var c;var d;var f=r._ellipsoid.geodeticSurfaceNormal(s.position,at);var h=r._ellipsoid.cartesianToCartographic(s.positionWC,rt).height;var m=r._globe;var v;var g=false;if(a(m)&&h<r._minimumPickingTerrainHeight){v=ve(r,n.startPosition,$e);if(a(v)){var _=s.getPickRay(n.startPosition,he);var y=r._ellipsoid.geodeticSurfaceNormal(v);g=Math.abs(t.dot(_.direction,y))<.05;if(g&&!r._looking){r._rotating=false;r._strafing=true}}}if(e.equals(i,r._rotateMousePosition)){if(r._looking){zt(r,i,n,f)}else if(r._rotating){st(r,i,n)}else if(r._strafing){t.clone(v,r._strafeStartPosition);et(r,i,n)}else{u=t.magnitude(r._rotateStartPosition);c=it;c.x=c.y=c.z=u;d=l.fromCartesian3(c,nt);vt(r,i,n,d)}return}r._looking=false;r._rotating=false;r._strafing=false;if(a(m)&&h<r._minimumPickingTerrainHeight){if(a(v)){if(t.magnitude(s.position)<t.magnitude(v)){t.clone(v,r._strafeStartPosition);r._strafing=true;et(r,i,n)}else{u=t.magnitude(v);c=it;c.x=c.y=c.z=u;d=l.fromCartesian3(c,nt);vt(r,i,n,d);t.clone(v,r._rotateStartPosition)}}else{r._looking=true;zt(r,i,n,f)}}else if(a(s.pickEllipsoid(n.startPosition,r._ellipsoid,tt))){vt(r,i,n,r._ellipsoid);t.clone(tt,r._rotateStartPosition)}else if(h>r._minimumTrackBallHeight){r._rotating=true;st(r,i,n)}else{r._looking=true;zt(r,i,n,f)}e.clone(i,r._rotateMousePosition)}function st(e,r,i,o,s,l){s=n(s,false);l=n(l,false);var u=e._scene;var c=u.camera;var d=u.canvas;var f=c.constrainedAxis;if(a(o)){c.constrainedAxis=o}var h=t.magnitude(c.position);var p=e._rotateFactor*(h-e._rotateRateRangeAdjustment);if(p>e._maximumRotateRate){p=e._maximumRotateRate}if(p<e._minimumRotateRate){p=e._minimumRotateRate}var m=(i.startPosition.x-i.endPosition.x)/d.clientWidth;var v=(i.startPosition.y-i.endPosition.y)/d.clientHeight;m=Math.min(m,e.maximumMovementRatio);v=Math.min(v,e.maximumMovementRatio);var g=p*m*Math.PI*2;var _=p*v*Math.PI;if(!s){c.rotateRight(g)}if(!l){c.rotateUp(_)}c.constrainedAxis=f}var lt=r.clone(r.UNIT_W);var ut=r.clone(r.UNIT_W);var ct=new t;var dt=new t;var ft=new t;var ht=new t;var pt=new e;var mt=new e;function vt(r,i,n,o){var s=r._scene;var l=s.camera;var u=e.clone(n.startPosition,pt);var c=e.clone(n.endPosition,mt);var d=l.pickEllipsoid(u,o,lt);var h=l.pickEllipsoid(c,o,ut);if(!a(d)||!a(h)){r._rotating=true;st(r,i,n);return}d=l.worldToCameraCoordinates(d,d);h=l.worldToCameraCoordinates(h,h);if(!a(l.constrainedAxis)){t.normalize(d,d);t.normalize(h,h);var p=t.dot(d,h);var m=t.cross(d,h,ct);if(p<1&&!t.equalsEpsilon(m,t.ZERO,f.EPSILON14)){var v=Math.acos(p);l.rotate(m,v)}}else{var g=l.constrainedAxis;var _=t.mostOrthogonalAxis(g,ct);t.cross(_,g,_);t.normalize(_,_);var y=t.cross(g,_,dt);var b=t.magnitude(d);var w=t.dot(g,d);var C=Math.acos(w/b);var S=t.multiplyByScalar(g,w,ft);t.subtract(d,S,S);t.normalize(S,S);var T=t.magnitude(h);var E=t.dot(g,h);var x=Math.acos(E/T);var P=t.multiplyByScalar(g,E,ht);t.subtract(h,P,P);t.normalize(P,P);var A=Math.acos(t.dot(S,_));if(t.dot(S,y)<0){A=f.TWO_PI-A}var O=Math.acos(t.dot(P,_));if(t.dot(P,y)<0){O=f.TWO_PI-O}var D=A-O;var I;if(t.equalsEpsilon(g,l.position,f.EPSILON2)){I=l.right}else{I=t.cross(g,l.position,ct)}var M=t.cross(g,I,ct);var R=t.dot(M,t.subtract(d,g,dt));var L=t.dot(M,t.subtract(h,g,dt));var N;if(R>0&&L>0){N=x-C}else if(R>0&&L<=0){if(t.dot(l.position,g)>0){N=-C-x}else{N=C+x}}else{N=C-x}l.rotateRight(D);l.rotateUp(N)}}var gt=new t;var _t=new i;function yt(e,r,i){if(a(i.distance)){i=i.distance}var n=e._ellipsoid;var o=e._scene;var s=o.camera;var l=o.canvas;var u=He;u.x=l.clientWidth/2;u.y=l.clientHeight/2;var c=s.getPickRay(u,je);var d;var f=n.cartesianToCartographic(s.position,_t).height;if(f<e._minimumPickingTerrainHeight){d=ve(e,u,We)}var h;if(a(d)){h=t.distance(c.origin,d)}else{h=f}var p=t.normalize(s.position,gt);re(e,r,i,e._zoomFactor,h,t.dot(p,s.direction))}var bt=new e;var wt=new _;var Ct=new t;var St=new t;var Tt=new p;var Et=new p;var xt=new p;var Pt=new g;var At=new h;var Ot=new i;var Dt=new t;function It(t,r,i){var n=t._scene;var o=n.camera;if(!p.equals(o.transform,p.IDENTITY)){return}if(a(i.angleAndHeight)){i=i.angleAndHeight}if(!e.equals(r,t._tiltCenterMousePosition)){t._tiltOnEllipsoid=false;t._looking=false}if(t._looking){var s=t._ellipsoid.geodeticSurfaceNormal(o.position,Dt);zt(t,r,i,s);return}var l=t._ellipsoid;var u=l.cartesianToCartographic(o.position,Ot);if(t._tiltOnEllipsoid||u.height>t._minimumCollisionTerrainHeight){t._tiltOnEllipsoid=true;Rt(t,r,i)}else{Lt(t,r,i)}}var Mt=new i;function Rt(r,i,n){var o=r._ellipsoid;var s=r._scene;var c=s.camera;var d=r.minimumZoomDistance*.25;var h=o.cartesianToCartographic(c.positionWC,Mt).height;if(h-d-1<f.EPSILON3&&n.endPosition.y-n.startPosition.y<0){return}var m=s.canvas;var v=bt;v.x=m.clientWidth/2;v.y=m.clientHeight/2;var g=c.getPickRay(v,wt);var b;var w=u.rayEllipsoid(g,o);if(a(w)){b=_.getPoint(g,w.start,Ct)}else if(h>r._minimumTrackBallHeight){var C=u.grazingAltitudeLocation(g,o);if(!a(C)){return}var S=o.cartesianToCartographic(C,Ot);S.height=0;b=o.cartographicToCartesian(S,Ct)}else{r._looking=true;var T=r._ellipsoid.geodeticSurfaceNormal(c.position,Dt);zt(r,i,n,T);e.clone(i,r._tiltCenterMousePosition);return}var E=y.eastNorthUpToFixedFrame(b,o,Tt);var x=r._globe;var P=r._ellipsoid;r._globe=undefined;r._ellipsoid=l.UNIT_SPHERE;r._rotateFactor=1;r._rotateRateRangeAdjustment=1;var A=p.clone(c.transform,xt);c._setTransform(E);st(r,i,n,t.UNIT_Z);c._setTransform(A);r._globe=x;r._ellipsoid=P;var O=P.maximumRadius;r._rotateFactor=1/O;r._rotateRateRangeAdjustment=O}function Lt(r,i,n){var o=r._ellipsoid;var s=r._scene;var c=s.camera;var d;var m;var v;if(e.equals(i,r._tiltCenterMousePosition)){d=t.clone(r._tiltCenter,Ct)}else{d=ve(r,i,Ct);if(!a(d)){m=c.getPickRay(i,wt);v=u.rayEllipsoid(m,o);if(!a(v)){var b=o.cartesianToCartographic(c.position,Ot);if(b.height<=r._minimumTrackBallHeight){r._looking=true;var w=r._ellipsoid.geodeticSurfaceNormal(c.position,Dt);zt(r,i,n,w);e.clone(i,r._tiltCenterMousePosition)}return}d=_.getPoint(m,v.start,Ct)}e.clone(i,r._tiltCenterMousePosition);t.clone(d,r._tiltCenter)}var C=s.canvas;var S=bt;S.x=C.clientWidth/2;S.y=r._tiltCenterMousePosition.y;m=c.getPickRay(S,wt);var T=t.magnitude(d);var E=t.fromElements(T,T,T,it);var x=l.fromCartesian3(E,nt);v=u.rayEllipsoid(m,x);if(!a(v)){return}var P=t.magnitude(m.origin)>T?v.start:v.stop;var A=_.getPoint(m,P,St);var O=y.eastNorthUpToFixedFrame(d,o,Tt);var D=y.eastNorthUpToFixedFrame(A,x,Et);var I=r._globe;var M=r._ellipsoid;r._globe=undefined;r._ellipsoid=l.UNIT_SPHERE;r._rotateFactor=1;r._rotateRateRangeAdjustment=1;var R=t.UNIT_Z;var L=p.clone(c.transform,xt);c._setTransform(O);var N=t.cross(A,c.positionWC,Ve);var k=t.dot(c.rightWC,N);st(r,i,n,R,false,true);c._setTransform(D);if(k<0){if(n.startPosition.y>n.endPosition.y){R=undefined}var F=c.constrainedAxis;c.constrainedAxis=undefined;st(r,i,n,R,true,false);c.constrainedAxis=F}else{st(r,i,n,R,true,false)}if(a(c.constrainedAxis)){var B=t.cross(c.direction,c.constrainedAxis,Ve);if(!t.equalsEpsilon(B,t.ZERO,f.EPSILON6)){if(t.dot(B,c.right)<0){t.negate(B,B)}t.cross(B,c.direction,c.up);t.cross(c.direction,c.up,c.right);t.normalize(c.up,c.up);t.normalize(c.right,c.right)}}c._setTransform(L);r._globe=I;r._ellipsoid=M;var U=M.maximumRadius;r._rotateFactor=1/U;r._rotateRateRangeAdjustment=U;var V=t.clone(c.positionWC,Ve);c._adjustHeightForTerrain();if(!t.equals(c.positionWC,V)){c._setTransform(D);c.worldToCameraCoordinatesPoint(V,V);var z=t.magnitudeSquared(V);if(t.magnitudeSquared(c.position)>z){t.normalize(c.position,c.position);t.multiplyByScalar(c.position,Math.sqrt(z),c.position)}var q=t.angleBetween(V,c.position);var G=t.cross(V,c.position,V);t.normalize(G,G);var H=g.fromAxisAngle(G,q,Pt);var j=h.fromQuaternion(H,At);h.multiplyByVector(j,c.direction,c.direction);h.multiplyByVector(j,c.up,c.up);t.cross(c.direction,c.up,c.right);t.cross(c.right,c.direction,c.up);c._setTransform(L)}}var Nt=new e;var kt=new e;var Ft=new _;var Bt=new _;var Ut=new t;var Vt=new t;function zt(e,r,i,o){var s=e._scene;var l=s.camera;var u=Nt;u.x=i.startPosition.x;u.y=0;var c=kt;c.x=i.endPosition.x;c.y=0;var d=l.getPickRay(u,Ft);var h=l.getPickRay(c,Bt);var p=0;var v;var g;if(l.frustum instanceof m){v=d.origin;g=h.origin;t.add(l.direction,v,v);t.add(l.direction,g,g);t.subtract(v,l.position,v);t.subtract(g,l.position,g);t.normalize(v,v);t.normalize(g,g)}else{v=d.direction;g=h.direction}var _=t.dot(v,g);if(_<1){p=Math.acos(_)}p=i.startPosition.x>i.endPosition.x?-p:p;var y=e._horizontalRotationAxis;if(a(o)){l.look(o,-p)}else if(a(y)){l.look(y,-p)}else{l.lookLeft(p)}u.x=0;u.y=i.startPosition.y;c.x=0;c.y=i.endPosition.y;d=l.getPickRay(u,Ft);h=l.getPickRay(c,Bt);p=0;if(l.frustum instanceof m){v=d.origin;g=h.origin;t.add(l.direction,v,v);t.add(l.direction,g,g);t.subtract(v,l.position,v);t.subtract(g,l.position,g);t.normalize(v,v);t.normalize(g,g)}else{v=d.direction;g=h.direction}_=t.dot(v,g);if(_<1){p=Math.acos(_)}p=i.startPosition.y>i.endPosition.y?-p:p;o=n(o,y);if(a(o)){var b=l.direction;var w=t.negate(o,Ut);var C=t.equalsEpsilon(b,o,f.EPSILON2);var S=t.equalsEpsilon(b,w,f.EPSILON2);if(!C&&!S){_=t.dot(b,o);var T=f.acosClamped(_);if(p>0&&p>T){p=T-f.EPSILON4}_=t.dot(b,w);T=f.acosClamped(_);if(p<0&&-p>T){p=-T+f.EPSILON4}var E=t.cross(o,b,Vt);l.look(E,p)}else if(C&&p<0||S&&p>0){l.look(l.right,-p)}}else{l.lookUp(p)}}function qt(e){M(e,e.enableRotate,e.rotateEventTypes,ot,e.inertiaSpin,"_lastInertiaSpinMovement");M(e,e.enableZoom,e.zoomEventTypes,yt,e.inertiaZoom,"_lastInertiaZoomMovement");M(e,e.enableTilt,e.tiltEventTypes,It,e.inertiaSpin,"_lastInertiaTiltMovement");M(e,e.enableLook,e.lookEventTypes,zt)}x.prototype.update=function(){if(!p.equals(this._scene.camera.transform,p.IDENTITY)){this._globe=undefined;this._ellipsoid=l.UNIT_SPHERE}else{this._globe=this._scene.globe;this._ellipsoid=a(this._globe)?this._globe.ellipsoid:this._scene.mapProjection.ellipsoid}this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight*this._scene.terrainExaggeration;this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight*this._scene.terrainExaggeration;this._minimumTrackBallHeight=this.minimumTrackBallHeight*this._scene.terrainExaggeration;var e=this._ellipsoid.maximumRadius;this._rotateFactor=1/e;this._rotateRateRangeAdjustment=e;var r=this._scene;var i=r.mode;if(i===S.SCENE2D){fe(this)}else if(i===S.COLUMBUS_VIEW){this._horizontalRotationAxis=t.UNIT_Z;Xe(this)}else if(i===S.SCENE3D){this._horizontalRotationAxis=undefined;qt(this)}this._aggregator.reset()};x.prototype.isDestroyed=function(){return false};x.prototype.destroy=function(){this._tweens.removeAll();this._aggregator=this._aggregator&&this._aggregator.destroy();return o(this)};return x});define("Scene/ShadowMapShader",["../Core/defined","../Renderer/ShaderSource"],function(e,t){"use strict";function r(){}r.getShadowCastShaderKeyword=function(e,t,r,i){return"castShadow "+e+" "+t+" "+r+" "+i};r.createShadowCastVertexShader=function(r,i,n){var a=r.defines.slice(0);var o=r.sources.slice(0);if(n){a.push("GENERATE_POSITION")}var s=t.findPositionVarying(r);var l=e(s);if(i&&!l){var u=o.length;for(var c=0;c<u;++c){o[c]=t.replaceMain(o[c],"czm_shadow_cast_main")}var d="varying vec3 v_positionEC; \n"+"void main() \n"+"{ \n"+"    czm_shadow_cast_main(); \n"+"    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n"+"}";o.push(d)}return new t({defines:a,sources:o})};r.createShadowCastFragmentShader=function(r,i,n,a){var o=r.defines.slice(0);var s=r.sources.slice(0);var l=t.findPositionVarying(r);var u=e(l);if(!u){l="v_positionEC"}var c=s.length;for(var d=0;d<c;++d){s[d]=t.replaceMain(s[d],"czm_shadow_cast_main")}var f="";if(i){if(!u){f+="varying vec3 v_positionEC; \n"}f+="uniform vec4 shadowMap_lightPositionEC; \n"}if(a){f+="void main() \n"+"{ \n"}else{f+="void main() \n"+"{ \n"+"    czm_shadow_cast_main(); \n"+"    if (gl_FragColor.a == 0.0) \n"+"    { \n"+"       discard; \n"+"    } \n"}if(i){f+="float distance = length("+l+"); \n"+"distance /= shadowMap_lightPositionEC.w; // radius \n"+"gl_FragColor = czm_packDepth(distance); \n"}else if(n){f+="gl_FragColor = vec4(1.0); \n"}else{f+="gl_FragColor = czm_packDepth(gl_FragCoord.z); \n"}f+="} \n";s.push(f);return new t({defines:o,sources:s})};r.getShadowReceiveShaderKeyword=function(e,t,r,i){var n=e._usesDepthTexture;var a=e._polygonOffsetSupported;var o=e._isPointLight;var s=e._isSpotLight;var l=e._numberOfCascades>1;var u=e.debugCascadeColors;var c=e.softShadows;return"receiveShadow "+n+a+o+s+l+u+c+t+r+i};r.createShadowReceiveVertexShader=function(e,r,i){var n=e.defines.slice(0);var a=e.sources.slice(0);if(r){if(i){n.push("GENERATE_POSITION_AND_NORMAL")}else{n.push("GENERATE_POSITION")}}return new t({defines:n,sources:a})};r.createShadowReceiveFragmentShader=function(r,i,n,a,o){var s=t.findNormalVarying(r);var l=!a&&e(s)||a&&o;var u=t.findPositionVarying(r);var c=e(u);var d=i._usesDepthTexture;var f=i._polygonOffsetSupported;var h=i._isPointLight;var p=i._isSpotLight;var m=i._numberOfCascades>1;var v=i.debugCascadeColors;var g=i.softShadows;var _=h?i._pointBias:a?i._terrainBias:i._primitiveBias;var y=r.defines.slice(0);var b=r.sources.slice(0);var w=b.length;for(var C=0;C<w;++C){b[C]=t.replaceMain(b[C],"czm_shadow_receive_main")}if(h){y.push("USE_CUBE_MAP_SHADOW")}else if(d){y.push("USE_SHADOW_DEPTH_TEXTURE")}if(g&&!h){y.push("USE_SOFT_SHADOWS")}if(m&&n&&a){if(l){y.push("ENABLE_VERTEX_LIGHTING")}else{y.push("ENABLE_DAYNIGHT_SHADING")}}if(n&&_.normalShading&&l){y.push("USE_NORMAL_SHADING");if(_.normalShadingSmooth>0){y.push("USE_NORMAL_SHADING_SMOOTH")}}var S="";if(h){S+="uniform samplerCube shadowMap_textureCube; \n"}else{S+="uniform sampler2D shadowMap_texture; \n"}S+="uniform mat4 shadowMap_matrix; \n"+"uniform vec3 shadowMap_lightDirectionEC; \n"+"uniform vec4 shadowMap_lightPositionEC; \n"+"uniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \n"+"uniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n"+"vec4 getPositionEC() \n"+"{ \n"+(c?"    return vec4("+u+", 1.0); \n":"    return czm_windowToEyeCoordinates(gl_FragCoord); \n")+"} \n"+"vec3 getNormalEC() \n"+"{ \n"+(l?"    return normalize("+s+"); \n":"    return vec3(1.0); \n")+"} \n"+"void applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n"+"{ \n"+(_.normalOffset&&l?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n"+"    float normalOffsetScale = 1.0 - nDotL; \n"+"    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n"+"    positionEC.xyz += offset; \n":"")+"} \n";S+="void main() \n"+"{ \n"+"    czm_shadow_receive_main(); \n"+"    vec4 positionEC = getPositionEC(); \n"+"    vec3 normalEC = getNormalEC(); \n"+"    float depth = -positionEC.z; \n";S+="    czm_shadowParameters shadowParameters; \n"+"    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n"+"    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n"+"    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n"+"    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n";if(a){S+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n"}else if(!f){S+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"}if(h){S+="    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n"+"    float distance = length(directionEC); \n"+"    directionEC = normalize(directionEC); \n"+"    float radius = shadowMap_lightPositionEC.w; \n"+"    // Stop early if the fragment is beyond the point light radius \n"+"    if (distance > radius) \n"+"    { \n"+"        return; \n"+"    } \n"+"    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n"+"    shadowParameters.depth = distance / radius; \n"+"    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n"+"    shadowParameters.texCoords = directionWC; \n"+"    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n"}else if(p){S+="    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n"+"    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n"+"    applyNormalOffset(positionEC, normalEC, nDotL); \n"+"    vec4 shadowPosition = shadowMap_matrix * positionEC; \n"+"    // Spot light uses a perspective projection, so perform the perspective divide \n"+"    shadowPosition /= shadowPosition.w; \n"+"    // Stop early if the fragment is not in the shadow bounds \n"+"    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n"+"    { \n"+"        return; \n"+"    } \n"+"    shadowParameters.texCoords = shadowPosition.xy; \n"+"    shadowParameters.depth = shadowPosition.z; \n"+"    shadowParameters.nDotL = nDotL; \n"+"    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n"}else if(m){S+="    float maxDepth = shadowMap_cascadeSplits[1].w; \n"+"    // Stop early if the eye depth exceeds the last cascade \n"+"    if (depth > maxDepth) \n"+"    { \n"+"        return; \n"+"    } \n"+"    // Get the cascade based on the eye-space depth \n"+"    vec4 weights = czm_cascadeWeights(depth); \n"+"    // Apply normal offset \n"+"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n"+"    applyNormalOffset(positionEC, normalEC, nDotL); \n"+"    // Transform position into the cascade \n"+"    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n"+"    // Get visibility \n"+"    shadowParameters.texCoords = shadowPosition.xy; \n"+"    shadowParameters.depth = shadowPosition.z; \n"+"    shadowParameters.nDotL = nDotL; \n"+"    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n"+"    // Fade out shadows that are far away \n"+"    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n"+"    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n"+"    visibility = mix(visibility, 1.0, fade); \n"+(v?"    // Draw cascade colors for debugging \n"+"    gl_FragColor *= czm_cascadeColor(weights); \n":"")}else{S+="    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n"+"    applyNormalOffset(positionEC, normalEC, nDotL); \n"+"    vec4 shadowPosition = shadowMap_matrix * positionEC; \n"+"    // Stop early if the fragment is not in the shadow bounds \n"+"    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n"+"    { \n"+"        return; \n"+"    } \n"+"    shadowParameters.texCoords = shadowPosition.xy; \n"+"    shadowParameters.depth = shadowPosition.z; \n"+"    shadowParameters.nDotL = nDotL; \n"+"    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n"}S+="    gl_FragColor.rgb *= visibility; \n"+"} \n";b.push(S);return new t({defines:y,sources:b})};return r});define("Scene/ShadowMap",["../Core/BoundingRectangle","../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/combine","../Core/CullingVolume","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/GeometryInstance","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/PixelFormat","../Core/Quaternion","../Core/SphereOutlineGeometry","../Core/WebGLConstants","../Renderer/ClearCommand","../Renderer/ContextLimits","../Renderer/CubeMap","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/Pass","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","./Camera","./CullFace","./DebugCameraPrimitive","./PerInstanceColorAppearance","./Primitive","./ShadowMapShader"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U,V,z,q,G,H,j,W,Y,X,Q){"use strict";function Z(e){e=f(e,f.EMPTY_OBJECT);var r=e.context;if(!h(r)){throw new v("context is required.")}if(!h(e.lightCamera)){throw new v("lightCamera is required.")}if(h(e.numberOfCascades)&&(e.numberOfCascades!==1&&e.numberOfCascades!==4)){throw new v("Only one or four cascades are supported.")}this._enabled=f(e.enabled,true);this._softShadows=f(e.softShadows,false);this._normalOffset=f(e.normalOffset,true);this.dirty=true;this.fromLightSource=f(e.fromLightSource,true);this.darkness=f(e.darkness,.3);this._darkness=this.darkness;this.maximumDistance=f(e.maximumDistance,5e3);this._outOfView=false;this._outOfViewPrevious=false;this._needsUpdate=true;var o=true;if(g.isInternetExplorer()||g.isEdge()||(g.isChrome()||g.isFirefox())&&g.isWindows()&&!r.depthTexture){o=false}this._polygonOffsetSupported=o;this._terrainBias={polygonOffset:o,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:true,normalShadingSmooth:.3,depthBias:1e-4};this._primitiveBias={polygonOffset:o,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:true,normalShadingSmooth:.05,depthBias:2e-5};this._pointBias={polygonOffset:false,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:true,normalShadingSmooth:.1,depthBias:5e-4};this._depthAttachment=undefined;this._colorAttachment=undefined;this._shadowMapMatrix=new w;this._shadowMapTexture=undefined;this._lightDirectionEC=new n;this._lightPositionEC=new a;this._distance=0;this._lightCamera=e.lightCamera;this._shadowMapCamera=new we;this._shadowMapCullingVolume=undefined;this._sceneCamera=undefined;this._boundingSphere=new t;this._isPointLight=f(e.isPointLight,false);this._pointLightRadius=f(e.pointLightRadius,100);this._cascadesEnabled=this._isPointLight?false:f(e.cascadesEnabled,true);this._numberOfCascades=!this._cascadesEnabled?0:f(e.numberOfCascades,4);this._fitNearFar=true;this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE];this._textureSize=new i;this._isSpotLight=false;if(this._cascadesEnabled){this._shadowMapCamera.frustum=new C}else if(h(this._lightCamera.frustum.fov)){this._isSpotLight=true}this._cascadeSplits=[new a,new a];this._cascadeMatrices=[new w,new w,new w,new w];this._cascadeDistances=new a;var s;if(this._isPointLight){s=6}else if(!this._cascadesEnabled){s=1}else{s=this._numberOfCascades}this._passes=new Array(s);for(var u=0;u<s;++u){this._passes[u]=new K(r)}this.debugShow=false;this.debugFreezeFrame=false;this._debugFreezeFrame=false;this._debugCascadeColors=false;this._debugLightFrustum=undefined;this._debugCameraFrustum=undefined;this._debugCascadeFrustums=new Array(this._numberOfCascades);this._debugShadowViewCommand=undefined;this._usesDepthTexture=r.depthTexture;if(this._isPointLight){this._usesDepthTexture=false}this._primitiveRenderState=undefined;this._terrainRenderState=undefined;this._pointRenderState=undefined;$(this);this._clearCommand=new A({depth:1,color:new l});this._clearPassState=new L(r);this._size=f(e.size,2048);this.size=this._size}Z.MAXIMUM_DISTANCE=2e4;function K(e){this.camera=new we;this.passState=new L(e);this.framebuffer=undefined;this.textureOffsets=undefined;this.commandList=[];this.cullingVolume=undefined}function J(e,t){return B.fromCache({cull:{enabled:true,face:j.BACK},depthTest:{enabled:true},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:true,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function $(e){var t=!e._usesDepthTexture;e._primitiveRenderState=J(t,e._primitiveBias);e._terrainRenderState=J(t,e._terrainBias);e._pointRenderState=J(t,e._pointBias)}Z.prototype.debugCreateRenderStates=function(){$(this)};p(Z.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e;this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e;this._normalOffset=e;this._terrainBias.normalOffset=e;this._primitiveBias.normalOffset=e;this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e;this._softShadows=e}},size:{get:function(){return this._size},set:function(e){ue(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e;this._debugCascadeColors=e}}});function ee(e){var t=e._passes.length;for(var r=0;r<t;++r){var i=e._passes[r];var n=i.framebuffer;if(h(n)&&!n.isDestroyed()){n.destroy()}i.framebuffer=undefined}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy();e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function te(){return new U({wrapS:G.CLAMP_TO_EDGE,wrapT:G.CLAMP_TO_EDGE,minificationFilter:q.NEAREST,magnificationFilter:z.NEAREST})}function re(e,t){var r=new k({context:t,width:e._textureSize.x,height:e._textureSize.y,format:F.DEPTH_COMPONENT16});var i=new V({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:T.RGBA,pixelDatatype:N.UNSIGNED_BYTE,sampler:te()});var n=new M({context:t,depthRenderbuffer:r,colorTextures:[i],destroyAttachments:false});var a=e._passes.length;for(var o=0;o<a;++o){var s=e._passes[o];s.framebuffer=n;s.passState.framebuffer=n}e._shadowMapTexture=i;e._depthAttachment=r;e._colorAttachment=i}function ie(e,t){var r=new V({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:T.DEPTH_STENCIL,pixelDatatype:N.UNSIGNED_INT_24_8,sampler:te()});var i=new M({context:t,depthStencilTexture:r,destroyAttachments:false});var n=e._passes.length;for(var a=0;a<n;++a){var o=e._passes[a];o.framebuffer=i;o.passState.framebuffer=i}e._shadowMapTexture=r;e._depthAttachment=r}function ne(e,t){var r=new k({context:t,width:e._textureSize.x,height:e._textureSize.y,format:F.DEPTH_COMPONENT16});var i=new D({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:T.RGBA,pixelDatatype:N.UNSIGNED_BYTE,sampler:te()});var n=[i.negativeX,i.negativeY,i.negativeZ,i.positiveX,i.positiveY,i.positiveZ];for(var a=0;a<6;++a){var o=new M({context:t,depthRenderbuffer:r,colorTextures:[n[a]],destroyAttachments:false});var s=e._passes[a];s.framebuffer=o;s.passState.framebuffer=o}e._shadowMapTexture=i;e._depthAttachment=r;e._colorAttachment=i}function ae(e,t){if(e._isPointLight){ne(e,t)}else if(e._usesDepthTexture){ie(e,t)}else{re(e,t)}}function oe(e,t){if(e._usesDepthTexture&&e._passes[0].framebuffer.status!==P.FRAMEBUFFER_COMPLETE){e._usesDepthTexture=false;$(e);ee(e);ae(e,t)}}function se(e,t){if(!h(e._passes[0].framebuffer)||e._shadowMapTexture.width!==e._textureSize.x){ee(e);ae(e,t);oe(e,t);le(e,t)}}function le(e,t,r){r=f(r,0);if(e._isPointLight||r===0){e._clearCommand.framebuffer=e._passes[r].framebuffer;e._clearCommand.execute(t,e._clearPassState)}}function ue(t,r){t._size=r;var i=t._passes;var n=i.length;var a=t._textureSize;if(t._isPointLight){r=O.maximumCubeMapSize>=r?r:O.maximumCubeMapSize;a.x=r;a.y=r;var o=new e(0,0,r,r);i[0].passState.viewport=o;i[1].passState.viewport=o;i[2].passState.viewport=o;i[3].passState.viewport=o;i[4].passState.viewport=o;i[5].passState.viewport=o}else if(n===1){r=O.maximumTextureSize>=r?r:O.maximumTextureSize;a.x=r;a.y=r;i[0].passState.viewport=new e(0,0,r,r)}else if(n===4){r=O.maximumTextureSize>=r*2?r:O.maximumTextureSize/2;a.x=r*2;a.y=r*2;i[0].passState.viewport=new e(0,0,r,r);i[1].passState.viewport=new e(r,0,r,r);i[2].passState.viewport=new e(0,r,r,r);i[3].passState.viewport=new e(r,r,r,r)}t._clearPassState.viewport=new e(0,0,a.x,a.y);for(var s=0;s<n;++s){var l=i[s];var u=l.passState.viewport;var c=u.x/a.x;var d=u.y/a.y;var f=u.width/a.x;var h=u.height/a.y;l.textureOffsets=new w(f,0,0,c,0,h,0,d,0,0,1,0,0,0,0,1)}}var ce=new e;function de(e,t){var r;if(e._isPointLight){r="uniform samplerCube shadowMap_textureCube; \n"+"varying vec2 v_textureCoordinates; \n"+"void main() \n"+"{ \n"+"    vec2 uv = v_textureCoordinates; \n"+"    vec3 dir; \n"+" \n"+"    if (uv.y < 0.5) \n"+"    { \n"+"        if (uv.x < 0.333) \n"+"        { \n"+"            dir.x = -1.0; \n"+"            dir.y = uv.x * 6.0 - 1.0; \n"+"            dir.z = uv.y * 4.0 - 1.0; \n"+"        } \n"+"        else if (uv.x < 0.666) \n"+"        { \n"+"            dir.y = -1.0; \n"+"            dir.x = uv.x * 6.0 - 3.0; \n"+"            dir.z = uv.y * 4.0 - 1.0; \n"+"        } \n"+"        else \n"+"        { \n"+"            dir.z = -1.0; \n"+"            dir.x = uv.x * 6.0 - 5.0; \n"+"            dir.y = uv.y * 4.0 - 1.0; \n"+"        } \n"+"    } \n"+"    else \n"+"    { \n"+"        if (uv.x < 0.333) \n"+"        { \n"+"            dir.x = 1.0; \n"+"            dir.y = uv.x * 6.0 - 1.0; \n"+"            dir.z = uv.y * 4.0 - 3.0; \n"+"        } \n"+"        else if (uv.x < 0.666) \n"+"        { \n"+"            dir.y = 1.0; \n"+"            dir.x = uv.x * 6.0 - 3.0; \n"+"            dir.z = uv.y * 4.0 - 3.0; \n"+"        } \n"+"        else \n"+"        { \n"+"            dir.z = 1.0; \n"+"            dir.x = uv.x * 6.0 - 5.0; \n"+"            dir.y = uv.y * 4.0 - 3.0; \n"+"        } \n"+"    } \n"+" \n"+"    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n"+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n"+"} \n"}else{r="uniform sampler2D shadowMap_texture; \n"+"varying vec2 v_textureCoordinates; \n"+"void main() \n"+"{ \n"+(e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n"+"} \n"}var i=t.createViewportQuadCommand(r,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});i.pass=R.OVERLAY;return i}function fe(t,r){var i=r.context;var n=r.context.drawingBufferWidth;var a=r.context.drawingBufferHeight;var o=Math.min(n,a)*.3;var s=ce;s.x=n-o;s.y=0;s.width=o;s.height=o;var l=t._debugShadowViewCommand;if(!h(l)){l=de(t,i);t._debugShadowViewCommand=l}if(!h(l.renderState)||!e.equals(l.renderState.viewport,s)){l.renderState=B.fromCache({viewport:e.clone(s)})}r.commandList.push(t._debugShadowViewCommand)}var he=new Array(8);he[0]=new a(-1,-1,-1,1);he[1]=new a(1,-1,-1,1);he[2]=new a(1,1,-1,1);he[3]=new a(-1,1,-1,1);he[4]=new a(-1,-1,1,1);he[5]=new a(1,-1,1,1);he[6]=new a(1,1,1,1);he[7]=new a(-1,1,1,1);var pe=new w;var me=new Array(8);for(var ve=0;ve<8;++ve){me[ve]=new a}function ge(e,t){var i=new _({geometry:new r({minimum:new n(-.5,-.5,-.5),maximum:new n(.5,.5,.5)}),attributes:{color:u.fromColor(t)}});var a=new _({geometry:new x({radius:.5}),attributes:{color:u.fromColor(t)}});return new X({geometryInstances:[i,a],appearance:new Y({translucent:false,flat:true}),asynchronous:false,modelMatrix:e})}var _e=[l.RED,l.GREEN,l.BLUE,l.MAGENTA];var ye=new n;function be(e,t){fe(e,t);var r=e.debugFreezeFrame&&!e._debugFreezeFrame;e._debugFreezeFrame=e.debugFreezeFrame;if(e.debugFreezeFrame){if(r){e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy();e._debugCameraFrustum=new W({camera:e._sceneCamera,color:l.CYAN,updateOnChange:false})}e._debugCameraFrustum.update(t)}if(e._cascadesEnabled){if(e.debugFreezeFrame){if(r){e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy();e._debugLightFrustum=new W({camera:e._shadowMapCamera,color:l.YELLOW,updateOnChange:false})}e._debugLightFrustum.update(t);for(var i=0;i<e._numberOfCascades;++i){if(r){e._debugCascadeFrustums[i]=e._debugCascadeFrustums[i]&&e._debugCascadeFrustums[i].destroy();e._debugCascadeFrustums[i]=new W({camera:e._passes[i].camera,color:_e[i],updateOnChange:false})}e._debugCascadeFrustums[i].update(t)}}}else if(e._isPointLight){if(!h(e._debugLightFrustum)||e._needsUpdate){var a=e._shadowMapCamera.positionWC;var o=E.IDENTITY;var s=e._pointLightRadius*2;var u=n.fromElements(s,s,s,ye);var c=w.fromTranslationQuaternionRotationScale(a,o,u,pe);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy();e._debugLightFrustum=ge(c,l.YELLOW)}e._debugLightFrustum.update(t)}else{if(!h(e._debugLightFrustum)||e._needsUpdate){e._debugLightFrustum=new W({camera:e._shadowMapCamera,color:l.YELLOW,updateOnChange:false})}e._debugLightFrustum.update(t)}}function we(){this.viewMatrix=new w;this.inverseViewMatrix=new w;this.frustum=undefined;this.positionCartographic=new o;this.positionWC=new n;this.directionWC=n.clone(n.UNIT_Z);this.upWC=n.clone(n.UNIT_Y);this.rightWC=n.clone(n.UNIT_X);this.viewProjectionMatrix=new w}we.prototype.clone=function(e){w.clone(e.viewMatrix,this.viewMatrix);w.clone(e.inverseViewMatrix,this.inverseViewMatrix);this.frustum=e.frustum.clone(this.frustum);o.clone(e.positionCartographic,this.positionCartographic);n.clone(e.positionWC,this.positionWC);n.clone(e.directionWC,this.directionWC);n.clone(e.upWC,this.upWC);n.clone(e.rightWC,this.rightWC)};var Ce=new w(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);we.prototype.getViewProjection=function(){var e=this.viewMatrix;var t=this.frustum.projectionMatrix;w.multiply(t,e,this.viewProjectionMatrix);w.multiply(Ce,this.viewProjectionMatrix,this.viewProjectionMatrix);return this.viewProjectionMatrix};var Se=new Array(5);var Te=new S;var Ee=new Array(4);var xe=new n;var Pe=new n;function Ae(e,t){var r=e._shadowMapCamera;var i=e._sceneCamera;var o=i.frustum.near;var s=i.frustum.far;var l=e._numberOfCascades;var u;var c=s-o;var d=s/o;var f=.9;var h=false;if(t.shadowHints.closestObjectSize<200){h=true;f=.9}var p=Ee;var m=Se;m[0]=o;m[l]=s;for(u=0;u<l;++u){var v=(u+1)/l;var g=o*Math.pow(d,v);var _=o+c*v;var y=b.lerp(_,g,f);m[u+1]=y;p[u]=y-m[u]}if(h){for(u=0;u<l;++u){p[u]=Math.min(p[u],e._maximumCascadeDistances[u])}var C=m[0];for(u=0;u<l-1;++u){C+=p[u];m[u+1]=C}}a.unpack(m,0,e._cascadeSplits[0]);a.unpack(m,1,e._cascadeSplits[1]);a.unpack(p,0,e._cascadeDistances);var S=r.frustum;var T=S.left;var E=S.right;var x=S.bottom;var P=S.top;var A=S.near;var O=S.far;var D=r.positionWC;var I=r.directionWC;var M=r.upWC;var R=i.frustum.clone(Te);var L=r.getViewProjection();for(u=0;u<l;++u){R.near=m[u];R.far=m[u+1];var N=w.multiply(R.projectionMatrix,i.viewMatrix,pe);var k=w.inverse(N,pe);var F=w.multiply(L,k,pe);var B=n.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,xe);var U=n.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Pe);for(var V=0;V<8;++V){var z=a.clone(he[V],me[V]);w.multiplyByVector(F,z,z);n.divideByScalar(z,z.w,z);n.minimumByComponent(z,B,B);n.maximumByComponent(z,U,U)}B.x=Math.max(B.x,0);B.y=Math.max(B.y,0);B.z=0;U.x=Math.min(U.x,1);U.y=Math.min(U.y,1);U.z=Math.min(U.z,1);var q=e._passes[u];var G=q.camera;G.clone(r);var H=G.frustum;H.left=T+B.x*(E-T);H.right=T+U.x*(E-T);H.bottom=x+B.y*(P-x);H.top=x+U.y*(P-x);H.near=A+B.z*(O-A);H.far=A+U.z*(O-A);q.cullingVolume=G.frustum.computeCullingVolume(D,I,M);var j=e._cascadeMatrices[u];w.multiply(G.getViewProjection(),i.inverseViewMatrix,j);w.multiply(q.textureOffsets,j,j)}}var Oe=new w;var De=new n;var Ie=new n;var Me=new n;function Re(e,t){var r=e._shadowMapCamera;var i=e._sceneCamera;var o=w.multiply(i.frustum.projectionMatrix,i.viewMatrix,pe);var s=w.inverse(o,pe);var l=r.directionWC;var u=i.directionWC;var c=n.cross(l,u,De);u=n.cross(c,l,Ie);n.normalize(u,u);n.normalize(c,c);var d=n.fromElements(0,0,0,Me);var f=w.computeView(d,l,u,c,Oe);var h=w.multiply(f,s,pe);var p=n.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,xe);var m=n.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Pe);for(var v=0;v<8;++v){var g=a.clone(he[v],me[v]);w.multiplyByVector(h,g,g);n.divideByScalar(g,g.w,g);n.minimumByComponent(g,p,p);n.maximumByComponent(g,m,m)}m.z+=1e3;p.z-=10;var _=Me;_.x=-(.5*(p.x+m.x));_.y=-(.5*(p.y+m.y));_.z=-m.z;var y=w.fromTranslation(_,pe);f=w.multiply(y,f,f);var b=.5*(m.x-p.x);var C=.5*(m.y-p.y);var S=m.z-p.z;var T=r.frustum;T.left=-b;T.right=b;T.bottom=-C;T.top=C;T.near=.01;T.far=S;w.clone(f,r.viewMatrix);w.inverse(f,r.inverseViewMatrix);w.getTranslation(r.inverseViewMatrix,r.positionWC);t.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic);n.clone(l,r.directionWC);n.clone(u,r.upWC);n.clone(c,r.rightWC)}var Le=[new n(-1,0,0),new n(0,-1,0),new n(0,0,-1),new n(1,0,0),new n(0,1,0),new n(0,0,1)];var Ne=[new n(0,-1,0),new n(0,0,-1),new n(0,-1,0),new n(0,-1,0),new n(0,0,1),new n(0,-1,0)];var ke=[new n(0,0,1),new n(1,0,0),new n(-1,0,0),new n(0,0,-1),new n(1,0,0),new n(1,0,0)];function Fe(e,t){var r=new S;r.fov=b.PI_OVER_TWO;r.near=1;r.far=e._pointLightRadius;r.aspectRatio=1;for(var i=0;i<6;++i){var n=e._passes[i].camera;n.positionWC=e._shadowMapCamera.positionWC;n.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(n.positionWC,n.positionCartographic);n.directionWC=Le[i];n.upWC=Ne[i];n.rightWC=ke[i];w.computeView(n.positionWC,n.directionWC,n.upWC,n.rightWC,n.viewMatrix);w.inverse(n.viewMatrix,n.inverseViewMatrix);n.frustum=r}}var Be=new n;var Ue=new n;var Ve=new t;var ze=Ve.center;function qe(e,r){var i=e._sceneCamera;var a=e._shadowMapCamera;var o=Ve;if(e._cascadesEnabled){if(i.frustum.near>=e.maximumDistance){e._outOfView=true;e._needsUpdate=false;return}var s=r.mapProjection.ellipsoid.geodeticSurfaceNormal(i.positionWC,Be);var l=n.negate(a.directionWC,Ue);var u=n.dot(s,l);var c=b.clamp(u/.1,0,1);e._darkness=b.lerp(1,e.darkness,c);if(u<0){e._outOfView=true;e._needsUpdate=false;return}e._needsUpdate=true;e._outOfView=false}else if(e._isPointLight){o.center=a.positionWC;o.radius=e._pointLightRadius;e._outOfView=r.cullingVolume.computeVisibility(o)===y.OUTSIDE;e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(o);t.clone(o,e._boundingSphere)}else{var d=a.frustum.far/2;var f=n.add(a.positionWC,n.multiplyByScalar(a.directionWC,d,ze),ze);o.center=f;o.radius=d;e._outOfView=r.cullingVolume.computeVisibility(o)===y.OUTSIDE;e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(o);t.clone(o,e._boundingSphere)}}function Ge(e,t){var r=t.camera;var i=e._lightCamera;var a=e._sceneCamera;var o=e._shadowMapCamera;if(e._cascadesEnabled){n.clone(i.directionWC,o.directionWC)}else if(e._isPointLight){n.clone(i.positionWC,o.positionWC)}else{o.clone(i)}var s=e._lightDirectionEC;w.multiplyByPointAsVector(r.viewMatrix,o.directionWC,s);n.normalize(s,s);n.negate(s,s);w.multiplyByPoint(r.viewMatrix,o.positionWC,e._lightPositionEC);e._lightPositionEC.w=e._pointLightRadius;var l;var u;if(e._fitNearFar){l=Math.min(t.shadowHints.nearPlane,e.maximumDistance);u=Math.min(t.shadowHints.farPlane,e.maximumDistance+1)}else{l=r.frustum.near;u=e.maximumDistance}e._sceneCamera=H.clone(r,a);r.frustum.clone(e._sceneCamera.frustum);e._sceneCamera.frustum.near=l;e._sceneCamera.frustum.far=u;e._distance=u-l;qe(e,t);if(!e._outOfViewPrevious&&e._outOfView){e._needsUpdate=true}e._outOfViewPrevious=e._outOfView}Z.prototype.update=function(e){Ge(this,e);if(this._needsUpdate){se(this,e.context);if(this._isPointLight){Fe(this,e)}if(this._cascadesEnabled){Re(this,e);if(this._numberOfCascades>1){Ae(this,e)}}if(!this._isPointLight){var t=this._shadowMapCamera;var r=t.positionWC;var i=t.directionWC;var n=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(r,i,n);if(this._passes.length===1){this._passes[0].camera.clone(t)}}else{this._shadowMapCullingVolume=d.fromBoundingSphere(this._boundingSphere)}}if(this._passes.length===1){var a=this._sceneCamera.inverseViewMatrix;w.multiply(this._shadowMapCamera.getViewProjection(),a,this._shadowMapMatrix)}if(this.debugShow){be(this,e)}};Z.prototype.updatePass=function(e,t){le(this,e,t)};var He=new i;function je(e,t,r){var i=e._isPointLight?e._pointBias:r?e._terrainBias:e._primitiveBias;var n={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var t=He;t.x=1/e._textureSize.x;t.y=1/e._textureSize.y;return a.fromElements(t.x,t.y,i.depthBias,i.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return a.fromElements(i.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new a,combinedUniforms2:new a};return c(t,n,false)}function We(e,t,r,i,n,a){var o;var l;var u;if(h(a)){o=a.shaderProgram;l=a.renderState;u=a.uniformMap}a=I.shallowClone(r,a);a.castShadows=true;a.receiveShadows=false;if(!h(o)||n!==r.shaderProgram.id||t){var c=r.shaderProgram;var d=r.pass===R.GLOBE;var f=r.pass!==R.TRANSLUCENT;var p=e._isPointLight;var m=e._usesDepthTexture;var v=Q.getShadowCastShaderKeyword(p,d,m,f);o=i.shaderCache.getDerivedShaderProgram(c,v);if(!h(o)){var g=c.vertexShaderSource;var _=c.fragmentShaderSource;var y=Q.createShadowCastVertexShader(g,p,d);var b=Q.createShadowCastFragmentShader(_,p,m,f);o=i.shaderCache.createDerivedShaderProgram(c,v,{vertexShaderSource:y,fragmentShaderSource:b,attributeLocations:c._attributeLocations})}l=e._primitiveRenderState;if(p){l=e._pointRenderState}else if(d){l=e._terrainRenderState}var w=r.renderState.cull.enabled;if(!w){l=s(l,false);l.cull.enabled=false;l=B.fromCache(l)}u=je(e,r.uniformMap,d)}a.shaderProgram=o;a.renderState=l;a.uniformMap=u;return a}Z.createDerivedCommands=function(e,t,r,i,n,a){if(!h(a)){a={}}var o=t.length>0;var s=r.shaderProgram;var l=s.vertexShaderSource;var u=s.fragmentShaderSource;var c=r.pass===R.GLOBE;var d=false;if(c){d=r.owner.data.pickTerrain.mesh.encoding.hasVertexNormals}if(r.castShadows){var f=a.castCommands;if(!h(f)){f=a.castCommands=[]}var p=a.castShaderProgramId;var m=e.length;f.length=m;for(var v=0;v<m;++v){f[v]=We(e[v],i,r,n,p,f[v])}a.castShaderProgramId=r.shaderProgram.id}if(r.receiveShadows&&o){var g;var _;if(h(a.receiveCommand)){g=a.receiveCommand.shaderProgram;_=a.receiveCommand.uniformMap}a.receiveCommand=I.shallowClone(r,a.receiveCommand);a.castShadows=false;a.receiveShadows=true;var y=a.receiveShaderCastShadows!==r.castShadows;var b=a.receiveShaderProgramId!==r.shaderProgram.id;if(!h(g)||b||i||y){var w=Q.getShadowReceiveShaderKeyword(t[0],r.castShadows,c,d);g=n.shaderCache.getDerivedShaderProgram(s,w);if(!h(g)){var C=Q.createShadowReceiveVertexShader(l,c,d);var S=Q.createShadowReceiveFragmentShader(u,t[0],r.castShadows,c,d);g=n.shaderCache.createDerivedShaderProgram(s,w,{vertexShaderSource:C,fragmentShaderSource:S,attributeLocations:s._attributeLocations})}_=je(t[0],r.uniformMap,c)}a.receiveCommand.shaderProgram=g;a.receiveCommand.uniformMap=_;a.receiveShaderProgramId=r.shaderProgram.id;a.receiveShaderCastShadows=r.castShadows}return a};Z.prototype.isDestroyed=function(){return false};Z.prototype.destroy=function(){ee(this);this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy();this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy();this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e){this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy()}return m(this)};return Z});define("Shaders/PostProcessFilters/AdditiveBlend",[],function(){"use strict";return"uniform sampler2D u_texture0;\nuniform sampler2D u_texture1;\n\nuniform vec2 u_center;\nuniform float u_radius;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 color0 = texture2D(u_texture0, v_textureCoordinates);\n    vec4 color1 = texture2D(u_texture1, v_textureCoordinates);\n    \n    float x = length(gl_FragCoord.xy - u_center) / u_radius;\n    float t = smoothstep(0.5, 0.8, x);\n    gl_FragColor = mix(color0 + color1, color0, t);\n}\n"});define("Shaders/PostProcessFilters/BrightPass",[],function(){"use strict";return'uniform sampler2D u_texture;\n\nuniform float u_avgLuminance;\nuniform float u_threshold;\nuniform float u_offset;\n\nvarying vec2 v_textureCoordinates;\n\nfloat key(float avg)\n{\n    float guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));\n    return max(0.0, guess) + 0.1;\n}\n\n// See section 9. "The bright-pass filter" of Realtime HDR Rendering\n// http://www.cg.tuwien.ac.at/research/publications/2007/Luksch_2007_RHR/Luksch_2007_RHR-RealtimeHDR%20.pdf\n\nvoid main()\n{\n    vec4 color = texture2D(u_texture, v_textureCoordinates);\n    vec3 xyz = czm_RGBToXYZ(color.rgb);\n    float luminance = xyz.r;\n    \n    float scaledLum = key(u_avgLuminance) * luminance / u_avgLuminance;\n    float brightLum = max(scaledLum - u_threshold, 0.0);\n    float brightness = brightLum / (u_offset + brightLum);\n    \n    xyz.r = brightness;\n    gl_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);\n}\n'});define("Shaders/PostProcessFilters/GaussianBlur1D",[],function(){"use strict";return"#define SAMPLES 8\n\nuniform float delta;\nuniform float sigma;\nuniform float direction; // 0.0 for x direction, 1.0 for y direction\n\nuniform sampler2D u_texture;\nuniform vec2 u_step;\n\nvarying vec2 v_textureCoordinates;\n\n//  Incremental Computation of the Gaussian:\n//  http://http.developer.nvidia.com/GPUGems3/gpugems3_ch40.html\n\nvoid main()\n{\n    vec2 st = v_textureCoordinates;\n    \n    vec2 dir = vec2(1.0 - direction, direction);\n    \n    vec3 g;\n    g.x = 1.0 / (sqrt(czm_twoPi) * sigma);\n    g.y = exp((-0.5 * delta * delta) / (sigma * sigma));\n    g.z = g.y * g.y;\n    \n    vec4 result = texture2D(u_texture, st) * g.x;\n    for (int i = 1; i < SAMPLES; ++i)\n    {\n        g.xy *= g.yz;\n        \n        vec2 offset = float(i) * dir * u_step;\n        result += texture2D(u_texture, st - offset) * g.x;\n        result += texture2D(u_texture, st + offset) * g.x;\n    }\n    \n    gl_FragColor = result;\n}\n"});define("Scene/SunPostProcess",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian4","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/Transforms","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/AdditiveBlend","../Shaders/PostProcessFilters/BrightPass","../Shaders/PostProcessFilters/GaussianBlur1D","../Shaders/PostProcessFilters/PassThrough"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C){"use strict";function S(){this._fbo=undefined;this._downSampleFBO1=undefined;this._downSampleFBO2=undefined;this._clearFBO1Command=undefined;this._clearFBO2Command=undefined;this._downSampleCommand=undefined;this._brightPassCommand=undefined;this._blurXCommand=undefined;this._blurYCommand=undefined;this._blendCommand=undefined;this._fullScreenCommand=undefined;this._downSamplePassState=new h;this._downSamplePassState.scissorTest={enable:true,rectangle:new e};this._upSamplePassState=new h;this._upSamplePassState.scissorTest={enabled:true,rectangle:new e};this._uCenter=new t;this._uRadius=undefined;this._blurStep=new t}S.prototype.clear=function(e,t){var r=this._clearFBO1Command;i.clone(n(t,i.BLACK),r.color);r.execute(e);r=this._clearFBO2Command;i.clone(n(t,i.BLACK),r.color);r.execute(e)};S.prototype.execute=function(e,t){this._downSampleCommand.execute(e,this._downSamplePassState);this._brightPassCommand.execute(e,this._downSamplePassState);this._blurXCommand.execute(e,this._downSamplePassState);this._blurYCommand.execute(e,this._downSamplePassState);this._fullScreenCommand.framebuffer=t;this._blendCommand.framebuffer=t;this._fullScreenCommand.execute(e);this._blendCommand.execute(e,this._upSamplePassState)};var T=new e;var E=new e;var x=new r;var P=new t;var A=new t;var O=new l;S.prototype.update=function(e){var r=e.context;var n=e.viewport;var o=r.drawingBufferWidth;var h=r.drawingBufferHeight;var S=this;if(!a(this._downSampleCommand)){this._clearFBO1Command=new d({color:new i});this._clearFBO2Command=new d({color:new i});var D={};this._downSampleCommand=r.createViewportQuadCommand(C,{uniformMap:D,owner:this});D={u_avgLuminance:function(){return.5},u_threshold:function(){return.25},u_offset:function(){return.1}};this._brightPassCommand=r.createViewportQuadCommand(b,{uniformMap:D,owner:this});var I=1;var M=2;D={delta:function(){return I},sigma:function(){return M},direction:function(){return 0}};this._blurXCommand=r.createViewportQuadCommand(w,{uniformMap:D,owner:this});D={delta:function(){return I},sigma:function(){return M},direction:function(){return 1}};this._blurYCommand=r.createViewportQuadCommand(w,{uniformMap:D,owner:this});D={u_center:function(){return S._uCenter},u_radius:function(){return S._uRadius}};this._blendCommand=r.createViewportQuadCommand(y,{uniformMap:D,owner:this});D={};this._fullScreenCommand=r.createViewportQuadCommand(C,{uniformMap:D,owner:this})}var R=Math.pow(2,Math.ceil(Math.log(o)/Math.log(2))-2);var L=Math.pow(2,Math.ceil(Math.log(h)/Math.log(2))-2);var N=Math.max(1,R,L);var k=E;k.width=N;k.height=N;var F=this._fbo;var B=a(F)&&F.getColorTexture(0)||undefined;if(!a(B)||B.width!==o||B.height!==h){F=F&&F.destroy();this._downSampleFBO1=this._downSampleFBO1&&this._downSampleFBO1.destroy();this._downSampleFBO2=this._downSampleFBO2&&this._downSampleFBO2.destroy();this._blurStep.x=this._blurStep.y=1/N;var U=[new _({context:r,width:o,height:h})];if(r.depthTexture){F=this._fbo=new f({context:r,colorTextures:U,depthTexture:new _({context:r,width:o,height:h,pixelFormat:u.DEPTH_COMPONENT,pixelDatatype:p.UNSIGNED_SHORT})})}else{F=this._fbo=new f({context:r,colorTextures:U,depthRenderbuffer:new m({context:r,format:v.DEPTH_COMPONENT16})})}this._downSampleFBO1=new f({context:r,colorTextures:[new _({context:r,width:N,height:N})]});this._downSampleFBO2=new f({context:r,colorTextures:[new _({context:r,width:N,height:N})]});this._clearFBO1Command.framebuffer=this._downSampleFBO1;this._clearFBO2Command.framebuffer=this._downSampleFBO2;this._downSampleCommand.framebuffer=this._downSampleFBO1;this._brightPassCommand.framebuffer=this._downSampleFBO2;this._blurXCommand.framebuffer=this._downSampleFBO1;this._blurYCommand.framebuffer=this._downSampleFBO2;var V=g.fromCache({viewport:k});this._downSampleCommand.uniformMap.u_texture=function(){return F.getColorTexture(0)};this._downSampleCommand.renderState=V;this._brightPassCommand.uniformMap.u_texture=function(){return S._downSampleFBO1.getColorTexture(0)};this._brightPassCommand.renderState=V;this._blurXCommand.uniformMap.u_texture=function(){return S._downSampleFBO2.getColorTexture(0)};this._blurXCommand.uniformMap.u_step=function(){return S._blurStep};this._blurXCommand.renderState=V;this._blurYCommand.uniformMap.u_texture=function(){return S._downSampleFBO1.getColorTexture(0)};this._blurYCommand.uniformMap.u_step=function(){return S._blurStep};this._blurYCommand.renderState=V;var z=T;z.width=o;z.height=h;var q=g.fromCache({viewport:z});this._blendCommand.uniformMap.u_texture0=function(){return F.getColorTexture(0)};this._blendCommand.uniformMap.u_texture1=function(){return S._downSampleFBO2.getColorTexture(0)};this._blendCommand.renderState=q;this._fullScreenCommand.uniformMap.u_texture=function(){return F.getColorTexture(0)};this._fullScreenCommand.renderState=q}var G=r.uniformState;var H=G.sunPositionWC;var j=G.view;var W=G.viewProjection;var Y=G.projection;var X=l.computeViewportTransformation(n,0,1,O);var Q=l.multiplyByPoint(j,H,x);var Z=c.pointToGLWindowCoordinates(W,X,H,P);Q.x+=s.SOLAR_RADIUS;var K=c.pointToGLWindowCoordinates(Y,X,Q,Q);var J=t.magnitude(t.subtract(K,Z,K))*30*2;var $=A;$.x=J;$.y=J;var ee=this._upSamplePassState.scissorTest.rectangle;ee.x=Math.max(Z.x-$.x*.5,0);ee.y=Math.max(Z.y-$.y*.5,0);ee.width=Math.min($.x,o);ee.height=Math.min($.y,h);this._uCenter=t.clone(Z,this._uCenter);this._uRadius=Math.max($.x,$.y)*.15;X=l.computeViewportTransformation(k,0,1,O);Z=c.pointToGLWindowCoordinates(W,X,H,P);$.x*=R/o;$.y*=L/h;ee=this._downSamplePassState.scissorTest.rectangle;ee.x=Math.max(Z.x-$.x*.5,0);ee.y=Math.max(Z.y-$.y*.5,0);ee.width=Math.min($.x,o);ee.height=Math.min($.y,h);this._downSamplePassState.context=r;this._upSamplePassState.context=r;return this._fbo};S.prototype.isDestroyed=function(){return false};S.prototype.destroy=function(){this._fbo=this._fbo&&this._fbo.destroy();this._downSampleFBO1=this._downSampleFBO1&&this._downSampleFBO1.destroy();this._downSampleFBO2=this._downSampleFBO2&&this._downSampleFBO2.destroy();this._downSampleCommand=this._downSampleCommand&&this._downSampleCommand.shaderProgram&&this._downSampleCommand.shaderProgram.destroy();this._brightPassCommand=this._brightPassCommand&&this._brightPassCommand.shaderProgram&&this._brightPassCommand.shaderProgram.destroy();this._blurXCommand=this._blurXCommand&&this._blurXCommand.shaderProgram&&this._blurXCommand.shaderProgram.destroy();this._blurYCommand=this._blurYCommand&&this._blurYCommand.shaderProgram&&this._blurYCommand.shaderProgram.destroy();this._blendCommand=this._blendCommand&&this._blendCommand.shaderProgram&&this._blendCommand.shaderProgram.destroy();this._fullScreenCommand=this._fullScreenCommand&&this._fullScreenCommand.shaderProgram&&this._fullScreenCommand.shaderProgram.destroy();return o(this)};return S});define("Scene/Scene",["../Core/BoundingRectangle","../Core/BoundingSphere","../Core/BoxGeometry","../Core/buildModuleUrl","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/createGuid","../Core/CullingVolume","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EllipsoidGeometry","../Core/Event","../Core/GeographicProjection","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/getTimestamp","../Core/Intersect","../Core/Interval","../Core/JulianDate","../Core/Math","../Core/Matrix4","../Core/mergeSort","../Core/Occluder","../Core/OrthographicFrustum","../Core/OrthographicOffCenterFrustum","../Core/PerspectiveFrustum","../Core/PerspectiveOffCenterFrustum","../Core/PixelFormat","../Core/RequestScheduler","../Core/ShowGeometryInstanceAttribute","../Core/Transforms","../Renderer/ClearCommand","../Renderer/ComputeEngine","../Renderer/Context","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/loadCubeMap","../Renderer/Pass","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","./BrdfLutGenerator","./Camera","./CreditDisplay","./DebugCameraPrimitive","./DepthPlane","./DeviceOrientationCameraController","./Fog","./FrameState","./FrustumCommands","./FXAA","./GlobeDepth","./JobScheduler","./MapMode2D","./OIT","./PerformanceDisplay","./PerInstanceColorAppearance","./PickDepth","./Primitive","./PrimitiveCollection","./SceneMode","./SceneTransforms","./SceneTransitioner","./ScreenSpaceCameraController","./ShadowMap","./SunPostProcess","./TweenCollection"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U,V,z,q,G,H,j,W,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,ae,oe,se,le,ue,ce,de,fe,he,pe,me,ve,ge,_e,ye,be,we,Ce,Se,Te){"use strict";function Ee(t){t=f(t,f.EMPTY_OBJECT);var r=t.canvas;var i=t.contextOptions;var n=t.creditContainer;if(!h(r)){throw new v("options and options.canvas are required.")}var a=new V(r,i);if(!h(n)){n=document.createElement("div");n.style.position="absolute";n.style.bottom="0";n.style["text-shadow"]="0 0 2px #000000";n.style.color="#ffffff";n.style["font-size"]="10px";n.style["padding-right"]="5px";r.parentNode.appendChild(n)}this._id=c();this._jobScheduler=new ce;this._frameState=new oe(a,new te(n),this._jobScheduler);this._frameState.scene3DOnly=f(t.scene3DOnly,false);var o=new W(a);o.viewport=new e;o.viewport.x=0;o.viewport.y=0;o.viewport.width=a.drawingBufferWidth;o.viewport.height=a.drawingBufferHeight;this._passState=o;this._canvas=r;this._context=a;this._computeEngine=new U(a);this._globe=undefined;this._primitives=new ge;this._groundPrimitives=new ge;this._tweens=new Te;this._shaderFrameCount=0;this._sunPostProcess=undefined;this._computeCommandList=[];this._frustumCommandsList=[];this._overlayCommandList=[];this._pickFramebuffer=undefined;this._useOIT=f(t.orderIndependentTranslucency,true);this._executeOITFunction=undefined;var s;if(a.depthTexture){s=new ue}var u;if(this._useOIT&&h(s)){u=new fe(a)}this._globeDepth=s;this._depthPlane=new ie;this._oit=u;this._fxaa=new le;this._clearColorCommand=new B({color:new l,stencil:0,owner:this});this._depthClearCommand=new B({depth:1,owner:this});this._stencilClearCommand=new B({stencil:0});this._pickDepths=[];this._debugGlobeDepths=[];this._pickDepthPassState=undefined;this._pickDepthFramebuffer=undefined;this._pickDepthFramebufferWidth=undefined;this._pickDepthFramebufferHeight=undefined;this._depthOnlyRenderStateCache={};this._transitioner=new be(this);this._renderError=new _;this._preRender=new _;this._postRender=new _;this._cameraStartFired=false;this._cameraMovedTime=undefined;this._pickPositionCache={};this._pickPositionCacheDirty=false;this._minimumDisableDepthTestDistance=0;this.rethrowRenderErrors=false;this.completeMorphOnUserInput=true;this.morphStart=new _;this.morphComplete=new _;this.skyBox=undefined;this.skyAtmosphere=undefined;this.sun=undefined;this.sunBloom=true;this._sunBloom=undefined;this.moon=undefined;this.backgroundColor=l.clone(l.BLACK);this._mode=_e.SCENE3D;this._mapProjection=h(t.mapProjection)?t.mapProjection:new y;this.morphTime=1;this.farToNearRatio=1e3;this.nearToFarDistance2D=175e4;this.debugCommandFilter=undefined;this.debugShowCommands=false;this.debugShowFrustums=false;this._debugFrustumStatistics=undefined;this.debugShowFramesPerSecond=false;this.debugShowGlobeDepth=false;this.debugShowDepthFrustum=1;this.debugShowFrustumPlanes=false;this._debugShowFrustumPlanes=false;this._debugFrustumPlanes=undefined;this.fxaa=true;this.useDepthPicking=true;this.pickTranslucentDepth=false;this.cameraEventWaitTime=500;this.copyGlobeDepth=false;this.fog=new ae;this._sunCamera=new ee(this);this.shadowMap=new Ce({context:a,lightCamera:this._sunCamera,enabled:f(t.shadows,false)});this._brdfLutGenerator=new $;this._terrainExaggeration=f(t.terrainExaggeration,1);this._performanceDisplay=undefined;this._debugVolume=undefined;var d=new ee(this);this._camera=d;this._cameraClone=ee.clone(d);this._screenSpaceCameraController=new we(this);this._mapMode2D=f(t.mapMode2D,de.INFINITE_SCROLL);this._environmentState={skyBoxCommand:undefined,skyAtmosphereCommand:undefined,sunDrawCommand:undefined,sunComputeCommand:undefined,moonCommand:undefined,isSunVisible:false,isMoonVisible:false,isReadyForAtmosphere:false,isSkyAtmosphereVisible:false,clearGlobeDepth:false,useDepthPlane:false,originalFramebuffer:undefined,useGlobeDepthFramebuffer:false,useOIT:false,useFXAA:false};this._useWebVR=false;this._cameraVR=undefined;this._aspectRatioVR=undefined;var p=d.frustum.near;var m=d.frustum.far;var g=Math.ceil(Math.log(m/p)/Math.log(this.farToNearRatio));Fe(p,m,this.farToNearRatio,g,this._frustumCommandsList,false,undefined);ke(this,0,E.now());this.initializeFrame()}var xe=.9999;p(Ee.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return z.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return z.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy();this._globe=e}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._camera}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},frameState:{get:function(){return this._frameState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if(!h(this.globe)){return undefined}return this.globe.imageryLayers}},terrainProvider:{get:function(){if(!h(this.globe)){return undefined}return this.globe.terrainProvider},set:function(e){if(h(this.globe)){this.globe.terrainProvider=e}}},terrainProviderChanged:{get:function(){if(!h(this.globe)){return undefined}return this.globe.terrainProviderChanged}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return h(this._oit)}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){if(this.scene3DOnly&&e!==_e.SCENE3D){throw new v("Only SceneMode.SCENE3D is valid when scene3DOnly is true.")}if(e===_e.SCENE2D){this.morphTo2D(0)}else if(e===_e.SCENE3D){this.morphTo3D(0)}else if(e===_e.COLUMBUS_VIEW){this.morphToColumbusView(0)}else{throw new v("value must be a valid SceneMode enumeration.")}this._mode=e}},numberOfFrustums:{get:function(){return this._frustumCommandsList.length}},terrainExaggeration:{get:function(){return this._terrainExaggeration}},useWebVR:{get:function(){return this._useWebVR},set:function(e){if(this.camera.frustum instanceof D){throw new v("VR is unsupported with an orthographic projection.")}this._useWebVR=e;if(this._useWebVR){this._frameState.creditDisplay.container.style.visibility="hidden";this._cameraVR=new ee(this);if(!h(this._deviceOrientationCameraController)){this._deviceOrientationCameraController=new ne(this)}this._aspectRatioVR=this._camera.frustum.aspectRatio}else{this._frameState.creditDisplay.container.style.visibility="visible";this._cameraVR=undefined;this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy();this._camera.frustum.aspectRatio=this._aspectRatioVR;this._camera.frustum.xOffset=0}}},mapMode2D:{get:function(){return this._mapMode2D}},imagerySplitPosition:{get:function(){return this._frameState.imagerySplitPosition},set:function(e){this._frameState.imagerySplitPosition=e}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(e){if(!h(e)||e<0){throw new v("minimumDisableDepthTestDistance must be greater than or equal to 0.0.")}this._minimumDisableDepthTestDistance=e}}});Ee.prototype.getCompressedTextureFormatSupported=function(e){var t=this.context;return(e==="WEBGL_compressed_texture_s3tc"||e==="s3tc")&&t.s3tc||(e==="WEBGL_compressed_texture_pvrtc"||e==="pvrtc")&&t.pvrtc||(e==="WEBGL_compressed_texture_etc1"||e==="etc1")&&t.etc1};var Pe=new a;var Ae=new a;function Oe(e,t){var r=Math.max(Math.abs(e.x),Math.abs(t.x));var i=Math.max(Math.abs(e.y),Math.abs(t.y));var n=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.max(Math.max(r,i),n)}function De(e,t,r){var i=1/Math.max(1,Oe(e.position,t.position));a.multiplyByScalar(e.position,i,Pe);a.multiplyByScalar(t.position,i,Ae);return a.equalsEpsilon(Pe,Ae,r)&&a.equalsEpsilon(e.direction,t.direction,r)&&a.equalsEpsilon(e.up,t.up,r)&&a.equalsEpsilon(e.right,t.right,r)&&P.equalsEpsilon(e.transform,t.transform,r)}function Ie(e,t){var r=e.frameState;var i=e._context;var n=r.shadowHints.shadowsEnabled;var a=r.shadowHints.shadowMaps;var o=r.shadowHints.lightShadowMaps;var s=n&&o.length>0;var l=false;var u=r.shadowHints.lastDirtyTime;if(t.lastDirtyTime!==u){t.lastDirtyTime=u;t.dirty=true;l=true}var c=t.derivedCommands;if(t.dirty&&h(c)){t.dirty=false;if(n&&(t.receiveShadows||t.castShadows)){c.shadows=Ce.createDerivedCommands(a,o,t,l,i,c.shadows)}var d=e._oit;if(t.pass===j.TRANSLUCENT&&h(d)&&d.isSupported()){if(s&&t.receiveShadows){c.oit=h(c.oit)?c.oit:{};c.oit.shadows=d.createDerivedCommands(t.derivedCommands.shadows.receiveCommand,i,c.oit.shadows)}else{c.oit=d.createDerivedCommands(t,i,c.oit)}}c.depth=jt(e,t,i,c.depth)}}var Me=new t;var Re;function Le(e){var t=e.globe;if(e._mode===_e.SCENE3D&&h(t)){var r=t.ellipsoid;Me.radius=r.minimumRadius;Re=O.fromBoundingSphere(Me,e._camera.positionWC,Re);return Re}return undefined}function Ne(e){e.render=false;e.pick=false;e.depth=false}function ke(e,t,r){var i=e._camera;var n=e._frameState;n.commandList.length=0;n.shadowMaps.length=0;n.brdfLutGenerator=e._brdfLutGenerator;n.environmentMap=e.skyBox&&e.skyBox._cubeMap;n.mode=e._mode;n.morphTime=e.morphTime;n.mapProjection=e.mapProjection;n.frameNumber=t;n.time=E.clone(r,n.time);n.camera=i;n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC);n.occluder=Le(e);n.terrainExaggeration=e._terrainExaggeration;n.minimumDisableDepthTestDistance=e._minimumDisableDepthTestDistance;if(h(e.globe)){n.maximumScreenSpaceError=e.globe.maximumScreenSpaceError}else{n.maximumScreenSpaceError=2}Ne(n.passes)}function Fe(e,t,r,i,n,a,o){n.length=i;for(var s=0;s<i;++s){var l;var u;if(!a){l=Math.max(e,Math.pow(r,s)*e);u=Math.min(t,r*l)}else{l=Math.min(t-o,e+s*o);u=Math.min(t,l+o)}var c=n[s];if(!h(c)){c=n[s]=new se(l,u)}else{c.near=l;c.far=u}}}function Be(e,t,r){if(e.debugShowFrustums){t.debugOverlappingFrustums=0}if(!e.frameState.passes.pick){Ie(e,t)}var i=e._frustumCommandsList;var n=i.length;for(var a=0;a<n;++a){var o=i[a];var s=o.near;var l=o.far;if(r.start>l){continue}if(r.stop<s){break}var u=t.pass;var c=o.indices[u]++;o.commands[u][c]=t;if(e.debugShowFrustums){t.debugOverlappingFrustums|=1<<a}if(t.executeInClosestFrustum){break}}if(e.debugShowFrustums){var d=e._debugFrustumStatistics.commandsInFrustums;d[t.debugOverlappingFrustums]=h(d[t.debugOverlappingFrustums])?d[t.debugOverlappingFrustums]+1:1;++e._debugFrustumStatistics.totalCommands}}var Ue=new d;var Ve=new T;function ze(e,t,r){return h(e)&&(!h(e.boundingVolume)||!e.cull||t.computeVisibility(e.boundingVolume)!==S.OUTSIDE&&(!h(r)||!e.boundingVolume.isOccluded(r)))}function qe(e){var t=e._frameState;var r=t.camera;var i=r.directionWC;var n=r.positionWC;var a=e._computeCommandList;var o=e._overlayCommandList;var s=t.commandList;if(e.debugShowFrustums){e._debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}}}var l=e._frustumCommandsList;var u=l.length;var c=j.NUMBER_OF_PASSES;for(var d=0;d<u;++d){for(var f=0;f<c;++f){l[d].indices[f]=0}}a.length=0;o.length=0;var p=Number.MAX_VALUE;var m=-Number.MAX_VALUE;var v=false;var g=t.shadowHints.shadowsEnabled;var _=Number.MAX_VALUE;var y=-Number.MAX_VALUE;var b=Number.MAX_VALUE;var w=t.mode===_e.SCENE3D?t.occluder:undefined;var C=t.cullingVolume;var S=Ue.planes;for(var T=0;T<5;++T){S[T]=C.planes[T]}C=Ue;var E=s.length;for(var P=0;P<E;++P){var A=s[P];var O=A.pass;if(O===j.COMPUTE){a.push(A)}else if(O===j.OVERLAY){o.push(A)}else{var D=A.boundingVolume;if(h(D)){if(!ze(A,C,w)){continue}Ve=D.computePlaneDistances(n,i,Ve);p=Math.min(p,Ve.start);m=Math.max(m,Ve.stop);if(g&&A.receiveShadows&&Ve.start<Ce.MAXIMUM_DISTANCE&&!(O===j.GLOBE&&Ve.start<-100&&Ve.stop>100)){var I=Ve.stop-Ve.start;if(O!==j.GLOBE&&Ve.start<100){b=Math.min(b,I)}_=Math.min(_,Ve.start);y=Math.max(y,Ve.stop)}}else{Ve.start=r.frustum.near;Ve.stop=r.frustum.far;v=!(A instanceof B)}Be(e,A,Ve)}}if(v){p=r.frustum.near;m=r.frustum.far}else{p=Math.min(Math.max(p,r.frustum.near),r.frustum.far);m=Math.max(Math.min(m,r.frustum.far),p);if(g){_=Math.min(Math.max(_,r.frustum.near),r.frustum.far);y=Math.max(Math.min(y,r.frustum.far),_)}}if(g){t.shadowHints.nearPlane=_;t.shadowHints.farPlane=y;t.shadowHints.closestObjectSize=b}var M=e.mode===_e.SCENE2D;var R=e.farToNearRatio;var L;if(!M){L=Math.ceil(Math.log(m/p)/Math.log(R))}else{m=Math.min(m,r.position.z+e.nearToFarDistance2D);p=Math.min(p,m);L=Math.ceil(Math.max(1,m-p)/e.nearToFarDistance2D)}if(p!==Number.MAX_VALUE&&(L!==u||l.length!==0&&(p<l[0].near||m>l[u-1].far&&!x.equalsEpsilon(m,l[u-1].far,x.EPSILON8)))){Fe(p,m,R,L,l,M,e.nearToFarDistance2D);qe(e)}var N=t.frustumSplits;N.length=L+1;for(var k=0;k<L;++k){N[k]=l[k].near;if(k===L-1){N[k+1]=l[k].far}}}function Ge(e){var t={};var r=e.vertexAttributes;for(var i in r){if(r.hasOwnProperty(i)){t[i]=r[i].index}}return t}function He(e,t,r){var i=t.context;var n=f(r,e.shaderProgram);var a=n.fragmentShaderSource.clone();var o=[];a.sources=a.sources.map(function(e){e=K.replaceMain(e,"czm_Debug_main");var t=/gl_FragData\[(\d+)\]/g;var r;while((r=t.exec(e))!==null){if(o.indexOf(r[1])===-1){o.push(r[1])}}return e});var s=o.length;var u="void main() \n"+"{ \n"+"    czm_Debug_main(); \n";var c;if(t.debugShowCommands){if(!h(e._debugColor)){e._debugColor=l.fromRandom()}var d=e._debugColor;if(s>0){for(c=0;c<s;++c){u+="    gl_FragData["+o[c]+"].rgb *= vec3("+d.red+", "+d.green+", "+d.blue+"); \n"}}else{u+="    "+"gl_FragColor"+".rgb *= vec3("+d.red+", "+d.green+", "+d.blue+"); \n"}}if(t.debugShowFrustums){var p=e.debugOverlappingFrustums&1<<0?"1.0":"0.0";var m=e.debugOverlappingFrustums&1<<1?"1.0":"0.0";var v=e.debugOverlappingFrustums&1<<2?"1.0":"0.0";if(s>0){for(c=0;c<s;++c){u+="    gl_FragData["+o[c]+"].rgb *= vec3("+p+", "+m+", "+v+"); \n"}}else{u+="    "+"gl_FragColor"+".rgb *= vec3("+p+", "+m+", "+v+"); \n"}}u+="}";a.sources.push(u);var g=Ge(n);return Z.fromCache({context:i,vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:a,attributeLocations:g})}function je(e,t,r){var i=q.shallowClone(e);i.shaderProgram=He(e,t);i.execute(t.context,r);i.shaderProgram.destroy()}var We=new P(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);We=P.inverseTransformation(We,We);function Ye(e,t,i,n,o){if(h(t.debugCommandFilter)&&!t.debugCommandFilter(e)){return}if(e instanceof B){e.execute(i,n);return}var s=t.frameState.shadowHints.shadowsEnabled;var l=s&&t.frameState.shadowHints.lightShadowMaps.length>0;if(t.debugShowCommands||t.debugShowFrustums){je(e,t,n)}else if(l&&e.receiveShadows&&h(e.derivedCommands.shadows)){e.derivedCommands.shadows.receiveCommand.execute(i,n)}else if(t.frameState.passes.depth&&h(e.derivedCommands.depth)){e.derivedCommands.depth.depthOnlyCommand.execute(i,n)}else{e.execute(i,n)}if(e.debugShowBoundingVolume&&h(e.boundingVolume)){var c=t._frameState;var d=e.boundingVolume;if(h(t._debugVolume)){t._debugVolume.destroy()}var f;var p=a.clone(d.center);if(c.mode!==_e.SCENE3D){p=P.multiplyByPoint(We,p,p);var m=c.mapProjection;var v=m.unproject(p);p=m.ellipsoid.cartographicToCartesian(v)}if(h(d.radius)){var _=d.radius;f=w.toWireframe(g.createGeometry(new g({radii:new a(_,_,_),vertexFormat:pe.FLAT_VERTEX_FORMAT})));t._debugVolume=new ve({geometryInstances:new b({geometry:f,modelMatrix:P.fromTranslation(p),attributes:{color:new u(1,0,0,1)}}),appearance:new pe({flat:true,translucent:false}),asynchronous:false})}else{var y=d.halfAxes;f=w.toWireframe(r.createGeometry(r.fromDimensions({dimensions:new a(2,2,2),vertexFormat:pe.FLAT_VERTEX_FORMAT})));t._debugVolume=new ve({geometryInstances:new b({geometry:f,modelMatrix:P.fromRotationTranslation(y,p,new P),attributes:{color:new u(1,0,0,1)}}),appearance:new pe({flat:true,translucent:false}),asynchronous:false})}var C=c.commandList;var S=c.commandList=[];t._debugVolume.update(c);var T;if(h(o)){T=n.framebuffer;n.framebuffer=o}S[0].execute(i,n);if(h(T)){n.framebuffer=T}c.commandList=C}}function Xe(e,t,r){return t.boundingVolume.distanceSquaredTo(r)-e.boundingVolume.distanceSquaredTo(r)}function Qe(e,t,r,i){var n=e.context;A(i,Xe,e._camera.positionWC);var a=i.length;for(var o=0;o<a;++o){t(i[o],e,n,r)}}function Ze(e,t){var r=e._debugGlobeDepths[t];if(!h(r)&&e.context.depthTexture){r=new ue;e._debugGlobeDepths[t]=r}return r}function Ke(e,t){var r=e._pickDepths[t];if(!h(r)){r=new me;e._pickDepths[t]=r}return r}var Je=new M;var $e=new R;var et=new D;var tt=new I;function rt(e,t){var r=e._camera;var i=e.context;var n=i.uniformState;n.updateCamera(r);var a;if(h(r.frustum.fov)){a=r.frustum.clone(Je)}else if(h(r.frustum.infiniteProjectionMatrix)){a=r.frustum.clone($e)}else if(h(r.frustum.width)){a=r.frustum.clone(et)}else{a=r.frustum.clone(tt)}a.near=r.frustum.near;a.far=r.frustum.far;n.updateFrustum(a);n.updatePass(j.ENVIRONMENT);var o=e._useWebVR&&e.mode!==_e.SCENE2D;var s=e._frameState.passes;var l=s.pick;var u=s.depth;var c=e._environmentState;if(!l){var d=c.skyBoxCommand;if(h(d)){Ye(d,e,i,t)}if(c.isSkyAtmosphereVisible){Ye(c.skyAtmosphereCommand,e,i,t)}if(c.isSunVisible){c.sunDrawCommand.execute(i,t);if(e.sunBloom&&!o){var f;if(c.useGlobeDepthFramebuffer){f=e._globeDepth.framebuffer}else if(c.useFXAA){f=e._fxaa.getColorFramebuffer()}else{f=c.originalFramebuffer}e._sunPostProcess.execute(i,f);t.framebuffer=f}}if(c.isMoonVisible){c.moonCommand.execute(i,t)}}var p;if(c.useOIT){if(!h(e._executeOITFunction)){e._executeOITFunction=function(e,t,r,i){e._oit.executeCommands(e,t,r,i)}}p=e._executeOITFunction}else{p=Qe}var m=c.clearGlobeDepth;var v=c.useDepthPlane;var g=e._depthClearCommand;var _=e._depthPlane;var y=r.position.z;var b;var w=e._frustumCommandsList;var C=w.length;for(var S=0;S<C;++S){var T=C-S-1;var E=w[T];if(e.mode===_e.SCENE2D){r.position.z=y-E.near+1;a.far=Math.max(1,E.far-E.near);a.near=1;n.update(e.frameState);n.updateFrustum(a)}else{a.near=T!==0?E.near*xe:E.near;a.far=E.far;n.updateFrustum(a)}var x=e.debugShowGlobeDepth?Ze(e,T):e._globeDepth;var P;if(e.debugShowGlobeDepth&&h(x)&&c.useGlobeDepthFramebuffer){P=t.framebuffer;t.framebuffer=x.framebuffer}g.execute(i,t);n.updatePass(j.GLOBE);var A=E.commands[j.GLOBE];var O=E.indices[j.GLOBE];for(b=0;b<O;++b){Ye(A[b],e,i,t)}n.updatePass(j.CESIUM_3D_TILE);A=E.commands[j.CESIUM_3D_TILE];O=E.indices[j.CESIUM_3D_TILE];for(b=0;b<O;++b){Ye(A[b],e,i,t)}if(O>0&&i.stencilBuffer){e._stencilClearCommand.execute(i,t)}if(h(x)&&c.useGlobeDepthFramebuffer&&(e.copyGlobeDepth||e.debugShowGlobeDepth)){x.update(i,t);x.executeCopyDepth(i,t)}if(e.debugShowGlobeDepth&&h(x)&&c.useGlobeDepthFramebuffer){t.framebuffer=P}n.updatePass(j.GROUND);A=E.commands[j.GROUND];O=E.indices[j.GROUND];for(b=0;b<O;++b){Ye(A[b],e,i,t)}if(O>0&&i.stencilBuffer){e._stencilClearCommand.execute(i,t)}if(m){g.execute(i,t);if(v){_.execute(i,t)}}var D=j.GROUND+1;var I=j.TRANSLUCENT;for(var M=D;M<I;++M){n.updatePass(M);A=E.commands[M];O=E.indices[M];for(b=0;b<O;++b){Ye(A[b],e,i,t)}}if(T!==0&&e.mode!==_e.SCENE2D){a.near=E.near;n.updateFrustum(a)}n.updatePass(j.TRANSLUCENT);A=E.commands[j.TRANSLUCENT];A.length=E.indices[j.TRANSLUCENT];p(e,Ye,t,A);if(h(x)&&(c.useGlobeDepthFramebuffer||u)&&e.useDepthPicking){var R=u?t.framebuffer.depthStencilTexture:x.framebuffer.depthStencilTexture;var L=Ke(e,T);L.update(i,R);L.executeCopyDepth(i,t)}}}function it(e){var t=e.context.uniformState;t.updatePass(j.COMPUTE);var r=e._environmentState.sunComputeCommand;if(h(r)){r.execute(e._computeEngine)}var i=e._computeCommandList;var n=i.length;for(var a=0;a<n;++a){i[a].execute(e._computeEngine)}}function nt(e,t){var r=e.context.uniformState;r.updatePass(j.OVERLAY);var i=e.context;var n=e._overlayCommandList;var a=n.length;for(var o=0;o<a;++o){n[o].execute(i,t)}}function at(e,t,r){var i=r.shadowMapCullingVolume;var n=r.isPointLight;var a=r.passes;var o=a.length;var s=t.length;for(var l=0;l<s;++l){var u=t[l];Ie(e,u);if(u.castShadows&&(u.pass===j.GLOBE||u.pass===j.CESIUM_3D_TILE||u.pass===j.OPAQUE||u.pass===j.TRANSLUCENT)){if(ze(u,i)){if(n){for(var c=0;c<o;++c){a[c].commandList.push(u)}}else if(o===1){a[0].commandList.push(u)}else{var d=false;for(var f=o-1;f>=0;--f){var h=a[f].cullingVolume;if(ze(u,h)){a[f].commandList.push(u);d=true}else if(d){break}}}}}}}function ot(e){var t=e.frameState;var r=t.shadowHints.shadowMaps;var i=r.length;if(!t.shadowHints.shadowsEnabled){return}var n=e.context;var a=n.uniformState;for(var o=0;o<i;++o){var s=r[o];if(s.outOfView){continue}var l;var u=s.passes;var c=u.length;for(l=0;l<c;++l){u[l].commandList.length=0}var d=e.frameState.commandList;at(e,d,s);for(l=0;l<c;++l){var f=s.passes[l];a.updateCamera(f.camera);s.updatePass(n,l);var h=f.commandList.length;for(var p=0;p<h;++p){var m=f.commandList[p];a.updatePass(m.pass);Ye(m.derivedCommands.shadows.castCommands[o],e,n,f.passState)}}}}var st=new a;function lt(e,t,r){var i=e._context;var n=t.viewport;n.x=0;n.y=0;n.width=i.drawingBufferWidth;n.height=i.drawingBufferHeight;var o=e._frameState;var s=o.camera;var l=o.mode;var u=o.passes.depth;if(e._useWebVR&&l!==_e.SCENE2D){St(e,t,r);if(!u){Ct(e)}qe(e);if(!u){it(e);ot(e)}n.x=0;n.y=0;n.width=i.drawingBufferWidth*.5;n.height=i.drawingBufferHeight;var c=ee.clone(s,e._cameraVR);var d=s.frustum.near;var f=d*5;var h=f/30;var p=a.multiplyByScalar(c.right,h*.5,st);s.frustum.aspectRatio=n.width/n.height;var m=.5*h*d/f;a.add(c.position,p,s.position);s.frustum.xOffset=m;rt(e,t);n.x=t.viewport.width;a.subtract(c.position,p,s.position);s.frustum.xOffset=-m;rt(e,t);ee.clone(c,s)}else if(l!==_e.SCENE2D||e._mapMode2D===de.ROTATE){_t(true,e,t,r)}else{St(e,t,r);gt(e,t)}}var ut=new s(Math.PI,x.PI_OVER_TWO);var ct=new a;var dt=new a;var ft=new P;var ht=new P;var pt=new a;var mt=new a;var vt=new e;function gt(t,r){var i=t.context;var n=t.frameState;var o=t.camera;var s=r.viewport;var l=e.clone(s,vt);r.viewport=l;var u=ut;var c=ct;var d=t.mapProjection;d.project(u,c);var f=a.clone(o.position,dt);var h=P.clone(o.transform,ht);var p=o.frustum.clone();o._setTransform(P.IDENTITY);var m=P.computeViewportTransformation(l,0,1,ft);var v=o.frustum.projectionMatrix;var g=o.positionWC.y;var _=a.fromElements(x.sign(g)*c.x-g,0,-o.positionWC.x,pt);var y=F.pointToGLWindowCoordinates(v,m,_,mt);y.x=Math.floor(y.x);var b=l.x;var w=l.width;if(g===0||y.x<=b||y.x>=b+w){_t(true,t,r)}else if(Math.abs(b+w*.5-y.x)<1){l.width=y.x-l.x;o.position.x*=x.sign(o.position.x);o.frustum.right=0;n.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(n);_t(true,t,r);l.x=y.x;o.position.x=-o.position.x;o.frustum.right=-o.frustum.left;o.frustum.left=0;n.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(n);_t(false,t,r)}else if(y.x>b+w*.5){l.width=y.x-b;var C=o.frustum.right;o.frustum.right=c.x-g;n.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(n);_t(true,t,r);l.x=y.x;l.width=b+w-y.x;o.position.x=-o.position.x;o.frustum.left=-o.frustum.right;o.frustum.right=C-o.frustum.right*2;n.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(n);_t(false,t,r)}else{l.x=y.x;l.width=b+w-y.x;var S=o.frustum.left;o.frustum.left=-c.x-g;n.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(n);_t(true,t,r);l.x=b;l.width=y.x-b;o.position.x=-o.position.x;o.frustum.right=-o.frustum.left;o.frustum.left=S-o.frustum.left*2;n.cullingVolume=o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC);i.uniformState.update(n);_t(false,t,r)}o._setTransform(h);a.clone(f,o.position);o.frustum=p.clone();r.viewport=s}function _t(e,t,r,i){var n=t.frameState.passes.depth;if(!e&&!n){t.frameState.commandList.length=0}if(!n){Ct(t)}qe(t);if(e){if(h(i)){St(t,r,i)}if(!n){it(t);ot(t)}}rt(t,r)}function yt(e,t){var r=e._frameState;var i=e._environmentState;var n=r.passes.render;var a=e.skyAtmosphere;var o=e.globe;if(!n||e._mode!==_e.SCENE2D&&r.camera.frustum instanceof D){i.skyAtmosphereCommand=undefined;i.skyBoxCommand=undefined;i.sunDrawCommand=undefined;i.sunComputeCommand=undefined;i.moonCommand=undefined}else{if(h(a)&&h(o)){a.setDynamicAtmosphereColor(o.enableLighting);i.isReadyForAtmosphere=i.isReadyForAtmosphere||o._surface._tilesToRender.length>0}i.skyAtmosphereCommand=h(a)?a.update(r):undefined;i.skyBoxCommand=h(e.skyBox)?e.skyBox.update(r):undefined;var s=h(e.sun)?e.sun.update(r,t):undefined;i.sunDrawCommand=h(s)?s.drawCommand:undefined;i.sunComputeCommand=h(s)?s.computeCommand:undefined;i.moonCommand=h(e.moon)?e.moon.update(r):undefined}var l=i.clearGlobeDepth=h(o)&&(!o.depthTestAgainstTerrain||e.mode===_e.SCENE2D);var u=i.useDepthPlane=l&&e.mode===_e.SCENE3D;if(u){e._depthPlane.update(r)}var c=r.mode===_e.SCENE3D?r.occluder:undefined;var d=r.cullingVolume;var f=Ue.planes;for(var p=0;p<5;++p){f[p]=d.planes[p]}d=Ue;i.isSkyAtmosphereVisible=h(i.skyAtmosphereCommand)&&i.isReadyForAtmosphere;i.isSunVisible=ze(i.sunDrawCommand,d,c);i.isMoonVisible=ze(i.moonCommand,d,c)}function bt(e){var t=e._frameState;if(e.debugShowFrustumPlanes!==e._debugShowFrustumPlanes){if(e.debugShowFrustumPlanes){e._debugFrustumPlanes=new re({camera:e.camera,updateOnChange:false})}else{e._debugFrustumPlanes=e._debugFrustumPlanes&&e._debugFrustumPlanes.destroy()}e._debugShowFrustumPlanes=e.debugShowFrustumPlanes}if(h(e._debugFrustumPlanes)){e._debugFrustumPlanes.update(t)}}function wt(e){var t=e._frameState;var r=t.shadowMaps;var i=r.length;var n=i>0&&!t.passes.pick&&e.mode===_e.SCENE3D;if(n!==t.shadowHints.shadowsEnabled){++t.shadowHints.lastDirtyTime;t.shadowHints.shadowsEnabled=n}if(!n){return}for(var a=0;a<i;++a){if(r[a]!==t.shadowHints.shadowMaps[a]){++t.shadowHints.lastDirtyTime;break}}t.shadowHints.shadowMaps.length=0;t.shadowHints.lightShadowMaps.length=0;for(var o=0;o<i;++o){var s=r[o];s.update(t);t.shadowHints.shadowMaps.push(s);if(s.fromLightSource){t.shadowHints.lightShadowMaps.push(s)}if(s.dirty){++t.shadowHints.lastDirtyTime;s.dirty=false}}}function Ct(e){var t=e._frameState;e._groundPrimitives.update(t);e._primitives.update(t);bt(e);wt(e);if(e._globe){e._globe.update(t)}}function St(e,t,r){var i=e._context;var n=e._environmentState;var a=e._frameState.passes;var o=a.pick;var s=e._useWebVR&&e.mode!==_e.SCENE2D;n.originalFramebuffer=t.framebuffer;if(h(e.sun)&&e.sunBloom!==e._sunBloom){if(e.sunBloom&&!s){e._sunPostProcess=new Se}else if(h(e._sunPostProcess)){e._sunPostProcess=e._sunPostProcess.destroy()}e._sunBloom=e.sunBloom}else if(!h(e.sun)&&h(e._sunPostProcess)){e._sunPostProcess=e._sunPostProcess.destroy();e._sunBloom=false}var u=e._clearColorCommand;l.clone(r,u.color);u.execute(i,t);var c=n.useGlobeDepthFramebuffer=!o&&h(e._globeDepth);if(c){e._globeDepth.update(i,t);e._globeDepth.clear(i,t,r)}var d=n.useOIT=!o&&h(e._oit)&&e._oit.isSupported();if(d){e._oit.update(i,t,e._globeDepth.framebuffer);e._oit.clear(i,t,r);n.useOIT=e._oit.isSupported()}var f=n.useFXAA=!o&&e.fxaa;if(f){e._fxaa.update(i,t);e._fxaa.clear(i,t,r)}if(n.isSunVisible&&e.sunBloom&&!s){t.framebuffer=e._sunPostProcess.update(t)}else if(c){t.framebuffer=e._globeDepth.framebuffer}else if(f){t.framebuffer=e._fxaa.getColorFramebuffer()}if(h(t.framebuffer)){u.execute(i,t)}}function Tt(e,t){var r=e._context;var i=e._environmentState;var n=i.useGlobeDepthFramebuffer;if(e.debugShowGlobeDepth&&n){var a=Ze(e,e.debugShowDepthFrustum-1);a.executeDebugGlobeDepth(r,t)}if(e.debugShowPickDepth&&n){var o=Ke(e,e.debugShowDepthFrustum-1);o.executeDebugPickDepth(r,t)}var s=i.useOIT;var l=i.useFXAA;if(s){t.framebuffer=l?e._fxaa.getColorFramebuffer():undefined;e._oit.execute(r,t)}if(l){if(!s&&n){t.framebuffer=e._fxaa.getColorFramebuffer();e._globeDepth.executeCopyColor(r,t)}t.framebuffer=i.originalFramebuffer;e._fxaa.execute(r,t)}if(!s&&!l&&n){t.framebuffer=i.originalFramebuffer;e._globeDepth.executeCopyColor(r,t)}}function Et(e){var t=e.afterRender;for(var r=0,i=t.length;r<i;++r){t[r]()}t.length=0}Ee.prototype.initializeFrame=function(){if(this._shaderFrameCount++===120){this._shaderFrameCount=0;this._context.shaderCache.destroyReleasedShaderPrograms()}this._tweens.update();this._screenSpaceCameraController.update();if(h(this._deviceOrientationCameraController)){this._deviceOrientationCameraController.update()}this._camera.update(this._mode);this._camera._updateCameraChanged()};function xt(e,t){e._pickPositionCacheDirty=true;if(!h(t)){t=E.now()}var r=e._camera;if(!De(r,e._cameraClone,x.EPSILON6)){if(!e._cameraStartFired){r.moveStart.raiseEvent();e._cameraStartFired=true}e._cameraMovedTime=C();ee.clone(r,e._cameraClone)}else if(e._cameraStartFired&&C()-e._cameraMovedTime>e.cameraEventWaitTime){r.moveEnd.raiseEvent();e._cameraStartFired=false}e._preRender.raiseEvent(e,t);e._jobScheduler.resetBudgets();var i=e.context;var n=i.uniformState;var o=e._frameState;var s=x.incrementWrap(o.frameNumber,15e6,1);ke(e,s,t);o.passes.render=true;var u=f(e.backgroundColor,l.BLACK);o.backgroundColor=u;o.creditDisplay.beginFrame();e.fog.update(o);n.update(o);var c=e.shadowMap;if(h(c)&&c.enabled){a.negate(n.sunDirectionWC,e._sunCamera.direction);o.shadowMaps.push(c)}e._computeCommandList.length=0;e._overlayCommandList.length=0;var d=e._passState;d.framebuffer=undefined;d.blendingEnabled=undefined;d.scissorTest=undefined;if(h(e.globe)){e.globe.beginFrame(o)}yt(e,d);lt(e,d,u);Tt(e,d);nt(e,d);if(h(e.globe)){e.globe.endFrame(o)}o.creditDisplay.endFrame();if(e.debugShowFramesPerSecond){if(!h(e._performanceDisplay)){var p=document.createElement("div");p.className="cesium-performanceDisplay-defaultContainer";var m=e._canvas.parentNode;m.appendChild(p);var v=new he({container:p});e._performanceDisplay=v;e._performanceContainer=p}e._performanceDisplay.update()}else if(h(e._performanceDisplay)){e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy();e._performanceContainer.parentNode.removeChild(e._performanceContainer)}i.endFrame();N.update();Et(o);e._postRender.raiseEvent(e,t)}Ee.prototype.render=function(e){try{xt(this,e)}catch(e){this._renderError.raiseEvent(this,e);if(this.rethrowRenderErrors){throw e}}};Ee.prototype.clampLineWidth=function(e){return Math.max(z.minimumAliasedLineWidth,Math.min(e,z.maximumAliasedLineWidth))};var Pt=new I;var At=new a;var Ot=new a;var Dt=new n;var It=new P;function Mt(e,t,r,i){var n=e._camera;var o=n.frustum;if(h(o._offCenterFrustum)){o=o._offCenterFrustum}var s=e._passState.viewport;var l=2*(t.x-s.x)/s.width-1;l*=(o.right-o.left)*.5;var u=2*(s.height-t.y-s.y)/s.height-1;u*=(o.top-o.bottom)*.5;var c=P.clone(n.transform,It);n._setTransform(P.IDENTITY);var d=a.clone(n.position,At);a.multiplyByScalar(n.right,l,Ot);a.add(Ot,d,d);a.multiplyByScalar(n.up,u,Ot);a.add(Ot,d,d);n._setTransform(c);if(e.mode===_e.SCENE2D){a.fromElements(d.z,d.x,d.y,d)}var f=o.getPixelDimensions(s.width,s.height,1,Dt);var p=Pt;p.right=f.x*.5;p.left=-p.right;p.top=f.y*.5;p.bottom=-p.top;p.near=o.near;p.far=o.far;return p.computeCullingVolume(d,n.directionWC,n.upWC)}var Rt=new R;function Lt(e,t,r,i){var n=e._camera;var a=n.frustum;var o=a.near;var s=Math.tan(a.fovy*.5);var l=a.aspectRatio*s;var u=e._passState.viewport;var c=2*(t.x-u.x)/u.width-1;var d=2*(u.height-t.y-u.y)/u.height-1;var f=c*o*l;var h=d*o*s;var p=a.getPixelDimensions(u.width,u.height,1,Dt);var m=p.x*r*.5;var v=p.y*i*.5;var g=Rt;g.top=h+v;g.bottom=h-v;g.right=f+m;g.left=f-m;g.near=o;g.far=a.far;return g.computeCullingVolume(n.positionWC,n.directionWC,n.upWC)}function Nt(e,t,r,i){var n=e.camera.frustum;if(n instanceof D||n instanceof I){return Mt(e,t,r,i)}return Lt(e,t,r,i)}var kt=3;var Ft=3;var Bt=new e(0,0,kt,Ft);var Ut=new l(0,0,0,0);var Vt=new n;Ee.prototype.pick=function(e,t,r){if(!h(e)){throw new v("windowPosition is undefined.")}kt=f(t,3);Ft=f(r,kt);var i=this._context;var n=i.uniformState;var a=this._frameState;var o=ye.transformWindowToDrawingBuffer(this,e,Vt);if(!h(this._pickFramebuffer)){this._pickFramebuffer=i.createPickFramebuffer()}this._jobScheduler.disableThisFrame();ke(this,a.frameNumber,a.time);a.cullingVolume=Nt(this,o,kt,Ft);a.passes.pick=true;n.update(a);Bt.x=o.x-(kt-1)*.5;Bt.y=this.drawingBufferHeight-o.y-(Ft-1)*.5;Bt.width=kt;Bt.height=Ft;var s=this._pickFramebuffer.begin(Bt);yt(this,s);lt(this,s,Ut);Tt(this,s);var l=this._pickFramebuffer.end(Bt);i.endFrame();Et(a);return l};var zt=/\bgl_FragDepthEXT\b/;var qt=/\bdiscard\b/;function Gt(e,t){var r=e.shaderCache.getDerivedShaderProgram(t,"depthOnly");if(!h(r)){var i=t._attributeLocations;var n=t.fragmentShaderSource;var a=false;var o=n.sources;var s=o.length;for(var l=0;l<s;++l){if(zt.test(o[l])||qt.test(o[l])){a=true;break}}if(!a){n=new K({sources:["void main() { gl_FragColor = vec4(1.0); }"]})}r=e.shaderCache.createDerivedShaderProgram(t,"depthOnly",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:n,attributeLocations:i})}return r}function Ht(e,t){var r=e._depthOnlyRenderStateCache;var i=r[t.id];if(!h(i)){var n=X.getState(t);n.depthMask=true;n.colorMask={red:false,green:false,blue:false,alpha:false};i=X.fromCache(n);r[t.id]=i}return i}function jt(e,t,r,i){if(!h(i)){i={}}var n;var a;if(h(i.depthOnlyCommand)){n=i.depthOnlyCommand.shaderProgram;a=i.depthOnlyCommand.renderState}i.depthOnlyCommand=q.shallowClone(t,i.depthOnlyCommand);if(!h(n)||i.shaderProgramId!==t.shaderProgram.id){i.depthOnlyCommand.shaderProgram=Gt(r,t.shaderProgram);i.depthOnlyCommand.renderState=Ht(e,t.renderState);i.shaderProgramId=t.shaderProgram.id}else{i.depthOnlyCommand.shaderProgram=n;i.depthOnlyCommand.renderState=a}return i}function Wt(t,r){var i=t._context;var n=t._frameState;Ne(n.passes);n.passes.pick=true;n.passes.depth=true;n.cullingVolume=Nt(t,r,1,1);var a=t._pickDepthPassState;if(!h(a)){a=t._pickDepthPassState=new W(i);a.scissorTest={enabled:true,rectangle:new e};a.viewport=new e}var o=i.drawingBufferWidth;var s=i.drawingBufferHeight;var l=t._pickDepthFramebuffer;var u=t._pickDepthFramebufferWidth;var c=t._pickDepthFramebufferHeight;if(!h(l)||u!==o||c!==s){t._pickDepthFramebuffer=t._pickDepthFramebuffer&&t._pickDepthFramebuffer.destroy();l=t._pickDepthFramebuffer=new G({context:i,depthStencilTexture:new J({context:i,width:o,height:s,pixelFormat:L.DEPTH_STENCIL,pixelDatatype:Y.UNSIGNED_INT_24_8})});t._pickDepthFramebufferWidth=o;t._pickDepthFramebufferHeight=s}a.framebuffer=l;a.viewport.width=o;a.viewport.height=s;a.scissorTest.rectangle.x=r.x;a.scissorTest.rectangle.y=s-r.y;a.scissorTest.rectangle.width=1;a.scissorTest.rectangle.height=1;yt(t,a);lt(t,a,Ut);Tt(t,a);i.endFrame()}var Yt=new o;var Xt=new o(1,1/255,1/65025,1/16581375);Ee.prototype.pickPositionWorldCoordinates=function(e,t){if(!this.useDepthPicking){return undefined}if(!h(e)){throw new v("windowPosition is undefined.")}if(!h(this._globeDepth)){throw new v("Picking from the depth buffer is not supported. Check pickPositionSupported.")}var r=e.toString();if(this._pickPositionCacheDirty){this._pickPositionCache={};this._pickPositionCacheDirty=false}else if(this._pickPositionCache.hasOwnProperty(r)){return a.clone(this._pickPositionCache[r],t)}var i=this._context;var n=i.uniformState;var s=ye.transformWindowToDrawingBuffer(this,e,Vt);if(this.pickTranslucentDepth){Wt(this,s)}s.y=this.drawingBufferHeight-s.y;var l=this._camera;var u;if(h(l.frustum.fov)){u=l.frustum.clone(Je)}else if(h(l.frustum.infiniteProjectionMatrix)){u=l.frustum.clone($e)}else if(h(l.frustum.width)){u=l.frustum.clone(et)}else{u=l.frustum.clone(tt)}var c=this.numberOfFrustums;for(var d=0;d<c;++d){var f=Ke(this,d);var p=i.readPixels({x:s.x,y:s.y,width:1,height:1,framebuffer:f.framebuffer});var m=o.unpack(p,0,Yt);o.divideByScalar(m,255,m);var g=o.dot(m,Xt);if(g>0&&g<1){var _=this._frustumCommandsList[d];var y;if(this.mode===_e.SCENE2D){y=l.position.z;l.position.z=y-_.near+1;u.far=Math.max(1,_.far-_.near);u.near=1;n.update(this.frameState);n.updateFrustum(u)}else{u.near=_.near*(d!==0?xe:1);u.far=_.far;n.updateFrustum(u)}t=ye.drawingBufferToWgs84Coordinates(this,s,g,t);if(this.mode===_e.SCENE2D){l.position.z=y;n.update(this.frameState)}this._pickPositionCache[r]=a.clone(t);return t}}this._pickPositionCache[r]=undefined;return undefined};var Qt=new s;Ee.prototype.pickPosition=function(e,t){t=this.pickPositionWorldCoordinates(e,t);if(h(t)&&this.mode!==_e.SCENE3D){a.fromElements(t.y,t.z,t.x,t);var r=this.mapProjection;var i=r.ellipsoid;var n=r.unproject(t,Qt);i.cartographicToCartesian(n,t)}return t};Ee.prototype.drillPick=function(e,t){if(!h(e)){throw new v("windowPosition is undefined.")}var r;var i;var n=[];var a=[];var o=[];if(!h(t)){t=Number.MAX_VALUE}var s=this.pick(e);while(h(s)&&h(s.primitive)){n.push(s);if(0>=--t){break}var l=s.primitive;var u=false;if(typeof l.getGeometryInstanceAttributes==="function"){if(h(s.id)){i=l.getGeometryInstanceAttributes(s.id);if(h(i)&&h(i.show)){u=true;i.show=k.toValue(false,i.show);o.push(i)}}}if(!u){l.show=false;a.push(l)}s=this.pick(e)}for(r=0;r<a.length;++r){a[r].show=true}for(r=0;r<o.length;++r){i=o[r];i.show=k.toValue(true,i.show)}return n};Ee.prototype.completeMorph=function(){this._transitioner.completeMorph()};Ee.prototype.morphTo2D=function(e){var t;var r=this.globe;if(h(r)){t=r.ellipsoid}else{t=this.mapProjection.ellipsoid}e=f(e,2);this._transitioner.morphTo2D(e,t)};Ee.prototype.morphToColumbusView=function(e){var t;var r=this.globe;if(h(r)){t=r.ellipsoid}else{t=this.mapProjection.ellipsoid}e=f(e,2);this._transitioner.morphToColumbusView(e,t)};Ee.prototype.morphTo3D=function(e){var t;var r=this.globe;if(h(r)){t=r.ellipsoid}else{t=this.mapProjection.ellipsoid}e=f(e,2);this._transitioner.morphTo3D(e,t)};Ee.prototype.isDestroyed=function(){return false};Ee.prototype.destroy=function(){this._tweens.removeAll();this._computeEngine=this._computeEngine&&this._computeEngine.destroy();this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy();this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy();this._pickFramebuffer=this._pickFramebuffer&&this._pickFramebuffer.destroy();this._pickDepthFramebuffer=this._pickDepthFramebuffer&&this._pickDepthFramebuffer.destroy();this._primitives=this._primitives&&this._primitives.destroy();this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy();this._globe=this._globe&&this._globe.destroy();this.skyBox=this.skyBox&&this.skyBox.destroy();this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy();this._debugSphere=this._debugSphere&&this._debugSphere.destroy();this.sun=this.sun&&this.sun.destroy();this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy();this._depthPlane=this._depthPlane&&this._depthPlane.destroy();this._transitioner.destroy();this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy();this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy();if(h(this._globeDepth)){this._globeDepth.destroy()}if(h(this._oit)){this._oit.destroy()}this._fxaa.destroy();this._context=this._context&&this._context.destroy();this._frameState.creditDisplay.destroy();if(h(this._performanceDisplay)){this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy();this._performanceContainer.parentNode.removeChild(this._performanceContainer)}return m(this)};Ee.prototype.cartesianToCanvasCoordinates=function(e,t){return ye.wgs84ToWindowCoordinates(this,e,t)};return Ee});define("Scene/SingleTileImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/loadImage","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../ThirdParty/when"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(i){i=t(i,{});var f=i.url;if(!r(f)){throw new n("url is required.")}this._url=f;var h=i.proxy;this._proxy=h;var p=t(i.rectangle,l.MAX_VALUE);var m=new o({rectangle:p,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:i.ellipsoid});this._tilingScheme=m;this._image=undefined;this._texture=undefined;this._tileWidth=0;this._tileHeight=0;this._errorEvent=new a;this._ready=false;this._readyPromise=d.defer();var v=f;if(r(h)){v=h.getURL(v)}var g=i.credit;if(typeof g==="string"){g=new e(g)}this._credit=g;var _=this;var y;function b(e){_._image=e;_._tileWidth=e.width;_._tileHeight=e.height;_._ready=true;_._readyPromise.resolve(true);c.handleSuccess(_._errorEvent)}function w(e){var t="Failed to load image "+v+".";y=c.handleError(y,_,_._errorEvent,t,0,0,0,C,e);_._readyPromise.reject(new u(t))}function C(){d(s(v),b,w)}C()}i(f.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this._ready){throw new n("tileWidth must not be called before the imagery provider is ready.")}return this._tileWidth}},tileHeight:{get:function(){if(!this._ready){throw new n("tileHeight must not be called before the imagery provider is ready.")}return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready){throw new n("maximumLevel must not be called before the imagery provider is ready.")}return 0}},minimumLevel:{get:function(){if(!this._ready){throw new n("minimumLevel must not be called before the imagery provider is ready.")}return 0}},tilingScheme:{get:function(){if(!this._ready){throw new n("tilingScheme must not be called before the imagery provider is ready.")}return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready){throw new n("tileDiscardPolicy must not be called before the imagery provider is ready.")}return undefined}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return true}}});f.prototype.getTileCredits=function(e,t,r){return undefined};f.prototype.requestImage=function(e,t,r,i){if(!this._ready){throw new n("requestImage must not be called before the imagery provider is ready.")}return this._image};f.prototype.pickFeatures=function(e,t,r,i,n){return undefined};return f});define("Shaders/SkyAtmosphereFS",[],function(){"use strict";return'/**\n * @license\n * Copyright (c) 2000-2005, Sean O\'Neil (s_p_oneil@hotmail.com)\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * * Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n * * Neither the name of the project nor the names of its contributors may be\n *   used to endorse or promote products derived from this software without\n *   specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Modifications made by Analytical Graphics, Inc.\n */\n\n // Code:  http://sponeil.net/\n // GPU Gems 2 Article:  http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift; // Hue, saturation, brightness\n#endif\n\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor; // Camera height, outer radius, inner radius, dynamic atmosphere color flag\n\nconst float g = -0.95;\nconst float g2 = g * g;\n\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nvarying vec3 v_positionEC;\n\nvoid main (void)\n{\n    // Extra normalize added for Android\n    float cosAngle = dot(czm_sunDirectionWC, normalize(v_toCamera)) / length(v_toCamera);\n    float rayleighPhase = 0.75 * (1.0 + cosAngle * cosAngle);\n    float miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cosAngle * cosAngle) / pow(1.0 + g2 - 2.0 * g * cosAngle, 1.5);\n\n    const float exposure = 2.0;\n\n    vec3 rgb = rayleighPhase * v_rayleighColor + miePhase * v_mieColor;\n    rgb = vec3(1.0) - exp(-exposure * rgb);\n    // Compute luminance before color correction to avoid strangely gray night skies\n    float l = czm_luminance(rgb);\n\n#ifdef COLOR_CORRECT\n    // Convert rgb color to hsb\n    vec3 hsb = czm_RGBToHSB(rgb);\n    // Perform hsb shift\n    hsb.x += u_hsbShift.x; // hue\n    hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0); // saturation\n    hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0; // brightness\n    // Convert shifted hsb back to rgb\n    rgb = czm_HSBToRGB(hsb);\n\n    // Check if correction decreased the luminance to 0\n    l = min(l, czm_luminance(rgb));\n#endif\n\n    // Alter alpha based on how close the viewer is to the ground (1.0 = on ground, 0.0 = at edge of atmosphere)\n    float atmosphereAlpha = clamp((u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.x) / (u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.z), 0.0, 1.0);\n\n    // Alter alpha based on time of day (0.0 = night , 1.0 = day)\n    float nightAlpha = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? clamp(dot(normalize(czm_viewerPositionWC), normalize(czm_sunPositionWC)), 0.0, 1.0) : 1.0;\n    atmosphereAlpha *= pow(nightAlpha, 0.5);\n\n    gl_FragColor = vec4(rgb, mix(rgb.b, 1.0, atmosphereAlpha) * smoothstep(0.0, 1.0, czm_morphTime));\n}\n'});define("Shaders/SkyAtmosphereVS",[],function(){"use strict";return"/**\n * @license\n * Copyright (c) 2000-2005, Sean O'Neil (s_p_oneil@hotmail.com)\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * * Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n * * Neither the name of the project nor the names of its contributors may be\n *   used to endorse or promote products derived from this software without\n *   specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Modifications made by Analytical Graphics, Inc.\n */\n\n // Code:  http://sponeil.net/\n // GPU Gems 2 Article:  http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n\nattribute vec4 position;\n\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor; // Camera height, outer radius, inner radius, dynamic atmosphere color flag\n\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * czm_pi;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * czm_pi;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 InvWavelength = vec3(\n    5.60204474633241,  // Red = 1.0 / Math.pow(0.650, 4.0)\n    9.473284437923038, // Green = 1.0 / Math.pow(0.570, 4.0)\n    19.643802610477206); // Blue = 1.0 / Math.pow(0.475, 4.0)\nconst float rayleighScaleDepth = 0.25;\n\nconst int nSamples = 2;\nconst float fSamples = 2.0;\n\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\n\nfloat scale(float cosAngle)\n{\n    float x = 1.0 - cosAngle;\n    return rayleighScaleDepth  * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\n\nvoid main(void)\n{\n    // Unpack attributes\n    float cameraHeight = u_cameraAndRadiiAndDynamicAtmosphereColor.x;\n    float outerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.y;\n    float innerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.z;\n\n    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n    vec3 positionV3 = position.xyz;\n    vec3 ray = positionV3 - czm_viewerPositionWC;\n    float far = length(ray);\n    ray /= far;\n    float atmosphereScale = 1.0 / (outerRadius - innerRadius);\n\n#ifdef SKY_FROM_SPACE\n    // Calculate the closest intersection of the ray with the outer atmosphere (which is the near point of the ray passing through the atmosphere)\n    float B = 2.0 * dot(czm_viewerPositionWC, ray);\n    float C = cameraHeight * cameraHeight - outerRadius * outerRadius;\n    float det = max(0.0, B*B - 4.0 * C);\n    float near = 0.5 * (-B - sqrt(det));\n\n    // Calculate the ray's starting position, then calculate its scattering offset\n    vec3 start = czm_viewerPositionWC + ray * near;\n    far -= near;\n    float startAngle = dot(ray, start) / outerRadius;\n    float startDepth = exp(-1.0 / rayleighScaleDepth );\n    float startOffset = startDepth*scale(startAngle);\n#else // SKY_FROM_ATMOSPHERE\n    // Calculate the ray's starting position, then calculate its scattering offset\n    vec3 start = czm_viewerPositionWC;\n    float height = length(start);\n    float depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - cameraHeight));\n    float startAngle = dot(ray, start) / height;\n    float startOffset = depth*scale(startAngle);\n#endif\n\n    // Initialize the scattering loop variables\n    float sampleLength = far / fSamples;\n    float scaledLength = sampleLength * atmosphereScale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n\n    // Now loop through the sample rays\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    vec3 lightDir = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? czm_sunPositionWC - czm_viewerPositionWC : czm_viewerPositionWC;\n    lightDir = normalize(lightDir);\n\n    for(int i=0; i<nSamples; i++)\n    {\n        float height = length(samplePoint);\n        float depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - height));\n        float fLightAngle = dot(lightDir, samplePoint) / height;\n        float fCameraAngle = dot(ray, samplePoint) / height;\n        float fScatter = (startOffset + depth*(scale(fLightAngle) - scale(fCameraAngle)));\n        vec3 attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\n        frontColor += attenuate * (depth * scaledLength);\n        samplePoint += sampleRay;\n    }\n\n    // Finally, scale the Mie and Rayleigh colors and set up the varying variables for the pixel shader\n    v_mieColor = frontColor * KmESun;\n    v_rayleighColor = frontColor * (InvWavelength * KrESun);\n    v_toCamera = czm_viewerPositionWC - positionV3;\n    gl_Position = czm_modelViewProjection * position;\n}\n"});define("Scene/SkyAtmosphere",["../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/EllipsoidGeometry","../Core/GeometryPipeline","../Core/Math","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/SkyAtmosphereFS","../Shaders/SkyAtmosphereVS","./BlendingState","./CullFace","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w){"use strict";function C(i){i=r(i,o.WGS84);this.show=true;this._ellipsoid=i;this._command=new f({owner:this});this._spSkyFromSpace=undefined;this._spSkyFromAtmosphere=undefined;this._spSkyFromSpaceColorCorrect=undefined;this._spSkyFromAtmosphereColorCorrect=undefined;this.hueShift=0;this.saturationShift=0;this.brightnessShift=0;this._hueSaturationBrightness=new e;var n=new t;n.w=0;n.y=e.maximumComponent(e.multiplyByScalar(i.radii,1.025,new e));n.z=i.maximumRadius;this._cameraAndRadiiAndDynamicAtmosphereColor=n;var a=this;this._command.uniformMap={u_cameraAndRadiiAndDynamicAtmosphereColor:function(){return a._cameraAndRadiiAndDynamicAtmosphereColor},u_hsbShift:function(){a._hueSaturationBrightness.x=a.hueShift;a._hueSaturationBrightness.y=a.saturationShift;a._hueSaturationBrightness.z=a.brightnessShift;return a._hueSaturationBrightness}}}n(C.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});C.prototype.setDynamicAtmosphereColor=function(e){this._cameraAndRadiiAndDynamicAtmosphereColor.w=e?1:0};C.prototype.update=function(t){if(!this.show){return undefined}var r=t.mode;if(r!==w.SCENE3D&&r!==w.MORPHING){return undefined}if(!t.passes.render){return undefined}var n=this._command;if(!i(n.vertexArray)){var a=t.context;var o=s.createGeometry(new s({radii:e.multiplyByScalar(this._ellipsoid.radii,1.025,new e),slicePartitions:256,stackPartitions:256,vertexFormat:c.POSITION_ONLY}));n.vertexArray=v.fromGeometry({context:a,geometry:o,attributeLocations:l.createAttributeLocations(o),bufferUsage:d.STATIC_DRAW});n.renderState=h.fromCache({cull:{enabled:true,face:b.FRONT},blending:y.ALPHA_BLEND});var u=new m({defines:["SKY_FROM_SPACE"],sources:[_]});this._spSkyFromSpace=p.fromCache({context:a,vertexShaderSource:u,fragmentShaderSource:g});u=new m({defines:["SKY_FROM_ATMOSPHERE"],sources:[_]});this._spSkyFromAtmosphere=p.fromCache({context:a,vertexShaderSource:u,fragmentShaderSource:g})}var f=S(this);if(f&&(!i(this._spSkyFromSpaceColorCorrect)||!i(this._spSkyFromAtmosphereColorCorrect))){var C=t.context;var T=new m({defines:["SKY_FROM_SPACE"],sources:[_]});var E=new m({defines:["COLOR_CORRECT"],sources:[g]});this._spSkyFromSpaceColorCorrect=p.fromCache({context:C,vertexShaderSource:T,fragmentShaderSource:E});T=new m({defines:["SKY_FROM_ATMOSPHERE"],sources:[_]});this._spSkyFromAtmosphereColorCorrect=p.fromCache({context:C,vertexShaderSource:T,fragmentShaderSource:E})}var x=t.camera.positionWC;var P=e.magnitude(x);this._cameraAndRadiiAndDynamicAtmosphereColor.x=P;if(P>this._cameraAndRadiiAndDynamicAtmosphereColor.y){n.shaderProgram=f?this._spSkyFromSpaceColorCorrect:this._spSkyFromSpace}else{n.shaderProgram=f?this._spSkyFromAtmosphereColorCorrect:this._spSkyFromAtmosphere}return n};function S(e){return!(u.equalsEpsilon(e.hueShift,0,u.EPSILON7)&&u.equalsEpsilon(e.saturationShift,0,u.EPSILON7)&&u.equalsEpsilon(e.brightnessShift,0,u.EPSILON7))}C.prototype.isDestroyed=function(){return false};C.prototype.destroy=function(){var e=this._command;e.vertexArray=e.vertexArray&&e.vertexArray.destroy();this._spSkyFromSpace=this._spSkyFromSpace&&this._spSkyFromSpace.destroy();this._spSkyFromAtmosphere=this._spSkyFromAtmosphere&&this._spSkyFromAtmosphere.destroy();this._spSkyFromSpaceColorCorrect=this._spSkyFromSpaceColorCorrect&&this._spSkyFromSpaceColorCorrect.destroy();this._spSkyFromAtmosphereColorCorrect=this._spSkyFromAtmosphereColorCorrect&&this._spSkyFromAtmosphereColorCorrect.destroy();return a(this)};return C});define("Shaders/SkyBoxFS",[],function(){"use strict";return"uniform samplerCube u_cubeMap;\n\nvarying vec3 v_texCoord;\n\nvoid main()\n{\n    vec3 rgb = textureCube(u_cubeMap, normalize(v_texCoord)).rgb;\n    gl_FragColor = vec4(rgb, czm_morphTime);\n}\n"});define("Shaders/SkyBoxVS",[],function(){"use strict";return"attribute vec3 position;\n\nvarying vec3 v_texCoord;\n\nvoid main()\n{\n    vec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n    gl_Position = czm_projection * vec4(p, 1.0);\n    v_texCoord = position.xyz;\n}\n"});define("Scene/SkyBox",["../Core/BoxGeometry","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryPipeline","../Core/Matrix4","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/CubeMap","../Renderer/DrawCommand","../Renderer/loadCubeMap","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/VertexArray","../Shaders/SkyBoxFS","../Shaders/SkyBoxVS","./BlendingState","./SceneMode"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y){"use strict";function b(e){this.sources=e.sources;this._sources=undefined;this.show=r(e.show,true);this._command=new d({modelMatrix:s.clone(s.IDENTITY),owner:this});this._cubeMap=undefined}b.prototype.update=function(r){var n=this;if(!this.show){return undefined}if(r.mode!==y.SCENE3D&&r.mode!==y.MORPHING){return undefined}if(!r.passes.render){return undefined}var s=r.context;if(this._sources!==this.sources){this._sources=this.sources;var d=this.sources;if(!i(d.positiveX)||!i(d.negativeX)||!i(d.positiveY)||!i(d.negativeY)||!i(d.positiveZ)||!i(d.negativeZ)){throw new a("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.")}if(typeof d.positiveX!==typeof d.negativeX||typeof d.positiveX!==typeof d.positiveY||typeof d.positiveX!==typeof d.negativeY||typeof d.positiveX!==typeof d.positiveZ||typeof d.positiveX!==typeof d.negativeZ){throw new a("this.sources properties must all be the same type.")}if(typeof d.positiveX==="string"){f(s,this._sources).then(function(e){n._cubeMap=n._cubeMap&&n._cubeMap.destroy();n._cubeMap=e})}else{this._cubeMap=this._cubeMap&&this._cubeMap.destroy();this._cubeMap=new c({context:s,source:d})}}var b=this._command;if(!i(b.vertexArray)){b.uniformMap={u_cubeMap:function(){return n._cubeMap}};var w=e.createGeometry(e.fromDimensions({dimensions:new t(2,2,2),vertexFormat:l.POSITION_ONLY}));var C=o.createAttributeLocations(w);b.vertexArray=m.fromGeometry({context:s,geometry:w,attributeLocations:C,bufferUsage:u.STATIC_DRAW});b.shaderProgram=p.fromCache({context:s,vertexShaderSource:g,fragmentShaderSource:v,attributeLocations:C});b.renderState=h.fromCache({blending:_.ALPHA_BLEND})}if(!i(this._cubeMap)){return undefined}return b};b.prototype.isDestroyed=function(){return false};b.prototype.destroy=function(){var e=this._command;e.vertexArray=e.vertexArray&&e.vertexArray.destroy();e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy();this._cubeMap=this._cubeMap&&this._cubeMap.destroy();return n(this)};return b});define("Scene/SphereEmitter",["../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/defineProperties","../Core/Math"],function(e,t,r,i,n){"use strict";function a(e){e=r(e,1);t.typeOf.number.greaterThan("radius",e,0);this._radius=r(e,1)}i(a.prototype,{radius:{get:function(){return this._radius},set:function(e){t.typeOf.number.greaterThan("value",e,0);this._radius=e}}});a.prototype.emit=function(t){var r=n.randomBetween(0,n.TWO_PI);var i=n.randomBetween(0,n.PI);var a=n.randomBetween(0,this._radius);var o=a*Math.cos(r)*Math.sin(i);var s=a*Math.sin(r)*Math.sin(i);var l=a*Math.cos(i);t.position=e.fromElements(o,s,l,t.position);t.velocity=e.normalize(t.position,t.velocity)};return a});define("Scene/StyleExpression",["../Core/DeveloperError"],function(e){"use strict";function t(){}t.prototype.evaluate=function(t,r,i){e.throwInstantiationError()};t.prototype.evaluateColor=function(t,r,i){e.throwInstantiationError()};t.prototype.getShaderFunction=function(t,r,i,n){e.throwInstantiationError()};return t});define("Shaders/SunFS",[],function(){"use strict";return"uniform sampler2D u_texture;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    gl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"});define("Shaders/SunTextureFS",[],function(){"use strict";return"uniform float u_glowLengthTS;\nuniform float u_radiusTS;\n\nvarying vec2 v_textureCoordinates;\n\nvec2 rotate(vec2 p, vec2 direction)\n{\n    return vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);\n}\n\nvec4 addBurst(vec2 position, vec2 direction)\n{\n    vec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);\n    float radius = length(rotatedPosition);\n    float burst = 1.0 - smoothstep(0.0, 0.55, radius);\n\n    return vec4(burst);\n}\n\nvoid main()\n{\n    vec2 position = v_textureCoordinates - vec2(0.5);\n    float radius = length(position);\n    float surface = step(radius, u_radiusTS);\n    vec4 color = vec4(1.0, 1.0, surface + 0.2, surface);\n\n    float glow = 1.0 - smoothstep(0.0, 0.55, radius);\n    color.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;\n\n    vec4 burst = vec4(0.0);\n\n    // The following loop has been manually unrolled for speed, to\n    // avoid sin() and cos().\n    //\n    //for (float i = 0.4; i < 3.2; i += 1.047) {\n    //    vec2 direction = vec2(sin(i), cos(i));\n    //    burst += 0.4 * addBurst(position, direction);\n    //\n    //    direction = vec2(sin(i - 0.08), cos(i - 0.08));\n    //    burst += 0.3 * addBurst(position, direction);\n    //}\n\n    burst += 0.4 * addBurst(position, vec2(0.38942,  0.92106));  // angle == 0.4\n    burst += 0.4 * addBurst(position, vec2(0.99235,  0.12348));  // angle == 0.4 + 1.047\n    burst += 0.4 * addBurst(position, vec2(0.60327, -0.79754));  // angle == 0.4 + 1.047 * 2.0\n\n    burst += 0.3 * addBurst(position, vec2(0.31457,  0.94924));  // angle == 0.4 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.97931,  0.20239));  // angle == 0.4 + 1.047 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.66507, -0.74678));  // angle == 0.4 + 1.047 * 2.0 - 0.08\n\n    // End of manual loop unrolling.\n\n    color += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;\n    \n    gl_FragColor = clamp(color, vec4(0.0), vec4(1.0));\n}\n"});define("Shaders/SunVS",[],function(){"use strict";return"attribute vec2 direction;\n\nuniform float u_size;\n\nvarying vec2 v_textureCoordinates;\n\nvoid main() \n{\n    vec4 position;\n    if (czm_morphTime == 1.0)\n    {\n        position = vec4(czm_sunPositionWC, 1.0);\n    }\n    else\n    {\n        position = vec4(czm_sunPositionColumbusView.zxy, 1.0);\n    }\n    \n    vec4 positionEC = czm_view * position;\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n    \n    vec2 halfSize = vec2(u_size * 0.5);\n    halfSize *= ((direction * 2.0) - 1.0);\n    \n    gl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);\n    \n    v_textureCoordinates = direction;\n}\n"});define("Scene/Sun",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/IndexDatatype","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/PrimitiveType","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ComputeCommand","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/Texture","../Renderer/VertexArray","../Shaders/SunFS","../Shaders/SunTextureFS","../Shaders/SunVS","./BlendingState","./SceneMode","./SceneTransforms"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x){"use strict";function P(){this.show=true;this._drawCommand=new v({primitiveType:f.TRIANGLES,boundingVolume:new e,owner:this});this._commands={drawCommand:this._drawCommand,computeCommand:undefined};this._boundingVolume=new e;this._boundingVolume2D=new e;this._texture=undefined;this._drawingBufferWidth=undefined;this._drawingBufferHeight=undefined;this._radiusTS=undefined;this._size=undefined;this.glowFactor=1;this._glowFactorDirty=false;var t=this;this._uniformMap={u_texture:function(){return t._texture},u_size:function(){return t._size}}}o(P.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0);this._glowFactor=e;this._glowFactorDirty=true}}});var A=new t;var O=new t;var D=new i;var I=new i;P.prototype.update=function(i,o){if(!this.show){return undefined}var s=i.mode;if(s===E.SCENE2D||s===E.MORPHING){return undefined}if(!i.passes.render){return undefined}var f=i.context;var v=o.viewport.width;var P=o.viewport.height;if(!a(this._texture)||v!==this._drawingBufferWidth||P!==this._drawingBufferHeight||this._glowFactorDirty){this._texture=this._texture&&this._texture.destroy();this._drawingBufferWidth=v;this._drawingBufferHeight=P;this._glowFactorDirty=false;var M=Math.max(v,P);M=Math.pow(2,Math.ceil(Math.log(M)/Math.log(2))-2);M=Math.max(1,M);this._texture=new y({context:f,width:M,height:M,pixelFormat:d.RGBA});this._glowLengthTS=this._glowFactor*5;this._radiusTS=1/(1+2*this._glowLengthTS)*.5;var R=this;var L={u_glowLengthTS:function(){return R._glowLengthTS},u_radiusTS:function(){return R._radiusTS}};this._commands.computeCommand=new m({fragmentShaderSource:C,outputTexture:this._texture,uniformMap:L,persists:false,owner:this,postExecute:function(){R._commands.computeCommand=undefined}})}var N=this._drawCommand;if(!a(N.vertexArray)){var k={direction:0};var F=new Uint8Array(4*2);F[0]=0;F[1]=0;F[2]=255;F[3]=0;F[4]=255;F[5]=255;F[6]=0;F[7]=255;var B=h.createVertexBuffer({context:f,typedArray:F,usage:p.STATIC_DRAW});var U=[{index:k.direction,vertexBuffer:B,componentsPerAttribute:2,normalize:true,componentDatatype:n.UNSIGNED_BYTE}];var V=h.createIndexBuffer({context:f,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:p.STATIC_DRAW,indexDatatype:l.UNSIGNED_SHORT});N.vertexArray=new b({context:f,attributes:U,indexBuffer:V});N.shaderProgram=_.fromCache({context:f,vertexShaderSource:S,fragmentShaderSource:w,attributeLocations:k});N.renderState=g.fromCache({blending:T.ALPHA_BLEND});N.uniformMap=this._uniformMap}var z=f.uniformState.sunPositionWC;var q=f.uniformState.sunPositionColumbusView;var G=this._boundingVolume;var H=this._boundingVolume2D;r.clone(z,G.center);H.center.x=q.z;H.center.y=q.x;H.center.z=q.y;G.radius=u.SOLAR_RADIUS+u.SOLAR_RADIUS*this._glowLengthTS;H.radius=G.radius;if(s===E.SCENE3D){e.clone(G,N.boundingVolume)}else if(s===E.COLUMBUS_VIEW){e.clone(H,N.boundingVolume)}var j=x.computeActualWgs84Position(i,z,I);var W=r.magnitude(r.subtract(j,i.camera.position,I));var Y=f.uniformState.projection;var X=D;X.x=0;X.y=0;X.z=-W;X.w=1;var Q=c.multiplyByVector(Y,X,I);var Z=x.clipToGLWindowCoordinates(o.viewport,Q,A);X.x=u.SOLAR_RADIUS;var K=c.multiplyByVector(Y,X,I);var J=x.clipToGLWindowCoordinates(o.viewport,K,O);this._size=Math.ceil(t.magnitude(t.subtract(J,Z,I)));this._size=2*this._size*(1+2*this._glowLengthTS);return this._commands};P.prototype.isDestroyed=function(){return false};P.prototype.destroy=function(){var e=this._drawCommand;e.vertexArray=e.vertexArray&&e.vertexArray.destroy();e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy();this._texture=this._texture&&this._texture.destroy();return s(this)};return P});define("Scene/TileBoundingVolume",["../Core/DeveloperError"],function(e){"use strict";function t(){}t.prototype.boundingVolume=undefined;t.prototype.boundingSphere=undefined;t.prototype.distanceToCamera=function(t){e.throwInstantiationError()};t.prototype.intersectPlane=function(t){e.throwInstantiationError()};t.prototype.createDebugVolume=function(t){e.throwInstantiationError()};return t});define("Scene/TileCoordinatesImageryProvider",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/GeographicTilingScheme","../ThirdParty/when"],function(e,t,r,i,n,a,o){"use strict";function s(i){i=t(i,t.EMPTY_OBJECT);this._tilingScheme=r(i.tilingScheme)?i.tilingScheme:new a({ellipsoid:i.ellipsoid});this._color=t(i.color,e.YELLOW);this._errorEvent=new n;this._tileWidth=t(i.tileWidth,256);this._tileHeight=t(i.tileHeight,256);this._readyPromise=o.resolve(true)}i(s.prototype,{proxy:{get:function(){return undefined}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return undefined}},minimumLevel:{get:function(){return undefined}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return undefined}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return true}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return undefined}},hasAlphaChannel:{get:function(){return true}}});s.prototype.getTileCredits=function(e,t,r){return undefined};s.prototype.requestImage=function(e,t,r,i){var n=document.createElement("canvas");n.width=256;n.height=256;var a=n.getContext("2d");var o=this._color.toCssColorString();a.strokeStyle=o;a.lineWidth=2;a.strokeRect(1,1,255,255);var s="L"+r+"X"+e+"Y"+t;a.font="bold 25px Arial";a.textAlign="center";a.fillStyle="black";a.fillText(s,127,127);a.fillStyle=o;a.fillText(s,124,124);return n};s.prototype.pickFeatures=function(e,t,r,i,n){return undefined};return s});define("Scene/TileDiscardPolicy",["../Core/DeveloperError"],function(e){"use strict";function t(t){e.throwInstantiationError()}t.prototype.isReady=e.throwInstantiationError;t.prototype.shouldDiscardImage=e.throwInstantiationError;return t});define("Scene/TileState",["../Core/freezeObject"],function(e){"use strict";var t={START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3};return e(t)});define("Scene/TimeDynamicImagery",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/JulianDate","../Core/Request","../Core/RequestType"],function(e,t,r,i,n,a,o,s){"use strict";function l(r){r=t(r,t.EMPTY_OBJECT);e.typeOf.object("options.clock",r.clock);e.typeOf.object("options.times",r.times);e.typeOf.func("options.requestImageFunction",r.requestImageFunction);e.typeOf.func("options.reloadFunction",r.reloadFunction);this._tileCache={};this._tilesRequestedForInterval=[];var i=this._clock=r.clock;this._times=r.times;this._requestImageFunction=r.requestImageFunction;this._reloadFunction=r.reloadFunction;this._currentIntervalIndex=-1;i.onTick.addEventListener(this._clockOnTick,this);this._clockOnTick(i)}i(l.prototype,{clock:{get:function(){return this._clock},set:function(e){if(!r(e)){throw new n("value is required.")}if(this._clock!==e){this._clock=e;this._clockOnTick(e);this._reloadFunction()}}},times:{get:function(){return this._times},set:function(e){if(!r(e)){throw new n("value is required.")}if(this._times!==e){this._times=e;this._clockOnTick(this._clock);this._reloadFunction()}}},currentInterval:{get:function(){return this._times.get(this._currentIntervalIndex)}}});l.prototype.getFromCache=function(e,t,i,n){var a=u(e,t,i);var o;var s=this._tileCache[this._currentIntervalIndex];if(r(s)&&r(s[a])){var l=s[a];o=l.promise.otherwise(function(e){n.state=l.request.state;throw e});delete s[a]}return o};l.prototype.checkApproachingInterval=function(e,t,i,n){var a=u(e,t,i);var o=this._tilesRequestedForInterval;var s=d(this);var l={key:a,priorityFunction:n.priorityFunction};if(!r(s)||!f(this,l,s)){o.push(l)}if(o.length>=512){o.splice(0,256)}};l.prototype._clockOnTick=function(e){var t=e.currentTime;var i=this._times;var n=i.indexOf(t);var a=this._currentIntervalIndex;if(n!==a){var o=this._tileCache[a];for(var s in o){if(o.hasOwnProperty(s)){o[s].request.cancel()}}delete this._tileCache[a];this._tilesRequestedForInterval=[];this._currentIntervalIndex=n;this._reloadFunction();return}var l=d(this);if(r(l)){var u=this._tilesRequestedForInterval;var c=true;while(c){if(u.length===0){break}var h=u.pop();c=f(this,h,l);if(!c){u.push(h)}}}};function u(e,t,r){return e+"-"+t+"-"+r}function c(e){var t=e.split("-");if(t.length!==3){return undefined}return{x:Number(t[0]),y:Number(t[1]),level:Number(t[2])}}function d(e){var t=e._times;if(!r(t)){return undefined}var i=e._clock;var n=i.currentTime;var o=i.canAnimate&&i.shouldAnimate;var s=i.multiplier;if(!o&&s!==0){return undefined}var l;var u=t.indexOf(n);if(u===-1){return undefined}var c=t.get(u);if(s>0){l=a.secondsDifference(c.stop,n);++u}else{l=a.secondsDifference(c.start,n);--u}l/=s;return u>=0&&l<=5?t.get(u):undefined}function f(e,t,i){var n=e._times.indexOf(i.start);var a=e._tileCache;var l=a[n];if(!r(l)){l=a[n]={}}var u=t.key;if(r(l[u])){return true}var d=c(u);var f=new o({throttle:true,throttleByServer:true,type:s.IMAGERY,priorityFunction:t.priorityFunction});var h=e._requestImageFunction(d.x,d.y,d.level,f,i);if(!r(h)){return false}l[u]={promise:h,request:f};return true}return l});define("Shaders/ViewportQuadFS",[],function(){"use strict";return"\nvarying vec2 v_textureCoordinates;\n\nvoid main()\n{\n    czm_materialInput materialInput;\n    \n    materialInput.s = v_textureCoordinates.s;\n    materialInput.st = v_textureCoordinates;\n    materialInput.str = vec3(v_textureCoordinates, 0.0);\n    materialInput.normalEC = vec3(0.0, 0.0, -1.0);\n    \n    czm_material material = czm_getMaterial(materialInput);\n\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n"});define("Scene/ViewportQuad",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderSource","../Shaders/ViewportQuadFS","./BlendingState","./Material"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";function d(i,n){this.show=true;if(!r(i)){i=new e}this.rectangle=e.clone(i);if(!r(n)){n=c.fromType(c.ColorType,{color:new t(1,1,1,1)})}this.material=n;this._material=undefined;this._overlayCommand=undefined;this._rs=undefined}d.prototype.update=function(t){if(!this.show){return}if(!r(this.material)){throw new n("this.material must be defined.")}if(!r(this.rectangle)){throw new n("this.rectangle must be defined.")}var i=this._rs;if(!r(i)||!e.equals(i.viewport,this.rectangle)){this._rs=o.fromCache({blending:u.ALPHA_BLEND,viewport:this.rectangle})}var c=t.passes;if(c.render){var d=t.context;if(this._material!==this.material||!r(this._overlayCommand)){this._material=this.material;if(r(this._overlayCommand)){this._overlayCommand.shaderProgram.destroy()}var f=new s({sources:[this._material.shaderSource,l]});this._overlayCommand=d.createViewportQuadCommand(f,{renderState:this._rs,uniformMap:this._material._uniforms,owner:this});this._overlayCommand.pass=a.OVERLAY}this._material.update(d);this._overlayCommand.uniformMap=this._material._uniforms;t.commandList.push(this._overlayCommand)}};d.prototype.isDestroyed=function(){return false};d.prototype.destroy=function(){if(r(this._overlayCommand)){this._overlayCommand.shaderProgram=this._overlayCommand.shaderProgram&&this._overlayCommand.shaderProgram.destroy()}return i(this)};return d});define("Scene/WebMapServiceImageryProvider",["../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/freezeObject","../Core/GeographicTilingScheme","../Core/objectToQuery","../Core/queryToObject","../Core/WebMercatorTilingScheme","../ThirdParty/Uri","./GetFeatureInfoFormat","./UrlTemplateImageryProvider"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";function h(i){i=t(i,t.EMPTY_OBJECT);if(!r(i.url)){throw new n("options.url is required.")}if(!r(i.layers)){throw new n("options.layers is required.")}this._url=i.url;this._layers=i.layers;var a=t(i.getFeatureInfoFormats,h.DefaultGetFeatureInfoFormats);var d=new c(i.url);var m=l(t(d.query,""));var v=e(p(t(i.parameters,t.EMPTY_OBJECT)),h.DefaultParameters);m=e(v,m);var g;var _;g=new c(i.url);_=l(t(g.query,""));var y=e(p(t(i.getFeatureInfoParameters,t.EMPTY_OBJECT)),h.GetFeatureInfoDefaultParameters);_=e(y,_);function b(e,t){if(!r(m[e])){m[e]=t}if(r(_)&&!r(_[e])){_[e]=t}}b("layers",i.layers);if(parseFloat(v.version)>=1.3){b("crs",i.tilingScheme instanceof u?"EPSG:3857":"CRS:84")}else{b("srs",i.tilingScheme instanceof u?"EPSG:3857":"EPSG:4326")}b("bbox","{westProjected},{southProjected},{eastProjected},{northProjected}");b("width","{width}");b("height","{height}");d.query=s(m);var w=d.toString().replace(/%7B/g,"{").replace(/%7D/g,"}");var C;if(r(_)){if(!r(_.query_layers)){_.query_layers=i.layers}if(!r(_.x)){_.x="{i}"}if(!r(_.y)){_.y="{j}"}if(!r(_.info_format)){_.info_format="{format}"}g.query=s(_);C=g.toString().replace(/%7B/g,"{").replace(/%7D/g,"}")}this._tileProvider=new f({url:w,pickFeaturesUrl:C,tilingScheme:t(i.tilingScheme,new o({ellipsoid:i.ellipsoid})),rectangle:i.rectangle,tileWidth:i.tileWidth,tileHeight:i.tileHeight,minimumLevel:i.minimumLevel,maximumLevel:i.maximumLevel,proxy:i.proxy,subdomains:i.subdomains,tileDiscardPolicy:i.tileDiscardPolicy,credit:i.credit,getFeatureInfoFormats:a,enablePickFeatures:i.enablePickFeatures})}i(h.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._tileProvider.proxy}},layers:{get:function(){return this._layers}},tileWidth:{get:function(){return this._tileProvider.tileWidth}},tileHeight:{get:function(){return this._tileProvider.tileHeight}},maximumLevel:{get:function(){return this._tileProvider.maximumLevel}},minimumLevel:{get:function(){return this._tileProvider.minimumLevel}},tilingScheme:{get:function(){return this._tileProvider.tilingScheme}},rectangle:{get:function(){return this._tileProvider.rectangle}},tileDiscardPolicy:{get:function(){return this._tileProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._tileProvider.errorEvent}},ready:{get:function(){return this._tileProvider.ready}},readyPromise:{get:function(){return this._tileProvider.readyPromise}},credit:{get:function(){return this._tileProvider.credit}},hasAlphaChannel:{get:function(){return this._tileProvider.hasAlphaChannel}},enablePickFeatures:{get:function(){return this._tileProvider.enablePickFeatures},set:function(e){this._tileProvider.enablePickFeatures=e}}});h.prototype.getTileCredits=function(e,t,r){return this._tileProvider.getTileCredits(e,t,r)};h.prototype.requestImage=function(e,t,r,i){return this._tileProvider.requestImage(e,t,r,i)};h.prototype.pickFeatures=function(e,t,r,i,n){return this._tileProvider.pickFeatures(e,t,r,i,n)};h.DefaultParameters=a({service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"});h.GetFeatureInfoDefaultParameters=a({service:"WMS",version:"1.1.1",request:"GetFeatureInfo"});h.DefaultGetFeatureInfoFormats=a([a(new d("json","application/json")),a(new d("xml","text/xml")),a(new d("text","text/html"))]);function p(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[r.toLowerCase()]=e[r]}}return t}return h});define("Scene/WebMapTileServiceImageryProvider",["../Core/combine","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/freezeObject","../Core/isArray","../Core/objectToQuery","../Core/queryToObject","../Core/Rectangle","../Core/Request","../Core/RequestType","../Core/WebMercatorTilingScheme","../ThirdParty/Uri","../ThirdParty/when","./ImageryProvider","./TimeDynamicImagery"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_){"use strict";function y(e){e=r(e,r.EMPTY_OBJECT);if(!i(e.url)){throw new a("options.url is required.")}if(!i(e.layer)){throw new a("options.layer is required.")}if(!i(e.style)){throw new a("options.style is required.")}if(!i(e.tileMatrixSetID)){throw new a("options.tileMatrixSetID is required.")}if(i(e.times)&&!i(e.clock)){throw new a("options.times was specified, so options.clock is required.")}this._url=e.url;this._layer=e.layer;this._style=e.style;this._tileMatrixSetID=e.tileMatrixSetID;this._tileMatrixLabels=e.tileMatrixLabels;this._format=r(e.format,"image/jpeg");this._proxy=e.proxy;this._tileDiscardPolicy=e.tileDiscardPolicy;this._tilingScheme=i(e.tilingScheme)?e.tilingScheme:new p({ellipsoid:e.ellipsoid});this._tileWidth=r(e.tileWidth,256);this._tileHeight=r(e.tileHeight,256);this._minimumLevel=r(e.minimumLevel,0);this._maximumLevel=e.maximumLevel;this._rectangle=r(e.rectangle,this._tilingScheme.rectangle);this._dimensions=e.dimensions;var n=this;this._reload=undefined;if(i(e.times)){this._timeDynamicImagery=new _({clock:e.clock,times:e.times,requestImageFunction:function(e,t,r,i,a){return w(n,e,t,r,i,a)},reloadFunction:function(){if(i(n._reload)){n._reload()}}})}this._readyPromise=v.resolve(true);var s=this._tilingScheme.positionToTileXY(d.southwest(this._rectangle),this._minimumLevel);var u=this._tilingScheme.positionToTileXY(d.northeast(this._rectangle),this._minimumLevel);var c=(Math.abs(u.x-s.x)+1)*(Math.abs(u.y-s.y)+1);if(c>4){throw new a("The imagery provider's rectangle and minimumLevel indicate that there are "+c+" tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.")}this._errorEvent=new o;var f=e.credit;this._credit=typeof f==="string"?new t(f):f;this._subdomains=e.subdomains;if(l(this._subdomains)){this._subdomains=this._subdomains.slice()}else if(i(this._subdomains)&&this._subdomains.length>0){this._subdomains=this._subdomains.split("")}else{this._subdomains=["a","b","c"]}}var b=s({service:"WMTS",version:"1.0.0",request:"GetTile"});function w(t,n,a,o,s,l){var d=t._tileMatrixLabels;var f=i(d)?d[o]:o.toString();var h=t._subdomains;var p;var v;var _=t._dimensions;var y=i(l)?l.data:undefined;if(t._url.indexOf("{")>=0){p=t._url.replace("{style}",t._style).replace("{Style}",t._style).replace("{TileMatrixSet}",t._tileMatrixSetID).replace("{TileMatrix}",f).replace("{TileRow}",a.toString()).replace("{TileCol}",n.toString()).replace("{s}",h[(n+a+o)%h.length]);if(i(_)){for(v in _){if(_.hasOwnProperty(v)){p=p.replace("{"+v+"}",_[v])}}}if(i(y)){for(v in y){if(y.hasOwnProperty(v)){p=p.replace("{"+v+"}",y[v])}}}}else{var w=new m(t._url);var C=c(r(w.query,""));C=e(b,C);C.tilematrix=f;C.layer=t._layer;C.style=t._style;C.tilerow=a;C.tilecol=n;C.tilematrixset=t._tileMatrixSetID;C.format=t._format;if(i(_)){for(v in _){if(_.hasOwnProperty(v)){C[v]=_[v]}}}if(i(y)){for(v in y){if(y.hasOwnProperty(v)){C[v]=y[v]}}}w.query=u(C);p=w.toString()}var S=t._proxy;if(i(S)){p=S.getURL(p)}return g.loadImage(t,p,s)}n(y.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},ready:{value:true},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return true}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}},dimensions:{get:function(){return this._dimensions},set:function(e){if(this._dimensions!==e){this._dimensions=e;if(i(this._reload)){this._reload()}}}}});y.prototype.getTileCredits=function(e,t,r){return undefined};y.prototype.requestImage=function(e,t,r,n){var a;var o=this._timeDynamicImagery;var s;if(i(o)){s=o.currentInterval;a=o.getFromCache(e,t,r,n)}if(!i(a)){a=w(this,e,t,r,n,s)}if(i(a)&&i(o)){o.checkApproachingInterval(e,t,r,n)}return a};y.prototype.pickFeatures=function(e,t,r,i,n){return undefined};return y});define("ThirdParty/crunch",[],function(){var Module;if(!Module)Module=(typeof Module!=="undefined"?Module:null)||{};var moduleOverrides={};for(var key in Module){if(Module.hasOwnProperty(key)){moduleOverrides[key]=Module[key]}}var ENVIRONMENT_IS_WEB=typeof window==="object";var ENVIRONMENT_IS_WORKER=typeof importScripts==="function";var ENVIRONMENT_IS_NODE=typeof process==="object"&&typeof require==="function"&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER;var ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE){if(!Module["print"])Module["print"]=function e(t){process["stdout"].write(t+"\n")};if(!Module["printErr"])Module["printErr"]=function e(t){process["stderr"].write(t+"\n")};var nodeFS=require("fs");var nodePath=require("path");Module["read"]=function e(t,r){t=nodePath["normalize"](t);var i=nodeFS["readFileSync"](t);if(!i&&t!=nodePath["resolve"](t)){t=path.join(__dirname,"..","src",t);i=nodeFS["readFileSync"](t)}if(i&&!r)i=i.toString();return i};Module["readBinary"]=function e(t){var r=Module["read"](t,true);if(!r.buffer){r=new Uint8Array(r)}assert(r.buffer);return r};Module["load"]=function e(t){globalEval(read(t))};if(!Module["thisProgram"]){if(process["argv"].length>1){Module["thisProgram"]=process["argv"][1].replace(/\\/g,"/")}else{Module["thisProgram"]="unknown-program"}}Module["arguments"]=process["argv"].slice(2);if(typeof module!=="undefined"){module["exports"]=Module}process["on"]("uncaughtException",function(e){if(!(e instanceof ExitStatus)){throw e}});Module["inspect"]=function(){return"[Emscripten Module object]"}}else if(ENVIRONMENT_IS_SHELL){if(!Module["print"])Module["print"]=print;if(typeof printErr!="undefined")Module["printErr"]=printErr;if(typeof read!="undefined"){Module["read"]=read}else{Module["read"]=function e(){throw"no read() available (jsc?)"}}Module["readBinary"]=function e(t){if(typeof readbuffer==="function"){return new Uint8Array(readbuffer(t))}var r=read(t,"binary");assert(typeof r==="object");return r};if(typeof scriptArgs!="undefined"){Module["arguments"]=scriptArgs}else if(typeof arguments!="undefined"){Module["arguments"]=arguments}}else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){Module["read"]=function e(t){var r=new XMLHttpRequest;r.open("GET",t,false);r.send(null);return r.responseText};if(typeof arguments!="undefined"){Module["arguments"]=arguments}if(typeof console!=="undefined"){if(!Module["print"])Module["print"]=function e(t){console.log(t)};if(!Module["printErr"])Module["printErr"]=function e(t){console.log(t)}}else{var TRY_USE_DUMP=false;if(!Module["print"])Module["print"]=TRY_USE_DUMP&&typeof dump!=="undefined"?function(e){dump(e)}:function(e){}}if(ENVIRONMENT_IS_WORKER){Module["load"]=importScripts}if(typeof Module["setWindowTitle"]==="undefined"){Module["setWindowTitle"]=function(e){document.title=e}}}else{throw"Unknown runtime environment. Where are we?"}function globalEval(e){eval.call(null,e)}if(!Module["load"]&&Module["read"]){Module["load"]=function e(t){globalEval(Module["read"](t))}}if(!Module["print"]){Module["print"]=function(){}}if(!Module["printErr"]){Module["printErr"]=Module["print"]}if(!Module["arguments"]){Module["arguments"]=[]}if(!Module["thisProgram"]){Module["thisProgram"]="./this.program"}Module.print=Module["print"];Module.printErr=Module["printErr"];Module["preRun"]=[];Module["postRun"]=[];for(var key in moduleOverrides){if(moduleOverrides.hasOwnProperty(key)){Module[key]=moduleOverrides[key]}}var Runtime={setTempRet0:function(e){tempRet0=e},getTempRet0:function(){return tempRet0},stackSave:function(){return STACKTOP},stackRestore:function(e){STACKTOP=e},getNativeTypeSize:function(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:{if(e[e.length-1]==="*"){return Runtime.QUANTUM_SIZE}else if(e[0]==="i"){var t=parseInt(e.substr(1));assert(t%8===0);return t/8}else{return 0}}}},getNativeFieldSize:function(e){return Math.max(Runtime.getNativeTypeSize(e),Runtime.QUANTUM_SIZE)},STACK_ALIGN:16,prepVararg:function(e,t){if(t==="double"||t==="i64"){if(e&7){assert((e&7)===4);e+=4}}else{assert((e&3)===0)}return e},getAlignSize:function(e,t,r){if(!r&&(e=="i64"||e=="double"))return 8;if(!e)return Math.min(t,8);return Math.min(t||(e?Runtime.getNativeFieldSize(e):0),Runtime.QUANTUM_SIZE)},dynCall:function(e,t,r){if(r&&r.length){if(!r.splice)r=Array.prototype.slice.call(r);r.splice(0,0,t);return Module["dynCall_"+e].apply(null,r)}else{return Module["dynCall_"+e].call(null,t)}},functionPointers:[],addFunction:function(e){for(var t=0;t<Runtime.functionPointers.length;t++){if(!Runtime.functionPointers[t]){Runtime.functionPointers[t]=e;return 2*(1+t)}}throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(e){Runtime.functionPointers[(e-2)/2]=null},warnOnce:function(e){if(!Runtime.warnOnce.shown)Runtime.warnOnce.shown={};if(!Runtime.warnOnce.shown[e]){Runtime.warnOnce.shown[e]=1;Module.printErr(e)}},funcWrappers:{},getFuncWrapper:function(e,t){assert(t);if(!Runtime.funcWrappers[t]){Runtime.funcWrappers[t]={}}var r=Runtime.funcWrappers[t];if(!r[e]){r[e]=function r(){return Runtime.dynCall(t,e,arguments)}}return r[e]},getCompilerSetting:function(e){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(e){var t=STACKTOP;STACKTOP=STACKTOP+e|0;STACKTOP=STACKTOP+15&-16;return t},staticAlloc:function(e){var t=STATICTOP;STATICTOP=STATICTOP+e|0;STATICTOP=STATICTOP+15&-16;return t},dynamicAlloc:function(e){var t=DYNAMICTOP;DYNAMICTOP=DYNAMICTOP+e|0;DYNAMICTOP=DYNAMICTOP+15&-16;if(DYNAMICTOP>=TOTAL_MEMORY){var r=enlargeMemory();if(!r){DYNAMICTOP=t;return 0}}return t},alignMemory:function(e,t){var r=e=Math.ceil(e/(t?t:16))*(t?t:16);return r},makeBigInt:function(e,t,r){var i=r?+(e>>>0)+ +(t>>>0)*+4294967296:+(e>>>0)+ +(t|0)*+4294967296;return i},GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};Module["Runtime"]=Runtime;var __THREW__=0;var ABORT=false;var EXITSTATUS=0;var undef=0;var tempValue,tempInt,tempBigInt,tempInt2,tempBigInt2,tempPair,tempBigIntI,tempBigIntR,tempBigIntS,tempBigIntP,tempBigIntD,tempDouble,tempFloat;var tempI64,tempI64b;var tempRet0,tempRet1,tempRet2,tempRet3,tempRet4,tempRet5,tempRet6,tempRet7,tempRet8,tempRet9;function assert(e,t){if(!e){abort("Assertion failed: "+t)}}var globalScope=this;function getCFunc(ident){var func=Module["_"+ident];if(!func){try{func=eval("_"+ident)}catch(e){}}assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)");return func}var cwrap,ccall;(function(){var JSfuncs={stackSave:function(){Runtime.stackSave()},stackRestore:function(){Runtime.stackRestore()},arrayToC:function(e){var t=Runtime.stackAlloc(e.length);writeArrayToMemory(e,t);return t},stringToC:function(e){var t=0;if(e!==null&&e!==undefined&&e!==0){t=Runtime.stackAlloc((e.length<<2)+1);writeStringToMemory(e,t)}return t}};var toC={string:JSfuncs["stringToC"],array:JSfuncs["arrayToC"]};ccall=function e(t,r,i,n,a){var o=getCFunc(t);var s=[];var l=0;if(n){for(var u=0;u<n.length;u++){var c=toC[i[u]];if(c){if(l===0)l=Runtime.stackSave();s[u]=c(n[u])}else{s[u]=n[u]}}}var d=o.apply(null,s);if(r==="string")d=Pointer_stringify(d);if(l!==0){if(a&&a.async){EmterpreterAsync.asyncFinalizers.push(function(){Runtime.stackRestore(l)});return}Runtime.stackRestore(l)}return d};var sourceRegex=/^function\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/;function parseJSFunc(e){var t=e.toString().match(sourceRegex).slice(1);return{arguments:t[0],body:t[1],returnValue:t[2]}}var JSsource={};for(var fun in JSfuncs){if(JSfuncs.hasOwnProperty(fun)){JSsource[fun]=parseJSFunc(JSfuncs[fun])}}cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident);var numericArgs=argTypes.every(function(e){return e==="number"});var numericRet=returnType!=="string";if(numericRet&&numericArgs){return cfunc}var argNames=argTypes.map(function(e,t){return"$"+t});var funcstr="(function("+argNames.join(",")+") {";var nargs=argTypes.length;if(!numericArgs){funcstr+="var stack = "+JSsource["stackSave"].body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if(type==="number")continue;var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";";funcstr+=convertCode.body+";";funcstr+=arg+"="+convertCode.returnValue+";"}}var cfuncname=parseJSFunc(function(){return cfunc}).returnValue;funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");";if(!numericRet){var strgfy=parseJSFunc(function(){return Pointer_stringify}).returnValue;funcstr+="ret = "+strgfy+"(ret);"}if(!numericArgs){funcstr+=JSsource["stackRestore"].body.replace("()","(stack)")+";"}funcstr+="return ret})";return eval(funcstr)}})();Module["ccall"]=ccall;Module["cwrap"]=cwrap;function setValue(e,t,r,i){r=r||"i8";if(r.charAt(r.length-1)==="*")r="i32";switch(r){case"i1":HEAP8[e>>0]=t;break;case"i8":HEAP8[e>>0]=t;break;case"i16":HEAP16[e>>1]=t;break;case"i32":HEAP32[e>>2]=t;break;case"i64":tempI64=[t>>>0,(tempDouble=t,+Math_abs(tempDouble)>=+1?tempDouble>+0?(Math_min(+Math_floor(tempDouble/+4294967296),+4294967295)|0)>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/+4294967296)>>>0:0)],HEAP32[e>>2]=tempI64[0],HEAP32[e+4>>2]=tempI64[1];break;case"float":HEAPF32[e>>2]=t;break;case"double":HEAPF64[e>>3]=t;break;default:abort("invalid type for setValue: "+r)}}Module["setValue"]=setValue;function getValue(e,t,r){t=t||"i8";if(t.charAt(t.length-1)==="*")t="i32";switch(t){case"i1":return HEAP8[e>>0];case"i8":return HEAP8[e>>0];case"i16":return HEAP16[e>>1];case"i32":return HEAP32[e>>2];case"i64":return HEAP32[e>>2];case"float":return HEAPF32[e>>2];case"double":return HEAPF64[e>>3];default:abort("invalid type for setValue: "+t)}return null}Module["getValue"]=getValue;var ALLOC_NORMAL=0;var ALLOC_STACK=1;var ALLOC_STATIC=2;var ALLOC_DYNAMIC=3;var ALLOC_NONE=4;Module["ALLOC_NORMAL"]=ALLOC_NORMAL;Module["ALLOC_STACK"]=ALLOC_STACK;Module["ALLOC_STATIC"]=ALLOC_STATIC;Module["ALLOC_DYNAMIC"]=ALLOC_DYNAMIC;Module["ALLOC_NONE"]=ALLOC_NONE;function allocate(e,t,r,i){var n,a;if(typeof e==="number"){n=true;a=e}else{n=false;a=e.length}var o=typeof t==="string"?t:null;var s;if(r==ALLOC_NONE){s=i}else{s=[_malloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][r===undefined?ALLOC_STATIC:r](Math.max(a,o?1:t.length))}if(n){var i=s,l;assert((s&3)==0);l=s+(a&~3);for(;i<l;i+=4){HEAP32[i>>2]=0}l=s+a;while(i<l){HEAP8[i++>>0]=0}return s}if(o==="i8"){if(e.subarray||e.slice){HEAPU8.set(e,s)}else{HEAPU8.set(new Uint8Array(e),s)}return s}var u=0,c,d,f;while(u<a){var h=e[u];if(typeof h==="function"){h=Runtime.getFunctionIndex(h)}c=o||t[u];if(c===0){u++;continue}if(c=="i64")c="i32";setValue(s+u,h,c);if(f!==c){d=Runtime.getNativeTypeSize(c);f=c}u+=d}return s}Module["allocate"]=allocate;function getMemory(e){if(!staticSealed)return Runtime.staticAlloc(e);if(typeof _sbrk!=="undefined"&&!_sbrk.called||!runtimeInitialized)return Runtime.dynamicAlloc(e);return _malloc(e)}Module["getMemory"]=getMemory;function Pointer_stringify(e,t){if(t===0||!e)return"";var r=0;var i;var n=0;while(1){i=HEAPU8[e+n>>0];r|=i;if(i==0&&!t)break;n++;if(t&&n==t)break}if(!t)t=n;var a="";if(r<128){var o=1024;var s;while(t>0){s=String.fromCharCode.apply(String,HEAPU8.subarray(e,e+Math.min(t,o)));a=a?a+s:s;e+=o;t-=o}return a}return Module["UTF8ToString"](e)}Module["Pointer_stringify"]=Pointer_stringify;function AsciiToString(e){var t="";while(1){var r=HEAP8[e++>>0];if(!r)return t;t+=String.fromCharCode(r)}}Module["AsciiToString"]=AsciiToString;function stringToAscii(e,t){return writeAsciiToMemory(e,t,false)}Module["stringToAscii"]=stringToAscii;function UTF8ArrayToString(e,t){var r,i,n,a,o,s;var l="";while(1){r=e[t++];if(!r)return l;if(!(r&128)){l+=String.fromCharCode(r);continue}i=e[t++]&63;if((r&224)==192){l+=String.fromCharCode((r&31)<<6|i);continue}n=e[t++]&63;if((r&240)==224){r=(r&15)<<12|i<<6|n}else{a=e[t++]&63;if((r&248)==240){r=(r&7)<<18|i<<12|n<<6|a}else{o=e[t++]&63;if((r&252)==248){r=(r&3)<<24|i<<18|n<<12|a<<6|o}else{s=e[t++]&63;r=(r&1)<<30|i<<24|n<<18|a<<12|o<<6|s}}}if(r<65536){l+=String.fromCharCode(r)}else{var u=r-65536;l+=String.fromCharCode(55296|u>>10,56320|u&1023)}}}Module["UTF8ArrayToString"]=UTF8ArrayToString;function UTF8ToString(e){return UTF8ArrayToString(HEAPU8,e)}Module["UTF8ToString"]=UTF8ToString;function stringToUTF8Array(e,t,r,i){if(!(i>0))return 0;var n=r;var a=r+i-1;for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s>=55296&&s<=57343)s=65536+((s&1023)<<10)|e.charCodeAt(++o)&1023;if(s<=127){if(r>=a)break;t[r++]=s}else if(s<=2047){if(r+1>=a)break;t[r++]=192|s>>6;t[r++]=128|s&63}else if(s<=65535){if(r+2>=a)break;t[r++]=224|s>>12;t[r++]=128|s>>6&63;t[r++]=128|s&63}else if(s<=2097151){if(r+3>=a)break;t[r++]=240|s>>18;t[r++]=128|s>>12&63;t[r++]=128|s>>6&63;t[r++]=128|s&63}else if(s<=67108863){if(r+4>=a)break;t[r++]=248|s>>24;t[r++]=128|s>>18&63;t[r++]=128|s>>12&63;t[r++]=128|s>>6&63;t[r++]=128|s&63}else{if(r+5>=a)break;t[r++]=252|s>>30;t[r++]=128|s>>24&63;t[r++]=128|s>>18&63;t[r++]=128|s>>12&63;t[r++]=128|s>>6&63;t[r++]=128|s&63}}t[r]=0;return r-n}Module["stringToUTF8Array"]=stringToUTF8Array;function stringToUTF8(e,t,r){return stringToUTF8Array(e,HEAPU8,t,r)}Module["stringToUTF8"]=stringToUTF8;function lengthBytesUTF8(e){var t=0;for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);if(i>=55296&&i<=57343)i=65536+((i&1023)<<10)|e.charCodeAt(++r)&1023;if(i<=127){++t}else if(i<=2047){t+=2}else if(i<=65535){t+=3}else if(i<=2097151){t+=4}else if(i<=67108863){t+=5}else{t+=6}}return t}Module["lengthBytesUTF8"]=lengthBytesUTF8;function UTF16ToString(e){var t=0;var r="";while(1){var i=HEAP16[e+t*2>>1];if(i==0)return r;++t;r+=String.fromCharCode(i)}}Module["UTF16ToString"]=UTF16ToString;function stringToUTF16(e,t,r){if(r===undefined){r=2147483647}if(r<2)return 0;r-=2;var i=t;var n=r<e.length*2?r/2:e.length;for(var a=0;a<n;++a){var o=e.charCodeAt(a);HEAP16[t>>1]=o;t+=2}HEAP16[t>>1]=0;return t-i}Module["stringToUTF16"]=stringToUTF16;function lengthBytesUTF16(e){return e.length*2}Module["lengthBytesUTF16"]=lengthBytesUTF16;function UTF32ToString(e){var t=0;var r="";while(1){var i=HEAP32[e+t*4>>2];if(i==0)return r;++t;if(i>=65536){var n=i-65536;r+=String.fromCharCode(55296|n>>10,56320|n&1023)}else{r+=String.fromCharCode(i)}}}Module["UTF32ToString"]=UTF32ToString;function stringToUTF32(e,t,r){if(r===undefined){r=2147483647}if(r<4)return 0;var i=t;var n=i+r-4;for(var a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343){var s=e.charCodeAt(++a);o=65536+((o&1023)<<10)|s&1023}HEAP32[t>>2]=o;t+=4;if(t+4>n)break}HEAP32[t>>2]=0;return t-i}Module["stringToUTF32"]=stringToUTF32;function lengthBytesUTF32(e){var t=0;for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);if(i>=55296&&i<=57343)++r;t+=4}return t}Module["lengthBytesUTF32"]=lengthBytesUTF32;function demangle(e){var t=!!Module["___cxa_demangle"];if(t){try{var r=_malloc(e.length);writeStringToMemory(e.substr(1),r);var i=_malloc(4);var n=Module["___cxa_demangle"](r,0,0,i);if(getValue(i,"i32")===0&&n){return Pointer_stringify(n)}}catch(e){}finally{if(r)_free(r);if(i)_free(i);if(n)_free(n)}}var a=3;var o={v:"void",b:"bool",c:"char",s:"short",i:"int",l:"long",f:"float",d:"double",w:"wchar_t",a:"signed char",h:"unsigned char",t:"unsigned short",j:"unsigned int",m:"unsigned long",x:"long long",y:"unsigned long long",z:"..."};var s=[];var l=true;function u(t){if(t)Module.print(t);Module.print(e);var r="";for(var i=0;i<a;i++)r+=" ";Module.print(r+"^")}function c(){a++;if(e[a]==="K")a++;var t=[];while(e[a]!=="E"){if(e[a]==="S"){a++;var r=e.indexOf("_",a);var i=e.substring(a,r)||0;t.push(s[i]||"?");a=r+1;continue}if(e[a]==="C"){t.push(t[t.length-1]);a+=2;continue}var n=parseInt(e.substr(a));var o=n.toString().length;if(!n||!o){a--;break}var l=e.substr(a+o,n);t.push(l);s.push(l);a+=o+n}a++;return t}function d(t,r,i){r=r||Infinity;var n="",s=[];function u(){return"("+s.join(", ")+")"}var f;if(e[a]==="N"){f=c().join("::");r--;if(r===0)return t?[f]:f}else{if(e[a]==="K"||l&&e[a]==="L")a++;var h=parseInt(e.substr(a));if(h){var p=h.toString().length;f=e.substr(a+p,h);a+=p+h}}l=false;if(e[a]==="I"){a++;var m=d(true);var v=d(true,1,true);n+=v[0]+" "+f+"<"+m.join(", ")+">"}else{n=f}e:while(a<e.length&&r-- >0){var g=e[a++];if(g in o){s.push(o[g])}else{switch(g){case"P":s.push(d(true,1,true)[0]+"*");break;case"R":s.push(d(true,1,true)[0]+"&");break;case"L":{a++;var _=e.indexOf("E",a);var h=_-a;s.push(e.substr(a,h));a+=h+2;break};case"A":{var h=parseInt(e.substr(a));a+=h.toString().length;if(e[a]!=="_")throw"?";a++;s.push(d(true,1,true)[0]+" ["+h+"]");break};case"E":break e;default:n+="?"+g;break e}}}if(!i&&s.length===1&&s[0]==="void")s=[];if(t){if(n){s.push(n+"?")}return s}else{return n+u()}}var f=e;try{if(e=="Object._main"||e=="_main"){return"main()"}if(typeof e==="number")e=Pointer_stringify(e);if(e[0]!=="_")return e;if(e[1]!=="_")return e;if(e[2]!=="Z")return e;switch(e[3]){case"n":return"operator new()";case"d":return"operator delete()"}f=d()}catch(e){f+="?"}if(f.indexOf("?")>=0&&!t){Runtime.warnOnce("warning: a problem occurred in builtin C++ name demangling; build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling")}return f}function demangleAll(e){return e.replace(/__Z[\w\d_]+/g,function(e){var t=demangle(e);return e===t?e:e+" ["+t+"]"})}function jsStackTrace(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack){return"(no stack trace available)"}}return e.stack.toString()}function stackTrace(){return demangleAll(jsStackTrace())}Module["stackTrace"]=stackTrace;var PAGE_SIZE=4096;function alignMemoryPage(e){if(e%4096>0){e+=4096-e%4096}return e}var HEAP;var HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;var STATIC_BASE=0,STATICTOP=0,staticSealed=false;var STACK_BASE=0,STACKTOP=0,STACK_MAX=0;var DYNAMIC_BASE=0,DYNAMICTOP=0;function enlargeMemory(){var e=TOTAL_MEMORY;var t=Math.pow(2,31);if(DYNAMICTOP>=t)return false;while(TOTAL_MEMORY<=DYNAMICTOP){if(TOTAL_MEMORY<t/2){TOTAL_MEMORY=alignMemoryPage(2*TOTAL_MEMORY)}else{var r=TOTAL_MEMORY;TOTAL_MEMORY=alignMemoryPage((3*TOTAL_MEMORY+t)/4);if(TOTAL_MEMORY<=r)return false}}TOTAL_MEMORY=Math.max(TOTAL_MEMORY,16*1024*1024);if(TOTAL_MEMORY>=t)return false;try{if(ArrayBuffer.transfer){buffer=ArrayBuffer.transfer(buffer,TOTAL_MEMORY)}else{var i=HEAP8;buffer=new ArrayBuffer(TOTAL_MEMORY)}}catch(e){return false}var n=_emscripten_replace_memory(buffer);if(!n)return false;Module["buffer"]=buffer;Module["HEAP8"]=HEAP8=new Int8Array(buffer);Module["HEAP16"]=HEAP16=new Int16Array(buffer);Module["HEAP32"]=HEAP32=new Int32Array(buffer);Module["HEAPU8"]=HEAPU8=new Uint8Array(buffer);Module["HEAPU16"]=HEAPU16=new Uint16Array(buffer);Module["HEAPU32"]=HEAPU32=new Uint32Array(buffer);Module["HEAPF32"]=HEAPF32=new Float32Array(buffer);Module["HEAPF64"]=HEAPF64=new Float64Array(buffer);if(!ArrayBuffer.transfer){HEAP8.set(i)}return true}var byteLength;try{byteLength=Function.prototype.call.bind(Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get);byteLength(new ArrayBuffer(4))}catch(e){byteLength=function(e){return e.byteLength}}var TOTAL_STACK=Module["TOTAL_STACK"]||5242880;var TOTAL_MEMORY=Module["TOTAL_MEMORY"]||16777216;var totalMemory=64*1024;while(totalMemory<TOTAL_MEMORY||totalMemory<2*TOTAL_STACK){if(totalMemory<16*1024*1024){totalMemory*=2}else{totalMemory+=16*1024*1024}}totalMemory=Math.max(totalMemory,16*1024*1024);if(totalMemory!==TOTAL_MEMORY){TOTAL_MEMORY=totalMemory}assert(typeof Int32Array!=="undefined"&&typeof Float64Array!=="undefined"&&!!new Int32Array(1)["subarray"]&&!!new Int32Array(1)["set"],"JS engine does not provide full typed array support");var buffer;buffer=new ArrayBuffer(TOTAL_MEMORY);HEAP8=new Int8Array(buffer);HEAP16=new Int16Array(buffer);HEAP32=new Int32Array(buffer);HEAPU8=new Uint8Array(buffer);HEAPU16=new Uint16Array(buffer);HEAPU32=new Uint32Array(buffer);HEAPF32=new Float32Array(buffer);HEAPF64=new Float64Array(buffer);HEAP32[0]=255;assert(HEAPU8[0]===255&&HEAPU8[3]===0,"Typed arrays 2 must be run on a little-endian system");Module["HEAP"]=HEAP;Module["buffer"]=buffer;Module["HEAP8"]=HEAP8;Module["HEAP16"]=HEAP16;Module["HEAP32"]=HEAP32;Module["HEAPU8"]=HEAPU8;Module["HEAPU16"]=HEAPU16;Module["HEAPU32"]=HEAPU32;Module["HEAPF32"]=HEAPF32;Module["HEAPF64"]=HEAPF64;function callRuntimeCallbacks(e){while(e.length>0){var t=e.shift();if(typeof t=="function"){t();continue}var r=t.func;if(typeof r==="number"){if(t.arg===undefined){Runtime.dynCall("v",r)}else{Runtime.dynCall("vi",r,[t.arg])}}else{r(t.arg===undefined?null:t.arg)}}}var __ATPRERUN__=[];var __ATINIT__=[];var __ATMAIN__=[];var __ATEXIT__=[];var __ATPOSTRUN__=[];var runtimeInitialized=false;var runtimeExited=false;function preRun(){if(Module["preRun"]){if(typeof Module["preRun"]=="function")Module["preRun"]=[Module["preRun"]];while(Module["preRun"].length){addOnPreRun(Module["preRun"].shift())}}callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){if(runtimeInitialized)return;runtimeInitialized=true;callRuntimeCallbacks(__ATINIT__)}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__);runtimeExited=true}function postRun(){if(Module["postRun"]){if(typeof Module["postRun"]=="function")Module["postRun"]=[Module["postRun"]];while(Module["postRun"].length){addOnPostRun(Module["postRun"].shift())}}callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(e){__ATPRERUN__.unshift(e)}Module["addOnPreRun"]=addOnPreRun;function addOnInit(e){__ATINIT__.unshift(e)}Module["addOnInit"]=addOnInit;function addOnPreMain(e){__ATMAIN__.unshift(e)}Module["addOnPreMain"]=addOnPreMain;function addOnExit(e){__ATEXIT__.unshift(e)}Module["addOnExit"]=addOnExit;function addOnPostRun(e){__ATPOSTRUN__.unshift(e)}Module["addOnPostRun"]=addOnPostRun;function intArrayFromString(e,t,r){var i=r>0?r:lengthBytesUTF8(e)+1;var n=new Array(i);var a=stringToUTF8Array(e,n,0,n.length);if(t)n.length=a;return n}Module["intArrayFromString"]=intArrayFromString;function intArrayToString(e){var t=[];for(var r=0;r<e.length;r++){var i=e[r];if(i>255){i&=255}t.push(String.fromCharCode(i))}return t.join("")}Module["intArrayToString"]=intArrayToString;function writeStringToMemory(e,t,r){var i=intArrayFromString(e,r);var n=0;while(n<i.length){var a=i[n];HEAP8[t+n>>0]=a;n=n+1}}Module["writeStringToMemory"]=writeStringToMemory;function writeArrayToMemory(e,t){for(var r=0;r<e.length;r++){HEAP8[t++>>0]=e[r]}}Module["writeArrayToMemory"]=writeArrayToMemory;function writeAsciiToMemory(e,t,r){for(var i=0;i<e.length;++i){HEAP8[t++>>0]=e.charCodeAt(i)}if(!r)HEAP8[t>>0]=0}Module["writeAsciiToMemory"]=writeAsciiToMemory;function unSign(e,t,r){if(e>=0){return e}return t<=32?2*Math.abs(1<<t-1)+e:Math.pow(2,t)+e}function reSign(e,t,r){if(e<=0){return e}var i=t<=32?Math.abs(1<<t-1):Math.pow(2,t-1);if(e>=i&&(t<=32||e>i)){e=-2*i+e}return e}if(!Math["imul"]||Math["imul"](4294967295,5)!==-5)Math["imul"]=function e(t,r){var i=t>>>16;var n=t&65535;var a=r>>>16;var o=r&65535;return n*o+(i*o+n*a<<16)|0};Math.imul=Math["imul"];if(!Math["clz32"])Math["clz32"]=function(e){e=e>>>0;for(var t=0;t<32;t++){if(e&1<<31-t)return t}return 32};Math.clz32=Math["clz32"];var Math_abs=Math.abs;var Math_cos=Math.cos;var Math_sin=Math.sin;var Math_tan=Math.tan;var Math_acos=Math.acos;var Math_asin=Math.asin;var Math_atan=Math.atan;var Math_atan2=Math.atan2;var Math_exp=Math.exp;var Math_log=Math.log;var Math_sqrt=Math.sqrt;var Math_ceil=Math.ceil;var Math_floor=Math.floor;var Math_pow=Math.pow;var Math_imul=Math.imul;var Math_fround=Math.fround;var Math_min=Math.min;var Math_clz32=Math.clz32;var runDependencies=0;var runDependencyWatcher=null;var dependenciesFulfilled=null;function getUniqueRunDependency(e){return e}function addRunDependency(e){runDependencies++;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies)}}Module["addRunDependency"]=addRunDependency;function removeRunDependency(e){runDependencies--;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies)}if(runDependencies==0){if(runDependencyWatcher!==null){clearInterval(runDependencyWatcher);runDependencyWatcher=null}if(dependenciesFulfilled){var t=dependenciesFulfilled;dependenciesFulfilled=null;t()}}}Module["removeRunDependency"]=removeRunDependency;Module["preloadedImages"]={};Module["preloadedAudios"]={};var memoryInitializer=null;var ASM_CONSTS=[];STATIC_BASE=8;STATICTOP=STATIC_BASE+5888;__ATINIT__.push();allocate([116,0,0,0,86,7,0,0,116,0,0,0,99,7,0,0,156,0,0,0,112,7,0,0,16,0,0,0,0,0,0,0,156,0,0,0,145,7,0,0,24,0,0,0,0,0,0,0,156,0,0,0,215,7,0,0,24,0,0,0,0,0,0,0,156,0,0,0,179,7,0,0,56,0,0,0,0,0,0,0,156,0,0,0,249,7,0,0,40,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,40,0,0,0,1,0,0,0,2,0,0,0,3,0,0,0,4,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,88,0,0,0,1,0,0,0,5,0,0,0,3,0,0,0,4,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,108,1,0,0,220,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,4,0,0,0,227,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,4,0,0,0,219,16,0,0,0,4,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,37,115,40,37,117,41,58,32,65,115,115,101,114,116,105,111,110,32,102,97,105,108,117,114,101,58,32,34,37,115,34,10,0,109,95,115,105,122,101,32,60,61,32,109,95,99,97,112,97,99,105,116,121,0,46,47,105,110,99,92,99,114,110,95,100,101,99,111,109,112,46,104,0,109,105,110,95,110,101,119,95,99,97,112,97,99,105,116,121,32,60,32,40,48,120,55,70,70,70,48,48,48,48,85,32,47,32,101,108,101,109,101,110,116,95,115,105,122,101,41,0,110,101,119,95,99,97,112,97,99,105,116,121,32,38,38,32,40,110,101,119,95,99,97,112,97,99,105,116,121,32,62,32,109,95,99,97,112,97,99,105,116,121,41,0,110,117,109,95,99,111,100,101,115,91,99,93,0,115,111,114,116,101,100,95,112,111,115,32,60,32,116,111,116,97,108,95,117,115,101,100,95,115,121,109,115,0,112,67,111,100,101,115,105,122,101,115,91,115,121,109,95,105,110,100,101,120,93,32,61,61,32,99,111,100,101,115,105,122,101,0,116,32,60,32,40,49,85,32,60,60,32,116,97,98,108,101,95,98,105,116,115,41,0,109,95,108,111,111,107,117,112,91,116,93,32,61,61,32,99,85,73,78,84,51,50,95,77,65,88,0,99,114,110,100,95,109,97,108,108,111,99,58,32,115,105,122,101,32,116,111,111,32,98,105,103,0,99,114,110,100,95,109,97,108,108,111,99,58,32,111,117,116,32,111,102,32,109,101,109,111,114,121,0,40,40,117,105,110,116,51,50,41,112,95,110,101,119,32,38,32,40,67,82,78,68,95,77,73,78,95,65,76,76,79,67,95,65,76,73,71,78,77,69,78,84,32,45,32,49,41,41,32,61,61,32,48,0,99,114,110,100,95,114,101,97,108,108,111,99,58,32,98,97,100,32,112,116,114,0,99,114,110,100,95,102,114,101,101,58,32,98,97,100,32,112,116,114,0,102,97,108,115,101,0,40,116,111,116,97,108,95,115,121,109,115,32,62,61,32,49,41,32,38,38,32,40,116,111,116,97,108,95,115,121,109,115,32,60,61,32,112,114,101,102,105,120,95,99,111,100,105,110,103,58,58,99,77,97,120,83,117,112,112,111,114,116,101,100,83,121,109,115,41,0,17,18,19,20,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15,16,48,0,110,117,109,95,98,105,116,115,32,60,61,32,51,50,85,0,109,95,98,105,116,95,99,111,117,110,116,32,60,61,32,99,66,105,116,66,117,102,83,105,122,101,0,116,32,33,61,32,99,85,73,78,84,51,50,95,77,65,88,0,109,111,100,101,108,46,109,95,99,111,100,101,95,115,105,122,101,115,91,115,121,109,93,32,61,61,32,108,101,110,0,0,2,3,1,0,2,3,4,5,6,7,1,40,108,101,110,32,62,61,32,49,41,32,38,38,32,40,108,101,110,32,60,61,32,99,77,97,120,69,120,112,101,99,116,101,100,67,111,100,101,83,105,122,101,41,0,105,32,60,32,109,95,115,105,122,101,0,110,101,120,116,95,108,101,118,101,108,95,111,102,115,32,62,32,99,117,114,95,108,101,118,101,108,95,111,102,115,0,1,2,2,3,3,3,3,4,0,0,0,0,0,0,1,1,0,1,0,1,0,0,1,2,1,2,0,0,0,1,0,2,1,0,2,0,0,1,2,3,110,117,109,32,38,38,32,40,110,117,109,32,61,61,32,126,110,117,109,95,99,104,101,99,107,41,0,83,116,57,101,120,99,101,112,116,105,111,110,0,83,116,57,116,121,112,101,95,105,110,102,111,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,54,95,95,115,104,105,109,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,57,95,95,112,111,105,110,116,101,114,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,112,98,97,115,101,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,48,95,95,115,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,112,116,104,114,101,97,100,95,111,110,99,101,32,102,97,105,108,117,114,101,32,105,110,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,95,102,97,115,116,40,41,0,116,101,114,109,105,110,97,116,101,95,104,97,110,100,108,101,114,32,117,110,101,120,112,101,99,116,101,100,108,121,32,114,101,116,117,114,110,101,100,0,99,97,110,110,111,116,32,99,114,101,97,116,101,32,112,116,104,114,101,97,100,32,107,101,121,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,99,97,110,110,111,116,32,122,101,114,111,32,111,117,116,32,116,104,114,101,97,100,32,118,97,108,117,101,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,58,32,37,115,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,102,111,114,101,105,103,110,32,101,120,99,101,112,116,105,111,110,0,116,101,114,109,105,110,97,116,105,110,103,0,117,110,99,97,117,103,104,116,0,84,33,34,25,13,1,2,3,17,75,28,12,16,4,11,29,18,30,39,104,110,111,112,113,98,32,5,6,15,19,20,21,26,8,22,7,40,36,23,24,9,10,14,27,31,37,35,131,130,125,38,42,43,60,61,62,63,67,71,74,77,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,114,115,116,121,122,123,124,0,73,108,108,101,103,97,108,32,98,121,116,101,32,115,101,113,117,101,110,99,101,0,68,111,109,97,105,110,32,101,114,114,111,114,0,82,101,115,117,108,116,32,110,111,116,32,114,101,112,114,101,115,101,110,116,97,98,108,101,0,78,111,116,32,97,32,116,116,121,0,80,101,114,109,105,115,115,105,111,110,32,100,101,110,105,101,100,0,79,112,101,114,97,116,105,111,110,32,110,111,116,32,112,101,114,109,105,116,116,101,100,0,78,111,32,115,117,99,104,32,102,105,108,101,32,111,114,32,100,105,114,101,99,116,111,114,121,0,78,111,32,115,117,99,104,32,112,114,111,99,101,115,115,0,70,105,108,101,32,101,120,105,115,116,115,0,86,97,108,117,101,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,100,97,116,97,32,116,121,112,101,0,78,111,32,115,112,97,99,101,32,108,101,102,116,32,111,110,32,100,101,118,105,99,101,0,79,117,116,32,111,102,32,109,101,109,111,114,121,0,82,101,115,111,117,114,99,101,32,98,117,115,121,0,73,110,116,101,114,114,117,112,116,101,100,32,115,121,115,116,101,109,32,99,97,108,108,0,82,101,115,111,117,114,99,101,32,116,101,109,112,111,114,97,114,105,108,121,32,117,110,97,118,97,105,108,97,98,108,101,0,73,110,118,97,108,105,100,32,115,101,101,107,0,67,114,111,115,115,45,100,101,118,105,99,101,32,108,105,110,107,0,82,101,97,100,45,111,110,108,121,32,102,105,108,101,32,115,121,115,116,101,109,0,68,105,114,101,99,116,111,114,121,32,110,111,116,32,101,109,112,116,121,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,112,101,101,114,0,79,112,101,114,97,116,105,111,110,32,116,105,109,101,100,32,111,117,116,0,67,111,110,110,101,99,116,105,111,110,32,114,101,102,117,115,101,100,0,72,111,115,116,32,105,115,32,100,111,119,110,0,72,111,115,116,32,105,115,32,117,110,114,101,97,99,104,97,98,108,101,0,65,100,100,114,101,115,115,32,105,110,32,117,115,101,0,66,114,111,107,101,110,32,112,105,112,101,0,73,47,79,32,101,114,114,111,114,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,32,111,114,32,97,100,100,114,101,115,115,0,66,108,111,99,107,32,100,101,118,105,99,101,32,114,101,113,117,105,114,101,100,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,0,78,111,116,32,97,32,100,105,114,101,99,116,111,114,121,0,73,115,32,97,32,100,105,114,101,99,116,111,114,121,0,84,101,120,116,32,102,105,108,101,32,98,117,115,121,0,69,120,101,99,32,102,111,114,109,97,116,32,101,114,114,111,114,0,73,110,118,97,108,105,100,32,97,114,103,117,109,101,110,116,0,65,114,103,117,109,101,110,116,32,108,105,115,116,32,116,111,111,32,108,111,110,103,0,83,121,109,98,111,108,105,99,32,108,105,110,107,32,108,111,111,112,0,70,105,108,101,110,97,109,101,32,116,111,111,32,108,111,110,103,0,84,111,111,32,109,97,110,121,32,111,112,101,110,32,102,105,108,101,115,32,105,110,32,115,121,115,116,101,109,0,78,111,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,115,32,97,118,97,105,108,97,98,108,101,0,66,97,100,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,0,78,111,32,99,104,105,108,100,32,112,114,111,99,101,115,115,0,66,97,100,32,97,100,100,114,101,115,115,0,70,105,108,101,32,116,111,111,32,108,97,114,103,101,0,84,111,111,32,109,97,110,121,32,108,105,110,107,115,0,78,111,32,108,111,99,107,115,32,97,118,97,105,108,97,98,108,101,0,82,101,115,111,117,114,99,101,32,100,101,97,100,108,111,99,107,32,119,111,117,108,100,32,111,99,99,117,114,0,83,116,97,116,101,32,110,111,116,32,114,101,99,111,118,101,114,97,98,108,101,0,80,114,101,118,105,111,117,115,32,111,119,110,101,114,32,100,105,101,100,0,79,112,101,114,97,116,105,111,110,32,99,97,110,99,101,108,101,100,0,70,117,110,99,116,105,111,110,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,0,78,111,32,109,101,115,115,97,103,101,32,111,102,32,100,101,115,105,114,101,100,32,116,121,112,101,0,73,100,101,110,116,105,102,105,101,114,32,114,101,109,111,118,101,100,0,68,101,118,105,99,101,32,110,111,116,32,97,32,115,116,114,101,97,109,0,78,111,32,100,97,116,97,32,97,118,97,105,108,97,98,108,101,0,68,101,118,105,99,101,32,116,105,109,101,111,117,116,0,79,117,116,32,111,102,32,115,116,114,101,97,109,115,32,114,101,115,111,117,114,99,101,115,0,76,105,110,107,32,104,97,115,32,98,101,101,110,32,115,101,118,101,114,101,100,0,80,114,111,116,111,99,111,108,32,101,114,114,111,114,0,66,97,100,32,109,101,115,115,97,103,101,0,70,105,108,101,32,100,101,115,99,114,105,112,116,111,114,32,105,110,32,98,97,100,32,115,116,97,116,101,0,78,111,116,32,97,32,115,111,99,107,101,116,0,68,101,115,116,105,110,97,116,105,111,110,32,97,100,100,114,101,115,115,32,114,101,113,117,105,114,101,100,0,77,101,115,115,97,103,101,32,116,111,111,32,108,97,114,103,101,0,80,114,111,116,111,99,111,108,32,119,114,111,110,103,32,116,121,112,101,32,102,111,114,32,115,111,99,107,101,116,0,80,114,111,116,111,99,111,108,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,80,114,111,116,111,99,111,108,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,83,111,99,107,101,116,32,116,121,112,101,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,78,111,116,32,115,117,112,112,111,114,116,101,100,0,80,114,111,116,111,99,111,108,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,65,100,100,114,101,115,115,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,32,98,121,32,112,114,111,116,111,99,111,108,0,65,100,100,114,101,115,115,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,78,101,116,119,111,114,107,32,105,115,32,100,111,119,110,0,78,101,116,119,111,114,107,32,117,110,114,101,97,99,104,97,98,108,101,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,110,101,116,119,111,114,107,0,67,111,110,110,101,99,116,105,111,110,32,97,98,111,114,116,101,100,0,78,111,32,98,117,102,102,101,114,32,115,112,97,99,101,32,97,118,97,105,108,97,98,108,101,0,83,111,99,107,101,116,32,105,115,32,99,111,110,110,101,99,116,101,100,0,83,111,99,107,101,116,32,110,111,116,32,99,111,110,110,101,99,116,101,100,0,67,97,110,110,111,116,32,115,101,110,100,32,97,102,116,101,114,32,115,111,99,107,101,116,32,115,104,117,116,100,111,119,110,0,79,112,101,114,97,116,105,111,110,32,97,108,114,101,97,100,121,32,105,110,32,112,114,111,103,114,101,115,115,0,79,112,101,114,97,116,105,111,110,32,105,110,32,112,114,111,103,114,101,115,115,0,83,116,97,108,101,32,102,105,108,101,32,104,97,110,100,108,101,0,82,101,109,111,116,101,32,73,47,79,32,101,114,114,111,114,0,81,117,111,116,97,32,101,120,99,101,101,100,101,100,0,78,111,32,109,101,100,105,117,109,32,102,111,117,110,100,0,87,114,111,110,103,32,109,101,100,105,117,109,32,116,121,112,101,0,78,111,32,101,114,114,111,114,32,105,110,102,111,114,109,97,116,105,111,110,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,10,0,17,17,17,0,0,0,0,5,0,0,0,0,0,0,9,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,15,10,17,17,17,3,10,7,0,1,19,9,11,11,0,0,9,6,11,0,0,11,0,6,17,0,0,0,17,17,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,10,10,17,17,17,0,10,0,0,2,0,9,11,0,0,0,9,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,4,13,0,0,0,0,9,14,0,0,0,0,0,14,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,15,0,0,0,0,9,16,0,0,0,0,0,16,0,0,16,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,10,0,0,0,0,9,11,0,0,0,0,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,45,43,32,32,32,48,88,48,120,0,40,110,117,108,108,41,0,45,48,88,43,48,88,32,48,88,45,48,120,43,48,120,32,48,120,0,105,110,102,0,73,78,70,0,110,97,110,0,78,65,78,0,46,0],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE);var tempDoublePtr=Runtime.alignMemory(allocate(12,"i8",ALLOC_STATIC),8);assert(tempDoublePtr%8==0);function copyTempFloat(e){HEAP8[tempDoublePtr]=HEAP8[e];HEAP8[tempDoublePtr+1]=HEAP8[e+1];HEAP8[tempDoublePtr+2]=HEAP8[e+2];HEAP8[tempDoublePtr+3]=HEAP8[e+3]}function copyTempDouble(e){HEAP8[tempDoublePtr]=HEAP8[e];HEAP8[tempDoublePtr+1]=HEAP8[e+1];HEAP8[tempDoublePtr+2]=HEAP8[e+2];HEAP8[tempDoublePtr+3]=HEAP8[e+3];HEAP8[tempDoublePtr+4]=HEAP8[e+4];HEAP8[tempDoublePtr+5]=HEAP8[e+5];HEAP8[tempDoublePtr+6]=HEAP8[e+6];HEAP8[tempDoublePtr+7]=HEAP8[e+7]}var _BDtoIHigh=true;Module["_i64Subtract"]=_i64Subtract;Module["_i64Add"]=_i64Add;function _pthread_cleanup_push(e,t){__ATEXIT__.push(function(){Runtime.dynCall("vi",e,[t])});_pthread_cleanup_push.level=__ATEXIT__.length}Module["_memset"]=_memset;var _BDtoILow=true;Module["_bitshift64Lshr"]=_bitshift64Lshr;Module["_bitshift64Shl"]=_bitshift64Shl;function _pthread_cleanup_pop(){assert(_pthread_cleanup_push.level==__ATEXIT__.length,"cannot pop if something else added meanwhile!");__ATEXIT__.pop();_pthread_cleanup_push.level=__ATEXIT__.length}function _abort(){Module["abort"]()}function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:function(e){if(!e||EXCEPTIONS.infos[e])return e;for(var t in EXCEPTIONS.infos){var r=EXCEPTIONS.infos[t];if(r.adjusted===e){return t}}return e},addRef:function(e){if(!e)return;var t=EXCEPTIONS.infos[e];t.refcount++},decRef:function(e){if(!e)return;var t=EXCEPTIONS.infos[e];assert(t.refcount>0);t.refcount--;if(t.refcount===0){if(t.destructor){Runtime.dynCall("vi",t.destructor,[e])}delete EXCEPTIONS.infos[e];___cxa_free_exception(e)}},clearRef:function(e){if(!e)return;var t=EXCEPTIONS.infos[e];t.refcount=0}};function ___cxa_begin_catch(e){__ZSt18uncaught_exceptionv.uncaught_exception--;EXCEPTIONS.caught.push(e);EXCEPTIONS.addRef(EXCEPTIONS.deAdjust(e));return e}function _pthread_once(e,t){if(!_pthread_once.seen)_pthread_once.seen={};if(e in _pthread_once.seen)return;Runtime.dynCall("v",t);_pthread_once.seen[e]=1}function _emscripten_memcpy_big(e,t,r){HEAPU8.set(HEAPU8.subarray(t,t+r),e);return e}Module["_memcpy"]=_memcpy;var SYSCALLS={varargs:0,get:function(e){SYSCALLS.varargs+=4;var t=HEAP32[SYSCALLS.varargs-4>>2];return t},getStr:function(){var e=Pointer_stringify(SYSCALLS.get());return e},get64:function(){var e=SYSCALLS.get(),t=SYSCALLS.get();if(e>=0)assert(t===0);else assert(t===-1);return e},getZero:function(){assert(SYSCALLS.get()===0)}};function ___syscall6(e,t){SYSCALLS.varargs=t;try{var r=SYSCALLS.getStreamFromFD();FS.close(r);return 0}catch(e){if(typeof FS==="undefined"||!(e instanceof FS.ErrnoError))abort(e);return-e.errno}}var PTHREAD_SPECIFIC={};function _pthread_getspecific(e){return PTHREAD_SPECIFIC[e]||0}function ___setErrNo(e){if(Module["___errno_location"])HEAP32[Module["___errno_location"]()>>2]=e;return e}var ERRNO_CODES={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};function _sysconf(e){switch(e){case 30:return PAGE_SIZE;case 85:return totalMemory/PAGE_SIZE;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 79:return 0;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:{if(typeof navigator==="object")return navigator["hardwareConcurrency"]||1;return 1}}___setErrNo(ERRNO_CODES.EINVAL);return-1}function _sbrk(e){var t=_sbrk;if(!t.called){DYNAMICTOP=alignMemoryPage(DYNAMICTOP);t.called=true;assert(Runtime.dynamicAlloc);t.alloc=Runtime.dynamicAlloc;Runtime.dynamicAlloc=function(){abort("cannot dynamically allocate, sbrk now has control")}}var r=DYNAMICTOP;if(e!=0){var i=t.alloc(e);if(!i)return-1>>>0}return r}var PTHREAD_SPECIFIC_NEXT_KEY=1;function _pthread_key_create(e,t){if(e==0){return ERRNO_CODES.EINVAL}HEAP32[e>>2]=PTHREAD_SPECIFIC_NEXT_KEY;PTHREAD_SPECIFIC[PTHREAD_SPECIFIC_NEXT_KEY]=0;PTHREAD_SPECIFIC_NEXT_KEY++;return 0}var _BItoD=true;var PATH=undefined;function _emscripten_set_main_loop_timing(e,t){Browser.mainLoop.timingMode=e;Browser.mainLoop.timingValue=t;if(!Browser.mainLoop.func){return 1}if(e==0){Browser.mainLoop.scheduler=function e(){setTimeout(Browser.mainLoop.runner,t)};Browser.mainLoop.method="timeout"}else if(e==1){Browser.mainLoop.scheduler=function e(){Browser.requestAnimationFrame(Browser.mainLoop.runner)};Browser.mainLoop.method="rAF"}else if(e==2){if(!window["setImmediate"]){var r=[];var i="__emcc";function n(e){if(e.source===window&&e.data===i){e.stopPropagation();r.shift()()}}window.addEventListener("message",n,true);window["setImmediate"]=function e(t){r.push(t);window.postMessage(i,"*")}}Browser.mainLoop.scheduler=function e(){window["setImmediate"](Browser.mainLoop.runner)};Browser.mainLoop.method="immediate"}return 0}function _emscripten_set_main_loop(e,t,r,i,n){Module["noExitRuntime"]=true;assert(!Browser.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters.");Browser.mainLoop.func=e;Browser.mainLoop.arg=i;var a=Browser.mainLoop.currentlyRunningMainloop;Browser.mainLoop.runner=function t(){if(ABORT)return;if(Browser.mainLoop.queue.length>0){var r=Date.now();var n=Browser.mainLoop.queue.shift();n.func(n.arg);if(Browser.mainLoop.remainingBlockers){var o=Browser.mainLoop.remainingBlockers;var s=o%1==0?o-1:Math.floor(o);if(n.counted){Browser.mainLoop.remainingBlockers=s}else{s=s+.5;Browser.mainLoop.remainingBlockers=(8*o+s)/9}}console.log('main loop blocker "'+n.name+'" took '+(Date.now()-r)+" ms");Browser.mainLoop.updateStatus();setTimeout(Browser.mainLoop.runner,0);return}if(a<Browser.mainLoop.currentlyRunningMainloop)return;Browser.mainLoop.currentFrameNumber=Browser.mainLoop.currentFrameNumber+1|0;if(Browser.mainLoop.timingMode==1&&Browser.mainLoop.timingValue>1&&Browser.mainLoop.currentFrameNumber%Browser.mainLoop.timingValue!=0){Browser.mainLoop.scheduler();return}if(Browser.mainLoop.method==="timeout"&&Module.ctx){Module.printErr("Looks like you are rendering without using requestAnimationFrame for the main loop. You should use 0 for the frame rate in emscripten_set_main_loop in order to use requestAnimationFrame, as that can greatly improve your frame rates!");Browser.mainLoop.method=""}Browser.mainLoop.runIter(function(){if(typeof i!=="undefined"){Runtime.dynCall("vi",e,[i])}else{Runtime.dynCall("v",e)}});if(a<Browser.mainLoop.currentlyRunningMainloop)return;if(typeof SDL==="object"&&SDL.audio&&SDL.audio.queueNewAudioData)SDL.audio.queueNewAudioData();Browser.mainLoop.scheduler()};if(!n){if(t&&t>0)_emscripten_set_main_loop_timing(0,1e3/t);else _emscripten_set_main_loop_timing(1,1);Browser.mainLoop.scheduler()}if(r){throw"SimulateInfiniteLoop"}}var Browser={mainLoop:{scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause:function(){Browser.mainLoop.scheduler=null;Browser.mainLoop.currentlyRunningMainloop++},resume:function(){Browser.mainLoop.currentlyRunningMainloop++;var e=Browser.mainLoop.timingMode;var t=Browser.mainLoop.timingValue;var r=Browser.mainLoop.func;Browser.mainLoop.func=null;_emscripten_set_main_loop(r,0,false,Browser.mainLoop.arg,true);_emscripten_set_main_loop_timing(e,t);Browser.mainLoop.scheduler()},updateStatus:function(){if(Module["setStatus"]){var e=Module["statusMessage"]||"Please wait...";var t=Browser.mainLoop.remainingBlockers;var r=Browser.mainLoop.expectedBlockers;if(t){if(t<r){Module["setStatus"](e+" ("+(r-t)+"/"+r+")")}else{Module["setStatus"](e)}}else{Module["setStatus"]("")}}},runIter:function(e){if(ABORT)return;if(Module["preMainLoop"]){var t=Module["preMainLoop"]();if(t===false){return}}try{e()}catch(e){if(e instanceof ExitStatus){return}else{if(e&&typeof e==="object"&&e.stack)Module.printErr("exception thrown: "+[e,e.stack]);throw e}}if(Module["postMainLoop"])Module["postMainLoop"]()}},isFullScreen:false,pointerLock:false,moduleContextCreatedCallbacks:[],workers:[],init:function(){if(!Module["preloadPlugins"])Module["preloadPlugins"]=[];if(Browser.initted)return;Browser.initted=true;try{new Blob;Browser.hasBlobConstructor=true}catch(e){Browser.hasBlobConstructor=false;console.log("warning: no blob constructor, cannot create blobs with mimetypes")}Browser.BlobBuilder=typeof MozBlobBuilder!="undefined"?MozBlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:!Browser.hasBlobConstructor?console.log("warning: no BlobBuilder"):null;Browser.URLObject=typeof window!="undefined"?window.URL?window.URL:window.webkitURL:undefined;if(!Module.noImageDecoding&&typeof Browser.URLObject==="undefined"){console.log("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available.");Module.noImageDecoding=true}var e={};e["canHandle"]=function e(t){return!Module.noImageDecoding&&/\.(jpg|jpeg|png|bmp)$/i.test(t)};e["handle"]=function e(t,r,i,n){var a=null;if(Browser.hasBlobConstructor){try{a=new Blob([t],{type:Browser.getMimetype(r)});if(a.size!==t.length){a=new Blob([new Uint8Array(t).buffer],{type:Browser.getMimetype(r)})}}catch(e){Runtime.warnOnce("Blob constructor present but fails: "+e+"; falling back to blob builder")}}if(!a){var o=new Browser.BlobBuilder;o.append(new Uint8Array(t).buffer);a=o.getBlob()}var s=Browser.URLObject.createObjectURL(a);var l=new Image;l.onload=function e(){assert(l.complete,"Image "+r+" could not be decoded");var n=document.createElement("canvas");n.width=l.width;n.height=l.height;var a=n.getContext("2d");a.drawImage(l,0,0);Module["preloadedImages"][r]=n;Browser.URLObject.revokeObjectURL(s);if(i)i(t)};l.onerror=function e(t){console.log("Image "+s+" could not be decoded");if(n)n()};l.src=s};Module["preloadPlugins"].push(e);var t={};t["canHandle"]=function e(t){return!Module.noAudioDecoding&&t.substr(-4)in{".ogg":1,".wav":1,".mp3":1}};t["handle"]=function e(t,r,i,n){var a=false;function o(e){if(a)return;a=true;Module["preloadedAudios"][r]=e;if(i)i(t)}function s(){if(a)return;a=true;Module["preloadedAudios"][r]=new Audio;if(n)n()}if(Browser.hasBlobConstructor){try{var l=new Blob([t],{type:Browser.getMimetype(r)})}catch(e){return s()}var u=Browser.URLObject.createObjectURL(l);var c=new Audio;c.addEventListener("canplaythrough",function(){o(c)},false);c.onerror=function e(i){if(a)return;console.log("warning: browser could not fully decode audio "+r+", trying slower base64 approach");function n(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r="=";var i="";var n=0;var a=0;for(var o=0;o<e.length;o++){n=n<<8|e[o];a+=8;while(a>=6){var s=n>>a-6&63;a-=6;i+=t[s]}}if(a==2){i+=t[(n&3)<<4];i+=r+r}else if(a==4){i+=t[(n&15)<<2];i+=r}return i}c.src="data:audio/x-"+r.substr(-3)+";base64,"+n(t);o(c)};c.src=u;Browser.safeSetTimeout(function(){o(c)},1e4)}else{return s()}};Module["preloadPlugins"].push(t);var r=Module["canvas"];function i(){Browser.pointerLock=document["pointerLockElement"]===r||document["mozPointerLockElement"]===r||document["webkitPointerLockElement"]===r||document["msPointerLockElement"]===r}if(r){r.requestPointerLock=r["requestPointerLock"]||r["mozRequestPointerLock"]||r["webkitRequestPointerLock"]||r["msRequestPointerLock"]||function(){};r.exitPointerLock=document["exitPointerLock"]||document["mozExitPointerLock"]||document["webkitExitPointerLock"]||document["msExitPointerLock"]||function(){};r.exitPointerLock=r.exitPointerLock.bind(document);document.addEventListener("pointerlockchange",i,false);document.addEventListener("mozpointerlockchange",i,false);document.addEventListener("webkitpointerlockchange",i,false);document.addEventListener("mspointerlockchange",i,false);if(Module["elementPointerLock"]){r.addEventListener("click",function(e){if(!Browser.pointerLock&&r.requestPointerLock){r.requestPointerLock();e.preventDefault()}},false)}}},createContext:function(e,t,r,i){if(t&&Module.ctx&&e==Module.canvas)return Module.ctx;var n;var a;if(t){var o={antialias:false,alpha:false};if(i){for(var s in i){o[s]=i[s]}}a=GL.createContext(e,o);if(a){n=GL.getContext(a).GLctx}e.style.backgroundColor="black"}else{n=e.getContext("2d")}if(!n)return null;if(r){if(!t)assert(typeof GLctx==="undefined","cannot set in module if GLctx is used, but we are a non-GL context that would replace it");Module.ctx=n;if(t)GL.makeContextCurrent(a);Module.useWebGL=t;Browser.moduleContextCreatedCallbacks.forEach(function(e){e()});Browser.init()}return n},destroyContext:function(e,t,r){},fullScreenHandlersInstalled:false,lockPointer:undefined,resizeCanvas:undefined,requestFullScreen:function(e,t,r){Browser.lockPointer=e;Browser.resizeCanvas=t;Browser.vrDevice=r;if(typeof Browser.lockPointer==="undefined")Browser.lockPointer=true;if(typeof Browser.resizeCanvas==="undefined")Browser.resizeCanvas=false;if(typeof Browser.vrDevice==="undefined")Browser.vrDevice=null;var i=Module["canvas"];function n(){Browser.isFullScreen=false;var e=i.parentNode;if((document["webkitFullScreenElement"]||document["webkitFullscreenElement"]||document["mozFullScreenElement"]||document["mozFullscreenElement"]||document["fullScreenElement"]||document["fullscreenElement"]||document["msFullScreenElement"]||document["msFullscreenElement"]||document["webkitCurrentFullScreenElement"])===e){i.cancelFullScreen=document["cancelFullScreen"]||document["mozCancelFullScreen"]||document["webkitCancelFullScreen"]||document["msExitFullscreen"]||document["exitFullscreen"]||function(){};i.cancelFullScreen=i.cancelFullScreen.bind(document);if(Browser.lockPointer)i.requestPointerLock();Browser.isFullScreen=true;if(Browser.resizeCanvas)Browser.setFullScreenCanvasSize()}else{e.parentNode.insertBefore(i,e);e.parentNode.removeChild(e);if(Browser.resizeCanvas)Browser.setWindowedCanvasSize()}if(Module["onFullScreen"])Module["onFullScreen"](Browser.isFullScreen);Browser.updateCanvasDimensions(i)}if(!Browser.fullScreenHandlersInstalled){Browser.fullScreenHandlersInstalled=true;document.addEventListener("fullscreenchange",n,false);document.addEventListener("mozfullscreenchange",n,false);document.addEventListener("webkitfullscreenchange",n,false);document.addEventListener("MSFullscreenChange",n,false)}var a=document.createElement("div");i.parentNode.insertBefore(a,i);a.appendChild(i);a.requestFullScreen=a["requestFullScreen"]||a["mozRequestFullScreen"]||a["msRequestFullscreen"]||(a["webkitRequestFullScreen"]?function(){a["webkitRequestFullScreen"](Element["ALLOW_KEYBOARD_INPUT"])}:null);if(r){a.requestFullScreen({vrDisplay:r})}else{a.requestFullScreen()}},nextRAF:0,fakeRequestAnimationFrame:function(e){var t=Date.now();if(Browser.nextRAF===0){Browser.nextRAF=t+1e3/60}else{while(t+2>=Browser.nextRAF){Browser.nextRAF+=1e3/60}}var r=Math.max(Browser.nextRAF-t,0);setTimeout(e,r)},requestAnimationFrame:function e(t){if(typeof window==="undefined"){Browser.fakeRequestAnimationFrame(t)}else{if(!window.requestAnimationFrame){window.requestAnimationFrame=window["requestAnimationFrame"]||window["mozRequestAnimationFrame"]||window["webkitRequestAnimationFrame"]||window["msRequestAnimationFrame"]||window["oRequestAnimationFrame"]||Browser.fakeRequestAnimationFrame}window.requestAnimationFrame(t)}},safeCallback:function(e){return function(){if(!ABORT)return e.apply(null,arguments)}},allowAsyncCallbacks:true,queuedAsyncCallbacks:[],pauseAsyncCallbacks:function(){Browser.allowAsyncCallbacks=false},resumeAsyncCallbacks:function(){Browser.allowAsyncCallbacks=true;if(Browser.queuedAsyncCallbacks.length>0){var e=Browser.queuedAsyncCallbacks;Browser.queuedAsyncCallbacks=[];e.forEach(function(e){e()})}},safeRequestAnimationFrame:function(e){return Browser.requestAnimationFrame(function(){if(ABORT)return;if(Browser.allowAsyncCallbacks){e()}else{Browser.queuedAsyncCallbacks.push(e)}})},safeSetTimeout:function(e,t){Module["noExitRuntime"]=true;return setTimeout(function(){if(ABORT)return;if(Browser.allowAsyncCallbacks){e()}else{Browser.queuedAsyncCallbacks.push(e)}},t)},safeSetInterval:function(e,t){Module["noExitRuntime"]=true;return setInterval(function(){if(ABORT)return;if(Browser.allowAsyncCallbacks){e()}},t)},getMimetype:function(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]},getUserMedia:function(e){if(!window.getUserMedia){window.getUserMedia=navigator["getUserMedia"]||navigator["mozGetUserMedia"]}window.getUserMedia(e)},getMovementX:function(e){return e["movementX"]||e["mozMovementX"]||e["webkitMovementX"]||0},getMovementY:function(e){return e["movementY"]||e["mozMovementY"]||e["webkitMovementY"]||0},getMouseWheelDelta:function(e){var t=0;switch(e.type){case"DOMMouseScroll":t=e.detail;break;case"mousewheel":t=e.wheelDelta;break;case"wheel":t=e["deltaY"];break;default:throw"unrecognized mouse wheel event: "+e.type}return t},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseEvent:function(e){if(Browser.pointerLock){if(e.type!="mousemove"&&"mozMovementX"in e){Browser.mouseMovementX=Browser.mouseMovementY=0}else{Browser.mouseMovementX=Browser.getMovementX(e);Browser.mouseMovementY=Browser.getMovementY(e)}if(typeof SDL!="undefined"){Browser.mouseX=SDL.mouseX+Browser.mouseMovementX;Browser.mouseY=SDL.mouseY+Browser.mouseMovementY}else{Browser.mouseX+=Browser.mouseMovementX;Browser.mouseY+=Browser.mouseMovementY}}else{var t=Module["canvas"].getBoundingClientRect();var r=Module["canvas"].width;var i=Module["canvas"].height;var n=typeof window.scrollX!=="undefined"?window.scrollX:window.pageXOffset;var a=typeof window.scrollY!=="undefined"?window.scrollY:window.pageYOffset;if(e.type==="touchstart"||e.type==="touchend"||e.type==="touchmove"){var o=e.touch;if(o===undefined){return}var s=o.pageX-(n+t.left);var l=o.pageY-(a+t.top);s=s*(r/t.width);l=l*(i/t.height);var u={x:s,y:l};if(e.type==="touchstart"){Browser.lastTouches[o.identifier]=u;Browser.touches[o.identifier]=u}else if(e.type==="touchend"||e.type==="touchmove"){var c=Browser.touches[o.identifier];if(!c)c=u;Browser.lastTouches[o.identifier]=c;Browser.touches[o.identifier]=u}return}var d=e.pageX-(n+t.left);var f=e.pageY-(a+t.top);d=d*(r/t.width);f=f*(i/t.height);Browser.mouseMovementX=d-Browser.mouseX;Browser.mouseMovementY=f-Browser.mouseY;Browser.mouseX=d;Browser.mouseY=f}},xhrLoad:function(e,t,r){var i=new XMLHttpRequest;i.open("GET",e,true);i.responseType="arraybuffer";i.onload=function e(){if(i.status==200||i.status==0&&i.response){t(i.response)}else{r()}};i.onerror=r;i.send(null)},asyncLoad:function(e,t,r,i){Browser.xhrLoad(e,function(r){assert(r,'Loading data file "'+e+'" failed (no arrayBuffer).');t(new Uint8Array(r));if(!i)removeRunDependency("al "+e)},function(t){if(r){r()}else{throw'Loading data file "'+e+'" failed.'}});if(!i)addRunDependency("al "+e)},resizeListeners:[],updateResizeListeners:function(){var e=Module["canvas"];Browser.resizeListeners.forEach(function(t){t(e.width,e.height)})},setCanvasSize:function(e,t,r){var i=Module["canvas"];Browser.updateCanvasDimensions(i,e,t);if(!r)Browser.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullScreenCanvasSize:function(){if(typeof SDL!="undefined"){var e=HEAPU32[SDL.screen+Runtime.QUANTUM_SIZE*0>>2];e=e|8388608;HEAP32[SDL.screen+Runtime.QUANTUM_SIZE*0>>2]=e}Browser.updateResizeListeners()},setWindowedCanvasSize:function(){if(typeof SDL!="undefined"){var e=HEAPU32[SDL.screen+Runtime.QUANTUM_SIZE*0>>2];e=e&~8388608;HEAP32[SDL.screen+Runtime.QUANTUM_SIZE*0>>2]=e}Browser.updateResizeListeners()},updateCanvasDimensions:function(e,t,r){if(t&&r){e.widthNative=t;e.heightNative=r}else{t=e.widthNative;r=e.heightNative}var i=t;var n=r;if(Module["forcedAspectRatio"]&&Module["forcedAspectRatio"]>0){if(i/n<Module["forcedAspectRatio"]){i=Math.round(n*Module["forcedAspectRatio"])}else{n=Math.round(i/Module["forcedAspectRatio"])}}if((document["webkitFullScreenElement"]||document["webkitFullscreenElement"]||document["mozFullScreenElement"]||document["mozFullscreenElement"]||document["fullScreenElement"]||document["fullscreenElement"]||document["msFullScreenElement"]||document["msFullscreenElement"]||document["webkitCurrentFullScreenElement"])===e.parentNode&&typeof screen!="undefined"){var a=Math.min(screen.width/i,screen.height/n);i=Math.round(i*a);n=Math.round(n*a)}if(Browser.resizeCanvas){if(e.width!=i)e.width=i;if(e.height!=n)e.height=n;if(typeof e.style!="undefined"){e.style.removeProperty("width");e.style.removeProperty("height")}}else{if(e.width!=t)e.width=t;if(e.height!=r)e.height=r;if(typeof e.style!="undefined"){if(i!=t||n!=r){e.style.setProperty("width",i+"px","important");e.style.setProperty("height",n+"px","important")}else{e.style.removeProperty("width");e.style.removeProperty("height")}}}},wgetRequests:{},nextWgetRequestHandle:0,getNextWgetRequestHandle:function(){var e=Browser.nextWgetRequestHandle;Browser.nextWgetRequestHandle++;return e}};function _pthread_setspecific(e,t){if(!(e in PTHREAD_SPECIFIC)){return ERRNO_CODES.EINVAL}PTHREAD_SPECIFIC[e]=t;return 0}function _time(e){var t=Date.now()/1e3|0;if(e){HEAP32[e>>2]=t}return t}function _pthread_self(){return 0}function ___syscall140(e,t){SYSCALLS.varargs=t;try{var r=SYSCALLS.getStreamFromFD(),i=SYSCALLS.get(),n=SYSCALLS.get(),a=SYSCALLS.get(),o=SYSCALLS.get();var s=n;assert(i===0);FS.llseek(r,s,o);HEAP32[a>>2]=r.position;if(r.getdents&&s===0&&o===0)r.getdents=null;return 0}catch(e){if(typeof FS==="undefined"||!(e instanceof FS.ErrnoError))abort(e);return-e.errno}}function ___syscall146(e,t){SYSCALLS.varargs=t;try{var r=SYSCALLS.get(),i=SYSCALLS.get(),n=SYSCALLS.get();var a=0;if(!___syscall146.buffer)___syscall146.buffer=[];var o=___syscall146.buffer;for(var s=0;s<n;s++){var l=HEAP32[i+s*8>>2];var u=HEAP32[i+(s*8+4)>>2];for(var c=0;c<u;c++){var d=HEAPU8[l+c];if(d===0||d===10){Module["print"](UTF8ArrayToString(o,0));o.length=0}else{o.push(d)}}a+=u}return a}catch(e){if(typeof FS==="undefined"||!(e instanceof FS.ErrnoError))abort(e);return-e.errno}}function ___syscall54(e,t){SYSCALLS.varargs=t;try{return 0}catch(e){if(typeof FS==="undefined"||!(e instanceof FS.ErrnoError))abort(e);return-e.errno}}Module["requestFullScreen"]=function e(t,r,i){Browser.requestFullScreen(t,r,i)};Module["requestAnimationFrame"]=function e(t){Browser.requestAnimationFrame(t)};Module["setCanvasSize"]=function e(t,r,i){Browser.setCanvasSize(t,r,i)};Module["pauseMainLoop"]=function e(){Browser.mainLoop.pause()};Module["resumeMainLoop"]=function e(){Browser.mainLoop.resume()};Module["getUserMedia"]=function e(){Browser.getUserMedia()};Module["createContext"]=function e(t,r,i,n){return Browser.createContext(t,r,i,n)};STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP);staticSealed=true;STACK_MAX=STACK_BASE+TOTAL_STACK;DYNAMIC_BASE=DYNAMICTOP=Runtime.alignMemory(STACK_MAX);assert(DYNAMIC_BASE<TOTAL_MEMORY,"TOTAL_MEMORY not big enough for stack");var cttz_i8=allocate([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",ALLOC_DYNAMIC);function invoke_iiii(e,t,r,i){try{return Module["dynCall_iiii"](e,t,r,i)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiii(e,t,r,i,n,a){try{Module["dynCall_viiiii"](e,t,r,i,n,a)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_vi(e,t){try{Module["dynCall_vi"](e,t)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_ii(e,t){try{return Module["dynCall_ii"](e,t)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viii(e,t,r,i){try{Module["dynCall_viii"](e,t,r,i)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_v(e){try{Module["dynCall_v"](e)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiiii(e,t,r,i,n,a,o){try{Module["dynCall_viiiiii"](e,t,r,i,n,a,o)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiii(e,t,r,i,n){try{Module["dynCall_viiii"](e,t,r,i,n)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}Module.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:Infinity,byteLength:byteLength};Module.asmLibraryArg={abort:abort,assert:assert,invoke_iiii:invoke_iiii,invoke_viiiii:invoke_viiiii,invoke_vi:invoke_vi,invoke_ii:invoke_ii,invoke_viii:invoke_viii,invoke_v:invoke_v,invoke_viiiiii:invoke_viiiiii,invoke_viiii:invoke_viiii,_pthread_cleanup_pop:_pthread_cleanup_pop,_pthread_getspecific:_pthread_getspecific,_pthread_setspecific:_pthread_setspecific,__ZSt18uncaught_exceptionv:__ZSt18uncaught_exceptionv,_emscripten_set_main_loop:_emscripten_set_main_loop,_pthread_self:_pthread_self,_abort:_abort,_pthread_cleanup_push:_pthread_cleanup_push,___syscall6:___syscall6,_sbrk:_sbrk,_time:_time,_pthread_key_create:_pthread_key_create,___setErrNo:___setErrNo,_emscripten_memcpy_big:_emscripten_memcpy_big,___syscall54:___syscall54,___syscall140:___syscall140,_pthread_once:_pthread_once,_emscripten_set_main_loop_timing:_emscripten_set_main_loop_timing,_sysconf:_sysconf,___syscall146:___syscall146,___cxa_begin_catch:___cxa_begin_catch,STACKTOP:STACKTOP,STACK_MAX:STACK_MAX,tempDoublePtr:tempDoublePtr,ABORT:ABORT,cttz_i8:cttz_i8};var asm=function(e,t,r){"use asm";var i=e.Int8Array;var n=e.Int16Array;var a=e.Int32Array;var o=e.Uint8Array;var s=e.Uint16Array;var l=e.Uint32Array;var u=e.Float32Array;var c=e.Float64Array;var d=new i(r);var f=new n(r);var h=new a(r);var p=new o(r);var m=new s(r);var v=new l(r);var g=new u(r);var _=new c(r);var y=e.byteLength;var b=t.STACKTOP|0;var w=t.STACK_MAX|0;var C=t.tempDoublePtr|0;var S=t.ABORT|0;var T=t.cttz_i8|0;var E=0;var x=0;var P=0;var A=0;var O=e.NaN,D=e.Infinity;var I=0,M=0,R=0,L=0,N=0.0,k=0,F=0,B=0,U=0.0;var V=0;var z=0;var q=0;var G=0;var H=0;var j=0;var W=0;var Y=0;var X=0;var Q=0;var Z=e.Math.floor;var K=e.Math.abs;var J=e.Math.sqrt;var $=e.Math.pow;var ee=e.Math.cos;var te=e.Math.sin;var re=e.Math.tan;var ie=e.Math.acos;var ne=e.Math.asin;var ae=e.Math.atan;var oe=e.Math.atan2;var se=e.Math.exp;var le=e.Math.log;var ue=e.Math.ceil;var ce=e.Math.imul;var de=e.Math.min;var fe=e.Math.clz32;var he=t.abort;var pe=t.assert;var me=t.invoke_iiii;var ve=t.invoke_viiiii;var ge=t.invoke_vi;var _e=t.invoke_ii;var ye=t.invoke_viii;var be=t.invoke_v;var we=t.invoke_viiiiii;var Ce=t.invoke_viiii;var Se=t._pthread_cleanup_pop;var Te=t._pthread_getspecific;var Ee=t._pthread_setspecific;var xe=t.__ZSt18uncaught_exceptionv;var Pe=t._emscripten_set_main_loop;var Ae=t._pthread_self;var Oe=t._abort;var De=t._pthread_cleanup_push;var Ie=t.___syscall6;var Me=t._sbrk;var Re=t._time;var Le=t._pthread_key_create;var Ne=t.___setErrNo;var ke=t._emscripten_memcpy_big;var Fe=t.___syscall54;var Be=t.___syscall140;var Ue=t._pthread_once;var Ve=t._emscripten_set_main_loop_timing;var ze=t._sysconf;var qe=t.___syscall146;var Ge=t.___cxa_begin_catch;var He=0.0;function je(e){if(y(e)&16777215||y(e)<=16777215||y(e)>2147483648)return false;d=new i(e);f=new n(e);h=new a(e);p=new o(e);m=new s(e);v=new l(e);g=new u(e);_=new c(e);r=e;return true}function We(e){e=e|0;var t=0;t=b;b=b+e|0;b=b+15&-16;return t|0}function Ye(){return b|0}function Xe(e){e=e|0;b=e}function Qe(e,t){e=e|0;t=t|0;b=e;w=t}function Ze(e,t){e=e|0;t=t|0;if(!E){E=e;x=t}}function Ke(e){e=e|0;d[C>>0]=d[e>>0];d[C+1>>0]=d[e+1>>0];d[C+2>>0]=d[e+2>>0];d[C+3>>0]=d[e+3>>0]}function Je(e){e=e|0;d[C>>0]=d[e>>0];d[C+1>>0]=d[e+1>>0];d[C+2>>0]=d[e+2>>0];d[C+3>>0]=d[e+3>>0];d[C+4>>0]=d[e+4>>0];d[C+5>>0]=d[e+5>>0];d[C+6>>0]=d[e+6>>0];d[C+7>>0]=d[e+7>>0]}function $e(e){e=e|0;V=e}function et(){return V|0}function tt(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0;p=b;b=b+576|0;c=p+48|0;s=p+32|0;o=p+16|0;a=p;u=p+64|0;d=p+60|0;l=e+4|0;f=e+8|0;if((h[l>>2]|0)>>>0>(h[f>>2]|0)>>>0){h[a>>2]=1138;h[a+4>>2]=2119;h[a+8>>2]=1117;yr(u,1084,a)|0;_r(u)|0}if((2147418112/(i>>>0)|0)>>>0<=t>>>0){h[o>>2]=1138;h[o+4>>2]=2120;h[o+8>>2]=1157;yr(u,1084,o)|0;_r(u)|0}o=h[f>>2]|0;if(o>>>0>=t>>>0){f=1;b=p;return f|0}do{if(r){if(t){a=t+-1|0;if(!(a&t)){a=11;break}else t=a}else t=-1;t=t>>>16|t;t=t>>>8|t;t=t>>>4|t;t=t>>>2|t;t=(t>>>1|t)+1|0;a=10}else a=10}while(0);if((a|0)==10)if(!t){t=0;a=12}else a=11;if((a|0)==11)if(t>>>0<=o>>>0)a=12;if((a|0)==12){h[s>>2]=1138;h[s+4>>2]=2129;h[s+8>>2]=1205;yr(u,1084,s)|0;_r(u)|0}r=ce(t,i)|0;do{if(!n){a=rt(h[e>>2]|0,r,d,1)|0;if(!a){f=0;b=p;return f|0}else{h[e>>2]=a;break}}else{o=it(r,d)|0;if(!o){f=0;b=p;return f|0}Pi[n&0](o,h[e>>2]|0,h[l>>2]|0);a=h[e>>2]|0;do{if(a)if(!(a&7)){at(a,0,0,1,0)|0;break}else{h[c>>2]=1138;h[c+4>>2]=2502;h[c+8>>2]=1504;yr(u,1084,c)|0;_r(u)|0;break}}while(0);h[e>>2]=o}}while(0);a=h[d>>2]|0;if(a>>>0>r>>>0)t=(a>>>0)/(i>>>0)|0;h[f>>2]=t;f=1;b=p;return f|0}function rt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,l=0,u=0;u=b;b=b+560|0;l=u+32|0;a=u+16|0;n=u;s=u+48|0;o=u+44|0;if(e&7){h[n>>2]=1138;h[n+4>>2]=2502;h[n+8>>2]=1482;yr(s,1084,n)|0;_r(s)|0;l=0;b=u;return l|0}if(t>>>0>2147418112){h[a>>2]=1138;h[a+4>>2]=2502;h[a+8>>2]=1375;yr(s,1084,a)|0;_r(s)|0;l=0;b=u;return l|0}h[o>>2]=t;i=at(e,t,o,i,0)|0;if(r)h[r>>2]=h[o>>2];if(!(i&7)){l=i;b=u;return l|0}h[l>>2]=1138;h[l+4>>2]=2554;h[l+8>>2]=1428;yr(s,1084,l)|0;_r(s)|0;l=i;b=u;return l|0}function it(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,l=0;l=b;b=b+560|0;s=l+32|0;o=l+16|0;r=l;a=l+48|0;n=l+44|0;i=e+3&-4;i=(i|0)!=0?i:4;if(i>>>0>2147418112){h[r>>2]=1138;h[r+4>>2]=2502;h[r+8>>2]=1375;yr(a,1084,r)|0;_r(a)|0;s=0;b=l;return s|0}h[n>>2]=i;r=at(0,i,n,1,0)|0;e=h[n>>2]|0;if(t)h[t>>2]=e;if((r|0)==0|e>>>0<i>>>0){h[o>>2]=1138;h[o+4>>2]=2502;h[o+8>>2]=1401;yr(a,1084,o)|0;_r(a)|0;s=0;b=l;return s|0}if(!(r&7)){s=r;b=l;return s|0}h[s>>2]=1138;h[s+4>>2]=2529;h[s+8>>2]=1428;yr(a,1084,s)|0;_r(a)|0;s=r;b=l;return s|0}function nt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,l=0,u=0,c=0,v=0,g=0,_=0,y=0,w=0,C=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0,I=0,M=0,R=0,L=0,N=0,k=0,F=0;F=b;b=b+880|0;L=F+144|0;R=F+128|0;M=F+112|0;I=F+96|0;A=F+80|0;C=F+64|0;y=F+48|0;w=F+32|0;v=F+16|0;c=F;D=F+360|0;N=F+296|0;k=F+224|0;_=F+156|0;if((t|0)==0|i>>>0>11){e=0;b=F;return e|0}h[e>>2]=t;n=k;a=n+68|0;do{h[n>>2]=0;n=n+4|0}while((n|0)<(a|0));a=0;do{n=d[r+a>>0]|0;if(n<<24>>24){O=k+((n&255)<<2)|0;h[O>>2]=(h[O>>2]|0)+1}a=a+1|0}while((a|0)!=(t|0));a=0;u=1;o=0;s=-1;l=0;while(1){n=h[k+(u<<2)>>2]|0;if(!n)h[e+28+(u+-1<<2)>>2]=0;else{O=u+-1|0;h[N+(O<<2)>>2]=a;a=n+a|0;P=16-u|0;h[e+28+(O<<2)>>2]=(a+-1<<P|(1<<P)+-1)+1;h[e+96+(O<<2)>>2]=l;h[_+(u<<2)>>2]=l;o=o>>>0>u>>>0?o:u;s=s>>>0<u>>>0?s:u;l=n+l|0}u=u+1|0;if((u|0)==17){O=o;break}else a=a<<1}h[e+4>>2]=l;a=e+172|0;do{if(l>>>0>(h[a>>2]|0)>>>0){h[a>>2]=l;if(l){n=l+-1|0;if(n&l)g=14}else{n=-1;g=14}if((g|0)==14){P=n>>>16|n;P=P>>>8|P;P=P>>>4|P;P=P>>>2|P;P=(P>>>1|P)+1|0;h[a>>2]=P>>>0>t>>>0?t:P}o=e+176|0;n=h[o>>2]|0;do{if(n){P=h[n+-4>>2]|0;n=n+-8|0;if(!((P|0)!=0?(P|0)==(~h[n>>2]|0):0)){h[c>>2]=1138;h[c+4>>2]=647;h[c+8>>2]=1851;yr(D,1084,c)|0;_r(D)|0}if(!(n&7)){at(n,0,0,1,0)|0;break}else{h[v>>2]=1138;h[v+4>>2]=2502;h[v+8>>2]=1504;yr(D,1084,v)|0;_r(D)|0;break}}}while(0);a=h[a>>2]|0;a=(a|0)!=0?a:1;n=it((a<<1)+8|0,0)|0;if(!n){h[o>>2]=0;n=0;break}else{h[n+4>>2]=a;h[n>>2]=~a;h[o>>2]=n+8;g=25;break}}else g=25}while(0);e:do{if((g|0)==25){P=e+24|0;d[P>>0]=s;d[e+25>>0]=O;a=e+176|0;o=0;do{x=d[r+o>>0]|0;n=x&255;if(x<<24>>24){if(!(h[k+(n<<2)>>2]|0)){h[w>>2]=1138;h[w+4>>2]=2272;h[w+8>>2]=1249;yr(D,1084,w)|0;_r(D)|0}x=_+(n<<2)|0;n=h[x>>2]|0;h[x>>2]=n+1;if(n>>>0>=l>>>0){h[y>>2]=1138;h[y+4>>2]=2276;h[y+8>>2]=1262;yr(D,1084,y)|0;_r(D)|0}f[(h[a>>2]|0)+(n<<1)>>1]=o}o=o+1|0}while((o|0)!=(t|0));n=d[P>>0]|0;E=(n&255)>>>0<i>>>0?i:0;x=e+8|0;h[x>>2]=E;T=(E|0)!=0;if(T){S=1<<E;n=e+164|0;do{if(S>>>0>(h[n>>2]|0)>>>0){h[n>>2]=S;o=e+168|0;n=h[o>>2]|0;do{if(n){w=h[n+-4>>2]|0;n=n+-8|0;if(!((w|0)!=0?(w|0)==(~h[n>>2]|0):0)){h[C>>2]=1138;h[C+4>>2]=647;h[C+8>>2]=1851;yr(D,1084,C)|0;_r(D)|0}if(!(n&7)){at(n,0,0,1,0)|0;break}else{h[A>>2]=1138;h[A+4>>2]=2502;h[A+8>>2]=1504;yr(D,1084,A)|0;_r(D)|0;break}}}while(0);n=S<<2;a=it(n+8|0,0)|0;if(!a){h[o>>2]=0;n=0;break e}else{A=a+8|0;h[a+4>>2]=S;h[a>>2]=~S;h[o>>2]=A;a=A;break}}else{a=e+168|0;n=S<<2;o=a;a=h[a>>2]|0}}while(0);Xr(a|0,-1,n|0)|0;_=e+176|0;C=1;do{if(h[k+(C<<2)>>2]|0){y=E-C|0;w=1<<y;a=C+-1|0;s=h[N+(a<<2)>>2]|0;if(a>>>0>=16){h[I>>2]=1138;h[I+4>>2]=1956;h[I+8>>2]=1725;yr(D,1084,I)|0;_r(D)|0}n=h[e+28+(a<<2)>>2]|0;if(!n)t=-1;else t=(n+-1|0)>>>(16-C|0);if(s>>>0<=t>>>0){v=(h[e+96+(a<<2)>>2]|0)-s|0;g=C<<16;do{n=m[(h[_>>2]|0)+(v+s<<1)>>1]|0;if((p[r+n>>0]|0|0)!=(C|0)){h[M>>2]=1138;h[M+4>>2]=2318;h[M+8>>2]=1291;yr(D,1084,M)|0;_r(D)|0}c=s<<y;a=n|g;u=0;do{l=u+c|0;if(l>>>0>=S>>>0){h[R>>2]=1138;h[R+4>>2]=2324;h[R+8>>2]=1325;yr(D,1084,R)|0;_r(D)|0}n=h[o>>2]|0;if((h[n+(l<<2)>>2]|0)!=-1){h[L>>2]=1138;h[L+4>>2]=2326;h[L+8>>2]=1348;yr(D,1084,L)|0;_r(D)|0;n=h[o>>2]|0}h[n+(l<<2)>>2]=a;u=u+1|0}while(u>>>0<w>>>0);s=s+1|0}while(s>>>0<=t>>>0)}}C=C+1|0}while(E>>>0>=C>>>0);n=d[P>>0]|0}a=e+96|0;h[a>>2]=(h[a>>2]|0)-(h[N>>2]|0);a=e+100|0;h[a>>2]=(h[a>>2]|0)-(h[N+4>>2]|0);a=e+104|0;h[a>>2]=(h[a>>2]|0)-(h[N+8>>2]|0);a=e+108|0;h[a>>2]=(h[a>>2]|0)-(h[N+12>>2]|0);a=e+112|0;h[a>>2]=(h[a>>2]|0)-(h[N+16>>2]|0);a=e+116|0;h[a>>2]=(h[a>>2]|0)-(h[N+20>>2]|0);a=e+120|0;h[a>>2]=(h[a>>2]|0)-(h[N+24>>2]|0);a=e+124|0;h[a>>2]=(h[a>>2]|0)-(h[N+28>>2]|0);a=e+128|0;h[a>>2]=(h[a>>2]|0)-(h[N+32>>2]|0);a=e+132|0;h[a>>2]=(h[a>>2]|0)-(h[N+36>>2]|0);a=e+136|0;h[a>>2]=(h[a>>2]|0)-(h[N+40>>2]|0);a=e+140|0;h[a>>2]=(h[a>>2]|0)-(h[N+44>>2]|0);a=e+144|0;h[a>>2]=(h[a>>2]|0)-(h[N+48>>2]|0);a=e+148|0;h[a>>2]=(h[a>>2]|0)-(h[N+52>>2]|0);a=e+152|0;h[a>>2]=(h[a>>2]|0)-(h[N+56>>2]|0);a=e+156|0;h[a>>2]=(h[a>>2]|0)-(h[N+60>>2]|0);a=e+16|0;h[a>>2]=0;o=e+20|0;h[o>>2]=n&255;t:do{if(T){while(1){if(!i)break t;n=i+-1|0;if(!(h[k+(i<<2)>>2]|0))i=n;else break}h[a>>2]=h[e+28+(n<<2)>>2];n=E+1|0;h[o>>2]=n;if(n>>>0<=O>>>0){while(1){if(h[k+(n<<2)>>2]|0)break;n=n+1|0;if(n>>>0>O>>>0)break t}h[o>>2]=n}}}while(0);h[e+92>>2]=-1;h[e+160>>2]=1048575;h[e+12>>2]=32-(h[x>>2]|0);n=1}}while(0);e=n;b=F;return e|0}function at(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;do{if(!e){i=Ur(t)|0;if(r){if(!i)e=0;else e=qr(i)|0;h[r>>2]=e}}else{if(!t){Vr(e);if(!r){i=0;break}h[r>>2]=0;i=0;break}if(i){i=zr(e,t)|0;e=(i|0)==0?e:i}else i=0;if(r){t=qr(e)|0;h[r>>2]=t}}}while(0);return i|0}function ot(e,t,r){e=e|0;t=t|0;r=r|0;var i=0;if(!((e|0)!=0&t>>>0>73&(r|0)!=0)){r=0;return r|0}if((h[r>>2]|0)!=40|t>>>0<74){r=0;return r|0}if(((p[e>>0]|0)<<8|(p[e+1>>0]|0)|0)!=18552){r=0;return r|0}if(((p[e+2>>0]|0)<<8|(p[e+3>>0]|0))>>>0<74){r=0;return r|0}if(((p[e+7>>0]|0)<<16|(p[e+6>>0]|0)<<24|(p[e+8>>0]|0)<<8|(p[e+9>>0]|0))>>>0>t>>>0){r=0;return r|0}h[r+4>>2]=(p[e+12>>0]|0)<<8|(p[e+13>>0]|0);h[r+8>>2]=(p[e+14>>0]|0)<<8|(p[e+15>>0]|0);h[r+12>>2]=p[e+16>>0];h[r+16>>2]=p[e+17>>0];t=e+18|0;i=r+32|0;h[i>>2]=p[t>>0];h[i+4>>2]=0;t=d[t>>0]|0;h[r+20>>2]=t<<24>>24==0|t<<24>>24==9?8:16;h[r+24>>2]=(p[e+26>>0]|0)<<16|(p[e+25>>0]|0)<<24|(p[e+27>>0]|0)<<8|(p[e+28>>0]|0);h[r+28>>2]=(p[e+30>>0]|0)<<16|(p[e+29>>0]|0)<<24|(p[e+31>>0]|0)<<8|(p[e+32>>0]|0);r=1;return r|0}function st(e){e=e|0;Ge(e|0)|0;Ut()}function lt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0;a=b;b=b+528|0;n=a;i=a+16|0;t=h[e+20>>2]|0;if(t)ut(t);t=e+4|0;r=h[t>>2]|0;if(!r){n=e+16|0;d[n>>0]=0;b=a;return}if(!(r&7))at(r,0,0,1,0)|0;else{h[n>>2]=1138;h[n+4>>2]=2502;h[n+8>>2]=1504;yr(i,1084,n)|0;_r(i)|0}h[t>>2]=0;h[e+8>>2]=0;h[e+12>>2]=0;n=e+16|0;d[n>>0]=0;b=a;return}function ut(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0;l=b;b=b+592|0;o=l+64|0;a=l+48|0;s=l+32|0;i=l+16|0;r=l;n=l+80|0;if(!e){b=l;return}t=h[e+168>>2]|0;do{if(t){u=h[t+-4>>2]|0;t=t+-8|0;if(!((u|0)!=0?(u|0)==(~h[t>>2]|0):0)){h[r>>2]=1138;h[r+4>>2]=647;h[r+8>>2]=1851;yr(n,1084,r)|0;_r(n)|0}if(!(t&7)){at(t,0,0,1,0)|0;break}else{h[i>>2]=1138;h[i+4>>2]=2502;h[i+8>>2]=1504;yr(n,1084,i)|0;_r(n)|0;break}}}while(0);t=h[e+176>>2]|0;do{if(t){u=h[t+-4>>2]|0;t=t+-8|0;if(!((u|0)!=0?(u|0)==(~h[t>>2]|0):0)){h[s>>2]=1138;h[s+4>>2]=647;h[s+8>>2]=1851;yr(n,1084,s)|0;_r(n)|0}if(!(t&7)){at(t,0,0,1,0)|0;break}else{h[a>>2]=1138;h[a+4>>2]=2502;h[a+8>>2]=1504;yr(n,1084,a)|0;_r(n)|0;break}}}while(0);if(!(e&7)){at(e,0,0,1,0)|0;b=l;return}else{h[o>>2]=1138;h[o+4>>2]=2502;h[o+8>>2]=1504;yr(n,1084,o)|0;_r(n)|0;b=l;return}}function ct(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,l=0;l=b;b=b+544|0;o=l+16|0;t=l;a=l+32|0;n=e+8|0;r=h[n>>2]|0;if((r+-1|0)>>>0>=8192){h[t>>2]=1138;h[t+4>>2]=3002;h[t+8>>2]=1529;yr(a,1084,t)|0;_r(a)|0}h[e>>2]=r;i=e+20|0;t=h[i>>2]|0;if(!t){t=it(180,0)|0;if(!t)t=0;else{s=t+164|0;h[s>>2]=0;h[s+4>>2]=0;h[s+8>>2]=0;h[s+12>>2]=0}h[i>>2]=t;s=h[e>>2]|0}else s=r;if(!(h[n>>2]|0)){h[o>>2]=1138;h[o+4>>2]=906;h[o+8>>2]=1769;yr(a,1084,o)|0;_r(a)|0;o=h[e>>2]|0}else o=s;a=h[e+4>>2]|0;if(o>>>0>16){i=o;r=0}else{e=0;e=nt(t,s,a,e)|0;b=l;return e|0}while(1){n=r+1|0;if(i>>>0>3){i=i>>>1;r=n}else{i=n;break}}e=r+2+((i|0)!=32&1<<i>>>0<o>>>0&1)|0;e=e>>>0<11?e&255:11;e=nt(t,s,a,e)|0;b=l;return e|0}function dt(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,f=0,m=0,v=0,g=0,_=0,y=0,w=0,C=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0;D=b;b=b+720|0;E=D+160|0;T=D+144|0;S=D+128|0;C=D+112|0;w=D+96|0;y=D+80|0;_=D+64|0;g=D+48|0;c=D+32|0;s=D+16|0;n=D;A=D+200|0;O=D+176|0;x=ft(e,14)|0;if(!x){h[t>>2]=0;r=t+4|0;i=h[r>>2]|0;if(i){if(!(i&7))at(i,0,0,1,0)|0;else{h[n>>2]=1138;h[n+4>>2]=2502;h[n+8>>2]=1504;yr(A,1084,n)|0;_r(A)|0}h[r>>2]=0;h[t+8>>2]=0;h[t+12>>2]=0}d[t+16>>0]=0;r=t+20|0;i=h[r>>2]|0;if(!i){t=1;b=D;return t|0}ut(i);h[r>>2]=0;t=1;b=D;return t|0}m=t+4|0;v=t+8|0;r=h[v>>2]|0;if((r|0)!=(x|0)){if(r>>>0<=x>>>0){do{if((h[t+12>>2]|0)>>>0<x>>>0){if(tt(m,x,(r+1|0)==(x|0),1,0)|0){r=h[v>>2]|0;break}d[t+16>>0]=1;t=0;b=D;return t|0}}while(0);Xr((h[m>>2]|0)+r|0,0,x-r|0)|0}h[v>>2]=x}Xr(h[m>>2]|0,0,x|0)|0;f=e+20|0;r=h[f>>2]|0;if((r|0)<5){a=e+4|0;o=e+8|0;n=e+16|0;do{i=h[a>>2]|0;if((i|0)==(h[o>>2]|0))i=0;else{h[a>>2]=i+1;i=p[i>>0]|0}r=r+8|0;h[f>>2]=r;if((r|0)>=33){h[s>>2]=1138;h[s+4>>2]=3204;h[s+8>>2]=1638;yr(A,1084,s)|0;_r(A)|0;r=h[f>>2]|0}i=i<<32-r|h[n>>2];h[n>>2]=i}while((r|0)<5)}else{i=e+16|0;n=i;i=h[i>>2]|0}u=i>>>27;h[n>>2]=i<<5;h[f>>2]=r+-5;if((u+-1|0)>>>0>20){t=0;b=D;return t|0}h[O+20>>2]=0;h[O>>2]=0;h[O+4>>2]=0;h[O+8>>2]=0;h[O+12>>2]=0;d[O+16>>0]=0;r=O+4|0;i=O+8|0;e:do{if(tt(r,21,0,1,0)|0){s=h[i>>2]|0;l=h[r>>2]|0;Xr(l+s|0,0,21-s|0)|0;h[i>>2]=21;if(u){n=e+4|0;a=e+8|0;o=e+16|0;s=0;do{r=h[f>>2]|0;if((r|0)<3)do{i=h[n>>2]|0;if((i|0)==(h[a>>2]|0))i=0;else{h[n>>2]=i+1;i=p[i>>0]|0}r=r+8|0;h[f>>2]=r;if((r|0)>=33){h[c>>2]=1138;h[c+4>>2]=3204;h[c+8>>2]=1638;yr(A,1084,c)|0;_r(A)|0;r=h[f>>2]|0}i=i<<32-r|h[o>>2];h[o>>2]=i}while((r|0)<3);else i=h[o>>2]|0;h[o>>2]=i<<3;h[f>>2]=r+-3;d[l+(p[1599+s>>0]|0)>>0]=i>>>29;s=s+1|0}while((s|0)!=(u|0))}if(ct(O)|0){u=e+4|0;s=e+8|0;l=e+16|0;i=0;t:while(1){o=x-i|0;r=ht(e,O)|0;r:do{if(r>>>0<17){if((h[v>>2]|0)>>>0<=i>>>0){h[g>>2]=1138;h[g+4>>2]=906;h[g+8>>2]=1769;yr(A,1084,g)|0;_r(A)|0}d[(h[m>>2]|0)+i>>0]=r;r=i+1|0}else switch(r|0){case 17:{r=h[f>>2]|0;if((r|0)<3)do{n=h[u>>2]|0;if((n|0)==(h[s>>2]|0))n=0;else{h[u>>2]=n+1;n=p[n>>0]|0}r=r+8|0;h[f>>2]=r;if((r|0)>=33){h[_>>2]=1138;h[_+4>>2]=3204;h[_+8>>2]=1638;yr(A,1084,_)|0;_r(A)|0;r=h[f>>2]|0}n=n<<32-r|h[l>>2];h[l>>2]=n}while((r|0)<3);else n=h[l>>2]|0;h[l>>2]=n<<3;h[f>>2]=r+-3;r=(n>>>29)+3|0;if(r>>>0>o>>>0){r=0;break e}r=r+i|0;break r}case 18:{r=h[f>>2]|0;if((r|0)<7)do{n=h[u>>2]|0;if((n|0)==(h[s>>2]|0))n=0;else{h[u>>2]=n+1;n=p[n>>0]|0}r=r+8|0;h[f>>2]=r;if((r|0)>=33){h[y>>2]=1138;h[y+4>>2]=3204;h[y+8>>2]=1638;yr(A,1084,y)|0;_r(A)|0;r=h[f>>2]|0}n=n<<32-r|h[l>>2];h[l>>2]=n}while((r|0)<7);else n=h[l>>2]|0;h[l>>2]=n<<7;h[f>>2]=r+-7;r=(n>>>25)+11|0;if(r>>>0>o>>>0){r=0;break e}r=r+i|0;break r}default:{if((r+-19|0)>>>0>=2){P=90;break t}a=h[f>>2]|0;if((r|0)==19){if((a|0)<2){n=a;while(1){r=h[u>>2]|0;if((r|0)==(h[s>>2]|0))a=0;else{h[u>>2]=r+1;a=p[r>>0]|0}r=n+8|0;h[f>>2]=r;if((r|0)>=33){h[w>>2]=1138;h[w+4>>2]=3204;h[w+8>>2]=1638;yr(A,1084,w)|0;_r(A)|0;r=h[f>>2]|0}n=a<<32-r|h[l>>2];h[l>>2]=n;if((r|0)<2)n=r;else break}}else{n=h[l>>2]|0;r=a}h[l>>2]=n<<2;h[f>>2]=r+-2;a=(n>>>30)+3|0}else{if((a|0)<6){n=a;while(1){r=h[u>>2]|0;if((r|0)==(h[s>>2]|0))a=0;else{h[u>>2]=r+1;a=p[r>>0]|0}r=n+8|0;h[f>>2]=r;if((r|0)>=33){h[C>>2]=1138;h[C+4>>2]=3204;h[C+8>>2]=1638;yr(A,1084,C)|0;_r(A)|0;r=h[f>>2]|0}n=a<<32-r|h[l>>2];h[l>>2]=n;if((r|0)<6)n=r;else break}}else{n=h[l>>2]|0;r=a}h[l>>2]=n<<6;h[f>>2]=r+-6;a=(n>>>26)+7|0}if((i|0)==0|a>>>0>o>>>0){r=0;break e}r=i+-1|0;if((h[v>>2]|0)>>>0<=r>>>0){h[S>>2]=1138;h[S+4>>2]=906;h[S+8>>2]=1769;yr(A,1084,S)|0;_r(A)|0}n=d[(h[m>>2]|0)+r>>0]|0;if(!(n<<24>>24)){r=0;break e}r=a+i|0;if(i>>>0>=r>>>0){r=i;break r}do{if((h[v>>2]|0)>>>0<=i>>>0){h[T>>2]=1138;h[T+4>>2]=906;h[T+8>>2]=1769;yr(A,1084,T)|0;_r(A)|0}d[(h[m>>2]|0)+i>>0]=n;i=i+1|0}while((i|0)!=(r|0))}}}while(0);if(x>>>0>r>>>0)i=r;else break}if((P|0)==90){h[E>>2]=1138;h[E+4>>2]=3145;h[E+8>>2]=1620;yr(A,1084,E)|0;_r(A)|0;r=0;break}if((x|0)==(r|0))r=ct(t)|0;else r=0}else r=0}else{d[O+16>>0]=1;r=0}}while(0);lt(O);t=r;b=D;return t|0}function ft(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0;u=b;b=b+528|0;o=u;a=u+16|0;if(!t){l=0;b=u;return l|0}if(t>>>0<=16){l=pt(e,t)|0;b=u;return l|0}s=pt(e,t+-16|0)|0;l=e+20|0;t=h[l>>2]|0;if((t|0)<16){i=e+4|0;n=e+8|0;r=e+16|0;do{e=h[i>>2]|0;if((e|0)==(h[n>>2]|0))e=0;else{h[i>>2]=e+1;e=p[e>>0]|0}t=t+8|0;h[l>>2]=t;if((t|0)>=33){h[o>>2]=1138;h[o+4>>2]=3204;h[o+8>>2]=1638;yr(a,1084,o)|0;_r(a)|0;t=h[l>>2]|0}e=e<<32-t|h[r>>2];h[r>>2]=e}while((t|0)<16)}else{e=e+16|0;r=e;e=h[e>>2]|0}h[r>>2]=e<<16;h[l>>2]=t+-16;l=e>>>16|s<<16;b=u;return l|0}function ht(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,d=0,f=0,v=0,g=0,_=0;_=b;b=b+576|0;d=_+48|0;c=_+32|0;u=_+16|0;l=_;v=_+64|0;f=h[t+20>>2]|0;g=e+20|0;s=h[g>>2]|0;do{if((s|0)<24){o=e+4|0;i=h[o>>2]|0;n=h[e+8>>2]|0;r=i>>>0<n>>>0;if((s|0)>=16){if(r){h[o>>2]=i+1;r=p[i>>0]|0}else r=0;h[g>>2]=s+8;o=e+16|0;a=r<<24-s|h[o>>2];h[o>>2]=a;break}if(r){a=(p[i>>0]|0)<<8;r=i+1|0}else{a=0;r=i}if(r>>>0<n>>>0){i=p[r>>0]|0;r=r+1|0}else i=0;h[o>>2]=r;h[g>>2]=s+16;o=e+16|0;a=(i|a)<<16-s|h[o>>2];h[o>>2]=a}else{a=e+16|0;o=a;a=h[a>>2]|0}}while(0);n=(a>>>16)+1|0;do{if(n>>>0<=(h[f+16>>2]|0)>>>0){i=h[(h[f+168>>2]|0)+(a>>>(32-(h[f+8>>2]|0)|0)<<2)>>2]|0;if((i|0)==-1){h[l>>2]=1138;h[l+4>>2]=3249;h[l+8>>2]=1665;yr(v,1084,l)|0;_r(v)|0}r=i&65535;i=i>>>16;if((h[t+8>>2]|0)>>>0<=r>>>0){h[u>>2]=1138;h[u+4>>2]=905;h[u+8>>2]=1769;yr(v,1084,u)|0;_r(v)|0}if((p[(h[t+4>>2]|0)+r>>0]|0|0)!=(i|0)){h[c>>2]=1138;h[c+4>>2]=3253;h[c+8>>2]=1682;yr(v,1084,c)|0;_r(v)|0}}else{i=h[f+20>>2]|0;while(1){r=i+-1|0;if(n>>>0>(h[f+28+(r<<2)>>2]|0)>>>0)i=i+1|0;else break}r=(a>>>(32-i|0))+(h[f+96+(r<<2)>>2]|0)|0;if(r>>>0<(h[t>>2]|0)>>>0){r=m[(h[f+176>>2]|0)+(r<<1)>>1]|0;break}h[d>>2]=1138;h[d+4>>2]=3271;h[d+8>>2]=1620;yr(v,1084,d)|0;_r(v)|0;g=0;b=_;return g|0}}while(0);h[o>>2]=h[o>>2]<<i;h[g>>2]=(h[g>>2]|0)-i;g=r;b=_;return g|0}function pt(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0;u=b;b=b+544|0;s=u+16|0;r=u;o=u+32|0;if(t>>>0>=33){h[r>>2]=1138;h[r+4>>2]=3195;h[r+8>>2]=1622;yr(o,1084,r)|0;_r(o)|0}l=e+20|0;r=h[l>>2]|0;if((r|0)>=(t|0)){n=e+16|0;a=n;n=h[n>>2]|0;o=r;s=32-t|0;s=n>>>s;n=n<<t;h[a>>2]=n;t=o-t|0;h[l>>2]=t;b=u;return s|0}n=e+4|0;a=e+8|0;i=e+16|0;do{e=h[n>>2]|0;if((e|0)==(h[a>>2]|0))e=0;else{h[n>>2]=e+1;e=p[e>>0]|0}r=r+8|0;h[l>>2]=r;if((r|0)>=33){h[s>>2]=1138;h[s+4>>2]=3204;h[s+8>>2]=1638;yr(o,1084,s)|0;_r(o)|0;r=h[l>>2]|0}e=e<<32-r|h[i>>2];h[i>>2]=e}while((r|0)<(t|0));s=32-t|0;s=e>>>s;o=e<<t;h[i>>2]=o;t=r-t|0;h[l>>2]=t;b=u;return s|0}function mt(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,f=0,m=0,v=0,g=0,_=0;v=b;b=b+528|0;f=v;c=v+16|0;if((e|0)==0|t>>>0<62){m=0;b=v;return m|0}u=it(300,0)|0;if(!u){m=0;b=v;return m|0}h[u>>2]=519686845;r=u+4|0;h[r>>2]=0;i=u+8|0;h[i>>2]=0;l=u+88|0;n=u+136|0;a=u+160|0;o=l;s=o+44|0;do{h[o>>2]=0;o=o+4|0}while((o|0)<(s|0));d[l+44>>0]=0;g=u+184|0;o=u+208|0;s=u+232|0;_=u+252|0;h[_>>2]=0;h[_+4>>2]=0;h[_+8>>2]=0;d[_+12>>0]=0;_=u+268|0;h[_>>2]=0;h[_+4>>2]=0;h[_+8>>2]=0;d[_+12>>0]=0;_=u+284|0;h[_>>2]=0;h[_+4>>2]=0;h[_+8>>2]=0;d[_+12>>0]=0;h[n>>2]=0;h[n+4>>2]=0;h[n+8>>2]=0;h[n+12>>2]=0;h[n+16>>2]=0;d[n+20>>0]=0;h[a>>2]=0;h[a+4>>2]=0;h[a+8>>2]=0;h[a+12>>2]=0;h[a+16>>2]=0;d[a+20>>0]=0;h[g>>2]=0;h[g+4>>2]=0;h[g+8>>2]=0;h[g+12>>2]=0;h[g+16>>2]=0;d[g+20>>0]=0;h[o>>2]=0;h[o+4>>2]=0;h[o+8>>2]=0;h[o+12>>2]=0;h[o+16>>2]=0;d[o+20>>0]=0;h[s>>2]=0;h[s+4>>2]=0;h[s+8>>2]=0;h[s+12>>2]=0;d[s+16>>0]=0;do{if(((t>>>0>=74?((p[e>>0]|0)<<8|(p[e+1>>0]|0)|0)==18552:0)?((p[e+2>>0]|0)<<8|(p[e+3>>0]|0))>>>0>=74:0)?((p[e+7>>0]|0)<<16|(p[e+6>>0]|0)<<24|(p[e+8>>0]|0)<<8|(p[e+9>>0]|0))>>>0<=t>>>0:0){h[l>>2]=e;h[r>>2]=e;h[i>>2]=t;if(Et(u)|0){r=h[l>>2]|0;if((p[r+39>>0]|0)<<8|(p[r+40>>0]|0)){if(!(xt(u)|0))break;if(!(Pt(u)|0))break;r=h[l>>2]|0}if(!((p[r+55>>0]|0)<<8|(p[r+56>>0]|0))){_=u;b=v;return _|0}if(At(u)|0?Ot(u)|0:0){_=u;b=v;return _|0}}}else m=7}while(0);if((m|0)==7)h[l>>2]=0;Lt(u);if(!(u&7)){at(u,0,0,1,0)|0;_=0;b=v;return _|0}else{h[f>>2]=1138;h[f+4>>2]=2502;h[f+8>>2]=1504;yr(c,1084,f)|0;_r(c)|0;_=0;b=v;return _|0}return 0}function vt(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,l=0,u=0,c=0;c=b;b=b+528|0;u=c;l=c+16|0;a=h[e+88>>2]|0;s=(p[a+70+(n<<2)+1>>0]|0)<<16|(p[a+70+(n<<2)>>0]|0)<<24|(p[a+70+(n<<2)+2>>0]|0)<<8|(p[a+70+(n<<2)+3>>0]|0);o=n+1|0;if(o>>>0<(p[a+16>>0]|0)>>>0)a=(p[a+70+(o<<2)+1>>0]|0)<<16|(p[a+70+(o<<2)>>0]|0)<<24|(p[a+70+(o<<2)+2>>0]|0)<<8|(p[a+70+(o<<2)+3>>0]|0);else a=h[e+8>>2]|0;if(a>>>0>s>>>0){l=e+4|0;l=h[l>>2]|0;l=l+s|0;u=a-s|0;u=gt(e,l,u,t,r,i,n)|0;b=c;return u|0}h[u>>2]=1138;h[u+4>>2]=3690;h[u+8>>2]=1780;yr(l,1084,u)|0;_r(l)|0;l=e+4|0;l=h[l>>2]|0;l=l+s|0;u=a-s|0;u=gt(e,l,u,t,r,i,n)|0;b=c;return u|0}function gt(e,t,r,i,n,a,o){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;var s=0,l=0,u=0,c=0;c=h[e+88>>2]|0;l=((p[c+12>>0]|0)<<8|(p[c+13>>0]|0))>>>o;u=((p[c+14>>0]|0)<<8|(p[c+15>>0]|0))>>>o;l=l>>>0>1?(l+3|0)>>>2:1;u=u>>>0>1?(u+3|0)>>>2:1;c=c+18|0;o=d[c>>0]|0;o=ce(o<<24>>24==0|o<<24>>24==9?8:16,l)|0;if(a)if((a&3|0)==0&o>>>0<=a>>>0)o=a;else{e=0;return e|0}if((ce(o,u)|0)>>>0>n>>>0){e=0;return e|0}a=(l+1|0)>>>1;s=(u+1|0)>>>1;if(!r){e=0;return e|0}h[e+92>>2]=t;h[e+96>>2]=t;h[e+104>>2]=r;h[e+100>>2]=t+r;h[e+108>>2]=0;h[e+112>>2]=0;switch(p[c>>0]|0|0){case 0:{Dt(e,i,n,o,l,u,a,s)|0;e=1;return e|0}case 4:case 6:case 5:case 3:case 2:{It(e,i,n,o,l,u,a,s)|0;e=1;return e|0}case 9:{Mt(e,i,n,o,l,u,a,s)|0;e=1;return e|0}case 8:case 7:{Rt(e,i,n,o,l,u,a,s)|0;e=1;return e|0}default:{e=0;return e|0}}return 0}function _t(e,t){e=e|0;t=t|0;var r=0,i=0;i=b;b=b+48|0;r=i;h[r>>2]=40;ot(e,t,r)|0;b=i;return h[r+4>>2]|0}function yt(e,t){e=e|0;t=t|0;var r=0,i=0;i=b;b=b+48|0;r=i;h[r>>2]=40;ot(e,t,r)|0;b=i;return h[r+8>>2]|0}function bt(e,t){e=e|0;t=t|0;var r=0,i=0;i=b;b=b+48|0;r=i;h[r>>2]=40;ot(e,t,r)|0;b=i;return h[r+12>>2]|0}function wt(e,t){e=e|0;t=t|0;var r=0,i=0;i=b;b=b+48|0;r=i;h[r>>2]=40;ot(e,t,r)|0;b=i;return h[r+32>>2]|0}function Ct(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0;n=b;b=b+576|0;i=n+40|0;r=n+56|0;a=n;h[a>>2]=40;ot(e,t,a)|0;t=a+32|0;e=h[t+4>>2]|0;do{switch(h[t>>2]|0){case 0:{if(!e){a=8;b=n;return a|0}else e=14;break}case 1:{if(!e)e=13;else e=14;break}case 2:{if(!e)e=13;else e=14;break}case 3:{if(!e)e=13;else e=14;break}case 4:{if(!e)e=13;else e=14;break}case 5:{if(!e)e=13;else e=14;break}case 6:{if(!e)e=13;else e=14;break}case 7:{if(!e)e=13;else e=14;break}case 8:{if(!e)e=13;else e=14;break}case 9:{if(!e){a=8;b=n;return a|0}else e=14;break}case 10:{if(!e){a=8;b=n;return a|0}else e=14;break}default:e=14}}while(0);if((e|0)==13){a=16;b=n;return a|0}else if((e|0)==14){h[i>>2]=1138;h[i+4>>2]=2668;h[i+8>>2]=1523;yr(r,1084,i)|0;_r(r)|0;a=0;b=n;return a|0}return 0}function St(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0,s=0,l=0;s=b;b=b+576|0;a=s+40|0;n=s+56|0;l=s;h[l>>2]=40;ot(e,t,l)|0;i=(((h[l+4>>2]|0)>>>r)+3|0)>>>2;t=(((h[l+8>>2]|0)>>>r)+3|0)>>>2;r=l+32|0;e=h[r+4>>2]|0;do{switch(h[r>>2]|0){case 0:{if(!e)e=8;else o=14;break}case 1:{if(!e)o=13;else o=14;break}case 2:{if(!e)o=13;else o=14;break}case 3:{if(!e)o=13;else o=14;break}case 4:{if(!e)o=13;else o=14;break}case 5:{if(!e)o=13;else o=14;break}case 6:{if(!e)o=13;else o=14;break}case 7:{if(!e)o=13;else o=14;break}case 8:{if(!e)o=13;else o=14;break}case 9:{if(!e)e=8;else o=14;break}case 10:{if(!e)e=8;else o=14;break}default:o=14}}while(0);if((o|0)==13)e=16;else if((o|0)==14){h[a>>2]=1138;h[a+4>>2]=2668;h[a+8>>2]=1523;yr(n,1084,a)|0;_r(n)|0;e=0}l=ce(ce(t,i)|0,e)|0;b=s;return l|0}function Tt(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;var o=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,m=0,v=0;v=b;b=b+592|0;m=v+56|0;o=v+40|0;f=v+72|0;d=v;p=v+68|0;h[d>>2]=40;ot(e,t,d)|0;s=(h[d+4>>2]|0)>>>n;l=(h[d+8>>2]|0)>>>n;d=d+32|0;i=h[d+4>>2]|0;do{switch(h[d>>2]|0){case 0:{if(!i)d=8;else u=14;break}case 1:{if(!i)u=13;else u=14;break}case 2:{if(!i)u=13;else u=14;break}case 3:{if(!i)u=13;else u=14;break}case 4:{if(!i)u=13;else u=14;break}case 5:{if(!i)u=13;else u=14;break}case 6:{if(!i)u=13;else u=14;break}case 7:{if(!i)u=13;else u=14;break}case 8:{if(!i)u=13;else u=14;break}case 9:{if(!i)d=8;else u=14;break}case 10:{if(!i)d=8;else u=14;break}default:u=14}}while(0);if((u|0)==13)d=16;else if((u|0)==14){h[o>>2]=1138;h[o+4>>2]=2668;h[o+8>>2]=1523;yr(f,1084,o)|0;_r(f)|0;d=0}h[p>>2]=r;c=mt(e,t)|0;t=a+n|0;if(t>>>0>n>>>0){u=(c|0)==0;e=r;while(1){i=ce((s+3|0)>>>2,d)|0;o=ce(i,(l+3|0)>>>2)|0;if(!(n>>>0>15|(u|o>>>0<8))?(h[c>>2]|0)==519686845:0)vt(c,p,o,i,n)|0;e=e+o|0;h[p>>2]=e;n=n+1|0;if((n|0)==(t|0))break;else{l=l>>>1;s=s>>>1}}}if(!c){b=v;return}if((h[c>>2]|0)!=519686845){b=v;return}Lt(c);if(!(c&7)){at(c,0,0,1,0)|0;b=v;return}else{h[m>>2]=1138;h[m+4>>2]=2502;h[m+8>>2]=1504;yr(f,1084,m)|0;_r(f)|0;b=v;return}}function Et(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0;o=e+92|0;i=h[e+4>>2]|0;a=e+88|0;n=h[a>>2]|0;t=(p[n+68>>0]|0)<<8|(p[n+67>>0]|0)<<16|(p[n+69>>0]|0);r=i+t|0;n=(p[n+65>>0]|0)<<8|(p[n+66>>0]|0);if(!n){e=0;return e|0}h[o>>2]=r;h[e+96>>2]=r;h[e+104>>2]=n;h[e+100>>2]=i+(n+t);h[e+108>>2]=0;h[e+112>>2]=0;if(!(dt(o,e+116|0)|0)){e=0;return e|0}t=h[a>>2]|0;do{if(!((p[t+39>>0]|0)<<8|(p[t+40>>0]|0))){if(!((p[t+55>>0]|0)<<8|(p[t+56>>0]|0))){e=0;return e|0}}else{if(!(dt(o,e+140|0)|0)){e=0;return e|0}if(dt(o,e+188|0)|0){t=h[a>>2]|0;break}else{e=0;return e|0}}}while(0);if((p[t+55>>0]|0)<<8|(p[t+56>>0]|0)){if(!(dt(o,e+164|0)|0)){e=0;return e|0}if(!(dt(o,e+212|0)|0)){e=0;return e|0}}e=1;return e|0}function xt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,f=0,m=0,v=0;v=b;b=b+576|0;s=v;o=v+64|0;m=v+16|0;i=e+88|0;t=h[i>>2]|0;f=(p[t+39>>0]|0)<<8|(p[t+40>>0]|0);u=e+236|0;a=e+240|0;r=h[a>>2]|0;if((r|0)!=(f|0)){if(r>>>0<=f>>>0){do{if((h[e+244>>2]|0)>>>0<f>>>0){if(tt(u,f,(r+1|0)==(f|0),4,0)|0){t=h[a>>2]|0;break}d[e+248>>0]=1;m=0;b=v;return m|0}else t=r}while(0);Xr((h[u>>2]|0)+(t<<2)|0,0,f-t<<2|0)|0;t=h[i>>2]|0}h[a>>2]=f}l=e+92|0;r=h[e+4>>2]|0;i=(p[t+34>>0]|0)<<8|(p[t+33>>0]|0)<<16|(p[t+35>>0]|0);n=r+i|0;t=(p[t+37>>0]|0)<<8|(p[t+36>>0]|0)<<16|(p[t+38>>0]|0);if(!t){m=0;b=v;return m|0}h[l>>2]=n;h[e+96>>2]=n;h[e+104>>2]=t;h[e+100>>2]=r+(t+i);h[e+108>>2]=0;h[e+112>>2]=0;h[m+20>>2]=0;h[m>>2]=0;h[m+4>>2]=0;h[m+8>>2]=0;h[m+12>>2]=0;d[m+16>>0]=0;e=m+24|0;h[m+44>>2]=0;h[e>>2]=0;h[e+4>>2]=0;h[e+8>>2]=0;h[e+12>>2]=0;d[e+16>>0]=0;if(dt(l,m)|0?(c=m+24|0,dt(l,c)|0):0){if(!(h[a>>2]|0)){h[s>>2]=1138;h[s+4>>2]=906;h[s+8>>2]=1769;yr(o,1084,s)|0;_r(o)|0}if(!f)t=1;else{i=0;n=0;a=0;t=0;o=0;e=0;s=0;r=h[u>>2]|0;while(1){i=(ht(l,m)|0)+i&31;n=(ht(l,c)|0)+n&63;a=(ht(l,m)|0)+a&31;t=(ht(l,m)|0)+t|0;o=(ht(l,c)|0)+o&63;e=(ht(l,m)|0)+e&31;h[r>>2]=n<<5|i<<11|a|t<<27|o<<21|e<<16;s=s+1|0;if((s|0)==(f|0)){t=1;break}else{t=t&31;r=r+4|0}}}}else t=0;lt(m+24|0);lt(m);m=t;b=v;return m|0}function Pt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,f=0,m=0,v=0,g=0,_=0,y=0,w=0,C=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0,I=0;O=b;b=b+1008|0;o=O;a=O+496|0;A=O+472|0;x=O+276|0;P=O+80|0;E=O+16|0;n=h[e+88>>2]|0;T=(p[n+47>>0]|0)<<8|(p[n+48>>0]|0);S=e+92|0;t=h[e+4>>2]|0;r=(p[n+42>>0]|0)<<8|(p[n+41>>0]|0)<<16|(p[n+43>>0]|0);i=t+r|0;n=(p[n+45>>0]|0)<<8|(p[n+44>>0]|0)<<16|(p[n+46>>0]|0);if(!n){A=0;b=O;return A|0}h[S>>2]=i;h[e+96>>2]=i;h[e+104>>2]=n;h[e+100>>2]=t+(n+r);h[e+108>>2]=0;h[e+112>>2]=0;h[A+20>>2]=0;h[A>>2]=0;h[A+4>>2]=0;h[A+8>>2]=0;h[A+12>>2]=0;d[A+16>>0]=0;if(dt(S,A)|0){r=0;i=-3;n=-3;while(1){h[x+(r<<2)>>2]=i;h[P+(r<<2)>>2]=n;t=(i|0)>2;r=r+1|0;if((r|0)==49)break;else{i=t?-3:i+1|0;n=(t&1)+n|0}}t=E;r=t+64|0;do{h[t>>2]=0;t=t+4|0}while((t|0)<(r|0));C=e+252|0;r=e+256|0;t=h[r>>2]|0;e:do{if((t|0)==(T|0))s=13;else{if(t>>>0<=T>>>0){do{if((h[e+260>>2]|0)>>>0<T>>>0)if(tt(C,T,(t+1|0)==(T|0),4,0)|0){t=h[r>>2]|0;break}else{d[e+264>>0]=1;t=0;break e}}while(0);Xr((h[C>>2]|0)+(t<<2)|0,0,T-t<<2|0)|0}h[r>>2]=T;s=13}}while(0);do{if((s|0)==13){if(!T){h[o>>2]=1138;h[o+4>>2]=906;h[o+8>>2]=1769;yr(a,1084,o)|0;_r(a)|0;t=1;break}i=E+4|0;n=E+8|0;e=E+12|0;a=E+16|0;o=E+20|0;s=E+24|0;l=E+28|0;u=E+32|0;c=E+36|0;f=E+40|0;m=E+44|0;v=E+48|0;g=E+52|0;_=E+56|0;y=E+60|0;w=0;r=h[C>>2]|0;while(1){t=0;do{D=ht(S,A)|0;C=t<<1;I=E+(C<<2)|0;h[I>>2]=(h[I>>2]|0)+(h[x+(D<<2)>>2]|0)&3;C=E+((C|1)<<2)|0;h[C>>2]=(h[C>>2]|0)+(h[P+(D<<2)>>2]|0)&3;t=t+1|0}while((t|0)!=8);h[r>>2]=(p[1713+(h[i>>2]|0)>>0]|0)<<2|(p[1713+(h[E>>2]|0)>>0]|0)|(p[1713+(h[n>>2]|0)>>0]|0)<<4|(p[1713+(h[e>>2]|0)>>0]|0)<<6|(p[1713+(h[a>>2]|0)>>0]|0)<<8|(p[1713+(h[o>>2]|0)>>0]|0)<<10|(p[1713+(h[s>>2]|0)>>0]|0)<<12|(p[1713+(h[l>>2]|0)>>0]|0)<<14|(p[1713+(h[u>>2]|0)>>0]|0)<<16|(p[1713+(h[c>>2]|0)>>0]|0)<<18|(p[1713+(h[f>>2]|0)>>0]|0)<<20|(p[1713+(h[m>>2]|0)>>0]|0)<<22|(p[1713+(h[v>>2]|0)>>0]|0)<<24|(p[1713+(h[g>>2]|0)>>0]|0)<<26|(p[1713+(h[_>>2]|0)>>0]|0)<<28|(p[1713+(h[y>>2]|0)>>0]|0)<<30;w=w+1|0;if((w|0)==(T|0)){t=1;break}else r=r+4|0}}}while(0)}else t=0;lt(A);I=t;b=O;return I|0}function At(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,m=0;m=b;b=b+560|0;s=m;o=m+40|0;c=m+16|0;n=h[e+88>>2]|0;u=(p[n+55>>0]|0)<<8|(p[n+56>>0]|0);l=e+92|0;t=h[e+4>>2]|0;r=(p[n+50>>0]|0)<<8|(p[n+49>>0]|0)<<16|(p[n+51>>0]|0);i=t+r|0;n=(p[n+53>>0]|0)<<8|(p[n+52>>0]|0)<<16|(p[n+54>>0]|0);if(!n){c=0;b=m;return c|0}h[l>>2]=i;h[e+96>>2]=i;h[e+104>>2]=n;h[e+100>>2]=t+(n+r);h[e+108>>2]=0;h[e+112>>2]=0;h[c+20>>2]=0;h[c>>2]=0;h[c+4>>2]=0;h[c+8>>2]=0;h[c+12>>2]=0;d[c+16>>0]=0;e:do{if(dt(l,c)|0){a=e+268|0;r=e+272|0;t=h[r>>2]|0;if((t|0)!=(u|0)){if(t>>>0<=u>>>0){do{if((h[e+276>>2]|0)>>>0<u>>>0)if(tt(a,u,(t+1|0)==(u|0),2,0)|0){t=h[r>>2]|0;break}else{d[e+280>>0]=1;t=0;break e}}while(0);Xr((h[a>>2]|0)+(t<<1)|0,0,u-t<<1|0)|0}h[r>>2]=u}if(!u){h[s>>2]=1138;h[s+4>>2]=906;h[s+8>>2]=1769;yr(o,1084,s)|0;_r(o)|0;t=1;break}r=0;i=0;n=0;t=h[a>>2]|0;while(1){s=ht(l,c)|0;r=s+r&255;i=(ht(l,c)|0)+i&255;f[t>>1]=i<<8|r;n=n+1|0;if((n|0)==(u|0)){t=1;break}else t=t+2|0}}else t=0}while(0);lt(c);c=t;b=m;return c|0}function Ot(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,m=0,v=0,g=0,_=0,y=0,w=0,C=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0,I=0,M=0;D=b;b=b+2416|0;o=D;a=D+1904|0;O=D+1880|0;P=D+980|0;A=D+80|0;x=D+16|0;n=h[e+88>>2]|0;E=(p[n+63>>0]|0)<<8|(p[n+64>>0]|0);T=e+92|0;t=h[e+4>>2]|0;r=(p[n+58>>0]|0)<<8|(p[n+57>>0]|0)<<16|(p[n+59>>0]|0);i=t+r|0;n=(p[n+61>>0]|0)<<8|(p[n+60>>0]|0)<<16|(p[n+62>>0]|0);if(!n){O=0;b=D;return O|0}h[T>>2]=i;h[e+96>>2]=i;h[e+104>>2]=n;h[e+100>>2]=t+(n+r);h[e+108>>2]=0;h[e+112>>2]=0;h[O+20>>2]=0;h[O>>2]=0;h[O+4>>2]=0;h[O+8>>2]=0;h[O+12>>2]=0;d[O+16>>0]=0;if(dt(T,O)|0){r=0;i=-7;n=-7;while(1){h[P+(r<<2)>>2]=i;h[A+(r<<2)>>2]=n;t=(i|0)>6;r=r+1|0;if((r|0)==225)break;else{i=t?-7:i+1|0;n=(t&1)+n|0}}t=x;r=t+64|0;do{h[t>>2]=0;t=t+4|0}while((t|0)<(r|0));S=e+284|0;r=E*3|0;i=e+288|0;t=h[i>>2]|0;e:do{if((t|0)==(r|0))s=13;else{if(t>>>0<=r>>>0){do{if((h[e+292>>2]|0)>>>0<r>>>0)if(tt(S,r,(t+1|0)==(r|0),2,0)|0){t=h[i>>2]|0;break}else{d[e+296>>0]=1;t=0;break e}}while(0);Xr((h[S>>2]|0)+(t<<1)|0,0,r-t<<1|0)|0}h[i>>2]=r;s=13}}while(0);do{if((s|0)==13){if(!E){h[o>>2]=1138;h[o+4>>2]=906;h[o+8>>2]=1769;yr(a,1084,o)|0;_r(a)|0;t=1;break}i=x+4|0;n=x+8|0;e=x+12|0;a=x+16|0;o=x+20|0;s=x+24|0;l=x+28|0;u=x+32|0;c=x+36|0;m=x+40|0;v=x+44|0;g=x+48|0;_=x+52|0;y=x+56|0;w=x+60|0;C=0;r=h[S>>2]|0;while(1){t=0;do{I=ht(T,O)|0;S=t<<1;M=x+(S<<2)|0;h[M>>2]=(h[M>>2]|0)+(h[P+(I<<2)>>2]|0)&7;S=x+((S|1)<<2)|0;h[S>>2]=(h[S>>2]|0)+(h[A+(I<<2)>>2]|0)&7;t=t+1|0}while((t|0)!=8);I=p[1717+(h[o>>2]|0)>>0]|0;f[r>>1]=(p[1717+(h[i>>2]|0)>>0]|0)<<3|(p[1717+(h[x>>2]|0)>>0]|0)|(p[1717+(h[n>>2]|0)>>0]|0)<<6|(p[1717+(h[e>>2]|0)>>0]|0)<<9|(p[1717+(h[a>>2]|0)>>0]|0)<<12|I<<15;M=p[1717+(h[m>>2]|0)>>0]|0;f[r+2>>1]=(p[1717+(h[s>>2]|0)>>0]|0)<<2|I>>>1|(p[1717+(h[l>>2]|0)>>0]|0)<<5|(p[1717+(h[u>>2]|0)>>0]|0)<<8|(p[1717+(h[c>>2]|0)>>0]|0)<<11|M<<14;f[r+4>>1]=(p[1717+(h[v>>2]|0)>>0]|0)<<1|M>>>2|(p[1717+(h[g>>2]|0)>>0]|0)<<4|(p[1717+(h[_>>2]|0)>>0]|0)<<7|(p[1717+(h[y>>2]|0)>>0]|0)<<10|(p[1717+(h[w>>2]|0)>>0]|0)<<13;C=C+1|0;if((C|0)==(E|0)){t=1;break}else r=r+6|0}}}while(0)}else t=0;lt(O);M=t;b=D;return M|0}function Dt(e,t,r,i,n,a,o,s){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;s=s|0;var l=0,u=0,c=0,f=0,m=0,v=0,g=0,_=0,y=0,w=0,C=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0,I=0,M=0,R=0,L=0,N=0,k=0,F=0,B=0,U=0,V=0,z=0,q=0,G=0,H=0,j=0,W=0,Y=0,X=0,Q=0,Z=0,K=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,ae=0,oe=0,se=0,le=0;oe=b;b=b+656|0;ne=oe+112|0;re=oe+96|0;te=oe+80|0;ee=oe+64|0;$=oe+48|0;ae=oe+32|0;ie=oe+16|0;J=oe;Z=oe+144|0;K=oe+128|0;G=e+240|0;H=h[G>>2]|0;Y=e+256|0;X=h[Y>>2]|0;r=d[(h[e+88>>2]|0)+17>>0]|0;Q=i>>>2;if(!(r<<24>>24)){b=oe;return 1}j=(s|0)==0;W=s+-1|0;k=(a&1|0)!=0;F=i<<1;B=e+92|0;U=e+116|0;V=e+140|0;z=e+236|0;q=o+-1|0;N=(n&1|0)!=0;L=e+188|0;O=e+252|0;D=Q+1|0;I=Q+2|0;M=Q+3|0;R=q<<4;P=r&255;r=0;a=0;n=1;A=0;do{if(!j){E=h[t+(A<<2)>>2]|0;x=0;while(1){C=x&1;l=(C|0)==0;w=(C<<5^32)+-16|0;C=(C<<1^2)+-1|0;T=l?o:-1;u=l?0:q;e=(x|0)==(W|0);S=k&e;if((u|0)!=(T|0)){y=k&e^1;_=l?E:E+R|0;while(1){if((n|0)==1)n=ht(B,U)|0|512;g=n&7;n=n>>>3;l=p[1811+g>>0]|0;e=0;do{m=(ht(B,V)|0)+a|0;v=m-H|0;a=v>>31;a=a&m|v&~a;if((h[G>>2]|0)>>>0<=a>>>0){h[J>>2]=1138;h[J+4>>2]=906;h[J+8>>2]=1769;yr(Z,1084,J)|0;_r(Z)|0}h[K+(e<<2)>>2]=h[(h[z>>2]|0)+(a<<2)>>2];e=e+1|0}while(e>>>0<l>>>0);v=N&(u|0)==(q|0);if(S|v){m=0;do{c=ce(m,i)|0;e=_+c|0;l=(m|0)==0|y;f=m<<1;le=(ht(B,L)|0)+r|0;se=le-X|0;r=se>>31;r=r&le|se&~r;do{if(v){if(!l){se=(ht(B,L)|0)+r|0;le=se-X|0;r=le>>31;r=r&se|le&~r;break}h[e>>2]=h[K+((p[1819+(g<<2)+f>>0]|0)<<2)>>2];if((h[Y>>2]|0)>>>0<=r>>>0){h[re>>2]=1138;h[re+4>>2]=906;h[re+8>>2]=1769;yr(Z,1084,re)|0;_r(Z)|0}h[_+(c+4)>>2]=h[(h[O>>2]|0)+(r<<2)>>2];se=(ht(B,L)|0)+r|0;le=se-X|0;r=le>>31;r=r&se|le&~r}else{if(!l){se=(ht(B,L)|0)+r|0;le=se-X|0;r=le>>31;r=r&se|le&~r;break}h[e>>2]=h[K+((p[1819+(g<<2)+f>>0]|0)<<2)>>2];if((h[Y>>2]|0)>>>0<=r>>>0){h[te>>2]=1138;h[te+4>>2]=906;h[te+8>>2]=1769;yr(Z,1084,te)|0;_r(Z)|0}h[_+(c+4)>>2]=h[(h[O>>2]|0)+(r<<2)>>2];se=(ht(B,L)|0)+r|0;le=se-X|0;r=le>>31;r=r&se|le&~r;h[_+(c+8)>>2]=h[K+((p[(f|1)+(1819+(g<<2))>>0]|0)<<2)>>2];if((h[Y>>2]|0)>>>0<=r>>>0){h[ne>>2]=1138;h[ne+4>>2]=906;h[ne+8>>2]=1769;yr(Z,1084,ne)|0;_r(Z)|0}h[_+(c+12)>>2]=h[(h[O>>2]|0)+(r<<2)>>2]}}while(0);m=m+1|0}while((m|0)!=2)}else{h[_>>2]=h[K+((p[1819+(g<<2)>>0]|0)<<2)>>2];se=(ht(B,L)|0)+r|0;le=se-X|0;r=le>>31;r=r&se|le&~r;if((h[Y>>2]|0)>>>0<=r>>>0){h[ie>>2]=1138;h[ie+4>>2]=906;h[ie+8>>2]=1769;yr(Z,1084,ie)|0;_r(Z)|0}h[_+4>>2]=h[(h[O>>2]|0)+(r<<2)>>2];h[_+8>>2]=h[K+((p[1819+(g<<2)+1>>0]|0)<<2)>>2];se=(ht(B,L)|0)+r|0;le=se-X|0;r=le>>31;r=r&se|le&~r;if((h[Y>>2]|0)>>>0<=r>>>0){h[ae>>2]=1138;h[ae+4>>2]=906;h[ae+8>>2]=1769;yr(Z,1084,ae)|0;_r(Z)|0}h[_+12>>2]=h[(h[O>>2]|0)+(r<<2)>>2];h[_+(Q<<2)>>2]=h[K+((p[1819+(g<<2)+2>>0]|0)<<2)>>2];se=(ht(B,L)|0)+r|0;le=se-X|0;r=le>>31;r=r&se|le&~r;if((h[Y>>2]|0)>>>0<=r>>>0){h[$>>2]=1138;h[$+4>>2]=906;h[$+8>>2]=1769;yr(Z,1084,$)|0;_r(Z)|0}h[_+(D<<2)>>2]=h[(h[O>>2]|0)+(r<<2)>>2];h[_+(I<<2)>>2]=h[K+((p[1819+(g<<2)+3>>0]|0)<<2)>>2];se=(ht(B,L)|0)+r|0;le=se-X|0;r=le>>31;r=r&se|le&~r;if((h[Y>>2]|0)>>>0<=r>>>0){h[ee>>2]=1138;h[ee+4>>2]=906;h[ee+8>>2]=1769;yr(Z,1084,ee)|0;_r(Z)|0}h[_+(M<<2)>>2]=h[(h[O>>2]|0)+(r<<2)>>2]}u=u+C|0;if((u|0)==(T|0))break;else _=_+w|0}}x=x+1|0;if((x|0)==(s|0))break;else E=E+F|0}}A=A+1|0}while((A|0)!=(P|0));b=oe;return 1}function It(e,t,r,i,n,a,o,s){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;s=s|0;var l=0,u=0,c=0,f=0,v=0,g=0,_=0,y=0,w=0,C=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0,I=0,M=0,R=0,L=0,N=0,k=0,F=0,B=0,U=0,V=0,z=0,q=0,G=0,H=0,j=0,W=0,Y=0,X=0,Q=0,Z=0,K=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,ae=0,oe=0,se=0,le=0,ue=0,ce=0,de=0,fe=0,he=0;fe=b;b=b+608|0;ue=fe+48|0;de=fe+32|0;ce=fe+16|0;le=fe;oe=fe+96|0;se=fe+80|0;ae=fe+64|0;H=e+240|0;j=h[H>>2]|0;X=e+256|0;re=h[X>>2]|0;ie=e+272|0;ne=h[ie>>2]|0;r=h[e+88>>2]|0;W=(p[r+63>>0]|0)<<8|(p[r+64>>0]|0);r=d[r+17>>0]|0;if(!(r<<24>>24)){b=fe;return 1}Y=(s|0)==0;Q=s+-1|0;Z=i<<1;K=e+92|0;J=e+116|0;$=o+-1|0;ee=e+212|0;te=e+188|0;G=(n&1|0)==0;q=(a&1|0)==0;k=e+288|0;F=e+284|0;B=e+252|0;U=e+140|0;V=e+236|0;z=e+164|0;L=e+268|0;N=$<<5;M=r&255;r=0;n=0;a=0;e=0;l=1;R=0;do{if(!Y){D=h[t+(R<<2)>>2]|0;I=0;while(1){A=I&1;u=(A|0)==0;P=(A<<6^64)+-32|0;A=(A<<1^2)+-1|0;O=u?o:-1;c=u?0:$;if((c|0)!=(O|0)){x=q|(I|0)!=(Q|0);E=u?D:D+N|0;while(1){if((l|0)==1)l=ht(K,J)|0|512;T=l&7;l=l>>>3;f=p[1811+T>>0]|0;u=0;do{C=(ht(K,z)|0)+n|0;S=C-ne|0;n=S>>31;n=n&C|S&~n;if((h[ie>>2]|0)>>>0<=n>>>0){h[le>>2]=1138;h[le+4>>2]=906;h[le+8>>2]=1769;yr(oe,1084,le)|0;_r(oe)|0}h[ae+(u<<2)>>2]=m[(h[L>>2]|0)+(n<<1)>>1];u=u+1|0}while(u>>>0<f>>>0);u=0;do{C=(ht(K,U)|0)+e|0;S=C-j|0;e=S>>31;e=e&C|S&~e;if((h[H>>2]|0)>>>0<=e>>>0){h[ce>>2]=1138;h[ce+4>>2]=906;h[ce+8>>2]=1769;yr(oe,1084,ce)|0;_r(oe)|0}h[se+(u<<2)>>2]=h[(h[V>>2]|0)+(e<<2)>>2];u=u+1|0}while(u>>>0<f>>>0);S=G|(c|0)!=($|0);w=0;C=E;while(1){y=x|(w|0)==0;_=w<<1;v=0;g=C;while(1){f=(ht(K,ee)|0)+r|0;u=f-W|0;r=u>>31;r=r&f|u&~r;u=(ht(K,te)|0)+a|0;f=u-re|0;a=f>>31;a=a&u|f&~a;if((S|(v|0)==0)&y){u=p[v+_+(1819+(T<<2))>>0]|0;f=r*3|0;if((h[k>>2]|0)>>>0<=f>>>0){h[de>>2]=1138;h[de+4>>2]=906;h[de+8>>2]=1769;yr(oe,1084,de)|0;_r(oe)|0}he=h[F>>2]|0;h[g>>2]=(m[he+(f<<1)>>1]|0)<<16|h[ae+(u<<2)>>2];h[g+4>>2]=(m[he+(f+2<<1)>>1]|0)<<16|(m[he+(f+1<<1)>>1]|0);h[g+8>>2]=h[se+(u<<2)>>2];if((h[X>>2]|0)>>>0<=a>>>0){h[ue>>2]=1138;h[ue+4>>2]=906;h[ue+8>>2]=1769;yr(oe,1084,ue)|0;_r(oe)|0}h[g+12>>2]=h[(h[B>>2]|0)+(a<<2)>>2]}v=v+1|0;if((v|0)==2)break;else g=g+16|0}w=w+1|0;if((w|0)==2)break;else C=C+i|0}c=c+A|0;if((c|0)==(O|0))break;else E=E+P|0}}I=I+1|0;if((I|0)==(s|0))break;else D=D+Z|0}}R=R+1|0}while((R|0)!=(M|0));b=fe;return 1}function Mt(e,t,r,i,n,a,o,s){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;s=s|0;var l=0,u=0,c=0,f=0,v=0,g=0,_=0,y=0,w=0,C=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0,I=0,M=0,R=0,L=0,N=0,k=0,F=0,B=0,U=0,V=0,z=0,q=0,G=0,H=0,j=0,W=0,Y=0,X=0,Q=0,Z=0,K=0,J=0,$=0;$=b;b=b+576|0;J=$+32|0;K=$+16|0;Z=$;Q=$+64|0;X=$+48|0;B=e+272|0;U=h[B>>2]|0;r=h[e+88>>2]|0;V=(p[r+63>>0]|0)<<8|(p[r+64>>0]|0);r=d[r+17>>0]|0;if(!(r<<24>>24)){b=$;return 1}z=(s|0)==0;q=s+-1|0;G=i<<1;H=e+92|0;j=e+116|0;W=o+-1|0;Y=e+212|0;F=(a&1|0)==0;L=e+288|0;N=e+284|0;k=e+164|0;M=e+268|0;R=W<<4;I=r&255;D=(n&1|0)!=0;r=0;a=0;e=1;O=0;do{if(!z){P=h[t+(O<<2)>>2]|0;A=0;while(1){E=A&1;n=(E|0)==0;T=(E<<5^32)+-16|0;E=(E<<1^2)+-1|0;x=n?o:-1;l=n?0:W;if((l|0)!=(x|0)){S=F|(A|0)!=(q|0);C=n?P:P+R|0;while(1){if((e|0)==1)e=ht(H,j)|0|512;w=e&7;e=e>>>3;u=p[1811+w>>0]|0;n=0;do{_=(ht(H,k)|0)+a|0;y=_-U|0;a=y>>31;a=a&_|y&~a;if((h[B>>2]|0)>>>0<=a>>>0){h[Z>>2]=1138;h[Z+4>>2]=906;h[Z+8>>2]=1769;yr(Q,1084,Z)|0;_r(Q)|0}h[X+(n<<2)>>2]=m[(h[M>>2]|0)+(a<<1)>>1];n=n+1|0}while(n>>>0<u>>>0);y=(l|0)==(W|0)&D;g=0;_=C;while(1){v=S|(g|0)==0;f=g<<1;n=(ht(H,Y)|0)+r|0;c=n-V|0;u=c>>31;u=u&n|c&~u;if(v){r=p[1819+(w<<2)+f>>0]|0;n=u*3|0;if((h[L>>2]|0)>>>0<=n>>>0){h[K>>2]=1138;h[K+4>>2]=906;h[K+8>>2]=1769;yr(Q,1084,K)|0;_r(Q)|0}c=h[N>>2]|0;h[_>>2]=(m[c+(n<<1)>>1]|0)<<16|h[X+(r<<2)>>2];h[_+4>>2]=(m[c+(n+2<<1)>>1]|0)<<16|(m[c+(n+1<<1)>>1]|0)}c=_+8|0;n=(ht(H,Y)|0)+u|0;u=n-V|0;r=u>>31;r=r&n|u&~r;if(!(y|v^1)){n=p[(f|1)+(1819+(w<<2))>>0]|0;u=r*3|0;if((h[L>>2]|0)>>>0<=u>>>0){h[J>>2]=1138;h[J+4>>2]=906;h[J+8>>2]=1769;yr(Q,1084,J)|0;_r(Q)|0}v=h[N>>2]|0;h[c>>2]=(m[v+(u<<1)>>1]|0)<<16|h[X+(n<<2)>>2];h[_+12>>2]=(m[v+(u+2<<1)>>1]|0)<<16|(m[v+(u+1<<1)>>1]|0)}g=g+1|0;if((g|0)==2)break;else _=_+i|0}l=l+E|0;if((l|0)==(x|0))break;else C=C+T|0}}A=A+1|0;if((A|0)==(s|0))break;else P=P+G|0}}O=O+1|0}while((O|0)!=(I|0));b=$;return 1}function Rt(e,t,r,i,n,a,o,s){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;s=s|0;var l=0,u=0,c=0,f=0,v=0,g=0,_=0,y=0,w=0,C=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0,I=0,M=0,R=0,L=0,N=0,k=0,F=0,B=0,U=0,V=0,z=0,q=0,G=0,H=0,j=0,W=0,Y=0,X=0,Q=0,Z=0,K=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,ae=0,oe=0,se=0;se=b;b=b+608|0;ne=se+48|0;oe=se+32|0;ae=se+16|0;ie=se;re=se+96|0;ee=se+80|0;te=se+64|0;H=e+272|0;j=h[H>>2]|0;r=h[e+88>>2]|0;W=(p[r+63>>0]|0)<<8|(p[r+64>>0]|0);r=d[r+17>>0]|0;if(!(r<<24>>24)){b=se;return 1}Y=(s|0)==0;X=s+-1|0;Q=i<<1;Z=e+92|0;K=e+116|0;J=o+-1|0;$=e+212|0;G=(n&1|0)==0;q=(a&1|0)==0;U=e+288|0;V=e+284|0;z=e+164|0;F=e+268|0;B=J<<5;N=r&255;r=0;n=0;a=0;e=0;l=1;k=0;do{if(!Y){R=h[t+(k<<2)>>2]|0;L=0;while(1){I=L&1;u=(I|0)==0;D=(I<<6^64)+-32|0;I=(I<<1^2)+-1|0;M=u?o:-1;c=u?0:J;if((c|0)!=(M|0)){O=q|(L|0)!=(X|0);A=u?R:R+B|0;while(1){if((l|0)==1)l=ht(Z,K)|0|512;P=l&7;l=l>>>3;f=p[1811+P>>0]|0;u=0;do{E=(ht(Z,z)|0)+e|0;x=E-j|0;e=x>>31;e=e&E|x&~e;if((h[H>>2]|0)>>>0<=e>>>0){h[ie>>2]=1138;h[ie+4>>2]=906;h[ie+8>>2]=1769;yr(re,1084,ie)|0;_r(re)|0}h[ee+(u<<2)>>2]=m[(h[F>>2]|0)+(e<<1)>>1];u=u+1|0}while(u>>>0<f>>>0);u=0;do{E=(ht(Z,z)|0)+n|0;x=E-j|0;n=x>>31;n=n&E|x&~n;if((h[H>>2]|0)>>>0<=n>>>0){h[ae>>2]=1138;h[ae+4>>2]=906;h[ae+8>>2]=1769;yr(re,1084,ae)|0;_r(re)|0}h[te+(u<<2)>>2]=m[(h[F>>2]|0)+(n<<1)>>1];u=u+1|0}while(u>>>0<f>>>0);x=G|(c|0)!=(J|0);T=0;E=A;while(1){S=O|(T|0)==0;C=T<<1;y=0;w=E;while(1){_=(ht(Z,$)|0)+a|0;g=_-W|0;a=g>>31;a=a&_|g&~a;g=(ht(Z,$)|0)+r|0;_=g-W|0;r=_>>31;r=r&g|_&~r;if((x|(y|0)==0)&S){g=p[y+C+(1819+(P<<2))>>0]|0;_=a*3|0;u=h[U>>2]|0;if(u>>>0<=_>>>0){h[oe>>2]=1138;h[oe+4>>2]=906;h[oe+8>>2]=1769;yr(re,1084,oe)|0;_r(re)|0;u=h[U>>2]|0}f=h[V>>2]|0;v=r*3|0;if(u>>>0>v>>>0)u=f;else{h[ne>>2]=1138;h[ne+4>>2]=906;h[ne+8>>2]=1769;yr(re,1084,ne)|0;_r(re)|0;u=h[V>>2]|0}h[w>>2]=(m[f+(_<<1)>>1]|0)<<16|h[ee+(g<<2)>>2];h[w+4>>2]=(m[f+(_+2<<1)>>1]|0)<<16|(m[f+(_+1<<1)>>1]|0);h[w+8>>2]=(m[u+(v<<1)>>1]|0)<<16|h[te+(g<<2)>>2];h[w+12>>2]=(m[u+(v+2<<1)>>1]|0)<<16|(m[u+(v+1<<1)>>1]|0)}y=y+1|0;if((y|0)==2)break;else w=w+16|0}T=T+1|0;if((T|0)==2)break;else E=E+i|0}c=c+I|0;if((c|0)==(M|0))break;else A=A+D|0}}L=L+1|0;if((L|0)==(s|0))break;else R=R+Q|0}}k=k+1|0}while((k|0)!=(N|0));b=se;return 1}function Lt(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,l=0;l=b;b=b+576|0;s=l+48|0;a=l+32|0;n=l+16|0;i=l;o=l+64|0;h[e>>2]=0;t=e+284|0;r=h[t>>2]|0;if(r){if(!(r&7))at(r,0,0,1,0)|0;else{h[i>>2]=1138;h[i+4>>2]=2502;h[i+8>>2]=1504;yr(o,1084,i)|0;_r(o)|0}h[t>>2]=0;h[e+288>>2]=0;h[e+292>>2]=0}d[e+296>>0]=0;r=e+268|0;t=h[r>>2]|0;if(t){if(!(t&7))at(t,0,0,1,0)|0;else{h[n>>2]=1138;h[n+4>>2]=2502;h[n+8>>2]=1504;yr(o,1084,n)|0;_r(o)|0}h[r>>2]=0;h[e+272>>2]=0;h[e+276>>2]=0}d[e+280>>0]=0;t=e+252|0;r=h[t>>2]|0;if(r){if(!(r&7))at(r,0,0,1,0)|0;else{h[a>>2]=1138;h[a+4>>2]=2502;h[a+8>>2]=1504;yr(o,1084,a)|0;_r(o)|0}h[t>>2]=0;h[e+256>>2]=0;h[e+260>>2]=0}d[e+264>>0]=0;t=e+236|0;r=h[t>>2]|0;if(!r){s=e+248|0;d[s>>0]=0;s=e+212|0;lt(s);s=e+188|0;lt(s);s=e+164|0;lt(s);s=e+140|0;lt(s);s=e+116|0;lt(s);b=l;return}if(!(r&7))at(r,0,0,1,0)|0;else{h[s>>2]=1138;h[s+4>>2]=2502;h[s+8>>2]=1504;yr(o,1084,s)|0;_r(o)|0}h[t>>2]=0;h[e+240>>2]=0;h[e+244>>2]=0;s=e+248|0;d[s>>0]=0;s=e+212|0;lt(s);s=e+188|0;lt(s);s=e+164|0;lt(s);s=e+140|0;lt(s);s=e+116|0;lt(s);b=l;return}function Nt(e,t){e=e|0;t=t|0;var r=0;r=b;b=b+16|0;h[r>>2]=t;t=h[60]|0;br(t,e,r)|0;pr(10,t)|0;Oe()}function kt(){var e=0,t=0;e=b;b=b+16|0;if(!(Ue(192,2)|0)){t=Te(h[47]|0)|0;b=e;return t|0}else Nt(2078,e);return 0}function Ft(e){e=e|0;Vr(e);return}function Bt(e){e=e|0;var t=0;t=b;b=b+16|0;Ai[e&3]();Nt(2127,t)}function Ut(){var e=0,t=0;e=kt()|0;if(((e|0)!=0?(t=h[e>>2]|0,(t|0)!=0):0)?(e=t+48|0,(h[e>>2]&-256|0)==1126902528?(h[e+4>>2]|0)==1129074247:0):0)Bt(h[t+12>>2]|0);t=h[26]|0;h[26]=t+0;Bt(t)}function Vt(e){e=e|0;return}function zt(e){e=e|0;return}function qt(e){e=e|0;return}function Gt(e){e=e|0;return}function Ht(e){e=e|0;Ft(e);return}function jt(e){e=e|0;Ft(e);return}function Wt(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0;o=b;b=b+64|0;a=o;if((e|0)!=(t|0))if((t|0)!=0?(n=Zt(t,24,40,0)|0,(n|0)!=0):0){t=a;i=t+56|0;do{h[t>>2]=0;t=t+4|0}while((t|0)<(i|0));h[a>>2]=n;h[a+8>>2]=e;h[a+12>>2]=-1;h[a+48>>2]=1;Di[h[(h[n>>2]|0)+28>>2]&3](n,a,h[r>>2]|0,1);if((h[a+24>>2]|0)==1){h[r>>2]=h[a+16>>2];t=1}else t=0}else t=0;else t=1;b=o;return t|0}function Yt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0;e=t+16|0;n=h[e>>2]|0;do{if(n){if((n|0)!=(r|0)){i=t+36|0;h[i>>2]=(h[i>>2]|0)+1;h[t+24>>2]=2;d[t+54>>0]=1;break}e=t+24|0;if((h[e>>2]|0)==2)h[e>>2]=i}else{h[e>>2]=r;h[t+24>>2]=i;h[t+36>>2]=1}}while(0);return}function Xt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;if((e|0)==(h[t+8>>2]|0))Yt(0,t,r,i);return}function Qt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;if((e|0)==(h[t+8>>2]|0))Yt(0,t,r,i);else{e=h[e+8>>2]|0;Di[h[(h[e>>2]|0)+28>>2]&3](e,t,r,i)}return}function Zt(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,l=0,u=0,c=0,p=0,m=0,v=0;v=b;b=b+64|0;m=v;p=h[e>>2]|0;c=e+(h[p+-8>>2]|0)|0;p=h[p+-4>>2]|0;h[m>>2]=r;h[m+4>>2]=e;h[m+8>>2]=t;h[m+12>>2]=i;i=m+16|0;e=m+20|0;t=m+24|0;n=m+28|0;a=m+32|0;o=m+40|0;s=(p|0)==(r|0);l=i;u=l+36|0;do{h[l>>2]=0;l=l+4|0}while((l|0)<(u|0));f[i+36>>1]=0;d[i+38>>0]=0;e:do{if(s){h[m+48>>2]=1;Oi[h[(h[r>>2]|0)+20>>2]&3](r,m,c,c,1,0);i=(h[t>>2]|0)==1?c:0}else{Ti[h[(h[p>>2]|0)+24>>2]&3](p,m,c,1,0);switch(h[m+36>>2]|0){case 0:{i=(h[o>>2]|0)==1&(h[n>>2]|0)==1&(h[a>>2]|0)==1?h[e>>2]|0:0;break e}case 1:break;default:{i=0;break e}}if((h[t>>2]|0)!=1?!((h[o>>2]|0)==0&(h[n>>2]|0)==1&(h[a>>2]|0)==1):0){i=0;break}i=h[i>>2]|0}}while(0);b=v;return i|0}function Kt(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;d[t+53>>0]=1;do{if((h[t+4>>2]|0)==(i|0)){d[t+52>>0]=1;i=t+16|0;e=h[i>>2]|0;if(!e){h[i>>2]=r;h[t+24>>2]=n;h[t+36>>2]=1;if(!((n|0)==1?(h[t+48>>2]|0)==1:0))break;d[t+54>>0]=1;break}if((e|0)!=(r|0)){n=t+36|0;h[n>>2]=(h[n>>2]|0)+1;d[t+54>>0]=1;break}e=t+24|0;i=h[e>>2]|0;if((i|0)==2){h[e>>2]=n;i=n}if((i|0)==1?(h[t+48>>2]|0)==1:0)d[t+54>>0]=1}}while(0);return}function Jt(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,l=0;e:do{if((e|0)==(h[t+8>>2]|0)){if((h[t+4>>2]|0)==(r|0)?(a=t+28|0,(h[a>>2]|0)!=1):0)h[a>>2]=i}else{if((e|0)!=(h[t>>2]|0)){s=h[e+8>>2]|0;Ti[h[(h[s>>2]|0)+24>>2]&3](s,t,r,i,n);break}if((h[t+16>>2]|0)!=(r|0)?(o=t+20|0,(h[o>>2]|0)!=(r|0)):0){h[t+32>>2]=i;i=t+44|0;if((h[i>>2]|0)==4)break;a=t+52|0;d[a>>0]=0;l=t+53|0;d[l>>0]=0;e=h[e+8>>2]|0;Oi[h[(h[e>>2]|0)+20>>2]&3](e,t,r,r,1,n);if(d[l>>0]|0){if(!(d[a>>0]|0)){a=1;s=13}}else{a=0;s=13}do{if((s|0)==13){h[o>>2]=r;l=t+40|0;h[l>>2]=(h[l>>2]|0)+1;if((h[t+36>>2]|0)==1?(h[t+24>>2]|0)==2:0){d[t+54>>0]=1;if(a)break}else s=16;if((s|0)==16?a:0)break;h[i>>2]=4;break e}}while(0);h[i>>2]=3;break}if((i|0)==1)h[t+32>>2]=1}}while(0);return}function $t(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0;do{if((e|0)==(h[t+8>>2]|0)){if((h[t+4>>2]|0)==(r|0)?(o=t+28|0,(h[o>>2]|0)!=1):0)h[o>>2]=i}else if((e|0)==(h[t>>2]|0)){if((h[t+16>>2]|0)!=(r|0)?(a=t+20|0,(h[a>>2]|0)!=(r|0)):0){h[t+32>>2]=i;h[a>>2]=r;n=t+40|0;h[n>>2]=(h[n>>2]|0)+1;if((h[t+36>>2]|0)==1?(h[t+24>>2]|0)==2:0)d[t+54>>0]=1;h[t+44>>2]=4;break}if((i|0)==1)h[t+32>>2]=1}}while(0);return}function er(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;if((e|0)==(h[t+8>>2]|0))Kt(0,t,r,i,n);else{e=h[e+8>>2]|0;Oi[h[(h[e>>2]|0)+20>>2]&3](e,t,r,i,n,a)}return}function tr(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;if((e|0)==(h[t+8>>2]|0))Kt(0,t,r,i,n);return}function rr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0;n=b;b=b+16|0;i=n;h[i>>2]=h[r>>2];e=Si[h[(h[e>>2]|0)+16>>2]&7](e,t,i)|0;if(e)h[r>>2]=h[i>>2];b=n;return e&1|0}function ir(e){e=e|0;if(!e)e=0;else e=(Zt(e,24,72,0)|0)!=0;return e&1|0}function nr(){var e=0,t=0,r=0,i=0,n=0,a=0,o=0,s=0;n=b;b=b+48|0;o=n+32|0;r=n+24|0;s=n+16|0;a=n;n=n+36|0;e=kt()|0;if((e|0)!=0?(i=h[e>>2]|0,(i|0)!=0):0){e=i+48|0;t=h[e>>2]|0;e=h[e+4>>2]|0;if(!((t&-256|0)==1126902528&(e|0)==1129074247)){h[r>>2]=2406;Nt(2356,r)}if((t|0)==1126902529&(e|0)==1129074247)e=h[i+44>>2]|0;else e=i+80|0;h[n>>2]=e;i=h[i>>2]|0;e=h[i+4>>2]|0;if(Si[h[(h[8>>2]|0)+16>>2]&7](8,i,n)|0){s=h[n>>2]|0;s=xi[h[(h[s>>2]|0)+8>>2]&1](s)|0;h[a>>2]=2406;h[a+4>>2]=e;h[a+8>>2]=s;Nt(2270,a)}else{h[s>>2]=2406;h[s+4>>2]=e;Nt(2315,s)}}Nt(2394,o)}function ar(){var e=0;e=b;b=b+16|0;if(!(Le(188,6)|0)){b=e;return}else Nt(2167,e)}function or(e){e=e|0;var t=0;t=b;b=b+16|0;Vr(e);if(!(Ee(h[47]|0,0)|0)){b=t;return}else Nt(2217,t)}function sr(e){e=e|0;var t=0,r=0;t=0;while(1){if((p[2415+t>>0]|0)==(e|0)){r=2;break}t=t+1|0;if((t|0)==87){t=87;e=2503;r=5;break}}if((r|0)==2)if(!t)e=2503;else{e=2503;r=5}if((r|0)==5)while(1){r=e;while(1){e=r+1|0;if(!(d[r>>0]|0))break;else r=e}t=t+-1|0;if(!t)break;else r=5}return e|0}function lr(){var e=0;if(!0)e=248;else{e=(Ae()|0)+60|0;e=h[e>>2]|0}return e|0}function ur(e){e=e|0;var t=0;if(e>>>0>4294963200){t=lr()|0;h[t>>2]=0-e;e=-1}return e|0}function cr(e,t){e=+e;t=t|0;var r=0,i=0,n=0;_[C>>3]=e;r=h[C>>2]|0;i=h[C+4>>2]|0;n=Qr(r|0,i|0,52)|0;n=n&2047;switch(n|0){case 0:{if(e!=0.0){e=+cr(e*18446744073709552.0e3,t);r=(h[t>>2]|0)+-64|0}else r=0;h[t>>2]=r;break}case 2047:break;default:{h[t>>2]=n+-1022;h[C>>2]=r;h[C+4>>2]=i&-2146435073|1071644672;e=+_[C>>3]}}return+e}function dr(e,t){e=+e;t=t|0;return+ +cr(e,t)}function fr(e,t,r){e=e|0;t=t|0;r=r|0;do{if(e){if(t>>>0<128){d[e>>0]=t;e=1;break}if(t>>>0<2048){d[e>>0]=t>>>6|192;d[e+1>>0]=t&63|128;e=2;break}if(t>>>0<55296|(t&-8192|0)==57344){d[e>>0]=t>>>12|224;d[e+1>>0]=t>>>6&63|128;d[e+2>>0]=t&63|128;e=3;break}if((t+-65536|0)>>>0<1048576){d[e>>0]=t>>>18|240;d[e+1>>0]=t>>>12&63|128;d[e+2>>0]=t>>>6&63|128;d[e+3>>0]=t&63|128;e=4;break}else{e=lr()|0;h[e>>2]=84;e=-1;break}}else e=1}while(0);return e|0}function hr(e,t){e=e|0;t=t|0;if(!e)e=0;else e=fr(e,t,0)|0;return e|0}function pr(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0;if((h[t+76>>2]|0)>=0?(Sr(t)|0)!=0:0){if((d[t+75>>0]|0)!=(e|0)?(i=t+20|0,n=h[i>>2]|0,n>>>0<(h[t+16>>2]|0)>>>0):0){h[i>>2]=n+1;d[n>>0]=e;r=e&255}else r=Er(t,e)|0;Tr(t)}else o=3;do{if((o|0)==3){if((d[t+75>>0]|0)!=(e|0)?(a=t+20|0,r=h[a>>2]|0,r>>>0<(h[t+16>>2]|0)>>>0):0){h[a>>2]=r+1;d[r>>0]=e;r=e&255;break}r=Er(t,e)|0}}while(0);return r|0}function mr(e,t){e=e|0;t=t|0;return(gr(e,Mr(e)|0,1,t)|0)+-1|0}function vr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0;i=r+16|0;n=h[i>>2]|0;if(!n)if(!(Dr(r)|0)){n=h[i>>2]|0;a=4}else i=0;else a=4;e:do{if((a|0)==4){o=r+20|0;a=h[o>>2]|0;if((n-a|0)>>>0<t>>>0){i=Si[h[r+36>>2]&7](r,e,t)|0;break}t:do{if((d[r+75>>0]|0)>-1){i=t;while(1){if(!i){n=a;i=0;break t}n=i+-1|0;if((d[e+n>>0]|0)==10)break;else i=n}if((Si[h[r+36>>2]&7](r,e,i)|0)>>>0<i>>>0)break e;t=t-i|0;e=e+i|0;n=h[o>>2]|0}else{n=a;i=0}}while(0);Kr(n|0,e|0,t|0)|0;h[o>>2]=(h[o>>2]|0)+t;i=i+t|0}}while(0);return i|0}function gr(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0;n=ce(r,t)|0;if((h[i+76>>2]|0)>-1){a=(Sr(i)|0)==0;e=vr(e,n,i)|0;if(!a)Tr(i)}else e=vr(e,n,i)|0;if((e|0)!=(n|0))r=(e>>>0)/(t>>>0)|0;return r|0}function _r(e){e=e|0;var t=0,r=0,i=0,n=0;i=h[61]|0;if((h[i+76>>2]|0)>-1)n=Sr(i)|0;else n=0;do{if((mr(e,i)|0)<0)t=1;else{if((d[i+75>>0]|0)!=10?(t=i+20|0,r=h[t>>2]|0,r>>>0<(h[i+16>>2]|0)>>>0):0){h[t>>2]=r+1;d[r>>0]=10;t=0;break}t=(Er(i,10)|0)<0}}while(0);if(n)Tr(i);return t<<31>>31|0}function yr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0;i=b;b=b+16|0;n=i;h[n>>2]=r;r=Cr(e,t,n)|0;b=i;return r|0}function br(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,f=0,p=0,m=0,v=0,g=0;g=b;b=b+224|0;f=g+120|0;v=g+80|0;m=g;p=g+136|0;i=v;n=i+40|0;do{h[i>>2]=0;i=i+4|0}while((i|0)<(n|0));h[f>>2]=h[r>>2];if((Rr(0,t,f,m,v)|0)<0)r=-1;else{if((h[e+76>>2]|0)>-1)u=Sr(e)|0;else u=0;r=h[e>>2]|0;c=r&32;if((d[e+74>>0]|0)<1)h[e>>2]=r&-33;r=e+48|0;if(!(h[r>>2]|0)){n=e+44|0;a=h[n>>2]|0;h[n>>2]=p;o=e+28|0;h[o>>2]=p;s=e+20|0;h[s>>2]=p;h[r>>2]=80;l=e+16|0;h[l>>2]=p+80;i=Rr(e,t,f,m,v)|0;if(a){Si[h[e+36>>2]&7](e,0,0)|0;i=(h[s>>2]|0)==0?-1:i;h[n>>2]=a;h[r>>2]=0;h[l>>2]=0;h[o>>2]=0;h[s>>2]=0}}else i=Rr(e,t,f,m,v)|0;r=h[e>>2]|0;h[e>>2]=r|c;if(u)Tr(e);r=(r&32|0)==0?i:-1}b=g;return r|0}function wr(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,l=0,u=0,c=0;c=b;b=b+128|0;n=c+112|0;u=c;a=u;o=252;s=a+112|0;do{h[a>>2]=h[o>>2];a=a+4|0;o=o+4|0}while((a|0)<(s|0));if((t+-1|0)>>>0>2147483646)if(!t){t=1;l=4}else{t=lr()|0;h[t>>2]=75;t=-1}else{n=e;l=4}if((l|0)==4){l=-2-n|0;l=t>>>0>l>>>0?l:t;h[u+48>>2]=l;e=u+20|0;h[e>>2]=n;h[u+44>>2]=n;t=n+l|0;n=u+16|0;h[n>>2]=t;h[u+28>>2]=t;t=br(u,r,i)|0;if(l){r=h[e>>2]|0;d[r+(((r|0)==(h[n>>2]|0))<<31>>31)>>0]=0}}b=c;return t|0}function Cr(e,t,r){e=e|0;t=t|0;r=r|0;return wr(e,2147483647,t,r)|0}function Sr(e){e=e|0;return 0}function Tr(e){e=e|0;return}function Er(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,l=0;l=b;b=b+16|0;s=l;o=t&255;d[s>>0]=o;i=e+16|0;n=h[i>>2]|0;if(!n)if(!(Dr(e)|0)){n=h[i>>2]|0;a=4}else r=-1;else a=4;do{if((a|0)==4){i=e+20|0;a=h[i>>2]|0;if(a>>>0<n>>>0?(r=t&255,(r|0)!=(d[e+75>>0]|0)):0){h[i>>2]=a+1;d[a>>0]=o;break}if((Si[h[e+36>>2]&7](e,s,1)|0)==1)r=p[s>>0]|0;else r=-1}}while(0);b=l;return r|0}function xr(e){e=e|0;var t=0,r=0;t=b;b=b+16|0;r=t;h[r>>2]=h[e+60>>2];e=ur(Ie(6,r|0)|0)|0;b=t;return e|0}function Pr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0;n=b;b=b+32|0;a=n;i=n+20|0;h[a>>2]=h[e+60>>2];h[a+4>>2]=0;h[a+8>>2]=t;h[a+12>>2]=i;h[a+16>>2]=r;if((ur(Be(140,a|0)|0)|0)<0){h[i>>2]=-1;e=-1}else e=h[i>>2]|0;b=n;return e|0}function Ar(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,m=0;m=b;b=b+48|0;d=m+16|0;c=m;i=m+32|0;f=e+28|0;n=h[f>>2]|0;h[i>>2]=n;p=e+20|0;n=(h[p>>2]|0)-n|0;h[i+4>>2]=n;h[i+8>>2]=t;h[i+12>>2]=r;l=e+60|0;u=e+44|0;t=2;n=n+r|0;while(1){if(!(h[49]|0)){h[d>>2]=h[l>>2];h[d+4>>2]=i;h[d+8>>2]=t;o=ur(qe(146,d|0)|0)|0}else{De(7,e|0);h[c>>2]=h[l>>2];h[c+4>>2]=i;h[c+8>>2]=t;o=ur(qe(146,c|0)|0)|0;Se(0)}if((n|0)==(o|0)){n=6;break}if((o|0)<0){n=8;break}n=n-o|0;a=h[i+4>>2]|0;if(o>>>0<=a>>>0)if((t|0)==2){h[f>>2]=(h[f>>2]|0)+o;s=a;t=2}else s=a;else{s=h[u>>2]|0;h[f>>2]=s;h[p>>2]=s;s=h[i+12>>2]|0;o=o-a|0;i=i+8|0;t=t+-1|0}h[i>>2]=(h[i>>2]|0)+o;h[i+4>>2]=s-o}if((n|0)==6){d=h[u>>2]|0;h[e+16>>2]=d+(h[e+48>>2]|0);e=d;h[f>>2]=e;h[p>>2]=e}else if((n|0)==8){h[e+16>>2]=0;h[f>>2]=0;h[p>>2]=0;h[e>>2]=h[e>>2]|32;if((t|0)==2)r=0;else r=r-(h[i+4>>2]|0)|0}b=m;return r|0}function Or(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0;n=b;b=b+80|0;i=n;h[e+36>>2]=3;if((h[e>>2]&64|0)==0?(h[i>>2]=h[e+60>>2],h[i+4>>2]=21505,h[i+8>>2]=n+12,(Fe(54,i|0)|0)!=0):0)d[e+75>>0]=-1;i=Ar(e,t,r)|0;b=n;return i|0}function Dr(e){e=e|0;var t=0,r=0;t=e+74|0;r=d[t>>0]|0;d[t>>0]=r+255|r;t=h[e>>2]|0;if(!(t&8)){h[e+8>>2]=0;h[e+4>>2]=0;t=h[e+44>>2]|0;h[e+28>>2]=t;h[e+20>>2]=t;h[e+16>>2]=t+(h[e+48>>2]|0);t=0}else{h[e>>2]=t|32;t=-1}return t|0}function Ir(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0;a=t&255;i=(r|0)!=0;e:do{if(i&(e&3|0)!=0){n=t&255;while(1){if((d[e>>0]|0)==n<<24>>24){o=6;break e}e=e+1|0;r=r+-1|0;i=(r|0)!=0;if(!(i&(e&3|0)!=0)){o=5;break}}}else o=5}while(0);if((o|0)==5)if(i)o=6;else r=0;e:do{if((o|0)==6){n=t&255;if((d[e>>0]|0)!=n<<24>>24){i=ce(a,16843009)|0;t:do{if(r>>>0>3)while(1){a=h[e>>2]^i;if((a&-2139062144^-2139062144)&a+-16843009)break;e=e+4|0;r=r+-4|0;if(r>>>0<=3){o=11;break t}}else o=11}while(0);if((o|0)==11)if(!r){r=0;break}while(1){if((d[e>>0]|0)==n<<24>>24)break e;e=e+1|0;r=r+-1|0;if(!r){r=0;break}}}}}while(0);return((r|0)!=0?e:0)|0}function Mr(e){e=e|0;var t=0,r=0,i=0;i=e;e:do{if(!(i&3))r=4;else{t=e;e=i;while(1){if(!(d[t>>0]|0))break e;t=t+1|0;e=t;if(!(e&3)){e=t;r=4;break}}}}while(0);if((r|0)==4){while(1){t=h[e>>2]|0;if(!((t&-2139062144^-2139062144)&t+-16843009))e=e+4|0;else break}if((t&255)<<24>>24)do{e=e+1|0}while((d[e>>0]|0)!=0)}return e-i|0}function Rr(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,l=0,u=0.0,c=0,m=0,v=0,g=0,y=0.0,w=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0,I=0,M=0,R=0,L=0,N=0,k=0,F=0,B=0,U=0,z=0,q=0,G=0,H=0,j=0,W=0,Y=0,X=0,Q=0,Z=0,K=0,J=0,$=0,ee=0,te=0,re=0,ie=0,ne=0,ae=0,oe=0;oe=b;b=b+624|0;te=oe+24|0;ie=oe+16|0;re=oe+588|0;Z=oe+576|0;ee=oe;Y=oe+536|0;ae=oe+8|0;ne=oe+528|0;F=(e|0)!=0;B=Y+40|0;W=B;Y=Y+39|0;X=ae+4|0;Q=Z+12|0;Z=Z+11|0;K=re;J=Q;$=J-K|0;U=-2-K|0;z=J+2|0;q=te+288|0;G=re+9|0;H=G;j=re+8|0;a=0;w=t;o=0;t=0;e:while(1){do{if((a|0)>-1)if((o|0)>(2147483647-a|0)){a=lr()|0;h[a>>2]=75;a=-1;break}else{a=o+a|0;break}}while(0);o=d[w>>0]|0;if(!(o<<24>>24)){k=245;break}else s=w;t:while(1){switch(o<<24>>24){case 37:{o=s;k=9;break t}case 0:{o=s;break t}default:{}}N=s+1|0;o=d[N>>0]|0;s=N}t:do{if((k|0)==9)while(1){k=0;if((d[o+1>>0]|0)!=37)break t;s=s+1|0;o=o+2|0;if((d[o>>0]|0)==37)k=9;else break}}while(0);T=s-w|0;if(F?(h[e>>2]&32|0)==0:0)vr(w,T,e)|0;if((s|0)!=(w|0)){w=o;o=T;continue}c=o+1|0;s=d[c>>0]|0;l=(s<<24>>24)+-48|0;if(l>>>0<10){N=(d[o+2>>0]|0)==36;c=N?o+3|0:c;s=d[c>>0]|0;g=N?l:-1;t=N?1:t}else g=-1;o=s<<24>>24;t:do{if((o&-32|0)==32){l=0;while(1){if(!(1<<o+-32&75913)){m=l;o=c;break t}l=1<<(s<<24>>24)+-32|l;c=c+1|0;s=d[c>>0]|0;o=s<<24>>24;if((o&-32|0)!=32){m=l;o=c;break}}}else{m=0;o=c}}while(0);do{if(s<<24>>24==42){l=o+1|0;s=(d[l>>0]|0)+-48|0;if(s>>>0<10?(d[o+2>>0]|0)==36:0){h[n+(s<<2)>>2]=10;t=1;o=o+3|0;s=h[i+((d[l>>0]|0)+-48<<3)>>2]|0}else{if(t){a=-1;break e}if(!F){S=m;o=l;t=0;N=0;break}t=(h[r>>2]|0)+(4-1)&~(4-1);s=h[t>>2]|0;h[r>>2]=t+4;t=0;o=l}if((s|0)<0){S=m|8192;N=0-s|0}else{S=m;N=s}}else{l=(s<<24>>24)+-48|0;if(l>>>0<10){s=0;do{s=(s*10|0)+l|0;o=o+1|0;l=(d[o>>0]|0)+-48|0}while(l>>>0<10);if((s|0)<0){a=-1;break e}else{S=m;N=s}}else{S=m;N=0}}}while(0);t:do{if((d[o>>0]|0)==46){l=o+1|0;s=d[l>>0]|0;if(s<<24>>24!=42){c=(s<<24>>24)+-48|0;if(c>>>0<10){o=l;s=0}else{o=l;c=0;break}while(1){s=(s*10|0)+c|0;o=o+1|0;c=(d[o>>0]|0)+-48|0;if(c>>>0>=10){c=s;break t}}}l=o+2|0;s=(d[l>>0]|0)+-48|0;if(s>>>0<10?(d[o+3>>0]|0)==36:0){h[n+(s<<2)>>2]=10;o=o+4|0;c=h[i+((d[l>>0]|0)+-48<<3)>>2]|0;break}if(t){a=-1;break e}if(F){o=(h[r>>2]|0)+(4-1)&~(4-1);c=h[o>>2]|0;h[r>>2]=o+4;o=l}else{o=l;c=0}}else c=-1}while(0);v=0;while(1){s=(d[o>>0]|0)+-65|0;if(s>>>0>57){a=-1;break e}l=o+1|0;s=d[5347+(v*58|0)+s>>0]|0;m=s&255;if((m+-1|0)>>>0<8){o=l;v=m}else{L=l;break}}if(!(s<<24>>24)){a=-1;break}l=(g|0)>-1;do{if(s<<24>>24==19)if(l){a=-1;break e}else k=52;else{if(l){h[n+(g<<2)>>2]=m;M=i+(g<<3)|0;R=h[M+4>>2]|0;k=ee;h[k>>2]=h[M>>2];h[k+4>>2]=R;k=52;break}if(!F){a=0;break e}kr(ee,m,r)}}while(0);if((k|0)==52?(k=0,!F):0){w=L;o=T;continue}g=d[o>>0]|0;g=(v|0)!=0&(g&15|0)==3?g&-33:g;l=S&-65537;R=(S&8192|0)==0?S:l;t:do{switch(g|0){case 110:switch(v|0){case 0:{h[h[ee>>2]>>2]=a;w=L;o=T;continue e}case 1:{h[h[ee>>2]>>2]=a;w=L;o=T;continue e}case 2:{w=h[ee>>2]|0;h[w>>2]=a;h[w+4>>2]=((a|0)<0)<<31>>31;w=L;o=T;continue e}case 3:{f[h[ee>>2]>>1]=a;w=L;o=T;continue e}case 4:{d[h[ee>>2]>>0]=a;w=L;o=T;continue e}case 6:{h[h[ee>>2]>>2]=a;w=L;o=T;continue e}case 7:{w=h[ee>>2]|0;h[w>>2]=a;h[w+4>>2]=((a|0)<0)<<31>>31;w=L;o=T;continue e}default:{w=L;o=T;continue e}}case 112:{v=R|8;c=c>>>0>8?c:8;g=120;k=64;break}case 88:case 120:{v=R;k=64;break}case 111:{l=ee;s=h[l>>2]|0;l=h[l+4>>2]|0;if((s|0)==0&(l|0)==0)o=B;else{o=B;do{o=o+-1|0;d[o>>0]=s&7|48;s=Qr(s|0,l|0,3)|0;l=V}while(!((s|0)==0&(l|0)==0))}if(!(R&8)){s=R;v=0;m=5827;k=77}else{v=W-o+1|0;s=R;c=(c|0)<(v|0)?v:c;v=0;m=5827;k=77}break}case 105:case 100:{s=ee;o=h[s>>2]|0;s=h[s+4>>2]|0;if((s|0)<0){o=Wr(0,0,o|0,s|0)|0;s=V;l=ee;h[l>>2]=o;h[l+4>>2]=s;l=1;m=5827;k=76;break t}if(!(R&2048)){m=R&1;l=m;m=(m|0)==0?5827:5829;k=76}else{l=1;m=5828;k=76}break}case 117:{s=ee;o=h[s>>2]|0;s=h[s+4>>2]|0;l=0;m=5827;k=76;break}case 99:{d[Y>>0]=h[ee>>2];w=Y;s=1;v=0;g=5827;o=B;break}case 109:{o=lr()|0;o=sr(h[o>>2]|0)|0;k=82;break}case 115:{o=h[ee>>2]|0;o=(o|0)!=0?o:5837;k=82;break}case 67:{h[ae>>2]=h[ee>>2];h[X>>2]=0;h[ee>>2]=ae;c=-1;k=86;break}case 83:{if(!c){Br(e,32,N,0,R);o=0;k=98}else k=86;break}case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:{u=+_[ee>>3];h[ie>>2]=0;_[C>>3]=u;if((h[C+4>>2]|0)>=0)if(!(R&2048)){M=R&1;I=M;M=(M|0)==0?5845:5850}else{I=1;M=5847}else{u=-u;I=1;M=5844}_[C>>3]=u;D=h[C+4>>2]&2146435072;do{if(D>>>0<2146435072|(D|0)==2146435072&0<0){y=+dr(u,ie)*2.0;s=y!=0.0;if(s)h[ie>>2]=(h[ie>>2]|0)+-1;A=g|32;if((A|0)==97){w=g&32;T=(w|0)==0?M:M+9|0;S=I|2;o=12-c|0;do{if(!(c>>>0>11|(o|0)==0)){u=8.0;do{o=o+-1|0;u=u*16.0}while((o|0)!=0);if((d[T>>0]|0)==45){u=-(u+(-y-u));break}else{u=y+u-u;break}}else u=y}while(0);s=h[ie>>2]|0;o=(s|0)<0?0-s|0:s;o=Fr(o,((o|0)<0)<<31>>31,Q)|0;if((o|0)==(Q|0)){d[Z>>0]=48;o=Z}d[o+-1>>0]=(s>>31&2)+43;v=o+-2|0;d[v>>0]=g+15;m=(c|0)<1;l=(R&8|0)==0;s=re;while(1){M=~~u;o=s+1|0;d[s>>0]=p[5811+M>>0]|w;u=(u-+(M|0))*16.0;do{if((o-K|0)==1){if(l&(m&u==0.0))break;d[o>>0]=46;o=s+2|0}}while(0);if(!(u!=0.0))break;else s=o}c=(c|0)!=0&(U+o|0)<(c|0)?z+c-v|0:$-v+o|0;l=c+S|0;Br(e,32,N,l,R);if(!(h[e>>2]&32))vr(T,S,e)|0;Br(e,48,N,l,R^65536);o=o-K|0;if(!(h[e>>2]&32))vr(re,o,e)|0;s=J-v|0;Br(e,48,c-(o+s)|0,0,0);if(!(h[e>>2]&32))vr(v,s,e)|0;Br(e,32,N,l,R^8192);o=(l|0)<(N|0)?N:l;break}o=(c|0)<0?6:c;if(s){s=(h[ie>>2]|0)+-28|0;h[ie>>2]=s;u=y*268435456.0}else{u=y;s=h[ie>>2]|0}D=(s|0)<0?te:q;O=D;s=D;do{P=~~u>>>0;h[s>>2]=P;s=s+4|0;u=(u-+(P>>>0))*1.0e9}while(u!=0.0);l=s;s=h[ie>>2]|0;if((s|0)>0){m=D;while(1){v=(s|0)>29?29:s;c=l+-4|0;do{if(c>>>0<m>>>0)c=m;else{s=0;do{P=Zr(h[c>>2]|0,0,v|0)|0;P=Yr(P|0,V|0,s|0,0)|0;s=V;x=ai(P|0,s|0,1e9,0)|0;h[c>>2]=x;s=ni(P|0,s|0,1e9,0)|0;c=c+-4|0}while(c>>>0>=m>>>0);if(!s){c=m;break}c=m+-4|0;h[c>>2]=s}}while(0);while(1){if(l>>>0<=c>>>0)break;s=l+-4|0;if(!(h[s>>2]|0))l=s;else break}s=(h[ie>>2]|0)-v|0;h[ie>>2]=s;if((s|0)>0)m=c;else break}}else c=D;if((s|0)<0){T=((o+25|0)/9|0)+1|0;E=(A|0)==102;w=c;while(1){S=0-s|0;S=(S|0)>9?9:S;do{if(w>>>0<l>>>0){s=(1<<S)+-1|0;m=1e9>>>S;c=0;v=w;do{P=h[v>>2]|0;h[v>>2]=(P>>>S)+c;c=ce(P&s,m)|0;v=v+4|0}while(v>>>0<l>>>0);s=(h[w>>2]|0)==0?w+4|0:w;if(!c){c=s;break}h[l>>2]=c;c=s;l=l+4|0}else c=(h[w>>2]|0)==0?w+4|0:w}while(0);s=E?D:c;l=(l-s>>2|0)>(T|0)?s+(T<<2)|0:l;s=(h[ie>>2]|0)+S|0;h[ie>>2]=s;if((s|0)>=0){w=c;break}else w=c}}else w=c;do{if(w>>>0<l>>>0){s=(O-w>>2)*9|0;m=h[w>>2]|0;if(m>>>0<10)break;else c=10;do{c=c*10|0;s=s+1|0}while(m>>>0>=c>>>0)}else s=0}while(0);x=(A|0)==103;P=(o|0)!=0;c=o-((A|0)!=102?s:0)+((P&x)<<31>>31)|0;if((c|0)<(((l-O>>2)*9|0)+-9|0)){v=c+9216|0;E=(v|0)/9|0;c=D+(E+-1023<<2)|0;v=((v|0)%9|0)+1|0;if((v|0)<9){m=10;do{m=m*10|0;v=v+1|0}while((v|0)!=9)}else m=10;S=h[c>>2]|0;T=(S>>>0)%(m>>>0)|0;if((T|0)==0?(D+(E+-1022<<2)|0)==(l|0):0)m=w;else k=163;do{if((k|0)==163){k=0;y=(((S>>>0)/(m>>>0)|0)&1|0)==0?9007199254740992.0:9007199254740994.0;v=(m|0)/2|0;do{if(T>>>0<v>>>0)u=.5;else{if((T|0)==(v|0)?(D+(E+-1022<<2)|0)==(l|0):0){u=1.0;break}u=1.5}}while(0);do{if(I){if((d[M>>0]|0)!=45)break;y=-y;u=-u}}while(0);v=S-T|0;h[c>>2]=v;if(!(y+u!=y)){m=w;break}A=v+m|0;h[c>>2]=A;if(A>>>0>999999999){s=w;while(1){m=c+-4|0;h[c>>2]=0;if(m>>>0<s>>>0){s=s+-4|0;h[s>>2]=0}A=(h[m>>2]|0)+1|0;h[m>>2]=A;if(A>>>0>999999999)c=m;else{w=s;c=m;break}}}s=(O-w>>2)*9|0;v=h[w>>2]|0;if(v>>>0<10){m=w;break}else m=10;do{m=m*10|0;s=s+1|0}while(v>>>0>=m>>>0);m=w}}while(0);A=c+4|0;w=m;l=l>>>0>A>>>0?A:l}T=0-s|0;while(1){if(l>>>0<=w>>>0){E=0;A=l;break}c=l+-4|0;if(!(h[c>>2]|0))l=c;else{E=1;A=l;break}}do{if(x){o=(P&1^1)+o|0;if((o|0)>(s|0)&(s|0)>-5){g=g+-1|0;o=o+-1-s|0}else{g=g+-2|0;o=o+-1|0}l=R&8;if(l)break;do{if(E){l=h[A+-4>>2]|0;if(!l){c=9;break}if(!((l>>>0)%10|0)){m=10;c=0}else{c=0;break}do{m=m*10|0;c=c+1|0}while(((l>>>0)%(m>>>0)|0|0)==0)}else c=9}while(0);l=((A-O>>2)*9|0)+-9|0;if((g|32|0)==102){l=l-c|0;l=(l|0)<0?0:l;o=(o|0)<(l|0)?o:l;l=0;break}else{l=l+s-c|0;l=(l|0)<0?0:l;o=(o|0)<(l|0)?o:l;l=0;break}}else l=R&8}while(0);S=o|l;m=(S|0)!=0&1;v=(g|32|0)==102;if(v){s=(s|0)>0?s:0;g=0}else{c=(s|0)<0?T:s;c=Fr(c,((c|0)<0)<<31>>31,Q)|0;if((J-c|0)<2)do{c=c+-1|0;d[c>>0]=48}while((J-c|0)<2);d[c+-1>>0]=(s>>31&2)+43;O=c+-2|0;d[O>>0]=g;s=J-O|0;g=O}T=I+1+o+m+s|0;Br(e,32,N,T,R);if(!(h[e>>2]&32))vr(M,I,e)|0;Br(e,48,N,T,R^65536);do{if(v){c=w>>>0>D>>>0?D:w;s=c;do{l=Fr(h[s>>2]|0,0,G)|0;do{if((s|0)==(c|0)){if((l|0)!=(G|0))break;d[j>>0]=48;l=j}else{if(l>>>0<=re>>>0)break;do{l=l+-1|0;d[l>>0]=48}while(l>>>0>re>>>0)}}while(0);if(!(h[e>>2]&32))vr(l,H-l|0,e)|0;s=s+4|0}while(s>>>0<=D>>>0);do{if(S){if(h[e>>2]&32)break;vr(5879,1,e)|0}}while(0);if((o|0)>0&s>>>0<A>>>0){l=s;while(1){s=Fr(h[l>>2]|0,0,G)|0;if(s>>>0>re>>>0)do{s=s+-1|0;d[s>>0]=48}while(s>>>0>re>>>0);if(!(h[e>>2]&32))vr(s,(o|0)>9?9:o,e)|0;l=l+4|0;s=o+-9|0;if(!((o|0)>9&l>>>0<A>>>0)){o=s;break}else o=s}}Br(e,48,o+9|0,9,0)}else{v=E?A:w+4|0;if((o|0)>-1){m=(l|0)==0;c=w;do{s=Fr(h[c>>2]|0,0,G)|0;if((s|0)==(G|0)){d[j>>0]=48;s=j}do{if((c|0)==(w|0)){l=s+1|0;if(!(h[e>>2]&32))vr(s,1,e)|0;if(m&(o|0)<1){s=l;break}if(h[e>>2]&32){s=l;break}vr(5879,1,e)|0;s=l}else{if(s>>>0<=re>>>0)break;do{s=s+-1|0;d[s>>0]=48}while(s>>>0>re>>>0)}}while(0);l=H-s|0;if(!(h[e>>2]&32))vr(s,(o|0)>(l|0)?l:o,e)|0;o=o-l|0;c=c+4|0}while(c>>>0<v>>>0&(o|0)>-1)}Br(e,48,o+18|0,18,0);if(h[e>>2]&32)break;vr(g,J-g|0,e)|0}}while(0);Br(e,32,N,T,R^8192);o=(T|0)<(N|0)?N:T}else{v=(g&32|0)!=0;m=u!=u|0.0!=0.0;s=m?0:I;c=s+3|0;Br(e,32,N,c,l);o=h[e>>2]|0;if(!(o&32)){vr(M,s,e)|0;o=h[e>>2]|0}if(!(o&32))vr(m?v?5871:5875:v?5863:5867,3,e)|0;Br(e,32,N,c,R^8192);o=(c|0)<(N|0)?N:c}}while(0);w=L;continue e}default:{l=R;s=c;v=0;g=5827;o=B}}}while(0);t:do{if((k|0)==64){l=ee;s=h[l>>2]|0;l=h[l+4>>2]|0;m=g&32;if(!((s|0)==0&(l|0)==0)){o=B;do{o=o+-1|0;d[o>>0]=p[5811+(s&15)>>0]|m;s=Qr(s|0,l|0,4)|0;l=V}while(!((s|0)==0&(l|0)==0));k=ee;if((v&8|0)==0|(h[k>>2]|0)==0&(h[k+4>>2]|0)==0){s=v;v=0;m=5827;k=77}else{s=v;v=2;m=5827+(g>>4)|0;k=77}}else{o=B;s=v;v=0;m=5827;k=77}}else if((k|0)==76){o=Fr(o,s,B)|0;s=R;v=l;k=77}else if((k|0)==82){k=0;R=Ir(o,0,c)|0;M=(R|0)==0;w=o;s=M?c:R-o|0;v=0;g=5827;o=M?o+c|0:R}else if((k|0)==86){k=0;s=0;o=0;m=h[ee>>2]|0;while(1){l=h[m>>2]|0;if(!l)break;o=hr(ne,l)|0;if((o|0)<0|o>>>0>(c-s|0)>>>0)break;s=o+s|0;if(c>>>0>s>>>0)m=m+4|0;else break}if((o|0)<0){a=-1;break e}Br(e,32,N,s,R);if(!s){o=0;k=98}else{l=0;c=h[ee>>2]|0;while(1){o=h[c>>2]|0;if(!o){o=s;k=98;break t}o=hr(ne,o)|0;l=o+l|0;if((l|0)>(s|0)){o=s;k=98;break t}if(!(h[e>>2]&32))vr(ne,o,e)|0;if(l>>>0>=s>>>0){o=s;k=98;break}else c=c+4|0}}}}while(0);if((k|0)==98){k=0;Br(e,32,N,o,R^8192);w=L;o=(N|0)>(o|0)?N:o;continue}if((k|0)==77){k=0;l=(c|0)>-1?s&-65537:s;s=ee;s=(h[s>>2]|0)!=0|(h[s+4>>2]|0)!=0;if((c|0)!=0|s){s=(s&1^1)+(W-o)|0;w=o;s=(c|0)>(s|0)?c:s;g=m;o=B}else{w=B;s=0;g=m;o=B}}m=o-w|0;s=(s|0)<(m|0)?m:s;c=v+s|0;o=(N|0)<(c|0)?c:N;Br(e,32,o,c,l);if(!(h[e>>2]&32))vr(g,v,e)|0;Br(e,48,o,c,l^65536);Br(e,48,s,m,0);if(!(h[e>>2]&32))vr(w,m,e)|0;Br(e,32,o,c,l^8192);w=L}e:do{if((k|0)==245)if(!e)if(t){a=1;while(1){t=h[n+(a<<2)>>2]|0;if(!t)break;kr(i+(a<<3)|0,t,r);a=a+1|0;if((a|0)>=10){a=1;break e}}if((a|0)<10)while(1){if(h[n+(a<<2)>>2]|0){a=-1;break e}a=a+1|0;if((a|0)>=10){a=1;break}}else a=1}else a=0}while(0);b=oe;return a|0}function Lr(e){e=e|0;if(!(h[e+68>>2]|0))Tr(e);return}function Nr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0;i=e+20|0;n=h[i>>2]|0;e=(h[e+16>>2]|0)-n|0;e=e>>>0>r>>>0?r:e;Kr(n|0,t|0,e|0)|0;h[i>>2]=(h[i>>2]|0)+e;return r|0}function kr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0.0;e:do{if(t>>>0<=20)do{switch(t|0){case 9:{i=(h[r>>2]|0)+(4-1)&~(4-1);t=h[i>>2]|0;h[r>>2]=i+4;h[e>>2]=t;break e}case 10:{i=(h[r>>2]|0)+(4-1)&~(4-1);t=h[i>>2]|0;h[r>>2]=i+4;i=e;h[i>>2]=t;h[i+4>>2]=((t|0)<0)<<31>>31;break e}case 11:{i=(h[r>>2]|0)+(4-1)&~(4-1);t=h[i>>2]|0;h[r>>2]=i+4;i=e;h[i>>2]=t;h[i+4>>2]=0;break e}case 12:{i=(h[r>>2]|0)+(8-1)&~(8-1);t=i;n=h[t>>2]|0;t=h[t+4>>2]|0;h[r>>2]=i+8;i=e;h[i>>2]=n;h[i+4>>2]=t;break e}case 13:{n=(h[r>>2]|0)+(4-1)&~(4-1);i=h[n>>2]|0;h[r>>2]=n+4;i=(i&65535)<<16>>16;n=e;h[n>>2]=i;h[n+4>>2]=((i|0)<0)<<31>>31;break e}case 14:{n=(h[r>>2]|0)+(4-1)&~(4-1);i=h[n>>2]|0;h[r>>2]=n+4;n=e;h[n>>2]=i&65535;h[n+4>>2]=0;break e}case 15:{n=(h[r>>2]|0)+(4-1)&~(4-1);i=h[n>>2]|0;h[r>>2]=n+4;i=(i&255)<<24>>24;n=e;h[n>>2]=i;h[n+4>>2]=((i|0)<0)<<31>>31;break e}case 16:{n=(h[r>>2]|0)+(4-1)&~(4-1);i=h[n>>2]|0;h[r>>2]=n+4;n=e;h[n>>2]=i&255;h[n+4>>2]=0;break e}case 17:{n=(h[r>>2]|0)+(8-1)&~(8-1);a=+_[n>>3];h[r>>2]=n+8;_[e>>3]=a;break e}case 18:{n=(h[r>>2]|0)+(8-1)&~(8-1);a=+_[n>>3];h[r>>2]=n+8;_[e>>3]=a;break e}default:break e}}while(0)}while(0);return}function Fr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0;if(t>>>0>0|(t|0)==0&e>>>0>4294967295)while(1){i=ai(e|0,t|0,10,0)|0;r=r+-1|0;d[r>>0]=i|48;i=ni(e|0,t|0,10,0)|0;if(t>>>0>9|(t|0)==9&e>>>0>4294967295){e=i;t=V}else{e=i;break}}if(e)while(1){r=r+-1|0;d[r>>0]=(e>>>0)%10|0|48;if(e>>>0<10)break;else e=(e>>>0)/10|0}return r|0}function Br(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0;s=b;b=b+256|0;o=s;do{if((r|0)>(i|0)&(n&73728|0)==0){n=r-i|0;Xr(o|0,t|0,(n>>>0>256?256:n)|0)|0;t=h[e>>2]|0;a=(t&32|0)==0;if(n>>>0>255){i=r-i|0;do{if(a){vr(o,256,e)|0;t=h[e>>2]|0}n=n+-256|0;a=(t&32|0)==0}while(n>>>0>255);if(a)n=i&255;else break}else if(!a)break;vr(o,n,e)|0}}while(0);b=s;return}function Ur(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,m=0,v=0,g=0,_=0,y=0,b=0,w=0,C=0,S=0,T=0,E=0,x=0,P=0,A=0,O=0,D=0,I=0,M=0,R=0,L=0,N=0,k=0,F=0,B=0;do{if(e>>>0<245){p=e>>>0<11?16:e+11&-8;e=p>>>3;s=h[147]|0;r=s>>>e;if(r&3){e=(r&1^1)+e|0;i=e<<1;r=628+(i<<2)|0;i=628+(i+2<<2)|0;n=h[i>>2]|0;a=n+8|0;o=h[a>>2]|0;do{if((r|0)!=(o|0)){if(o>>>0<(h[151]|0)>>>0)Oe();t=o+12|0;if((h[t>>2]|0)==(n|0)){h[t>>2]=r;h[i>>2]=o;break}else Oe()}else h[147]=s&~(1<<e)}while(0);B=e<<3;h[n+4>>2]=B|3;B=n+(B|4)|0;h[B>>2]=h[B>>2]|1;B=a;return B|0}o=h[149]|0;if(p>>>0>o>>>0){if(r){i=2<<e;i=r<<e&(i|0-i);i=(i&0-i)+-1|0;l=i>>>12&16;i=i>>>l;n=i>>>5&8;i=i>>>n;a=i>>>2&4;i=i>>>a;r=i>>>1&2;i=i>>>r;e=i>>>1&1;e=(n|l|a|r|e)+(i>>>e)|0;i=e<<1;r=628+(i<<2)|0;i=628+(i+2<<2)|0;a=h[i>>2]|0;l=a+8|0;n=h[l>>2]|0;do{if((r|0)!=(n|0)){if(n>>>0<(h[151]|0)>>>0)Oe();t=n+12|0;if((h[t>>2]|0)==(a|0)){h[t>>2]=r;h[i>>2]=n;u=h[149]|0;break}else Oe()}else{h[147]=s&~(1<<e);u=o}}while(0);B=e<<3;o=B-p|0;h[a+4>>2]=p|3;s=a+p|0;h[a+(p|4)>>2]=o|1;h[a+B>>2]=o;if(u){n=h[152]|0;r=u>>>3;t=r<<1;i=628+(t<<2)|0;e=h[147]|0;r=1<<r;if(e&r){e=628+(t+2<<2)|0;t=h[e>>2]|0;if(t>>>0<(h[151]|0)>>>0)Oe();else{c=e;d=t}}else{h[147]=e|r;c=628+(t+2<<2)|0;d=i}h[c>>2]=n;h[d+12>>2]=n;h[n+8>>2]=d;h[n+12>>2]=i}h[149]=o;h[152]=s;B=l;return B|0}e=h[148]|0;if(e){r=(e&0-e)+-1|0;F=r>>>12&16;r=r>>>F;k=r>>>5&8;r=r>>>k;B=r>>>2&4;r=r>>>B;e=r>>>1&2;r=r>>>e;i=r>>>1&1;i=h[892+((k|F|B|e|i)+(r>>>i)<<2)>>2]|0;r=(h[i+4>>2]&-8)-p|0;e=i;while(1){t=h[e+16>>2]|0;if(!t){t=h[e+20>>2]|0;if(!t){l=r;break}}e=(h[t+4>>2]&-8)-p|0;B=e>>>0<r>>>0;r=B?e:r;e=t;i=B?t:i}a=h[151]|0;if(i>>>0<a>>>0)Oe();s=i+p|0;if(i>>>0>=s>>>0)Oe();o=h[i+24>>2]|0;r=h[i+12>>2]|0;do{if((r|0)==(i|0)){e=i+20|0;t=h[e>>2]|0;if(!t){e=i+16|0;t=h[e>>2]|0;if(!t){f=0;break}}while(1){r=t+20|0;n=h[r>>2]|0;if(n){t=n;e=r;continue}r=t+16|0;n=h[r>>2]|0;if(!n)break;else{t=n;e=r}}if(e>>>0<a>>>0)Oe();else{h[e>>2]=0;f=t;break}}else{n=h[i+8>>2]|0;if(n>>>0<a>>>0)Oe();t=n+12|0;if((h[t>>2]|0)!=(i|0))Oe();e=r+8|0;if((h[e>>2]|0)==(i|0)){h[t>>2]=r;h[e>>2]=n;f=r;break}else Oe()}}while(0);do{if(o){t=h[i+28>>2]|0;e=892+(t<<2)|0;if((i|0)==(h[e>>2]|0)){h[e>>2]=f;if(!f){h[148]=h[148]&~(1<<t);break}}else{if(o>>>0<(h[151]|0)>>>0)Oe();t=o+16|0;if((h[t>>2]|0)==(i|0))h[t>>2]=f;else h[o+20>>2]=f;if(!f)break}e=h[151]|0;if(f>>>0<e>>>0)Oe();h[f+24>>2]=o;t=h[i+16>>2]|0;do{if(t)if(t>>>0<e>>>0)Oe();else{h[f+16>>2]=t;h[t+24>>2]=f;break}}while(0);t=h[i+20>>2]|0;if(t)if(t>>>0<(h[151]|0)>>>0)Oe();else{h[f+20>>2]=t;h[t+24>>2]=f;break}}}while(0);if(l>>>0<16){B=l+p|0;h[i+4>>2]=B|3;B=i+(B+4)|0;h[B>>2]=h[B>>2]|1}else{h[i+4>>2]=p|3;h[i+(p|4)>>2]=l|1;h[i+(l+p)>>2]=l;t=h[149]|0;if(t){a=h[152]|0;r=t>>>3;t=r<<1;n=628+(t<<2)|0;e=h[147]|0;r=1<<r;if(e&r){t=628+(t+2<<2)|0;e=h[t>>2]|0;if(e>>>0<(h[151]|0)>>>0)Oe();else{m=t;v=e}}else{h[147]=e|r;m=628+(t+2<<2)|0;v=n}h[m>>2]=a;h[v+12>>2]=a;h[a+8>>2]=v;h[a+12>>2]=n}h[149]=l;h[152]=s}B=i+8|0;return B|0}else v=p}else v=p}else if(e>>>0<=4294967231){e=e+11|0;d=e&-8;c=h[148]|0;if(c){r=0-d|0;e=e>>>8;if(e)if(d>>>0>16777215)u=31;else{v=(e+1048320|0)>>>16&8;w=e<<v;m=(w+520192|0)>>>16&4;w=w<<m;u=(w+245760|0)>>>16&2;u=14-(m|v|u)+(w<<u>>>15)|0;u=d>>>(u+7|0)&1|u<<1}else u=0;e=h[892+(u<<2)>>2]|0;e:do{if(!e){n=0;e=0;w=86}else{o=r;n=0;s=d<<((u|0)==31?0:25-(u>>>1)|0);l=e;e=0;while(1){a=h[l+4>>2]&-8;r=a-d|0;if(r>>>0<o>>>0)if((a|0)==(d|0)){a=l;e=l;w=90;break e}else e=l;else r=o;w=h[l+20>>2]|0;l=h[l+16+(s>>>31<<2)>>2]|0;n=(w|0)==0|(w|0)==(l|0)?n:w;if(!l){w=86;break}else{o=r;s=s<<1}}}}while(0);if((w|0)==86){if((n|0)==0&(e|0)==0){e=2<<u;e=c&(e|0-e);if(!e){v=d;break}e=(e&0-e)+-1|0;f=e>>>12&16;e=e>>>f;c=e>>>5&8;e=e>>>c;m=e>>>2&4;e=e>>>m;v=e>>>1&2;e=e>>>v;n=e>>>1&1;n=h[892+((c|f|m|v|n)+(e>>>n)<<2)>>2]|0;e=0}if(!n){s=r;l=e}else{a=n;w=90}}if((w|0)==90)while(1){w=0;v=(h[a+4>>2]&-8)-d|0;n=v>>>0<r>>>0;r=n?v:r;e=n?a:e;n=h[a+16>>2]|0;if(n){a=n;w=90;continue}a=h[a+20>>2]|0;if(!a){s=r;l=e;break}else w=90}if((l|0)!=0?s>>>0<((h[149]|0)-d|0)>>>0:0){n=h[151]|0;if(l>>>0<n>>>0)Oe();o=l+d|0;if(l>>>0>=o>>>0)Oe();a=h[l+24>>2]|0;r=h[l+12>>2]|0;do{if((r|0)==(l|0)){e=l+20|0;t=h[e>>2]|0;if(!t){e=l+16|0;t=h[e>>2]|0;if(!t){p=0;break}}while(1){r=t+20|0;i=h[r>>2]|0;if(i){t=i;e=r;continue}r=t+16|0;i=h[r>>2]|0;if(!i)break;else{t=i;e=r}}if(e>>>0<n>>>0)Oe();else{h[e>>2]=0;p=t;break}}else{i=h[l+8>>2]|0;if(i>>>0<n>>>0)Oe();t=i+12|0;if((h[t>>2]|0)!=(l|0))Oe();e=r+8|0;if((h[e>>2]|0)==(l|0)){h[t>>2]=r;h[e>>2]=i;p=r;break}else Oe()}}while(0);do{if(a){t=h[l+28>>2]|0;e=892+(t<<2)|0;if((l|0)==(h[e>>2]|0)){h[e>>2]=p;if(!p){h[148]=h[148]&~(1<<t);break}}else{if(a>>>0<(h[151]|0)>>>0)Oe();t=a+16|0;if((h[t>>2]|0)==(l|0))h[t>>2]=p;else h[a+20>>2]=p;if(!p)break}e=h[151]|0;if(p>>>0<e>>>0)Oe();h[p+24>>2]=a;t=h[l+16>>2]|0;do{if(t)if(t>>>0<e>>>0)Oe();else{h[p+16>>2]=t;h[t+24>>2]=p;break}}while(0);t=h[l+20>>2]|0;if(t)if(t>>>0<(h[151]|0)>>>0)Oe();else{h[p+20>>2]=t;h[t+24>>2]=p;break}}}while(0);e:do{if(s>>>0>=16){h[l+4>>2]=d|3;h[l+(d|4)>>2]=s|1;h[l+(s+d)>>2]=s;t=s>>>3;if(s>>>0<256){e=t<<1;i=628+(e<<2)|0;r=h[147]|0;t=1<<t;if(r&t){t=628+(e+2<<2)|0;e=h[t>>2]|0;if(e>>>0<(h[151]|0)>>>0)Oe();else{_=t;y=e}}else{h[147]=r|t;_=628+(e+2<<2)|0;y=i}h[_>>2]=o;h[y+12>>2]=o;h[l+(d+8)>>2]=y;h[l+(d+12)>>2]=i;break}t=s>>>8;if(t)if(s>>>0>16777215)i=31;else{F=(t+1048320|0)>>>16&8;B=t<<F;k=(B+520192|0)>>>16&4;B=B<<k;i=(B+245760|0)>>>16&2;i=14-(k|F|i)+(B<<i>>>15)|0;i=s>>>(i+7|0)&1|i<<1}else i=0;t=892+(i<<2)|0;h[l+(d+28)>>2]=i;h[l+(d+20)>>2]=0;h[l+(d+16)>>2]=0;e=h[148]|0;r=1<<i;if(!(e&r)){h[148]=e|r;h[t>>2]=o;h[l+(d+24)>>2]=t;h[l+(d+12)>>2]=o;h[l+(d+8)>>2]=o;break}t=h[t>>2]|0;t:do{if((h[t+4>>2]&-8|0)!=(s|0)){i=s<<((i|0)==31?0:25-(i>>>1)|0);while(1){e=t+16+(i>>>31<<2)|0;r=h[e>>2]|0;if(!r)break;if((h[r+4>>2]&-8|0)==(s|0)){T=r;break t}else{i=i<<1;t=r}}if(e>>>0<(h[151]|0)>>>0)Oe();else{h[e>>2]=o;h[l+(d+24)>>2]=t;h[l+(d+12)>>2]=o;h[l+(d+8)>>2]=o;break e}}else T=t}while(0);t=T+8|0;e=h[t>>2]|0;B=h[151]|0;if(e>>>0>=B>>>0&T>>>0>=B>>>0){h[e+12>>2]=o;h[t>>2]=o;h[l+(d+8)>>2]=e;h[l+(d+12)>>2]=T;h[l+(d+24)>>2]=0;break}else Oe()}else{B=s+d|0;h[l+4>>2]=B|3;B=l+(B+4)|0;h[B>>2]=h[B>>2]|1}}while(0);B=l+8|0;return B|0}else v=d}else v=d}else v=-1}while(0);r=h[149]|0;if(r>>>0>=v>>>0){t=r-v|0;e=h[152]|0;if(t>>>0>15){h[152]=e+v;h[149]=t;h[e+(v+4)>>2]=t|1;h[e+r>>2]=t;h[e+4>>2]=v|3}else{h[149]=0;h[152]=0;h[e+4>>2]=r|3;B=e+(r+4)|0;h[B>>2]=h[B>>2]|1}B=e+8|0;return B|0}e=h[150]|0;if(e>>>0>v>>>0){F=e-v|0;h[150]=F;B=h[153]|0;h[153]=B+v;h[B+(v+4)>>2]=F|1;h[B+4>>2]=v|3;B=B+8|0;return B|0}do{if(!(h[265]|0)){e=ze(30)|0;if(!(e+-1&e)){h[267]=e;h[266]=e;h[268]=-1;h[269]=-1;h[270]=0;h[258]=0;T=(Re(0)|0)&-16^1431655768;h[265]=T;break}else Oe()}}while(0);l=v+48|0;s=h[267]|0;u=v+47|0;o=s+u|0;s=0-s|0;c=o&s;if(c>>>0<=v>>>0){B=0;return B|0}e=h[257]|0;if((e|0)!=0?(y=h[255]|0,T=y+c|0,T>>>0<=y>>>0|T>>>0>e>>>0):0){B=0;return B|0}e:do{if(!(h[258]&4)){e=h[153]|0;t:do{if(e){n=1036;while(1){r=h[n>>2]|0;if(r>>>0<=e>>>0?(g=n+4|0,(r+(h[g>>2]|0)|0)>>>0>e>>>0):0){a=n;e=g;break}n=h[n+8>>2]|0;if(!n){w=174;break t}}r=o-(h[150]|0)&s;if(r>>>0<2147483647){n=Me(r|0)|0;T=(n|0)==((h[a>>2]|0)+(h[e>>2]|0)|0);e=T?r:0;if(T){if((n|0)!=(-1|0)){C=n;m=e;w=194;break e}}else w=184}else e=0}else w=174}while(0);do{if((w|0)==174){a=Me(0)|0;if((a|0)!=(-1|0)){e=a;r=h[266]|0;n=r+-1|0;if(!(n&e))r=c;else r=c-e+(n+e&0-r)|0;e=h[255]|0;n=e+r|0;if(r>>>0>v>>>0&r>>>0<2147483647){T=h[257]|0;if((T|0)!=0?n>>>0<=e>>>0|n>>>0>T>>>0:0){e=0;break}n=Me(r|0)|0;T=(n|0)==(a|0);e=T?r:0;if(T){C=a;m=e;w=194;break e}else w=184}else e=0}else e=0}}while(0);t:do{if((w|0)==184){a=0-r|0;do{if(l>>>0>r>>>0&(r>>>0<2147483647&(n|0)!=(-1|0))?(b=h[267]|0,b=u-r+b&0-b,b>>>0<2147483647):0)if((Me(b|0)|0)==(-1|0)){Me(a|0)|0;break t}else{r=b+r|0;break}}while(0);if((n|0)!=(-1|0)){C=n;m=r;w=194;break e}}}while(0);h[258]=h[258]|4;w=191}else{e=0;w=191}}while(0);if((((w|0)==191?c>>>0<2147483647:0)?(C=Me(c|0)|0,S=Me(0)|0,C>>>0<S>>>0&((C|0)!=(-1|0)&(S|0)!=(-1|0))):0)?(E=S-C|0,x=E>>>0>(v+40|0)>>>0,x):0){m=x?E:e;w=194}if((w|0)==194){e=(h[255]|0)+m|0;h[255]=e;if(e>>>0>(h[256]|0)>>>0)h[256]=e;o=h[153]|0;e:do{if(o){a=1036;do{e=h[a>>2]|0;r=a+4|0;n=h[r>>2]|0;if((C|0)==(e+n|0)){P=e;A=r;O=n;D=a;w=204;break}a=h[a+8>>2]|0}while((a|0)!=0);if(((w|0)==204?(h[D+12>>2]&8|0)==0:0)?o>>>0<C>>>0&o>>>0>=P>>>0:0){h[A>>2]=O+m;B=(h[150]|0)+m|0;F=o+8|0;F=(F&7|0)==0?0:0-F&7;k=B-F|0;h[153]=o+F;h[150]=k;h[o+(F+4)>>2]=k|1;h[o+(B+4)>>2]=40;h[154]=h[269];break}e=h[151]|0;if(C>>>0<e>>>0){h[151]=C;e=C}r=C+m|0;a=1036;while(1){if((h[a>>2]|0)==(r|0)){n=a;r=a;w=212;break}a=h[a+8>>2]|0;if(!a){r=1036;break}}if((w|0)==212)if(!(h[r+12>>2]&8)){h[n>>2]=C;f=r+4|0;h[f>>2]=(h[f>>2]|0)+m;f=C+8|0;f=(f&7|0)==0?0:0-f&7;u=C+(m+8)|0;u=(u&7|0)==0?0:0-u&7;t=C+(u+m)|0;d=f+v|0;p=C+d|0;c=t-(C+f)-v|0;h[C+(f+4)>>2]=v|3;t:do{if((t|0)!=(o|0)){if((t|0)==(h[152]|0)){B=(h[149]|0)+c|0;h[149]=B;h[152]=p;h[C+(d+4)>>2]=B|1;h[C+(B+d)>>2]=B;break}s=m+4|0;r=h[C+(s+u)>>2]|0;if((r&3|0)==1){l=r&-8;a=r>>>3;r:do{if(r>>>0>=256){o=h[C+((u|24)+m)>>2]|0;i=h[C+(m+12+u)>>2]|0;do{if((i|0)==(t|0)){n=u|16;i=C+(s+n)|0;r=h[i>>2]|0;if(!r){i=C+(n+m)|0;r=h[i>>2]|0;if(!r){N=0;break}}while(1){n=r+20|0;a=h[n>>2]|0;if(a){r=a;i=n;continue}n=r+16|0;a=h[n>>2]|0;if(!a)break;else{r=a;i=n}}if(i>>>0<e>>>0)Oe();else{h[i>>2]=0;N=r;break}}else{n=h[C+((u|8)+m)>>2]|0;if(n>>>0<e>>>0)Oe();e=n+12|0;if((h[e>>2]|0)!=(t|0))Oe();r=i+8|0;if((h[r>>2]|0)==(t|0)){h[e>>2]=i;h[r>>2]=n;N=i;break}else Oe()}}while(0);if(!o)break;e=h[C+(m+28+u)>>2]|0;r=892+(e<<2)|0;do{if((t|0)!=(h[r>>2]|0)){if(o>>>0<(h[151]|0)>>>0)Oe();e=o+16|0;if((h[e>>2]|0)==(t|0))h[e>>2]=N;else h[o+20>>2]=N;if(!N)break r}else{h[r>>2]=N;if(N)break;h[148]=h[148]&~(1<<e);break r}}while(0);r=h[151]|0;if(N>>>0<r>>>0)Oe();h[N+24>>2]=o;t=u|16;e=h[C+(t+m)>>2]|0;do{if(e)if(e>>>0<r>>>0)Oe();else{h[N+16>>2]=e;h[e+24>>2]=N;break}}while(0);t=h[C+(s+t)>>2]|0;if(!t)break;if(t>>>0<(h[151]|0)>>>0)Oe();else{h[N+20>>2]=t;h[t+24>>2]=N;break}}else{i=h[C+((u|8)+m)>>2]|0;n=h[C+(m+12+u)>>2]|0;r=628+(a<<1<<2)|0;do{if((i|0)!=(r|0)){if(i>>>0<e>>>0)Oe();if((h[i+12>>2]|0)==(t|0))break;Oe()}}while(0);if((n|0)==(i|0)){h[147]=h[147]&~(1<<a);break}do{if((n|0)==(r|0))I=n+8|0;else{if(n>>>0<e>>>0)Oe();e=n+8|0;if((h[e>>2]|0)==(t|0)){I=e;break}Oe()}}while(0);h[i+12>>2]=n;h[I>>2]=i}}while(0);t=C+((l|u)+m)|0;n=l+c|0}else n=c;t=t+4|0;h[t>>2]=h[t>>2]&-2;h[C+(d+4)>>2]=n|1;h[C+(n+d)>>2]=n;t=n>>>3;if(n>>>0<256){e=t<<1;i=628+(e<<2)|0;r=h[147]|0;t=1<<t;do{if(!(r&t)){h[147]=r|t;k=628+(e+2<<2)|0;F=i}else{t=628+(e+2<<2)|0;e=h[t>>2]|0;if(e>>>0>=(h[151]|0)>>>0){k=t;F=e;break}Oe()}}while(0);h[k>>2]=p;h[F+12>>2]=p;h[C+(d+8)>>2]=F;h[C+(d+12)>>2]=i;break}t=n>>>8;do{if(!t)i=0;else{if(n>>>0>16777215){i=31;break}k=(t+1048320|0)>>>16&8;F=t<<k;N=(F+520192|0)>>>16&4;F=F<<N;i=(F+245760|0)>>>16&2;i=14-(N|k|i)+(F<<i>>>15)|0;i=n>>>(i+7|0)&1|i<<1}}while(0);t=892+(i<<2)|0;h[C+(d+28)>>2]=i;h[C+(d+20)>>2]=0;h[C+(d+16)>>2]=0;e=h[148]|0;r=1<<i;if(!(e&r)){h[148]=e|r;h[t>>2]=p;h[C+(d+24)>>2]=t;h[C+(d+12)>>2]=p;h[C+(d+8)>>2]=p;break}t=h[t>>2]|0;r:do{if((h[t+4>>2]&-8|0)!=(n|0)){i=n<<((i|0)==31?0:25-(i>>>1)|0);while(1){e=t+16+(i>>>31<<2)|0;r=h[e>>2]|0;if(!r)break;if((h[r+4>>2]&-8|0)==(n|0)){B=r;break r}else{i=i<<1;t=r}}if(e>>>0<(h[151]|0)>>>0)Oe();else{h[e>>2]=p;h[C+(d+24)>>2]=t;h[C+(d+12)>>2]=p;h[C+(d+8)>>2]=p;break t}}else B=t}while(0);t=B+8|0;e=h[t>>2]|0;F=h[151]|0;if(e>>>0>=F>>>0&B>>>0>=F>>>0){h[e+12>>2]=p;h[t>>2]=p;h[C+(d+8)>>2]=e;h[C+(d+12)>>2]=B;h[C+(d+24)>>2]=0;break}else Oe()}else{B=(h[150]|0)+c|0;h[150]=B;h[153]=p;h[C+(d+4)>>2]=B|1}}while(0);B=C+(f|8)|0;return B|0}else r=1036;while(1){e=h[r>>2]|0;if(e>>>0<=o>>>0?(t=h[r+4>>2]|0,i=e+t|0,i>>>0>o>>>0):0)break;r=h[r+8>>2]|0}n=e+(t+-39)|0;e=e+(t+-47+((n&7|0)==0?0:0-n&7))|0;n=o+16|0;e=e>>>0<n>>>0?o:e;t=e+8|0;r=C+8|0;r=(r&7|0)==0?0:0-r&7;B=m+-40-r|0;h[153]=C+r;h[150]=B;h[C+(r+4)>>2]=B|1;h[C+(m+-36)>>2]=40;h[154]=h[269];r=e+4|0;h[r>>2]=27;h[t>>2]=h[259];h[t+4>>2]=h[260];h[t+8>>2]=h[261];h[t+12>>2]=h[262];h[259]=C;h[260]=m;h[262]=0;h[261]=t;t=e+28|0;h[t>>2]=7;if((e+32|0)>>>0<i>>>0)do{B=t;t=t+4|0;h[t>>2]=7}while((B+8|0)>>>0<i>>>0);if((e|0)!=(o|0)){a=e-o|0;h[r>>2]=h[r>>2]&-2;h[o+4>>2]=a|1;h[e>>2]=a;t=a>>>3;if(a>>>0<256){e=t<<1;i=628+(e<<2)|0;r=h[147]|0;t=1<<t;if(r&t){t=628+(e+2<<2)|0;e=h[t>>2]|0;if(e>>>0<(h[151]|0)>>>0)Oe();else{M=t;R=e}}else{h[147]=r|t;M=628+(e+2<<2)|0;R=i}h[M>>2]=o;h[R+12>>2]=o;h[o+8>>2]=R;h[o+12>>2]=i;break}t=a>>>8;if(t)if(a>>>0>16777215)i=31;else{F=(t+1048320|0)>>>16&8;B=t<<F;k=(B+520192|0)>>>16&4;B=B<<k;i=(B+245760|0)>>>16&2;i=14-(k|F|i)+(B<<i>>>15)|0;i=a>>>(i+7|0)&1|i<<1}else i=0;r=892+(i<<2)|0;h[o+28>>2]=i;h[o+20>>2]=0;h[n>>2]=0;t=h[148]|0;e=1<<i;if(!(t&e)){h[148]=t|e;h[r>>2]=o;h[o+24>>2]=r;h[o+12>>2]=o;h[o+8>>2]=o;break}t=h[r>>2]|0;t:do{if((h[t+4>>2]&-8|0)!=(a|0)){i=a<<((i|0)==31?0:25-(i>>>1)|0);while(1){e=t+16+(i>>>31<<2)|0;r=h[e>>2]|0;if(!r)break;if((h[r+4>>2]&-8|0)==(a|0)){L=r;break t}else{i=i<<1;t=r}}if(e>>>0<(h[151]|0)>>>0)Oe();else{h[e>>2]=o;h[o+24>>2]=t;h[o+12>>2]=o;h[o+8>>2]=o;break e}}else L=t}while(0);t=L+8|0;e=h[t>>2]|0;B=h[151]|0;if(e>>>0>=B>>>0&L>>>0>=B>>>0){h[e+12>>2]=o;h[t>>2]=o;h[o+8>>2]=e;h[o+12>>2]=L;h[o+24>>2]=0;break}else Oe()}}else{B=h[151]|0;if((B|0)==0|C>>>0<B>>>0)h[151]=C;h[259]=C;h[260]=m;h[262]=0;h[156]=h[265];h[155]=-1;t=0;do{B=t<<1;F=628+(B<<2)|0;h[628+(B+3<<2)>>2]=F;h[628+(B+2<<2)>>2]=F;t=t+1|0}while((t|0)!=32);B=C+8|0;B=(B&7|0)==0?0:0-B&7;F=m+-40-B|0;h[153]=C+B;h[150]=F;h[C+(B+4)>>2]=F|1;h[C+(m+-36)>>2]=40;h[154]=h[269]}}while(0);t=h[150]|0;if(t>>>0>v>>>0){F=t-v|0;h[150]=F;B=h[153]|0;h[153]=B+v;h[B+(v+4)>>2]=F|1;h[B+4>>2]=v|3;B=B+8|0;return B|0}}B=lr()|0;h[B>>2]=12;B=0;return B|0}function Vr(e){e=e|0;var t=0,r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,m=0,v=0,g=0,_=0,y=0,b=0;if(!e)return;t=e+-8|0;s=h[151]|0;if(t>>>0<s>>>0)Oe();r=h[e+-4>>2]|0;i=r&3;if((i|0)==1)Oe();p=r&-8;v=e+(p+-8)|0;do{if(!(r&1)){t=h[t>>2]|0;if(!i)return;l=-8-t|0;c=e+l|0;d=t+p|0;if(c>>>0<s>>>0)Oe();if((c|0)==(h[152]|0)){t=e+(p+-4)|0;r=h[t>>2]|0;if((r&3|0)!=3){b=c;a=d;break}h[149]=d;h[t>>2]=r&-2;h[e+(l+4)>>2]=d|1;h[v>>2]=d;return}n=t>>>3;if(t>>>0<256){i=h[e+(l+8)>>2]|0;r=h[e+(l+12)>>2]|0;t=628+(n<<1<<2)|0;if((i|0)!=(t|0)){if(i>>>0<s>>>0)Oe();if((h[i+12>>2]|0)!=(c|0))Oe()}if((r|0)==(i|0)){h[147]=h[147]&~(1<<n);b=c;a=d;break}if((r|0)!=(t|0)){if(r>>>0<s>>>0)Oe();t=r+8|0;if((h[t>>2]|0)==(c|0))o=t;else Oe()}else o=r+8|0;h[i+12>>2]=r;h[o>>2]=i;b=c;a=d;break}o=h[e+(l+24)>>2]|0;i=h[e+(l+12)>>2]|0;do{if((i|0)==(c|0)){r=e+(l+20)|0;t=h[r>>2]|0;if(!t){r=e+(l+16)|0;t=h[r>>2]|0;if(!t){u=0;break}}while(1){i=t+20|0;n=h[i>>2]|0;if(n){t=n;r=i;continue}i=t+16|0;n=h[i>>2]|0;if(!n)break;else{t=n;r=i}}if(r>>>0<s>>>0)Oe();else{h[r>>2]=0;u=t;break}}else{n=h[e+(l+8)>>2]|0;if(n>>>0<s>>>0)Oe();t=n+12|0;if((h[t>>2]|0)!=(c|0))Oe();r=i+8|0;if((h[r>>2]|0)==(c|0)){h[t>>2]=i;h[r>>2]=n;u=i;break}else Oe()}}while(0);if(o){t=h[e+(l+28)>>2]|0;r=892+(t<<2)|0;if((c|0)==(h[r>>2]|0)){h[r>>2]=u;if(!u){h[148]=h[148]&~(1<<t);b=c;a=d;break}}else{if(o>>>0<(h[151]|0)>>>0)Oe();t=o+16|0;if((h[t>>2]|0)==(c|0))h[t>>2]=u;else h[o+20>>2]=u;if(!u){b=c;a=d;break}}r=h[151]|0;if(u>>>0<r>>>0)Oe();h[u+24>>2]=o;t=h[e+(l+16)>>2]|0;do{if(t)if(t>>>0<r>>>0)Oe();else{h[u+16>>2]=t;h[t+24>>2]=u;break}}while(0);t=h[e+(l+20)>>2]|0;if(t)if(t>>>0<(h[151]|0)>>>0)Oe();else{h[u+20>>2]=t;h[t+24>>2]=u;b=c;a=d;break}else{b=c;a=d}}else{b=c;a=d}}else{b=t;a=p}}while(0);if(b>>>0>=v>>>0)Oe();t=e+(p+-4)|0;r=h[t>>2]|0;if(!(r&1))Oe();if(!(r&2)){if((v|0)==(h[153]|0)){y=(h[150]|0)+a|0;h[150]=y;h[153]=b;h[b+4>>2]=y|1;if((b|0)!=(h[152]|0))return;h[152]=0;h[149]=0;return}if((v|0)==(h[152]|0)){y=(h[149]|0)+a|0;h[149]=y;h[152]=b;h[b+4>>2]=y|1;h[b+y>>2]=y;return}a=(r&-8)+a|0;n=r>>>3;do{if(r>>>0>=256){o=h[e+(p+16)>>2]|0;t=h[e+(p|4)>>2]|0;do{if((t|0)==(v|0)){r=e+(p+12)|0;t=h[r>>2]|0;if(!t){r=e+(p+8)|0;t=h[r>>2]|0;if(!t){m=0;break}}while(1){i=t+20|0;n=h[i>>2]|0;if(n){t=n;r=i;continue}i=t+16|0;n=h[i>>2]|0;if(!n)break;else{t=n;r=i}}if(r>>>0<(h[151]|0)>>>0)Oe();else{h[r>>2]=0;m=t;break}}else{r=h[e+p>>2]|0;if(r>>>0<(h[151]|0)>>>0)Oe();i=r+12|0;if((h[i>>2]|0)!=(v|0))Oe();n=t+8|0;if((h[n>>2]|0)==(v|0)){h[i>>2]=t;h[n>>2]=r;m=t;break}else Oe()}}while(0);if(o){t=h[e+(p+20)>>2]|0;r=892+(t<<2)|0;if((v|0)==(h[r>>2]|0)){h[r>>2]=m;if(!m){h[148]=h[148]&~(1<<t);break}}else{if(o>>>0<(h[151]|0)>>>0)Oe();t=o+16|0;if((h[t>>2]|0)==(v|0))h[t>>2]=m;else h[o+20>>2]=m;if(!m)break}r=h[151]|0;if(m>>>0<r>>>0)Oe();h[m+24>>2]=o;t=h[e+(p+8)>>2]|0;do{if(t)if(t>>>0<r>>>0)Oe();else{h[m+16>>2]=t;h[t+24>>2]=m;break}}while(0);t=h[e+(p+12)>>2]|0;if(t)if(t>>>0<(h[151]|0)>>>0)Oe();else{h[m+20>>2]=t;h[t+24>>2]=m;break}}}else{i=h[e+p>>2]|0;r=h[e+(p|4)>>2]|0;t=628+(n<<1<<2)|0;if((i|0)!=(t|0)){if(i>>>0<(h[151]|0)>>>0)Oe();if((h[i+12>>2]|0)!=(v|0))Oe()}if((r|0)==(i|0)){h[147]=h[147]&~(1<<n);break}if((r|0)!=(t|0)){if(r>>>0<(h[151]|0)>>>0)Oe();t=r+8|0;if((h[t>>2]|0)==(v|0))f=t;else Oe()}else f=r+8|0;h[i+12>>2]=r;h[f>>2]=i}}while(0);h[b+4>>2]=a|1;h[b+a>>2]=a;if((b|0)==(h[152]|0)){h[149]=a;return}}else{h[t>>2]=r&-2;h[b+4>>2]=a|1;h[b+a>>2]=a}t=a>>>3;if(a>>>0<256){r=t<<1;n=628+(r<<2)|0;i=h[147]|0;t=1<<t;if(i&t){t=628+(r+2<<2)|0;r=h[t>>2]|0;if(r>>>0<(h[151]|0)>>>0)Oe();else{g=t;_=r}}else{h[147]=i|t;g=628+(r+2<<2)|0;_=n}h[g>>2]=b;h[_+12>>2]=b;h[b+8>>2]=_;h[b+12>>2]=n;return}t=a>>>8;if(t)if(a>>>0>16777215)n=31;else{g=(t+1048320|0)>>>16&8;_=t<<g;v=(_+520192|0)>>>16&4;_=_<<v;n=(_+245760|0)>>>16&2;n=14-(v|g|n)+(_<<n>>>15)|0;n=a>>>(n+7|0)&1|n<<1}else n=0;t=892+(n<<2)|0;h[b+28>>2]=n;h[b+20>>2]=0;h[b+16>>2]=0;r=h[148]|0;i=1<<n;e:do{if(r&i){t=h[t>>2]|0;t:do{if((h[t+4>>2]&-8|0)!=(a|0)){n=a<<((n|0)==31?0:25-(n>>>1)|0);while(1){r=t+16+(n>>>31<<2)|0;i=h[r>>2]|0;if(!i)break;if((h[i+4>>2]&-8|0)==(a|0)){y=i;break t}else{n=n<<1;t=i}}if(r>>>0<(h[151]|0)>>>0)Oe();else{h[r>>2]=b;h[b+24>>2]=t;h[b+12>>2]=b;h[b+8>>2]=b;break e}}else y=t}while(0);t=y+8|0;r=h[t>>2]|0;_=h[151]|0;if(r>>>0>=_>>>0&y>>>0>=_>>>0){h[r+12>>2]=b;h[t>>2]=b;h[b+8>>2]=r;h[b+12>>2]=y;h[b+24>>2]=0;break}else Oe()}else{h[148]=r|i;h[t>>2]=b;h[b+24>>2]=t;h[b+12>>2]=b;h[b+8>>2]=b}}while(0);b=(h[155]|0)+-1|0;h[155]=b;if(!b)t=1044;else return;while(1){t=h[t>>2]|0;if(!t)break;else t=t+8|0}h[155]=-1;return}function zr(e,t){e=e|0;t=t|0;var r=0,i=0;if(!e){e=Ur(t)|0;return e|0}if(t>>>0>4294967231){e=lr()|0;h[e>>2]=12;e=0;return e|0}r=Gr(e+-8|0,t>>>0<11?16:t+11&-8)|0;if(r){e=r+8|0;return e|0}r=Ur(t)|0;if(!r){e=0;return e|0}i=h[e+-4>>2]|0;i=(i&-8)-((i&3|0)==0?8:4)|0;Kr(r|0,e|0,(i>>>0<t>>>0?i:t)|0)|0;Vr(e);e=r;return e|0}function qr(e){e=e|0;var t=0;if(!e){t=0;return t|0}e=h[e+-4>>2]|0;t=e&3;if((t|0)==1){t=0;return t|0}t=(e&-8)-((t|0)==0?8:4)|0;return t|0}function Gr(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,m=0;p=e+4|0;m=h[p>>2]|0;l=m&-8;c=e+l|0;s=h[151]|0;r=m&3;if(!((r|0)!=1&e>>>0>=s>>>0&e>>>0<c>>>0))Oe();i=e+(l|4)|0;n=h[i>>2]|0;if(!(n&1))Oe();if(!r){if(t>>>0<256){e=0;return e|0}if(l>>>0>=(t+4|0)>>>0?(l-t|0)>>>0<=h[267]<<1>>>0:0)return e|0;e=0;return e|0}if(l>>>0>=t>>>0){r=l-t|0;if(r>>>0<=15)return e|0;h[p>>2]=m&1|t|2;h[e+(t+4)>>2]=r|3;h[i>>2]=h[i>>2]|1;Hr(e+t|0,r);return e|0}if((c|0)==(h[153]|0)){r=(h[150]|0)+l|0;if(r>>>0<=t>>>0){e=0;return e|0}f=r-t|0;h[p>>2]=m&1|t|2;h[e+(t+4)>>2]=f|1;h[153]=e+t;h[150]=f;return e|0}if((c|0)==(h[152]|0)){i=(h[149]|0)+l|0;if(i>>>0<t>>>0){e=0;return e|0}r=i-t|0;if(r>>>0>15){h[p>>2]=m&1|t|2;h[e+(t+4)>>2]=r|1;h[e+i>>2]=r;i=e+(i+4)|0;h[i>>2]=h[i>>2]&-2;i=e+t|0}else{h[p>>2]=m&1|i|2;i=e+(i+4)|0;h[i>>2]=h[i>>2]|1;i=0;r=0}h[149]=r;h[152]=i;return e|0}if(n&2){e=0;return e|0}d=(n&-8)+l|0;if(d>>>0<t>>>0){e=0;return e|0}f=d-t|0;a=n>>>3;do{if(n>>>0>=256){o=h[e+(l+24)>>2]|0;a=h[e+(l+12)>>2]|0;do{if((a|0)==(c|0)){i=e+(l+20)|0;r=h[i>>2]|0;if(!r){i=e+(l+16)|0;r=h[i>>2]|0;if(!r){u=0;break}}while(1){n=r+20|0;a=h[n>>2]|0;if(a){r=a;i=n;continue}n=r+16|0;a=h[n>>2]|0;if(!a)break;else{r=a;i=n}}if(i>>>0<s>>>0)Oe();else{h[i>>2]=0;u=r;break}}else{n=h[e+(l+8)>>2]|0;if(n>>>0<s>>>0)Oe();r=n+12|0;if((h[r>>2]|0)!=(c|0))Oe();i=a+8|0;if((h[i>>2]|0)==(c|0)){h[r>>2]=a;h[i>>2]=n;u=a;break}else Oe()}}while(0);if(o){r=h[e+(l+28)>>2]|0;i=892+(r<<2)|0;if((c|0)==(h[i>>2]|0)){h[i>>2]=u;if(!u){h[148]=h[148]&~(1<<r);break}}else{if(o>>>0<(h[151]|0)>>>0)Oe();r=o+16|0;if((h[r>>2]|0)==(c|0))h[r>>2]=u;else h[o+20>>2]=u;if(!u)break}i=h[151]|0;if(u>>>0<i>>>0)Oe();h[u+24>>2]=o;r=h[e+(l+16)>>2]|0;do{if(r)if(r>>>0<i>>>0)Oe();else{h[u+16>>2]=r;h[r+24>>2]=u;break}}while(0);r=h[e+(l+20)>>2]|0;if(r)if(r>>>0<(h[151]|0)>>>0)Oe();else{h[u+20>>2]=r;h[r+24>>2]=u;break}}}else{n=h[e+(l+8)>>2]|0;i=h[e+(l+12)>>2]|0;r=628+(a<<1<<2)|0;if((n|0)!=(r|0)){if(n>>>0<s>>>0)Oe();if((h[n+12>>2]|0)!=(c|0))Oe()}if((i|0)==(n|0)){h[147]=h[147]&~(1<<a);break}if((i|0)!=(r|0)){if(i>>>0<s>>>0)Oe();r=i+8|0;if((h[r>>2]|0)==(c|0))o=r;else Oe()}else o=i+8|0;h[n+12>>2]=i;h[o>>2]=n}}while(0);if(f>>>0<16){h[p>>2]=d|m&1|2;t=e+(d|4)|0;h[t>>2]=h[t>>2]|1;return e|0}else{h[p>>2]=m&1|t|2;h[e+(t+4)>>2]=f|3;m=e+(d|4)|0;h[m>>2]=h[m>>2]|1;Hr(e+t|0,f);return e|0}return 0}function Hr(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0,o=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,m=0,v=0,g=0,_=0,y=0;v=e+t|0;r=h[e+4>>2]|0;do{if(!(r&1)){u=h[e>>2]|0;if(!(r&3))return;f=e+(0-u)|0;d=u+t|0;l=h[151]|0;if(f>>>0<l>>>0)Oe();if((f|0)==(h[152]|0)){i=e+(t+4)|0;r=h[i>>2]|0;if((r&3|0)!=3){y=f;o=d;break}h[149]=d;h[i>>2]=r&-2;h[e+(4-u)>>2]=d|1;h[v>>2]=d;return}a=u>>>3;if(u>>>0<256){n=h[e+(8-u)>>2]|0;i=h[e+(12-u)>>2]|0;r=628+(a<<1<<2)|0;if((n|0)!=(r|0)){if(n>>>0<l>>>0)Oe();if((h[n+12>>2]|0)!=(f|0))Oe()}if((i|0)==(n|0)){h[147]=h[147]&~(1<<a);y=f;o=d;break}if((i|0)!=(r|0)){if(i>>>0<l>>>0)Oe();r=i+8|0;if((h[r>>2]|0)==(f|0))s=r;else Oe()}else s=i+8|0;h[n+12>>2]=i;h[s>>2]=n;y=f;o=d;break}s=h[e+(24-u)>>2]|0;n=h[e+(12-u)>>2]|0;do{if((n|0)==(f|0)){n=16-u|0;i=e+(n+4)|0;r=h[i>>2]|0;if(!r){i=e+n|0;r=h[i>>2]|0;if(!r){c=0;break}}while(1){n=r+20|0;a=h[n>>2]|0;if(a){r=a;i=n;continue}n=r+16|0;a=h[n>>2]|0;if(!a)break;else{r=a;i=n}}if(i>>>0<l>>>0)Oe();else{h[i>>2]=0;c=r;break}}else{a=h[e+(8-u)>>2]|0;if(a>>>0<l>>>0)Oe();r=a+12|0;if((h[r>>2]|0)!=(f|0))Oe();i=n+8|0;if((h[i>>2]|0)==(f|0)){h[r>>2]=n;h[i>>2]=a;c=n;break}else Oe()}}while(0);if(s){r=h[e+(28-u)>>2]|0;i=892+(r<<2)|0;if((f|0)==(h[i>>2]|0)){h[i>>2]=c;if(!c){h[148]=h[148]&~(1<<r);y=f;o=d;break}}else{if(s>>>0<(h[151]|0)>>>0)Oe();r=s+16|0;if((h[r>>2]|0)==(f|0))h[r>>2]=c;else h[s+20>>2]=c;if(!c){y=f;o=d;break}}n=h[151]|0;if(c>>>0<n>>>0)Oe();h[c+24>>2]=s;r=16-u|0;i=h[e+r>>2]|0;do{if(i)if(i>>>0<n>>>0)Oe();else{h[c+16>>2]=i;h[i+24>>2]=c;break}}while(0);r=h[e+(r+4)>>2]|0;if(r)if(r>>>0<(h[151]|0)>>>0)Oe();else{h[c+20>>2]=r;h[r+24>>2]=c;y=f;o=d;break}else{y=f;o=d}}else{y=f;o=d}}else{y=e;o=t}}while(0);l=h[151]|0;if(v>>>0<l>>>0)Oe();r=e+(t+4)|0;i=h[r>>2]|0;if(!(i&2)){if((v|0)==(h[153]|0)){_=(h[150]|0)+o|0;h[150]=_;h[153]=y;h[y+4>>2]=_|1;if((y|0)!=(h[152]|0))return;h[152]=0;h[149]=0;return}if((v|0)==(h[152]|0)){_=(h[149]|0)+o|0;h[149]=_;h[152]=y;h[y+4>>2]=_|1;h[y+_>>2]=_;return}o=(i&-8)+o|0;a=i>>>3;do{if(i>>>0>=256){s=h[e+(t+24)>>2]|0;n=h[e+(t+12)>>2]|0;do{if((n|0)==(v|0)){i=e+(t+20)|0;r=h[i>>2]|0;if(!r){i=e+(t+16)|0;r=h[i>>2]|0;if(!r){m=0;break}}while(1){n=r+20|0;a=h[n>>2]|0;if(a){r=a;i=n;continue}n=r+16|0;a=h[n>>2]|0;if(!a)break;else{r=a;i=n}}if(i>>>0<l>>>0)Oe();else{h[i>>2]=0;m=r;break}}else{a=h[e+(t+8)>>2]|0;if(a>>>0<l>>>0)Oe();r=a+12|0;if((h[r>>2]|0)!=(v|0))Oe();i=n+8|0;if((h[i>>2]|0)==(v|0)){h[r>>2]=n;h[i>>2]=a;m=n;break}else Oe()}}while(0);if(s){r=h[e+(t+28)>>2]|0;i=892+(r<<2)|0;if((v|0)==(h[i>>2]|0)){h[i>>2]=m;if(!m){h[148]=h[148]&~(1<<r);break}}else{if(s>>>0<(h[151]|0)>>>0)Oe();r=s+16|0;if((h[r>>2]|0)==(v|0))h[r>>2]=m;else h[s+20>>2]=m;if(!m)break}i=h[151]|0;if(m>>>0<i>>>0)Oe();h[m+24>>2]=s;r=h[e+(t+16)>>2]|0;do{if(r)if(r>>>0<i>>>0)Oe();else{h[m+16>>2]=r;h[r+24>>2]=m;break}}while(0);r=h[e+(t+20)>>2]|0;if(r)if(r>>>0<(h[151]|0)>>>0)Oe();else{h[m+20>>2]=r;h[r+24>>2]=m;break}}}else{n=h[e+(t+8)>>2]|0;i=h[e+(t+12)>>2]|0;r=628+(a<<1<<2)|0;if((n|0)!=(r|0)){if(n>>>0<l>>>0)Oe();if((h[n+12>>2]|0)!=(v|0))Oe()}if((i|0)==(n|0)){h[147]=h[147]&~(1<<a);break}if((i|0)!=(r|0)){if(i>>>0<l>>>0)Oe();r=i+8|0;if((h[r>>2]|0)==(v|0))p=r;else Oe()}else p=i+8|0;h[n+12>>2]=i;h[p>>2]=n}}while(0);h[y+4>>2]=o|1;h[y+o>>2]=o;if((y|0)==(h[152]|0)){h[149]=o;return}}else{h[r>>2]=i&-2;h[y+4>>2]=o|1;h[y+o>>2]=o}r=o>>>3;if(o>>>0<256){i=r<<1;a=628+(i<<2)|0;n=h[147]|0;r=1<<r;if(n&r){r=628+(i+2<<2)|0;i=h[r>>2]|0;if(i>>>0<(h[151]|0)>>>0)Oe();else{g=r;_=i}}else{h[147]=n|r;g=628+(i+2<<2)|0;_=a}h[g>>2]=y;h[_+12>>2]=y;h[y+8>>2]=_;h[y+12>>2]=a;return}r=o>>>8;if(r)if(o>>>0>16777215)a=31;else{g=(r+1048320|0)>>>16&8;_=r<<g;v=(_+520192|0)>>>16&4;_=_<<v;a=(_+245760|0)>>>16&2;a=14-(v|g|a)+(_<<a>>>15)|0;a=o>>>(a+7|0)&1|a<<1}else a=0;r=892+(a<<2)|0;h[y+28>>2]=a;h[y+20>>2]=0;h[y+16>>2]=0;i=h[148]|0;n=1<<a;if(!(i&n)){h[148]=i|n;h[r>>2]=y;h[y+24>>2]=r;h[y+12>>2]=y;h[y+8>>2]=y;return}r=h[r>>2]|0;e:do{if((h[r+4>>2]&-8|0)!=(o|0)){a=o<<((a|0)==31?0:25-(a>>>1)|0);while(1){i=r+16+(a>>>31<<2)|0;n=h[i>>2]|0;if(!n)break;if((h[n+4>>2]&-8|0)==(o|0)){r=n;break e}else{a=a<<1;r=n}}if(i>>>0<(h[151]|0)>>>0)Oe();h[i>>2]=y;h[y+24>>2]=r;h[y+12>>2]=y;h[y+8>>2]=y;return}}while(0);i=r+8|0;n=h[i>>2]|0;_=h[151]|0;if(!(n>>>0>=_>>>0&r>>>0>=_>>>0))Oe();h[n+12>>2]=y;h[i>>2]=y;h[y+8>>2]=n;h[y+12>>2]=r;h[y+24>>2]=0;return}function jr(){}function Wr(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;i=t-i-(r>>>0>e>>>0|0)>>>0;return(V=i,e-r>>>0|0)|0}function Yr(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;r=e+r>>>0;return(V=t+i+(r>>>0<e>>>0|0)>>>0,r|0)|0}function Xr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0,n=0,a=0,o=0;i=e+r|0;if((r|0)>=20){t=t&255;a=e&3;o=t|t<<8|t<<16|t<<24;n=i&~3;if(a){a=e+4-a|0;while((e|0)<(a|0)){d[e>>0]=t;e=e+1|0}}while((e|0)<(n|0)){h[e>>2]=o;e=e+4|0}}while((e|0)<(i|0)){d[e>>0]=t;e=e+1|0}return e-r|0}function Qr(e,t,r){e=e|0;t=t|0;r=r|0;if((r|0)<32){V=t>>>r;return e>>>r|(t&(1<<r)-1)<<32-r}V=0;return t>>>r-32|0}function Zr(e,t,r){e=e|0;t=t|0;r=r|0;if((r|0)<32){V=t<<r|(e&(1<<r)-1<<32-r)>>>32-r;return e<<r}V=e<<r-32;return 0}function Kr(e,t,r){e=e|0;t=t|0;r=r|0;var i=0;if((r|0)>=4096)return ke(e|0,t|0,r|0)|0;i=e|0;if((e&3)==(t&3)){while(e&3){if(!r)return i|0;d[e>>0]=d[t>>0]|0;e=e+1|0;t=t+1|0;r=r-1|0}while((r|0)>=4){h[e>>2]=h[t>>2];e=e+4|0;t=t+4|0;r=r-4|0}}while((r|0)>0){d[e>>0]=d[t>>0]|0;e=e+1|0;t=t+1|0;r=r-1|0}return i|0}function Jr(e,t,r){e=e|0;t=t|0;r=r|0;if((r|0)<32){V=t>>r;return e>>>r|(t&(1<<r)-1)<<32-r}V=(t|0)<0?-1:0;return t>>r-32|0}function $r(e){e=e|0;var t=0;t=d[T+(e&255)>>0]|0;if((t|0)<8)return t|0;t=d[T+(e>>8&255)>>0]|0;if((t|0)<8)return t+8|0;t=d[T+(e>>16&255)>>0]|0;if((t|0)<8)return t+16|0;return(d[T+(e>>>24)>>0]|0)+24|0}function ei(e,t){e=e|0;t=t|0;var r=0,i=0,n=0,a=0;a=e&65535;n=t&65535;r=ce(n,a)|0;i=e>>>16;e=(r>>>16)+(ce(n,i)|0)|0;n=t>>>16;t=ce(n,a)|0;return(V=(e>>>16)+(ce(n,i)|0)+(((e&65535)+t|0)>>>16)|0,e+t<<16|r&65535|0)|0}function ti(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,l=0,u=0;u=t>>31|((t|0)<0?-1:0)<<1;l=((t|0)<0?-1:0)>>31|((t|0)<0?-1:0)<<1;a=i>>31|((i|0)<0?-1:0)<<1;n=((i|0)<0?-1:0)>>31|((i|0)<0?-1:0)<<1;s=Wr(u^e,l^t,u,l)|0;o=V;e=a^u;t=n^l;return Wr((oi(s,o,Wr(a^r,n^i,a,n)|0,V,0)|0)^e,V^t,e,t)|0}function ri(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0,o=0,s=0,l=0,u=0;n=b;b=b+16|0;s=n|0;o=t>>31|((t|0)<0?-1:0)<<1;a=((t|0)<0?-1:0)>>31|((t|0)<0?-1:0)<<1;u=i>>31|((i|0)<0?-1:0)<<1;l=((i|0)<0?-1:0)>>31|((i|0)<0?-1:0)<<1;e=Wr(o^e,a^t,o,a)|0;t=V;oi(e,t,Wr(u^r,l^i,u,l)|0,V,s)|0;i=Wr(h[s>>2]^o,h[s+4>>2]^a,o,a)|0;r=V;b=n;return(V=r,i)|0}function ii(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0;n=e;a=r;r=ei(n,a)|0;e=V;return(V=(ce(t,a)|0)+(ce(i,n)|0)+e|e&0,r|0|0)|0}function ni(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;return oi(e,t,r,i,0)|0}function ai(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;var n=0,a=0;a=b;b=b+16|0;n=a|0;oi(e,t,r,i,n)|0;b=a;return(V=h[n+4>>2]|0,h[n>>2]|0)|0}function oi(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;var a=0,o=0,s=0,l=0,u=0,c=0,d=0,f=0,p=0,m=0;c=e;l=t;u=l;o=r;f=i;s=f;if(!u){a=(n|0)!=0;if(!s){if(a){h[n>>2]=(c>>>0)%(o>>>0);h[n+4>>2]=0}f=0;n=(c>>>0)/(o>>>0)>>>0;return(V=f,n)|0}else{if(!a){f=0;n=0;return(V=f,n)|0}h[n>>2]=e|0;h[n+4>>2]=t&0;f=0;n=0;return(V=f,n)|0}}a=(s|0)==0;do{if(o){if(!a){a=(fe(s|0)|0)-(fe(u|0)|0)|0;if(a>>>0<=31){d=a+1|0;s=31-a|0;t=a-31>>31;o=d;e=c>>>(d>>>0)&t|u<<s;t=u>>>(d>>>0)&t;a=0;s=c<<s;break}if(!n){f=0;n=0;return(V=f,n)|0}h[n>>2]=e|0;h[n+4>>2]=l|t&0;f=0;n=0;return(V=f,n)|0}a=o-1|0;if(a&o){s=(fe(o|0)|0)+33-(fe(u|0)|0)|0;m=64-s|0;d=32-s|0;l=d>>31;p=s-32|0;t=p>>31;o=s;e=d-1>>31&u>>>(p>>>0)|(u<<d|c>>>(s>>>0))&t;t=t&u>>>(s>>>0);a=c<<m&l;s=(u<<m|c>>>(p>>>0))&l|c<<d&s-33>>31;break}if(n){h[n>>2]=a&c;h[n+4>>2]=0}if((o|0)==1){p=l|t&0;m=e|0|0;return(V=p,m)|0}else{m=$r(o|0)|0;p=u>>>(m>>>0)|0;m=u<<32-m|c>>>(m>>>0)|0;return(V=p,m)|0}}else{if(a){if(n){h[n>>2]=(u>>>0)%(o>>>0);h[n+4>>2]=0}p=0;m=(u>>>0)/(o>>>0)>>>0;return(V=p,m)|0}if(!c){if(n){h[n>>2]=0;h[n+4>>2]=(u>>>0)%(s>>>0)}p=0;m=(u>>>0)/(s>>>0)>>>0;return(V=p,m)|0}a=s-1|0;if(!(a&s)){if(n){h[n>>2]=e|0;h[n+4>>2]=a&u|t&0}p=0;m=u>>>(($r(s|0)|0)>>>0);return(V=p,m)|0}a=(fe(s|0)|0)-(fe(u|0)|0)|0;if(a>>>0<=30){t=a+1|0;s=31-a|0;o=t;e=u<<s|c>>>(t>>>0);t=u>>>(t>>>0);a=0;s=c<<s;break}if(!n){p=0;m=0;return(V=p,m)|0}h[n>>2]=e|0;h[n+4>>2]=l|t&0;p=0;m=0;return(V=p,m)|0}}while(0);if(!o){u=s;l=0;s=0}else{d=r|0|0;c=f|i&0;u=Yr(d|0,c|0,-1,-1)|0;r=V;l=s;s=0;do{i=l;l=a>>>31|l<<1;a=s|a<<1;i=e<<1|i>>>31|0;f=e>>>31|t<<1|0;Wr(u,r,i,f)|0;m=V;p=m>>31|((m|0)<0?-1:0)<<1;s=p&1;e=Wr(i,f,p&d,(((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1)&c)|0;t=V;o=o-1|0}while((o|0)!=0);u=l;l=0}o=0;if(n){h[n>>2]=e;h[n+4>>2]=t}p=(a|0)>>>31|(u|o)<<1|(o<<1|a>>>31)&0|l;m=(a<<1|0>>>31)&-2|s;return(V=p,m)|0}function si(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;return Si[e&7](t|0,r|0,i|0)|0}function li(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;Ti[e&3](t|0,r|0,i|0,n|0,a|0)}function ui(e,t){e=e|0;t=t|0;Ei[e&7](t|0)}function ci(e,t){e=e|0;t=t|0;return xi[e&1](t|0)|0}function di(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;Pi[e&0](t|0,r|0,i|0)}function fi(e){e=e|0;Ai[e&3]()}function hi(e,t,r,i,n,a,o){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;o=o|0;Oi[e&3](t|0,r|0,i|0,n|0,a|0,o|0)}function pi(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;Di[e&3](t|0,r|0,i|0,n|0)}function mi(e,t,r){e=e|0;t=t|0;r=r|0;he(0);return 0}function vi(e,t,r,i,n){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;he(1)}function gi(e){e=e|0;he(2)}function _i(e){e=e|0;he(3);return 0}function yi(e,t,r){e=e|0;t=t|0;r=r|0;he(4)}function bi(){he(5)}function wi(e,t,r,i,n,a){e=e|0;t=t|0;r=r|0;i=i|0;n=n|0;a=a|0;he(6)}function Ci(e,t,r,i){e=e|0;t=t|0;r=r|0;i=i|0;he(7)}var Si=[mi,Wt,Nr,Ar,Pr,Or,mi,mi];var Ti=[vi,$t,Jt,vi];var Ei=[gi,zt,Ht,qt,Gt,jt,or,Lr];var xi=[_i,xr];var Pi=[yi];var Ai=[bi,nr,ar,bi];var Oi=[wi,tr,er,wi];var Di=[Ci,Xt,Qt,Ci];return{___cxa_can_catch:rr,_crn_get_levels:bt,_crn_get_uncompressed_size:St,_crn_decompress:Tt,_i64Add:Yr,_crn_get_width:_t,___cxa_is_pointer_type:ir,_crn_get_bytes_per_block:Ct,_memset:Xr,_malloc:Ur,_memcpy:Kr,_i64Subtract:Wr,_bitshift64Lshr:Qr,_free:Vr,_bitshift64Shl:Zr,_crn_get_height:yt,_crn_get_dxt_format:wt,runPostSets:jr,_emscripten_replace_memory:je,stackAlloc:We,stackSave:Ye,stackRestore:Xe,establishStackSpace:Qe,setThrew:Ze,setTempRet0:$e,getTempRet0:et,dynCall_iiii:si,dynCall_viiiii:li,dynCall_vi:ui,dynCall_ii:ci,dynCall_viii:di,dynCall_v:fi,dynCall_viiiiii:hi,dynCall_viiii:pi}}(Module.asmGlobalArg,Module.asmLibraryArg,buffer);var ___cxa_can_catch=Module["___cxa_can_catch"]=asm["___cxa_can_catch"];var _crn_get_levels=Module["_crn_get_levels"]=asm["_crn_get_levels"];var runPostSets=Module["runPostSets"]=asm["runPostSets"];var _crn_get_uncompressed_size=Module["_crn_get_uncompressed_size"]=asm["_crn_get_uncompressed_size"];var _crn_decompress=Module["_crn_decompress"]=asm["_crn_decompress"];var _i64Add=Module["_i64Add"]=asm["_i64Add"];var _crn_get_height=Module["_crn_get_height"]=asm["_crn_get_height"];var ___cxa_is_pointer_type=Module["___cxa_is_pointer_type"]=asm["___cxa_is_pointer_type"];var _crn_get_bytes_per_block=Module["_crn_get_bytes_per_block"]=asm["_crn_get_bytes_per_block"];var _memset=Module["_memset"]=asm["_memset"];var _malloc=Module["_malloc"]=asm["_malloc"];var _memcpy=Module["_memcpy"]=asm["_memcpy"];var _emscripten_replace_memory=Module["_emscripten_replace_memory"]=asm["_emscripten_replace_memory"];var _i64Subtract=Module["_i64Subtract"]=asm["_i64Subtract"];var _bitshift64Lshr=Module["_bitshift64Lshr"]=asm["_bitshift64Lshr"];var _free=Module["_free"]=asm["_free"];var _crn_get_dxt_format=Module["_crn_get_dxt_format"]=asm["_crn_get_dxt_format"];var _crn_get_width=Module["_crn_get_width"]=asm["_crn_get_width"];var _bitshift64Shl=Module["_bitshift64Shl"]=asm["_bitshift64Shl"];var dynCall_iiii=Module["dynCall_iiii"]=asm["dynCall_iiii"];var dynCall_viiiii=Module["dynCall_viiiii"]=asm["dynCall_viiiii"];var dynCall_vi=Module["dynCall_vi"]=asm["dynCall_vi"];var dynCall_ii=Module["dynCall_ii"]=asm["dynCall_ii"];var dynCall_viii=Module["dynCall_viii"]=asm["dynCall_viii"];var dynCall_v=Module["dynCall_v"]=asm["dynCall_v"];var dynCall_viiiiii=Module["dynCall_viiiiii"]=asm["dynCall_viiiiii"];var dynCall_viiii=Module["dynCall_viiii"]=asm["dynCall_viiii"];Runtime.stackAlloc=asm["stackAlloc"];Runtime.stackSave=asm["stackSave"];Runtime.stackRestore=asm["stackRestore"];Runtime.establishStackSpace=asm["establishStackSpace"];Runtime.setTempRet0=asm["setTempRet0"];Runtime.getTempRet0=asm["getTempRet0"];function ExitStatus(e){this.name="ExitStatus";this.message="Program terminated with exit("+e+")";this.status=e}ExitStatus.prototype=new Error;ExitStatus.prototype.constructor=ExitStatus;var initialStackTop;var preloadStartTime=null;var calledMain=false;dependenciesFulfilled=function e(){if(!Module["calledRun"])run();if(!Module["calledRun"])dependenciesFulfilled=e};Module["callMain"]=Module.callMain=function e(t){assert(runDependencies==0,"cannot call main when async dependencies remain! (listen on __ATMAIN__)");assert(__ATPRERUN__.length==0,"cannot call main when preRun functions remain to be called");t=t||[];ensureInitRuntime();var r=t.length+1;function i(){for(var e=0;e<4-1;e++){n.push(0)}}var n=[allocate(intArrayFromString(Module["thisProgram"]),"i8",ALLOC_NORMAL)];i();for(var a=0;a<r-1;a=a+1){n.push(allocate(intArrayFromString(t[a]),"i8",ALLOC_NORMAL));i()}n.push(0);n=allocate(n,"i32",ALLOC_NORMAL);try{var o=Module["_main"](r,n,0);exit(o,true)}catch(e){if(e instanceof ExitStatus){return}else if(e=="SimulateInfiniteLoop"){Module["noExitRuntime"]=true;return}else{if(e&&typeof e==="object"&&e.stack)Module.printErr("exception thrown: "+[e,e.stack]);throw e}}finally{calledMain=true}};function run(e){e=e||Module["arguments"];if(preloadStartTime===null)preloadStartTime=Date.now();if(runDependencies>0){return}preRun();if(runDependencies>0)return;if(Module["calledRun"])return;function t(){if(Module["calledRun"])return;Module["calledRun"]=true;if(ABORT)return;ensureInitRuntime();preMain();if(Module["onRuntimeInitialized"])Module["onRuntimeInitialized"]();if(Module["_main"]&&shouldRunNow)Module["callMain"](e);postRun()}if(Module["setStatus"]){Module["setStatus"]("Running...");setTimeout(function(){setTimeout(function(){Module["setStatus"]("")},1);t()},1)}else{t()}}Module["run"]=Module.run=run;function exit(e,t){if(t&&Module["noExitRuntime"]){return}if(Module["noExitRuntime"]){}else{ABORT=true;EXITSTATUS=e;STACKTOP=initialStackTop;exitRuntime();if(Module["onExit"])Module["onExit"](e)}if(ENVIRONMENT_IS_NODE){process["stdout"]["once"]("drain",function(){process["exit"](e)});console.log(" ");setTimeout(function(){process["exit"](e)},500)}else if(ENVIRONMENT_IS_SHELL&&typeof quit==="function"){quit(e)}throw new ExitStatus(e)}Module["exit"]=Module.exit=exit;var abortDecorators=[];function abort(e){if(e!==undefined){Module.print(e);Module.printErr(e);e=JSON.stringify(e)}else{e=""}ABORT=true;EXITSTATUS=1;var t="\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";var r="abort("+e+") at "+stackTrace()+t;if(abortDecorators){abortDecorators.forEach(function(t){r=t(r,e)})}throw r}Module["abort"]=Module.abort=abort;if(Module["preInit"]){if(typeof Module["preInit"]=="function")Module["preInit"]=[Module["preInit"]];while(Module["preInit"].length>0){Module["preInit"].pop()()}}var shouldRunNow=true;if(Module["noInitialRun"]){shouldRunNow=false}Module["noExitRuntime"]=true;run();return Module});define("ThirdParty/GltfPipeline/getJointCountForMaterials",["./ForEach","../../Core/defined"],function(e,t){"use strict";function r(r){var i=r.meshes;var n={};var a={};e.node(r,function(e){if(t(e.skin)){if(!t(a[e.skin])){a[e.skin]=[]}a[e.skin].push(e)}});e.skin(r,function(r,o){var s=r.joints.length;var l=function(e){n[e.material]=s};var u=a[o];var c=u.length;for(var d=0;d<c;d++){var f=u[d];var h=f.mesh;if(t(h)){var p=i[h];e.meshPrimitive(p,l)}}});return n}return r});define("ThirdParty/GltfPipeline/getUniqueId",["../../Core/defined"],function(e){"use strict";function t(t,r){var i=r;var n=0;for(var a in t){if(t.hasOwnProperty(a)){var o=t[a];var s=o[i];while(e(s)){i=r+"_"+n;s=o[i];n++}}}return i}return t});(function(){(function(e){var t=this||(0,eval)("this"),r=t.document,i=t.navigator,n=t.jQuery,a=t.JSON;(function(e){"function"===typeof define&&define.amd?define("ThirdParty/knockout-3.4.0",["exports","require"],e):"object"===typeof exports&&"object"===typeof module?e(module.exports||exports):e(t.ko={})})(function(o,s){function l(e,t){return null===e||typeof e in v?e===t:!1}function u(t,r){var i;return function(){i||(i=m.a.setTimeout(function(){i=e;t()},r))}}function c(e,t){var r;return function(){clearTimeout(r);r=m.a.setTimeout(e,t)}}function d(e,t){t&&t!==g?"beforeChange"===t?this.Kb(e):this.Ha(e,t):this.Lb(e)}function f(e,t){null!==t&&t.k&&t.k()}function h(e,t){var r=this.Hc,i=r[C];i.R||(this.lb&&this.Ma[t]?(r.Pb(t,e,this.Ma[t]),this.Ma[t]=null,--this.lb):i.r[t]||r.Pb(t,e,i.s?{ia:e}:r.uc(e)))}function p(e,t,r,i){m.d[e]={init:function(e,n,a,o,s){var l,u;m.m(function(){var a=m.a.c(n()),o=!r!==!a,c=!u;if(c||t||o!==l)c&&m.va.Aa()&&(u=m.a.ua(m.f.childNodes(e),!0)),o?(c||m.f.da(e,m.a.ua(u)),m.eb(i?i(s,a):s,e)):m.f.xa(e),l=o},null,{i:e});return{controlsDescendantBindings:!0}}};m.h.ta[e]=!1;m.f.Z[e]=!0}var m="undefined"!==typeof o?o:{};m.b=function(e,t){for(var r=e.split("."),i=m,n=0;n<r.length-1;n++)i=i[r[n]];i[r[r.length-1]]=t};m.G=function(e,t,r){e[t]=r};m.version="3.4.0";m.b("version",m.version);m.options={deferUpdates:!1,useOnlyNativeEvents:!1};m.a=function(){function o(e,t){for(var r in e)e.hasOwnProperty(r)&&t(r,e[r])}function s(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function l(e,t){e.__proto__=t;return e}function u(e,t,r,i){var n=e[t].match(g)||[];m.a.q(r.match(g),function(e){m.a.pa(n,e,i)});e[t]=n.join(" ")}var c={__proto__:[]}instanceof Array,d="function"===typeof Symbol,f={},h={};f[i&&/Firefox\/2/i.test(i.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");o(f,function(e,t){if(t.length)for(var r=0,i=t.length;r<i;r++)h[t[r]]=e});var p={propertychange:!0},v=r&&function(){for(var t=3,i=r.createElement("div"),n=i.getElementsByTagName("i");i.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",n[0];);return 4<t?t:e}(),g=/\S+/g;return{cc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(e,t){for(var r=0,i=e.length;r<i;r++)t(e[r],r)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},Sb:function(e,t,r){for(var i=0,n=e.length;i<n;i++)if(t.call(r,e[i],i))return e[i];return null},La:function(e,t){var r=m.a.o(e,t);0<r?e.splice(r,1):0===r&&e.shift()},Tb:function(e){e=e||[];for(var t=[],r=0,i=e.length;r<i;r++)0>m.a.o(t,e[r])&&t.push(e[r]);return t},fb:function(e,t){e=e||[];for(var r=[],i=0,n=e.length;i<n;i++)r.push(t(e[i],i));return r},Ka:function(e,t){e=e||[];for(var r=[],i=0,n=e.length;i<n;i++)t(e[i],i)&&r.push(e[i]);return r},ra:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var r=0,i=t.length;r<i;r++)e.push(t[r]);return e},pa:function(e,t,r){var i=m.a.o(m.a.zb(e),t);0>i?r&&e.push(t):r||e.splice(i,1)},ka:c,extend:s,Xa:l,Ya:c?l:s,D:o,Ca:function(e,t){if(!e)return e;var r={},i;for(i in e)e.hasOwnProperty(i)&&(r[i]=t(e[i],i,e));return r},ob:function(e){for(;e.firstChild;)m.removeNode(e.firstChild)},jc:function(e){e=m.a.V(e);for(var t=(e[0]&&e[0].ownerDocument||r).createElement("div"),i=0,n=e.length;i<n;i++)t.appendChild(m.$(e[i]));return t},ua:function(e,t){for(var r=0,i=e.length,n=[];r<i;r++){var a=e[r].cloneNode(!0);n.push(t?m.$(a):a)}return n},da:function(e,t){m.a.ob(e);if(t)for(var r=0,i=t.length;r<i;r++)e.appendChild(t[r])},qc:function(e,t){var r=e.nodeType?[e]:e;if(0<r.length){for(var i=r[0],n=i.parentNode,a=0,o=t.length;a<o;a++)n.insertBefore(t[a],i);a=0;for(o=r.length;a<o;a++)m.removeNode(r[a])}},za:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var r=e[0],i=e[e.length-1];for(e.length=0;r!==i;)e.push(r),r=r.nextSibling;e.push(i)}}return e},sc:function(e,t){7>v?e.setAttribute("selected",t):e.selected=t},$a:function(t){return null===t||t===e?"":t.trim?t.trim():t.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},nd:function(e,t){e=e||"";return t.length>e.length?!1:e.substring(0,t.length)===t},Mc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(t.compareDocumentPosition(e)&16);for(;e&&e!=t;)e=e.parentNode;return!!e},nb:function(e){return m.a.Mc(e,e.ownerDocument.documentElement)},Qb:function(e){return!!m.a.Sb(e,m.a.nb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Wb:function(e){return m.onError?function(){try{return e.apply(this,arguments)}catch(e){throw m.onError&&m.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(m.a.Wb(e),t)},$b:function(e){setTimeout(function(){m.onError&&m.onError(e);throw e},0)},p:function(e,t,r){var i=m.a.Wb(r);r=v&&p[t];if(m.options.useOnlyNativeEvents||r||!n)if(r||"function"!=typeof e.addEventListener)if("undefined"!=typeof e.attachEvent){var a=function(t){i.call(e,t)},o="on"+t;e.attachEvent(o,a);m.a.F.oa(e,function(){e.detachEvent(o,a)})}else throw Error("Browser doesn't support addEventListener or attachEvent");else e.addEventListener(t,i,!1);else n(e).bind(t,i)},Da:function(e,i){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var a;"input"===m.a.A(e)&&e.type&&"click"==i.toLowerCase()?(a=e.type,a="checkbox"==a||"radio"==a):a=!1;if(m.options.useOnlyNativeEvents||!n||a)if("function"==typeof r.createEvent)if("function"==typeof e.dispatchEvent)a=r.createEvent(h[i]||"HTMLEvents"),a.initEvent(i,!0,!0,t,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(a);else throw Error("The supplied element doesn't support dispatchEvent");else if(a&&e.click)e.click();else if("undefined"!=typeof e.fireEvent)e.fireEvent("on"+i);else throw Error("Browser doesn't support triggering events");else n(e).trigger(i)},c:function(e){return m.H(e)?e():e},zb:function(e){return m.H(e)?e.t():e},bb:function(e,t,r){var i;t&&("object"===typeof e.classList?(i=e.classList[r?"add":"remove"],m.a.q(t.match(g),function(t){i.call(e.classList,t)})):"string"===typeof e.className.baseVal?u(e.className,"baseVal",t,r):u(e,"className",t,r))},Za:function(t,r){var i=m.a.c(r);if(null===i||i===e)i="";var n=m.f.firstChild(t);!n||3!=n.nodeType||m.f.nextSibling(n)?m.f.da(t,[t.ownerDocument.createTextNode(i)]):n.data=i;m.a.Rc(t)},rc:function(e,t){e.name=t;if(7>=v)try{e.mergeAttributes(r.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Rc:function(e){9<=v&&(e=1==e.nodeType?e:e.parentNode,e.style&&(e.style.zoom=e.style.zoom))},Nc:function(e){if(v){var t=e.style.width;e.style.width=0;e.style.width=t}},hd:function(e,t){e=m.a.c(e);t=m.a.c(t);for(var r=[],i=e;i<=t;i++)r.push(i);return r},V:function(e){for(var t=[],r=0,i=e.length;r<i;r++)t.push(e[r]);return t},Yb:function(e){return d?Symbol(e):e},rd:6===v,sd:7===v,C:v,ec:function(e,t){for(var r=m.a.V(e.getElementsByTagName("input")).concat(m.a.V(e.getElementsByTagName("textarea"))),i="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},n=[],a=r.length-1;0<=a;a--)i(r[a])&&n.push(r[a]);return n},ed:function(e){return"string"==typeof e&&(e=m.a.$a(e))?a&&a.parse?a.parse(e):new Function("return "+e)():null},Eb:function(e,t,r){if(!a||!a.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return a.stringify(m.a.c(e),t,r)},fd:function(e,t,i){i=i||{};var n=i.params||{},a=i.includeFields||this.cc,s=e;if("object"==typeof e&&"form"===m.a.A(e))for(var s=e.action,l=a.length-1;0<=l;l--)for(var u=m.a.ec(e,a[l]),c=u.length-1;0<=c;c--)n[u[c].name]=u[c].value;t=m.a.c(t);var d=r.createElement("form");d.style.display="none";d.action=s;d.method="post";for(var f in t)e=r.createElement("input"),e.type="hidden",e.name=f,e.value=m.a.Eb(m.a.c(t[f])),d.appendChild(e);o(n,function(e,t){var i=r.createElement("input");i.type="hidden";i.name=e;i.value=t;d.appendChild(i)});r.body.appendChild(d);i.submitter?i.submitter(d):d.submit();setTimeout(function(){d.parentNode.removeChild(d)},0)}}}();m.b("utils",m.a);m.b("utils.arrayForEach",m.a.q);m.b("utils.arrayFirst",m.a.Sb);m.b("utils.arrayFilter",m.a.Ka);m.b("utils.arrayGetDistinctValues",m.a.Tb);m.b("utils.arrayIndexOf",m.a.o);m.b("utils.arrayMap",m.a.fb);m.b("utils.arrayPushAll",m.a.ra);m.b("utils.arrayRemoveItem",m.a.La);m.b("utils.extend",m.a.extend);m.b("utils.fieldsIncludedWithJsonPost",m.a.cc);m.b("utils.getFormFields",m.a.ec);m.b("utils.peekObservable",m.a.zb);m.b("utils.postJson",m.a.fd);m.b("utils.parseJson",m.a.ed);m.b("utils.registerEventHandler",m.a.p);m.b("utils.stringifyJson",m.a.Eb);m.b("utils.range",m.a.hd);m.b("utils.toggleDomNodeCssClass",m.a.bb);m.b("utils.triggerEvent",m.a.Da);m.b("utils.unwrapObservable",m.a.c);m.b("utils.objectForEach",m.a.D);m.b("utils.addOrRemoveItem",m.a.pa);m.b("utils.setTextContent",m.a.Za);m.b("unwrap",m.a.c);Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var r=Array.prototype.slice.call(arguments,1);return function(){var i=r.slice(0);i.push.apply(i,arguments);return t.apply(e,i)}});m.a.e=new function(){function t(t,a){var o=t[i];if(!o||"null"===o||!n[o]){if(!a)return e;o=t[i]="ko"+r++;n[o]={}}return n[o]}var r=0,i="__ko__"+(new Date).getTime(),n={};return{get:function(r,i){var n=t(r,!1);return n===e?e:n[i]},set:function(r,i,n){if(n!==e||t(r,!1)!==e)t(r,!0)[i]=n},clear:function(e){var t=e[i];return t?(delete n[t],e[i]=null,!0):!1},I:function(){return r+++i}}};m.b("utils.domData",m.a.e);m.b("utils.domData.clear",m.a.e.clear);m.a.F=new function(){function t(t,r){var n=m.a.e.get(t,i);n===e&&r&&(n=[],m.a.e.set(t,i,n));return n}function r(e){var i=t(e,!1);if(i)for(var i=i.slice(0),n=0;n<i.length;n++)i[n](e);m.a.e.clear(e);m.a.F.cleanExternalData(e);if(o[e.nodeType])for(i=e.firstChild;e=i;)i=e.nextSibling,8===e.nodeType&&r(e)}var i=m.a.e.I(),a={1:!0,8:!0,9:!0},o={1:!0,9:!0};return{oa:function(e,r){if("function"!=typeof r)throw Error("Callback must be a function");t(e,!0).push(r)},pc:function(r,n){var a=t(r,!1);a&&(m.a.La(a,n),0==a.length&&m.a.e.set(r,i,e))},$:function(e){if(a[e.nodeType]&&(r(e),o[e.nodeType])){var t=[];m.a.ra(t,e.getElementsByTagName("*"));for(var i=0,n=t.length;i<n;i++)r(t[i])}return e},removeNode:function(e){m.$(e);e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){n&&"function"==typeof n.cleanData&&n.cleanData([e])}}};m.$=m.a.F.$;m.removeNode=m.a.F.removeNode;m.b("cleanNode",m.$);m.b("removeNode",m.removeNode);m.b("utils.domNodeDisposal",m.a.F);m.b("utils.domNodeDisposal.addDisposeCallback",m.a.F.oa);m.b("utils.domNodeDisposal.removeDisposeCallback",m.a.F.pc);(function(){var i=[0,"",""],a=[1,"<table>","</table>"],o=[3,"<table><tbody><tr>","</tr></tbody></table>"],s=[1,"<select multiple='multiple'>","</select>"],l={thead:a,tbody:a,tfoot:a,tr:[2,"<table><tbody>","</tbody></table>"],td:o,th:o,option:s,optgroup:s},u=8>=m.a.C;m.a.ma=function(e,a){var o;if(n)if(n.parseHTML)o=n.parseHTML(e,a)||[];else{if((o=n.clean([e],a))&&o[0]){for(var s=o[0];s.parentNode&&11!==s.parentNode.nodeType;)s=s.parentNode;s.parentNode&&s.parentNode.removeChild(s)}}else{(o=a)||(o=r);var s=o.parentWindow||o.defaultView||t,c=m.a.$a(e).toLowerCase(),d=o.createElement("div"),f;f=(c=c.match(/^<([a-z]+)[ >]/))&&l[c[1]]||i;c=f[0];f="ignored<div>"+f[1]+e+f[2]+"</div>";"function"==typeof s.innerShiv?d.appendChild(s.innerShiv(f)):(u&&o.appendChild(d),d.innerHTML=f,u&&d.parentNode.removeChild(d));for(;c--;)d=d.lastChild;o=m.a.V(d.lastChild.childNodes)}return o};m.a.Cb=function(t,r){m.a.ob(t);r=m.a.c(r);if(null!==r&&r!==e)if("string"!=typeof r&&(r=r.toString()),n)n(t).html(r);else for(var i=m.a.ma(r,t.ownerDocument),a=0;a<i.length;a++)t.appendChild(i[a])}})();m.b("utils.parseHtmlFragment",m.a.ma);m.b("utils.setHtml",m.a.Cb);m.M=function(){function t(e,r){if(e)if(8==e.nodeType){var i=m.M.lc(e.nodeValue);null!=i&&r.push({Lc:e,cd:i})}else if(1==e.nodeType)for(var i=0,n=e.childNodes,a=n.length;i<a;i++)t(n[i],r)}var r={};return{wb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);r[t]=e;return"\x3c!--[ko_memo:"+t+"]--\x3e"},xc:function(t,i){var n=r[t];if(n===e)throw Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.");try{return n.apply(null,i||[]),!0}finally{delete r[t]}},yc:function(e,r){var i=[];t(e,i);for(var n=0,a=i.length;n<a;n++){var o=i[n].Lc,s=[o];r&&m.a.ra(s,r);m.M.xc(i[n].cd,s);o.nodeValue="";o.parentNode&&o.parentNode.removeChild(o)}},lc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}();m.b("memoization",m.M);m.b("memoization.memoize",m.M.wb);m.b("memoization.unmemoize",m.M.xc);m.b("memoization.parseMemoText",m.M.lc);m.b("memoization.unmemoizeDomNodeAndDescendants",m.M.yc);m.Y=function(){function e(){if(a)for(var e=a,t=0,r;s<a;)if(r=n[s++]){if(s>e){if(5e3<=++t){s=a;m.a.$b(Error("'Too much recursion' after processing "+t+" task groups."));break}e=a}try{r()}catch(e){m.a.$b(e)}}}function i(){e();s=a=n.length=0}var n=[],a=0,o=1,s=0;return{scheduler:t.MutationObserver?function(e){var t=r.createElement("div");new MutationObserver(e).observe(t,{attributes:!0});return function(){t.classList.toggle("foo")}}(i):r&&"onreadystatechange"in r.createElement("script")?function(e){var t=r.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null;r.documentElement.removeChild(t);t=null;e()};r.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Wa:function(e){a||m.Y.scheduler(i);n[a++]=e;return o++},cancel:function(e){e-=o-a;e>=s&&e<a&&(n[e]=null)},resetForTesting:function(){var e=a-s;s=a=n.length=0;return e},md:e}}();m.b("tasks",m.Y);m.b("tasks.schedule",m.Y.Wa);m.b("tasks.runEarly",m.Y.md);m.ya={throttle:function(e,t){e.throttleEvaluation=t;var r=null;return m.B({read:e,write:function(i){clearTimeout(r);r=m.a.setTimeout(function(){e(i)},t)}})},rateLimit:function(e,t){var r,i,n;"number"==typeof t?r=t:(r=t.timeout,i=t.method);e.cb=!1;n="notifyWhenChangesStop"==i?c:u;e.Ta(function(e){return n(e,r)})},deferred:function(t,r){if(!0!==r)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");t.cb||(t.cb=!0,t.Ta(function(r){var i;return function(){m.Y.cancel(i);i=m.Y.Wa(r);t.notifySubscribers(e,"dirty")}}))},notify:function(e,t){e.equalityComparer="always"==t?null:l}};var v={undefined:1,boolean:1,number:1,string:1};m.b("extenders",m.ya);m.vc=function(e,t,r){this.ia=e;this.gb=t;this.Kc=r;this.R=!1;m.G(this,"dispose",this.k)};m.vc.prototype.k=function(){this.R=!0;this.Kc()};m.J=function(){m.a.Ya(this,_);_.rb(this)};var g="change",_={rb:function(e){e.K={};e.Nb=1},X:function(e,t,r){var i=this;r=r||g;var n=new m.vc(i,t?e.bind(t):e,function(){m.a.La(i.K[r],n);i.Ia&&i.Ia(r)});i.sa&&i.sa(r);i.K[r]||(i.K[r]=[]);i.K[r].push(n);return n},notifySubscribers:function(e,t){t=t||g;t===g&&this.zc();if(this.Pa(t))try{m.l.Ub();for(var r=this.K[t].slice(0),i=0,n;n=r[i];++i)n.R||n.gb(e)}finally{m.l.end()}},Na:function(){return this.Nb},Uc:function(e){return this.Na()!==e},zc:function(){++this.Nb},Ta:function(e){var t=this,r=m.H(t),i,n,a;t.Ha||(t.Ha=t.notifySubscribers,t.notifySubscribers=d);var o=e(function(){t.Mb=!1;r&&a===t&&(a=t());i=!1;t.tb(n,a)&&t.Ha(n=a)});t.Lb=function(e){t.Mb=i=!0;a=e;o()};t.Kb=function(e){i||(n=e,t.Ha(e,"beforeChange"))}},Pa:function(e){return this.K[e]&&this.K[e].length},Sc:function(e){if(e)return this.K[e]&&this.K[e].length||0;var t=0;m.a.D(this.K,function(e,r){"dirty"!==e&&(t+=r.length)});return t},tb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;e&&m.a.D(e,function(e,r){var i=m.ya[e];"function"==typeof i&&(t=i(t,r)||t)});return t}};m.G(_,"subscribe",_.X);m.G(_,"extend",_.extend);m.G(_,"getSubscriptionsCount",_.Sc);m.a.ka&&m.a.Xa(_,Function.prototype);m.J.fn=_;m.hc=function(e){return null!=e&&"function"==typeof e.X&&"function"==typeof e.notifySubscribers};m.b("subscribable",m.J);m.b("isSubscribable",m.hc);m.va=m.l=function(){function e(e){r.push(i);i=e}function t(){i=r.pop()}var r=[],i,n=0;return{Ub:e,end:t,oc:function(e){if(i){if(!m.hc(e))throw Error("Only subscribable things can act as dependencies");i.gb.call(i.Gc,e,e.Cc||(e.Cc=++n))}},w:function(r,i,n){try{return e(),r.apply(i,n||[])}finally{t()}},Aa:function(){if(i)return i.m.Aa()},Sa:function(){if(i)return i.Sa}}}();m.b("computedContext",m.va);m.b("computedContext.getDependenciesCount",m.va.Aa);m.b("computedContext.isInitial",m.va.Sa);m.b("ignoreDependencies",m.qd=m.l.w);var y=m.a.Yb("_latestValue");m.N=function(e){function t(){if(0<arguments.length)return t.tb(t[y],arguments[0])&&(t.ga(),t[y]=arguments[0],t.fa()),this;m.l.oc(t);return t[y]}t[y]=e;m.a.ka||m.a.extend(t,m.J.fn);m.J.fn.rb(t);m.a.Ya(t,b);m.options.deferUpdates&&m.ya.deferred(t,!0);return t};var b={equalityComparer:l,t:function(){return this[y]},fa:function(){this.notifySubscribers(this[y])},ga:function(){this.notifySubscribers(this[y],"beforeChange")}};m.a.ka&&m.a.Xa(b,m.J.fn);var w=m.N.gd="__ko_proto__";b[w]=m.N;m.Oa=function(t,r){return null===t||t===e||t[w]===e?!1:t[w]===r?!0:m.Oa(t[w],r)};m.H=function(e){return m.Oa(e,m.N)};m.Ba=function(e){return"function"==typeof e&&e[w]===m.N||"function"==typeof e&&e[w]===m.B&&e.Vc?!0:!1};m.b("observable",m.N);m.b("isObservable",m.H);m.b("isWriteableObservable",m.Ba);m.b("isWritableObservable",m.Ba);m.b("observable.fn",b);m.G(b,"peek",b.t);m.G(b,"valueHasMutated",b.fa);m.G(b,"valueWillMutate",b.ga);m.la=function(e){e=e||[];if("object"!=typeof e||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");e=m.N(e);m.a.Ya(e,m.la.fn);return e.extend({trackArrayChanges:!0})};m.la.fn={remove:function(e){for(var t=this.t(),r=[],i="function"!=typeof e||m.H(e)?function(t){return t===e}:e,n=0;n<t.length;n++){var a=t[n];i(a)&&(0===r.length&&this.ga(),r.push(a),t.splice(n,1),n--)}r.length&&this.fa();return r},removeAll:function(t){if(t===e){var r=this.t(),i=r.slice(0);this.ga();r.splice(0,r.length);this.fa();return i}return t?this.remove(function(e){return 0<=m.a.o(t,e)}):[]},destroy:function(e){var t=this.t(),r="function"!=typeof e||m.H(e)?function(t){return t===e}:e;this.ga();for(var i=t.length-1;0<=i;i--)r(t[i])&&(t[i]._destroy=!0);this.fa()},destroyAll:function(t){return t===e?this.destroy(function(){return!0}):t?this.destroy(function(e){return 0<=m.a.o(t,e)}):[]},indexOf:function(e){var t=this();return m.a.o(t,e)},replace:function(e,t){var r=this.indexOf(e);0<=r&&(this.ga(),this.t()[r]=t,this.fa())}};m.a.ka&&m.a.Xa(m.la.fn,m.N.fn);m.a.q("pop push reverse shift sort splice unshift".split(" "),function(e){m.la.fn[e]=function(){var t=this.t();this.ga();this.Vb(t,e,arguments);var r=t[e].apply(t,arguments);this.fa();return r===t?this:r}});m.a.q(["slice"],function(e){m.la.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}});m.b("observableArray",m.la);m.ya.trackArrayChanges=function(e,t){function r(){if(!i){i=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,r){r&&r!==g||++o;return t.apply(this,arguments)};var r=[].concat(e.t()||[]);n=null;a=e.X(function(t){t=[].concat(t||[]);if(e.Pa("arrayChange")){var i;if(!n||1<o)n=m.a.ib(r,t,e.hb);i=n}r=t;n=null;o=0;i&&i.length&&e.notifySubscribers(i,"arrayChange")})}}e.hb={};t&&"object"==typeof t&&m.a.extend(e.hb,t);e.hb.sparse=!0;if(!e.Vb){var i=!1,n=null,a,o=0,s=e.sa,l=e.Ia;e.sa=function(t){s&&s.call(e,t);"arrayChange"===t&&r()};e.Ia=function(t){l&&l.call(e,t);"arrayChange"!==t||e.Pa("arrayChange")||(a.k(),i=!1)};e.Vb=function(e,t,r){function a(e,t,r){return s[s.length]={status:e,value:t,index:r}}if(i&&!o){var s=[],l=e.length,u=r.length,c=0;switch(t){case"push":c=l;case"unshift":for(t=0;t<u;t++)a("added",r[t],c+t);break;case"pop":c=l-1;case"shift":l&&a("deleted",e[c],c);break;case"splice":t=Math.min(Math.max(0,0>r[0]?l+r[0]:r[0]),l);for(var l=1===u?l:Math.min(t+(r[1]||0),l),u=t+u-2,c=Math.max(l,u),d=[],f=[],h=2;t<c;++t,++h)t<l&&f.push(a("deleted",e[t],t)),t<u&&d.push(a("added",r[h],t));m.a.dc(f,d);break;default:return}n=s}}}};var C=m.a.Yb("_state");m.m=m.B=function(t,r,i){function n(){if(0<arguments.length){if("function"===typeof a)a.apply(o.pb,arguments);else throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}m.l.oc(n);(o.S||o.s&&n.Qa())&&n.aa();return o.T}"object"===typeof t?i=t:(i=i||{},t&&(i.read=t));if("function"!=typeof i.read)throw Error("Pass a function that returns the value of the ko.computed");var a=i.write,o={T:e,S:!0,Ra:!1,Fb:!1,R:!1,Va:!1,s:!1,jd:i.read,pb:r||i.owner,i:i.disposeWhenNodeIsRemoved||i.i||null,wa:i.disposeWhen||i.wa,mb:null,r:{},L:0,bc:null};n[C]=o;n.Vc="function"===typeof a;m.a.ka||m.a.extend(n,m.J.fn);m.J.fn.rb(n);m.a.Ya(n,S);i.pure?(o.Va=!0,o.s=!0,m.a.extend(n,T)):i.deferEvaluation&&m.a.extend(n,E);m.options.deferUpdates&&m.ya.deferred(n,!0);o.i&&(o.Fb=!0,o.i.nodeType||(o.i=null));o.s||i.deferEvaluation||n.aa();o.i&&n.ba()&&m.a.F.oa(o.i,o.mb=function(){n.k()});return n};var S={equalityComparer:l,Aa:function(){return this[C].L},Pb:function(e,t,r){if(this[C].Va&&t===this)throw Error("A 'pure' computed must not be called recursively");this[C].r[e]=r;r.Ga=this[C].L++;r.na=t.Na()},Qa:function(){var e,t,r=this[C].r;for(e in r)if(r.hasOwnProperty(e)&&(t=r[e],t.ia.Uc(t.na)))return!0},bd:function(){this.Fa&&!this[C].Ra&&this.Fa()},ba:function(){return this[C].S||0<this[C].L},ld:function(){this.Mb||this.ac()},uc:function(e){if(e.cb&&!this[C].i){var t=e.X(this.bd,this,"dirty"),r=e.X(this.ld,this);return{ia:e,k:function(){t.k();r.k()}}}return e.X(this.ac,this)},ac:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[C].bc),this[C].bc=m.a.setTimeout(function(){e.aa(!0)},t)):e.Fa?e.Fa():e.aa(!0)},aa:function(e){var t=this[C],r=t.wa;if(!t.Ra&&!t.R){if(t.i&&!m.a.nb(t.i)||r&&r()){if(!t.Fb){this.k();return}}else t.Fb=!1;t.Ra=!0;try{this.Qc(e)}finally{t.Ra=!1}t.L||this.k()}},Qc:function(t){var r=this[C],i=r.Va?e:!r.L,n={Hc:this,Ma:r.r,lb:r.L};m.l.Ub({Gc:n,gb:h,m:this,Sa:i});r.r={};r.L=0;n=this.Pc(r,n);this.tb(r.T,n)&&(r.s||this.notifySubscribers(r.T,"beforeChange"),r.T=n,r.s?this.zc():t&&this.notifySubscribers(r.T));i&&this.notifySubscribers(r.T,"awake")},Pc:function(e,t){try{var r=e.jd;return e.pb?r.call(e.pb):r()}finally{m.l.end(),t.lb&&!e.s&&m.a.D(t.Ma,f),e.S=!1}},t:function(){var e=this[C];(e.S&&!e.L||e.s&&this.Qa())&&this.aa();return e.T},Ta:function(e){m.J.fn.Ta.call(this,e);this.Fa=function(){this.Kb(this[C].T);this[C].S=!0;this.Lb(this)}},k:function(){var e=this[C];!e.s&&e.r&&m.a.D(e.r,function(e,t){t.k&&t.k()});e.i&&e.mb&&m.a.F.pc(e.i,e.mb);e.r=null;e.L=0;e.R=!0;e.S=!1;e.s=!1;e.i=null}},T={sa:function(e){var t=this,r=t[C];if(!r.R&&r.s&&"change"==e){r.s=!1;if(r.S||t.Qa())r.r=null,r.L=0,r.S=!0,t.aa();else{var i=[];m.a.D(r.r,function(e,t){i[t.Ga]=e});m.a.q(i,function(e,i){var n=r.r[e],a=t.uc(n.ia);a.Ga=i;a.na=n.na;r.r[e]=a})}r.R||t.notifySubscribers(r.T,"awake")}},Ia:function(t){var r=this[C];r.R||"change"!=t||this.Pa("change")||(m.a.D(r.r,function(e,t){t.k&&(r.r[e]={ia:t.ia,Ga:t.Ga,na:t.na},t.k())}),r.s=!0,this.notifySubscribers(e,"asleep"))},Na:function(){var e=this[C];e.s&&(e.S||this.Qa())&&this.aa();return m.J.fn.Na.call(this)}},E={sa:function(e){"change"!=e&&"beforeChange"!=e||this.t()}};m.a.ka&&m.a.Xa(S,m.J.fn);var x=m.N.gd;m.m[x]=m.N;S[x]=m.m;m.Xc=function(e){return m.Oa(e,m.m)};m.Yc=function(e){return m.Oa(e,m.m)&&e[C]&&e[C].Va};m.b("computed",m.m);m.b("dependentObservable",m.m);m.b("isComputed",m.Xc);m.b("isPureComputed",m.Yc);m.b("computed.fn",S);m.G(S,"peek",S.t);m.G(S,"dispose",S.k);m.G(S,"isActive",S.ba);m.G(S,"getDependenciesCount",S.Aa);m.nc=function(e,t){if("function"===typeof e)return m.m(e,t,{pure:!0});e=m.a.extend({},e);e.pure=!0;return m.m(e,t)};m.b("pureComputed",m.nc);(function(){function t(n,a,o){o=o||new i;n=a(n);if("object"!=typeof n||null===n||n===e||n instanceof RegExp||n instanceof Date||n instanceof String||n instanceof Number||n instanceof Boolean)return n;var s=n instanceof Array?[]:{};o.save(n,s);r(n,function(r){var i=a(n[r]);switch(typeof i){case"boolean":case"number":case"string":case"function":s[r]=i;break;case"object":case"undefined":var l=o.get(i);s[r]=l!==e?l:t(i,a,o)}});return s}function r(e,t){if(e instanceof Array){for(var r=0;r<e.length;r++)t(r);"function"==typeof e.toJSON&&t("toJSON")}else for(r in e)t(r)}function i(){this.keys=[];this.Ib=[]}m.wc=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return t(e,function(e){for(var t=0;m.H(e)&&10>t;t++)e=e();return e})};m.toJSON=function(e,t,r){e=m.wc(e);return m.a.Eb(e,t,r)};i.prototype={save:function(e,t){var r=m.a.o(this.keys,e);0<=r?this.Ib[r]=t:(this.keys.push(e),this.Ib.push(t))},get:function(t){t=m.a.o(this.keys,t);return 0<=t?this.Ib[t]:e}}})();m.b("toJS",m.wc);m.b("toJSON",m.toJSON);(function(){m.j={u:function(t){switch(m.a.A(t)){case"option":return!0===t.__ko__hasDomDataOptionValue__?m.a.e.get(t,m.d.options.xb):7>=m.a.C?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return 0<=t.selectedIndex?m.j.u(t.options[t.selectedIndex]):e;default:return t.value}},ha:function(t,r,i){switch(m.a.A(t)){case"option":switch(typeof r){case"string":m.a.e.set(t,m.d.options.xb,e);"__ko__hasDomDataOptionValue__"in t&&delete t.__ko__hasDomDataOptionValue__;t.value=r;break;default:m.a.e.set(t,m.d.options.xb,r),t.__ko__hasDomDataOptionValue__=!0,t.value="number"===typeof r?r:""}break;case"select":if(""===r||null===r)r=e;for(var n=-1,a=0,o=t.options.length,s;a<o;++a)if(s=m.j.u(t.options[a]),s==r||""==s&&r===e){n=a;break}if(i||0<=n||r===e&&1<t.size)t.selectedIndex=n;break;default:if(null===r||r===e)r="";t.value=r}}}})();m.b("selectExtensions",m.j);m.b("selectExtensions.readValue",m.j.u);m.b("selectExtensions.writeValue",m.j.ha);m.h=function(){function e(e){e=m.a.$a(e);123===e.charCodeAt(0)&&(e=e.slice(1,-1));var t=[],r=e.match(i),o,s=[],l=0;if(r){r.push(",");for(var u=0,c;c=r[u];++u){var d=c.charCodeAt(0);if(44===d){if(0>=l){t.push(o&&s.length?{key:o,value:s.join("")}:{unknown:o||s.join("")});o=l=0;s=[];continue}}else if(58===d){if(!l&&!o&&1===s.length){o=s.pop();continue}}else 47===d&&u&&1<c.length?(d=r[u-1].match(n))&&!a[d[0]]&&(e=e.substr(e.indexOf(c)+1),r=e.match(i),r.push(","),u=-1,c="/"):40===d||123===d||91===d?++l:41===d||125===d||93===d?--l:o||s.length||34!==d&&39!==d||(c=c.slice(1,-1));s.push(c)}}return t}var t=["true","false","null","undefined"],r=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),n=/[\])"'A-Za-z0-9_$]+$/,a={in:1,return:1,typeof:1},o={};return{ta:[],ea:o,yb:e,Ua:function(i,n){function a(e,i){var n;if(!c){var d=m.getBindingHandler(e);if(d&&d.preprocess&&!(i=d.preprocess(i,e,a)))return;if(d=o[e])n=i,0<=m.a.o(t,n)?n=!1:(d=n.match(r),n=null===d?!1:d[1]?"Object("+d[1]+")"+d[2]:n),d=n;d&&l.push("'"+e+"':function(_z){"+n+"=_z}")}u&&(i="function(){return "+i+" }");s.push("'"+e+"':"+i)}n=n||{};var s=[],l=[],u=n.valueAccessors,c=n.bindingParams,d="string"===typeof i?e(i):i;m.a.q(d,function(e){a(e.key||e.unknown,e.value)});l.length&&a("_ko_property_writers","{"+l.join(",")+" }");return s.join(",")},ad:function(e,t){for(var r=0;r<e.length;r++)if(e[r].key==t)return!0;return!1},Ea:function(e,t,r,i,n){if(e&&m.H(e))!m.Ba(e)||n&&e.t()===i||e(i);else if((e=t.get("_ko_property_writers"))&&e[r])e[r](i)}}}();m.b("expressionRewriting",m.h);m.b("expressionRewriting.bindingRewriteValidators",m.h.ta);m.b("expressionRewriting.parseObjectLiteral",m.h.yb);m.b("expressionRewriting.preProcessBindings",m.h.Ua);m.b("expressionRewriting._twoWayBindings",m.h.ea);m.b("jsonExpressionRewriting",m.h);m.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",m.h.Ua);(function(){function e(e){return 8==e.nodeType&&o.test(a?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&s.test(a?e.text:e.nodeValue)}function i(r,i){for(var n=r,a=1,o=[];n=n.nextSibling;){if(t(n)&&(a--,0===a))return o;o.push(n);e(n)&&a++}if(!i)throw Error("Cannot find closing comment tag to match: "+r.nodeValue);return null}function n(e,t){var r=i(e,t);return r?0<r.length?r[r.length-1].nextSibling:e.nextSibling:null}var a=r&&"\x3c!--test--\x3e"===r.createComment("test").text,o=a?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=a?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0};m.f={Z:{},childNodes:function(t){return e(t)?i(t):t.childNodes},xa:function(t){if(e(t)){t=m.f.childNodes(t);for(var r=0,i=t.length;r<i;r++)m.removeNode(t[r])}else m.a.ob(t)},da:function(t,r){if(e(t)){m.f.xa(t);for(var i=t.nextSibling,n=0,a=r.length;n<a;n++)i.parentNode.insertBefore(r[n],i)}else m.a.da(t,r)},mc:function(t,r){e(t)?t.parentNode.insertBefore(r,t.nextSibling):t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)},gc:function(t,r,i){i?e(t)?t.parentNode.insertBefore(r,i.nextSibling):i.nextSibling?t.insertBefore(r,i.nextSibling):t.appendChild(r):m.f.mc(t,r)},firstChild:function(r){return e(r)?!r.nextSibling||t(r.nextSibling)?null:r.nextSibling:r.firstChild},nextSibling:function(r){e(r)&&(r=n(r));return r.nextSibling&&t(r.nextSibling)?null:r.nextSibling},Tc:e,pd:function(e){return(e=(a?e.text:e.nodeValue).match(o))?e[1]:null},kc:function(r){if(l[m.a.A(r)]){var i=r.firstChild;if(i){do{if(1===i.nodeType){var a;a=i.firstChild;var o=null;if(a){do{if(o)o.push(a);else if(e(a)){var s=n(a,!0);s?a=s:o=[a]}else t(a)&&(o=[a])}while(a=a.nextSibling)}if(a=o)for(o=i.nextSibling,s=0;s<a.length;s++)o?r.insertBefore(a[s],o):r.appendChild(a[s])}}while(i=i.nextSibling)}}}}})();m.b("virtualElements",m.f);m.b("virtualElements.allowedBindings",m.f.Z);m.b("virtualElements.emptyNode",m.f.xa);m.b("virtualElements.insertAfter",m.f.gc);m.b("virtualElements.prepend",m.f.mc);m.b("virtualElements.setDomNodeChildren",m.f.da);(function(){m.Q=function(){this.Fc={}};m.a.extend(m.Q.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||m.g.getComponentNameForNode(e);case 8:return m.f.Tc(e);default:return!1}},getBindings:function(e,t){var r=this.getBindingsString(e,t),r=r?this.parseBindingsString(r,t,e):null;return m.g.Ob(r,e,t,!1)},getBindingAccessors:function(e,t){var r=this.getBindingsString(e,t),r=r?this.parseBindingsString(r,t,e,{valueAccessors:!0}):null;return m.g.Ob(r,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return m.f.pd(e);default:return null}},parseBindingsString:function(e,t,r,i){try{var n=this.Fc,a=e+(i&&i.valueAccessors||""),o;if(!(o=n[a])){var s,l="with($context){with($data||{}){return{"+m.h.Ua(e,i)+"}}}";s=new Function("$context","$element",l);o=n[a]=s}return o(t,r)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}});m.Q.instance=new m.Q})();m.b("bindingProvider",m.Q);(function(){function r(e){return function(){return e}}function i(e){return e()}function a(e){return m.a.Ca(m.l.w(e),function(t,r){return function(){return e()[r]}})}function o(e,t,i){return"function"===typeof e?a(e.bind(null,t,i)):m.a.Ca(e,r)}function s(e,t){return a(this.getBindings.bind(this,e,t))}function l(e,t,r){var i,n=m.f.firstChild(t),a=m.Q.instance,o=a.preprocessNode;if(o){for(;i=n;)n=m.f.nextSibling(i),o.call(a,i);n=m.f.firstChild(t)}for(;i=n;)n=m.f.nextSibling(i),u(e,i,r)}function u(e,t,r){var i=!0,n=1===t.nodeType;n&&m.f.kc(t);if(n&&r||m.Q.instance.nodeHasBindings(t))i=d(t,null,e,r).shouldBindDescendants;i&&!h[m.a.A(t)]&&l(e,t,!n)}function c(e){var t=[],r={},i=[];m.a.D(e,function n(a){if(!r[a]){var o=m.getBindingHandler(a);o&&(o.after&&(i.push(a),m.a.q(o.after,function(t){if(e[t]){if(-1!==m.a.o(i,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));n(t)}}),i.length--),t.push({key:a,fc:o}));r[a]=!0}});return t}function d(t,r,n,a){var o=m.a.e.get(t,p);if(!r){if(o)throw Error("You cannot apply bindings multiple times to the same element.");m.a.e.set(t,p,!0)}!o&&a&&m.tc(t,n);var l;if(r&&"function"!==typeof r)l=r;else{var u=m.Q.instance,d=u.getBindingAccessors||s,f=m.B(function(){(l=r?r(n,t):d.call(u,t,n))&&n.P&&n.P();return l},null,{i:t});l&&f.ba()||(f=null)}var h;if(l){var v=f?function(e){return function(){return i(f()[e])}}:function(e){return l[e]},g=function(){return m.a.Ca(f?f():l,i)};g.get=function(e){return l[e]&&i(v(e))};g.has=function(e){return e in l};a=c(l);m.a.q(a,function(r){var i=r.fc.init,a=r.fc.update,o=r.key;if(8===t.nodeType&&!m.f.Z[o])throw Error("The binding '"+o+"' cannot be used with virtual elements");try{"function"==typeof i&&m.l.w(function(){var r=i(t,v(o),g,n.$data,n);if(r&&r.controlsDescendantBindings){if(h!==e)throw Error("Multiple bindings ("+h+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");h=o}}),"function"==typeof a&&m.B(function(){a(t,v(o),g,n.$data,n)},null,{i:t})}catch(e){throw e.message='Unable to process binding "'+o+": "+l[o]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:h===e}}function f(e){return e&&e instanceof m.U?e:new m.U(e)}m.d={};var h={script:!0,textarea:!0,template:!0};m.getBindingHandler=function(e){return m.d[e]};m.U=function(t,r,i,n){var a=this,o="function"==typeof t&&!m.H(t),s,l=m.B(function(){var e=o?t():t,s=m.a.c(e);r?(r.P&&r.P(),m.a.extend(a,r),l&&(a.P=l)):(a.$parents=[],a.$root=s,a.ko=m);a.$rawData=e;a.$data=s;i&&(a[i]=s);n&&n(a,r,s);return a.$data},null,{wa:function(){return s&&!m.a.Qb(s)},i:!0});l.ba()&&(a.P=l,l.equalityComparer=null,s=[],l.Ac=function(t){s.push(t);m.a.F.oa(t,function(t){m.a.La(s,t);s.length||(l.k(),a.P=l=e)})})};m.U.prototype.createChildContext=function(e,t,r){return new m.U(e,this,t,function(e,t){e.$parentContext=t;e.$parent=t.$data;e.$parents=(t.$parents||[]).slice(0);e.$parents.unshift(e.$parent);r&&r(e)})};m.U.prototype.extend=function(e){return new m.U(this.P||this.$data,this,null,function(t,r){t.$rawData=r.$rawData;m.a.extend(t,"function"==typeof e?e():e)})};var p=m.a.e.I(),v=m.a.e.I();m.tc=function(e,t){if(2==arguments.length)m.a.e.set(e,v,t),t.P&&t.P.Ac(e);else return m.a.e.get(e,v)};m.Ja=function(e,t,r){1===e.nodeType&&m.f.kc(e);return d(e,t,f(r),!0)};m.Dc=function(e,t,r){r=f(r);return m.Ja(e,o(t,r,e),r)};m.eb=function(e,t){1!==t.nodeType&&8!==t.nodeType||l(f(e),t,!0)};m.Rb=function(e,r){!n&&t.jQuery&&(n=t.jQuery);if(r&&1!==r.nodeType&&8!==r.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");r=r||t.document.body;u(f(e),r,!0)};m.kb=function(t){switch(t.nodeType){case 1:case 8:var r=m.tc(t);if(r)return r;if(t.parentNode)return m.kb(t.parentNode)}return e};m.Jc=function(t){return(t=m.kb(t))?t.$data:e};m.b("bindingHandlers",m.d);m.b("applyBindings",m.Rb);m.b("applyBindingsToDescendants",m.eb);m.b("applyBindingAccessorsToNode",m.Ja);m.b("applyBindingsToNode",m.Dc);m.b("contextFor",m.kb);m.b("dataFor",m.Jc)})();(function(e){function t(t,i){var o=n.hasOwnProperty(t)?n[t]:e,s;o?o.X(i):(o=n[t]=new m.J,o.X(i),r(t,function(e,r){var i=!(!r||!r.synchronous);a[t]={definition:e,Zc:i};delete n[t];s||i?o.notifySubscribers(e):m.Y.Wa(function(){o.notifySubscribers(e)})}),s=!0)}function r(e,t){i("getConfig",[e],function(r){r?i("loadComponent",[e,r],function(e){t(e,r)}):t(null,null)})}function i(t,r,n,a){a||(a=m.g.loaders.slice(0));var o=a.shift();if(o){var s=o[t];if(s){var l=!1;if(s.apply(o,r.concat(function(e){l?n(null):null!==e?n(e):i(t,r,n,a)}))!==e&&(l=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else i(t,r,n,a)}else n(null)}var n={},a={};m.g={get:function(r,i){var n=a.hasOwnProperty(r)?a[r]:e;n?n.Zc?m.l.w(function(){i(n.definition)}):m.Y.Wa(function(){i(n.definition)}):t(r,i)},Xb:function(e){delete a[e]},Jb:i};m.g.loaders=[];m.b("components",m.g);m.b("components.get",m.g.get);m.b("components.clearCachedDefinition",m.g.Xb)})();(function(){function e(e,t,r,i){function n(){0===--s&&i(a)}var a={},s=2,l=r.template;r=r.viewModel;l?o(t,l,function(t){m.g.Jb("loadTemplate",[e,t],function(e){a.template=e;n()})}):n();r?o(t,r,function(t){m.g.Jb("loadViewModel",[e,t],function(e){a[c]=e;n()})}):n()}function i(e,t,r){if("function"===typeof t)r(function(e){return new t(e)});else if("function"===typeof t[c])r(t[c]);else if("instance"in t){var n=t.instance;r(function(){return n})}else"viewModel"in t?i(e,t.viewModel,r):e("Unknown viewModel value: "+t)}function n(e){switch(m.a.A(e)){case"script":return m.a.ma(e.text);case"textarea":return m.a.ma(e.value);case"template":if(a(e.content))return m.a.ua(e.content.childNodes)}return m.a.ua(e.childNodes)}function a(e){return t.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function o(e,r,i){"string"===typeof r.require?s||t.require?(s||t.require)([r.require],i):e("Uses require, but no AMD loader is present"):i(r)}function l(e){return function(t){throw Error("Component '"+e+"': "+t)}}var u={};m.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(m.g.ub(e))throw Error("Component "+e+" is already registered");u[e]=t};m.g.ub=function(e){return u.hasOwnProperty(e)};m.g.od=function(e){delete u[e];m.g.Xb(e)};m.g.Zb={getConfig:function(e,t){t(u.hasOwnProperty(e)?u[e]:null)},loadComponent:function(t,r,i){var n=l(t);o(n,r,function(r){e(t,n,r,i)})},loadTemplate:function(e,i,o){e=l(e);if("string"===typeof i)o(m.a.ma(i));else if(i instanceof Array)o(i);else if(a(i))o(m.a.V(i.childNodes));else if(i.element)if(i=i.element,t.HTMLElement?i instanceof HTMLElement:i&&i.tagName&&1===i.nodeType)o(n(i));else if("string"===typeof i){var s=r.getElementById(i);s?o(n(s)):e("Cannot find element with ID "+i)}else e("Unknown element type: "+i);else e("Unknown template value: "+i)},loadViewModel:function(e,t,r){i(l(e),t,r)}};var c="createViewModel";m.b("components.register",m.g.register);m.b("components.isRegistered",m.g.ub);m.b("components.unregister",m.g.od);m.b("components.defaultLoader",m.g.Zb);m.g.loaders.push(m.g.Zb);m.g.Bc=u})();(function(){function e(e,r){var i=e.getAttribute("params");if(i){var i=t.parseBindingsString(i,r,e,{valueAccessors:!0,bindingParams:!0}),i=m.a.Ca(i,function(t){return m.m(t,null,{i:e})}),n=m.a.Ca(i,function(t){var r=t.t();return t.ba()?m.m({read:function(){return m.a.c(t())},write:m.Ba(r)&&function(e){t()(e)},i:e}):r});n.hasOwnProperty("$raw")||(n.$raw=i);return n}return{$raw:{}}}m.g.getComponentNameForNode=function(e){var t=m.a.A(e);if(m.g.ub(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=m.a.C&&e.tagName===t))return t};m.g.Ob=function(t,r,i,n){if(1===r.nodeType){var a=m.g.getComponentNameForNode(r);if(a){t=t||{};if(t.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:a,params:e(r,i)};t.component=n?function(){return o}:o}}return t};var t=new m.Q;9>m.a.C&&(m.g.register=function(e){return function(t){r.createElement(t);return e.apply(this,arguments)}}(m.g.register),r.createDocumentFragment=function(e){return function(){var t=e(),r=m.g.Bc,i;for(i in r)r.hasOwnProperty(i)&&t.createElement(i);return t}}(r.createDocumentFragment))})();(function(e){function t(e,t,r){t=t.template;if(!t)throw Error("Component '"+e+"' has no template");e=m.a.ua(t);m.f.da(r,e)}function r(e,t,r,i){var n=e.createViewModel;return n?n.call(e,i,{element:t,templateNodes:r}):i}var i=0;m.d.component={init:function(n,a,o,s,l){function u(){var e=c&&c.dispose;"function"===typeof e&&e.call(c);d=c=null}var c,d,f=m.a.V(m.f.childNodes(n));m.a.F.oa(n,u);m.m(function(){var o=m.a.c(a()),s,h;"string"===typeof o?s=o:(s=m.a.c(o.name),h=m.a.c(o.params));if(!s)throw Error("No component name specified");var p=d=++i;m.g.get(s,function(i){if(d===p){u();if(!i)throw Error("Unknown component '"+s+"'");t(s,i,n);var a=r(i,n,f,h);i=l.createChildContext(a,e,function(e){e.$component=a;e.$componentTemplateNodes=f});c=a;m.eb(i,n)}})},null,{i:n});return{controlsDescendantBindings:!0}}};m.f.Z.component=!0})();var P={class:"className",for:"htmlFor"};m.d.attr={update:function(t,r){var i=m.a.c(r())||{};m.a.D(i,function(r,i){i=m.a.c(i);var n=!1===i||null===i||i===e;n&&t.removeAttribute(r);8>=m.a.C&&r in P?(r=P[r],n?t.removeAttribute(r):t[r]=i):n||t.setAttribute(r,i.toString());"name"===r&&m.a.rc(t,n?"":i.toString())})}};(function(){m.d.checked={after:["value","attr"],init:function(t,r,i){function n(){var e=t.checked,n=h?o():e;if(!m.va.Sa()&&(!l||e)){var a=m.l.w(r);if(c){var s=d?a.t():a;f!==n?(e&&(m.a.pa(s,n,!0),m.a.pa(s,f,!1)),f=n):m.a.pa(s,n,e);d&&m.Ba(a)&&a(s)}else m.h.Ea(a,i,"checked",n,!0)}}function a(){var e=m.a.c(r());t.checked=c?0<=m.a.o(e,o()):s?e:o()===e}var o=m.nc(function(){return i.has("checkedValue")?m.a.c(i.get("checkedValue")):i.has("value")?m.a.c(i.get("value")):t.value}),s="checkbox"==t.type,l="radio"==t.type;if(s||l){var u=r(),c=s&&m.a.c(u)instanceof Array,d=!(c&&u.push&&u.splice),f=c?o():e,h=l||c;l&&!t.name&&m.d.uniqueName.init(t,function(){return!0});m.m(n,null,{i:t});m.a.p(t,"click",n);m.m(a,null,{i:t});u=e}}};m.h.ea.checked=!0;m.d.checkedValue={update:function(e,t){e.value=m.a.c(t())}}})();m.d.css={update:function(e,t){var r=m.a.c(t());null!==r&&"object"==typeof r?m.a.D(r,function(t,r){r=m.a.c(r);m.a.bb(e,t,r)}):(r=m.a.$a(String(r||"")),m.a.bb(e,e.__ko__cssValue,!1),e.__ko__cssValue=r,m.a.bb(e,r,!0))}};m.d.enable={update:function(e,t){var r=m.a.c(t());r&&e.disabled?e.removeAttribute("disabled"):r||e.disabled||(e.disabled=!0)}};m.d.disable={update:function(e,t){m.d.enable.update(e,function(){return!m.a.c(t())})}};m.d.event={init:function(e,t,r,i,n){var a=t()||{};m.a.D(a,function(a){"string"==typeof a&&m.a.p(e,a,function(e){var o,s=t()[a];if(s){try{var l=m.a.V(arguments);i=n.$data;l.unshift(i);o=s.apply(i,l)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===r.get(a+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}};m.d.foreach={ic:function(e){return function(){var t=e(),r=m.a.zb(t);if(!r||"number"==typeof r.length)return{foreach:t,templateEngine:m.W.sb};m.a.c(t);return{foreach:r.data,as:r.as,includeDestroyed:r.includeDestroyed,afterAdd:r.afterAdd,beforeRemove:r.beforeRemove,afterRender:r.afterRender,beforeMove:r.beforeMove,afterMove:r.afterMove,templateEngine:m.W.sb}}},init:function(e,t){return m.d.template.init(e,m.d.foreach.ic(t))},update:function(e,t,r,i,n){return m.d.template.update(e,m.d.foreach.ic(t),r,i,n)}};m.h.ta.foreach=!1;m.f.Z.foreach=!0;m.d.hasfocus={init:function(e,t,r){function i(i){e.__ko_hasfocusUpdating=!0;var n=e.ownerDocument;if("activeElement"in n){var a;try{a=n.activeElement}catch(e){a=n.body}i=a===e}n=t();m.h.Ea(n,r,"hasfocus",i,!0);e.__ko_hasfocusLastValue=i;e.__ko_hasfocusUpdating=!1}var n=i.bind(null,!0),a=i.bind(null,!1);m.a.p(e,"focus",n);m.a.p(e,"focusin",n);m.a.p(e,"blur",a);m.a.p(e,"focusout",a)},update:function(e,t){var r=!!m.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===r||(r?e.focus():e.blur(),!r&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),m.l.w(m.a.Da,null,[e,r?"focusin":"focusout"]))}};m.h.ea.hasfocus=!0;m.d.hasFocus=m.d.hasfocus;m.h.ea.hasFocus=!0;m.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.a.Cb(e,t())}};p("if");p("ifnot",!1,!0);p("with",!0,!1,function(e,t){return e.createChildContext(t)});var A={};m.d.options={init:function(e){if("select"!==m.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(t,r,i){function n(){return m.a.Ka(t.options,function(e){return e.selected})}function a(e,t,r){var i=typeof t;return"function"==i?t(e):"string"==i?e[t]:r}function o(e,r){if(p&&c)m.j.ha(t,m.a.c(i.get("value")),!0);else if(h.length){var n=0<=m.a.o(h,m.j.u(r[0]));m.a.sc(r[0],n);p&&!n&&m.l.w(m.a.Da,null,[t,"change"])}}var s=t.multiple,l=0!=t.length&&s?t.scrollTop:null,u=m.a.c(r()),c=i.get("valueAllowUnset")&&i.has("value"),d=i.get("optionsIncludeDestroyed");r={};var f,h=[];c||(s?h=m.a.fb(n(),m.j.u):0<=t.selectedIndex&&h.push(m.j.u(t.options[t.selectedIndex])));u&&("undefined"==typeof u.length&&(u=[u]),f=m.a.Ka(u,function(t){return d||t===e||null===t||!m.a.c(t._destroy)}),i.has("optionsCaption")&&(u=m.a.c(i.get("optionsCaption")),null!==u&&u!==e&&f.unshift(A)));var p=!1;r.beforeRemove=function(e){t.removeChild(e)};u=o;i.has("optionsAfterRender")&&"function"==typeof i.get("optionsAfterRender")&&(u=function(t,r){o(0,r);m.l.w(i.get("optionsAfterRender"),null,[r[0],t!==A?t:e])});m.a.Bb(t,f,function(r,n,o){o.length&&(h=!c&&o[0].selected?[m.j.u(o[0])]:[],p=!0);n=t.ownerDocument.createElement("option");r===A?(m.a.Za(n,i.get("optionsCaption")),m.j.ha(n,e)):(o=a(r,i.get("optionsValue"),r),m.j.ha(n,m.a.c(o)),r=a(r,i.get("optionsText"),o),m.a.Za(n,r));return[n]},r,u);m.l.w(function(){c?m.j.ha(t,m.a.c(i.get("value")),!0):(s?h.length&&n().length<h.length:h.length&&0<=t.selectedIndex?m.j.u(t.options[t.selectedIndex])!==h[0]:h.length||0<=t.selectedIndex)&&m.a.Da(t,"change")});m.a.Nc(t);l&&20<Math.abs(l-t.scrollTop)&&(t.scrollTop=l)}};m.d.options.xb=m.a.e.I();m.d.selectedOptions={after:["options","foreach"],init:function(e,t,r){m.a.p(e,"change",function(){var i=t(),n=[];m.a.q(e.getElementsByTagName("option"),function(e){e.selected&&n.push(m.j.u(e))});m.h.Ea(i,r,"selectedOptions",n)})},update:function(e,t){if("select"!=m.a.A(e))throw Error("values binding applies only to SELECT elements");var r=m.a.c(t()),i=e.scrollTop;r&&"number"==typeof r.length&&m.a.q(e.getElementsByTagName("option"),function(e){var t=0<=m.a.o(r,m.j.u(e));e.selected!=t&&m.a.sc(e,t)});e.scrollTop=i}};m.h.ea.selectedOptions=!0;m.d.style={update:function(t,r){var i=m.a.c(r()||{});m.a.D(i,function(r,i){i=m.a.c(i);if(null===i||i===e||!1===i)i="";t.style[r]=i})}};m.d.submit={init:function(e,t,r,i,n){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");m.a.p(e,"submit",function(r){var i,a=t();try{i=a.call(n.$data,e)}finally{!0!==i&&(r.preventDefault?r.preventDefault():r.returnValue=!1)}})}};m.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.a.Za(e,t())}};m.f.Z.text=!0;(function(){if(t&&t.navigator)var r=function(e){if(e)return parseFloat(e[1])},i=t.opera&&t.opera.version&&parseInt(t.opera.version()),n=t.navigator.userAgent,a=r(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),o=r(n.match(/Firefox\/([^ ]*)/));if(10>m.a.C)var s=m.a.e.I(),l=m.a.e.I(),u=function(e){var t=this.activeElement;(t=t&&m.a.e.get(t,l))&&t(e)},c=function(e,t){var r=e.ownerDocument;m.a.e.get(r,s)||(m.a.e.set(r,s,!0),m.a.p(r,"selectionchange",u));m.a.e.set(e,l,t)};m.d.textInput={init:function(t,r,n){function s(e,r){m.a.p(t,e,r)}function l(){var i=m.a.c(r());if(null===i||i===e)i="";p!==e&&i===p?m.a.setTimeout(l,4):t.value!==i&&(f=i,t.value=i)}function u(){h||(p=t.value,h=m.a.setTimeout(d,4))}function d(){clearTimeout(h);p=h=e;var i=t.value;f!==i&&(f=i,m.h.Ea(r(),n,"textInput",i))}var f=t.value,h,p,v=9==m.a.C?u:d;10>m.a.C?(s("propertychange",function(e){"value"===e.propertyName&&v(e)}),8==m.a.C&&(s("keyup",d),s("keydown",d)),8<=m.a.C&&(c(t,v),s("dragend",u))):(s("input",d),5>a&&"textarea"===m.a.A(t)?(s("keydown",u),s("paste",u),s("cut",u)):11>i?s("keydown",u):4>o&&(s("DOMAutoComplete",d),s("dragdrop",d),s("drop",d)));s("change",d);m.m(l,null,{i:t})}};m.h.ea.textInput=!0;m.d.textinput={preprocess:function(e,t,r){r("textInput",e)}}})();m.d.uniqueName={init:function(e,t){if(t()){var r="ko_unique_"+ ++m.d.uniqueName.Ic;m.a.rc(e,r)}}};m.d.uniqueName.Ic=0;m.d.value={after:["options","foreach"],init:function(e,t,r){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var i=["change"],n=r.get("valueUpdate"),a=!1,o=null;n&&("string"==typeof n&&(n=[n]),m.a.ra(i,n),i=m.a.Tb(i));var s=function(){o=null;a=!1;var i=t(),n=m.j.u(e);m.h.Ea(i,r,"value",n)};!m.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=m.a.o(i,"propertychange")||(m.a.p(e,"propertychange",function(){a=!0}),m.a.p(e,"focus",function(){a=!1}),m.a.p(e,"blur",function(){a&&s()}));m.a.q(i,function(t){var r=s;m.a.nd(t,"after")&&(r=function(){o=m.j.u(e);m.a.setTimeout(s,0)},t=t.substring(5));m.a.p(e,t,r)});var l=function(){var i=m.a.c(t()),n=m.j.u(e);if(null!==o&&i===o)m.a.setTimeout(l,0);else if(i!==n)if("select"===m.a.A(e)){var a=r.get("valueAllowUnset"),n=function(){m.j.ha(e,i,a)};n();a||i===m.j.u(e)?m.a.setTimeout(n,0):m.l.w(m.a.Da,null,[e,"change"])}else m.j.ha(e,i)};m.m(l,null,{i:e})}else m.Ja(e,{checkedValue:t})},update:function(){}};m.h.ea.value=!0;m.d.visible={update:function(e,t){var r=m.a.c(t()),i="none"!=e.style.display;r&&!i?e.style.display="":!r&&i&&(e.style.display="none")}};(function(e){m.d[e]={init:function(t,r,i,n,a){return m.d.event.init.call(this,t,function(){var t={};t[e]=r();return t},i,n,a)}}})("click");m.O=function(){};m.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")};m.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")};m.O.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){t=t||r;var i=t.getElementById(e);if(!i)throw Error("Cannot find template with ID "+e);return new m.v.n(i)}if(1==e.nodeType||8==e.nodeType)return new m.v.qa(e);throw Error("Unknown template type: "+e)};m.O.prototype.renderTemplate=function(e,t,r,i){e=this.makeTemplateSource(e,i);return this.renderTemplateSource(e,t,r,i)};m.O.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(e,t).data("isRewritten")};m.O.prototype.rewriteTemplate=function(e,t,r){e=this.makeTemplateSource(e,r);t=t(e.text());e.text(t);e.data("isRewritten",!0)};m.b("templateEngine",m.O);m.Gb=function(){function e(e,t,r,i){e=m.h.yb(e);for(var n=m.h.ta,a=0;a<e.length;a++){var o=e[a].key;if(n.hasOwnProperty(o)){var s=n[o];if("function"===typeof s){if(o=s(e[a].value))throw Error(o)}else if(!s)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}r="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+m.h.Ua(e,{valueAccessors:!0})+" } })()},'"+r.toLowerCase()+"')";return i.createJavaScriptEvaluatorBlock(r)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,r=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Oc:function(e,t,r){t.isTemplateRewritten(e,r)||t.rewriteTemplate(e,function(e){return m.Gb.dd(e,t)},r)},dd:function(i,n){return i.replace(t,function(t,r,i,a,o){return e(o,r,i,n)}).replace(r,function(t,r){return e(r,"\x3c!-- ko --\x3e","#comment",n)})},Ec:function(e,t){return m.M.wb(function(r,i){var n=r.nextSibling;n&&n.nodeName.toLowerCase()===t&&m.Ja(n,e,i)})}}}();m.b("__tr_ambtns",m.Gb.Ec);(function(){m.v={};m.v.n=function(e){if(this.n=e){var t=m.a.A(e);this.ab="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}};m.v.n.prototype.text=function(){var e=1===this.ab?"text":2===this.ab?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?m.a.Cb(this.n,t):this.n[e]=t};var t=m.a.e.I()+"_";m.v.n.prototype.data=function(e){if(1===arguments.length)return m.a.e.get(this.n,t+e);m.a.e.set(this.n,t+e,arguments[1])};var r=m.a.e.I();m.v.n.prototype.nodes=function(){var t=this.n;if(0==arguments.length)return(m.a.e.get(t,r)||{}).jb||(3===this.ab?t.content:4===this.ab?t:e);m.a.e.set(t,r,{jb:arguments[0]})};m.v.qa=function(e){this.n=e};m.v.qa.prototype=new m.v.n;m.v.qa.prototype.text=function(){if(0==arguments.length){var t=m.a.e.get(this.n,r)||{};t.Hb===e&&t.jb&&(t.Hb=t.jb.innerHTML);return t.Hb}m.a.e.set(this.n,r,{Hb:arguments[0]})};m.b("templateSources",m.v);m.b("templateSources.domElement",m.v.n);m.b("templateSources.anonymousTemplate",m.v.qa)})();(function(){function t(e,t,r){var i;for(t=m.f.nextSibling(t);e&&(i=e)!==t;)e=m.f.nextSibling(i),r(i,e)}function r(e,r){if(e.length){var i=e[0],n=e[e.length-1],a=i.parentNode,o=m.Q.instance,s=o.preprocessNode;if(s){t(i,n,function(e,t){var r=e.previousSibling,a=s.call(o,e);a&&(e===i&&(i=a[0]||t),e===n&&(n=a[a.length-1]||r))});e.length=0;if(!i)return;i===n?e.push(i):(e.push(i,n),m.a.za(e,a))}t(i,n,function(e){1!==e.nodeType&&8!==e.nodeType||m.Rb(r,e)});t(i,n,function(e){1!==e.nodeType&&8!==e.nodeType||m.M.yc(e,[r])});m.a.za(e,a)}}function i(e){return e.nodeType?e:0<e.length?e[0]:null}function n(e,t,n,a,s){s=s||{};var l=(e&&i(e)||n||{}).ownerDocument,u=s.templateEngine||o;m.Gb.Oc(n,u,l);n=u.renderTemplate(n,a,s,l);if("number"!=typeof n.length||0<n.length&&"number"!=typeof n[0].nodeType)throw Error("Template engine must return an array of DOM nodes");l=!1;switch(t){case"replaceChildren":m.f.da(e,n);l=!0;break;case"replaceNode":m.a.qc(e,n);l=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t)}l&&(r(n,a),s.afterRender&&m.l.w(s.afterRender,null,[n,a.$data]));return n}function a(e,t,r){return m.H(e)?e():"function"===typeof e?e(t,r):e}var o;m.Db=function(t){if(t!=e&&!(t instanceof m.O))throw Error("templateEngine must inherit from ko.templateEngine");o=t};m.Ab=function(t,r,s,l,u){s=s||{};if((s.templateEngine||o)==e)throw Error("Set a template engine before calling renderTemplate");u=u||"replaceChildren";if(l){var c=i(l);return m.B(function(){var e=r&&r instanceof m.U?r:new m.U(m.a.c(r)),o=a(t,e.$data,e),e=n(l,u,o,e,s);"replaceNode"==u&&(l=e,c=i(l))},null,{wa:function(){return!c||!m.a.nb(c)},i:c&&"replaceNode"==u?c.parentNode:c})}return m.M.wb(function(e){m.Ab(t,r,s,e,"replaceNode")})};m.kd=function(t,i,o,s,l){function u(e,t){r(t,d);o.afterRender&&o.afterRender(t,e);d=null}function c(e,r){d=l.createChildContext(e,o.as,function(e){e.$index=r});var i=a(t,e,d);return n(null,"ignoreTargetNode",i,d,o)}var d;return m.B(function(){var t=m.a.c(i)||[];"undefined"==typeof t.length&&(t=[t]);t=m.a.Ka(t,function(t){return o.includeDestroyed||t===e||null===t||!m.a.c(t._destroy)});m.l.w(m.a.Bb,null,[s,t,c,o,u])},null,{i:s})};var s=m.a.e.I();m.d.template={init:function(e,t){var r=m.a.c(t());if("string"==typeof r||r.name)m.f.xa(e);else{if("nodes"in r){if(r=r.nodes||[],m.H(r))throw Error('The "nodes" option must be a plain, non-observable array.')}else r=m.f.childNodes(e);r=m.a.jc(r);new m.v.qa(e).nodes(r)}return{controlsDescendantBindings:!0}},update:function(t,r,i,n,a){var o=r(),l;r=m.a.c(o);i=!0;n=null;"string"==typeof r?r={}:(o=r.name,"if"in r&&(i=m.a.c(r["if"])),i&&"ifnot"in r&&(i=!m.a.c(r.ifnot)),l=m.a.c(r.data));"foreach"in r?n=m.kd(o||t,i&&r.foreach||[],r,t,a):i?(a="data"in r?a.createChildContext(l,r.as):a,n=m.Ab(o||t,a,r,t)):m.f.xa(t);a=n;(l=m.a.e.get(t,s))&&"function"==typeof l.k&&l.k();m.a.e.set(t,s,a&&a.ba()?a:e)}};m.h.ta.template=function(e){e=m.h.yb(e);return 1==e.length&&e[0].unknown||m.h.ad(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"};m.f.Z.template=!0})();m.b("setTemplateEngine",m.Db);m.b("renderTemplate",m.Ab);m.a.dc=function(e,t,r){if(e.length&&t.length){var i,n,a,o,s;for(i=n=0;(!r||i<r)&&(o=e[n]);++n){for(a=0;s=t[a];++a)if(o.value===s.value){o.moved=s.index;s.moved=o.index;t.splice(a,1);i=a=0;break}i+=a}}};m.a.ib=function(){function e(e,t,r,i,n){var a=Math.min,o=Math.max,s=[],l,u=e.length,c,d=t.length,f=d-u||1,h=u+d+1,p,v,g;for(l=0;l<=u;l++)for(v=p,s.push(p=[]),g=a(d,l+f),c=o(0,l-1);c<=g;c++)p[c]=c?l?e[l-1]===t[c-1]?v[c-1]:a(v[c]||h,p[c-1]||h)+1:c+1:l+1;a=[];o=[];f=[];l=u;for(c=d;l||c;)d=s[l][c]-1,c&&d===s[l][c-1]?o.push(a[a.length]={status:r,value:t[--c],index:c}):l&&d===s[l-1][c]?f.push(a[a.length]={status:i,value:e[--l],index:l}):(--c,--l,n.sparse||a.push({status:"retained",value:t[c]}));m.a.dc(f,o,!n.dontLimitMoves&&10*u);return a.reverse()}return function(t,r,i){i="boolean"===typeof i?{dontLimitMoves:i}:i||{};t=t||[];r=r||[];return t.length<r.length?e(t,r,"added","deleted",i):e(r,t,"deleted","added",i)}}();m.b("utils.compareArrays",m.a.ib);(function(){function t(t,r,i,n,a){var o=[],s=m.B(function(){var e=r(i,a,m.a.za(o,t))||[];0<o.length&&(m.a.qc(o,e),n&&m.l.w(n,null,[i,e,a]));o.length=0;m.a.ra(o,e)},null,{i:t,wa:function(){return!m.a.Qb(o)}});return{ca:o,B:s.ba()?s:e}}var r=m.a.e.I(),i=m.a.e.I();m.a.Bb=function(n,a,o,s,l){function u(e,t){C=f[t];_!==t&&(w[e]=C);C.qb(_++);m.a.za(C.ca,n);v.push(C);b.push(C)}function c(e,t){if(e)for(var r=0,i=t.length;r<i;r++)t[r]&&m.a.q(t[r].ca,function(i){e(i,r,t[r].ja)})}a=a||[];s=s||{};var d=m.a.e.get(n,r)===e,f=m.a.e.get(n,r)||[],h=m.a.fb(f,function(e){return e.ja}),p=m.a.ib(h,a,s.dontLimitMoves),v=[],g=0,_=0,y=[],b=[];a=[];for(var w=[],h=[],C,S=0,T,E;T=p[S];S++)switch(E=T.moved,T.status){case"deleted":E===e&&(C=f[g],C.B&&(C.B.k(),C.B=e),m.a.za(C.ca,n).length&&(s.beforeRemove&&(v.push(C),b.push(C),C.ja===i?C=null:a[S]=C),C&&y.push.apply(y,C.ca)));g++;break;case"retained":u(S,g++);break;case"added":E!==e?u(S,E):(C={ja:T.value,qb:m.N(_++)},v.push(C),b.push(C),d||(h[S]=C))}m.a.e.set(n,r,v);c(s.beforeMove,w);m.a.q(y,s.beforeRemove?m.$:m.removeNode);for(var S=0,d=m.f.firstChild(n),x;C=b[S];S++){C.ca||m.a.extend(C,t(n,o,C.ja,l,C.qb));for(g=0;p=C.ca[g];d=p.nextSibling,x=p,g++)p!==d&&m.f.gc(n,p,x);!C.Wc&&l&&(l(C.ja,C.ca,C.qb),C.Wc=!0)}c(s.beforeRemove,a);for(S=0;S<a.length;++S)a[S]&&(a[S].ja=i);c(s.afterMove,w);c(s.afterAdd,h)}})();m.b("utils.setDomNodeChildrenFromArrayMapping",m.a.Bb);m.W=function(){this.allowTemplateRewriting=!1};m.W.prototype=new m.O;m.W.prototype.renderTemplateSource=function(e,t,r,i){if(t=(9>m.a.C?0:e.nodes)?e.nodes():null)return m.a.V(t.cloneNode(!0).childNodes);e=e.text();return m.a.ma(e,i)};m.W.sb=new m.W;m.Db(m.W.sb);m.b("nativeTemplateEngine",m.W);(function(){m.vb=function(){var e=this.$c=function(){if(!n||!n.tmpl)return 0;try{if(0<=n.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,i,a,o){o=o||r;a=a||{};if(2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var s=t.data("precompiled");s||(s=t.text()||"",s=n.template(null,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),t.data("precompiled",s));t=[i.$data];i=n.extend({koBindingContext:i},a.templateOptions);i=n.tmpl(s,t,i);i.appendTo(o.createElement("div"));n.fragments={};return i};this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"};this.addTemplate=function(e,t){r.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")};0<e&&(n.tmpl.tag.ko_code={open:"__.push($1 || '');"},n.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};m.vb.prototype=new m.O;var e=new m.vb;0<e.$c&&m.Db(e);m.b("jqueryTmplTemplateEngine",m.vb)})()})})()})();define("ThirdParty/knockout-es5",[],function(){"use strict";var e="__knockoutObservables";var t="__knockoutSubscribable";function r(r,n){if(!r){throw new Error("When calling ko.track, you must pass an object as the first parameter.")}var o=this,s=i(r,true);n=n||Object.getOwnPropertyNames(r);n.forEach(function(i){if(i===e||i===t){return}if(i in s){return}var n=r[i],l=n instanceof Array,u=o.isObservable(n)?n:l?o.observableArray(n):o.observable(n);Object.defineProperty(r,i,{configurable:true,enumerable:true,get:u,set:o.isWriteableObservable(u)?u:undefined});s[i]=u;if(l){a(o,u)}});return r}function i(t,r){var i=t[e];if(!i&&r){i={};Object.defineProperty(t,e,{value:i})}return i}function n(e,t,i){var n=this,a={owner:e,deferEvaluation:true};if(typeof i==="function"){a.read=i}else{if("value"in i){throw new Error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.')}if(typeof i.get!=="function"){throw new Error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".')}a.read=i.get;a.write=i.set}e[t]=n.computed(a);r.call(n,e,[t]);return e}function a(e,t){var r=null;e.computed(function(){if(r){r.dispose();r=null}var i=t();if(i instanceof Array){r=o(e,t,i)}})}function o(e,t,r){var i=s(e,r);return i.subscribe(t)}function s(e,r){var i=r[t];if(!i){i=new e.subscribable;Object.defineProperty(r,t,{value:i});var n={};l(r,i,n);u(e,r,i,n)}return i}function l(e,t,r){["pop","push","reverse","shift","sort","splice","unshift"].forEach(function(i){var n=e[i];e[i]=function(){var e=n.apply(this,arguments);if(r.pause!==true){t.notifySubscribers(this)}return e}})}function u(e,t,r,i){["remove","removeAll","destroy","destroyAll","replace"].forEach(function(n){Object.defineProperty(t,n,{enumerable:false,value:function(){var a;i.pause=true;try{a=e.observableArray.fn[n].apply(e.observableArray(t),arguments)}finally{i.pause=false}r.notifySubscribers(t);return a}})})}function c(e,t){if(!e){return null}var r=i(e,false);return r&&r[t]||null}function d(e,t){var r=c(e,t);if(r){r.valueHasMutated()}}function f(e){e.track=r;e.getObservable=c;e.valueHasMutated=d;e.defineProperty=n}return{attachToKo:f}});define("Widgets/SvgPathBindingHandler",[],function(){"use strict";var e="http://www.w3.org/2000/svg";var t="cesium-svgPath-svg";var r={register:function(r){r.bindingHandlers.cesiumSvgPath={init:function(i,n){var a=document.createElementNS(e,"svg:svg");a.setAttribute("class",t);var o=document.createElementNS(e,"path");a.appendChild(o);r.virtualElements.setDomNodeChildren(i,[a]);r.computed({read:function(){var e=r.unwrap(n());o.setAttribute("d",r.unwrap(e.path));var i=r.unwrap(e.width);var s=r.unwrap(e.height);a.setAttribute("width",i);a.setAttribute("height",s);a.setAttribute("viewBox","0 0 "+i+" "+s);if(e.css){a.setAttribute("class",t+" "+r.unwrap(e.css))}},disposeWhenNodeIsRemoved:i});return{controlsDescendantBindings:true}}};r.virtualElements.allowedBindings.cesiumSvgPath=true}};return r});define("ThirdParty/knockout",["./knockout-3.4.0","./knockout-es5","../Widgets/SvgPathBindingHandler"],function(e,t,r){"use strict";t.attachToKo(e);r.register(e);return e});define("ThirdParty/NoSleep",[],function(){"use strict";var e={Android:typeof navigator!=="undefined"&&/Android/gi.test(navigator.userAgent),iOS:typeof navigator!=="undefined"&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent)};var t={WebM:"data:video/webm;base64,GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA=",MP4:"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw=="};function r(e,t,r){var i=document.createElement("source");i.src=r;i.type="video/"+t;e.appendChild(i)}var i=function(){if(e.iOS){this.noSleepTimer=null}else if(e.Android){this.noSleepVideo=document.createElement("video");this.noSleepVideo.setAttribute("loop","");r(this.noSleepVideo,"webm",t.WebM);r(this.noSleepVideo,"mp4",t.MP4)}return this};i.prototype.enable=function(t){if(e.iOS){this.disable();this.noSleepTimer=window.setInterval(function(){window.location=window.location;window.setTimeout(window.stop,0)},t||15e3)}else if(e.Android){this.noSleepVideo.play()}};i.prototype.disable=function(){if(e.iOS){if(this.noSleepTimer){window.clearInterval(this.noSleepTimer);this.noSleepTimer=null}}else if(e.Android){this.noSleepVideo.pause()}};return i});(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define("ThirdParty/pako_inflate",[],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.pako=e()}})(function(){var e,t,r;return function e(t,r,i){function n(o,s){if(!r[o]){if(!t[o]){var l=typeof require=="function"&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};t[o][0].call(c.exports,function(e){var r=t[o][1][e];return n(r?r:e)},c,c.exports,e,t,r,i)}return r[o].exports}var a=typeof require=="function"&&require;for(var o=0;o<i.length;o++)n(i[o]);return n}({1:[function(e,t,r){"use strict";var i=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";r.assign=function(e){var t=Array.prototype.slice.call(arguments,1);while(t.length){var r=t.shift();if(!r){continue}if(typeof r!=="object"){throw new TypeError(r+"must be non-object")}for(var i in r){if(r.hasOwnProperty(i)){e[i]=r[i]}}}return e};r.shrinkBuf=function(e,t){if(e.length===t){return e}if(e.subarray){return e.subarray(0,t)}e.length=t;return e};var n={arraySet:function(e,t,r,i,n){if(t.subarray&&e.subarray){e.set(t.subarray(r,r+i),n);return}for(var a=0;a<i;a++){e[n+a]=t[r+a]}},flattenChunks:function(e){var t,r,i,n,a,o;i=0;for(t=0,r=e.length;t<r;t++){i+=e[t].length}o=new Uint8Array(i);n=0;for(t=0,r=e.length;t<r;t++){a=e[t];o.set(a,n);n+=a.length}return o}};var a={arraySet:function(e,t,r,i,n){for(var a=0;a<i;a++){e[n+a]=t[r+a]}},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){if(e){r.Buf8=Uint8Array;r.Buf16=Uint16Array;r.Buf32=Int32Array;r.assign(r,n)}else{r.Buf8=Array;r.Buf16=Array;r.Buf32=Array;r.assign(r,a)}};r.setTyped(i)},{}],2:[function(e,t,r){"use strict";var i=e("./common");var n=true;var a=true;try{String.fromCharCode.apply(null,[0])}catch(e){n=false}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=false}var o=new i.Buf8(256);for(var s=0;s<256;s++){o[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1}o[254]=o[254]=1;r.string2buf=function(e){var t,r,n,a,o,s=e.length,l=0;for(a=0;a<s;a++){r=e.charCodeAt(a);if((r&64512)===55296&&a+1<s){n=e.charCodeAt(a+1);if((n&64512)===56320){r=65536+(r-55296<<10)+(n-56320);a++}}l+=r<128?1:r<2048?2:r<65536?3:4}t=new i.Buf8(l);for(o=0,a=0;o<l;a++){r=e.charCodeAt(a);if((r&64512)===55296&&a+1<s){n=e.charCodeAt(a+1);if((n&64512)===56320){r=65536+(r-55296<<10)+(n-56320);a++}}if(r<128){t[o++]=r}else if(r<2048){t[o++]=192|r>>>6;t[o++]=128|r&63}else if(r<65536){t[o++]=224|r>>>12;t[o++]=128|r>>>6&63;t[o++]=128|r&63}else{t[o++]=240|r>>>18;t[o++]=128|r>>>12&63;t[o++]=128|r>>>6&63;t[o++]=128|r&63}}return t};function l(e,t){if(t<65537){if(e.subarray&&a||!e.subarray&&n){return String.fromCharCode.apply(null,i.shrinkBuf(e,t))}}var r="";for(var o=0;o<t;o++){r+=String.fromCharCode(e[o])}return r}r.buf2binstring=function(e){return l(e,e.length)};r.binstring2buf=function(e){var t=new i.Buf8(e.length);for(var r=0,n=t.length;r<n;r++){t[r]=e.charCodeAt(r)}return t};r.buf2string=function(e,t){var r,i,n,a;var s=t||e.length;var u=new Array(s*2);for(i=0,r=0;r<s;){n=e[r++];if(n<128){u[i++]=n;continue}a=o[n];if(a>4){u[i++]=65533;r+=a-1;continue}n&=a===2?31:a===3?15:7;while(a>1&&r<s){n=n<<6|e[r++]&63;a--}if(a>1){u[i++]=65533;continue}if(n<65536){u[i++]=n}else{n-=65536;u[i++]=55296|n>>10&1023;u[i++]=56320|n&1023}}return l(u,i)};r.utf8border=function(e,t){var r;t=t||e.length;if(t>e.length){t=e.length}r=t-1;while(r>=0&&(e[r]&192)===128){r--}if(r<0){return t}if(r===0){return t}return r+o[e[r]]>t?r:t}},{"./common":1}],3:[function(e,t,r){"use strict";function i(e,t,r,i){var n=e&65535|0,a=e>>>16&65535|0,o=0;while(r!==0){o=r>2e3?2e3:r;r-=o;do{n=n+t[i++]|0;a=a+n|0}while(--o);n%=65521;a%=65521}return n|a<<16|0}t.exports=i},{}],4:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,r){"use strict";function i(){var e,t=[];for(var r=0;r<256;r++){e=r;for(var i=0;i<8;i++){e=e&1?3988292384^e>>>1:e>>>1}t[r]=e}return t}var n=i();function a(e,t,r,i){var a=n,o=i+r;e^=-1;for(var s=i;s<o;s++){e=e>>>8^a[(e^t[s])&255]}return e^-1}t.exports=a},{}],6:[function(e,t,r){"use strict";function i(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=false}t.exports=i},{}],7:[function(e,t,r){"use strict";var i=30;var n=12;t.exports=function e(t,r){var a;var o;var s;var l;var u;var c;var d;var f;var h;var p;var m;var v;var g;var _;var y;var b;var w;var C;var S;var T;var E;var x;var P;var A,O;a=t.state;o=t.next_in;A=t.input;s=o+(t.avail_in-5);l=t.next_out;O=t.output;u=l-(r-t.avail_out);c=l+(t.avail_out-257);d=a.dmax;f=a.wsize;h=a.whave;p=a.wnext;m=a.window;v=a.hold;g=a.bits;_=a.lencode;y=a.distcode;b=(1<<a.lenbits)-1;w=(1<<a.distbits)-1;e:do{if(g<15){v+=A[o++]<<g;g+=8;v+=A[o++]<<g;g+=8}C=_[v&b];t:for(;;){S=C>>>24;v>>>=S;g-=S;S=C>>>16&255;if(S===0){O[l++]=C&65535}else if(S&16){T=C&65535;S&=15;if(S){if(g<S){v+=A[o++]<<g;g+=8}T+=v&(1<<S)-1;v>>>=S;g-=S}if(g<15){v+=A[o++]<<g;g+=8;v+=A[o++]<<g;g+=8}C=y[v&w];r:for(;;){S=C>>>24;v>>>=S;g-=S;S=C>>>16&255;if(S&16){E=C&65535;S&=15;if(g<S){v+=A[o++]<<g;g+=8;if(g<S){v+=A[o++]<<g;g+=8}}E+=v&(1<<S)-1;if(E>d){t.msg="invalid distance too far back";a.mode=i;break e}v>>>=S;g-=S;S=l-u;if(E>S){S=E-S;if(S>h){if(a.sane){t.msg="invalid distance too far back";a.mode=i;break e}}x=0;P=m;if(p===0){x+=f-S;if(S<T){T-=S;do{O[l++]=m[x++]}while(--S);x=l-E;P=O}}else if(p<S){x+=f+p-S;S-=p;if(S<T){T-=S;do{O[l++]=m[x++]}while(--S);x=0;if(p<T){S=p;T-=S;do{O[l++]=m[x++]}while(--S);x=l-E;P=O}}}else{x+=p-S;if(S<T){T-=S;do{O[l++]=m[x++]}while(--S);x=l-E;P=O}}while(T>2){O[l++]=P[x++];O[l++]=P[x++];O[l++]=P[x++];T-=3}if(T){O[l++]=P[x++];if(T>1){O[l++]=P[x++]}}}else{x=l-E;do{O[l++]=O[x++];O[l++]=O[x++];O[l++]=O[x++];T-=3}while(T>2);if(T){O[l++]=O[x++];if(T>1){O[l++]=O[x++]}}}}else if((S&64)===0){C=y[(C&65535)+(v&(1<<S)-1)];continue r}else{t.msg="invalid distance code";a.mode=i;break e}break}}else if((S&64)===0){C=_[(C&65535)+(v&(1<<S)-1)];continue t}else if(S&32){a.mode=n;break e}else{t.msg="invalid literal/length code";a.mode=i;break e}break}}while(o<s&&l<c);T=g>>3;o-=T;g-=T<<3;v&=(1<<g)-1;t.next_in=o;t.next_out=l;t.avail_in=o<s?5+(s-o):5-(o-s);t.avail_out=l<c?257+(c-l):257-(l-c);a.hold=v;a.bits=g;return}},{}],8:[function(e,t,r){"use strict";var i=e("../utils/common");var n=e("./adler32");var a=e("./crc32");var o=e("./inffast");var s=e("./inftrees");var l=0;var u=1;var c=2;var d=4;var f=5;var h=6;var p=0;var m=1;var v=2;var g=-2;var _=-3;var y=-4;var b=-5;var w=8;var C=1;var S=2;var T=3;var E=4;var x=5;var P=6;var A=7;var O=8;var D=9;var I=10;var M=11;var R=12;var L=13;var N=14;var k=15;var F=16;var B=17;var U=18;var V=19;var z=20;var q=21;var G=22;var H=23;var j=24;var W=25;var Y=26;var X=27;var Q=28;var Z=29;var K=30;var J=31;var $=32;var ee=852;var te=592;var re=15;var ie=re;function ne(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function ae(){this.mode=0;this.last=false;this.wrap=0;this.havedict=false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new i.Buf16(320);this.work=new i.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function oe(e){var t;if(!e||!e.state){return g}t=e.state;e.total_in=e.total_out=t.total=0;e.msg="";if(t.wrap){e.adler=t.wrap&1}t.mode=C;t.last=0;t.havedict=0;t.dmax=32768;t.head=null;t.hold=0;t.bits=0;t.lencode=t.lendyn=new i.Buf32(ee);t.distcode=t.distdyn=new i.Buf32(te);t.sane=1;t.back=-1;return p}function se(e){var t;if(!e||!e.state){return g}t=e.state;t.wsize=0;t.whave=0;t.wnext=0;return oe(e)}function le(e,t){var r;var i;if(!e||!e.state){return g}i=e.state;if(t<0){r=0;t=-t}else{r=(t>>4)+1;if(t<48){t&=15}}if(t&&(t<8||t>15)){return g}if(i.window!==null&&i.wbits!==t){i.window=null}i.wrap=r;i.wbits=t;return se(e)}function ue(e,t){var r;var i;if(!e){return g}i=new ae;e.state=i;i.window=null;r=le(e,t);if(r!==p){e.state=null}return r}function ce(e){return ue(e,ie)}var de=true;var fe,he;function pe(e){if(de){var t;fe=new i.Buf32(512);he=new i.Buf32(32);t=0;while(t<144){e.lens[t++]=8}while(t<256){e.lens[t++]=9}while(t<280){e.lens[t++]=7}while(t<288){e.lens[t++]=8}s(u,e.lens,0,288,fe,0,e.work,{bits:9});t=0;while(t<32){e.lens[t++]=5}s(c,e.lens,0,32,he,0,e.work,{bits:5});de=false}e.lencode=fe;e.lenbits=9;e.distcode=he;e.distbits=5}function me(e,t,r,n){var a;var o=e.state;if(o.window===null){o.wsize=1<<o.wbits;o.wnext=0;o.whave=0;o.window=new i.Buf8(o.wsize)}if(n>=o.wsize){i.arraySet(o.window,t,r-o.wsize,o.wsize,0);o.wnext=0;o.whave=o.wsize}else{a=o.wsize-o.wnext;if(a>n){a=n}i.arraySet(o.window,t,r-n,a,o.wnext);n-=a;if(n){i.arraySet(o.window,t,r-n,n,0);o.wnext=n;o.whave=o.wsize}else{o.wnext+=a;if(o.wnext===o.wsize){o.wnext=0}if(o.whave<o.wsize){o.whave+=a}}}return 0}function ve(e,t){var r;var ee,te;var re;var ie;var ae,oe;var se;var le;var ue,ce;var de;var fe;var he;var ve=0;var ge,_e,ye;var be,we,Ce;var Se;var Te;var Ee=new i.Buf8(4);var xe;var Pe;var Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0){return g}r=e.state;if(r.mode===R){r.mode=L}ie=e.next_out;te=e.output;oe=e.avail_out;re=e.next_in;ee=e.input;ae=e.avail_in;se=r.hold;le=r.bits;ue=ae;ce=oe;Te=p;e:for(;;){switch(r.mode){case C:if(r.wrap===0){r.mode=L;break}while(le<16){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}if(r.wrap&2&&se===35615){r.check=0;Ee[0]=se&255;Ee[1]=se>>>8&255;r.check=a(r.check,Ee,2,0);se=0;le=0;r.mode=S;break}r.flags=0;if(r.head){r.head.done=false}if(!(r.wrap&1)||(((se&255)<<8)+(se>>8))%31){e.msg="incorrect header check";r.mode=K;break}if((se&15)!==w){e.msg="unknown compression method";r.mode=K;break}se>>>=4;le-=4;Se=(se&15)+8;if(r.wbits===0){r.wbits=Se}else if(Se>r.wbits){e.msg="invalid window size";r.mode=K;break}r.dmax=1<<Se;e.adler=r.check=1;r.mode=se&512?I:R;se=0;le=0;break;case S:while(le<16){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}r.flags=se;if((r.flags&255)!==w){e.msg="unknown compression method";r.mode=K;break}if(r.flags&57344){e.msg="unknown header flags set";r.mode=K;break}if(r.head){r.head.text=se>>8&1}if(r.flags&512){Ee[0]=se&255;Ee[1]=se>>>8&255;r.check=a(r.check,Ee,2,0)}se=0;le=0;r.mode=T;case T:while(le<32){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}if(r.head){r.head.time=se}if(r.flags&512){Ee[0]=se&255;Ee[1]=se>>>8&255;Ee[2]=se>>>16&255;Ee[3]=se>>>24&255;r.check=a(r.check,Ee,4,0)}se=0;le=0;r.mode=E;case E:while(le<16){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}if(r.head){r.head.xflags=se&255;r.head.os=se>>8}if(r.flags&512){Ee[0]=se&255;Ee[1]=se>>>8&255;r.check=a(r.check,Ee,2,0)}se=0;le=0;r.mode=x;case x:if(r.flags&1024){while(le<16){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}r.length=se;if(r.head){r.head.extra_len=se}if(r.flags&512){Ee[0]=se&255;Ee[1]=se>>>8&255;r.check=a(r.check,Ee,2,0)}se=0;le=0}else if(r.head){r.head.extra=null}r.mode=P;case P:if(r.flags&1024){de=r.length;if(de>ae){de=ae}if(de){if(r.head){Se=r.head.extra_len-r.length;if(!r.head.extra){r.head.extra=new Array(r.head.extra_len)}i.arraySet(r.head.extra,ee,re,de,Se)}if(r.flags&512){r.check=a(r.check,ee,de,re)}ae-=de;re+=de;r.length-=de}if(r.length){break e}}r.length=0;r.mode=A;case A:if(r.flags&2048){if(ae===0){break e}de=0;do{Se=ee[re+de++];if(r.head&&Se&&r.length<65536){r.head.name+=String.fromCharCode(Se)}}while(Se&&de<ae);if(r.flags&512){r.check=a(r.check,ee,de,re)}ae-=de;re+=de;if(Se){break e}}else if(r.head){r.head.name=null}r.length=0;r.mode=O;case O:if(r.flags&4096){if(ae===0){break e}de=0;do{Se=ee[re+de++];if(r.head&&Se&&r.length<65536){r.head.comment+=String.fromCharCode(Se)}}while(Se&&de<ae);if(r.flags&512){r.check=a(r.check,ee,de,re)}ae-=de;re+=de;if(Se){break e}}else if(r.head){r.head.comment=null}r.mode=D;case D:if(r.flags&512){while(le<16){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}if(se!==(r.check&65535)){e.msg="header crc mismatch";r.mode=K;break}se=0;le=0}if(r.head){r.head.hcrc=r.flags>>9&1;r.head.done=true}e.adler=r.check=0;r.mode=R;break;case I:while(le<32){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}e.adler=r.check=ne(se);se=0;le=0;r.mode=M;case M:if(r.havedict===0){e.next_out=ie;e.avail_out=oe;e.next_in=re;e.avail_in=ae;r.hold=se;r.bits=le;return v}e.adler=r.check=1;r.mode=R;case R:if(t===f||t===h){break e}case L:if(r.last){se>>>=le&7;le-=le&7;r.mode=X;break}while(le<3){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}r.last=se&1;se>>>=1;le-=1;switch(se&3){case 0:r.mode=N;break;case 1:pe(r);r.mode=z;if(t===h){se>>>=2;le-=2;break e}break;case 2:r.mode=B;break;case 3:e.msg="invalid block type";r.mode=K}se>>>=2;le-=2;break;case N:se>>>=le&7;le-=le&7;while(le<32){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}if((se&65535)!==(se>>>16^65535)){e.msg="invalid stored block lengths";r.mode=K;break}r.length=se&65535;se=0;le=0;r.mode=k;if(t===h){break e}case k:r.mode=F;case F:de=r.length;if(de){if(de>ae){de=ae}if(de>oe){de=oe}if(de===0){break e}i.arraySet(te,ee,re,de,ie);ae-=de;re+=de;oe-=de;ie+=de;r.length-=de;break}r.mode=R;break;case B:while(le<14){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}r.nlen=(se&31)+257;se>>>=5;le-=5;r.ndist=(se&31)+1;se>>>=5;le-=5;r.ncode=(se&15)+4;se>>>=4;le-=4;if(r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols";r.mode=K;break}r.have=0;r.mode=U;case U:while(r.have<r.ncode){while(le<3){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}r.lens[Ae[r.have++]]=se&7;se>>>=3;le-=3}while(r.have<19){r.lens[Ae[r.have++]]=0}r.lencode=r.lendyn;r.lenbits=7;xe={bits:r.lenbits};Te=s(l,r.lens,0,19,r.lencode,0,r.work,xe);r.lenbits=xe.bits;if(Te){e.msg="invalid code lengths set";r.mode=K;break}r.have=0;r.mode=V;case V:while(r.have<r.nlen+r.ndist){for(;;){ve=r.lencode[se&(1<<r.lenbits)-1];ge=ve>>>24;_e=ve>>>16&255;ye=ve&65535;if(ge<=le){break}if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}if(ye<16){se>>>=ge;le-=ge;r.lens[r.have++]=ye}else{if(ye===16){Pe=ge+2;while(le<Pe){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}se>>>=ge;le-=ge;if(r.have===0){e.msg="invalid bit length repeat";r.mode=K;break}Se=r.lens[r.have-1];de=3+(se&3);se>>>=2;le-=2}else if(ye===17){Pe=ge+3;while(le<Pe){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}se>>>=ge;le-=ge;Se=0;de=3+(se&7);se>>>=3;le-=3}else{Pe=ge+7;while(le<Pe){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}se>>>=ge;le-=ge;Se=0;de=11+(se&127);se>>>=7;le-=7}if(r.have+de>r.nlen+r.ndist){e.msg="invalid bit length repeat";r.mode=K;break}while(de--){r.lens[r.have++]=Se}}}if(r.mode===K){break}if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block";r.mode=K;break}r.lenbits=9;xe={bits:r.lenbits};Te=s(u,r.lens,0,r.nlen,r.lencode,0,r.work,xe);r.lenbits=xe.bits;if(Te){e.msg="invalid literal/lengths set";r.mode=K;break}r.distbits=6;r.distcode=r.distdyn;xe={bits:r.distbits};Te=s(c,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,xe);r.distbits=xe.bits;if(Te){e.msg="invalid distances set";r.mode=K;break}r.mode=z;if(t===h){break e}case z:r.mode=q;case q:if(ae>=6&&oe>=258){e.next_out=ie;e.avail_out=oe;e.next_in=re;e.avail_in=ae;r.hold=se;r.bits=le;o(e,ce);ie=e.next_out;te=e.output;oe=e.avail_out;re=e.next_in;ee=e.input;ae=e.avail_in;se=r.hold;le=r.bits;if(r.mode===R){r.back=-1}break}r.back=0;for(;;){ve=r.lencode[se&(1<<r.lenbits)-1];ge=ve>>>24;_e=ve>>>16&255;ye=ve&65535;if(ge<=le){break}if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}if(_e&&(_e&240)===0){be=ge;we=_e;Ce=ye;for(;;){ve=r.lencode[Ce+((se&(1<<be+we)-1)>>be)];ge=ve>>>24;_e=ve>>>16&255;ye=ve&65535;if(be+ge<=le){break}if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}se>>>=be;le-=be;r.back+=be}se>>>=ge;le-=ge;r.back+=ge;r.length=ye;if(_e===0){r.mode=Y;break}if(_e&32){r.back=-1;r.mode=R;break}if(_e&64){e.msg="invalid literal/length code";r.mode=K;break}r.extra=_e&15;r.mode=G;case G:if(r.extra){Pe=r.extra;while(le<Pe){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}r.length+=se&(1<<r.extra)-1;se>>>=r.extra;le-=r.extra;r.back+=r.extra}r.was=r.length;r.mode=H;case H:for(;;){ve=r.distcode[se&(1<<r.distbits)-1];ge=ve>>>24;_e=ve>>>16&255;ye=ve&65535;if(ge<=le){break}if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}if((_e&240)===0){be=ge;we=_e;Ce=ye;for(;;){ve=r.distcode[Ce+((se&(1<<be+we)-1)>>be)];ge=ve>>>24;_e=ve>>>16&255;ye=ve&65535;if(be+ge<=le){break}if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}se>>>=be;le-=be;r.back+=be}se>>>=ge;le-=ge;r.back+=ge;if(_e&64){e.msg="invalid distance code";r.mode=K;break}r.offset=ye;r.extra=_e&15;r.mode=j;case j:if(r.extra){Pe=r.extra;while(le<Pe){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}r.offset+=se&(1<<r.extra)-1;se>>>=r.extra;le-=r.extra;r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back";r.mode=K;break}r.mode=W;case W:if(oe===0){break e}de=ce-oe;if(r.offset>de){de=r.offset-de;if(de>r.whave){if(r.sane){e.msg="invalid distance too far back";r.mode=K;break}}if(de>r.wnext){de-=r.wnext;fe=r.wsize-de}else{fe=r.wnext-de}if(de>r.length){de=r.length}he=r.window}else{he=te;fe=ie-r.offset;de=r.length}if(de>oe){de=oe}oe-=de;r.length-=de;do{te[ie++]=he[fe++]}while(--de);if(r.length===0){r.mode=q}break;case Y:if(oe===0){break e}te[ie++]=r.length;oe--;r.mode=q;break;case X:if(r.wrap){while(le<32){if(ae===0){break e}ae--;se|=ee[re++]<<le;le+=8}ce-=oe;e.total_out+=ce;r.total+=ce;if(ce){e.adler=r.check=r.flags?a(r.check,te,ce,ie-ce):n(r.check,te,ce,ie-ce)}ce=oe;if((r.flags?se:ne(se))!==r.check){e.msg="incorrect data check";r.mode=K;break}se=0;le=0}r.mode=Q;case Q:if(r.wrap&&r.flags){while(le<32){if(ae===0){break e}ae--;se+=ee[re++]<<le;le+=8}if(se!==(r.total&4294967295)){e.msg="incorrect length check";r.mode=K;break}se=0;le=0}r.mode=Z;case Z:Te=m;break e;case K:Te=_;break e;case J:return y;case $:default:return g}}e.next_out=ie;e.avail_out=oe;e.next_in=re;e.avail_in=ae;r.hold=se;r.bits=le;if(r.wsize||ce!==e.avail_out&&r.mode<K&&(r.mode<X||t!==d)){if(me(e,e.output,e.next_out,ce-e.avail_out)){r.mode=J;return y}}ue-=e.avail_in;ce-=e.avail_out;e.total_in+=ue;e.total_out+=ce;r.total+=ce;if(r.wrap&&ce){e.adler=r.check=r.flags?a(r.check,te,ce,e.next_out-ce):n(r.check,te,ce,e.next_out-ce)}e.data_type=r.bits+(r.last?64:0)+(r.mode===R?128:0)+(r.mode===z||r.mode===k?256:0);if((ue===0&&ce===0||t===d)&&Te===p){Te=b}return Te}function ge(e){if(!e||!e.state){return g}var t=e.state;if(t.window){t.window=null}e.state=null;return p}function _e(e,t){var r;if(!e||!e.state){return g}r=e.state;if((r.wrap&2)===0){return g}r.head=t;t.done=false;return p}function ye(e,t){var r=t.length;var i;var a;var o;if(!e||!e.state){return g}i=e.state;if(i.wrap!==0&&i.mode!==M){return g}if(i.mode===M){a=1;a=n(a,t,r,0);if(a!==i.check){return _}}o=me(e,t,r,r);if(o){i.mode=J;return y}i.havedict=1;return p}r.inflateReset=se;r.inflateReset2=le;r.inflateResetKeep=oe;r.inflateInit=ce;r.inflateInit2=ue;r.inflate=ve;r.inflateEnd=ge;r.inflateGetHeader=_e;r.inflateSetDictionary=ye;r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,r){"use strict";var i=e("../utils/common");var n=15;var a=852;var o=592;var s=0;var l=1;var u=2;var c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function e(t,r,p,m,v,g,_,y){var b=y.bits;var w=0;var C=0;var S=0,T=0;var E=0;var x=0;var P=0;var A=0;var O=0;var D=0;var I;var M;var R;var L;var N;var k=null;var F=0;var B;var U=new i.Buf16(n+1);var V=new i.Buf16(n+1);var z=null;var q=0;var G,H,j;for(w=0;w<=n;w++){U[w]=0}for(C=0;C<m;C++){U[r[p+C]]++}E=b;for(T=n;T>=1;T--){if(U[T]!==0){break}}if(E>T){E=T}if(T===0){v[g++]=1<<24|64<<16|0;v[g++]=1<<24|64<<16|0;y.bits=1;return 0}for(S=1;S<T;S++){if(U[S]!==0){break}}if(E<S){E=S}A=1;for(w=1;w<=n;w++){A<<=1;A-=U[w];if(A<0){return-1}}if(A>0&&(t===s||T!==1)){return-1}V[1]=0;for(w=1;w<n;w++){V[w+1]=V[w]+U[w]}for(C=0;C<m;C++){if(r[p+C]!==0){_[V[r[p+C]]++]=C}}if(t===s){k=z=_;B=19}else if(t===l){k=c;F-=257;z=d;q-=257;B=256}else{k=f;z=h;B=-1}D=0;C=0;w=S;N=g;x=E;P=0;R=-1;O=1<<E;L=O-1;if(t===l&&O>a||t===u&&O>o){return 1}for(;;){G=w-P;if(_[C]<B){H=0;j=_[C]}else if(_[C]>B){H=z[q+_[C]];j=k[F+_[C]]}else{H=32+64;j=0}I=1<<w-P;M=1<<x;S=M;do{M-=I;v[N+(D>>P)+M]=G<<24|H<<16|j|0}while(M!==0);I=1<<w-1;while(D&I){I>>=1}if(I!==0){D&=I-1;D+=I}else{D=0}C++;if(--U[w]===0){if(w===T){break}w=r[p+_[C]]}if(w>E&&(D&L)!==R){if(P===0){P=E}N+=S;x=w-P;A=1<<x;while(x+P<T){A-=U[x+P];if(A<=0){break}x++;A<<=1}O+=1<<x;if(t===l&&O>a||t===u&&O>o){return 1}R=D&L;v[R]=E<<24|x<<16|N-g|0}}if(D!==0){v[N+D]=w-P<<24|64<<16|0}y.bits=E;return 0}},{"../utils/common":1}],10:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,r){"use strict";function i(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}t.exports=i},{}],"/lib/inflate.js":[function(e,t,r){"use strict";var i=e("./zlib/inflate");var n=e("./utils/common");var a=e("./utils/strings");var o=e("./zlib/constants");var s=e("./zlib/messages");var l=e("./zlib/zstream");var u=e("./zlib/gzheader");var c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;if(t.raw&&t.windowBits>=0&&t.windowBits<16){t.windowBits=-t.windowBits;if(t.windowBits===0){t.windowBits=-15}}if(t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)){t.windowBits+=32}if(t.windowBits>15&&t.windowBits<48){if((t.windowBits&15)===0){t.windowBits|=15}}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new l;this.strm.avail_out=0;var r=i.inflateInit2(this.strm,t.windowBits);if(r!==o.Z_OK){throw new Error(s[r])}this.header=new u;i.inflateGetHeader(this.strm,this.header)}d.prototype.push=function(e,t){var r=this.strm;var s=this.options.chunkSize;var l=this.options.dictionary;var u,d;var f,h,p;var m;var v=false;if(this.ended){return false}d=t===~~t?t:t===true?o.Z_FINISH:o.Z_NO_FLUSH;if(typeof e==="string"){r.input=a.binstring2buf(e)}else if(c.call(e)==="[object ArrayBuffer]"){r.input=new Uint8Array(e)}else{r.input=e}r.next_in=0;r.avail_in=r.input.length;do{if(r.avail_out===0){r.output=new n.Buf8(s);r.next_out=0;r.avail_out=s}u=i.inflate(r,o.Z_NO_FLUSH);if(u===o.Z_NEED_DICT&&l){if(typeof l==="string"){m=a.string2buf(l)}else if(c.call(l)==="[object ArrayBuffer]"){m=new Uint8Array(l)}else{m=l}u=i.inflateSetDictionary(this.strm,m)}if(u===o.Z_BUF_ERROR&&v===true){u=o.Z_OK;v=false}if(u!==o.Z_STREAM_END&&u!==o.Z_OK){this.onEnd(u);this.ended=true;return false}if(r.next_out){if(r.avail_out===0||u===o.Z_STREAM_END||r.avail_in===0&&(d===o.Z_FINISH||d===o.Z_SYNC_FLUSH)){if(this.options.to==="string"){f=a.utf8border(r.output,r.next_out);h=r.next_out-f;p=a.buf2string(r.output,f);r.next_out=h;r.avail_out=s-h;if(h){n.arraySet(r.output,r.output,f,h,0)}this.onData(p)}else{this.onData(n.shrinkBuf(r.output,r.next_out))}}}if(r.avail_in===0&&r.avail_out===0){v=true}}while((r.avail_in>0||r.avail_out===0)&&u!==o.Z_STREAM_END);if(u===o.Z_STREAM_END){d=o.Z_FINISH}if(d===o.Z_FINISH){u=i.inflateEnd(this.strm);this.onEnd(u);this.ended=true;return u===o.Z_OK}if(d===o.Z_SYNC_FLUSH){this.onEnd(o.Z_OK);r.avail_out=0;return true}return true};d.prototype.onData=function(e){this.chunks.push(e)};d.prototype.onEnd=function(e){if(e===o.Z_OK){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=n.flattenChunks(this.chunks)}}this.chunks=[];this.err=e;this.msg=this.strm.msg};function f(e,t){var r=new d(t);r.push(e,true);if(r.err){throw r.msg||s[r.err]}return r.result}function h(e,t){t=t||{};t.raw=true;return f(e,t)}r.Inflate=d;r.inflate=f;r.inflateRaw=h;r.ungzip=f},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")});define("Widgets/subscribeAndEvaluate",["../ThirdParty/knockout"],function(e){"use strict";function t(t,r,i,n,a){i.call(n,t[r]);return e.getObservable(t,r).subscribe(i,n,a)}return t});define("Widgets/Animation/Animation",["../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../getElement","../subscribeAndEvaluate"],function(e,t,r,i,n,a,o){"use strict";var s="http://www.w3.org/2000/svg";var l="http://www.w3.org/1999/xlink";var u;var c=e.fromCssColorString("rgba(247,250,255,0.384)");var d=e.fromCssColorString("rgba(143,191,255,0.216)");var f=e.fromCssColorString("rgba(153,197,255,0.098)");var h=e.fromCssColorString("rgba(255,255,255,0.086)");var p=e.fromCssColorString("rgba(255,255,255,0.267)");var m=e.fromCssColorString("rgba(255,255,255,0)");var v=e.fromCssColorString("rgba(66,67,68,0.3)");var g=e.fromCssColorString("rgba(0,0,0,0.5)");function _(t){return e.fromCssColorString(window.getComputedStyle(t).getPropertyValue("color"))}function y(e){var t=document.createElementNS(s,e.tagName);for(var r in e){if(e.hasOwnProperty(r)&&r!=="tagName"){if(r==="children"){var i;var n=e.children.length;for(i=0;i<n;++i){t.appendChild(y(e.children[i]))}}else if(r.indexOf("xlink:")===0){t.setAttributeNS(l,r.substring(6),e[r])}else if(r==="textContent"){t.textContent=e[r]}else{t.setAttribute(r,e[r])}}}return t}function b(e,t,r){var i=document.createElementNS(s,"text");i.setAttribute("x",e);i.setAttribute("y",t);i.setAttribute("class","cesium-animation-svgText");var n=document.createElementNS(s,"tspan");n.textContent=r;i.appendChild(n);return i}function w(e,t,r){e.setAttribute("transform","translate(100,100) rotate("+r+")");t.setAttribute("transform","rotate("+r+")")}var C=new e;function S(e,t){var r=t.alpha;var i=1-r;C.red=e.red*i+t.red*r;C.green=e.green*i+t.green*r;C.blue=e.blue*i+t.blue*r;return C.toCssColorString()}function T(e,t,r){var i={tagName:"g",class:"cesium-animation-rectButton",transform:"translate("+e+","+t+")",children:[{tagName:"rect",class:"cesium-animation-buttonGlow",width:32,height:32,rx:2,ry:2},{tagName:"rect",class:"cesium-animation-buttonMain",width:32,height:32,rx:4,ry:4},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":r},{tagName:"title",textContent:""}]};return y(i)}function E(e,t,r){var i={tagName:"g",class:"cesium-animation-rectButton",transform:"translate("+e+","+t+")",children:[{tagName:"use",class:"cesium-animation-buttonGlow","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonMain","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":r},{tagName:"title",textContent:""}]};return y(i)}function x(e,t){var r=e._viewModel;var i=r.shuttleRingDragging;if(i&&u!==e){return}if(t.type==="mousedown"||i&&t.type==="mousemove"||t.type==="touchstart"&&t.touches.length===1||i&&t.type==="touchmove"&&t.touches.length===1){var n=e._centerX;var a=e._centerY;var o=e._svgNode;var s=o.getBoundingClientRect();var l;var c;if(t.type==="touchstart"||t.type==="touchmove"){l=t.touches[0].clientX;c=t.touches[0].clientY}else{l=t.clientX;c=t.clientY}if(!i&&(l>s.right||l<s.left||c<s.top||c>s.bottom)){return}var d=e._shuttleRingPointer.getBoundingClientRect();var f=l-n-s.left;var h=c-a-s.top;var p=Math.atan2(h,f)*180/Math.PI+90;if(p>180){p-=360}var m=r.shuttleRingAngle;if(i||l<d.right&&l>d.left&&c>d.top&&c<d.bottom){u=e;r.shuttleRingDragging=true;r.shuttleRingAngle=p}else if(p<m){r.slower()}else if(p>m){r.faster()}t.preventDefault()}else{if(e===u){u=undefined}r.shuttleRingDragging=false}}function P(e,t){this._viewModel=t;this.svgElement=e;this._enabled=undefined;this._toggled=undefined;var r=this;this._clickFunction=function(){var e=r._viewModel.command;if(e.canExecute){e()}};e.addEventListener("click",this._clickFunction,true);this._subscriptions=[o(t,"toggled",this.setToggled,this),o(t,"tooltip",this.setTooltip,this),o(t.command,"canExecute",this.setEnabled,this)]}P.prototype.destroy=function(){this.svgElement.removeEventListener("click",this._clickFunction,true);var e=this._subscriptions;for(var t=0,r=e.length;t<r;t++){e[t].dispose()}i(this)};P.prototype.isDestroyed=function(){return false};P.prototype.setEnabled=function(e){if(this._enabled!==e){this._enabled=e;if(!e){this.svgElement.setAttribute("class","cesium-animation-buttonDisabled");return}if(this._toggled){this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled");return}this.svgElement.setAttribute("class","cesium-animation-rectButton")}};P.prototype.setToggled=function(e){if(this._toggled!==e){this._toggled=e;if(this._enabled){if(e){this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled")}else{this.svgElement.setAttribute("class","cesium-animation-rectButton")}}}};P.prototype.setTooltip=function(e){this.svgElement.getElementsByTagName("title")[0].textContent=e};function A(e,r){if(!t(e)){throw new n("container is required.")}if(!t(r)){throw new n("viewModel is required.")}e=a(e);this._viewModel=r;this._container=e;this._centerX=0;this._centerY=0;this._defsElement=undefined;this._svgNode=undefined;this._topG=undefined;this._lastHeight=undefined;this._lastWidth=undefined;var i=document.createElement("style");i.textContent=".cesium-animation-rectButton .cesium-animation-buttonGlow { filter: url(#animation_blurred); }.cesium-animation-rectButton .cesium-animation-buttonMain { fill: url(#animation_buttonNormal); }.cesium-animation-buttonToggled .cesium-animation-buttonMain { fill: url(#animation_buttonToggled); }.cesium-animation-rectButton:hover .cesium-animation-buttonMain { fill: url(#animation_buttonHovered); }.cesium-animation-buttonDisabled .cesium-animation-buttonMain { fill: url(#animation_buttonDisabled); }.cesium-animation-shuttleRingG .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshGradient); }.cesium-animation-shuttleRingG:hover .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshHovered); }.cesium-animation-shuttleRingPointer { fill: url(#animation_shuttleRingPointerGradient); }.cesium-animation-shuttleRingPausePointer { fill: url(#animation_shuttleRingPointerPaused); }.cesium-animation-knobOuter { fill: url(#animation_knobOuter); }.cesium-animation-knobInner { fill: url(#animation_knobInner); }";document.head.insertBefore(i,document.head.childNodes[0]);var u=document.createElement("div");u.className="cesium-animation-theme";u.innerHTML='<div class="cesium-animation-themeNormal"></div><div class="cesium-animation-themeHover"></div><div class="cesium-animation-themeSelect"></div><div class="cesium-animation-themeDisabled"></div><div class="cesium-animation-themeKnob"></div><div class="cesium-animation-themePointer"></div><div class="cesium-animation-themeSwoosh"></div><div class="cesium-animation-themeSwooshHover"></div>';this._theme=u;this._themeNormal=u.childNodes[0];this._themeHover=u.childNodes[1];this._themeSelect=u.childNodes[2];this._themeDisabled=u.childNodes[3];this._themeKnob=u.childNodes[4];this._themePointer=u.childNodes[5];this._themeSwoosh=u.childNodes[6];this._themeSwooshHover=u.childNodes[7];var c=document.createElementNS(s,"svg:svg");this._svgNode=c;c.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",l);var d=document.createElementNS(s,"g");this._topG=d;this._realtimeSVG=new P(E(3,4,"#animation_pathClock"),r.playRealtimeViewModel);this._playReverseSVG=new P(T(44,99,"#animation_pathPlayReverse"),r.playReverseViewModel);this._playForwardSVG=new P(T(124,99,"#animation_pathPlay"),r.playForwardViewModel);this._pauseSVG=new P(T(84,99,"#animation_pathPause"),r.pauseViewModel);var f=document.createElementNS(s,"g");f.appendChild(this._realtimeSVG.svgElement);f.appendChild(this._playReverseSVG.svgElement);f.appendChild(this._playForwardSVG.svgElement);f.appendChild(this._pauseSVG.svgElement);var h=y({tagName:"circle",class:"cesium-animation-shuttleRingBack",cx:100,cy:100,r:99});this._shuttleRingBackPanel=h;var p=y({tagName:"g",class:"cesium-animation-shuttleRingSwoosh",children:[{tagName:"use",transform:"translate(100,97) scale(-1,1)","xlink:href":"#animation_pathSwooshFX"},{tagName:"use",transform:"translate(100,97)","xlink:href":"#animation_pathSwooshFX"},{tagName:"line",x1:100,y1:8,x2:100,y2:22}]});this._shuttleRingSwooshG=p;this._shuttleRingPointer=y({tagName:"use",class:"cesium-animation-shuttleRingPointer","xlink:href":"#animation_pathPointer"});var m=y({tagName:"g",transform:"translate(100,100)"});this._knobOuter=y({tagName:"circle",class:"cesium-animation-knobOuter",cx:0,cy:0,r:71});var v=61;var g=y({tagName:"circle",class:"cesium-animation-knobInner",cx:0,cy:0,r:v});this._knobDate=b(0,-24,"");this._knobTime=b(0,-7,"");this._knobStatus=b(0,-41,"");var _=y({tagName:"circle",class:"cesium-animation-blank",cx:0,cy:0,r:v});var C=document.createElementNS(s,"g");C.setAttribute("class","cesium-animation-shuttleRingG");e.appendChild(u);d.appendChild(C);d.appendChild(m);d.appendChild(f);C.appendChild(h);C.appendChild(p);C.appendChild(this._shuttleRingPointer);m.appendChild(this._knobOuter);m.appendChild(g);m.appendChild(this._knobDate);m.appendChild(this._knobTime);m.appendChild(this._knobStatus);m.appendChild(_);c.appendChild(d);e.appendChild(c);var S=this;function A(e){x(S,e)}this._mouseCallback=A;h.addEventListener("mousedown",A,true);h.addEventListener("touchstart",A,true);p.addEventListener("mousedown",A,true);p.addEventListener("touchstart",A,true);document.addEventListener("mousemove",A,true);document.addEventListener("touchmove",A,true);document.addEventListener("mouseup",A,true);document.addEventListener("touchend",A,true);document.addEventListener("touchcancel",A,true);this._shuttleRingPointer.addEventListener("mousedown",A,true);this._shuttleRingPointer.addEventListener("touchstart",A,true);this._knobOuter.addEventListener("mousedown",A,true);this._knobOuter.addEventListener("touchstart",A,true);var O=this._knobTime.childNodes[0];var D=this._knobDate.childNodes[0];var I=this._knobStatus.childNodes[0];var M;this._subscriptions=[o(r.pauseViewModel,"toggled",function(e){if(M!==e){M=e;if(M){S._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPausePointer")}else{S._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPointer")}}}),o(r,"shuttleRingAngle",function(e){w(S._shuttleRingPointer,S._knobOuter,e)}),o(r,"dateLabel",function(e){if(D.textContent!==e){D.textContent=e}}),o(r,"timeLabel",function(e){if(O.textContent!==e){O.textContent=e}}),o(r,"multiplierLabel",function(e){if(I.textContent!==e){I.textContent=e}})];this.applyThemeChanges();this.resize()}r(A.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});A.prototype.isDestroyed=function(){return false};A.prototype.destroy=function(){if(t(this._observer)){this._observer.disconnect();this._observer=undefined}var e=this._mouseCallback;this._shuttleRingBackPanel.removeEventListener("mousedown",e,true);this._shuttleRingBackPanel.removeEventListener("touchstart",e,true);this._shuttleRingSwooshG.removeEventListener("mousedown",e,true);this._shuttleRingSwooshG.removeEventListener("touchstart",e,true);document.removeEventListener("mousemove",e,true);document.removeEventListener("touchmove",e,true);document.removeEventListener("mouseup",e,true);document.removeEventListener("touchend",e,true);document.removeEventListener("touchcancel",e,true);this._shuttleRingPointer.removeEventListener("mousedown",e,true);this._shuttleRingPointer.removeEventListener("touchstart",e,true);this._knobOuter.removeEventListener("mousedown",e,true);this._knobOuter.removeEventListener("touchstart",e,true);this._container.removeChild(this._svgNode);this._container.removeChild(this._theme);this._realtimeSVG.destroy();this._playReverseSVG.destroy();this._playForwardSVG.destroy();this._pauseSVG.destroy();var r=this._subscriptions;for(var n=0,a=r.length;n<a;n++){r[n].dispose()}return i(this)};A.prototype.resize=function(){var e=this._container.clientWidth;var t=this._container.clientHeight;if(e===this._lastWidth&&t===this._lastHeight){return}var r=this._svgNode;var i=200;var n=132;var a=e;var o=t;if(e===0&&t===0){a=i;o=n}else if(e===0){o=t;a=i*(t/n)}else if(t===0){a=e;o=n*(e/i)}var s=a/i;var l=o/n;r.style.cssText="width: "+a+"px; height: "+o+"px; position: absolute; bottom: 0; left: 0; overflow: hidden;";r.setAttribute("width",a);r.setAttribute("height",o);r.setAttribute("viewBox","0 0 "+a+" "+o);this._topG.setAttribute("transform","scale("+s+","+l+")");this._centerX=Math.max(1,100*s);this._centerY=Math.max(1,100*l);this._lastHeight=e;this._lastWidth=t};A.prototype.applyThemeChanges=function(){if(!document.body.contains(this._container)){if(t(this._observer)){return}var e=this;e._observer=new MutationObserver(function(){if(document.body.contains(e._container)){e._observer.disconnect();e._observer=undefined;e.applyThemeChanges()}});e._observer.observe(document,{childList:true,subtree:true});return}var r=_(this._themeNormal);var i=_(this._themeHover);var n=_(this._themeSelect);var a=_(this._themeDisabled);var o=_(this._themeKnob);var s=_(this._themePointer);var l=_(this._themeSwoosh);var u=_(this._themeSwooshHover);var b=y({tagName:"defs",children:[{id:"animation_buttonNormal",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":S(r,c)},{tagName:"stop",offset:"12%","stop-color":S(r,d)},{tagName:"stop",offset:"46%","stop-color":S(r,f)},{tagName:"stop",offset:"81%","stop-color":S(r,h)}]},{id:"animation_buttonHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":S(i,c)},{tagName:"stop",offset:"12%","stop-color":S(i,d)},{tagName:"stop",offset:"46%","stop-color":S(i,f)},{tagName:"stop",offset:"81%","stop-color":S(i,h)}]},{id:"animation_buttonToggled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":S(n,c)},{tagName:"stop",offset:"12%","stop-color":S(n,d)},{tagName:"stop",offset:"46%","stop-color":S(n,f)},{tagName:"stop",offset:"81%","stop-color":S(n,h)}]},{id:"animation_buttonDisabled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":S(a,p)},{tagName:"stop",offset:"75%","stop-color":S(a,m)}]},{id:"animation_blurred",tagName:"filter",width:"200%",height:"200%",x:"-50%",y:"-50%",children:[{tagName:"feGaussianBlur",stdDeviation:4,in:"SourceGraphic"}]},{id:"animation_shuttleRingSwooshGradient",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":l.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":l.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":l.toCssColorString()}]},{id:"animation_shuttleRingSwooshHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":u.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":u.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":u.toCssColorString()}]},{id:"animation_shuttleRingPointerGradient",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":s.toCssColorString()},{tagName:"stop",offset:"40%","stop-color":s.toCssColorString()},{tagName:"stop",offset:"60%","stop-color":S(s,g)},{tagName:"stop",offset:"100%","stop-color":S(s,g)}]},{id:"animation_shuttleRingPointerPaused",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":"#CCC"},{tagName:"stop",offset:"40%","stop-color":"#CCC"},{tagName:"stop",offset:"60%","stop-color":"#555"},{tagName:"stop",offset:"100%","stop-color":"#555"}]},{id:"animation_knobOuter",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":S(o,c)},{tagName:"stop",offset:"60%","stop-color":S(o,v)},{tagName:"stop",offset:"85%","stop-color":S(o,d)}]},{id:"animation_knobInner",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":S(o,v)},{tagName:"stop",offset:"60%","stop-color":S(o,c)},{tagName:"stop",offset:"85%","stop-color":S(o,h)}]},{id:"animation_pathReset",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.316,5.318,9.833,13.682,9.833,5.5,5.5,5.5,5.5,25.5,9.833,25.5,9.833,17.318,24.316,25.682z"},{id:"animation_pathPause",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M13,5.5,7.5,5.5,7.5,25.5,13,25.5zM24.5,5.5,19,5.5,19,25.5,24.5,25.5z"},{id:"animation_pathPlay",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathPlayReverse",tagName:"path",transform:"translate(16,16) scale(-0.85,0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathLoop",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.249,15.499c-0.009,4.832-3.918,8.741-8.75,8.75c-2.515,0-4.768-1.064-6.365-2.763l2.068-1.442l-7.901-3.703l0.744,8.694l2.193-1.529c2.244,2.594,5.562,4.242,9.26,4.242c6.767,0,12.249-5.482,12.249-12.249H24.249zM15.499,6.75c2.516,0,4.769,1.065,6.367,2.764l-2.068,1.443l7.901,3.701l-0.746-8.693l-2.192,1.529c-2.245-2.594-5.562-4.245-9.262-4.245C8.734,3.25,3.25,8.734,3.249,15.499H6.75C6.758,10.668,10.668,6.758,15.499,6.75z"},{id:"animation_pathClock",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-15.5)",d:"M15.5,2.374C8.251,2.375,2.376,8.251,2.374,15.5C2.376,22.748,8.251,28.623,15.5,28.627c7.249-0.004,13.124-5.879,13.125-13.127C28.624,8.251,22.749,2.375,15.5,2.374zM15.5,25.623C9.909,25.615,5.385,21.09,5.375,15.5C5.385,9.909,9.909,5.384,15.5,5.374c5.59,0.01,10.115,4.535,10.124,10.125C25.615,21.09,21.091,25.615,15.5,25.623zM8.625,15.5c-0.001-0.552-0.448-0.999-1.001-1c-0.553,0-1,0.448-1,1c0,0.553,0.449,1,1,1C8.176,16.5,8.624,16.053,8.625,15.5zM8.179,18.572c-0.478,0.277-0.642,0.889-0.365,1.367c0.275,0.479,0.889,0.641,1.365,0.365c0.479-0.275,0.643-0.887,0.367-1.367C9.27,18.461,8.658,18.297,8.179,18.572zM9.18,10.696c-0.479-0.276-1.09-0.112-1.366,0.366s-0.111,1.09,0.365,1.366c0.479,0.276,1.09,0.113,1.367-0.366C9.821,11.584,9.657,10.973,9.18,10.696zM22.822,12.428c0.478-0.275,0.643-0.888,0.366-1.366c-0.275-0.478-0.89-0.642-1.366-0.366c-0.479,0.278-0.642,0.89-0.366,1.367C21.732,12.54,22.344,12.705,22.822,12.428zM12.062,21.455c-0.478-0.275-1.089-0.111-1.366,0.367c-0.275,0.479-0.111,1.09,0.366,1.365c0.478,0.277,1.091,0.111,1.365-0.365C12.704,22.344,12.54,21.732,12.062,21.455zM12.062,9.545c0.479-0.276,0.642-0.888,0.366-1.366c-0.276-0.478-0.888-0.642-1.366-0.366s-0.642,0.888-0.366,1.366C10.973,9.658,11.584,9.822,12.062,9.545zM22.823,18.572c-0.48-0.275-1.092-0.111-1.367,0.365c-0.275,0.479-0.112,1.092,0.367,1.367c0.477,0.275,1.089,0.113,1.365-0.365C23.464,19.461,23.3,18.848,22.823,18.572zM19.938,7.813c-0.477-0.276-1.091-0.111-1.365,0.366c-0.275,0.48-0.111,1.091,0.366,1.367s1.089,0.112,1.366-0.366C20.581,8.702,20.418,8.089,19.938,7.813zM23.378,14.5c-0.554,0.002-1.001,0.45-1.001,1c0.001,0.552,0.448,1,1.001,1c0.551,0,1-0.447,1-1C24.378,14.949,23.929,14.5,23.378,14.5zM15.501,6.624c-0.552,0-1,0.448-1,1l-0.466,7.343l-3.004,1.96c-0.478,0.277-0.642,0.889-0.365,1.365c0.275,0.479,0.889,0.643,1.365,0.367l3.305-1.676C15.39,16.99,15.444,17,15.501,17c0.828,0,1.5-0.671,1.5-1.5l-0.5-7.876C16.501,7.072,16.053,6.624,15.501,6.624zM15.501,22.377c-0.552,0-1,0.447-1,1s0.448,1,1,1s1-0.447,1-1S16.053,22.377,15.501,22.377zM18.939,21.455c-0.479,0.277-0.643,0.889-0.366,1.367c0.275,0.477,0.888,0.643,1.366,0.365c0.478-0.275,0.642-0.889,0.366-1.365C20.028,21.344,19.417,21.18,18.939,21.455z"},{id:"animation_pathWingButton",tagName:"path",d:"m 4.5,0.5 c -2.216,0 -4,1.784 -4,4 l 0,24 c 0,2.216 1.784,4 4,4 l 13.71875,0 C 22.478584,27.272785 27.273681,22.511272 32.5,18.25 l 0,-13.75 c 0,-2.216 -1.784,-4 -4,-4 l -24,0 z"},{id:"animation_pathPointer",tagName:"path",d:"M-15,-65,-15,-55,15,-55,15,-65,0,-95z"},{id:"animation_pathSwooshFX",tagName:"path",d:"m 85,0 c 0,16.617 -4.813944,35.356 -13.131081,48.4508 h 6.099803 c 8.317138,-13.0948 13.13322,-28.5955 13.13322,-45.2124 0,-46.94483 -38.402714,-85.00262 -85.7743869,-85.00262 -1.0218522,0 -2.0373001,0.0241 -3.0506131,0.0589 45.958443,1.59437 82.723058,35.77285 82.723058,81.70532 z"}]});if(!t(this._defsElement)){this._svgNode.appendChild(b)}else{this._svgNode.replaceChild(b,this._defsElement)}this._defsElement=b};return A});define("Widgets/createCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../ThirdParty/knockout"],function(e,t,r,i,n,a){"use strict";function o(o,s){if(!t(o)){throw new i("func is required.")}s=e(s,true);var l=new n;var u=new n;function c(){if(!c.canExecute){throw new i("Cannot execute command, canExecute is false.")}var e={args:arguments,cancel:false};var t;l.raiseEvent(e);if(!e.cancel){t=o.apply(null,arguments);u.raiseEvent(t)}return t}c.canExecute=s;a.track(c,["canExecute"]);r(c,{beforeExecute:{value:l},afterExecute:{value:u}});return c}return o});define("Widgets/ToggleButtonViewModel",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../ThirdParty/knockout"],function(e,t,r,i,n){"use strict";function a(r,a){if(!t(r)){throw new i("command is required.")}this._command=r;a=e(a,e.EMPTY_OBJECT);this.toggled=e(a.toggled,false);this.tooltip=e(a.tooltip,"");n.track(this,["toggled","tooltip"])}r(a.prototype,{command:{get:function(){return this._command}}});return a});define("Widgets/Animation/AnimationViewModel",["../../Core/binarySearch","../../Core/ClockRange","../../Core/ClockStep","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/JulianDate","../../ThirdParty/knockout","../../ThirdParty/sprintf","../createCommand","../ToggleButtonViewModel"],function(e,t,r,i,n,a,o,s,l,u,c){"use strict";var d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var f=15;var h=105;function p(e,t){return e-t}function m(t,r){var i=e(r,t,p);return i<0?~i:i}function v(e,t){if(Math.abs(e)<=f){return e/f}var r=f;var i=h;var n;var a=0;var o;if(e>0){n=Math.log(t[t.length-1]);o=(n-a)/(i-r);return Math.exp(a+o*(e-r))}n=Math.log(-t[0]);o=(n-a)/(i-r);return-Math.exp(a+o*(Math.abs(e)-r))}function g(e,t,i){if(i.clockStep===r.SYSTEM_CLOCK){return f}if(Math.abs(e)<=1){return e*f}var n=t[t.length-1];if(e>n){e=n}else if(e<-n){e=-n}var a=f;var o=h;var s;var l=0;var u;if(e>0){s=Math.log(n);u=(s-l)/(o-a);return(Math.log(e)-l)/u+a}s=Math.log(-t[0]);u=(s-l)/(o-a);return-((Math.log(Math.abs(e))-l)/u+a)}function _(e){if(!i(e)){throw new a("clockViewModel is required.")}var n=this;this._clockViewModel=e;this._allShuttleRingTicks=[];this._dateFormatter=_.defaultDateFormatter;this._timeFormatter=_.defaultTimeFormatter;this.shuttleRingDragging=false;this.snapToTicks=false;s.track(this,["_allShuttleRingTicks","_dateFormatter","_timeFormatter","shuttleRingDragging","snapToTicks"]);this._sortedFilteredPositiveTicks=[];this.setShuttleRingTicks(_.defaultTicks);this.timeLabel=undefined;s.defineProperty(this,"timeLabel",function(){return n._timeFormatter(n._clockViewModel.currentTime,n)});this.dateLabel=undefined;s.defineProperty(this,"dateLabel",function(){return n._dateFormatter(n._clockViewModel.currentTime,n)});this.multiplierLabel=undefined;s.defineProperty(this,"multiplierLabel",function(){var e=n._clockViewModel;if(e.clockStep===r.SYSTEM_CLOCK){return"Today"}var t=e.multiplier;if(t%1===0){return t.toFixed(0)+"x"}return t.toFixed(3).replace(/0{0,3}$/,"")+"x"});this.shuttleRingAngle=undefined;s.defineProperty(this,"shuttleRingAngle",{get:function(){return g(e.multiplier,n._allShuttleRingTicks,e)},set:function(e){e=Math.max(Math.min(e,h),-h);var t=n._allShuttleRingTicks;var i=n._clockViewModel;i.clockStep=r.SYSTEM_CLOCK_MULTIPLIER;if(Math.abs(e)===h){i.multiplier=e>0?t[t.length-1]:t[0];return}var a=v(e,t);if(n.snapToTicks){a=t[m(a,t)]}else if(a!==0){var o=Math.abs(a);if(o>100){var s=o.toFixed(0).length-2;var l=Math.pow(10,s);a=Math.round(a/l)*l|0}else if(o>f){a=Math.round(a)}else if(o>1){a=+a.toFixed(1)}else if(o>0){a=+a.toFixed(2)}}i.multiplier=a}});this._canAnimate=undefined;s.defineProperty(this,"_canAnimate",function(){var e=n._clockViewModel;var r=e.clockRange;if(n.shuttleRingDragging||r===t.UNBOUNDED){return true}var i=e.multiplier;var a=e.currentTime;var s=e.startTime;var l=false;if(r===t.LOOP_STOP){l=o.greaterThan(a,s)||a.equals(s)&&i>0}else{var u=e.stopTime;l=o.greaterThan(a,s)&&o.lessThan(a,u)||a.equals(s)&&i>0||a.equals(u)&&i<0}if(!l){e.shouldAnimate=false}return l});this._isSystemTimeAvailable=undefined;s.defineProperty(this,"_isSystemTimeAvailable",function(){var e=n._clockViewModel;var r=e.clockRange;if(r===t.UNBOUNDED){return true}var i=e.systemTime;return o.greaterThanOrEquals(i,e.startTime)&&o.lessThanOrEquals(i,e.stopTime)});this._isAnimating=undefined;s.defineProperty(this,"_isAnimating",function(){return n._clockViewModel.shouldAnimate&&(n._canAnimate||n.shuttleRingDragging)});var l=u(function(){var e=n._clockViewModel;if(e.shouldAnimate){e.shouldAnimate=false}else if(n._canAnimate){e.shouldAnimate=true}});this._pauseViewModel=new c(l,{toggled:s.computed(function(){return!n._isAnimating}),tooltip:"Pause"});var d=u(function(){var e=n._clockViewModel;var t=e.multiplier;if(t>0){e.multiplier=-t}e.shouldAnimate=true});this._playReverseViewModel=new c(d,{toggled:s.computed(function(){return n._isAnimating&&e.multiplier<0}),tooltip:"Play Reverse"});var p=u(function(){var e=n._clockViewModel;var t=e.multiplier;if(t<0){e.multiplier=-t}e.shouldAnimate=true});this._playForwardViewModel=new c(p,{toggled:s.computed(function(){return n._isAnimating&&e.multiplier>0&&e.clockStep!==r.SYSTEM_CLOCK}),tooltip:"Play Forward"});var y=u(function(){n._clockViewModel.clockStep=r.SYSTEM_CLOCK},s.getObservable(this,"_isSystemTimeAvailable"));this._playRealtimeViewModel=new c(y,{toggled:s.computed(function(){return e.clockStep===r.SYSTEM_CLOCK}),tooltip:s.computed(function(){return n._isSystemTimeAvailable?"Today (real-time)":"Current time not in range"})});this._slower=u(function(){var e=n._clockViewModel;var t=n._allShuttleRingTicks;var r=e.multiplier;var i=m(r,t)-1;if(i>=0){e.multiplier=t[i]}});this._faster=u(function(){var e=n._clockViewModel;var t=n._allShuttleRingTicks;var r=e.multiplier;var i=m(r,t)+1;if(i<t.length){e.multiplier=t[i]}})}_.defaultDateFormatter=function(e,t){var r=o.toGregorianDate(e);return d[r.month-1]+" "+r.day+" "+r.year};_.defaultTicks=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800];_.defaultTimeFormatter=function(e,t){var r=o.toGregorianDate(e);var i=Math.round(r.millisecond);if(Math.abs(t._clockViewModel.multiplier)<1){return l("%02d:%02d:%02d.%03d",r.hour,r.minute,r.second,i)}return l("%02d:%02d:%02d UTC",r.hour,r.minute,r.second)};_.prototype.getShuttleRingTicks=function(){return this._sortedFilteredPositiveTicks.slice(0)};_.prototype.setShuttleRingTicks=function(e){if(!i(e)){throw new a("positiveTicks is required.")}var t;var r;var n;var o={};var s=this._sortedFilteredPositiveTicks;s.length=0;for(t=0,r=e.length;t<r;++t){n=e[t];if(!o.hasOwnProperty(n)){o[n]=true;s.push(n)}}s.sort(p);var l=[];for(r=s.length,t=r-1;t>=0;--t){n=s[t];if(n!==0){l.push(-n)}}Array.prototype.push.apply(l,s);this._allShuttleRingTicks=l};n(_.prototype,{slower:{get:function(){return this._slower}},faster:{get:function(){return this._faster}},clockViewModel:{get:function(){return this._clockViewModel}},pauseViewModel:{get:function(){return this._pauseViewModel}},playReverseViewModel:{get:function(){return this._playReverseViewModel}},playForwardViewModel:{get:function(){return this._playForwardViewModel}},playRealtimeViewModel:{get:function(){return this._playRealtimeViewModel}},dateFormatter:{get:function(){return this._dateFormatter},set:function(e){if(typeof e!=="function"){throw new a("dateFormatter must be a function")}this._dateFormatter=e}},timeFormatter:{get:function(){return this._timeFormatter},set:function(e){if(typeof e!=="function"){throw new a("timeFormatter must be a function")}this._timeFormatter=e}}});_._maxShuttleRingAngle=h;_._realtimeShuttleRingAngle=f;return _});define("Widgets/BaseLayerPicker/BaseLayerPickerViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/EllipsoidTerrainProvider","../../Core/isArray","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s){"use strict";function l(r){r=e(r,e.EMPTY_OBJECT);var l=r.globe;var u=e(r.imageryProviderViewModels,[]);var c=e(r.terrainProviderViewModels,[]);if(!t(l)){throw new i("globe is required")}this._globe=l;this.imageryProviderViewModels=u.slice(0);this.terrainProviderViewModels=c.slice(0);this.dropDownVisible=false;o.track(this,["imageryProviderViewModels","terrainProviderViewModels","dropDownVisible"]);this.buttonTooltip=undefined;o.defineProperty(this,"buttonTooltip",function(){var e=this.selectedImagery;var r=this.selectedTerrain;var i=t(e)?e.name:undefined;var n=t(r)?r.name:undefined;if(t(i)&&t(n)){return i+"\n"+n}else if(t(i)){return i}return n});this.buttonImageUrl=undefined;o.defineProperty(this,"buttonImageUrl",function(){var e=this.selectedImagery;return t(e)?e.iconUrl:undefined});this.selectedImagery=undefined;var d=o.observable();this._currentImageryProviders=[];o.defineProperty(this,"selectedImagery",{get:function(){return d()},set:function(e){if(d()===e){this.dropDownVisible=false;return}var r;var i=this._currentImageryProviders;var n=i.length;var o=this._globe.imageryLayers;for(r=0;r<n;r++){var s=o.length;for(var l=0;l<s;l++){var u=o.get(l);if(u.imageryProvider===i[r]){o.remove(u);break}}}if(t(e)){var c=e.creationCommand();if(a(c)){var f=c.length;for(r=f-1;r>=0;r--){o.addImageryProvider(c[r],0)}this._currentImageryProviders=c.slice(0)}else{this._currentImageryProviders=[c];o.addImageryProvider(c,0)}}d(e);this.dropDownVisible=false}});this.selectedTerrain=undefined;var f=o.observable();o.defineProperty(this,"selectedTerrain",{get:function(){return f()},set:function(e){if(f()===e){this.dropDownVisible=false;return}var r;if(t(e)){r=e.creationCommand()}this._globe.depthTestAgainstTerrain=!(r instanceof n);this._globe.terrainProvider=r;f(e);this.dropDownVisible=false}});var h=this;this._toggleDropDown=s(function(){h.dropDownVisible=!h.dropDownVisible});this.selectedImagery=e(r.selectedImageryProviderViewModel,u[0]);this.selectedTerrain=e(r.selectedTerrainProviderViewModel,c[0])}r(l.prototype,{toggleDropDown:{get:function(){return this._toggleDropDown}},globe:{get:function(){return this._globe}}});return l});define("Widgets/BaseLayerPicker/BaseLayerPicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./BaseLayerPickerViewModel"],function(e,t,r,i,n,a,o,s){"use strict";function l(t,r){if(!e(t)){throw new i("container is required.")}t=o(t);var l=new s(r);var u=document.createElement("button");u.type="button";u.className="cesium-button cesium-toolbar-button";u.setAttribute("data-bind","attr: { title: buttonTooltip },click: toggleDropDown");t.appendChild(u);var c=document.createElement("img");c.setAttribute("draggable","false");c.className="cesium-baseLayerPicker-selected";c.setAttribute("data-bind","attr: { src: buttonImageUrl }");u.appendChild(c);var d=document.createElement("div");d.className="cesium-baseLayerPicker-dropDown";d.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-dropDown-visible" : dropDownVisible }');t.appendChild(d);var f=document.createElement("div");f.className="cesium-baseLayerPicker-sectionTitle";f.setAttribute("data-bind","visible: imageryProviderViewModels.length > 0");f.innerHTML="Imagery";d.appendChild(f);var h=document.createElement("div");h.className="cesium-baseLayerPicker-choices";h.setAttribute("data-bind","foreach: imageryProviderViewModels");d.appendChild(h);var p=document.createElement("div");p.className="cesium-baseLayerPicker-item";p.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parent.selectedImagery },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parent.selectedImagery = $data; }');h.appendChild(p);var m=document.createElement("img");m.className="cesium-baseLayerPicker-itemIcon";m.setAttribute("data-bind","attr: { src: iconUrl }");m.setAttribute("draggable","false");p.appendChild(m);var v=document.createElement("div");v.className="cesium-baseLayerPicker-itemLabel";v.setAttribute("data-bind","text: name");p.appendChild(v);var g=document.createElement("div");g.className="cesium-baseLayerPicker-sectionTitle";g.setAttribute("data-bind","visible: terrainProviderViewModels.length > 0");g.innerHTML="Terrain";d.appendChild(g);var _=document.createElement("div");_.className="cesium-baseLayerPicker-choices";_.setAttribute("data-bind","foreach: terrainProviderViewModels");d.appendChild(_);var y=document.createElement("div");y.className="cesium-baseLayerPicker-item";y.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parent.selectedTerrain },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parent.selectedTerrain = $data; }');_.appendChild(y);var b=document.createElement("img");b.className="cesium-baseLayerPicker-itemIcon";b.setAttribute("data-bind","attr: { src: iconUrl }");b.setAttribute("draggable","false");y.appendChild(b);var w=document.createElement("div");w.className="cesium-baseLayerPicker-itemLabel";w.setAttribute("data-bind","text: name");y.appendChild(w);a.applyBindings(l,u);a.applyBindings(l,d);this._viewModel=l;this._container=t;this._element=u;this._dropPanel=d;this._closeDropDown=function(e){if(!(u.contains(e.target)||d.contains(e.target))){l.dropDownVisible=false}};if(n.supportsPointerEvents()){document.addEventListener("pointerdown",this._closeDropDown,true)}else{document.addEventListener("mousedown",this._closeDropDown,true);document.addEventListener("touchstart",this._closeDropDown,true)}}t(l.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){if(n.supportsPointerEvents()){document.removeEventListener("pointerdown",this._closeDropDown,true)}else{document.removeEventListener("mousedown",this._closeDropDown,true);document.removeEventListener("touchstart",this._closeDropDown,true)}a.cleanNode(this._element);a.cleanNode(this._dropPanel);this._container.removeChild(this._element);this._container.removeChild(this._dropPanel);return r(this)};return l});define("Widgets/BaseLayerPicker/ProviderViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n){"use strict";function a(t){if(!e(t.name)){throw new r("options.name is required.")}if(!e(t.tooltip)){throw new r("options.tooltip is required.")}if(!e(t.iconUrl)){throw new r("options.iconUrl is required.")}if(typeof t.creationFunction!=="function"){throw new r("options.creationFunction is required.")}var a=t.creationFunction;if(!e(a.canExecute)){a=n(a)}this._creationCommand=a;this.name=t.name;this.tooltip=t.tooltip;this.iconUrl=t.iconUrl;i.track(this,["name","tooltip","iconUrl"])}t(a.prototype,{creationCommand:{get:function(){return this._creationCommand}}});return a});define("Widgets/BaseLayerPicker/createDefaultImageryProviderViewModels",["../../Core/buildModuleUrl","../../Scene/ArcGisMapServerImageryProvider","../../Scene/BingMapsImageryProvider","../../Scene/BingMapsStyle","../../Scene/createOpenStreetMapImageryProvider","../../Scene/createTileMapServiceImageryProvider","../../Scene/MapboxImageryProvider","../BaseLayerPicker/ProviderViewModel"],function(e,t,r,i,n,a,o,s){"use strict";function l(){var l=[];l.push(new s({name:"Bing Maps Aerial",iconUrl:e("Widgets/Images/ImageryProviders/bingAerial.png"),tooltip:"Bing Maps aerial imagery \nhttp://www.bing.com/maps",creationFunction:function(){return new r({url:"https://dev.virtualearth.net",mapStyle:i.AERIAL})}}));l.push(new s({name:"Bing Maps Aerial with Labels",iconUrl:e("Widgets/Images/ImageryProviders/bingAerialLabels.png"),tooltip:"Bing Maps aerial imagery with label overlays \nhttp://www.bing.com/maps",creationFunction:function(){return new r({url:"https://dev.virtualearth.net",mapStyle:i.AERIAL_WITH_LABELS})}}));l.push(new s({name:"Bing Maps Roads",iconUrl:e("Widgets/Images/ImageryProviders/bingRoads.png"),tooltip:"Bing Maps standard road maps\nhttp://www.bing.com/maps",creationFunction:function(){return new r({url:"https://dev.virtualearth.net",mapStyle:i.ROAD})}}));l.push(new s({name:"Mapbox Satellite",tooltip:"Mapbox satellite imagery https://www.mapbox.com/maps/",iconUrl:e("Widgets/Images/ImageryProviders/mapboxSatellite.png"),creationFunction:function(){return new o({mapId:"mapbox.satellite"})}}));l.push(new s({name:"Mapbox Streets",tooltip:"Mapbox streets imagery https://www.mapbox.com/maps/",iconUrl:e("Widgets/Images/ImageryProviders/mapboxTerrain.png"),creationFunction:function(){return new o({mapId:"mapbox.streets"})}}));l.push(new s({name:"Mapbox Streets Classic",tooltip:"Mapbox streets basic imagery https://www.mapbox.com/maps/",iconUrl:e("Widgets/Images/ImageryProviders/mapboxStreets.png"),creationFunction:function(){return new o({mapId:"mapbox.streets-basic"})}}));l.push(new s({name:"ESRI World Imagery",iconUrl:e("Widgets/Images/ImageryProviders/esriWorldImagery.png"),tooltip:"World Imagery provides one meter or better satellite and aerial imagery in many parts of the world and lower resolution satellite imagery worldwide.  The map includes NASA Blue Marble: Next Generation 500m resolution imagery at small scales (above 1:1,000,000), i-cubed 15m eSAT imagery at medium-to-large scales (down to 1:70,000) for the world, and USGS 15m Landsat imagery for Antarctica. The map features 0.3m resolution imagery in the continental United States and 0.6m resolution imagery in parts of Western Europe from DigitalGlobe. In other parts of the world, 1 meter resolution imagery is available from GeoEye IKONOS, i-cubed Nationwide Prime, Getmapping, AeroGRID, IGN Spain, and IGP Portugal.  Additionally, imagery at different resolutions has been contributed by the GIS User Community.\nhttp://www.esri.com",creationFunction:function(){return new t({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",enablePickFeatures:false})}}));l.push(new s({name:"ESRI World Street Map",iconUrl:e("Widgets/Images/ImageryProviders/esriWorldStreetMap.png"),tooltip:"This worldwide street map presents highway-level data for the world. Street-level data includes the United States; much of Canada; Japan; most countries in Europe; Australia and New Zealand; India; parts of South America including Argentina, Brazil, Chile, Colombia, and Venezuela; Ghana; and parts of southern Africa including Botswana, Lesotho, Namibia, South Africa, and Swaziland.\nhttp://www.esri.com",creationFunction:function(){return new t({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",enablePickFeatures:false})}}));l.push(new s({name:"ESRI National Geographic",iconUrl:e("Widgets/Images/ImageryProviders/esriNationalGeographic.png"),tooltip:"This web map contains the National Geographic World Map service. This map service is designed to be used as a general reference map for informational and educational purposes as well as a basemap by GIS professionals and other users for creating web maps and web mapping applications.\nhttp://www.esri.com",creationFunction:function(){return new t({url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/",enablePickFeatures:false})}}));l.push(new s({name:"Open­Street­Map",iconUrl:e("Widgets/Images/ImageryProviders/openStreetMap.png"),tooltip:"OpenStreetMap (OSM) is a collaborative project to create a free editable map of the world.\nhttp://www.openstreetmap.org",creationFunction:function(){return n({url:"https://a.tile.openstreetmap.org/"})}}));l.push(new s({name:"Stamen Watercolor",iconUrl:e("Widgets/Images/ImageryProviders/stamenWatercolor.png"),tooltip:"Reminiscent of hand drawn maps, Stamen watercolor maps apply raster effect area washes and organic edges over a paper texture to add warm pop to any map.\nhttp://maps.stamen.com",creationFunction:function(){return n({url:"https://stamen-tiles.a.ssl.fastly.net/watercolor/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}}));l.push(new s({name:"Stamen Toner",iconUrl:e("Widgets/Images/ImageryProviders/stamenToner.png"),tooltip:"A high contrast black and white map.\nhttp://maps.stamen.com",creationFunction:function(){return n({url:"https://stamen-tiles.a.ssl.fastly.net/toner/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}}));l.push(new s({name:"The Black Marble",iconUrl:e("Widgets/Images/ImageryProviders/blackMarble.png"),tooltip:"The lights of cities and villages trace the outlines of civilization in this global view of the Earth at night as seen by NASA/NOAA's Suomi NPP satellite.",creationFunction:function(){return a({url:"https://cesiumjs.org/blackmarble",flipXY:true,credit:"Black Marble imagery courtesy NASA Earth Observatory"})}}));l.push(new s({name:"Natural Earth II",iconUrl:e("Widgets/Images/ImageryProviders/naturalEarthII.png"),tooltip:"Natural Earth II, darkened for contrast.\nhttp://www.naturalearthdata.com/",creationFunction:function(){return a({url:e("Assets/Textures/NaturalEarthII")})}}));return l}return l});define("Widgets/BaseLayerPicker/createDefaultTerrainProviderViewModels",["../../Core/buildModuleUrl","../../Core/CesiumTerrainProvider","../../Core/EllipsoidTerrainProvider","../BaseLayerPicker/ProviderViewModel"],function(e,t,r,i){"use strict";function n(){var n=[];n.push(new i({name:"WGS84 Ellipsoid",iconUrl:e("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",creationFunction:function(){return new r}}));n.push(new i({name:"STK World Terrain meshes",iconUrl:e("Widgets/Images/TerrainProviders/STK.png"),tooltip:"High-resolution, mesh-based terrain for the entire globe. Free for use on the Internet. Closed-network options are available.\nhttp://www.agi.com",creationFunction:function(){return new t({url:"https://assets.agi.com/stk-terrain/v1/tilesets/world/tiles",requestWaterMask:true,requestVertexNormals:true})}}));return n}return n});define("Widgets/Cesium3DTilesInspector/Cesium3DTilesInspectorViewModel",["../../Core/Check","../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/ScreenSpaceEventHandler","../../Core/ScreenSpaceEventType","../../Scene/Cesium3DTileColorBlendMode","../../Scene/Cesium3DTileFeature","../../Scene/Cesium3DTileset","../../Scene/Cesium3DTileStyle","../../Scene/PerformanceDisplay","../../ThirdParty/knockout"],function(e,t,r,i,n,a,o,s,l,u,c,d,f){"use strict";function h(e){return function(t){var i=e._scene.pick(t.position);if(r(i)&&i.primitive instanceof u){e.tileset=i.primitive}e.pickActive=false}}function p(e,t){if(t){e._eventHandler.setInputAction(function(t){var i=e._scene.pick(t.endPosition);if(r(i)&&i.primitive instanceof u){e.tileset=i.primitive}},o.MOUSE_MOVE)}else{e._eventHandler.removeInputAction(o.MOUSE_MOVE);e.picking=e.picking}}var m={maximumFractionDigits:3};function v(e){var t=e/1048576;if(t<1){return t.toLocaleString(undefined,m)}return Math.round(t).toLocaleString()}function g(e,t){if(!r(e)){return""}var i=e.statistics;var n='<ul class="cesium-cesiumInspector-statistics">';n+="<li><strong>Visited: </strong>"+i.visited.toLocaleString()+"</li>"+"<li><strong>Selected: </strong>"+e._selectedTiles.length.toLocaleString()+"</li>"+"<li><strong>Commands: </strong>"+i.numberOfCommands.toLocaleString()+"</li>";n+="</ul>";if(!t){n+='<ul class="cesium-cesiumInspector-statistics">';n+="<li><strong>Requests: </strong>"+i.numberOfPendingRequests.toLocaleString()+"</li>"+"<li><strong>Attempted: </strong>"+i.numberOfAttemptedRequests.toLocaleString()+"</li>"+"<li><strong>Processing: </strong>"+i.numberOfTilesProcessing.toLocaleString()+"</li>"+"<li><strong>Content Ready: </strong>"+i.numberOfTilesWithContentReady.toLocaleString()+"</li>"+"<li><strong>Total: </strong>"+i.numberOfTilesTotal.toLocaleString()+"</li>";n+="</ul>";n+='<ul class="cesium-cesiumInspector-statistics">';n+="<li><strong>Features Selected: </strong>"+i.numberOfFeaturesSelected.toLocaleString()+"</li>"+"<li><strong>Features Loaded: </strong>"+i.numberOfFeaturesLoaded.toLocaleString()+"</li>"+"<li><strong>Points Selected: </strong>"+i.numberOfPointsSelected.toLocaleString()+"</li>"+"<li><strong>Points Loaded: </strong>"+i.numberOfPointsLoaded.toLocaleString()+"</li>"+"<li><strong>Triangles Selected: </strong>"+i.numberOfTrianglesSelected.toLocaleString()+"</li>";n+="</ul>";n+='<ul class="cesium-cesiumInspector-statistics">';n+="<li><strong>Tiles styled: </strong>"+i.numberOfTilesStyled.toLocaleString()+"</li>"+"<li><strong>Features styled: </strong>"+i.numberOfFeaturesStyled.toLocaleString()+"</li>";n+="</ul>";n+='<ul class="cesium-cesiumInspector-statistics">';n+="<li><strong>Children Union Culled: </strong>"+i.numberOfTilesCulledWithChildrenUnion.toLocaleString()+"</li>";n+="</ul>";n+='<ul class="cesium-cesiumInspector-statistics">';n+="<li><strong>Geometry Memory (MB): </strong>"+v(i.geometryByteLength)+"</li>"+"<li><strong>Texture Memory (MB): </strong>"+v(i.texturesByteLength)+"</li>"+"<li><strong>Batch Table Memory (MB): </strong>"+v(i.batchTableByteLength)+"</li>";n+="</ul>"}return n}var _=[{text:"Highlight",value:s.HIGHLIGHT},{text:"Replace",value:s.REPLACE},{text:"Mix",value:s.MIX}];var y=new t(1,1,0,.4);var b=new t;var w=new t;function C(t,i){e.typeOf.object("scene",t);e.typeOf.object("performanceContainer",i);var n=this;var u=t.canvas;this._eventHandler=new a(u);this._scene=t;this._performanceContainer=i;this._canvas=u;this._performanceDisplay=new d({container:i});this._statisticsText="";this._pickStatisticsText="";this._editorError="";this.performance=false;this.showStatistics=true;this.showPickStatistics=true;this.inspectorVisible=true;this.tilesetVisible=false;this.displayVisible=false;this.updateVisible=false;this.loggingVisible=false;this.styleVisible=false;this.tileDebugLabelsVisible=false;this.optimizationVisible=false;this.styleString="{}";this._tileset=undefined;this._feature=undefined;this._tile=undefined;f.track(this,["performance","inspectorVisible","_statisticsText","_pickStatisticsText","_editorError","showPickStatistics","showStatistics","tilesetVisible","displayVisible","updateVisible","loggingVisible","styleVisible","optimizationVisible","tileDebugLabelsVisible","styleString","_feature","_tile"]);this._properties=f.observable({});this.properties=[];f.defineProperty(this,"properties",function(){var e=[];var t=n._properties();for(var r in t){if(t.hasOwnProperty(r)){e.push(r)}}return e});var c=f.observable();f.defineProperty(this,"dynamicScreenSpaceError",{get:function(){return c()},set:function(e){c(e);if(r(n._tileset)){n._tileset.dynamicScreenSpaceError=e}}});this.dynamicScreenSpaceError=false;var m=f.observable();f.defineProperty(this,"colorBlendMode",{get:function(){return m()},set:function(e){m(e);if(r(n._tileset)){n._tileset.colorBlendMode=e}}});this.colorBlendMode=s.HIGHLIGHT;var v=f.observable();f.defineProperty(this,"picking",{get:function(){return v()},set:function(e){v(e);if(e){n._eventHandler.setInputAction(function(e){var i=t.pick(e.endPosition);if(i instanceof l){n.feature=i;n.tile=i.content.tile}else if(r(i)&&r(i.content)){n.feature=undefined;n.tile=i.content.tile}else{n.feature=undefined;n.tile=undefined}if(!r(n._tileset)){return}if(S&&r(i)&&r(i.content)){var a;if(t.pickPositionSupported){a=t.pickPosition(e.endPosition);if(r(a)){n._tileset.debugPickPosition=a}}n._tileset.debugPickedTile=i.content.tile}else{n._tileset.debugPickedTile=undefined}},o.MOUSE_MOVE)}else{n.feature=undefined;n.tile=undefined;n._eventHandler.removeInputAction(o.MOUSE_MOVE)}}});this.picking=true;var g=f.observable();f.defineProperty(this,"colorize",{get:function(){return g()},set:function(e){g(e);if(r(n._tileset)){n._tileset.debugColorizeTiles=e}}});this.colorize=false;var _=f.observable();f.defineProperty(this,"wireframe",{get:function(){return _()},set:function(e){_(e);if(r(n._tileset)){n._tileset.debugWireframe=e}}});this.wireframe=false;var y=f.observable();f.defineProperty(this,"showBoundingVolumes",{get:function(){return y()},set:function(e){y(e);if(r(n._tileset)){n._tileset.debugShowBoundingVolume=e}}});this.showBoundingVolumes=false;var b=f.observable();f.defineProperty(this,"showContentBoundingVolumes",{get:function(){return b()},set:function(e){b(e);if(r(n._tileset)){n._tileset.debugShowContentBoundingVolume=e}}});this.showContentBoundingVolumes=false;var w=f.observable();f.defineProperty(this,"showRequestVolumes",{get:function(){return w()},set:function(e){w(e);if(r(n._tileset)){n._tileset.debugShowViewerRequestVolume=e}}});this.showRequestVolumes=false;var C=f.observable();f.defineProperty(this,"freezeFrame",{get:function(){return C()},set:function(e){C(e);if(r(n._tileset)){n._tileset.debugFreezeFrame=e;n._scene.debugShowFrustumPlanes=e}}});this.freezeFrame=false;var S=f.observable();f.defineProperty(this,"showOnlyPickedTileDebugLabel",{get:function(){return S()},set:function(e){S(e);if(r(n._tileset)){n._tileset.debugPickedTileLabelOnly=e}}});this.showOnlyPickedTileDebugLabel=false;var T=f.observable();f.defineProperty(this,"showGeometricError",{get:function(){return T()},set:function(e){T(e);if(r(n._tileset)){n._tileset.debugShowGeometricError=e}}});this.showGeometricError=false;var E=f.observable();f.defineProperty(this,"showRenderingStatistics",{get:function(){return E()},set:function(e){E(e);if(r(n._tileset)){n._tileset.debugShowRenderingStatistics=e}}});this.showRenderingStatistics=false;var x=f.observable();f.defineProperty(this,"showMemoryUsage",{get:function(){return x()},set:function(e){x(e);if(r(n._tileset)){n._tileset.debugShowMemoryUsage=e}}});this.showMemoryUsage=false;var P=f.observable();f.defineProperty(this,"showUrl",{get:function(){return P()},set:function(e){P(e);if(r(n._tileset)){n._tileset.debugShowUrl=e}}});this.showUrl=false;var A=f.observable();f.defineProperty(this,"maximumScreenSpaceError",{get:function(){return A()},set:function(e){e=Number(e);if(!isNaN(e)){A(e);if(r(n._tileset)){n._tileset.maximumScreenSpaceError=e}}}});this.maximumScreenSpaceError=16;var O=f.observable();f.defineProperty(this,"dynamicScreenSpaceErrorDensity",{get:function(){return O()},set:function(e){e=Number(e);if(!isNaN(e)){O(e);if(r(n._tileset)){n._tileset.dynamicScreenSpaceErrorDensity=e}}}});this.dynamicScreenSpaceErrorDensity=.00278;this.dynamicScreenSpaceErrorDensitySliderValue=undefined;f.defineProperty(this,"dynamicScreenSpaceErrorDensitySliderValue",{get:function(){return Math.pow(O(),1/6)},set:function(e){O(Math.pow(e,6))}});var D=f.observable();f.defineProperty(this,"dynamicScreenSpaceErrorFactor",{get:function(){return D()},set:function(e){e=Number(e);if(!isNaN(e)){D(e);if(r(n._tileset)){n._tileset.dynamicScreenSpaceErrorFactor=e}}}});this.dynamicScreenSpaceErrorFactor=4;var I=h(this);var M=f.observable();f.defineProperty(this,"pickActive",{get:function(){return M()},set:function(e){M(e);if(e){n._eventHandler.setInputAction(I,o.LEFT_CLICK)}else{n._eventHandler.removeInputAction(o.LEFT_CLICK)}}});this.pickActive=false;var R=f.observable();f.defineProperty(this,"skipLevelOfDetail",{get:function(){return R()},set:function(e){R(e);if(r(n._tileset)){n._tileset.skipLevelOfDetail=e}}});this.skipLevelOfDetail=true;var L=f.observable();f.defineProperty(this,"skipScreenSpaceErrorFactor",{get:function(){return L()},set:function(e){e=Number(e);if(!isNaN(e)){L(e);if(r(n._tileset)){n._tileset.skipScreenSpaceErrorFactor=e}}}});this.skipScreenSpaceErrorFactor=16;var N=f.observable();f.defineProperty(this,"baseScreenSpaceError",{get:function(){return N()},set:function(e){e=Number(e);if(!isNaN(e)){N(e);if(r(n._tileset)){n._tileset.baseScreenSpaceError=e}}}});this.baseScreenSpaceError=1024;var k=f.observable();f.defineProperty(this,"skipLevels",{get:function(){return k()},set:function(e){e=Number(e);if(!isNaN(e)){k(e);if(r(n._tileset)){n._tileset.skipLevels=e}}}});this.skipLevels=1;var F=f.observable();f.defineProperty(this,"immediatelyLoadDesiredLevelOfDetail",{get:function(){return F()},set:function(e){F(e);if(r(n._tileset)){n._tileset.immediatelyLoadDesiredLevelOfDetail=e}}});this.immediatelyLoadDesiredLevelOfDetail=false;var B=f.observable();f.defineProperty(this,"loadSiblings",{get:function(){B()},set:function(e){B(e);if(r(n._tileset)){n._tileset.loadSiblings=e}}});this.loadSiblings=false;this._style=undefined;this._shouldStyle=false;this._definedProperties=["properties","dynamicScreenSpaceError","colorBlendMode","picking","colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","maximumScreenSpaceError","dynamicScreenSpaceErrorDensity","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevelOfDetail","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","dynamicScreenSpaceErrorDensitySliderValue","dynamicScreenSpaceErrorFactor","pickActive","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl"];this._removePostRenderEvent=t.postRender.addEventListener(function(){n._update()});if(!r(this._tileset)){p(this,true)}}i(C.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},statisticsText:{get:function(){return this._statisticsText}},pickStatisticsText:{get:function(){return this._pickStatisticsText}},colorBlendModes:{get:function(){return _}},editorError:{get:function(){return this._editorError}},tileset:{get:function(){return this._tileset},set:function(e){this._tileset=e;this._style=undefined;this.styleString="{}";this.feature=undefined;this.tile=undefined;if(r(e)){var t=this;e.readyPromise.then(function(e){if(!t.isDestroyed()){t._properties(e.properties)}});var i=["colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl"];var n=i.length;for(var a=0;a<n;++a){var o=i[a];this[o]=this[o]}this.maximumScreenSpaceError=e.maximumScreenSpaceError;this.dynamicScreenSpaceError=e.dynamicScreenSpaceError;this.dynamicScreenSpaceErrorDensity=e.dynamicScreenSpaceErrorDensity;this.dynamicScreenSpaceErrorFactor=e.dynamicScreenSpaceErrorFactor;this.colorBlendMode=e.colorBlendMode;this.skipLevelOfDetail=e.skipLevelOfDetail;this.skipScreenSpaceErrorFactor=e.skipScreenSpaceErrorFactor;this.baseScreenSpaceError=e.baseScreenSpaceError;this.skipLevels=e.skipLevels;this.immediatelyLoadDesiredLevelOfDetail=e.immediatelyLoadDesiredLevelOfDetail;this.loadSiblings=e.loadSiblings}else{this._properties({})}this._statisticsText=g(e,false);this._pickStatisticsText=g(e,true);p(this,false)}},feature:{get:function(){return this._feature},set:function(e){if(this._feature===e){return}var i=this._feature;if(r(i)&&!i.content.isDestroyed()){var n=this._scene.frameState;if(!this.colorize&&r(this._style)){i.color=r(this._style.color)?this._style.color.evaluateColor(n,i,b):t.WHITE}else{i.color=w}}if(r(e)){t.clone(e.color,w);e.color=y}this._feature=e}},tile:{get:function(){return this._tile},set:function(e){if(this._tile===e){return}var i=this._tile;if(r(i)&&!i.isDestroyed()&&!S(i.content)){i.color=w}if(r(e)&&!S(e.content)){t.clone(e.color,w);e.color=y}this._tile=e}}});function S(e){if(e.featuresLength>0){return true}var t=e.innerContents;if(r(t)){var i=t.length;for(var n=0;n<i;++n){if(!S(t[n])){return false}}return true}return false}C.prototype.togglePickTileset=function(){this.pickActive=!this.pickActive};C.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible};C.prototype.toggleTileset=function(){this.tilesetVisible=!this.tilesetVisible};C.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible};C.prototype.toggleUpdate=function(){this.updateVisible=!this.updateVisible};C.prototype.toggleLogging=function(){this.loggingVisible=!this.loggingVisible};C.prototype.toggleStyle=function(){this.styleVisible=!this.styleVisible};C.prototype.toggleTileDebugLabels=function(){this.tileDebugLabelsVisible=!this.tileDebugLabelsVisible};C.prototype.toggleOptimization=function(){this.optimizationVisible=!this.optimizationVisible};C.prototype.trimTilesCache=function(){if(r(this._tileset)){this._tileset.trimLoadedTiles()}};C.prototype.compileStyle=function(){var e=this._tileset;if(!r(e)||this.styleString===JSON.stringify(e.style)){return}this._editorError="";try{if(this.styleString.length===0){this.styleString="{}"}this._style=new c(JSON.parse(this.styleString));this._shouldStyle=true}catch(e){this._editorError=e.toString()}this.feature=this._feature;this.tile=this._tile};C.prototype.styleEditorKeyPress=function(e,t){if(t.keyCode===9){t.preventDefault();var r=t.target;var i=r.selectionStart;var n=r.selectionEnd;var a=n;var o=r.value.slice(i,n);var s=o.split("\n");var l=s.length;var u;if(!t.shiftKey){for(u=0;u<l;++u){s[u]="  "+s[u];a+=2}}else{for(u=0;u<l;++u){if(s[u][0]===" "){if(s[u][1]===" "){s[u]=s[u].substr(2);a-=2}else{s[u]=s[u].substr(1);a-=1}}}}var c=s.join("\n");r.value=r.value.slice(0,i)+c+r.value.slice(n);r.selectionStart=i!==n?i:a;r.selectionEnd=a}else if(t.ctrlKey&&(t.keyCode===10||t.keyCode===13)){this.compileStyle()}return true};C.prototype._update=function(){var e=this._tileset;if(this.performance){this._performanceDisplay.update()}if(r(e)){if(e.isDestroyed()){this.tile=undefined;this.feature=undefined;this.tileset=undefined;return}var t=e.style;if(this._style!==e.style){if(this._shouldStyle){e.style=this._style;this._shouldStyle=false}else{this._style=t;this.styleString=JSON.stringify(t.style,null,"  ")}}}if(this.showStatistics){this._statisticsText=g(e,false);this._pickStatisticsText=g(e,true)}};C.prototype.isDestroyed=function(){return false};C.prototype.destroy=function(){this._eventHandler.destroy();this._removePostRenderEvent();var e=this;this._definedProperties.forEach(function(t){f.getObservable(e,t).dispose()});return n(this)};C.getStatistics=g;return C});define("Widgets/Cesium3DTilesInspector/Cesium3DTilesInspector",["../../Core/Check","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../ThirdParty/knockout","../getElement","./Cesium3DTilesInspectorViewModel"],function(e,t,r,i,n,a,o,s){"use strict";function l(t,r){e.defined("container",t);e.typeOf.object("scene",r);t=o(t);var i=document.createElement("div");var n=document.createElement("div");n.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : performance, "cesium-cesiumInspector-hide" : !performance}');var l=new s(r,n);this._viewModel=l;this._container=t;this._element=i;var h=document.createElement("div");h.textContent="3D Tiles Inspector";h.className="cesium-cesiumInspector-button";h.setAttribute("data-bind","click: toggleInspector");i.appendChild(h);i.className="cesium-cesiumInspector cesium-3DTilesInspector";i.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}');t.appendChild(i);var p=document.createElement("div");var m=document.createElement("div");var v=document.createElement("div");var g=document.createElement("div");var _=document.createElement("div");var y=document.createElement("div");var b=document.createElement("div");var w=document.createElement("div");w.className="field-group";var C=document.createElement("label");C.className="field-label";C.appendChild(document.createTextNode("Properties: "));var S=document.createElement("div");S.setAttribute("data-bind","text: properties");w.appendChild(C);w.appendChild(S);p.appendChild(w);p.appendChild(f("togglePickTileset","Pick Tileset","pickActive"));p.appendChild(f("trimTilesCache","Trim Tiles Cache"));p.appendChild(c("picking","Enable Picking"));m.appendChild(c("colorize","Colorize"));m.appendChild(c("wireframe","Wireframe"));m.appendChild(c("showBoundingVolumes","Bounding Volumes"));m.appendChild(c("showContentBoundingVolumes","Content Volumes"));m.appendChild(c("showRequestVolumes","Request Volumes"));v.appendChild(c("freezeFrame","Freeze Frame"));v.appendChild(c("dynamicScreenSpaceError","Dynamic Screen Space Error"));var T=document.createElement("div");T.appendChild(d("maximumScreenSpaceError",0,128,1,"Maximum Screen Space Error"));v.appendChild(T);var E=document.createElement("div");E.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : dynamicScreenSpaceError, "cesium-cesiumInspector-hide" : !dynamicScreenSpaceError}');E.appendChild(d("dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"Screen Space Error Density","dynamicScreenSpaceErrorDensity"));E.appendChild(d("dynamicScreenSpaceErrorFactor",1,10,.1,"Screen Space Error Factor"));v.appendChild(E);g.appendChild(c("performance","Performance"));g.appendChild(n);g.appendChild(c("showStatistics","Statistics"));var x=document.createElement("div");x.className="cesium-3dTilesInspector-statistics";x.setAttribute("data-bind","html: statisticsText, visible: showStatistics");g.appendChild(x);g.appendChild(c("showPickStatistics","Pick Statistics"));var P=document.createElement("div");P.className="cesium-3dTilesInspector-statistics";P.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics");g.appendChild(P);y.appendChild(document.createTextNode("Color Blend Mode: "));var A=document.createElement("select");A.setAttribute("data-bind","options: colorBlendModes, "+'optionsText: "text", '+'optionsValue: "value", '+"value: colorBlendMode");y.appendChild(A);var O=document.createElement("textarea");O.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }");y.className="cesium-cesiumInspector-styleEditor";y.appendChild(O);var D=f("compileStyle","Compile (Ctrl+Enter)");y.appendChild(D);var I=document.createElement("div");I.className="cesium-cesiumInspector-error";I.setAttribute("data-bind","text: editorError");y.appendChild(I);_.appendChild(c("showOnlyPickedTileDebugLabel","Show Picked Only"));_.appendChild(c("showGeometricError","Geometric Error"));_.appendChild(c("showRenderingStatistics","Rendering Statistics"));_.appendChild(c("showMemoryUsage","Memory Usage (MB)"));_.appendChild(c("showUrl","Url"));b.appendChild(c("skipLevelOfDetail","Skip Tile LODs"));var M=document.createElement("div");M.appendChild(d("skipScreenSpaceErrorFactor",1,50,1,"Skip SSE Factor"));b.appendChild(M);var R=document.createElement("div");R.appendChild(d("baseScreenSpaceError",0,4096,1,"SSE before skipping LOD"));b.appendChild(R);var L=document.createElement("div");L.appendChild(d("skipLevels",0,10,1,"Min. levels to skip"));b.appendChild(L);b.appendChild(c("immediatelyLoadDesiredLevelOfDetail","Load only tiles that meet the max. SSE."));b.appendChild(c("loadSiblings","Load siblings of visible tiles."));var N=u("Tileset","tilesetVisible","toggleTileset",p);var k=u("Display","displayVisible","toggleDisplay",m);var F=u("Update","updateVisible","toggleUpdate",v);var B=u("Logging","loggingVisible","toggleLogging",g);var U=u("Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels",_);var V=u("Style","styleVisible","toggleStyle",y);var z=u("Optimization","optimizationVisible","toggleOptimization",b);i.appendChild(N);i.appendChild(k);i.appendChild(F);i.appendChild(B);i.appendChild(U);i.appendChild(V);i.appendChild(z);a.applyBindings(l,i)}i(l.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){a.cleanNode(this._element);this._container.removeChild(this._element);this.viewModel.destroy();return n(this)};function u(e,t,r,i){var n=document.createElement("span");n.className="cesium-cesiumInspector-toggleSwitch";n.setAttribute("data-bind","text: "+t+' ? "-" : "+", click: '+r);var a=document.createElement("div");a.className="cesium-cesiumInspector-sectionHeader";a.appendChild(n);a.appendChild(document.createTextNode(e));var o=document.createElement("div");o.className="cesium-cesiumInspector-section";o.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : '+t+', "cesium-cesiumInspector-hide" : !'+t+"}");o.appendChild(i);var s=document.createElement("div");s.className="cesium-cesiumInspector-dropDown";s.appendChild(a);s.appendChild(o);return s}function c(e,t){var r=document.createElement("input");r.type="checkbox";r.setAttribute("data-bind","checked: "+e);var i=document.createElement("div");i.appendChild(r);i.appendChild(document.createTextNode(t));return i}function d(e,r,i,n,a,o){o=t(o,e);var s=document.createElement("input");s.setAttribute("data-bind","value: "+o);s.type="number";var l=document.createElement("input");l.type="range";l.min=r;l.max=i;l.step=n;l.setAttribute("data-bind",'valueUpdate: "input", value: '+e);var u=document.createElement("div");u.appendChild(l);var c=document.createElement("div");c.className="cesium-cesiumInspector-slider";c.appendChild(document.createTextNode(a));c.appendChild(s);c.appendChild(u);return c}function f(e,t,i){var n=document.createElement("button");n.type="button";n.textContent=t;n.className="cesium-cesiumInspector-pickButton";var a="click: "+e;if(r(i)){a+=', css: {"cesium-cesiumInspector-pickButtonHighlight" : '+i+"}"}n.setAttribute("data-bind",a);return n}return l});define("Widgets/CesiumInspector/CesiumInspectorViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Rectangle","../../Core/ScreenSpaceEventHandler","../../Core/ScreenSpaceEventType","../../Scene/DebugModelMatrixPrimitive","../../Scene/PerformanceDisplay","../../Scene/TileCoordinatesImageryProvider","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(t){var r;if(e(t)){r="Command Statistics";var i=t.commandsInFrustums;for(var n in i){if(i.hasOwnProperty(n)){var a=parseInt(n,10);var o;if(a===7){o="1, 2 and 3"}else{var s=[];for(var l=2;l>=0;l--){var u=Math.pow(2,l);if(a>=u){s.push(l+1);a-=u}}o=s.reverse().join(" and ")}r+="<br>&nbsp;&nbsp;&nbsp;&nbsp;"+i[n]+" in frustum "+o}}r+="<br>Total: "+t.totalCommands}return r}function h(e,t,r){var i=Math.min(r,t);i=Math.max(i,e);return i}function p(t,r){if(!e(t)){throw new i("scene is required")}if(!e(r)){throw new i("performanceContainer is required")}var f=this;var p=t.canvas;var m=new a(p);this._eventHandler=m;this._scene=t;this._canvas=p;this._primitive=undefined;this._tile=undefined;this._modelMatrixPrimitive=undefined;this._performanceDisplay=undefined;this._performanceContainer=r;var v=this._scene.globe;v.depthTestAgainstTerrain=true;this.frustums=false;this.frustumPlanes=false;this.performance=false;this.shaderCacheText="";this.primitiveBoundingSphere=false;this.primitiveReferenceFrame=false;this.filterPrimitive=false;this.tileBoundingSphere=false;this.filterTile=false;this.wireframe=false;this.globeDepth=false;this.pickDepth=false;this.depthFrustum=1;this._numberOfFrustums=1;this.suspendUpdates=false;this.tileCoordinates=false;this.frustumStatisticText=false;this.tileText="";this.hasPickedPrimitive=false;this.hasPickedTile=false;this.pickPrimitiveActive=false;this.pickTileActive=false;this.dropDownVisible=true;this.generalVisible=true;this.primitivesVisible=false;this.terrainVisible=false;this.depthFrustumText="";this.generalSwitchText=c.pureComputed(function(){return f.generalVisible?"-":"+"});this.primitivesSwitchText=c.pureComputed(function(){return f.primitivesVisible?"-":"+"});this.terrainSwitchText=c.pureComputed(function(){return f.terrainVisible?"-":"+"});c.track(this,["frustums","frustumPlanes","performance","shaderCacheText","primitiveBoundingSphere","primitiveReferenceFrame","filterPrimitive","tileBoundingSphere","filterTile","wireframe","globeDepth","pickDepth","depthFrustum","suspendUpdates","tileCoordinates","frustumStatisticText","tileText","hasPickedPrimitive","hasPickedTile","pickPrimitiveActive","pickTileActive","dropDownVisible","generalVisible","primitivesVisible","terrainVisible","depthFrustumText"]);this._toggleDropDown=d(function(){f.dropDownVisible=!f.dropDownVisible});this._toggleGeneral=d(function(){f.generalVisible=!f.generalVisible});this._togglePrimitives=d(function(){f.primitivesVisible=!f.primitivesVisible});this._toggleTerrain=d(function(){f.terrainVisible=!f.terrainVisible});this._frustumsSubscription=c.getObservable(this,"frustums").subscribe(function(e){f._scene.debugShowFrustums=e});this._frustumPlanesSubscription=c.getObservable(this,"frustumPlanes").subscribe(function(e){f._scene.debugShowFrustumPlanes=e});this._performanceSubscription=c.getObservable(this,"performance").subscribe(function(e){if(e){f._performanceDisplay=new l({container:f._performanceContainer})}else{f._performanceContainer.innerHTML=""}});this._showPrimitiveBoundingSphere=d(function(){f._primitive.debugShowBoundingVolume=f.primitiveBoundingSphere;return true});this._primitiveBoundingSphereSubscription=c.getObservable(this,"primitiveBoundingSphere").subscribe(function(){f._showPrimitiveBoundingSphere()});this._showPrimitiveReferenceFrame=d(function(){if(f.primitiveReferenceFrame){var t=f._primitive.modelMatrix;f._modelMatrixPrimitive=new s({modelMatrix:t});f._scene.primitives.add(f._modelMatrixPrimitive)}else if(e(f._modelMatrixPrimitive)){f._scene.primitives.remove(f._modelMatrixPrimitive);f._modelMatrixPrimitive=undefined}return true});this._primitiveReferenceFrameSubscription=c.getObservable(this,"primitiveReferenceFrame").subscribe(function(){f._showPrimitiveReferenceFrame()});this._doFilterPrimitive=d(function(){if(f.filterPrimitive){f._scene.debugCommandFilter=function(t){if(e(f._modelMatrixPrimitive)&&t.owner===f._modelMatrixPrimitive._primitive){return true}else if(e(f._primitive)){return t.owner===f._primitive||t.owner===f._primitive._billboardCollection||t.owner.primitive===f._primitive}return false}}else{f._scene.debugCommandFilter=undefined}return true});this._filterPrimitiveSubscription=c.getObservable(this,"filterPrimitive").subscribe(function(){f._doFilterPrimitive()});this._wireframeSubscription=c.getObservable(this,"wireframe").subscribe(function(e){v._surface.tileProvider._debug.wireframe=e});this._globeDepthSubscription=c.getObservable(this,"globeDepth").subscribe(function(e){f._scene.debugShowGlobeDepth=e});this._pickDepthSubscription=c.getObservable(this,"pickDepth").subscribe(function(e){f._scene.debugShowPickDepth=e});this._depthFrustumSubscription=c.getObservable(this,"depthFrustum").subscribe(function(e){f.scene.debugShowDepthFrustum=e});this._incrementDepthFrustum=d(function(){var e=f.depthFrustum+1;f.depthFrustum=h(1,f._numberOfFrustums,e);return true});this._decrementDepthFrustum=d(function(){var e=f.depthFrustum-1;f.depthFrustum=h(1,f._numberOfFrustums,e);return true});this._suspendUpdatesSubscription=c.getObservable(this,"suspendUpdates").subscribe(function(e){v._surface._debug.suspendLodUpdate=e;if(!e){f.filterTile=false}});var g;this._showTileCoordinates=d(function(){if(f.tileCoordinates&&!e(g)){g=t.imageryLayers.addImageryProvider(new u({tilingScheme:t.terrainProvider.tilingScheme}))}else if(!f.tileCoordinates&&e(g)){t.imageryLayers.remove(g);g=undefined}return true});this._tileCoordinatesSubscription=c.getObservable(this,"tileCoordinates").subscribe(function(){f._showTileCoordinates()});this._tileBoundingSphereSubscription=c.getObservable(this,"tileBoundingSphere").subscribe(function(){f._showTileBoundingSphere()});this._showTileBoundingSphere=d(function(){if(f.tileBoundingSphere){v._surface.tileProvider._debug.boundingSphereTile=f._tile}else{v._surface.tileProvider._debug.boundingSphereTile=undefined}return true});this._doFilterTile=d(function(){if(!f.filterTile){f.suspendUpdates=false}else{f.suspendUpdates=true;v._surface._tilesToRender=[];if(e(f._tile)&&f._tile.renderable){v._surface._tilesToRender.push(f._tile)}}return true});this._filterTileSubscription=c.getObservable(this,"filterTile").subscribe(function(){f.doFilterTile()});function _(t){var r=f._scene.pick({x:t.position.x,y:t.position.y});if(e(r)){f.primitive=e(r.collection)?r.collection:r.primitive}f.pickPrimitiveActive=false}this._pickPrimitive=d(function(){f.pickPrimitiveActive=!f.pickPrimitiveActive});this._pickPrimitiveActiveSubscription=c.getObservable(this,"pickPrimitiveActive").subscribe(function(e){if(e){m.setInputAction(_,o.LEFT_CLICK)}else{m.removeInputAction(o.LEFT_CLICK)}});function y(t){var r;var i=v.ellipsoid;var a=f._scene.camera.pickEllipsoid({x:t.position.x,y:t.position.y},i);if(e(a)){var o=i.cartesianToCartographic(a);var s=v._surface.tileProvider._tilesToRenderByTextureCount;for(var l=0;!r&&l<s.length;++l){var u=s[l];if(!e(u)){continue}for(var c=0;!r&&c<u.length;++c){var d=u[c];if(n.contains(d.rectangle,o)){r=d}}}}f.tile=r;f.pickTileActive=false}this._pickTile=d(function(){f.pickTileActive=!f.pickTileActive});this._pickTileActiveSubscription=c.getObservable(this,"pickTileActive").subscribe(function(e){if(e){m.setInputAction(y,o.LEFT_CLICK)}else{m.removeInputAction(o.LEFT_CLICK)}});this._removePostRenderEvent=t.postRender.addEventListener(function(){f._update()})}t(p.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},toggleDropDown:{get:function(){return this._toggleDropDown}},showPrimitiveBoundingSphere:{get:function(){return this._showPrimitiveBoundingSphere}},showPrimitiveReferenceFrame:{get:function(){return this._showPrimitiveReferenceFrame}},doFilterPrimitive:{get:function(){return this._doFilterPrimitive}},incrementDepthFrustum:{get:function(){return this._incrementDepthFrustum}},decrementDepthFrustum:{get:function(){return this._decrementDepthFrustum}},showTileCoordinates:{get:function(){return this._showTileCoordinates}},showTileBoundingSphere:{get:function(){return this._showTileBoundingSphere}},doFilterTile:{get:function(){return this._doFilterTile}},toggleGeneral:{get:function(){return this._toggleGeneral}},togglePrimitives:{get:function(){return this._togglePrimitives}},toggleTerrain:{get:function(){return this._toggleTerrain}},pickPrimitive:{get:function(){return this._pickPrimitive}},pickTile:{get:function(){return this._pickTile}},selectParent:{get:function(){var e=this;return d(function(){e.tile=e.tile.parent})}},selectNW:{get:function(){var e=this;return d(function(){e.tile=e.tile.northwestChild})}},selectNE:{get:function(){var e=this;return d(function(){e.tile=e.tile.northeastChild})}},selectSW:{get:function(){var e=this;return d(function(){e.tile=e.tile.southwestChild})}},selectSE:{get:function(){var e=this;return d(function(){e.tile=e.tile.southeastChild})}},primitive:{get:function(){return this._primitive},set:function(t){var r=this._primitive;if(t!==r){this.hasPickedPrimitive=true;if(e(r)){r.debugShowBoundingVolume=false}this._scene.debugCommandFilter=undefined;if(e(this._modelMatrixPrimitive)){this._scene.primitives.remove(this._modelMatrixPrimitive);this._modelMatrixPrimitive=undefined}this._primitive=t;t.show=false;setTimeout(function(){t.show=true},50);this.showPrimitiveBoundingSphere();this.showPrimitiveReferenceFrame();this.doFilterPrimitive()}}},tile:{get:function(){return this._tile},set:function(t){if(e(t)){this.hasPickedTile=true;var r=this._tile;if(t!==r){this.tileText="L: "+t.level+" X: "+t.x+" Y: "+t.y;this.tileText+="<br>SW corner: "+t.rectangle.west+", "+t.rectangle.south;this.tileText+="<br>NE corner: "+t.rectangle.east+", "+t.rectangle.north;var i=t.data;if(e(i)){this.tileText+="<br>Min: "+i.minimumHeight+" Max: "+i.maximumHeight}else{this.tileText+="<br>(Tile is not loaded)"}}this._tile=t;this.showTileBoundingSphere();this.doFilterTile()}else{this.hasPickedTile=false;this._tile=undefined}}}});p.prototype._update=function(){if(this.frustums){this.frustumStatisticText=f(this._scene.debugFrustumStatistics)}var e=this._scene.numberOfFrustums;this._numberOfFrustums=e;this.depthFrustum=h(1,e,this.depthFrustum);this.depthFrustumText=this.depthFrustum+" of "+e;if(this.performance){this._performanceDisplay.update()}if(this.primitiveReferenceFrame){this._modelMatrixPrimitive.modelMatrix=this._primitive.modelMatrix}this.shaderCacheText="Cached shaders: "+this._scene.context.shaderCache.numberOfShaders};p.prototype.isDestroyed=function(){return false};p.prototype.destroy=function(){this._eventHandler.destroy();this._removePostRenderEvent();this._frustumsSubscription.dispose();this._frustumPlanesSubscription.dispose();this._performanceSubscription.dispose();this._primitiveBoundingSphereSubscription.dispose();this._primitiveReferenceFrameSubscription.dispose();this._filterPrimitiveSubscription.dispose();this._wireframeSubscription.dispose();this._globeDepthSubscription.dispose();this._pickDepthSubscription.dispose();this._depthFrustumSubscription.dispose();this._suspendUpdatesSubscription.dispose();this._tileCoordinatesSubscription.dispose();this._tileBoundingSphereSubscription.dispose();this._filterTileSubscription.dispose();this._pickPrimitiveActiveSubscription.dispose();this._pickTileActiveSubscription.dispose();return r(this)};return p});define("Widgets/CesiumInspector/CesiumInspector",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./CesiumInspectorViewModel"],function(e,t,r,i,n,a,o){"use strict";function s(t,r){if(!e(t)){throw new i("container is required.")}if(!e(r)){throw new i("scene is required.")}t=a(t);var s=document.createElement("div");var l=new o(r,s);this._viewModel=l;this._container=t;var u=document.createElement("div");this._element=u;var c=document.createElement("div");c.textContent="Cesium Inspector";c.className="cesium-cesiumInspector-button";c.setAttribute("data-bind","click: toggleDropDown");u.appendChild(c);u.className="cesium-cesiumInspector";u.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : dropDownVisible, "cesium-cesiumInspector-hidden" : !dropDownVisible }');t.appendChild(this._element);var d=document.createElement("div");this._panel=d;d.className="cesium-cesiumInspector-dropDown";u.appendChild(d);var f=document.createElement("div");f.className="cesium-cesiumInspector-sectionHeader";var h=document.createElement("span");h.className="cesium-cesiumInspector-toggleSwitch";h.setAttribute("data-bind","click: toggleGeneral, text: generalSwitchText");f.appendChild(h);f.appendChild(document.createTextNode("General"));d.appendChild(f);var p=document.createElement("div");p.className="cesium-cesiumInspector-section";p.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : generalVisible, "cesium-cesiumInspector-hide" : !generalVisible}');d.appendChild(p);var m=document.createElement("div");p.appendChild(m);var v=document.createElement("div");v.className="cesium-cesiumInspector-frustumStatistics";v.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : frustums, "cesium-cesiumInspector-hide" :  !frustums}, html: frustumStatisticText');var g=document.createElement("input");g.type="checkbox";g.setAttribute("data-bind","checked: frustums");m.appendChild(g);m.appendChild(document.createTextNode("Show Frustums"));m.appendChild(v);var _=document.createElement("div");p.appendChild(_);var y=document.createElement("input");y.type="checkbox";y.setAttribute("data-bind","checked: frustumPlanes");_.appendChild(y);_.appendChild(document.createTextNode("Show Frustum Planes"));var b=document.createElement("div");p.appendChild(b);var w=document.createElement("input");w.type="checkbox";w.setAttribute("data-bind","checked: performance");b.appendChild(w);b.appendChild(document.createTextNode("Performance Display"));s.className="cesium-cesiumInspector-performanceDisplay";p.appendChild(s);var C=document.createElement("div");C.className="cesium-cesiumInspector-shaderCache";C.setAttribute("data-bind","html: shaderCacheText");p.appendChild(C);var S=document.createElement("div");p.appendChild(S);var T=document.createElement("input");T.type="checkbox";T.setAttribute("data-bind","checked: globeDepth");S.appendChild(T);S.appendChild(document.createTextNode("Show globe depth"));var E=document.createElement("div");S.appendChild(E);var x=document.createElement("div");p.appendChild(x);var P=document.createElement("input");P.type="checkbox";P.setAttribute("data-bind","checked: pickDepth");x.appendChild(P);x.appendChild(document.createTextNode("Show pick depth"));var A=document.createElement("div");p.appendChild(A);var O=document.createElement("span");O.setAttribute("data-bind",'html: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frustum:"');A.appendChild(O);var D=document.createElement("span");D.setAttribute("data-bind","text: depthFrustumText");A.appendChild(D);var I=document.createElement("input");I.type="button";I.value="-";I.className="cesium-cesiumInspector-pickButton";I.setAttribute("data-bind","click: decrementDepthFrustum");A.appendChild(I);var M=document.createElement("input");M.type="button";M.value="+";M.className="cesium-cesiumInspector-pickButton";M.setAttribute("data-bind","click: incrementDepthFrustum");A.appendChild(M);var R=document.createElement("div");R.className="cesium-cesiumInspector-sectionHeader";h=document.createElement("span");h.className="cesium-cesiumInspector-toggleSwitch";h.setAttribute("data-bind","click: togglePrimitives, text: primitivesSwitchText");R.appendChild(h);R.appendChild(document.createTextNode("Primitives"));d.appendChild(R);var L=document.createElement("div");L.className="cesium-cesiumInspector-section";L.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : primitivesVisible, "cesium-cesiumInspector-hide" : !primitivesVisible}');d.appendChild(L);var N=document.createElement("div");N.className="cesium-cesiumInspector-pickSection";L.appendChild(N);var k=document.createElement("input");k.type="button";k.value="Pick a primitive";k.className="cesium-cesiumInspector-pickButton";k.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickPrimitiveActive}, click: pickPrimitive');var F=document.createElement("div");F.className="cesium-cesiumInspector-center";F.appendChild(k);N.appendChild(F);var B=document.createElement("div");N.appendChild(B);var U=document.createElement("input");U.type="checkbox";U.setAttribute("data-bind","checked: primitiveBoundingSphere, enable: hasPickedPrimitive");B.appendChild(U);B.appendChild(document.createTextNode("Show bounding sphere"));var V=document.createElement("div");N.appendChild(V);var z=document.createElement("input");z.type="checkbox";z.setAttribute("data-bind","checked: primitiveReferenceFrame, enable: hasPickedPrimitive");V.appendChild(z);V.appendChild(document.createTextNode("Show reference frame"));var q=document.createElement("div");this._primitiveOnly=q;N.appendChild(q);var G=document.createElement("input");G.type="checkbox";G.setAttribute("data-bind","checked: filterPrimitive, enable: hasPickedPrimitive");q.appendChild(G);q.appendChild(document.createTextNode("Show only selected"));var H=document.createElement("div");H.className="cesium-cesiumInspector-sectionHeader";h=document.createElement("span");h.className="cesium-cesiumInspector-toggleSwitch";h.setAttribute("data-bind","click: toggleTerrain, text: terrainSwitchText");H.appendChild(h);H.appendChild(document.createTextNode("Terrain"));d.appendChild(H);var j=document.createElement("div");j.className="cesium-cesiumInspector-section";j.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : terrainVisible, "cesium-cesiumInspector-hide" :  !terrainVisible}');d.appendChild(j);var W=document.createElement("div");W.className="cesium-cesiumInspector-pickSection";j.appendChild(W);var Y=document.createElement("input");Y.type="button";Y.value="Pick a tile";Y.className="cesium-cesiumInspector-pickButton";Y.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickTileActive}, click: pickTile');F=document.createElement("div");F.appendChild(Y);F.className="cesium-cesiumInspector-center";W.appendChild(F);var X=document.createElement("div");W.appendChild(X);var Q=document.createElement("input");Q.type="button";Q.value="Parent";Q.className="cesium-cesiumInspector-pickButton";Q.setAttribute("data-bind","click: selectParent");var Z=document.createElement("input");Z.type="button";Z.value="NW";Z.className="cesium-cesiumInspector-pickButton";Z.setAttribute("data-bind","click: selectNW");var K=document.createElement("input");K.type="button";K.value="NE";K.className="cesium-cesiumInspector-pickButton";K.setAttribute("data-bind","click: selectNE");var J=document.createElement("input");J.type="button";J.value="SW";J.className="cesium-cesiumInspector-pickButton";J.setAttribute("data-bind","click: selectSW");var $=document.createElement("input");$.type="button";$.value="SE";$.className="cesium-cesiumInspector-pickButton";$.setAttribute("data-bind","click: selectSE");var ee=document.createElement("div");ee.className="cesium-cesiumInspector-tileText";X.className="cesium-cesiumInspector-frustumStatistics";X.appendChild(ee);X.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : hasPickedTile, "cesium-cesiumInspector-hide" :  !hasPickedTile}');ee.setAttribute("data-bind","html: tileText");var te=document.createElement("div");te.className="cesium-cesiumInspector-relativeText";te.textContent="Select relative:";X.appendChild(te);var re=document.createElement("table");var ie=document.createElement("tr");var ne=document.createElement("tr");var ae=document.createElement("td");ae.appendChild(Q);var oe=document.createElement("td");oe.appendChild(Z);var se=document.createElement("td");se.appendChild(K);ie.appendChild(ae);ie.appendChild(oe);ie.appendChild(se);var le=document.createElement("td");var ue=document.createElement("td");ue.appendChild(J);var ce=document.createElement("td");ce.appendChild($);ne.appendChild(le);ne.appendChild(ue);ne.appendChild(ce);re.appendChild(ie);re.appendChild(ne);X.appendChild(re);var de=document.createElement("div");W.appendChild(de);var fe=document.createElement("input");fe.type="checkbox";fe.setAttribute("data-bind","checked: tileBoundingSphere, enable: hasPickedTile");de.appendChild(fe);de.appendChild(document.createTextNode("Show bounding volume"));var he=document.createElement("div");W.appendChild(he);var pe=document.createElement("input");pe.type="checkbox";pe.setAttribute("data-bind","checked: filterTile, enable: hasPickedTile");he.appendChild(pe);he.appendChild(document.createTextNode("Show only selected"));var me=document.createElement("div");j.appendChild(me);var ve=document.createElement("input");ve.type="checkbox";ve.setAttribute("data-bind","checked: wireframe");me.appendChild(ve);me.appendChild(document.createTextNode("Wireframe"));var ge=document.createElement("div");j.appendChild(ge);var _e=document.createElement("input");_e.type="checkbox";_e.setAttribute("data-bind","checked: suspendUpdates");ge.appendChild(_e);ge.appendChild(document.createTextNode("Suspend LOD update"));var ye=document.createElement("div");j.appendChild(ye);var be=document.createElement("input");be.type="checkbox";be.setAttribute("data-bind","checked: tileCoordinates");ye.appendChild(be);ye.appendChild(document.createTextNode("Show tile coordinates"));n.applyBindings(l,this._element)}t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){n.cleanNode(this._element);this._container.removeChild(this._element);this.viewModel.destroy();return r(this)};return s});define("Widgets/CesiumWidget/CesiumWidget",["../../Core/buildModuleUrl","../../Core/Cartesian3","../../Core/Clock","../../Core/Credit","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Ellipsoid","../../Core/FeatureDetection","../../Core/formatError","../../Core/requestAnimationFrame","../../Core/ScreenSpaceEventHandler","../../Scene/BingMapsImageryProvider","../../Scene/Globe","../../Scene/Moon","../../Scene/Scene","../../Scene/SceneMode","../../Scene/ShadowMode","../../Scene/SkyAtmosphere","../../Scene/SkyBox","../../Scene/Sun","../getElement"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S){"use strict";function T(t){return e("Assets/Textures/SkyBox/tycho2t3_80_"+t+".jpg")}function E(e){e._renderLoopRunning=true;var t=0;function r(i){if(e.isDestroyed()){return}if(e._useDefaultRenderLoop){try{var n=e._targetFrameRate;if(!a(n)){e.resize();e.render();f(r)}else{var o=1e3/n;var s=i-t;if(s>o){e.resize();e.render();t=i-s%o}f(r)}}catch(t){e._useDefaultRenderLoop=false;e._renderLoopRunning=false;if(e._showRenderLoopErrors){var l="An error occurred while rendering.  Rendering has stopped.";e.showErrorPanel(l,undefined,t)}}}else{e._renderLoopRunning=false}}f(r)}function x(e){var t=e._canvas;var r=t.clientWidth;var i=t.clientHeight;var a=e._resolutionScale;if(!e._supportsImageRenderingPixelated){a*=n(window.devicePixelRatio,1)}e._canvasWidth=r;e._canvasHeight=i;r*=a;i*=a;t.width=r;t.height=i;e._canRender=r!==0&&i!==0}function P(e){var t=e._canvas;var r=t.width;var i=t.height;if(r!==0&&i!==0){var n=e._scene.camera.frustum;if(a(n.aspectRatio)){n.aspectRatio=r/i}else{n.top=n.right*(i/r);n.bottom=-n.top}}}var A="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAAAeCAYAAAD5AOomAAAQWUlEQVR42u1beXxOxxpudrEktkbUkriI4lZpq5JbW6pJuFG0qrFeexVRak3TBm3RUgS1hFhrCdKgQWKLrUGQBiVBJMgiq0Qiuyxzn/fzTu74ZPnS9nfrj4zf8/ty5sw7M+c8824zx0svVa3oAfqAAWAIGAHGCoy43oDb6TGqywta9JgsIq4GUAswB+oDDRXU5/ragCm3N6gm+MUkVJ+1kAg1AyyA5oAN8BrQCXiTfzsArwLWgCVQF6jJBOtXk/tikWrMGkiEtgTeAOyBfsAQS0vL8YMHD/aws7ObiuthwAeAA/A20AZozAvCRNHe6vI3k2rCprUp8DoR1qVLF1c/P7+A5OTkhyUlJaKwuETkPSkRBUUlgkpmZmbW2bNnQyZOnLgA7Z2BzkALNtM1qsl9MTSVSLUCugADAwMDTxKZVI7cfCw8DiWK6fselMLtlwSxJyxDPM4vFsXFxSWRkZFRkBsOdAdaAw2qyf37ij77RDMm1a5evXojY2NjH5BW7ruaIab4xotPd8cJV/xO0cKkPXGae97n0kR6TpHIzs7O7d279xdsvoncemwJqn3u/1lbDTnqfYXN6JCUlJS03CfFwt0/4TkiK8IEEBydWiBIy21tbaejr24cWJlpBVT6ShpVFvS10iddZP6MbFkyqpw2Kor6K5P9M33onG1Iv0omsz3Q//79+7HpuUViDsys697KyZy89ynk9Wc/x4u7DwvE48ePs2mRcARtqUTLRjxmDa6rpYWanDqZKHmyzJ+lTFlyUrZGGbIm3GdF49VQcnMjZUwTJW83Ua4NtayQmlEYKW1NlOc11RrLoAxLpqdYUSmnPlOlbk1qa21OZ7ovX758E/lTz1MpOmvp5gvp4qeL6c8sAjLNOQXF4sKFC6Hotw+nSrR46rAfb8hkN+WxVTTlyPplNuNmDArGGgFNgGZloClbHQtua8bj1eW+GnObZspY2nL1WKaOkreraKDk7jXLsEJGXG+u1b4Bz/0VZayyUkO5f2DCc5DvyZL/1inb0ONVU5+1dSBMcHrIvRwNMbqQ6u6fKGSZ4POszFaQDZNc0q9fvzkcjFkzKf/gfJjSo3c40OrBoL+7cvvXeUFYM17l1MuOTbxEV8a/uE8pZ8Ww4bouPJ62bFlyzXmebRg2jLY8jxa8WGopxEiX9jLff1Vp357zfluefyeOPxpp9WHAGl2fn/k1do+Ef/K86lYWs+hzJ7SSbXv06OFGAfAMRLtlBUjkPyfuidMyw3Fi37UM8TMCLFVj6W9qW1BYIg4ePBjEWkukdCTyZsyYMcvX13f7iRMnDv36669B0OxTBKRNx4OCggIPHDiwa+XKld+j7Xv84v/l4+Oz6PLlywHnzp07Su0gdyw4OPgYXQNHzp8/f+TixYuHw8LCDuDeGiaLXqLj6tWrlyLC9ztz5gy1PwEcV3AU89i3detWT2NjYyeWedvLy2va77//7hcREeHfsWPH91HX6/r16/7h4eH+6H+ZVtQvN3ToujXm9wPJYS6+FhYWzggmh4eGhh6hsTHnE/j7eN++fQczWY1Yc6WrIVJb0SLEu9iJ93I0JCTkKMY+PHLkSGe2MLV5TL3ytgxr88pwuHLlyvXY9CcaH6mSR5HwwRuPRWZekTgXnfPcfW0QqfMDk0Qc+nqCnDc+Pj6FNzJoE+PfeDEXhQ6FtD0rKyu9Tp06LpAbBN9/S+hYEJmnck79EazQA5myVTKeyM/Pp7jgI2AAXv4JeW/AgAGzUTdKXj969CiOF04T1jhj/qXrzrgfQ+0KUdq1azdt6tSpntrjxcTEUGroyBrdkLmoy3x0HT9+vIe2zIoVK9y5fT0eU688/2rOJqY/bTRcjsl5hqRPYF5P38nSdJrwMErzezMpX1NfHrELjiQ9fbl56SIjO5leViH6nwwMnjZt2gL5EmWh/Lf4f+U5BtauXbsJshPu3LkTLQl/+PBhVmpqagZ+HxHS0tLSCShpGRkZqXhp12i8RYsWrVP7wr1ctM9E2wy0lch88uRJoWwTFRV1A7JjoVnBss7BwWEJ6ubIa/SRgOt32VybKduvZILtMbd4JraoZcuWC8eMGbNN+7noWTt06DCVXUIL9rtNOdj8uABFW+bbb7/9js34y4o5fo5YI14h7QwNDV1yc3MLAsIfP0PS9kvpmg6Db+wXn6/pKrwOztBcn7mTXWbEPHlPvMguKBFFxYXiq819hZu3k6Y9xpgFjN+xY8cBOcmkpKQ0rh8HDCUieHNjHExgmGwHQomkKbdu3bpP10VFRcU2NjZ7UbcKWATMB74C3IBpSn8jTp48eVb2k5iYSNq4BVjJcl8zFrq5ue3Py8vLB/Kg4USa6+nTp0OkLNwUmfYFckGiTRJZH1YKc3Zp5mye+yQnJydQOyyYImtr65XDhw/3lX2B7BJlgaSxhXiL+6K99z4wwadkG/RRLP/28PBYxpaiES+mcokllW4PczcUz1Twy++ZpSTRrhJtUCSnx4gvNzkL9419xBfevUVIxEHNIEuDUp4j90ZCHjSqUHj+/AnaOmnkmFgyIa6Y8Hk5SScnp6VMwLs82Tc5wOkJv9Tfz89v3f79+73xMPTyJyrEloCI8+PGjTs0adIkX1dXVx+Yuu2ff/75tlmzZm1A+xUDBw6kHHo4/GqQHA8Lt9DT0/OSu7v70SlTpuwdMmTIFhC2tlmzZivQ9geAtOFLgLRoGhbFJSnbrVu3DahbrEXs+4pZrMm/FGj1xaJNlMRaWVmtGTZs2D7ZV3R0dA6sWJG8Riayhd1GNzbNo0nTpWWbP3/+dYXY5fyOLCsjti5Hbh/hwfODbmeVkkS5rCgpFgt2DNaQKjHTy16kZsRpBpp1IKE0uNoSkqapO3llp2YBUFuPLf01Jgf9007UFAQCv8lJmpubf4Y6J478rNgMWfHL6cRBE+1e9SXTKInVpdy7d+8KmbOhQ4d+rasMLRjML5xMLlkSBFShCrEbiXxJLDQymQ8/2rN/lKkJXQ+AdUiSxDZv3nydSuzNmzczQWaEvIZbeESuhhf5mLt375Y+Z0BAQDQW7Dl5PXfu3KW6EGvIfoEisL6Ya+p1aBz5z/N3czQdbQ5w12ieSizhu13DEPHmajYiKDXyPJmiaX8t6pSYs8FB04bM8ObAL2ijIg/9zyCtU4lFBDqJA6p2nE/KPLMVmyRbToGcq0osAq0rrFEu8Eve5IfJhOsiCxN8FXJzjx07FqYQ6426JZJYaGQKu463eO4W/EvXLiqx0Ni1MMV+ig9PR5ut0PosWbd582bKHL50cXHZIOMMGqtJkybrQWZpEDdv3rwfdCHWgCM5yo3s/f39j9G8H2Y/tRKXbgUItw2Oz5EqSfMJWvT0dCefA5PsVPHNTx+VtpkFzb4Ve0ncuHHjLq/I0UhJSv1W27Zt57F/6cpp0Gv8awfz6Lxq1ar5P/7448KxY8eSH/5UNcUffPBBQKdOnTZ37tx5la2t7VI7O7vv33nnnYUwrR6Ojo7TEIm6sFkjckfxwvIAaMyvTE1NPRC4LEFQtAH9+yOVSFYiXvLFC48ePXpF1nXv3n09mWqF2Ie4/oTHeIM19Q2+/iQhISFVIXb1iBEj9irWhCL2pXPmzPlF9aOoW4+gL13W7d69+ywtMASApe1glhez2yqXWJnH1uDVRv5tpMY0PE4Qu4IWlkmoNlb6TRKRcaHiQoS/+Ir9sMTCnYM1q27NmjW+tIqJxMOHDwfISe7bty8YdZ8pZ7r9aZOEruE7F2lFqZ+pwRNI8WG/SGTNZuKm8gIawlrusGDBgi+wsEJ+Q8Fq38W+fg7LkHv4hoKwUaNGlWoFLEwuEatqrL29PQVq86TW5+Tk5LP8aDK9PN4AvnaXPhKBbSEW6bLRo0fvkH3FxsYmcaA3m6JzWR8ZGVlKKmUoHAhORFywSysqfqui4Enbz1JE5nz16tXwrNx0nUh9Gkw5QTPfFbPX93pWo6Hpp6740EqkVOc/lNzTZgM0cKVq9qAdmSlPS5IEHjaN8h7Z5iAKpUt48LsyTYCGPcBc7+L3DvLi2xEREYSbt2/fDkdwci0sLOwwRZfbt29frmhFIdpEgehIkqFfRN9RQAzmkSvbQdvIzLqdOnWqNN+GFaAoeircVYr68rHoohG138KYN+mXji1Rny1NKeKWXDMzM/cJEyZskHIPUMiX0ntp06aNm5riSYsA0+zLpn6Ql5fXRnl/8eLFX7NVsygv3VHNcU3ev+xC23800NlrvqUBUFVBckv3jNZMBNHnSvajr/OEHLDaM3X1lSCjoFGjRmRKhyGoiKziBgWZRWf0kSeqUGbOnOlJmod44Iys+/DDD8kiuMAULlMXXWUFUfkhIhB9LpZ1WBwxHBDSexmIBXFTlcHCeMQuqidh586dK+S91atXu3EkXp83KPQrOt0xZq2loMVh2bJlmmT6+OVt0MT3qkiqk1jsM0LkFWQL0iI2rx2UjXfyo73gPzZCu64iyIhHYJMMJU2RoJ0ikBiOiNBn0KBBY/gB7UNDQ3/B/QTcT1SRmpqaQEA/D3A/HtoXGxcXd07uy3bt2nUQSPKHJkbLthIsnwifGY/5/oZ0gnxwb5ojTPG6jIyMGCySBCz4gTJKnz59+szg4OBAjBEFkuIg+wxQojHXszD983hx9Zw8efI4EBZHgFYHsjnV7JdjfkMw50R+hnikauM4QKJspb23t/dkuAeaR9ySJUuG8Lusw9ZWr7KvEU15N4P2Lt9HZKjZdTkeuk3MRcpSVmT8DKEbe2vaePlPFyX4B8IoHfiYH6AJJ+/m7PRtuL47r9revJfch/92YDK78Hxas0xHDrTeU2R6c8rkWIZcK/5mqx1vondnWUeWUdGL++7EL9SG5Tooc2ihFbH3VPpzVOZgz4ugI6durVjLpNV6lRd5Y/5tx3Puxv3Kzf5G3KaFcpjQvCqfHKmH7Y15An3hqDeRWaZo1+fkIjFjXQ9NKiNNNJFJvpR87JLdI8X95HCNj6CjOtrJ4uituXLUZKwk8pbKCUpr5fSkNZNhxe6hIbeXR3bNFBlttOKX0Izb1mfZhtyXFcu20kFOfmZrwQteHtXJI8AmvKfbUulPLiRrTtvk8WFdPhyw4P4b8DupxZrXgOfXTHnmOvyu5P6x/NxX7nIZVuXA3Yg7asyrxoG+RER4HoMorzj/SY64ijw18OIm4Xd2uTh4fq04f+OASEy7pyGUvrqYPXv2CvYfb/JEzbUOlA342lR5MDNFo+UZam1+MBPlgNuU69X25mXI1lIO6qVsTUXWrAK5GloH49qH3Ophf21l/mZlzL2G1gG9aTkfEJgoHwDU1LpvqIxZ0eG8TuTKM8VWbCKcoYGj1q1btwehegJtPVIuSVEmnd8iQDhtbW3tamxs/CGbs7a8OOooDr68z1QMlQdUH0b7kxX1sxbDSmBQzqcoBpXIGJQjo/1ZSmVzqaivyvozqOB96f+Z78b0lLPFumwabFgDe3K+NpDz0kH8rXEvNrttWUvr6/DRuJ6O+CMyf0a2Ku+pqn390Xt/6QduBopPNFe2zFrJaI2dfmv2XZbsz2op5qL6v3m8oF8vqv9/R/oB+Q1RPf41U3yT0R+x/9Xlryn/BY268qsf3smdAAAAAElFTkSuQmCC";function O(e,o){if(!a(e)){throw new l("container is required.")}e=S(e);o=n(o,{});var s=document.createElement("div");s.className="cesium-widget";e.appendChild(s);var d=document.createElement("canvas");var f=c.supportsImageRenderingPixelated();this._supportsImageRenderingPixelated=f;if(f){d.style.imageRendering=c.imageRenderingValue()}d.oncontextmenu=function(){return false};d.onselectstart=function(){return false};s.appendChild(d);var E=document.createElement("div");E.className="cesium-widget-credits";var O=a(o.creditContainer)?S(o.creditContainer):s;O.appendChild(E);var D=n(o.showRenderLoopErrors,true);this._element=s;this._container=e;this._canvas=d;this._canvasWidth=0;this._canvasHeight=0;this._creditContainer=E;this._canRender=false;this._renderLoopRunning=false;this._showRenderLoopErrors=D;this._resolutionScale=1;this._forceResize=false;this._clock=a(o.clock)?o.clock:new r;x(this);try{var I=new g({canvas:d,contextOptions:o.contextOptions,creditContainer:E,mapProjection:o.mapProjection,orderIndependentTranslucency:o.orderIndependentTranslucency,scene3DOnly:n(o.scene3DOnly,false),terrainExaggeration:o.terrainExaggeration,shadows:o.shadows,mapMode2D:o.mapMode2D});this._scene=I;I.camera.constrainedAxis=t.UNIT_Z;P(this);var M=n(I.mapProjection.ellipsoid,u.WGS84);var R=I.frameState.creditDisplay;var L=new i("Cesium",A,"http://cesiumjs.org/");R.addDefaultCredit(L);var N=o.globe;if(!a(N)){N=new m(M)}if(N!==false){I.globe=N;I.globe.shadows=n(o.terrainShadows,y.RECEIVE_ONLY)}var k=o.skyBox;if(!a(k)){k=new w({sources:{positiveX:T("px"),negativeX:T("mx"),positiveY:T("py"),negativeY:T("my"),positiveZ:T("pz"),negativeZ:T("mz")}})}if(k!==false){I.skyBox=k;I.sun=new C;I.moon=new v}var F=o.skyAtmosphere;if(!a(F)){F=new b(M)}if(F!==false){I.skyAtmosphere=F}var B=o.globe===false?false:o.imageryProvider;if(!a(B)){B=new p({url:"https://dev.virtualearth.net"})}if(B!==false){I.imageryLayers.addImageryProvider(B)}if(a(o.terrainProvider)&&o.globe!==false){I.terrainProvider=o.terrainProvider}this._screenSpaceEventHandler=new h(d,false);if(a(o.sceneMode)){if(o.sceneMode===_.SCENE2D){this._scene.morphTo2D(0)}if(o.sceneMode===_.COLUMBUS_VIEW){this._scene.morphToColumbusView(0)}}this._useDefaultRenderLoop=undefined;this.useDefaultRenderLoop=n(o.useDefaultRenderLoop,true);this._targetFrameRate=undefined;this.targetFrameRate=o.targetFrameRate;var U=this;I.renderError.addEventListener(function(e,t){U._useDefaultRenderLoop=false;U._renderLoopRunning=false;if(U._showRenderLoopErrors){var r="An error occurred while rendering.  Rendering has stopped.";U.showErrorPanel(r,undefined,t)}})}catch(e){if(D){var V="Error constructing CesiumWidget.";var z='Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:';this.showErrorPanel(V,z,e)}throw e}}o(O.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},camera:{get:function(){return this._scene.camera}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){if(e<=0){throw new l("targetFrameRate must be greater than 0, or undefined.")}this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){if(this._useDefaultRenderLoop!==e){this._useDefaultRenderLoop=e;if(e&&!this._renderLoopRunning){E(this)}}}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){if(e<=0){throw new l("resolutionScale must be greater than 0.")}this._resolutionScale=e;this._forceResize=true}}});O.prototype.showErrorPanel=function(e,t,r){var i=this._element;var n=document.createElement("div");n.className="cesium-widget-errorPanel";var o=document.createElement("div");o.className="cesium-widget-errorPanel-content";n.appendChild(o);var s=document.createElement("div");s.className="cesium-widget-errorPanel-header";s.appendChild(document.createTextNode(e));o.appendChild(s);var l=document.createElement("div");l.className="cesium-widget-errorPanel-scroll";o.appendChild(l);function u(){l.style.maxHeight=Math.max(Math.round(i.clientHeight*.9-100),30)+"px"}u();if(a(window.addEventListener)){window.addEventListener("resize",u,false)}if(a(t)){var c=document.createElement("div");c.className="cesium-widget-errorPanel-message";c.innerHTML="<p>"+t+"</p>";l.appendChild(c)}var f="(no error details available)";if(a(r)){f=d(r)}var h=document.createElement("div");h.className="cesium-widget-errorPanel-message";h.appendChild(document.createTextNode(f));l.appendChild(h);var p=document.createElement("div");p.className="cesium-widget-errorPanel-buttonPanel";o.appendChild(p);var m=document.createElement("button");m.setAttribute("type","button");m.className="cesium-button";m.appendChild(document.createTextNode("OK"));m.onclick=function(){if(a(u)&&a(window.removeEventListener)){window.removeEventListener("resize",u,false)}i.removeChild(n)};p.appendChild(m);i.appendChild(n);if(typeof console!=="undefined"){console.error(e+"\n"+t+"\n"+f)}};O.prototype.isDestroyed=function(){return false};O.prototype.destroy=function(){this._scene=this._scene&&this._scene.destroy();this._container.removeChild(this._element);s(this)};O.prototype.resize=function(){var e=this._canvas;var t=e.clientWidth;var r=e.clientHeight;if(!this._forceResize&&this._canvasWidth===t&&this._canvasHeight===r){return}this._forceResize=false;x(this);P(this)};O.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();var e=this._clock.tick();this._scene.render(e)}else{this._clock.tick()}};return O});define("Widgets/ClockViewModel",["../Core/Clock","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/EventHelper","../Core/JulianDate","../ThirdParty/knockout"],function(e,t,r,i,n,a,o){"use strict";function s(r){if(!t(r)){r=new e}this._clock=r;this._eventHelper=new n;this._eventHelper.add(r.onTick,this.synchronize,this);this.systemTime=o.observable(a.now());this.systemTime.equalityComparer=a.equals;this.startTime=o.observable(r.startTime);this.startTime.equalityComparer=a.equals;this.startTime.subscribe(function(e){r.startTime=e;this.synchronize()},this);this.stopTime=o.observable(r.stopTime);this.stopTime.equalityComparer=a.equals;this.stopTime.subscribe(function(e){r.stopTime=e;this.synchronize()},this);this.currentTime=o.observable(r.currentTime);this.currentTime.equalityComparer=a.equals;this.currentTime.subscribe(function(e){r.currentTime=e;this.synchronize()},this);this.multiplier=o.observable(r.multiplier);this.multiplier.subscribe(function(e){r.multiplier=e;this.synchronize()},this);this.clockStep=o.observable(r.clockStep);this.clockStep.subscribe(function(e){r.clockStep=e;this.synchronize()},this);this.clockRange=o.observable(r.clockRange);this.clockRange.subscribe(function(e){r.clockRange=e;this.synchronize()},this);this.canAnimate=o.observable(r.canAnimate);this.canAnimate.subscribe(function(e){r.canAnimate=e;this.synchronize()},this);this.shouldAnimate=o.observable(r.shouldAnimate);this.shouldAnimate.subscribe(function(e){r.shouldAnimate=e;this.synchronize()},this);o.track(this,["systemTime","startTime","stopTime","currentTime","multiplier","clockStep","clockRange","canAnimate","shouldAnimate"])}r(s.prototype,{clock:{get:function(){return this._clock}}});s.prototype.synchronize=function(){var e=this._clock;this.systemTime=a.now();this.startTime=e.startTime;this.stopTime=e.stopTime;this.currentTime=e.currentTime;this.multiplier=e.multiplier;this.clockStep=e.clockStep;this.clockRange=e.clockRange;this.canAnimate=e.canAnimate;this.shouldAnimate=e.shouldAnimate};s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){this._eventHelper.removeAll();i(this)};return s});define("Widgets/Command",["../Core/DeveloperError"],function(e){"use strict";function t(){this.canExecute=undefined;this.beforeExecute=undefined;this.afterExecute=undefined;e.throwInstantiationError()}return t});define("Widgets/FullscreenButton/FullscreenButtonViewModel",["../../Core/defaultValue","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Fullscreen","../../ThirdParty/knockout","../createCommand","../getElement"],function(e,t,r,i,n,a,o,s){"use strict";function l(t){var r=this;var i=a.observable(n.fullscreen);var l=a.observable(n.enabled);this.isFullscreen=undefined;a.defineProperty(this,"isFullscreen",{get:function(){return i()}});this.isFullscreenEnabled=undefined;a.defineProperty(this,"isFullscreenEnabled",{get:function(){return l()},set:function(e){l(e&&n.enabled)}});this.tooltip=undefined;a.defineProperty(this,"tooltip",function(){if(!this.isFullscreenEnabled){return"Full screen unavailable"}return i()?"Exit full screen":"Full screen"});this._command=o(function(){if(n.fullscreen){n.exitFullscreen()}else{n.requestFullscreen(r._fullscreenElement)}},a.getObservable(this,"isFullscreenEnabled"));this._fullscreenElement=e(s(t),document.body);this._callback=function(){i(n.fullscreen)};document.addEventListener(n.changeEventName,this._callback)}t(l.prototype,{fullscreenElement:{get:function(){return this._fullscreenElement},set:function(e){if(!(e instanceof Element)){throw new i("value must be a valid Element.")}this._fullscreenElement=e}},command:{get:function(){return this._command}}});l.prototype.isDestroyed=function(){return false};l.prototype.destroy=function(){document.removeEventListener(n.changeEventName,this._callback);r(this)};return l});define("Widgets/FullscreenButton/FullscreenButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./FullscreenButtonViewModel"],function(e,t,r,i,n,a,o){"use strict";var s="M 83.96875 17.5625 L 83.96875 17.59375 L 76.65625 24.875 L 97.09375 24.96875 L 76.09375 45.96875 L 81.9375 51.8125 L 102.78125 30.9375 L 102.875 51.15625 L 110.15625 43.875 L 110.1875 17.59375 L 83.96875 17.5625 z M 44.125 17.59375 L 17.90625 17.625 L 17.9375 43.90625 L 25.21875 51.1875 L 25.3125 30.96875 L 46.15625 51.8125 L 52 45.96875 L 31 25 L 51.4375 24.90625 L 44.125 17.59375 z M 46.0625 76.03125 L 25.1875 96.875 L 25.09375 76.65625 L 17.8125 83.9375 L 17.8125 110.21875 L 44 110.25 L 51.3125 102.9375 L 30.90625 102.84375 L 51.875 81.875 L 46.0625 76.03125 z M 82 76.15625 L 76.15625 82 L 97.15625 103 L 76.71875 103.0625 L 84.03125 110.375 L 110.25 110.34375 L 110.21875 84.0625 L 102.9375 76.8125 L 102.84375 97 L 82 76.15625 z";var l="M 104.34375 17.5625 L 83.5 38.4375 L 83.40625 18.21875 L 76.125 25.5 L 76.09375 51.78125 L 102.3125 51.8125 L 102.3125 51.78125 L 109.625 44.5 L 89.1875 44.40625 L 110.1875 23.40625 L 104.34375 17.5625 z M 23.75 17.59375 L 17.90625 23.4375 L 38.90625 44.4375 L 18.5 44.53125 L 25.78125 51.8125 L 52 51.78125 L 51.96875 25.53125 L 44.6875 18.25 L 44.625 38.46875 L 23.75 17.59375 z M 25.6875 76.03125 L 18.375 83.3125 L 38.78125 83.40625 L 17.8125 104.40625 L 23.625 110.25 L 44.5 89.375 L 44.59375 109.59375 L 51.875 102.3125 L 51.875 76.0625 L 25.6875 76.03125 z M 102.375 76.15625 L 76.15625 76.1875 L 76.1875 102.4375 L 83.46875 109.71875 L 83.5625 89.53125 L 104.40625 110.375 L 110.25 104.53125 L 89.25 83.53125 L 109.6875 83.46875 L 102.375 76.15625 z";function u(t,r){if(!e(t)){throw new i("container is required.")}t=a(t);var u=new o(r);u._exitFullScreenPath=l;u._enterFullScreenPath=s;var c=document.createElement("button");c.type="button";c.className="cesium-button cesium-fullscreenButton";c.setAttribute("data-bind","attr: { title: tooltip },click: command,enable: isFullscreenEnabled,cesiumSvgPath: { path: isFullscreen ? _exitFullScreenPath : _enterFullScreenPath, width: 128, height: 128 }");t.appendChild(c);n.applyBindings(u,c);this._container=t;this._viewModel=u;this._element=c}t(u.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){this._viewModel.destroy();n.cleanNode(this._element);this._container.removeChild(this._element);return r(this)};return u});define("Widgets/Geocoder/GeocoderViewModel",["../../Core/BingMapsGeocoderService","../../Core/CartographicGeocoderService","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/Event","../../Core/Matrix4","../../ThirdParty/knockout","../../ThirdParty/when","../createCommand","../getElement"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(n){if(!i(n)||!i(n.scene)){throw new a("options.scene is required.")}if(i(n.geocoderServices)){this._geocoderServices=n.geocoderServices}else{this._geocoderServices=[new t,new e({scene:n.scene})]}this._viewContainer=n.container;this._scene=n.scene;this._flightDuration=n.flightDuration;this._searchText="";this._isSearchInProgress=false;this._geocodePromise=undefined;this._complete=new o;this._suggestions=[];this._selectedSuggestion=undefined;this._showSuggestions=true;this._updateCamera=m;this._adjustSuggestionsScroll=_;this._updateSearchSuggestions=C;this._handleArrowDown=p;this._handleArrowUp=h;var s=this;this._suggestionsVisible=l.pureComputed(function(){var e=l.getObservable(s,"_suggestions");var t=e().length>0;var r=l.getObservable(s,"_showSuggestions")();return t&&r});this._searchCommand=c(function(){s.hideSuggestions();s._focusTextbox=false;if(i(s._selectedSuggestion)){s.activateSuggestion(s._selectedSuggestion);return false}if(s.isSearchInProgress){y(s)}else{g(s,s._geocoderServices)}});this.deselectSuggestion=function(){s._selectedSuggestion=undefined};this.handleKeyDown=function(e,t){var r=t.key==="ArrowDown"||t.key==="Down"||t.keyCode===40;var i=t.key==="ArrowUp"||t.key==="Up"||t.keyCode===38;if(r||i){t.preventDefault()}return true};this.handleKeyUp=function(e,t){var r=t.key==="ArrowDown"||t.key==="Down"||t.keyCode===40;var i=t.key==="ArrowUp"||t.key==="Up"||t.keyCode===38;var n=t.key==="Enter"||t.keyCode===13;if(i){h(s)}else if(r){p(s)}else if(n){s._searchCommand()}return true};this.activateSuggestion=function(e){s.hideSuggestions();s._searchText=e.displayName;var t=e.destination;w(s);m(s,t)};this.hideSuggestions=function(){s._showSuggestions=false;s._selectedSuggestion=undefined};this.showSuggestions=function(){s._showSuggestions=true};this.handleMouseover=function(e,t){if(e!==s._selectedSuggestion){s._selectedSuggestion=e}};this.keepExpanded=false;this.autoComplete=r(n.autocomplete,true);this._focusTextbox=false;l.track(this,["_searchText","_isSearchInProgress","keepExpanded","_suggestions","_selectedSuggestion","_showSuggestions","_focusTextbox"]);var u=l.getObservable(this,"_searchText");u.extend({rateLimit:{timeout:500}});this._suggestionSubscription=u.subscribe(function(){C(s)});this.isSearchInProgress=undefined;l.defineProperty(this,"isSearchInProgress",{get:function(){return this._isSearchInProgress}});this.searchText=undefined;l.defineProperty(this,"searchText",{get:function(){if(this.isSearchInProgress){return"Searching..."}return this._searchText},set:function(e){if(typeof e!=="string"){throw new a("value must be a valid string.")}this._searchText=e}});this.flightDuration=undefined;l.defineProperty(this,"flightDuration",{get:function(){return this._flightDuration},set:function(e){if(i(e)&&e<0){throw new a("value must be positive.")}this._flightDuration=e}})}n(f.prototype,{complete:{get:function(){return this._complete}},scene:{get:function(){return this._scene}},search:{get:function(){return this._searchCommand}},selectedSuggestion:{get:function(){return this._selectedSuggestion}},suggestions:{get:function(){return this._suggestions}}});f.prototype.destroy=function(){this._suggestionSubscription.dispose()};function h(e){if(e._suggestions.length===0){return}var t;var r=e._suggestions.indexOf(e._selectedSuggestion);if(r===-1||r===0){e._selectedSuggestion=undefined;return}t=r-1;e._selectedSuggestion=e._suggestions[t];_(e,t)}function p(e){if(e._suggestions.length===0){return}var t=e._suggestions.length;var r=e._suggestions.indexOf(e._selectedSuggestion);var i=(r+1)%t;e._selectedSuggestion=e._suggestions[i];_(e,i)}function m(e,t){e._scene.camera.flyTo({destination:t,complete:function(){e._complete.raiseEvent()},duration:e._flightDuration,endTransform:s.IDENTITY})}function v(e,t,r){return e.then(function(e){if(i(e)&&e.state==="fulfilled"&&e.value.length>0){return e}var n=t.geocode(r).then(function(e){return{state:"fulfilled",value:e}}).otherwise(function(e){return{state:"rejected",reason:e}});return n})}function g(e,t){var r=e._searchText;if(b(r)){e.showSuggestions();return}e._isSearchInProgress=true;var n=u.resolve();for(var a=0;a<t.length;a++){n=v(n,t[a],r)}e._geocodePromise=n;n.then(function(t){if(n.cancel){return}e._isSearchInProgress=false;var a=t.value;if(t.state==="fulfilled"&&i(a)&&a.length>0){e._searchText=a[0].displayName;m(e,a[0].destination);return}e._searchText=r+" (not found)"})}function _(e,t){var r=d(e._viewContainer);var i=r.getElementsByClassName("search-results")[0];var n=r.getElementsByTagName("li");var a=n[t];if(t===0){i.scrollTop=0;return}var o=a.offsetTop;if(o+a.clientHeight>i.clientHeight){i.scrollTop=o+a.clientHeight}else if(o<i.scrollTop){i.scrollTop=o}}function y(e){e._isSearchInProgress=false;if(i(e._geocodePromise)){e._geocodePromise.cancel=true;e._geocodePromise=undefined}}function b(e){return/^\s*$/.test(e)}function w(e){l.getObservable(e,"_suggestions").removeAll()}function C(e){if(!e.autoComplete){return}var t=e._searchText;w(e);if(b(t)){return}var r=u.resolve([]);e._geocoderServices.forEach(function(e){r=r.then(function(r){if(r.length>=5){return r}return e.geocode(t).then(function(e){r=r.concat(e);return r})})});r.then(function(t){var r=e._suggestions;for(var i=0;i<t.length;i++){r.push(t[i])}})}return f});define("Widgets/Geocoder/Geocoder",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./GeocoderViewModel"],function(e,t,r,i,n,a,o,s){"use strict";var l="M29.772,26.433l-7.126-7.126c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127L29.772,26.433zM7.203,13.885c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486c-0.007,3.58-2.905,6.476-6.484,6.484C10.106,20.361,7.209,17.465,7.203,13.885z";var u="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z";function c(t){if(!e(t)||!e(t.container)){throw new i("options.container is required.")}if(!e(t.scene)){throw new i("options.scene is required.")}var r=o(t.container);var c=new s(t);c._startSearchPath=l;c._stopSearchPath=u;var d=document.createElement("form");d.setAttribute("data-bind","submit: search");var f=document.createElement("input");f.type="search";f.className="cesium-geocoder-input";f.setAttribute("placeholder","Enter an address or landmark...");f.setAttribute("data-bind",'textInput: searchText,disable: isSearchInProgress,event: { keyup: handleKeyUp, keydown: handleKeyDown, mouseover: deselectSuggestion },css: { "cesium-geocoder-input-wide" : keepExpanded || searchText.length > 0 },hasFocus: _focusTextbox');this._onTextBoxFocus=function(){setTimeout(function(){f.select()},0)};f.addEventListener("focus",this._onTextBoxFocus,false);d.appendChild(f);this._textBox=f;var h=document.createElement("span");h.className="cesium-geocoder-searchButton";h.setAttribute("data-bind","click: search,cesiumSvgPath: { path: isSearchInProgress ? _stopSearchPath : _startSearchPath, width: 32, height: 32 }");d.appendChild(h);r.appendChild(d);var p=document.createElement("div");p.className="search-results";p.setAttribute("data-bind","visible: _suggestionsVisible");var m=document.createElement("ul");m.setAttribute("data-bind","foreach: _suggestions");var v=document.createElement("li");m.appendChild(v);v.setAttribute("data-bind","text: $data.displayName, click: $parent.activateSuggestion, event: { mouseover: $parent.handleMouseover}, css: { active: $data === $parent._selectedSuggestion }");p.appendChild(m);r.appendChild(p);a.applyBindings(c,d);a.applyBindings(c,p);this._container=r;this._searchSuggestionsContainer=p;this._viewModel=c;this._form=d;this._onInputBegin=function(e){if(!r.contains(e.target)){c._focusTextbox=false;c.hideSuggestions()}};this._onInputEnd=function(e){if(r.contains(e.target)){c._focusTextbox=true;c.showSuggestions()}};if(n.supportsPointerEvents()){document.addEventListener("pointerdown",this._onInputBegin,true);document.addEventListener("pointerup",this._onInputEnd,true);document.addEventListener("pointercancel",this._onInputEnd,true)}else{document.addEventListener("mousedown",this._onInputBegin,true);document.addEventListener("mouseup",this._onInputEnd,true);document.addEventListener("touchstart",this._onInputBegin,true);document.addEventListener("touchend",this._onInputEnd,true);document.addEventListener("touchcancel",this._onInputEnd,true)}}t(c.prototype,{container:{get:function(){return this._container}},searchSuggestionsContainer:{get:function(){return this._searchSuggestionsContainer}},viewModel:{get:function(){return this._viewModel}}});c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){if(n.supportsPointerEvents()){document.removeEventListener("pointerdown",this._onInputBegin,true);document.removeEventListener("pointerup",this._onInputEnd,true)}else{document.removeEventListener("mousedown",this._onInputBegin,true);document.removeEventListener("mouseup",this._onInputEnd,true);document.removeEventListener("touchstart",this._onInputBegin,true);document.removeEventListener("touchend",this._onInputEnd,true)}this._viewModel.destroy();a.cleanNode(this._form);a.cleanNode(this._searchSuggestionsContainer);this._container.removeChild(this._form);this._container.removeChild(this._searchSuggestionsContainer);this._textBox.removeEventListener("focus",this._onTextBoxFocus,false);return r(this)};return c});define("Widgets/HomeButton/HomeButtonViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n){"use strict";function a(t,a){if(!e(t)){throw new r("scene is required.")}this._scene=t;this._duration=a;var o=this;this._command=n(function(){o._scene.camera.flyHome(o._duration)});this.tooltip="View Home";i.track(this,["tooltip"])}t(a.prototype,{scene:{get:function(){return this._scene}},command:{get:function(){return this._command}},duration:{get:function(){return this._duration},set:function(t){if(e(t)&&t<0){throw new r("value must be positive.")}this._duration=t}}});return a});define("Widgets/HomeButton/HomeButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./HomeButtonViewModel"],function(e,t,r,i,n,a,o){"use strict";function s(t,r,s){if(!e(t)){throw new i("container is required.")}t=a(t);var l=new o(r,s);l._svgPath="M14,4l-10,8.75h20l-4.25-3.7188v-4.6562h-2.812v2.1875l-2.938-2.5625zm-7.0938,9.906v10.094h14.094v-10.094h-14.094zm2.1876,2.313h3.3122v4.25h-3.3122v-4.25zm5.8442,1.281h3.406v6.438h-3.406v-6.438z";var u=document.createElement("button");u.type="button";u.className="cesium-button cesium-toolbar-button cesium-home-button";u.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 28, height: 28 }");t.appendChild(u);n.applyBindings(l,u);this._container=t;this._viewModel=l;this._element=u}t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){n.cleanNode(this._element);this._container.removeChild(this._element);return r(this)};return s});define("Widgets/InfoBox/InfoBoxViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/Event","../../ThirdParty/knockout"],function(e,t,r,i){"use strict";var n="M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4853444 22.104033 11.423165 24.0625 13.84375 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 8.975298 28.305952 7.03125 25.875 7.03125 L 13.84375 7.03125 z";var a="M 27.34375 1.65625 L 5.28125 27.9375 L 8.09375 30.3125 L 30.15625 4.03125 L 27.34375 1.65625 z M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4724893 20.232036 9.5676108 20.7379 9.75 21.21875 L 21.65625 7.03125 L 13.84375 7.03125 z M 28.21875 7.71875 L 14.53125 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 9.8371439 29.456025 8.4902779 28.21875 7.71875 z";function o(){this._cameraClicked=new r;this._closeClicked=new r;this.maxHeight=500;this.enableCamera=false;this.isCameraTracking=false;this.showInfo=false;this.titleText="";this.description="";i.track(this,["showInfo","titleText","description","maxHeight","enableCamera","isCameraTracking"]);this._loadingIndicatorHtml='<div class="cesium-infoBox-loadingContainer"><span class="cesium-infoBox-loading"></span></div>';this.cameraIconPath=undefined;i.defineProperty(this,"cameraIconPath",{get:function(){return!this.enableCamera||this.isCameraTracking?a:n}});i.defineProperty(this,"_bodyless",{get:function(){return!e(this.description)||this.description.length===0}})}o.prototype.maxHeightOffset=function(e){return this.maxHeight-e+"px"};t(o.prototype,{cameraClicked:{get:function(){return this._cameraClicked}},closeClicked:{get:function(){return this._closeClicked}}});return o});define("Widgets/InfoBox/InfoBox",["../../Core/buildModuleUrl","../../Core/Check","../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../ThirdParty/knockout","../getElement","../subscribeAndEvaluate","./InfoBoxViewModel"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(n){t.defined("container",n);n=s(n);var a=document.createElement("div");a.className="cesium-infoBox";a.setAttribute("data-bind",'css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }');n.appendChild(a);var c=document.createElement("div");c.className="cesium-infoBox-title";c.setAttribute("data-bind","text: titleText");a.appendChild(c);var d=document.createElement("button");d.type="button";d.className="cesium-button cesium-infoBox-camera";d.setAttribute("data-bind",'attr: { title: "Focus camera on object" },click: function () { cameraClicked.raiseEvent(this); },enable: enableCamera,cesiumSvgPath: { path: cameraIconPath, width: 32, height: 32 }');a.appendChild(d);var f=document.createElement("button");f.type="button";f.className="cesium-infoBox-close";f.setAttribute("data-bind","click: function () { closeClicked.raiseEvent(this); }");f.innerHTML="&times;";a.appendChild(f);var h=document.createElement("iframe");h.className="cesium-infoBox-iframe";h.setAttribute("sandbox","allow-same-origin allow-popups allow-forms");h.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }");h.setAttribute("allowfullscreen",true);a.appendChild(h);var p=new u;o.applyBindings(p,a);this._container=n;this._element=a;this._frame=h;this._viewModel=p;this._descriptionSubscription=undefined;var m=this;h.addEventListener("load",function(){var t=h.contentDocument;var n=t.createElement("link");n.href=e("Widgets/InfoBox/InfoBoxDescription.css");n.rel="stylesheet";n.type="text/css";var o=t.createElement("div");o.className="cesium-infoBox-description";t.head.appendChild(n);t.body.appendChild(o);m._descriptionSubscription=l(p,"description",function(e){h.style.height="5px";o.innerHTML=e;var t=null;var n=o.firstElementChild;if(n!==null&&o.childNodes.length===1){var s=window.getComputedStyle(n);if(s!==null){var l=s["background-color"];var u=r.fromCssColorString(l);if(i(u)&&u.alpha!==0){t=s["background-color"]}}}a.style["background-color"]=t;var c=o.getBoundingClientRect().height;h.style.height=c+"px"})});h.setAttribute("src","about:blank")}n(c.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}},frame:{get:function(){return this._frame}}});c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){var e=this._container;o.cleanNode(this._element);e.removeChild(this._element);if(i(this._descriptionSubscription)){this._descriptionSubscription.dispose()}return a(this)};return c});define("Widgets/NavigationHelpButton/NavigationHelpButtonViewModel",["../../Core/defineProperties","../../ThirdParty/knockout","../createCommand"],function(e,t,r){"use strict";function i(){this.showInstructions=false;var e=this;this._command=r(function(){e.showInstructions=!e.showInstructions});this._showClick=r(function(){e._touch=false});this._showTouch=r(function(){e._touch=true});this._touch=false;this.tooltip="Navigation Instructions";t.track(this,["tooltip","showInstructions","_touch"])}e(i.prototype,{command:{get:function(){return this._command}},showClick:{get:function(){return this._showClick}},showTouch:{get:function(){return this._showTouch}}});return i});define("Widgets/NavigationHelpButton/NavigationHelpButton",["../../Core/buildModuleUrl","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./NavigationHelpButtonViewModel"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(i){if(!r(i)||!r(i.container)){throw new a("options.container is required.")}var n=l(i.container);var c=new u;var d=t(i.instructionsInitiallyVisible,false);c.showInstructions=d;c._svgPath="M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M17.328,24.371h-2.707v-2.596h2.707V24.371zM17.328,19.003v0.858h-2.707v-1.057c0-3.19,3.63-3.696,3.63-5.963c0-1.034-0.924-1.826-2.134-1.826c-1.254,0-2.354,0.924-2.354,0.924l-1.541-1.915c0,0,1.519-1.584,4.137-1.584c2.487,0,4.796,1.54,4.796,4.136C21.156,16.208,17.328,16.627,17.328,19.003z";var f=document.createElement("span");f.className="cesium-navigationHelpButton-wrapper";n.appendChild(f);var h=document.createElement("button");h.type="button";h.className="cesium-button cesium-toolbar-button cesium-navigation-help-button";h.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 32, height: 32 }");f.appendChild(h);var p=document.createElement("div");p.className="cesium-navigation-help";p.setAttribute("data-bind",'css: { "cesium-navigation-help-visible" : showInstructions}');f.appendChild(p);var m=document.createElement("button");m.type="button";m.className="cesium-navigation-button cesium-navigation-button-left";m.setAttribute("data-bind",'click: showClick, css: {"cesium-navigation-button-selected": !_touch, "cesium-navigation-button-unselected": _touch}');var v=document.createElement("img");v.src=e("Widgets/Images/NavigationHelp/Mouse.svg");v.className="cesium-navigation-button-icon";v.style.width="25px";v.style.height="25px";m.appendChild(v);m.appendChild(document.createTextNode("Mouse"));var g=document.createElement("button");g.type="button";g.className="cesium-navigation-button cesium-navigation-button-right";g.setAttribute("data-bind",'click: showTouch, css: {"cesium-navigation-button-selected": _touch, "cesium-navigation-button-unselected": !_touch}');var _=document.createElement("img");_.src=e("Widgets/Images/NavigationHelp/Touch.svg");_.className="cesium-navigation-button-icon";_.style.width="25px";_.style.height="25px";g.appendChild(_);g.appendChild(document.createTextNode("Touch"));p.appendChild(m);p.appendChild(g);var y=document.createElement("div");y.className="cesium-click-navigation-help cesium-navigation-help-instructions";y.setAttribute("data-bind",'css: { "cesium-click-navigation-help-visible" : !_touch}');y.innerHTML='            <table>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/MouseLeft.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">Left click + drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/MouseRight.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Right click + drag, or</div>                        <div class="cesium-navigation-help-details">Mouse wheel scroll</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/MouseMiddle.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Rotate view</div>                        <div class="cesium-navigation-help-details">Middle click + drag, or</div>                        <div class="cesium-navigation-help-details">CTRL + Left/Right click + drag</div>                    </td>                </tr>            </table>';p.appendChild(y);var b=document.createElement("div");b.className="cesium-touch-navigation-help cesium-navigation-help-instructions";b.setAttribute("data-bind",'css: { "cesium-touch-navigation-help-visible" : _touch}');b.innerHTML='            <table>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchDrag.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">One finger drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchZoom.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Two finger pinch</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchTilt.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Tilt view</div>                        <div class="cesium-navigation-help-details">Two finger drag, same direction</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchRotate.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-tilt">Rotate view</div>                        <div class="cesium-navigation-help-details">Two finger drag, opposite direction</div>                    </td>                </tr>            </table>';p.appendChild(b);s.applyBindings(c,f);this._container=n;this._viewModel=c;this._wrapper=f;this._closeInstructions=function(e){if(!f.contains(e.target)){c.showInstructions=false}};if(o.supportsPointerEvents()){document.addEventListener("pointerdown",this._closeInstructions,true)}else{document.addEventListener("mousedown",this._closeInstructions,true);document.addEventListener("touchstart",this._closeInstructions,true)}}i(c.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){if(o.supportsPointerEvents()){document.removeEventListener("pointerdown",this._closeInstructions,true)}else{document.removeEventListener("mousedown",this._closeInstructions,true);document.removeEventListener("touchstart",this._closeInstructions,true)}s.cleanNode(this._wrapper);this._container.removeChild(this._wrapper);return n(this)};return c});define("Widgets/PerformanceWatchdog/PerformanceWatchdogViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Scene/FrameRateMonitor","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s){"use strict";function l(r){if(!t(r)||!t(r.scene)){throw new n("options.scene is required.")}this._scene=r.scene;this.lowFrameRateMessage=e(r.lowFrameRateMessage,"This application appears to be performing poorly on your system.  Please try using a different web browser or updating your video drivers.");this.lowFrameRateMessageDismissed=false;this.showingLowFrameRateMessage=false;o.track(this,["lowFrameRateMessage","lowFrameRateMessageDismissed","showingLowFrameRateMessage"]);var i=this;this._dismissMessage=s(function(){i.showingLowFrameRateMessage=false;i.lowFrameRateMessageDismissed=true});var l=a.fromScene(r.scene);this._unsubscribeLowFrameRate=l.lowFrameRate.addEventListener(function(){if(!i.lowFrameRateMessageDismissed){i.showingLowFrameRateMessage=true}});this._unsubscribeNominalFrameRate=l.nominalFrameRate.addEventListener(function(){i.showingLowFrameRateMessage=false})}r(l.prototype,{scene:{get:function(){return this._scene}},dismissMessage:{get:function(){return this._dismissMessage}}});l.prototype.destroy=function(){this._unsubscribeLowFrameRate();this._unsubscribeNominalFrameRate();return i(this)};return l});define("Widgets/PerformanceWatchdog/PerformanceWatchdog",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./PerformanceWatchdogViewModel"],function(e,t,r,i,n,a,o){"use strict";function s(t){if(!e(t)||!e(t.container)){throw new i("options.container is required.")}if(!e(t.scene)){throw new i("options.scene is required.")}var r=a(t.container);var s=new o(t);var l=document.createElement("div");l.className="cesium-performance-watchdog-message-area";l.setAttribute("data-bind","visible: showingLowFrameRateMessage");var u=document.createElement("button");u.setAttribute("type","button");u.className="cesium-performance-watchdog-message-dismiss";u.innerHTML="&times;";u.setAttribute("data-bind","click: dismissMessage");l.appendChild(u);var c=document.createElement("div");c.className="cesium-performance-watchdog-message";c.setAttribute("data-bind","html: lowFrameRateMessage");l.appendChild(c);r.appendChild(l);n.applyBindings(s,l);this._container=r;this._viewModel=s;this._element=l}t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){this._viewModel.destroy();n.cleanNode(this._element);this._container.removeChild(this._element);return r(this)};return s});define("Widgets/ProjectionPicker/ProjectionPickerViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Core/OrthographicFrustum","../../Scene/SceneMode","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(t){if(!e(t)){throw new i("scene is required.")}this._scene=t;this._orthographic=t.camera.frustum instanceof a;this._flightInProgress=false;this.dropDownVisible=false;this.tooltipPerspective="Perspective Projection";this.tooltipOrthographic="Orthographic Projection";this.selectedTooltip=undefined;this.sceneMode=t.mode;s.track(this,["_orthographic","_flightInProgress","sceneMode","dropDownVisible","tooltipPerspective","tooltipOrthographic"]);var r=this;s.defineProperty(this,"selectedTooltip",function(){if(r._orthographic){return r.tooltipOrthographic}return r.tooltipPerspective});this._toggleDropDown=l(function(){if(r.sceneMode===o.SCENE2D||r._flightInProgress){return}r.dropDownVisible=!r.dropDownVisible});this._eventHelper=new n;this._eventHelper.add(t.morphComplete,function(e,t,i,n){r.sceneMode=i;r._orthographic=i===o.SCENE2D||r._scene.camera.frustum instanceof a});this._eventHelper.add(t.preRender,function(){r._flightInProgress=e(t.camera._currentFlight)});this._switchToPerspective=l(function(){if(r.sceneMode===o.SCENE2D){return}r._scene.camera.switchToPerspectiveFrustum();r._orthographic=false;r.dropDownVisible=false});this._switchToOrthographic=l(function(){if(r.sceneMode===o.SCENE2D){return}r._scene.camera.switchToOrthographicFrustum();r._orthographic=true;r.dropDownVisible=false});this._sceneMode=o}t(u.prototype,{scene:{get:function(){return this._scene}},toggleDropDown:{get:function(){return this._toggleDropDown}},switchToPerspective:{get:function(){return this._switchToPerspective}},switchToOrthographic:{get:function(){return this._switchToOrthographic}},isOrthographicProjection:{get:function(){return this._orthographic}}});u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){this._eventHelper.removeAll();r(this)};return u});define("Widgets/ProjectionPicker/ProjectionPicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./ProjectionPickerViewModel"],function(e,t,r,i,n,a,o,s){"use strict";var l="M 28.15625,10.4375 9.125,13.21875 13.75,43.25 41.75,55.09375 50.8125,37 54.5,11.9375 z m 0.125,3 19.976451,0.394265 L 43.03125,16.875 22.6875,14.28125 z M 50.971746,15.705477 47.90625,36.03125 42.53125,46 44.84375,19.3125 z M 12.625,16.03125 l 29.15625,3.6875 -2.65625,31 L 16.4375,41.125 z";var u="m 31.560594,6.5254438 -20.75,12.4687502 0.1875,24.5625 22.28125,11.8125 19.5,-12 0.65625,-0.375 0,-0.75 0.0312,-23.21875 z m 0.0625,3.125 16.65625,9.5000002 -16.125,10.28125 -17.34375,-9.71875 z m 18.96875,11.1875002 0.15625,20.65625 -17.46875,10.59375 0.15625,-20.28125 z m -37.0625,1.25 17.21875,9.625 -0.15625,19.21875 -16.9375,-9 z";function c(t,r){if(!e(t)){throw new i("container is required.")}if(!e(r)){throw new i("scene is required.")}t=o(t);var c=new s(r);c._perspectivePath=l;c._orthographicPath=u;var d=document.createElement("span");d.className="cesium-projectionPicker-wrapper cesium-toolbar-button";t.appendChild(d);var f=document.createElement("button");f.type="button";f.className="cesium-button cesium-toolbar-button";f.setAttribute("data-bind",'css: { "cesium-projectionPicker-buttonPerspective": !_orthographic,       "cesium-projectionPicker-buttonOrthographic": _orthographic,       "cesium-button-disabled" : sceneMode === _sceneMode.SCENE2D || _flightInProgress,        "cesium-projectionPicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown');f.innerHTML='\x3c!-- ko cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64, css: "cesium-projectionPicker-iconPerspective" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64, css: "cesium-projectionPicker-iconOrthographic" } --\x3e\x3c!-- /ko --\x3e';d.appendChild(f);var h=document.createElement("button");h.type="button";h.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon";h.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && _orthographic),       "cesium-projectionPicker-none" : !_orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible },attr: { title: tooltipPerspective },click: switchToPerspective,cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64 }');d.appendChild(h);var p=document.createElement("button");p.type="button";p.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon";p.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && !_orthographic),       "cesium-projectionPicker-none" : _orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible},attr: { title: tooltipOrthographic },click: switchToOrthographic,cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64 }');d.appendChild(p);a.applyBindings(c,d);this._viewModel=c;this._container=t;this._wrapper=d;this._closeDropDown=function(e){if(!d.contains(e.target)){c.dropDownVisible=false}};if(n.supportsPointerEvents()){document.addEventListener("pointerdown",this._closeDropDown,true)}else{document.addEventListener("mousedown",this._closeDropDown,true);document.addEventListener("touchstart",this._closeDropDown,true)}}t(c.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});c.prototype.isDestroyed=function(){return false};c.prototype.destroy=function(){this._viewModel.destroy();if(n.supportsPointerEvents()){document.removeEventListener("pointerdown",this._closeDropDown,true)}else{document.removeEventListener("mousedown",this._closeDropDown,true);document.removeEventListener("touchstart",this._closeDropDown,true)}a.cleanNode(this._wrapper);this._container.removeChild(this._wrapper);return r(this)};return c});define("Widgets/SceneModePicker/SceneModePickerViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Scene/SceneMode","../../ThirdParty/knockout","../createCommand"],function(e,t,r,i,n,a,o,s,l){"use strict";function u(r,i){if(!t(r)){throw new n("scene is required.")}this._scene=r;var u=this;var c=function(e,t,r,i){u.sceneMode=r;u.dropDownVisible=false};this._eventHelper=new a;this._eventHelper.add(r.morphStart,c);this._duration=e(i,2);this.sceneMode=r.mode;this.dropDownVisible=false;this.tooltip2D="2D";this.tooltip3D="3D";this.tooltipColumbusView="Columbus View";s.track(this,["sceneMode","dropDownVisible","tooltip2D","tooltip3D","tooltipColumbusView"]);this.selectedTooltip=undefined;s.defineProperty(this,"selectedTooltip",function(){var e=u.sceneMode;if(e===o.SCENE2D){return u.tooltip2D}if(e===o.SCENE3D){return u.tooltip3D}return u.tooltipColumbusView});this._toggleDropDown=l(function(){u.dropDownVisible=!u.dropDownVisible});this._morphTo2D=l(function(){r.morphTo2D(u._duration)});this._morphTo3D=l(function(){r.morphTo3D(u._duration)});this._morphToColumbusView=l(function(){r.morphToColumbusView(u._duration)});this._sceneMode=o}r(u.prototype,{scene:{get:function(){return this._scene}},duration:{get:function(){return this._duration},set:function(e){if(e<0){throw new n("duration value must be positive.")}this._duration=e}},toggleDropDown:{get:function(){return this._toggleDropDown}},morphTo2D:{get:function(){return this._morphTo2D}},morphTo3D:{get:function(){return this._morphTo3D}},morphToColumbusView:{get:function(){return this._morphToColumbusView}}});u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){this._eventHelper.removeAll();i(this)};return u});define("Widgets/SceneModePicker/SceneModePicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./SceneModePickerViewModel"],function(e,t,r,i,n,a,o,s){"use strict";var l="m 32.401392,4.9330437 c -7.087603,0 -14.096095,2.884602 -19.10793,7.8946843 -5.0118352,5.010083 -7.9296167,11.987468 -7.9296167,19.072999 0,7.085531 2.9177815,14.097848 7.9296167,19.107931 4.837653,4.835961 11.541408,7.631372 18.374354,7.82482 0.05712,0.01231 0.454119,0.139729 0.454119,0.139729 l 0.03493,-0.104797 c 0.08246,7.84e-4 0.162033,0.03493 0.244525,0.03493 0.08304,0 0.161515,-0.03414 0.244526,-0.03493 l 0.03493,0.104797 c 0,0 0.309474,-0.129487 0.349323,-0.139729 6.867765,-0.168094 13.582903,-2.965206 18.444218,-7.82482 2.558195,-2.5573 4.551081,-5.638134 5.903547,-8.977584 1.297191,-3.202966 2.02607,-6.661489 2.02607,-10.130347 0,-6.237309 -2.366261,-12.31219 -6.322734,-17.116794 -0.0034,-0.02316 0.0049,-0.04488 0,-0.06986 -0.01733,-0.08745 -0.104529,-0.278855 -0.104797,-0.279458 -5.31e-4,-0.0012 -0.522988,-0.628147 -0.523984,-0.62878         -3.47e-4,-2.2e-4 -0.133444,-0.03532 -0.244525,-0.06987 C 51.944299,13.447603 51.751076,13.104317 51.474391,12.827728 46.462556,7.8176457 39.488996,4.9330437 32.401392,4.9330437 z m -2.130866,3.5281554 0.104797,9.6762289 c -4.111695,-0.08361 -7.109829,-0.423664 -9.257041,-0.943171 1.198093,-2.269271 2.524531,-4.124404 3.91241,-5.414496 2.167498,-2.0147811 3.950145,-2.8540169 5.239834,-3.3185619 z m 2.794579,0 c 1.280302,0.4754953 3.022186,1.3285948 5.065173,3.2486979 1.424667,1.338973 2.788862,3.303645 3.982275,5.728886 -2.29082,0.403367 -5.381258,0.621049 -8.942651,0.698645 L 33.065105,8.4611991 z m 5.728886,0.2445256 c 4.004072,1.1230822 7.793098,3.1481363 10.724195,6.0782083 0.03468,0.03466 0.07033,0.06991 0.104797,0.104797 -0.45375,0.313891 -0.923054,0.663002 -1.956205,1.082899 -0.647388,0.263114 -1.906242,0.477396 -2.829511,0.733577 -1.382296,-2.988132         -3.027146,-5.368585 -4.785716,-7.0213781 -0.422866,-0.397432 -0.835818,-0.6453247 -1.25756,-0.9781032 z m -15.33525,0.7685092 c -0.106753,0.09503 -0.207753,0.145402 -0.31439,0.244526 -1.684973,1.5662541 -3.298068,3.8232211 -4.680919,6.5672591 -0.343797,-0.14942 -1.035052,-0.273198 -1.292493,-0.419186 -0.956528,-0.542427 -1.362964,-1.022024 -1.537018,-1.292493 -0.0241,-0.03745 -0.01868,-0.0401 -0.03493,-0.06986 2.250095,-2.163342 4.948824,-3.869984 7.859752,-5.0302421 z m -9.641296,7.0912431 c 0.464973,0.571618 0.937729,1.169056 1.956205,1.746612 0.349907,0.198425 1.107143,0.335404 1.537018,0.523983 -1.20166,3.172984 -1.998037,7.051901 -2.165798,11.772162 C 14.256557,30.361384 12.934823,30.161483 12.280427,29.90959 10.644437,29.279855 9.6888882,28.674891 9.1714586,28.267775 8.6540289,27.860658 8.6474751,27.778724 8.6474751,27.778724 l -0.069864,0.03493 C 9.3100294,23.691285         11.163248,19.798527 13.817445,16.565477 z m 37.552149,0.523984 c 2.548924,3.289983 4.265057,7.202594 4.890513,11.318043 -0.650428,0.410896 -1.756876,1.001936 -3.563088,1.606882 -1.171552,0.392383 -3.163859,0.759153 -4.960377,1.117832 -0.04367,-4.752703 -0.784809,-8.591423 -1.88634,-11.807094 0.917574,-0.263678 2.170552,-0.486495 2.864443,-0.76851 1.274693,-0.518066 2.003942,-1.001558 2.654849,-1.467153 z m -31.439008,2.619917 c 2.487341,0.672766 5.775813,1.137775 10.479669,1.222628 l 0.104797,10.689263 0,0.03493 0,0.733577 c -5.435005,-0.09059 -9.512219,-0.519044 -12.610536,-1.117831 0.106127,-4.776683 0.879334,-8.55791 2.02607,-11.562569 z m 23.264866,0.31439 c 1.073459,3.067541 1.833795,6.821314 1.816476,11.702298 -3.054474,0.423245 -7.062018,0.648559 -11.702298,0.698644 l 0,-0.838373 -0.104796,-10.654331 c 4.082416,-0.0864 7.404468,-0.403886 9.990618,-0.908238 z         M 8.2632205,30.922625 c 0.7558676,0.510548 1.5529563,1.013339 3.0041715,1.57195 0.937518,0.360875 2.612202,0.647642 3.91241,0.978102 0.112814,3.85566 0.703989,7.107756 1.606883,9.920754 -1.147172,-0.324262 -2.644553,-0.640648 -3.423359,-0.978102 -1.516688,-0.657177 -2.386627,-1.287332 -2.864443,-1.71168 -0.477816,-0.424347 -0.489051,-0.489051 -0.489051,-0.489051 L 9.8002387,40.319395 C 8.791691,37.621767 8.1584238,34.769583 8.1584238,31.900727 c 0,-0.330153 0.090589,-0.648169 0.1047967,-0.978102 z m 48.2763445,0.419186 c 0.0047,0.188973 0.06986,0.36991 0.06986,0.558916 0,2.938869 -0.620228,5.873558 -1.676747,8.628261 -0.07435,0.07583 -0.06552,0.07411 -0.454119,0.349323 -0.606965,0.429857 -1.631665,1.042044 -3.318562,1.676747 -1.208528,0.454713 -3.204964,0.850894 -5.135038,1.25756 0.84593,-2.765726 1.41808,-6.005357 1.606883,-9.815957 2.232369,-0.413371 4.483758,-0.840201         5.938479,-1.327425 1.410632,-0.472457 2.153108,-0.89469 2.96924,-1.327425 z m -38.530252,2.864443 c 3.208141,0.56697 7.372279,0.898588 12.575603,0.978103 l 0.174662,9.885821 c -4.392517,-0.06139 -8.106722,-0.320566 -10.863925,-0.803441 -1.051954,-2.664695 -1.692909,-6.043794 -1.88634,-10.060483 z m 26.793022,0.31439 c -0.246298,3.923551 -0.877762,7.263679 -1.816476,9.885822 -2.561957,0.361954 -5.766249,0.560708 -9.431703,0.62878 l -0.174661,-9.815957 c 4.491734,-0.04969 8.334769,-0.293032 11.42284,-0.698645 z M 12.035901,44.860585 c 0.09977,0.04523 0.105535,0.09465 0.209594,0.139729 1.337656,0.579602 3.441099,1.058072 5.589157,1.537018 1.545042,3.399208 3.548524,5.969402 5.589157,7.789888 -3.034411,-1.215537 -5.871615,-3.007978 -8.174142,-5.309699 -1.245911,-1.245475 -2.271794,-2.662961 -3.213766,-4.156936 z m 40.69605,0 c -0.941972,1.493975 -1.967855,2.911461         -3.213765,4.156936 -2.74253,2.741571 -6.244106,4.696717 -9.955686,5.868615 0.261347,-0.241079 0.507495,-0.394491 0.768509,-0.663713 1.674841,-1.727516 3.320792,-4.181056 4.645987,-7.265904 2.962447,-0.503021 5.408965,-1.122293 7.161107,-1.781544 0.284034,-0.106865 0.337297,-0.207323 0.593848,-0.31439 z m -31.404076,2.305527 c 2.645807,0.376448 5.701178,0.649995 9.466635,0.698645 l 0.139729,7.789888 c -1.38739,-0.480844 -3.316218,-1.29837 -5.659022,-3.388427 -1.388822,-1.238993 -2.743668,-3.0113 -3.947342,-5.100106 z m 20.365491,0.104797 c -1.04872,2.041937 -2.174337,3.779068 -3.353494,4.995309 -1.853177,1.911459 -3.425515,2.82679 -4.611055,3.353494 l -0.139729,-7.789887 c 3.13091,-0.05714 5.728238,-0.278725 8.104278,-0.558916 z";var u="m 2.9825053,17.550598 0,1.368113 0,26.267766 0,1.368113 1.36811,0 54.9981397,0 1.36811,0 0,-1.368113 0,-26.267766 0,-1.368113 -1.36811,0 -54.9981397,0 -1.36811,0 z m 2.73623,2.736226 10.3292497,0 0,10.466063 -10.3292497,0 0,-10.466063 z m 13.0654697,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 10.32926,0 0,10.466063 -10.32926,0 0,-10.466063 z m -41.9326497,13.202288 10.3292497,0 0,10.329252 -10.3292497,0 0,-10.329252 z m 13.0654697,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 10.32926,0 0,10.329252 -10.32926,0 0,-10.329252 z";var c="m 14.723969,17.675598 -0.340489,0.817175 -11.1680536,26.183638 -0.817175,1.872692 2.076986,0 54.7506996,0 2.07698,0 -0.81717,-1.872692 -11.16805,-26.183638 -0.34049,-0.817175 -0.91933,0 -32.414586,0 -0.919322,0 z m 1.838643,2.723916 6.196908,0 -2.928209,10.418977 -7.729111,0 4.460412,-10.418977 z m 9.02297,0 4.903049,0 0,10.418977 -7.831258,0 2.928209,-10.418977 z m 7.626964,0 5.584031,0 2.62176,10.418977 -8.205791,0 0,-10.418977 z m 8.410081,0 5.51593,0 4.46042,10.418977 -7.38863,0 -2.58772,-10.418977 z m -30.678091,13.142892 8.103649,0 -2.89416,10.282782 -9.6018026,0 4.3923136,-10.282782 z m 10.929711,0 8.614384,0 0,10.282782 -11.508544,0 2.89416,-10.282782 z m 11.338299,0 8.852721,0 2.58772,10.282782 -11.440441,0 0,-10.282782 z m 11.678781,0 7.86531,0 4.39231,10.282782 -9.6699,0 -2.58772,-10.282782 z";function d(t,r,d){if(!e(t)){throw new i("container is required.")}if(!e(r)){throw new i("scene is required.")}t=o(t);var f=new s(r,d);f._globePath=l;f._flatMapPath=u;f._columbusViewPath=c;var h=document.createElement("span");h.className="cesium-sceneModePicker-wrapper cesium-toolbar-button";t.appendChild(h);var p=document.createElement("button");p.type="button";p.className="cesium-button cesium-toolbar-button";p.setAttribute("data-bind",'css: { "cesium-sceneModePicker-button2D": sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-button3D": sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-buttonColumbusView": sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown');p.innerHTML='\x3c!-- ko cesiumSvgPath: { path: _globePath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon3D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon2D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-iconColumbusView" } --\x3e\x3c!-- /ko --\x3e';h.appendChild(p);var m=document.createElement("button");m.type="button";m.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon";m.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE3D)) || (!dropDownVisible && (sceneMode === _sceneMode.SCENE3D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip3D },click: morphTo3D,cesiumSvgPath: { path: _globePath, width: 64, height: 64 }');h.appendChild(m);var v=document.createElement("button");v.type="button";v.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon";v.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE2D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip2D },click: morphTo2D,cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64 }');h.appendChild(v);var g=document.createElement("button");g.type="button";g.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon";g.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.COLUMBUS_VIEW)) || (!dropDownVisible && (sceneMode === _sceneMode.COLUMBUS_VIEW)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-hidden" : !dropDownVisible},attr: { title: tooltipColumbusView },click: morphToColumbusView,cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64 }');h.appendChild(g);a.applyBindings(f,h);this._viewModel=f;this._container=t;this._wrapper=h;this._closeDropDown=function(e){if(!h.contains(e.target)){f.dropDownVisible=false}};if(n.supportsPointerEvents()){document.addEventListener("pointerdown",this._closeDropDown,true)}else{document.addEventListener("mousedown",this._closeDropDown,true);document.addEventListener("touchstart",this._closeDropDown,true)}}t(d.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});d.prototype.isDestroyed=function(){return false};d.prototype.destroy=function(){this._viewModel.destroy();if(n.supportsPointerEvents()){document.removeEventListener("pointerdown",this._closeDropDown,true)}else{document.removeEventListener("mousedown",this._closeDropDown,true);document.removeEventListener("touchstart",this._closeDropDown,true)}a.cleanNode(this._wrapper);this._container.removeChild(this._wrapper);return r(this)};return d});define("Widgets/SelectionIndicator/SelectionIndicatorViewModel",["../../Core/Cartesian2","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/EasingFunction","../../Scene/SceneTransforms","../../ThirdParty/knockout"],function(e,t,r,i,n,a,o,s){"use strict";var l=new e;var u="-1000px";function c(e,i,a){if(!r(e)){throw new n("scene is required.")}if(!r(i)){throw new n("selectionIndicatorElement is required.")}if(!r(a)){throw new n("container is required.")}this._scene=e;this._screenPositionX=u;this._screenPositionY=u;this._tweens=e.tweens;this._container=t(a,document.body);this._selectionIndicatorElement=i;this._scale=1;this.position=undefined;this.showSelection=false;s.track(this,["position","_screenPositionX","_screenPositionY","_scale","showSelection"]);this.isVisible=undefined;s.defineProperty(this,"isVisible",{get:function(){return this.showSelection&&r(this.position)}});s.defineProperty(this,"_transform",{get:function(){return"scale("+this._scale+")"}});this.computeScreenSpacePosition=function(t,r){return o.wgs84ToWindowCoordinates(e,t,r)}}c.prototype.update=function(){if(this.showSelection&&r(this.position)){var e=this.computeScreenSpacePosition(this.position,l);if(!r(e)){this._screenPositionX=u;this._screenPositionY=u}else{var t=this._container;var i=t.parentNode.clientWidth;var n=t.parentNode.clientHeight;var a=this._selectionIndicatorElement.clientWidth;var o=a*.5;e.x=Math.min(Math.max(e.x,-a),i+a)-o;e.y=Math.min(Math.max(e.y,-a),n+a)-o;this._screenPositionX=Math.floor(e.x+.25)+"px";this._screenPositionY=Math.floor(e.y+.25)+"px"}}};c.prototype.animateAppear=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:2,stopValue:1,duration:.8,easingFunction:a.EXPONENTIAL_OUT})};c.prototype.animateDepart=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:this._scale,stopValue:1.5,duration:.8,easingFunction:a.EXPONENTIAL_OUT})};i(c.prototype,{container:{get:function(){return this._container}},selectionIndicatorElement:{get:function(){return this._selectionIndicatorElement}},scene:{get:function(){return this._scene}}});return c});define("Widgets/SelectionIndicator/SelectionIndicator",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./SelectionIndicatorViewModel"],function(e,t,r,i,n,a,o){"use strict";function s(t,r){if(!e(t)){throw new i("container is required.")}t=a(t);this._container=t;var s=document.createElement("div");s.className="cesium-selection-wrapper";s.setAttribute("data-bind",'style: { "top" : _screenPositionY, "left" : _screenPositionX },css: { "cesium-selection-wrapper-visible" : isVisible }');t.appendChild(s);this._element=s;var l="http://www.w3.org/2000/svg";var u="M -34 -34 L -34 -11.25 L -30 -15.25 L -30 -30 L -15.25 -30 L -11.25 -34 L -34 -34 z M 11.25 -34 L 15.25 -30 L 30 -30 L 30 -15.25 L 34 -11.25 L 34 -34 L 11.25 -34 z M -34 11.25 L -34 34 L -11.25 34 L -15.25 30 L -30 30 L -30 15.25 L -34 11.25 z M 34 11.25 L 30 15.25 L 30 30 L 15.25 30 L 11.25 34 L 34 34 L 34 11.25 z";var c=document.createElementNS(l,"svg:svg");c.setAttribute("width",160);c.setAttribute("height",160);c.setAttribute("viewBox","0 0 160 160");var d=document.createElementNS(l,"g");d.setAttribute("transform","translate(80,80)");c.appendChild(d);var f=document.createElementNS(l,"path");f.setAttribute("data-bind","attr: { transform: _transform }");f.setAttribute("d",u);d.appendChild(f);s.appendChild(c);var h=new o(r,this._element,this._container);this._viewModel=h;n.applyBindings(this._viewModel,this._element)}t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});s.prototype.isDestroyed=function(){return false};s.prototype.destroy=function(){var e=this._container;n.cleanNode(this._element);e.removeChild(this._element);return r(this)};return s});define("Widgets/Timeline/TimelineHighlightRange",["../../Core/defaultValue","../../Core/JulianDate"],function(e,t){"use strict";function r(t,r,i){this._color=t;this._height=r;this._base=e(i,0)}r.prototype.getHeight=function(){return this._height};r.prototype.getBase=function(){return this._base};r.prototype.getStartTime=function(){return this._start};r.prototype.getStopTime=function(){return this._stop};r.prototype.setRange=function(e,t){this._start=e;this._stop=t};r.prototype.render=function(e){var r="";if(this._start&&this._stop&&this._color){var i=t.secondsDifference(this._start,e.epochJulian);var n=Math.round(e.timeBarWidth*e.getAlpha(i));var a=t.secondsDifference(this._stop,e.epochJulian);var o=Math.round(e.timeBarWidth*e.getAlpha(a))-n;if(n<0){o+=n;n=0}if(n+o>e.timeBarWidth){o=e.timeBarWidth-n}if(o>0){r='<span class="cesium-timeline-highlight" style="left: '+n.toString()+"px; width: "+o.toString()+"px; bottom: "+this._base.toString()+"px; height: "+this._height+"px; background-color: "+this._color+';"></span>'}}return r};return r});define("Widgets/Timeline/TimelineTrack",["../../Core/Color","../../Core/defined","../../Core/JulianDate"],function(e,t,r){"use strict";function i(t,r,i,n){this.interval=t;this.height=r;this.color=i||new e(.5,.5,.5,1);this.backgroundColor=n||new e(0,0,0,0)}i.prototype.render=function(e,i){var n=this.interval.start;var a=this.interval.stop;var o=i.startJulian;var s=r.addSeconds(i.startJulian,i.duration,new r);if(r.lessThan(n,o)&&r.greaterThan(a,s)){e.fillStyle=this.color.toCssColorString();e.fillRect(0,i.y,i.timeBarWidth,this.height)}else if(r.lessThanOrEquals(n,s)&&r.greaterThanOrEquals(a,o)){var l;var u,c;for(l=0;l<i.timeBarWidth;++l){var d=r.addSeconds(i.startJulian,l/i.timeBarWidth*i.duration,new r);if(!t(u)&&r.greaterThanOrEquals(d,n)){u=l}else if(!t(c)&&r.greaterThanOrEquals(d,a)){c=l}}e.fillStyle=this.backgroundColor.toCssColorString();e.fillRect(0,i.y,i.timeBarWidth,this.height);if(t(u)){if(!t(c)){c=i.timeBarWidth}e.fillStyle=this.color.toCssColorString();e.fillRect(u,i.y,Math.max(c-u,1),this.height)}}};return i});define("Widgets/Timeline/Timeline",["../../Core/ClockRange","../../Core/defined","../../Core/destroyObject","../../Core/DeveloperError","../../Core/JulianDate","../getElement","./TimelineHighlightRange","./TimelineTrack"],function(e,t,r,i,n,a,o,s){"use strict";var l=1e12;var u={none:0,scrub:1,slide:2,zoom:3,touchOnly:4};var c={none:0,scrub:1,slideZoom:2,singleTap:3,ignore:4};var d=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800,1296e3,2592e3,5184e3,7776e3,15552e3,31536e3,63072e3,126144e3,15768e4,31536e4,63072e4,126144e4,15768e5,31536e5,63072e5,126144e5,15768e6,31536e6];var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function h(e,r){if(!t(e)){throw new i("container is required.")}if(!t(r)){throw new i("clock is required.")}e=a(e);this.container=e;var n=document.createElement("div");n.className="cesium-timeline-main";e.appendChild(n);this._topDiv=n;this._endJulian=undefined;this._epochJulian=undefined;this._lastXPos=undefined;this._scrubElement=undefined;this._startJulian=undefined;this._timeBarSecondsSpan=undefined;this._clock=r;this._scrubJulian=r.currentTime;this._mainTicSpan=-1;this._mouseMode=u.none;this._touchMode=c.none;this._touchState={centerX:0,spanX:0};this._mouseX=0;this._timelineDrag=0;this._timelineDragLocation=undefined;this._lastHeight=undefined;this._lastWidth=undefined;this._topDiv.innerHTML='<div class="cesium-timeline-bar"></div><div class="cesium-timeline-trackContainer">'+'<canvas class="cesium-timeline-tracks" width="10" height="1">'+'</canvas></div><div class="cesium-timeline-needle"></div><span class="cesium-timeline-ruler"></span>';this._timeBarEle=this._topDiv.childNodes[0];this._trackContainer=this._topDiv.childNodes[1];this._trackListEle=this._topDiv.childNodes[1].childNodes[0];this._needleEle=this._topDiv.childNodes[2];this._rulerEle=this._topDiv.childNodes[3];this._context=this._trackListEle.getContext("2d");this._trackList=[];this._highlightRanges=[];this.zoomTo(r.startTime,r.stopTime);this._onMouseDown=m(this);this._onMouseUp=v(this);this._onMouseMove=g(this);this._onMouseWheel=_(this);this._onTouchStart=y(this);this._onTouchMove=w(this);this._onTouchEnd=b(this);var o=this._timeBarEle;document.addEventListener("mouseup",this._onMouseUp,false);document.addEventListener("mousemove",this._onMouseMove,false);o.addEventListener("mousedown",this._onMouseDown,false);o.addEventListener("DOMMouseScroll",this._onMouseWheel,false);o.addEventListener("mousewheel",this._onMouseWheel,false);o.addEventListener("touchstart",this._onTouchStart,false);o.addEventListener("touchmove",this._onTouchMove,false);o.addEventListener("touchend",this._onTouchEnd,false);o.addEventListener("touchcancel",this._onTouchEnd,false);this._topDiv.oncontextmenu=function(){return false};r.onTick.addEventListener(this.updateFromClock,this);this.updateFromClock()}h.prototype.addEventListener=function(e,t,r){this._topDiv.addEventListener(e,t,r)};h.prototype.removeEventListener=function(e,t,r){this._topDiv.removeEventListener(e,t,r)};h.prototype.isDestroyed=function(){return false};h.prototype.destroy=function(){this._clock.onTick.removeEventListener(this.updateFromClock,this);document.removeEventListener("mouseup",this._onMouseUp,false);document.removeEventListener("mousemove",this._onMouseMove,false);var e=this._timeBarEle;e.removeEventListener("mousedown",this._onMouseDown,false);e.removeEventListener("DOMMouseScroll",this._onMouseWheel,false);e.removeEventListener("mousewheel",this._onMouseWheel,false);e.removeEventListener("touchstart",this._onTouchStart,false);e.removeEventListener("touchmove",this._onTouchMove,false);e.removeEventListener("touchend",this._onTouchEnd,false);e.removeEventListener("touchcancel",this._onTouchEnd,false);this.container.removeChild(this._topDiv);r(this)};h.prototype.addHighlightRange=function(e,t,r){var i=new o(e,t,r);this._highlightRanges.push(i);this.resize();return i};h.prototype.addTrack=function(e,t,r,i){var n=new s(e,t,r,i);this._trackList.push(n);this._lastHeight=undefined;this.resize();return n};h.prototype.zoomTo=function(r,a){if(!t(r)){throw new i("startTime is required.")}if(!t(a)){throw new i("stopTime is required")}if(n.lessThanOrEquals(a,r)){throw new i("Start time must come before end time.")}this._startJulian=r;this._endJulian=a;this._timeBarSecondsSpan=n.secondsDifference(a,r);if(this._clock&&this._clock.clockRange!==e.UNBOUNDED){var o=this._clock.startTime;var s=this._clock.stopTime;var l=n.secondsDifference(s,o);var u=n.secondsDifference(o,this._startJulian);var c=n.secondsDifference(s,this._endJulian);if(this._timeBarSecondsSpan>=l){this._timeBarSecondsSpan=l;this._startJulian=this._clock.startTime;this._endJulian=this._clock.stopTime}else if(u>0){this._endJulian=n.addSeconds(this._endJulian,u,new n);this._startJulian=o;this._timeBarSecondsSpan=n.secondsDifference(this._endJulian,this._startJulian)}else if(c<0){this._startJulian=n.addSeconds(this._startJulian,c,new n);this._endJulian=s;this._timeBarSecondsSpan=n.secondsDifference(this._endJulian,this._startJulian)}}this._makeTics();var d=document.createEvent("Event");d.initEvent("setzoom",true,true);d.startJulian=this._startJulian;d.endJulian=this._endJulian;d.epochJulian=this._epochJulian;d.totalSpan=this._timeBarSecondsSpan;d.mainTicSpan=this._mainTicSpan;this._topDiv.dispatchEvent(d)};h.prototype.zoomFrom=function(e){var t=n.secondsDifference(this._scrubJulian,this._startJulian);if(e>1||t<0||t>this._timeBarSecondsSpan){t=this._timeBarSecondsSpan*.5}else{t+=t-this._timeBarSecondsSpan*.5}var r=this._timeBarSecondsSpan-t;this.zoomTo(n.addSeconds(this._startJulian,t-t*e,new n),n.addSeconds(this._endJulian,r*e-r,new n))};function p(e){return e<10?"0"+e.toString():e.toString()}h.prototype.makeLabel=function(e){var t=n.toGregorianDate(e);var r=t.millisecond,i=" UTC";if(r>0&&this._timeBarSecondsSpan<3600){i=Math.floor(r).toString();while(i.length<3){i="0"+i}i="."+i}return f[t.month-1]+" "+t.day+" "+t.year+" "+p(t.hour)+":"+p(t.minute)+":"+p(t.second)+i};h.prototype.smallestTicInPixels=7;h.prototype._makeTics=function(){var e=this._timeBarEle;var t=n.secondsDifference(this._scrubJulian,this._startJulian);var r=Math.round(t*this._topDiv.clientWidth/this._timeBarSecondsSpan);var i=r-8,a;var o=this;this._needleEle.style.left=r.toString()+"px";var s="";var l=.01;var u=31536e6;var c=1e-10;var f=0;var h=this._timeBarSecondsSpan;if(h<l){h=l;this._timeBarSecondsSpan=l;this._endJulian=n.addSeconds(this._startJulian,l,new n)}else if(h>u){h=u;this._timeBarSecondsSpan=u;this._endJulian=n.addSeconds(this._startJulian,u,new n)}var p=this._timeBarEle.clientWidth;if(p<10){p=10}var m=this._startJulian;var v=Math.min(h/p*1e-5,.4);var g;var _=n.toGregorianDate(m);if(h>31536e4){g=n.fromDate(new Date(Date.UTC(Math.floor(_.year/100)*100,0)))}else if(h>31536e3){g=n.fromDate(new Date(Date.UTC(Math.floor(_.year/10)*10,0)))}else if(h>86400){g=n.fromDate(new Date(Date.UTC(_.year,0)))}else{g=n.fromDate(new Date(Date.UTC(_.year,_.month,_.day)))}var y=n.secondsDifference(this._startJulian,n.addSeconds(g,v,new n));var b=y+h;this._epochJulian=g;function w(e){return Math.floor(y/e)*e}function C(e,t){return Math.ceil(e/t+.5)*t}function S(e){return(e-y)/h}function T(e,t){return e-t*Math.round(e/t)}this._rulerEle.innerHTML=this.makeLabel(n.addSeconds(this._endJulian,-l,new n));var E=this._rulerEle.offsetWidth+20;if(E<30){E=180}var x=f;f-=c;var P={startTime:y,startJulian:m,epochJulian:g,duration:h,timeBarWidth:p,getAlpha:S};this._highlightRanges.forEach(function(e){s+=e.render(P)});var A=0,O=0,D=0;var I=E/p;if(I>1){I=1}I*=this._timeBarSecondsSpan;var M=-1,R=-1;var L,N=d.length;for(L=0;L<N;++L){var k=d[L];++M;A=k;if(k>I&&k>f){break}if(R<0&&p*(k/this._timeBarSecondsSpan)>=this.smallestTicInPixels){R=M}}if(M>0){while(M>0){--M;if(Math.abs(T(A,d[M]))<1e-5){if(d[M]>=f){O=d[M]}break}}if(R>=0){while(R<M){if(Math.abs(T(O,d[R]))<1e-5&&d[R]>=f){D=d[R];break}++R}}}f=x;if(f>c&&D<1e-5&&Math.abs(f-A)>c){D=f;if(f<=A+c){O=0}}var F=-999999,B;if(p*(D/this._timeBarSecondsSpan)>=3){for(a=w(D);a<=b;a=C(a,D)){s+='<span class="cesium-timeline-ticTiny" style="left: '+Math.round(p*S(a)).toString()+'px;"></span>'}}if(p*(O/this._timeBarSecondsSpan)>=3){for(a=w(O);a<=b;a=C(a,O)){s+='<span class="cesium-timeline-ticSub" style="left: '+Math.round(p*S(a)).toString()+'px;"></span>'}}if(p*(A/this._timeBarSecondsSpan)>=2){this._mainTicSpan=A;b+=A;a=w(A);var U=n.computeTaiMinusUtc(g);while(a<=b){var V=n.addSeconds(m,a-y,new n);if(A>2.1){var z=n.computeTaiMinusUtc(V);if(Math.abs(z-U)>.1){a+=z-U;V=n.addSeconds(m,a-y,new n)}}var q=Math.round(p*S(a));var G=this.makeLabel(V);this._rulerEle.innerHTML=G;B=this._rulerEle.offsetWidth;if(B<10){B=E}var H=q-(B/2-1);if(H>F){F=H+B+5;s+='<span class="cesium-timeline-ticMain" style="left: '+q.toString()+'px;"></span>'+'<span class="cesium-timeline-ticLabel" style="left: '+H.toString()+'px;">'+G+"</span>"}else{s+='<span class="cesium-timeline-ticSub" style="left: '+q.toString()+'px;"></span>'}a=C(a,A)}}else{this._mainTicSpan=-1}s+='<span class="cesium-timeline-icon16" style="left:'+i+'px;bottom:0;background-position: 0 0;"></span>';e.innerHTML=s;this._scrubElement=e.lastChild;this._context.clearRect(0,0,this._trackListEle.width,this._trackListEle.height);P.y=0;this._trackList.forEach(function(e){e.render(o._context,P);P.y+=e.height})};h.prototype.updateFromClock=function(){this._scrubJulian=this._clock.currentTime;var e=this._scrubElement;if(t(this._scrubElement)){var r=n.secondsDifference(this._scrubJulian,this._startJulian);var i=Math.round(r*this._topDiv.clientWidth/this._timeBarSecondsSpan);if(this._lastXPos!==i){this._lastXPos=i;e.style.left=i-8+"px";this._needleEle.style.left=i+"px"}}if(t(this._timelineDragLocation)){this._setTimeBarTime(this._timelineDragLocation,this._timelineDragLocation*this._timeBarSecondsSpan/this._topDiv.clientWidth);this.zoomTo(n.addSeconds(this._startJulian,this._timelineDrag,new n),n.addSeconds(this._endJulian,this._timelineDrag,new n))}};h.prototype._setTimeBarTime=function(e,t){e=Math.round(e);this._scrubJulian=n.addSeconds(this._startJulian,t,new n);if(this._scrubElement){var r=e-8;this._scrubElement.style.left=r.toString()+"px";this._needleEle.style.left=e.toString()+"px"}var i=document.createEvent("Event");i.initEvent("settime",true,true);i.clientX=e;i.timeSeconds=t;i.timeJulian=this._scrubJulian;i.clock=this._clock;this._topDiv.dispatchEvent(i)};function m(e){return function(t){if(e._mouseMode!==u.touchOnly){if(t.button===0){e._mouseMode=u.scrub;if(e._scrubElement){e._scrubElement.style.backgroundPosition="-16px 0"}e._onMouseMove(t)}else{e._mouseX=t.clientX;if(t.button===2){e._mouseMode=u.zoom}else{e._mouseMode=u.slide}}}t.preventDefault()}}function v(e){return function(t){e._mouseMode=u.none;if(e._scrubElement){e._scrubElement.style.backgroundPosition="0 0"}e._timelineDrag=0;e._timelineDragLocation=undefined}}function g(e){return function(t){var r;if(e._mouseMode===u.scrub){t.preventDefault();var i=t.clientX-e._topDiv.getBoundingClientRect().left;if(i<0){e._timelineDragLocation=0;e._timelineDrag=-.01*e._timeBarSecondsSpan}else if(i>e._topDiv.clientWidth){e._timelineDragLocation=e._topDiv.clientWidth;e._timelineDrag=.01*e._timeBarSecondsSpan}else{e._timelineDragLocation=undefined;e._setTimeBarTime(i,i*e._timeBarSecondsSpan/e._topDiv.clientWidth)}}else if(e._mouseMode===u.slide){r=e._mouseX-t.clientX;e._mouseX=t.clientX;if(r!==0){var a=r*e._timeBarSecondsSpan/e._topDiv.clientWidth;e.zoomTo(n.addSeconds(e._startJulian,a,new n),n.addSeconds(e._endJulian,a,new n))}}else if(e._mouseMode===u.zoom){r=e._mouseX-t.clientX;e._mouseX=t.clientX;if(r!==0){e.zoomFrom(Math.pow(1.01,r))}}}}function _(e){return function(t){var r=t.wheelDeltaY||t.wheelDelta||-t.detail;l=Math.max(Math.min(Math.abs(r),l),1);r/=l;e.zoomFrom(Math.pow(1.05,-r))}}function y(e){return function(t){var r=t.touches.length,i,a,o=e._topDiv.getBoundingClientRect().left;t.preventDefault();e._mouseMode=u.touchOnly;if(r===1){i=n.secondsDifference(e._scrubJulian,e._startJulian);a=Math.round(i*e._topDiv.clientWidth/e._timeBarSecondsSpan+o);if(Math.abs(t.touches[0].clientX-a)<50){e._touchMode=c.scrub;if(e._scrubElement){e._scrubElement.style.backgroundPosition=r===1?"-16px 0":"0 0"}}else{e._touchMode=c.singleTap;e._touchState.centerX=t.touches[0].clientX-o}}else if(r===2){e._touchMode=c.slideZoom;e._touchState.centerX=(t.touches[0].clientX+t.touches[1].clientX)*.5-o;e._touchState.spanX=Math.abs(t.touches[0].clientX-t.touches[1].clientX)}else{e._touchMode=c.ignore}}}function b(e){return function(t){var r=t.touches.length,i=e._topDiv.getBoundingClientRect().left;if(e._touchMode===c.singleTap){e._touchMode=c.scrub;e._onTouchMove(t)}else if(e._touchMode===c.scrub){e._onTouchMove(t)}e._mouseMode=u.touchOnly;if(r!==1){e._touchMode=r>0?c.ignore:c.none}else if(e._touchMode===c.slideZoom){e._touchState.centerX=t.touches[0].clientX-i}if(e._scrubElement){e._scrubElement.style.backgroundPosition="0 0"}}}function w(e){return function(r){var i,a,o,s,l,d,f=1,h=e._topDiv.getBoundingClientRect().left;if(e._touchMode===c.singleTap){e._touchMode=c.slideZoom}e._mouseMode=u.touchOnly;if(e._touchMode===c.scrub){r.preventDefault();if(r.changedTouches.length===1){a=r.changedTouches[0].clientX-h;if(a>=0&&a<=e._topDiv.clientWidth){e._setTimeBarTime(a,a*e._timeBarSecondsSpan/e._topDiv.clientWidth)}}}else if(e._touchMode===c.slideZoom){o=r.touches.length;if(o===2){s=(r.touches[0].clientX+r.touches[1].clientX)*.5-h;l=Math.abs(r.touches[0].clientX-r.touches[1].clientX)}else if(o===1){s=r.touches[0].clientX-h;l=0}if(t(s)){if(l>0&&e._touchState.spanX>0){f=e._touchState.spanX/l;d=n.addSeconds(e._startJulian,(e._touchState.centerX*e._timeBarSecondsSpan-s*e._timeBarSecondsSpan*f)/e._topDiv.clientWidth,new n)}else{i=e._touchState.centerX-s;d=n.addSeconds(e._startJulian,i*e._timeBarSecondsSpan/e._topDiv.clientWidth,new n)}e.zoomTo(d,n.addSeconds(d,e._timeBarSecondsSpan*f,new n));e._touchState.centerX=s;e._touchState.spanX=l}}}}h.prototype.resize=function(){var e=this.container.clientWidth;var t=this.container.clientHeight;if(e===this._lastWidth&&t===this._lastHeight){return}this._trackContainer.style.height=t+"px";var r=1;this._trackList.forEach(function(e){r+=e.height});this._trackListEle.style.height=r.toString()+"px";this._trackListEle.width=this._trackListEle.clientWidth;this._trackListEle.height=r;this._makeTics();this._lastXPos=undefined;this._lastWidth=e;this._lastHeight=t};return h});define("Widgets/VRButton/VRButtonViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Core/Fullscreen","../../Core/OrthographicFrustum","../../ThirdParty/knockout","../../ThirdParty/NoSleep","../createCommand","../getElement"],function(e,t,r,i,n,a,o,s,l,u,c,d){"use strict";function f(e){var r=false;var i=window.screen;if(t(i)){if(t(i.lockOrientation)){r=i.lockOrientation(e)}else if(t(i.mozLockOrientation)){r=i.mozLockOrientation(e)}else if(t(i.msLockOrientation)){r=i.msLockOrientation(e)}else if(t(i.orientation&&i.orientation.lock)){r=i.orientation.lock(e)}}return r}function h(){var e=window.screen;if(t(e)){if(t(e.unlockOrientation)){e.unlockOrientation()}else if(t(e.mozUnlockOrientation)){e.mozUnlockOrientation()}else if(t(e.msUnlockOrientation)){e.msUnlockOrientation()}else if(t(e.orientation&&e.orientation.unlock)){e.orientation.unlock()}}}function p(e,t,r,i){if(i()){return}if(r()){t.useWebVR=false;if(e._locked){h();e._locked=false}e._noSleep.disable();o.exitFullscreen();r(false)}else{if(!o.fullscreen){o.requestFullscreen(e._vrElement)}e._noSleep.enable();if(!e._locked){e._locked=f("landscape")}t.useWebVR=true;r(true)}}function m(r,i){if(!t(r)){throw new n("scene is required.")}var f=this;var m=l.observable(o.enabled);var v=l.observable(false);this.isVRMode=undefined;l.defineProperty(this,"isVRMode",{get:function(){return v()}});this.isVREnabled=undefined;l.defineProperty(this,"isVREnabled",{get:function(){return m()},set:function(e){m(e&&o.enabled)}});this.tooltip=undefined;l.defineProperty(this,"tooltip",function(){if(!m()){return"VR mode is unavailable"}return v()?"Exit VR mode":"Enter VR mode"});var g=l.observable(false);this._isOrthographic=undefined;l.defineProperty(this,"_isOrthographic",{get:function(){return g()}});this._eventHelper=new a;this._eventHelper.add(r.preRender,function(){g(r.camera.frustum instanceof s)});this._locked=false;this._noSleep=new u;this._command=c(function(){p(f,r,v,g)},l.getObservable(this,"isVREnabled"));this._vrElement=e(d(i),document.body);this._callback=function(){if(!o.fullscreen&&v()){r.useWebVR=false;if(f._locked){h();f._locked=false}f._noSleep.disable();v(false)}};document.addEventListener(o.changeEventName,this._callback)}r(m.prototype,{vrElement:{get:function(){return this._vrElement},set:function(e){if(!(e instanceof Element)){throw new n("value must be a valid Element.")}this._vrElement=e}},command:{get:function(){return this._command}}});m.prototype.isDestroyed=function(){return false};m.prototype.destroy=function(){this._eventHelper.removeAll();document.removeEventListener(o.changeEventName,this._callback);i(this)};return m});define("Widgets/VRButton/VRButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./VRButtonViewModel"],function(e,t,r,i,n,a,o){"use strict";var s="M 5.3125 6.375 C 4.008126 6.375 2.96875 7.4141499 2.96875 8.71875 L 2.96875 19.5 C 2.96875 20.8043 4.008126 21.875 5.3125 21.875 L 13.65625 21.875 C 13.71832 20.0547 14.845166 18.59375 16.21875 18.59375 C 17.592088 18.59375 18.71881 20.0552 18.78125 21.875 L 27.09375 21.875 C 28.398125 21.875 29.4375 20.8043 29.4375 19.5 L 29.4375 8.71875 C 29.4375 7.4141499 28.398125 6.375 27.09375 6.375 L 5.3125 6.375 z M 9.625 10.4375 C 11.55989 10.4375 13.125 12.03385 13.125 13.96875 C 13.125 15.90365 11.55989 17.46875 9.625 17.46875 C 7.69011 17.46875 6.125 15.90365 6.125 13.96875 C 6.125 12.03385 7.69011 10.4375 9.625 10.4375 z M 22.46875 10.4375 C 24.40364 10.4375 25.96875 12.03385 25.96875 13.96875 C 25.96875 15.90365 24.40364 17.46875 22.46875 17.46875 C 20.53386 17.46875 18.96875 15.90365 18.96875 13.96875 C 18.96875 12.03385 20.53386 10.4375 22.46875 10.4375 z";var l="M 25.770585,2.4552065 C 15.72282,13.962707 10.699956,19.704407 8.1768352,22.580207 c -1.261561,1.4379 -1.902282,2.1427 -2.21875,2.5 -0.141624,0.1599 -0.208984,0.2355 -0.25,0.2813 l 0.6875,0.75 c 10e-5,-10e-5 0.679191,0.727 0.6875,0.7187 0.01662,-0.016 0.02451,-0.024 0.03125,-0.031 0.01348,-0.014 0.04013,-0.038 0.0625,-0.062 0.04474,-0.05 0.120921,-0.1315 0.28125,-0.3126 0.320657,-0.3619 0.956139,-1.0921 2.2187499,-2.5312 2.5252219,-2.8781 7.5454589,-8.6169 17.5937499,-20.1250005 l -1.5,-1.3125 z m -20.5624998,3.9063 c -1.304375,0 -2.34375,1.0391 -2.34375,2.3437 l 0,10.8125005 c 0,1.3043 1.039375,2.375 2.34375,2.375 l 2.25,0 c 1.9518039,-2.2246 7.4710958,-8.5584 13.5624998,-15.5312005 l -15.8124998,0 z m 21.1249998,0 c -1.855467,2.1245 -2.114296,2.4005 -3.59375,4.0936995 1.767282,0.1815 3.15625,1.685301 3.15625,3.500001 0,1.9349 -1.56511,3.5 -3.5,3.5 -1.658043,0 -3.043426,-1.1411 -3.40625,-2.6875 -1.089617,1.2461 -2.647139,2.9988 -3.46875,3.9375 0.191501,-0.062 0.388502,-0.094 0.59375,-0.094 1.373338,0 2.50006,1.4614 2.5625,3.2812 l 8.3125,0 c 1.304375,0 2.34375,-1.0707 2.34375,-2.375 l 0,-10.8125005 c 0,-1.3046 -1.039375,-2.3437 -2.34375,-2.3437 l -0.65625,0 z M 9.5518351,10.423906 c 1.9348899,0 3.4999999,1.596401 3.4999999,3.531301 0,1.9349 -1.56511,3.5 -3.4999999,3.5 -1.9348899,0 -3.4999999,-1.5651 -3.4999999,-3.5 0,-1.9349 1.56511,-3.531301 3.4999999,-3.531301 z m 4.2187499,10.312601 c -0.206517,0.2356 -0.844218,0.9428 -1.03125,1.1562 l 0.8125,0 c 0.01392,-0.4081 0.107026,-0.7968 0.21875,-1.1562 z";function u(t,r,u){if(!e(t)){throw new i("container is required.")}if(!e(r)){throw new i("scene is required.")}t=a(t);var c=new o(r,u);c._exitVRPath=l;c._enterVRPath=s;var d=document.createElement("button");d.type="button";d.className="cesium-button cesium-vrButton";d.setAttribute("data-bind",'css: { "cesium-button-disabled" : _isOrthographic }, attr: { title: tooltip },click: command,enable: isVREnabled,cesiumSvgPath: { path: isVRMode ? _exitVRPath : _enterVRPath, width: 32, height: 32 }');t.appendChild(d);n.applyBindings(c,d);this._container=t;this._viewModel=c;this._element=d}t(u.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});u.prototype.isDestroyed=function(){return false};u.prototype.destroy=function(){this._viewModel.destroy();n.cleanNode(this._element);this._container.removeChild(this._element);return r(this)};return u});define("Widgets/Viewer/Viewer",["../../Core/BoundingSphere","../../Core/Cartesian3","../../Core/Clock","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/deprecationWarning","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Event","../../Core/EventHelper","../../Core/isArray","../../Core/Matrix4","../../Core/Rectangle","../../Core/ScreenSpaceEventType","../../DataSources/BoundingSphereState","../../DataSources/ConstantPositionProperty","../../DataSources/DataSourceCollection","../../DataSources/DataSourceDisplay","../../DataSources/Entity","../../DataSources/EntityView","../../DataSources/Property","../../Scene/ImageryLayer","../../Scene/SceneMode","../../ThirdParty/knockout","../../ThirdParty/when","../Animation/Animation","../Animation/AnimationViewModel","../BaseLayerPicker/BaseLayerPicker","../BaseLayerPicker/createDefaultImageryProviderViewModels","../BaseLayerPicker/createDefaultTerrainProviderViewModels","../CesiumWidget/CesiumWidget","../ClockViewModel","../FullscreenButton/FullscreenButton","../Geocoder/Geocoder","../getElement","../HomeButton/HomeButton","../InfoBox/InfoBox","../NavigationHelpButton/NavigationHelpButton","../ProjectionPicker/ProjectionPicker","../SceneModePicker/SceneModePicker","../SelectionIndicator/SelectionIndicator","../subscribeAndEvaluate","../Timeline/Timeline","../VRButton/VRButton"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U,V,z,q,G,H){"use strict";var j=new e;function W(e){var t=e.clock;t.currentTime=e.timeJulian;t.shouldAnimate=false}function Y(e,t){var r=e.scene.pick(t.position);if(n(r)){var a=i(r.id,r.primitive.id);if(a instanceof y){return a}}if(n(e.scene.globe)){return Z(e,t.position)}}function X(e,t,r){if(n(r)){var i=r.clock;if(n(i)){i.getValue(t);if(n(e)){e.updateFromClock();e.zoomTo(i.startTime,i.stopTime)}}}}var Q=new t;function Z(e,t){var r=e.scene;var i=r.camera.getPickRay(t);var a=r.imageryLayers.pickImageryLayerFeatures(i,r);if(!n(a)){return}var o=new y({id:"Loading...",description:"Loading feature information..."});E(a,function(t){if(e.selectedEntity!==o){return}if(!n(t)||t.length===0){e.selectedEntity=K();return}var r=t[0];var i=new y({id:r.name,description:r.description});if(n(r.position)){var a=e.scene.globe.ellipsoid.cartographicToCartesian(r.position,Q);i.position=new v(a)}e.selectedEntity=i},function(){if(e.selectedEntity!==o){return}e.selectedEntity=K()});return o}function K(){return new y({id:"None",description:"No features found."})}function J(e,t){var r=e._geocoder;var i=e._homeButton;var a=e._sceneModePicker;var o=e._projectionPicker;var s=e._baseLayerPicker;var l=e._animation;var u=e._timeline;var c=e._fullscreenButton;var d=e._infoBox;var f=e._selectionIndicator;var h=t?"hidden":"visible";if(n(r)){r.container.style.visibility=h}if(n(i)){i.container.style.visibility=h}if(n(a)){a.container.style.visibility=h}if(n(o)){o.container.style.visibility=h}if(n(s)){s.container.style.visibility=h}if(n(l)){l.container.style.visibility=h}if(n(u)){u.container.style.visibility=h}if(n(c)&&c.viewModel.isFullscreenEnabled){c.container.style.visibility=h}if(n(d)){d.container.style.visibility=h}if(n(f)){f.container.style.visibility=h}if(e._container){var p=t||!n(c)?0:c.container.clientWidth;e._vrButton.container.style.right=p+"px";e.forceResize()}}function $(e,t){if(!n(e)){throw new l("container is required.")}e=N(e);t=i(t,i.EMPTY_OBJECT);var a=(!n(t.globe)||t.globe!==false)&&(!n(t.baseLayerPicker)||t.baseLayerPicker!==false);if(a&&n(t.imageryProvider)){throw new l("options.imageryProvider is not available when using the BaseLayerPicker widget. Either specify options.selectedImageryProviderViewModel instead or set options.baseLayerPicker to false.")}if(!a&&n(t.selectedImageryProviderViewModel)){throw new l("options.selectedImageryProviderViewModel is not available when not using the BaseLayerPicker widget. Either specify options.imageryProvider instead or set options.baseLayerPicker to true.")}if(a&&n(t.terrainProvider)){throw new l("options.terrainProvider is not available when using the BaseLayerPicker widget. Either specify options.selectedTerrainProviderViewModel instead or set options.baseLayerPicker to false.")}if(!a&&n(t.selectedTerrainProviderViewModel)){throw new l("options.selectedTerrainProviderViewModel is not available when not using the BaseLayerPicker widget. Either specify options.terrainProvider instead or set options.baseLayerPicker to true.")}var s=this;var f=document.createElement("div");f.className="cesium-viewer";e.appendChild(f);var h=document.createElement("div");h.className="cesium-viewer-cesiumWidgetContainer";f.appendChild(h);var m=document.createElement("div");m.className="cesium-viewer-bottom";f.appendChild(m);var v=i(t.scene3DOnly,false);var y=t.clock;if(n(y)){o("Viewer.options.clock","Passing options.clock when creating a new Viewer instance was deprecated in Cesium 1.34 and will be removed in Cesium 1.37, pass options.clockViewModel instead.")}var b;var C;var S=false;if(n(t.clockViewModel)){C=t.clockViewModel;b=C.clock}else{b=n(y)?y:new r;C=new M(b);S=true}var E=new I(h,{terrainProvider:t.terrainProvider,imageryProvider:a?false:t.imageryProvider,clock:b,skyBox:t.skyBox,skyAtmosphere:t.skyAtmosphere,sceneMode:t.sceneMode,mapProjection:t.mapProjection,globe:t.globe,orderIndependentTranslucency:t.orderIndependentTranslucency,contextOptions:t.contextOptions,useDefaultRenderLoop:t.useDefaultRenderLoop,targetFrameRate:t.targetFrameRate,showRenderLoopErrors:t.showRenderLoopErrors,creditContainer:n(t.creditContainer)?t.creditContainer:m,scene3DOnly:v,terrainExaggeration:t.terrainExaggeration,shadows:t.shadows,terrainShadows:t.terrainShadows,mapMode2D:t.mapMode2D});var j=t.dataSources;var X=false;if(!n(j)){j=new g;X=true}var Q=new _({scene:E.scene,dataSourceCollection:j});var Z=new c;Z.add(b.onTick,$.prototype._onTick,this);Z.add(E.scene.morphStart,$.prototype._clearTrackedObject,this);var K;if(!n(t.selectionIndicator)||t.selectionIndicator!==false){var ee=document.createElement("div");ee.className="cesium-viewer-selectionIndicatorContainer";f.appendChild(ee);K=new z(ee,E.scene)}var te;if(!n(t.infoBox)||t.infoBox!==false){var re=document.createElement("div");re.className="cesium-viewer-infoBoxContainer";f.appendChild(re);te=new F(re);var ie=te.viewModel;Z.add(ie.cameraClicked,$.prototype._onInfoBoxCameraClicked,this);Z.add(ie.closeClicked,$.prototype._onInfoBoxClockClicked,this)}var ne=document.createElement("div");ne.className="cesium-viewer-toolbar";f.appendChild(ne);var ae;if(!n(t.geocoder)||t.geocoder!==false){var oe=document.createElement("div");oe.className="cesium-viewer-geocoderContainer";ne.appendChild(oe);ae=new L({container:oe,geocoderServices:n(t.geocoder)?d(t.geocoder)?t.geocoder:[t.geocoder]:undefined,scene:E.scene});Z.add(ae.viewModel.search.beforeExecute,$.prototype._clearObjects,this)}var se;if(!n(t.homeButton)||t.homeButton!==false){se=new k(ne,E.scene);if(n(ae)){Z.add(se.viewModel.command.afterExecute,function(){var e=ae.viewModel;e.searchText="";if(e.isSearchInProgress){e.search()}})}Z.add(se.viewModel.command.beforeExecute,$.prototype._clearTrackedObject,this)}if(t.sceneModePicker===true&&v){throw new l("options.sceneModePicker is not available when options.scene3DOnly is set to true.")}var le;if(!v&&(!n(t.sceneModePicker)||t.sceneModePicker!==false)){le=new V(ne,E.scene)}var ue;if(t.projectionPicker){ue=new U(ne,E.scene)}var ce;var de;if(a){var fe=i(t.imageryProviderViewModels,O());var he=i(t.terrainProviderViewModels,D());ce=new A(ne,{globe:E.scene.globe,imageryProviderViewModels:fe,selectedImageryProviderViewModel:t.selectedImageryProviderViewModel,terrainProviderViewModels:he,selectedTerrainProviderViewModel:t.selectedTerrainProviderViewModel});var pe=ne.getElementsByClassName("cesium-baseLayerPicker-dropDown");de=pe[0]}var me;if(!n(t.navigationHelpButton)||t.navigationHelpButton!==false){var ve=true;try{if(n(window.localStorage)){var ge=window.localStorage.getItem("cesium-hasSeenNavHelp");if(n(ge)&&Boolean(ge)){ve=false}else{window.localStorage.setItem("cesium-hasSeenNavHelp","true")}}}catch(e){}me=new B({container:ne,instructionsInitiallyVisible:i(t.navigationInstructionsInitiallyVisible,ve)})}var _e;if(!n(t.animation)||t.animation!==false){var ye=document.createElement("div");ye.className="cesium-viewer-animationContainer";f.appendChild(ye);_e=new x(ye,new P(C))}var be;if(!n(t.timeline)||t.timeline!==false){var we=document.createElement("div");we.className="cesium-viewer-timelineContainer";f.appendChild(we);be=new G(we,b);be.addEventListener("settime",W,false);be.zoomTo(b.startTime,b.stopTime)}var Ce;var Se;var Te;if(!n(t.fullscreenButton)||t.fullscreenButton!==false){Te=document.createElement("div");Te.className="cesium-viewer-fullscreenContainer";f.appendChild(Te);Ce=new R(Te,t.fullscreenElement);Se=q(Ce.viewModel,"isFullscreenEnabled",function(e){Te.style.display=e?"block":"none";if(n(be)){be.container.style.right=Te.clientWidth+"px";be.resize()}})}var Ee;var xe;var Pe;if(t.vrButton){var Ae=document.createElement("div");Ae.className="cesium-viewer-vrContainer";f.appendChild(Ae);Ee=new H(Ae,E.scene,t.fullScreenElement);xe=q(Ee.viewModel,"isVREnabled",function(e){Ae.style.display=e?"block":"none";if(n(Ce)){Ae.style.right=Te.clientWidth+"px"}if(n(be)){be.container.style.right=Ae.clientWidth+"px";be.resize()}});Pe=q(Ee.viewModel,"isVRMode",function(e){J(s,e)})}this._baseLayerPickerDropDown=de;this._fullscreenSubscription=Se;this._vrSubscription=xe;this._vrModeSubscription=Pe;this._dataSourceChangedListeners={};this._automaticallyTrackDataSourceClocks=i(t.automaticallyTrackDataSourceClocks,true);this._container=e;this._bottomContainer=m;this._element=f;this._cesiumWidget=E;this._selectionIndicator=K;this._infoBox=te;this._dataSourceCollection=j;this._destroyDataSourceCollection=X;this._dataSourceDisplay=Q;this._clockViewModel=C;this._destroyClockViewModel=S;this._toolbar=ne;this._homeButton=se;this._sceneModePicker=le;this._projectionPicker=ue;this._baseLayerPicker=ce;this._navigationHelpButton=me;this._animation=_e;this._timeline=be;this._fullscreenButton=Ce;this._vrButton=Ee;this._geocoder=ae;this._eventHelper=Z;this._lastWidth=0;this._lastHeight=0;this._allowDataSourcesToSuspendAnimation=true;this._entityView=undefined;this._enableInfoOrSelection=n(te)||n(K);this._clockTrackedDataSource=undefined;this._trackedEntity=undefined;this._needTrackedEntityUpdate=false;this._selectedEntity=undefined;this._clockTrackedDataSource=undefined;this._forceResize=false;this._zoomIsFlight=false;this._zoomTarget=undefined;this._zoomPromise=undefined;this._zoomOptions=undefined;this._selectedEntityChanged=new u;this._trackedEntityChanged=new u;T.track(this,["_trackedEntity","_selectedEntity","_clockTrackedDataSource"]);Z.add(j.dataSourceAdded,$.prototype._onDataSourceAdded,this);Z.add(j.dataSourceRemoved,$.prototype._onDataSourceRemoved,this);Z.add(E.scene.preRender,$.prototype.resize,this);Z.add(E.scene.postRender,$.prototype._postRender,this);var Oe=j.length;for(var De=0;De<Oe;De++){this._dataSourceAdded(j,j.get(De))}this._dataSourceAdded(undefined,Q.defaultDataSource);Z.add(j.dataSourceAdded,$.prototype._dataSourceAdded,this);Z.add(j.dataSourceRemoved,$.prototype._dataSourceRemoved,this);function Ie(e){var t=Y(s,e);if(n(t)){if(w.getValueOrUndefined(t.position,s.clock.currentTime)){s.trackedEntity=t}else{s.zoomTo(t)}}}function Me(e){s.selectedEntity=Y(s,e)}E.screenSpaceEventHandler.setInputAction(Me,p.LEFT_CLICK);E.screenSpaceEventHandler.setInputAction(Ie,p.LEFT_DOUBLE_CLICK)}a($.prototype,{container:{get:function(){return this._container}},bottomContainer:{get:function(){return this._bottomContainer}},cesiumWidget:{get:function(){return this._cesiumWidget}},selectionIndicator:{get:function(){return this._selectionIndicator}},infoBox:{get:function(){return this._infoBox}},geocoder:{get:function(){return this._geocoder}},homeButton:{get:function(){return this._homeButton}},sceneModePicker:{get:function(){return this._sceneModePicker}},projectionPicker:{get:function(){return this._projectionPicker}},baseLayerPicker:{get:function(){return this._baseLayerPicker}},navigationHelpButton:{get:function(){return this._navigationHelpButton}},animation:{get:function(){return this._animation}},timeline:{get:function(){return this._timeline}},fullscreenButton:{get:function(){return this._fullscreenButton}},vrButton:{get:function(){return this._vrButton}},dataSourceDisplay:{get:function(){return this._dataSourceDisplay}},entities:{get:function(){return this._dataSourceDisplay.defaultDataSource.entities}},dataSources:{get:function(){return this._dataSourceCollection}},canvas:{get:function(){return this._cesiumWidget.canvas}},cesiumLogo:{get:function(){return this._cesiumWidget.cesiumLogo}},scene:{get:function(){return this._cesiumWidget.scene}},shadows:{get:function(){return this.scene.shadowMap.enabled},set:function(e){this.scene.shadowMap.enabled=e}},terrainShadows:{get:function(){return this.scene.globe.shadows},set:function(e){this.scene.globe.shadows=e}},shadowMap:{get:function(){return this.scene.shadowMap}},imageryLayers:{get:function(){return this.scene.imageryLayers}},terrainProvider:{get:function(){return this.scene.terrainProvider},set:function(e){this.scene.terrainProvider=e}},camera:{get:function(){return this.scene.camera}},clock:{get:function(){return this._clockViewModel.clock}},clockViewModel:{get:function(){return this._clockViewModel}},screenSpaceEventHandler:{get:function(){return this._cesiumWidget.screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._cesiumWidget.targetFrameRate},set:function(e){this._cesiumWidget.targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._cesiumWidget.useDefaultRenderLoop},set:function(e){this._cesiumWidget.useDefaultRenderLoop=e}},resolutionScale:{get:function(){return this._cesiumWidget.resolutionScale},set:function(e){this._cesiumWidget.resolutionScale=e;this._forceResize=true}},allowDataSourcesToSuspendAnimation:{get:function(){return this._allowDataSourcesToSuspendAnimation},set:function(e){this._allowDataSourcesToSuspendAnimation=e}},trackedEntity:{get:function(){return this._trackedEntity},set:function(e){if(this._trackedEntity!==e){this._trackedEntity=e;re(this);var t=this.scene;var r=t.mode;if(!n(e)||!n(e.position)){this._needTrackedEntityUpdate=false;if(r===S.COLUMBUS_VIEW||r===S.SCENE2D){t.screenSpaceCameraController.enableTranslate=true}if(r===S.COLUMBUS_VIEW||r===S.SCENE3D){t.screenSpaceCameraController.enableTilt=true}this._entityView=undefined;this.camera.lookAtTransform(f.IDENTITY)}else{this._needTrackedEntityUpdate=true}this._trackedEntityChanged.raiseEvent(e)}}},selectedEntity:{get:function(){return this._selectedEntity},set:function(e){if(this._selectedEntity!==e){this._selectedEntity=e;var t=n(this._selectionIndicator)?this._selectionIndicator.viewModel:undefined;if(n(e)){if(n(t)){t.animateAppear()}}else if(n(t)){t.animateDepart()}this._selectedEntityChanged.raiseEvent(e)}}},selectedEntityChanged:{get:function(){return this._selectedEntityChanged}},trackedEntityChanged:{get:function(){return this._trackedEntityChanged}},clockTrackedDataSource:{get:function(){return this._clockTrackedDataSource},set:function(e){if(this._clockTrackedDataSource!==e){this._clockTrackedDataSource=e;X(this._timeline,this.clock,e)}}}});$.prototype.extend=function(e,t){if(!n(e)){throw new l("mixin is required.")}e(this,t)};$.prototype.resize=function(){var e=this._cesiumWidget;var t=this._container;var r=t.clientWidth;var i=t.clientHeight;var a=n(this._animation);var o=n(this._timeline);if(!this._forceResize&&r===this._lastWidth&&i===this._lastHeight){return}e.resize();this._forceResize=false;var s=i-125;var l=this._baseLayerPickerDropDown;if(n(l)){l.style.maxHeight=s+"px"}if(n(this._geocoder)){var u=this._geocoder.searchSuggestionsContainer;u.style.maxHeight=s+"px"}if(n(this._infoBox)){this._infoBox.viewModel.maxHeight=s}var c=this._timeline;var d;var f=0;var h=0;var p=0;if(a&&window.getComputedStyle(this._animation.container).visibility!=="hidden"){var m=this._lastWidth;d=this._animation.container;if(r>900){f=169;if(m<=900){d.style.width="169px";d.style.height="112px";this._animation.resize()}}else if(r>=600){f=136;if(m<600||m>900){d.style.width="136px";d.style.height="90px";this._animation.resize()}}else{f=106;if(m>600||m===0){d.style.width="106px";d.style.height="70px";this._animation.resize()}}h=f+5}if(o&&window.getComputedStyle(this._timeline.container).visibility!=="hidden"){var v=this._fullscreenButton;var g=this._vrButton;var _=c.container;var y=_.style;p=_.clientHeight+3;y.left=f+"px";var b=0;if(n(v)){b+=v.container.clientWidth}if(n(g)){b+=g.container.clientWidth}y.right=b+"px";c.resize()}this._bottomContainer.style.left=h+"px";this._bottomContainer.style.bottom=p+"px";this._lastWidth=r;this._lastHeight=i};$.prototype.forceResize=function(){this._lastWidth=0;this.resize()};$.prototype.render=function(){this._cesiumWidget.render()};$.prototype.isDestroyed=function(){return false};$.prototype.destroy=function(){var e;this.screenSpaceEventHandler.removeInputAction(p.LEFT_CLICK);this.screenSpaceEventHandler.removeInputAction(p.LEFT_DOUBLE_CLICK);var t=this.dataSources;var r=t.length;for(e=0;e<r;e++){this._dataSourceRemoved(t,t.get(e))}this._dataSourceRemoved(undefined,this._dataSourceDisplay.defaultDataSource);this._container.removeChild(this._element);this._element.removeChild(this._toolbar);this._eventHelper.removeAll();if(n(this._geocoder)){this._geocoder=this._geocoder.destroy()}if(n(this._homeButton)){this._homeButton=this._homeButton.destroy()}if(n(this._sceneModePicker)){this._sceneModePicker=this._sceneModePicker.destroy()}if(n(this._projectionPicker)){this._projectionPicker=this._projectionPicker.destroy()}if(n(this._baseLayerPicker)){this._baseLayerPicker=this._baseLayerPicker.destroy()}if(n(this._animation)){this._element.removeChild(this._animation.container);this._animation=this._animation.destroy()}if(n(this._timeline)){this._timeline.removeEventListener("settime",W,false);this._element.removeChild(this._timeline.container);this._timeline=this._timeline.destroy()}if(n(this._fullscreenButton)){this._fullscreenSubscription.dispose();this._element.removeChild(this._fullscreenButton.container);this._fullscreenButton=this._fullscreenButton.destroy()}if(n(this._vrButton)){this._vrSubscription.dispose();this._vrModeSubscription.dispose();this._element.removeChild(this._vrButton.container);this._vrButton=this._vrButton.destroy()}if(n(this._infoBox)){this._element.removeChild(this._infoBox.container);this._infoBox=this._infoBox.destroy()}if(n(this._selectionIndicator)){this._element.removeChild(this._selectionIndicator.container);this._selectionIndicator=this._selectionIndicator.destroy()}if(this._destroyClockViewModel){this._clockViewModel=this._clockViewModel.destroy()}this._dataSourceDisplay=this._dataSourceDisplay.destroy();this._cesiumWidget=this._cesiumWidget.destroy();if(this._destroyDataSourceCollection){this._dataSourceCollection=this._dataSourceCollection.destroy()}return s(this)};$.prototype._dataSourceAdded=function(e,t){var r=t.entities;r.collectionChanged.addEventListener($.prototype._onEntityCollectionChanged,this)};$.prototype._dataSourceRemoved=function(e,t){var r=t.entities;r.collectionChanged.removeEventListener($.prototype._onEntityCollectionChanged,this);if(n(this.trackedEntity)){if(r.getById(this.trackedEntity.id)===this.trackedEntity){this.trackedEntity=undefined}}if(n(this.selectedEntity)){if(r.getById(this.selectedEntity.id)===this.selectedEntity){this.selectedEntity=undefined}}};$.prototype._onTick=function(e){var r=e.currentTime;var a=this._dataSourceDisplay.update(r);if(this._allowDataSourcesToSuspendAnimation){this._clockViewModel.canAnimate=a}var o=this._entityView;if(n(o)){var s=this._trackedEntity;var l=this._dataSourceDisplay.getBoundingSphere(s,false,j);if(l===m.DONE){o.update(r,j)}}var u;var c=false;var d=this.selectedEntity;var f=n(d)&&this._enableInfoOrSelection;if(f&&d.isShowing&&d.isAvailable(r)){var h=this._dataSourceDisplay.getBoundingSphere(d,true,j);if(h!==m.FAILED){u=j.center}else if(n(d.position)){u=d.position.getValue(r,u)}c=n(u)}var p=n(this._selectionIndicator)?this._selectionIndicator.viewModel:undefined;if(n(p)){p.position=t.clone(u,p.position);p.showSelection=f&&c;p.update()}var v=n(this._infoBox)?this._infoBox.viewModel:undefined;if(n(v)){v.showInfo=f;v.enableCamera=c;v.isCameraTracking=this.trackedEntity===this.selectedEntity;if(f){v.titleText=i(d.name,d.id);v.description=w.getValueOrDefault(d.description,r,"")}else{v.titleText="";v.description=""}}};$.prototype._onEntityCollectionChanged=function(e,t,r){var i=r.length;for(var n=0;n<i;n++){var a=r[n];if(this.trackedEntity===a){this.trackedEntity=undefined}if(this.selectedEntity===a){this.selectedEntity=undefined}}};$.prototype._onInfoBoxCameraClicked=function(e){if(e.isCameraTracking&&this.trackedEntity===this.selectedEntity){this.trackedEntity=undefined}else{var t=this.selectedEntity;var r=t.position;if(n(r)){this.trackedEntity=this.selectedEntity}else{this.zoomTo(this.selectedEntity)}}};$.prototype._clearTrackedObject=function(){this.trackedEntity=undefined};$.prototype._onInfoBoxClockClicked=function(e){this.selectedEntity=undefined};$.prototype._clearObjects=function(){this.trackedEntity=undefined;this.selectedEntity=undefined};$.prototype._onDataSourceChanged=function(e){if(this.clockTrackedDataSource===e){X(this.timeline,this.clock,e)}};$.prototype._onDataSourceAdded=function(e,t){if(this._automaticallyTrackDataSourceClocks){this.clockTrackedDataSource=t}var r=t.entities.id;var i=this._eventHelper.add(t.changedEvent,$.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[r]=i};$.prototype._onDataSourceRemoved=function(e,t){var r=this.clockTrackedDataSource===t;var i=t.entities.id;this._dataSourceChangedListeners[i]();this._dataSourceChangedListeners[i]=undefined;if(r){var n=e.length;if(this._automaticallyTrackDataSourceClocks&&n>0){this.clockTrackedDataSource=e.get(n-1)}else{this.clockTrackedDataSource=undefined}}};$.prototype.zoomTo=function(e,t){return ee(this,e,t,false)};$.prototype.flyTo=function(e,t){return ee(this,e,t,true)};function ee(e,t,r,a){if(!n(t)){throw new l("zoomTarget is required.")}re(e);var o=E.defer();e._zoomPromise=o;e._zoomIsFlight=a;e._zoomOptions=r;E(t,function(t){if(e._zoomPromise!==o){return}if(t instanceof C){t.getViewableRectangle().then(function(t){if(e._zoomPromise===o){e._zoomTarget=t}});return}if(t.isLoading&&n(t.loadingEvent)){var r=t.loadingEvent.addEventListener(function(){r();if(e._zoomPromise===o){e._zoomTarget=t.entities.values.slice(0)}});return}if(d(t)){e._zoomTarget=t.slice(0);return}t=i(t.values,t);if(n(t.entities)){t=t.entities.values}if(d(t)){e._zoomTarget=t.slice(0)}else{e._zoomTarget=[t]}});return o.promise}function te(e){e._zoomPromise=undefined;e._zoomTarget=undefined;e._zoomOptions=undefined}function re(e){var t=e._zoomPromise;if(n(t)){te(e);t.resolve(false)}}$.prototype._postRender=function(){ie(this);ne(this)};function ie(t){var r=t._zoomTarget;if(!n(r)||t.scene.mode===S.MORPHING){return}var a=t.scene;var o=a.camera;var s=t._zoomPromise;var l=i(t._zoomOptions,{});if(r instanceof h){var u={destination:r,duration:l.duration,maximumHeight:l.maximumHeight,complete:function(){s.resolve(true)},cancel:function(){s.resolve(false)}};if(t._zoomIsFlight){o.flyTo(u)}else{o.setView(u);s.resolve(true)}te(t);return}var c=[];for(var d=0,p=r.length;d<p;d++){var v=t._dataSourceDisplay.getBoundingSphere(r[d],false,j);if(v===m.PENDING){return}else if(v!==m.FAILED){c.push(e.clone(j))}}if(c.length===0){re(t);return}t.trackedEntity=undefined;var g=e.fromBoundingSpheres(c);if(!t._zoomIsFlight){o.viewBoundingSphere(g,t._zoomOptions);o.lookAtTransform(f.IDENTITY);te(t);s.resolve(true)}else{te(t);o.flyToBoundingSphere(g,{duration:l.duration,maximumHeight:l.maximumHeight,complete:function(){s.resolve(true)},cancel:function(){s.resolve(false)},offset:l.offset})}}function ne(e){if(!e._needTrackedEntityUpdate){return}var t=e._trackedEntity;var r=e.clock.currentTime;var i=w.getValueOrUndefined(t.position,r);if(!n(i)){return}var a=e.scene;var o=e._dataSourceDisplay.getBoundingSphere(t,false,j);if(o===m.PENDING){return}var s=a.mode;if(s===S.COLUMBUS_VIEW||s===S.SCENE2D){a.screenSpaceCameraController.enableTranslate=false}if(s===S.COLUMBUS_VIEW||s===S.SCENE3D){a.screenSpaceCameraController.enableTilt=false}var l=o!==m.FAILED?j:undefined;e._entityView=new b(t,a,a.mapProjection.ellipsoid);e._entityView.update(r,l);e._needTrackedEntityUpdate=false}return $});define("Widgets/Viewer/viewerCesium3DTilesInspectorMixin",["../../Core/Check","../../Core/defineProperties","../Cesium3DTilesInspector/Cesium3DTilesInspector"],function(e,t,r){"use strict";function i(i){e.typeOf.object("viewer",i);var n=document.createElement("div");n.className="cesium-viewer-cesium3DTilesInspectorContainer";i.container.appendChild(n);var a=new r(n,i.scene);t(i,{cesium3DTilesInspector:{get:function(){return a}}})}return i});define("Widgets/Viewer/viewerCesiumInspectorMixin",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../CesiumInspector/CesiumInspector"],function(e,t,r,i){"use strict";function n(n){if(!e(n)){throw new r("viewer is required.")}var a=document.createElement("div");a.className="cesium-viewer-cesiumInspectorContainer";n.container.appendChild(a);var o=new i(a,n.scene);t(n,{cesiumInspector:{get:function(){return o}}})}return n});define("Widgets/Viewer/viewerDragDropMixin",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/Event","../../Core/wrapFunction","../../DataSources/CzmlDataSource","../../DataSources/GeoJsonDataSource","../../DataSources/KmlDataSource","../getElement"],function(e,t,r,i,n,a,o,s,l,u){"use strict";function c(o,s){if(!t(o)){throw new i("viewer is required.")}if(o.hasOwnProperty("dropTarget")){throw new i("dropTarget is already defined by another mixin.")}if(o.hasOwnProperty("dropEnabled")){throw new i("dropEnabled is already defined by another mixin.")}if(o.hasOwnProperty("dropError")){throw new i("dropError is already defined by another mixin.")}if(o.hasOwnProperty("clearOnDrop")){throw new i("clearOnDrop is already defined by another mixin.")}if(o.hasOwnProperty("flyToOnDrop")){throw new i("flyToOnDrop is already defined by another mixin.")}s=e(s,e.EMPTY_OBJECT);var l=true;var c=e(s.flyToOnDrop,true);var v=new n;var g=e(s.clearOnDrop,true);var _=e(s.dropTarget,o.container);var y=e(s.clampToGround,true);var b=s.proxy;_=u(_);r(o,{dropTarget:{get:function(){return _},set:function(e){if(!t(e)){throw new i("value is required.")}f(_,w);_=e;h(_,w)}},dropEnabled:{get:function(){return l},set:function(e){if(e!==l){if(e){h(_,w)}else{f(_,w)}l=e}}},dropError:{get:function(){return v}},clearOnDrop:{get:function(){return g},set:function(e){g=e}},flyToOnDrop:{get:function(){return c},set:function(e){c=e}},proxy:{get:function(){return b},set:function(e){b=e}},clampToGround:{get:function(){return y},set:function(e){y=e}}});function w(e){d(e);if(g){o.entities.removeAll();o.dataSources.removeAll()}var t=e.dataTransfer.files;var r=t.length;for(var i=0;i<r;i++){var n=t[i];var a=new FileReader;a.onload=p(o,n,b,y);a.onerror=m(o,n);a.readAsText(n)}}h(_,w);o.destroy=a(o,o.destroy,function(){o.dropEnabled=false});o._handleDrop=w}function d(e){e.stopPropagation();e.preventDefault()}function f(e,r){var i=e;if(t(i)){i.removeEventListener("drop",r,false);i.removeEventListener("dragenter",d,false);i.removeEventListener("dragover",d,false);i.removeEventListener("dragexit",d,false)}}function h(e,t){e.addEventListener("drop",t,false);e.addEventListener("dragenter",d,false);e.addEventListener("dragover",d,false);e.addEventListener("dragexit",d,false)}function p(e,r,i,n){var a=e.scene;return function(u){var c=r.name;try{var d;if(/\.czml$/i.test(c)){d=o.load(JSON.parse(u.target.result),{sourceUri:c})}else if(/\.geojson$/i.test(c)||/\.json$/i.test(c)||/\.topojson$/i.test(c)){d=s.load(JSON.parse(u.target.result),{sourceUri:c,clampToGround:n})}else if(/\.(kml|kmz)$/i.test(c)){d=l.load(r,{sourceUri:c,proxy:i,camera:a.camera,canvas:a.canvas})}else{e.dropError.raiseEvent(e,c,"Unrecognized file: "+c);return}if(t(d)){e.dataSources.add(d).then(function(t){if(e.flyToOnDrop){e.flyTo(t)}}).otherwise(function(t){e.dropError.raiseEvent(e,c,t)})}}catch(t){e.dropError.raiseEvent(e,c,t)}}}function m(e,t){return function(r){e.dropError.raiseEvent(e,t.name,r.target.error)}}return c});define("Widgets/Viewer/viewerPerformanceWatchdogMixin",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../PerformanceWatchdog/PerformanceWatchdog"],function(e,t,r,i,n){"use strict";function a(a,o){if(!t(a)){throw new i("viewer is required.")}o=e(o,e.EMPTY_OBJECT);var s=new n({scene:a.scene,container:a.bottomContainer,lowFrameRateMessage:o.lowFrameRateMessage});r(a,{performanceWatchdog:{get:function(){return s}}})}return a});define("Workers/createTaskProcessorWorker",["../Core/defaultValue","../Core/defined","../Core/formatError"],function(e,t,r){"use strict";function i(i){var n;var a=[];var o={id:undefined,result:undefined,error:undefined};return function(s){var l=s.data;a.length=0;o.id=l.id;o.error=undefined;o.result=undefined;try{o.result=i(l.parameters,a)}catch(e){if(e instanceof Error){o.error={name:e.name,message:e.message,stack:e.stack}}else{o.error=e}}if(!t(n)){n=e(self.webkitPostMessage,self.postMessage)}if(!l.canTransferArrayBuffer){a.length=0}try{n(o,a)}catch(e){o.result=undefined;o.error="postMessage failed with error: "+r(e)+"\n  with responseMessage: "+JSON.stringify(o);n(o)}}}return i});define("Cesium",["./Core/appendForwardSlash","./Core/arrayFill","./Core/arrayRemoveDuplicates","./Core/AssociativeArray","./Core/AttributeCompression","./Core/AxisAlignedBoundingBox","./Core/barycentricCoordinates","./Core/binarySearch","./Core/BingMapsApi","./Core/BingMapsGeocoderService","./Core/BoundingRectangle","./Core/BoundingSphere","./Core/BoxGeometry","./Core/BoxOutlineGeometry","./Core/buildModuleUrl","./Core/cancelAnimationFrame","./Core/Cartesian2","./Core/Cartesian3","./Core/Cartesian4","./Core/Cartographic","./Core/CartographicGeocoderService","./Core/CatmullRomSpline","./Core/CesiumTerrainProvider","./Core/Check","./Core/CircleGeometry","./Core/CircleOutlineGeometry","./Core/Clock","./Core/ClockRange","./Core/ClockStep","./Core/clone","./Core/Color","./Core/ColorGeometryInstanceAttribute","./Core/combine","./Core/ComponentDatatype","./Core/CompressedTextureBuffer","./Core/CornerType","./Core/CorridorGeometry","./Core/CorridorGeometryLibrary","./Core/CorridorOutlineGeometry","./Core/createGuid","./Core/Credit","./Core/CubicRealPolynomial","./Core/CullingVolume","./Core/CylinderGeometry","./Core/CylinderGeometryLibrary","./Core/CylinderOutlineGeometry","./Core/decodeGoogleEarthEnterpriseData","./Core/DefaultProxy","./Core/defaultValue","./Core/defined","./Core/defineProperties","./Core/deprecationWarning","./Core/destroyObject","./Core/DeveloperError","./Core/DistanceDisplayCondition","./Core/DistanceDisplayConditionGeometryInstanceAttribute","./Core/DoublyLinkedList","./Core/EarthOrientationParameters","./Core/EarthOrientationParametersSample","./Core/EasingFunction","./Core/EllipseGeometry","./Core/EllipseGeometryLibrary","./Core/EllipseOutlineGeometry","./Core/Ellipsoid","./Core/EllipsoidalOccluder","./Core/EllipsoidGeodesic","./Core/EllipsoidGeometry","./Core/EllipsoidOutlineGeometry","./Core/EllipsoidTangentPlane","./Core/EllipsoidTerrainProvider","./Core/EncodedCartesian3","./Core/Event","./Core/EventHelper","./Core/ExtrapolationType","./Core/FeatureDetection","./Core/formatError","./Core/freezeObject","./Core/FrustumGeometry","./Core/FrustumOutlineGeometry","./Core/Fullscreen","./Core/GeocoderService","./Core/GeographicProjection","./Core/GeographicTilingScheme","./Core/Geometry","./Core/GeometryAttribute","./Core/GeometryAttributes","./Core/GeometryInstance","./Core/GeometryInstanceAttribute","./Core/GeometryPipeline","./Core/GeometryType","./Core/getAbsoluteUri","./Core/getBaseUri","./Core/getExtensionFromUri","./Core/getFilenameFromUri","./Core/getImagePixels","./Core/getMagic","./Core/getStringFromTypedArray","./Core/getTimestamp","./Core/GoogleEarthEnterpriseMetadata","./Core/GoogleEarthEnterpriseTerrainData","./Core/GoogleEarthEnterpriseTerrainProvider","./Core/GoogleEarthEnterpriseTileInformation","./Core/GregorianDate","./Core/HeadingPitchRange","./Core/HeadingPitchRoll","./Core/Heap","./Core/HeightmapTerrainData","./Core/HeightmapTessellator","./Core/HermitePolynomialApproximation","./Core/HermiteSpline","./Core/Iau2000Orientation","./Core/Iau2006XysData","./Core/Iau2006XysSample","./Core/IauOrientationAxes","./Core/IauOrientationParameters","./Core/IndexDatatype","./Core/InterpolationAlgorithm","./Core/Intersect","./Core/Intersections2D","./Core/IntersectionTests","./Core/Interval","./Core/isArray","./Core/isBitSet","./Core/isBlobUri","./Core/isCrossOriginUrl","./Core/isDataUri","./Core/isLeapYear","./Core/Iso8601","./Core/joinUrls","./Core/JulianDate","./Core/KeyboardEventModifier","./Core/LagrangePolynomialApproximation","./Core/LeapSecond","./Core/LinearApproximation","./Core/LinearSpline","./Core/loadArrayBuffer","./Core/loadBlob","./Core/loadCRN","./Core/loadImage","./Core/loadImageFromTypedArray","./Core/loadImageViaBlob","./Core/loadJson","./Core/loadJsonp","./Core/loadKTX","./Core/loadText","./Core/loadWithXhr","./Core/loadXML","./Core/ManagedArray","./Core/MapboxApi","./Core/MapProjection","./Core/Math","./Core/Matrix2","./Core/Matrix3","./Core/Matrix4","./Core/mergeSort","./Core/NearFarScalar","./Core/objectToQuery","./Core/Occluder","./Core/oneTimeWarning","./Core/OrientedBoundingBox","./Core/OrthographicFrustum","./Core/OrthographicOffCenterFrustum","./Core/Packable","./Core/PackableForInterpolation","./Core/parseResponseHeaders","./Core/PerspectiveFrustum","./Core/PerspectiveOffCenterFrustum","./Core/PinBuilder","./Core/PixelFormat","./Core/Plane","./Core/pointInsideTriangle","./Core/PolygonGeometry","./Core/PolygonGeometryLibrary","./Core/PolygonHierarchy","./Core/PolygonOutlineGeometry","./Core/PolygonPipeline","./Core/PolylineGeometry","./Core/PolylinePipeline","./Core/PolylineVolumeGeometry","./Core/PolylineVolumeGeometryLibrary","./Core/PolylineVolumeOutlineGeometry","./Core/PrimitiveType","./Core/QuadraticRealPolynomial","./Core/QuantizedMeshTerrainData","./Core/QuarticRealPolynomial","./Core/Quaternion","./Core/QuaternionSpline","./Core/queryToObject","./Core/Queue","./Core/Ray","./Core/Rectangle","./Core/RectangleGeometry","./Core/RectangleGeometryLibrary","./Core/RectangleOutlineGeometry","./Core/ReferenceFrame","./Core/Request","./Core/requestAnimationFrame","./Core/RequestErrorEvent","./Core/RequestScheduler","./Core/RequestState","./Core/RequestType","./Core/RuntimeError","./Core/sampleTerrain","./Core/sampleTerrainMostDetailed","./Core/scaleToGeodeticSurface","./Core/ScreenSpaceEventHandler","./Core/ScreenSpaceEventType","./Core/ShowGeometryInstanceAttribute","./Core/Simon1994PlanetaryPositions","./Core/SimplePolylineGeometry","./Core/SphereGeometry","./Core/SphereOutlineGeometry","./Core/Spherical","./Core/Spline","./Core/subdivideArray","./Core/TaskProcessor","./Core/TerrainData","./Core/TerrainEncoding","./Core/TerrainMesh","./Core/TerrainProvider","./Core/TerrainQuantization","./Core/TileAvailability","./Core/TileProviderError","./Core/TilingScheme","./Core/TimeConstants","./Core/TimeInterval","./Core/TimeIntervalCollection","./Core/TimeStandard","./Core/Tipsify","./Core/Transforms","./Core/TranslationRotationScale","./Core/TridiagonalSystemSolver","./Core/TrustedServers","./Core/VertexFormat","./Core/VideoSynchronizer","./Core/Visibility","./Core/VRTheWorldTerrainProvider","./Core/WallGeometry","./Core/WallGeometryLibrary","./Core/WallOutlineGeometry","./Core/WebGLConstants","./Core/WebMercatorProjection","./Core/WebMercatorTilingScheme","./Core/WeightSpline","./Core/WindingOrder","./Core/wrapFunction","./Core/writeTextToCanvas","./DataSources/BillboardGraphics","./DataSources/BillboardVisualizer","./DataSources/BoundingSphereState","./DataSources/BoxGeometryUpdater","./DataSources/BoxGraphics","./DataSources/CallbackProperty","./DataSources/CheckerboardMaterialProperty","./DataSources/ColorMaterialProperty","./DataSources/CompositeEntityCollection","./DataSources/CompositeMaterialProperty","./DataSources/CompositePositionProperty","./DataSources/CompositeProperty","./DataSources/ConstantPositionProperty","./DataSources/ConstantProperty","./DataSources/CorridorGeometryUpdater","./DataSources/CorridorGraphics","./DataSources/createMaterialPropertyDescriptor","./DataSources/createPropertyDescriptor","./DataSources/createRawPropertyDescriptor","./DataSources/CustomDataSource","./DataSources/CylinderGeometryUpdater","./DataSources/CylinderGraphics","./DataSources/CzmlDataSource","./DataSources/DataSource","./DataSources/DataSourceClock","./DataSources/DataSourceCollection","./DataSources/DataSourceDisplay","./DataSources/dynamicGeometryGetBoundingSphere","./DataSources/DynamicGeometryUpdater","./DataSources/EllipseGeometryUpdater","./DataSources/EllipseGraphics","./DataSources/EllipsoidGeometryUpdater","./DataSources/EllipsoidGraphics","./DataSources/Entity","./DataSources/EntityCluster","./DataSources/EntityCollection","./DataSources/EntityView","./DataSources/GeoJsonDataSource","./DataSources/GeometryUpdater","./DataSources/GeometryVisualizer","./DataSources/GridMaterialProperty","./DataSources/ImageMaterialProperty","./DataSources/KmlDataSource","./DataSources/LabelGraphics","./DataSources/LabelVisualizer","./DataSources/MaterialProperty","./DataSources/ModelGraphics","./DataSources/ModelVisualizer","./DataSources/NodeTransformationProperty","./DataSources/PathGraphics","./DataSources/PathVisualizer","./DataSources/PointGraphics","./DataSources/PointVisualizer","./DataSources/PolygonGeometryUpdater","./DataSources/PolygonGraphics","./DataSources/PolylineArrowMaterialProperty","./DataSources/PolylineDashMaterialProperty","./DataSources/PolylineGeometryUpdater","./DataSources/PolylineGlowMaterialProperty","./DataSources/PolylineGraphics","./DataSources/PolylineOutlineMaterialProperty","./DataSources/PolylineVolumeGeometryUpdater","./DataSources/PolylineVolumeGraphics","./DataSources/PositionProperty","./DataSources/PositionPropertyArray","./DataSources/Property","./DataSources/PropertyArray","./DataSources/PropertyBag","./DataSources/RectangleGeometryUpdater","./DataSources/RectangleGraphics","./DataSources/ReferenceProperty","./DataSources/Rotation","./DataSources/SampledPositionProperty","./DataSources/SampledProperty","./DataSources/ScaledPositionProperty","./DataSources/StaticGeometryColorBatch","./DataSources/StaticGeometryPerMaterialBatch","./DataSources/StaticGroundGeometryColorBatch","./DataSources/StaticOutlineGeometryBatch","./DataSources/StripeMaterialProperty","./DataSources/StripeOrientation","./DataSources/TimeIntervalCollectionPositionProperty","./DataSources/TimeIntervalCollectionProperty","./DataSources/VelocityOrientationProperty","./DataSources/VelocityVectorProperty","./DataSources/Visualizer","./DataSources/WallGeometryUpdater","./DataSources/WallGraphics","./Renderer/AutomaticUniforms","./Renderer/Buffer","./Renderer/BufferUsage","./Renderer/ClearCommand","./Renderer/ComputeCommand","./Renderer/ComputeEngine","./Renderer/Context","./Renderer/ContextLimits","./Renderer/createUniform","./Renderer/createUniformArray","./Renderer/CubeMap","./Renderer/CubeMapFace","./Renderer/DrawCommand","./Renderer/Framebuffer","./Renderer/loadCubeMap","./Renderer/MipmapHint","./Renderer/modernizeShader","./Renderer/Pass","./Renderer/PassState","./Renderer/PickFramebuffer","./Renderer/PixelDatatype","./Renderer/Renderbuffer","./Renderer/RenderbufferFormat","./Renderer/RenderState","./Renderer/Sampler","./Renderer/ShaderCache","./Renderer/ShaderProgram","./Renderer/ShaderSource","./Renderer/Texture","./Renderer/TextureMagnificationFilter","./Renderer/TextureMinificationFilter","./Renderer/TextureWrap","./Renderer/UniformState","./Renderer/VertexArray","./Renderer/VertexArrayFacade","./Scene/Appearance","./Scene/ArcGisMapServerImageryProvider","./Scene/AttributeType","./Scene/Axis","./Scene/Batched3DModel3DTileContent","./Scene/BatchTable","./Scene/Billboard","./Scene/BillboardCollection","./Scene/BingMapsImageryProvider","./Scene/BingMapsStyle","./Scene/BlendEquation","./Scene/BlendFunction","./Scene/BlendingState","./Scene/BlendOption","./Scene/BoxEmitter","./Scene/BrdfLutGenerator","./Scene/Camera","./Scene/CameraEventAggregator","./Scene/CameraEventType","./Scene/CameraFlightPath","./Scene/Cesium3DTile","./Scene/Cesium3DTileBatchTable","./Scene/Cesium3DTileChildrenVisibility","./Scene/Cesium3DTileColorBlendMode","./Scene/Cesium3DTileContent","./Scene/Cesium3DTileContentFactory","./Scene/Cesium3DTileContentState","./Scene/Cesium3DTileFeature","./Scene/Cesium3DTileFeatureTable","./Scene/Cesium3DTileOptimizationHint","./Scene/Cesium3DTileOptimizations","./Scene/Cesium3DTileRefine","./Scene/Cesium3DTileset","./Scene/Cesium3DTilesetStatistics","./Scene/Cesium3DTilesetTraversal","./Scene/Cesium3DTileStyle","./Scene/Cesium3DTileStyleEngine","./Scene/CircleEmitter","./Scene/ClassificationPrimitive","./Scene/ColorBlendMode","./Scene/Composite3DTileContent","./Scene/ConditionsExpression","./Scene/ConeEmitter","./Scene/createOpenStreetMapImageryProvider","./Scene/createTangentSpaceDebugPrimitive","./Scene/createTileMapServiceImageryProvider","./Scene/CreditDisplay","./Scene/CullFace","./Scene/DebugAppearance","./Scene/DebugCameraPrimitive","./Scene/DebugModelMatrixPrimitive","./Scene/DepthFunction","./Scene/DepthPlane","./Scene/DeviceOrientationCameraController","./Scene/DiscardMissingTileImagePolicy","./Scene/EllipsoidPrimitive","./Scene/EllipsoidSurfaceAppearance","./Scene/Empty3DTileContent","./Scene/Expression","./Scene/ExpressionNodeType","./Scene/Fog","./Scene/FrameRateMonitor","./Scene/FrameState","./Scene/FrustumCommands","./Scene/FXAA","./Scene/getAttributeOrUniformBySemantic","./Scene/getBinaryAccessor","./Scene/GetFeatureInfoFormat","./Scene/Globe","./Scene/GlobeDepth","./Scene/GlobeSurfaceShaderSet","./Scene/GlobeSurfaceTile","./Scene/GlobeSurfaceTileProvider","./Scene/GoogleEarthEnterpriseImageryProvider","./Scene/GoogleEarthEnterpriseMapsProvider","./Scene/GoogleEarthImageryProvider","./Scene/GridImageryProvider","./Scene/GroundPrimitive","./Scene/HeightReference","./Scene/HorizontalOrigin","./Scene/Imagery","./Scene/ImageryLayer","./Scene/ImageryLayerCollection","./Scene/ImageryLayerFeatureInfo","./Scene/ImageryProvider","./Scene/ImagerySplitDirection","./Scene/ImageryState","./Scene/Instanced3DModel3DTileContent","./Scene/JobScheduler","./Scene/JobType","./Scene/Label","./Scene/LabelCollection","./Scene/LabelStyle","./Scene/MapboxImageryProvider","./Scene/MapMode2D","./Scene/Material","./Scene/MaterialAppearance","./Scene/Model","./Scene/ModelAnimation","./Scene/ModelAnimationCache","./Scene/ModelAnimationCollection","./Scene/ModelAnimationLoop","./Scene/ModelAnimationState","./Scene/ModelInstance","./Scene/ModelInstanceCollection","./Scene/ModelMaterial","./Scene/ModelMesh","./Scene/ModelNode","./Scene/Moon","./Scene/NeverTileDiscardPolicy","./Scene/OIT","./Scene/Particle","./Scene/ParticleBurst","./Scene/ParticleEmitter","./Scene/ParticleSystem","./Scene/PerformanceDisplay","./Scene/PerInstanceColorAppearance","./Scene/PickDepth","./Scene/PointCloud3DTileContent","./Scene/PointPrimitive","./Scene/PointPrimitiveCollection","./Scene/Polyline","./Scene/PolylineCollection","./Scene/PolylineColorAppearance","./Scene/PolylineMaterialAppearance","./Scene/Primitive","./Scene/PrimitiveCollection","./Scene/PrimitivePipeline","./Scene/PrimitiveState","./Scene/QuadtreeOccluders","./Scene/QuadtreePrimitive","./Scene/QuadtreeTile","./Scene/QuadtreeTileLoadState","./Scene/QuadtreeTileProvider","./Scene/Scene","./Scene/SceneMode","./Scene/SceneTransforms","./Scene/SceneTransitioner","./Scene/ScreenSpaceCameraController","./Scene/ShadowMap","./Scene/ShadowMapShader","./Scene/ShadowMode","./Scene/SingleTileImageryProvider","./Scene/SkyAtmosphere","./Scene/SkyBox","./Scene/SphereEmitter","./Scene/StencilFunction","./Scene/StencilOperation","./Scene/StyleExpression","./Scene/Sun","./Scene/SunPostProcess","./Scene/TerrainState","./Scene/TextureAtlas","./Scene/TileBoundingRegion","./Scene/TileBoundingSphere","./Scene/TileBoundingVolume","./Scene/TileCoordinatesImageryProvider","./Scene/TileDiscardPolicy","./Scene/TileImagery","./Scene/TileOrientedBoundingBox","./Scene/TileReplacementQueue","./Scene/Tileset3DTileContent","./Scene/TileState","./Scene/TileTerrain","./Scene/TimeDynamicImagery","./Scene/TweenCollection","./Scene/UrlTemplateImageryProvider","./Scene/VerticalOrigin","./Scene/ViewportQuad","./Scene/WebMapServiceImageryProvider","./Scene/WebMapTileServiceImageryProvider","./Shaders/AdjustTranslucentFS","./Shaders/Appearances/AllMaterialAppearanceFS","./Shaders/Appearances/AllMaterialAppearanceVS","./Shaders/Appearances/BasicMaterialAppearanceFS","./Shaders/Appearances/BasicMaterialAppearanceVS","./Shaders/Appearances/EllipsoidSurfaceAppearanceFS","./Shaders/Appearances/EllipsoidSurfaceAppearanceVS","./Shaders/Appearances/PerInstanceColorAppearanceFS","./Shaders/Appearances/PerInstanceColorAppearanceVS","./Shaders/Appearances/PerInstanceFlatColorAppearanceFS","./Shaders/Appearances/PerInstanceFlatColorAppearanceVS","./Shaders/Appearances/PolylineColorAppearanceVS","./Shaders/Appearances/PolylineMaterialAppearanceVS","./Shaders/Appearances/TexturedMaterialAppearanceFS","./Shaders/Appearances/TexturedMaterialAppearanceVS","./Shaders/BillboardCollectionFS","./Shaders/BillboardCollectionVS","./Shaders/BrdfLutGeneratorFS","./Shaders/Builtin/Constants/degreesPerRadian","./Shaders/Builtin/Constants/depthRange","./Shaders/Builtin/Constants/epsilon1","./Shaders/Builtin/Constants/epsilon2","./Shaders/Builtin/Constants/epsilon3","./Shaders/Builtin/Constants/epsilon4","./Shaders/Builtin/Constants/epsilon5","./Shaders/Builtin/Constants/epsilon6","./Shaders/Builtin/Constants/epsilon7","./Shaders/Builtin/Constants/infinity","./Shaders/Builtin/Constants/oneOverPi","./Shaders/Builtin/Constants/oneOverTwoPi","./Shaders/Builtin/Constants/passCesium3DTile","./Shaders/Builtin/Constants/passCompute","./Shaders/Builtin/Constants/passEnvironment","./Shaders/Builtin/Constants/passGlobe","./Shaders/Builtin/Constants/passGround","./Shaders/Builtin/Constants/passOpaque","./Shaders/Builtin/Constants/passOverlay","./Shaders/Builtin/Constants/passTranslucent","./Shaders/Builtin/Constants/pi","./Shaders/Builtin/Constants/piOverFour","./Shaders/Builtin/Constants/piOverSix","./Shaders/Builtin/Constants/piOverThree","./Shaders/Builtin/Constants/piOverTwo","./Shaders/Builtin/Constants/radiansPerDegree","./Shaders/Builtin/Constants/sceneMode2D","./Shaders/Builtin/Constants/sceneMode3D","./Shaders/Builtin/Constants/sceneModeColumbusView","./Shaders/Builtin/Constants/sceneModeMorphing","./Shaders/Builtin/Constants/solarRadius","./Shaders/Builtin/Constants/threePiOver2","./Shaders/Builtin/Constants/twoPi","./Shaders/Builtin/Constants/webMercatorMaxLatitude","./Shaders/Builtin/CzmBuiltins","./Shaders/Builtin/Functions/alphaWeight","./Shaders/Builtin/Functions/antialias","./Shaders/Builtin/Functions/cascadeColor","./Shaders/Builtin/Functions/cascadeDistance","./Shaders/Builtin/Functions/cascadeMatrix","./Shaders/Builtin/Functions/cascadeWeights","./Shaders/Builtin/Functions/columbusViewMorph","./Shaders/Builtin/Functions/computePosition","./Shaders/Builtin/Functions/cosineAndSine","./Shaders/Builtin/Functions/decompressTextureCoordinates","./Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates","./Shaders/Builtin/Functions/ellipsoidContainsPoint","./Shaders/Builtin/Functions/ellipsoidNew","./Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates","./Shaders/Builtin/Functions/equalsEpsilon","./Shaders/Builtin/Functions/eyeOffset","./Shaders/Builtin/Functions/eyeToWindowCoordinates","./Shaders/Builtin/Functions/fog","./Shaders/Builtin/Functions/geodeticSurfaceNormal","./Shaders/Builtin/Functions/getDefaultMaterial","./Shaders/Builtin/Functions/getLambertDiffuse","./Shaders/Builtin/Functions/getSpecular","./Shaders/Builtin/Functions/getWaterNoise","./Shaders/Builtin/Functions/getWgs84EllipsoidEC","./Shaders/Builtin/Functions/HSBToRGB","./Shaders/Builtin/Functions/HSLToRGB","./Shaders/Builtin/Functions/hue","./Shaders/Builtin/Functions/isEmpty","./Shaders/Builtin/Functions/isFull","./Shaders/Builtin/Functions/latitudeToWebMercatorFraction","./Shaders/Builtin/Functions/luminance","./Shaders/Builtin/Functions/metersPerPixel","./Shaders/Builtin/Functions/modelToWindowCoordinates","./Shaders/Builtin/Functions/multiplyWithColorBalance","./Shaders/Builtin/Functions/nearFarScalar","./Shaders/Builtin/Functions/octDecode","./Shaders/Builtin/Functions/packDepth","./Shaders/Builtin/Functions/phong","./Shaders/Builtin/Functions/pointAlongRay","./Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval","./Shaders/Builtin/Functions/RGBToHSB","./Shaders/Builtin/Functions/RGBToHSL","./Shaders/Builtin/Functions/RGBToXYZ","./Shaders/Builtin/Functions/saturation","./Shaders/Builtin/Functions/shadowDepthCompare","./Shaders/Builtin/Functions/shadowVisibility","./Shaders/Builtin/Functions/signNotZero","./Shaders/Builtin/Functions/tangentToEyeSpaceMatrix","./Shaders/Builtin/Functions/translateRelativeToEye","./Shaders/Builtin/Functions/translucentPhong","./Shaders/Builtin/Functions/transpose","./Shaders/Builtin/Functions/unpackDepth","./Shaders/Builtin/Functions/windowToEyeCoordinates","./Shaders/Builtin/Functions/XYZToRGB","./Shaders/Builtin/Structs/depthRangeStruct","./Shaders/Builtin/Structs/ellipsoid","./Shaders/Builtin/Structs/material","./Shaders/Builtin/Structs/materialInput","./Shaders/Builtin/Structs/ray","./Shaders/Builtin/Structs/raySegment","./Shaders/Builtin/Structs/shadowParameters","./Shaders/CompositeOITFS","./Shaders/DepthPlaneFS","./Shaders/DepthPlaneVS","./Shaders/EllipsoidFS","./Shaders/EllipsoidVS","./Shaders/GlobeFS","./Shaders/GlobeVS","./Shaders/GroundAtmosphere","./Shaders/Materials/BumpMapMaterial","./Shaders/Materials/CheckerboardMaterial","./Shaders/Materials/DotMaterial","./Shaders/Materials/FadeMaterial","./Shaders/Materials/GridMaterial","./Shaders/Materials/NormalMapMaterial","./Shaders/Materials/PolylineArrowMaterial","./Shaders/Materials/PolylineDashMaterial","./Shaders/Materials/PolylineGlowMaterial","./Shaders/Materials/PolylineOutlineMaterial","./Shaders/Materials/RimLightingMaterial","./Shaders/Materials/StripeMaterial","./Shaders/Materials/Water","./Shaders/PointPrimitiveCollectionFS","./Shaders/PointPrimitiveCollectionVS","./Shaders/PolylineCommon","./Shaders/PolylineFS","./Shaders/PolylineVS","./Shaders/PostProcessFilters/AdditiveBlend","./Shaders/PostProcessFilters/BrightPass","./Shaders/PostProcessFilters/FXAA","./Shaders/PostProcessFilters/GaussianBlur1D","./Shaders/PostProcessFilters/PassThrough","./Shaders/ReprojectWebMercatorFS","./Shaders/ReprojectWebMercatorVS","./Shaders/ShadowVolumeFS","./Shaders/ShadowVolumeVS","./Shaders/SkyAtmosphereFS","./Shaders/SkyAtmosphereVS","./Shaders/SkyBoxFS","./Shaders/SkyBoxVS","./Shaders/SunFS","./Shaders/SunTextureFS","./Shaders/SunVS","./Shaders/ViewportQuadFS","./Shaders/ViewportQuadVS","./ThirdParty/Autolinker","./ThirdParty/crunch","./ThirdParty/earcut-2.1.1","./ThirdParty/GltfPipeline/addDefaults","./ThirdParty/GltfPipeline/addExtensionsRequired","./ThirdParty/GltfPipeline/addExtensionsUsed","./ThirdParty/GltfPipeline/addPipelineExtras","./ThirdParty/GltfPipeline/addToArray","./ThirdParty/GltfPipeline/byteLengthForComponentType","./ThirdParty/GltfPipeline/findAccessorMinMax","./ThirdParty/GltfPipeline/ForEach","./ThirdParty/GltfPipeline/getAccessorByteStride","./ThirdParty/GltfPipeline/getJointCountForMaterials","./ThirdParty/GltfPipeline/getUniqueId","./ThirdParty/GltfPipeline/glslTypeToWebGLConstant","./ThirdParty/GltfPipeline/numberOfComponentsForType","./ThirdParty/GltfPipeline/parseBinaryGltf","./ThirdParty/GltfPipeline/processModelMaterialsCommon","./ThirdParty/GltfPipeline/processPbrMetallicRoughness","./ThirdParty/GltfPipeline/removeExtensionsRequired","./ThirdParty/GltfPipeline/removeExtensionsUsed","./ThirdParty/GltfPipeline/removePipelineExtras","./ThirdParty/GltfPipeline/techniqueParameterForSemantic","./ThirdParty/GltfPipeline/updateVersion","./ThirdParty/GltfPipeline/webGLConstantToGlslType","./ThirdParty/google-earth-dbroot-parser","./ThirdParty/jsep","./ThirdParty/kdbush","./ThirdParty/knockout-3.4.0","./ThirdParty/knockout-es5","./ThirdParty/knockout","./ThirdParty/measureText","./ThirdParty/mersenne-twister","./ThirdParty/NoSleep","./ThirdParty/pako_inflate","./ThirdParty/protobuf-minimal","./ThirdParty/Shaders/FXAA3_11","./ThirdParty/sprintf","./ThirdParty/topojson","./ThirdParty/Tween","./ThirdParty/Uri","./ThirdParty/when","./ThirdParty/zip","./Widgets/Animation/Animation","./Widgets/Animation/AnimationViewModel","./Widgets/BaseLayerPicker/BaseLayerPicker","./Widgets/BaseLayerPicker/BaseLayerPickerViewModel","./Widgets/BaseLayerPicker/createDefaultImageryProviderViewModels","./Widgets/BaseLayerPicker/createDefaultTerrainProviderViewModels","./Widgets/BaseLayerPicker/ProviderViewModel","./Widgets/Cesium3DTilesInspector/Cesium3DTilesInspector","./Widgets/Cesium3DTilesInspector/Cesium3DTilesInspectorViewModel","./Widgets/CesiumInspector/CesiumInspector","./Widgets/CesiumInspector/CesiumInspectorViewModel","./Widgets/CesiumWidget/CesiumWidget","./Widgets/ClockViewModel","./Widgets/Command","./Widgets/createCommand","./Widgets/FullscreenButton/FullscreenButton","./Widgets/FullscreenButton/FullscreenButtonViewModel","./Widgets/Geocoder/Geocoder","./Widgets/Geocoder/GeocoderViewModel","./Widgets/getElement","./Widgets/HomeButton/HomeButton","./Widgets/HomeButton/HomeButtonViewModel","./Widgets/InfoBox/InfoBox","./Widgets/InfoBox/InfoBoxViewModel","./Widgets/NavigationHelpButton/NavigationHelpButton","./Widgets/NavigationHelpButton/NavigationHelpButtonViewModel","./Widgets/PerformanceWatchdog/PerformanceWatchdog","./Widgets/PerformanceWatchdog/PerformanceWatchdogViewModel","./Widgets/ProjectionPicker/ProjectionPicker","./Widgets/ProjectionPicker/ProjectionPickerViewModel","./Widgets/SceneModePicker/SceneModePicker","./Widgets/SceneModePicker/SceneModePickerViewModel","./Widgets/SelectionIndicator/SelectionIndicator","./Widgets/SelectionIndicator/SelectionIndicatorViewModel","./Widgets/subscribeAndEvaluate","./Widgets/SvgPathBindingHandler","./Widgets/Timeline/Timeline","./Widgets/Timeline/TimelineHighlightRange","./Widgets/Timeline/TimelineTrack","./Widgets/ToggleButtonViewModel","./Widgets/Viewer/Viewer","./Widgets/Viewer/viewerCesium3DTilesInspectorMixin","./Widgets/Viewer/viewerCesiumInspectorMixin","./Widgets/Viewer/viewerDragDropMixin","./Widgets/Viewer/viewerPerformanceWatchdogMixin","./Widgets/VRButton/VRButton","./Widgets/VRButton/VRButtonViewModel","./Workers/createTaskProcessorWorker"],function(e,t,r,i,n,a,o,s,l,u,c,d,f,h,p,m,v,g,_,y,b,w,C,S,T,E,x,P,A,O,D,I,M,R,L,N,k,F,B,U,V,z,q,G,H,j,W,Y,X,Q,Z,K,J,$,ee,te,re,ie,ne,ae,oe,se,le,ue,ce,de,fe,he,pe,me,ve,ge,_e,ye,be,we,Ce,Se,Te,Ee,xe,Pe,Ae,Oe,De,Ie,Me,Re,Le,Ne,ke,Fe,Be,Ue,Ve,ze,qe,Ge,He,je,We,Ye,Xe,Qe,Ze,Ke,Je,$e,et,tt,rt,it,nt,at,ot,st,lt,ut,ct,dt,ft,ht,pt,mt,vt,gt,_t,yt,bt,wt,Ct,St,Tt,Et,xt,Pt,At,Ot,Dt,It,Mt,Rt,Lt,Nt,kt,Ft,Bt,Ut,Vt,zt,qt,Gt,Ht,jt,Wt,Yt,Xt,Qt,Zt,Kt,Jt,$t,er,tr,rr,ir,nr,ar,or,sr,lr,ur,cr,dr,fr,hr,pr,mr,vr,gr,_r,yr,br,wr,Cr,Sr,Tr,Er,xr,Pr,Ar,Or,Dr,Ir,Mr,Rr,Lr,Nr,kr,Fr,Br,Ur,Vr,zr,qr,Gr,Hr,jr,Wr,Yr,Xr,Qr,Zr,Kr,Jr,$r,ei,ti,ri,ii,ni,ai,oi,si,li,ui,ci,di,fi,hi,pi,mi,vi,gi,_i,yi,bi,wi,Ci,Si,Ti,Ei,xi,Pi,Ai,Oi,Di,Ii,Mi,Ri,Li,Ni,ki,Fi,Bi,Ui,Vi,zi,qi,Gi,Hi,ji,Wi,Yi,Xi,Qi,Zi,Ki,Ji,$i,en,tn,rn,nn,an,on,sn,ln,un,cn,dn,fn,hn,pn,mn,vn,gn,_n,yn,bn,wn,Cn,Sn,Tn,En,xn,Pn,An,On,Dn,In,Mn,Rn,Ln,Nn,kn,Fn,Bn,Un,Vn,zn,qn,Gn,Hn,jn,Wn,Yn,Xn,Qn,Zn,Kn,Jn,$n,ea,ta,ra,ia,na,aa,oa,sa,la,ua,ca,da,fa,ha,pa,ma,va,ga,_a,ya,ba,wa,Ca,Sa,Ta,Ea,xa,Pa,Aa,Oa,Da,Ia,Ma,Ra,La,Na,ka,Fa,Ba,Ua,Va,za,qa,Ga,Ha,ja,Wa,Ya,Xa,Qa,Za,Ka,Ja,$a,eo,to,ro,io,no,ao,oo,so,lo,uo,co,fo,ho,po,mo,vo,go,_o,yo,bo,wo,Co,So,To,Eo,xo,Po,Ao,Oo,Do,Io,Mo,Ro,Lo,No,ko,Fo,Bo,Uo,Vo,zo,qo,Go,Ho,jo,Wo,Yo,Xo,Qo,Zo,Ko,Jo,$o,es,ts,rs,is,ns,as,os,ss,ls,us,cs,ds,fs,hs,ps,ms,vs,gs,_s,ys,bs,ws,Cs,Ss,Ts,Es,xs,Ps,As,Os,Ds,Is,Ms,Rs,Ls,Ns,ks,Fs,Bs,Us,Vs,zs,qs,Gs,Hs,js,Ws,Ys,Xs,Qs,Zs,Ks,Js,$s,el,tl,rl,il,nl,al,ol,sl,ll,ul,cl,dl,fl,hl,pl,ml,vl,gl,_l,yl,bl,wl,Cl,Sl,Tl,El,xl,Pl,Al,Ol,Dl,Il,Ml,Rl,Ll,Nl,kl,Fl,Bl,Ul,Vl,zl,ql,Gl,Hl,jl,Wl,Yl,Xl,Ql,Zl,Kl,Jl,$l,eu,tu,ru,iu,nu,au,ou,su,lu,uu,cu,du,fu,hu,pu,mu,vu,gu,_u,yu,bu,wu,Cu,Su,Tu,Eu,xu,Pu,Au,Ou,Du,Iu,Mu,Ru,Lu,Nu,ku,Fu,Bu,Uu,Vu,zu,qu,Gu,Hu,ju,Wu,Yu,Xu,Qu,Zu,Ku,Ju,$u,ec,tc,rc,ic,nc,ac,oc,sc,lc,uc,cc,dc,fc,hc,pc,mc,vc,gc,_c,yc,bc,wc,Cc,Sc,Tc,Ec,xc,Pc,Ac,Oc,Dc,Ic,Mc,Rc,Lc,Nc,kc,Fc,Bc,Uc,Vc,zc,qc,Gc,Hc,jc,Wc,Yc,Xc,Qc,Zc,Kc,Jc,$c,ed,td,rd,id,nd,ad,od,sd,ld,ud,cd,dd,fd,hd,pd,md,vd,gd,_d,yd,bd,wd,Cd,Sd,Td,Ed,xd,Pd,Ad,Od,Dd,Id,Md,Rd,Ld,Nd,kd,Fd,Bd,Ud,Vd,zd,qd,Gd,Hd,jd,Wd,Yd,Xd,Qd,Zd,Kd,Jd,$d,ef,tf,rf,nf,af,of,sf,lf,uf,cf,df,ff,hf,pf,mf,vf,gf,_f,yf,bf,wf,Cf,Sf,Tf,Ef,xf,Pf,Af,Of,Df,If,Mf,Rf,Lf,Nf,kf,Ff,Bf,Uf,Vf,zf,qf,Gf,Hf,jf,Wf,Yf,Xf,Qf,Zf,Kf,Jf,$f,eh,th,rh,ih,nh,ah,oh,sh,lh,uh,ch,dh,fh,hh,ph,mh,vh,gh,_h,yh,bh,wh,Ch,Sh,Th,Eh,xh,Ph,Ah,Oh,Dh,Ih,Mh,Rh,Lh,Nh,kh){"use strict";var Fh={VERSION:"1.36",_shaders:{}};Fh["appendForwardSlash"]=e;Fh["arrayFill"]=t;Fh["arrayRemoveDuplicates"]=r;Fh["AssociativeArray"]=i;Fh["AttributeCompression"]=n;Fh["AxisAlignedBoundingBox"]=a;Fh["barycentricCoordinates"]=o;Fh["binarySearch"]=s;Fh["BingMapsApi"]=l;Fh["BingMapsGeocoderService"]=u;Fh["BoundingRectangle"]=c;Fh["BoundingSphere"]=d;Fh["BoxGeometry"]=f;Fh["BoxOutlineGeometry"]=h;Fh["buildModuleUrl"]=p;Fh["cancelAnimationFrame"]=m;Fh["Cartesian2"]=v;Fh["Cartesian3"]=g;Fh["Cartesian4"]=_;Fh["Cartographic"]=y;Fh["CartographicGeocoderService"]=b;Fh["CatmullRomSpline"]=w;Fh["CesiumTerrainProvider"]=C;Fh["Check"]=S;Fh["CircleGeometry"]=T;Fh["CircleOutlineGeometry"]=E;Fh["Clock"]=x;Fh["ClockRange"]=P;Fh["ClockStep"]=A;Fh["clone"]=O;Fh["Color"]=D;Fh["ColorGeometryInstanceAttribute"]=I;Fh["combine"]=M;Fh["ComponentDatatype"]=R;Fh["CompressedTextureBuffer"]=L;Fh["CornerType"]=N;Fh["CorridorGeometry"]=k;Fh["CorridorGeometryLibrary"]=F;Fh["CorridorOutlineGeometry"]=B;Fh["createGuid"]=U;Fh["Credit"]=V;Fh["CubicRealPolynomial"]=z;Fh["CullingVolume"]=q;Fh["CylinderGeometry"]=G;Fh["CylinderGeometryLibrary"]=H;Fh["CylinderOutlineGeometry"]=j;Fh["decodeGoogleEarthEnterpriseData"]=W;Fh["DefaultProxy"]=Y;Fh["defaultValue"]=X;Fh["defined"]=Q;Fh["defineProperties"]=Z;Fh["deprecationWarning"]=K;Fh["destroyObject"]=J;Fh["DeveloperError"]=$;Fh["DistanceDisplayCondition"]=ee;Fh["DistanceDisplayConditionGeometryInstanceAttribute"]=te;Fh["DoublyLinkedList"]=re;Fh["EarthOrientationParameters"]=ie;Fh["EarthOrientationParametersSample"]=ne;Fh["EasingFunction"]=ae;Fh["EllipseGeometry"]=oe;Fh["EllipseGeometryLibrary"]=se;Fh["EllipseOutlineGeometry"]=le;Fh["Ellipsoid"]=ue;Fh["EllipsoidalOccluder"]=ce;Fh["EllipsoidGeodesic"]=de;Fh["EllipsoidGeometry"]=fe;Fh["EllipsoidOutlineGeometry"]=he;Fh["EllipsoidTangentPlane"]=pe;Fh["EllipsoidTerrainProvider"]=me;Fh["EncodedCartesian3"]=ve;Fh["Event"]=ge;Fh["EventHelper"]=_e;Fh["ExtrapolationType"]=ye;Fh["FeatureDetection"]=be;Fh["formatError"]=we;Fh["freezeObject"]=Ce;Fh["FrustumGeometry"]=Se;Fh["FrustumOutlineGeometry"]=Te;Fh["Fullscreen"]=Ee;Fh["GeocoderService"]=xe;Fh["GeographicProjection"]=Pe;Fh["GeographicTilingScheme"]=Ae;Fh["Geometry"]=Oe;Fh["GeometryAttribute"]=De;Fh["GeometryAttributes"]=Ie;Fh["GeometryInstance"]=Me;Fh["GeometryInstanceAttribute"]=Re;Fh["GeometryPipeline"]=Le;Fh["GeometryType"]=Ne;Fh["getAbsoluteUri"]=ke;Fh["getBaseUri"]=Fe;Fh["getExtensionFromUri"]=Be;Fh["getFilenameFromUri"]=Ue;Fh["getImagePixels"]=Ve;Fh["getMagic"]=ze;Fh["getStringFromTypedArray"]=qe;Fh["getTimestamp"]=Ge;Fh["GoogleEarthEnterpriseMetadata"]=He;Fh["GoogleEarthEnterpriseTerrainData"]=je;Fh["GoogleEarthEnterpriseTerrainProvider"]=We;Fh["GoogleEarthEnterpriseTileInformation"]=Ye;Fh["GregorianDate"]=Xe;Fh["HeadingPitchRange"]=Qe;Fh["HeadingPitchRoll"]=Ze;Fh["Heap"]=Ke;Fh["HeightmapTerrainData"]=Je;Fh["HeightmapTessellator"]=$e;Fh["HermitePolynomialApproximation"]=et;Fh["HermiteSpline"]=tt;Fh["Iau2000Orientation"]=rt;Fh["Iau2006XysData"]=it;Fh["Iau2006XysSample"]=nt;Fh["IauOrientationAxes"]=at;Fh["IauOrientationParameters"]=ot;Fh["IndexDatatype"]=st;Fh["InterpolationAlgorithm"]=lt;Fh["Intersect"]=ut;Fh["Intersections2D"]=ct;Fh["IntersectionTests"]=dt;Fh["Interval"]=ft;Fh["isArray"]=ht;Fh["isBitSet"]=pt;Fh["isBlobUri"]=mt;Fh["isCrossOriginUrl"]=vt;Fh["isDataUri"]=gt;Fh["isLeapYear"]=_t;Fh["Iso8601"]=yt;Fh["joinUrls"]=bt;Fh["JulianDate"]=wt;Fh["KeyboardEventModifier"]=Ct;Fh["LagrangePolynomialApproximation"]=St;Fh["LeapSecond"]=Tt;Fh["LinearApproximation"]=Et;Fh["LinearSpline"]=xt;Fh["loadArrayBuffer"]=Pt;Fh["loadBlob"]=At;Fh["loadCRN"]=Ot;Fh["loadImage"]=Dt;Fh["loadImageFromTypedArray"]=It;Fh["loadImageViaBlob"]=Mt;Fh["loadJson"]=Rt;Fh["loadJsonp"]=Lt;Fh["loadKTX"]=Nt;Fh["loadText"]=kt;Fh["loadWithXhr"]=Ft;Fh["loadXML"]=Bt;Fh["ManagedArray"]=Ut;Fh["MapboxApi"]=Vt;Fh["MapProjection"]=zt;Fh["Math"]=qt;Fh["Matrix2"]=Gt;Fh["Matrix3"]=Ht;Fh["Matrix4"]=jt;Fh["mergeSort"]=Wt;Fh["NearFarScalar"]=Yt;Fh["objectToQuery"]=Xt;Fh["Occluder"]=Qt;Fh["oneTimeWarning"]=Zt;Fh["OrientedBoundingBox"]=Kt;Fh["OrthographicFrustum"]=Jt;Fh["OrthographicOffCenterFrustum"]=$t;Fh["Packable"]=er;Fh["PackableForInterpolation"]=tr;Fh["parseResponseHeaders"]=rr;Fh["PerspectiveFrustum"]=ir;Fh["PerspectiveOffCenterFrustum"]=nr;Fh["PinBuilder"]=ar;Fh["PixelFormat"]=or;Fh["Plane"]=sr;Fh["pointInsideTriangle"]=lr;Fh["PolygonGeometry"]=ur;Fh["PolygonGeometryLibrary"]=cr;Fh["PolygonHierarchy"]=dr;Fh["PolygonOutlineGeometry"]=fr;Fh["PolygonPipeline"]=hr;Fh["PolylineGeometry"]=pr;Fh["PolylinePipeline"]=mr;Fh["PolylineVolumeGeometry"]=vr;Fh["PolylineVolumeGeometryLibrary"]=gr;Fh["PolylineVolumeOutlineGeometry"]=_r;Fh["PrimitiveType"]=yr;Fh["QuadraticRealPolynomial"]=br;Fh["QuantizedMeshTerrainData"]=wr;Fh["QuarticRealPolynomial"]=Cr;Fh["Quaternion"]=Sr;Fh["QuaternionSpline"]=Tr;Fh["queryToObject"]=Er;Fh["Queue"]=xr;Fh["Ray"]=Pr;Fh["Rectangle"]=Ar;Fh["RectangleGeometry"]=Or;Fh["RectangleGeometryLibrary"]=Dr;Fh["RectangleOutlineGeometry"]=Ir;Fh["ReferenceFrame"]=Mr;Fh["Request"]=Rr;Fh["requestAnimationFrame"]=Lr;Fh["RequestErrorEvent"]=Nr;Fh["RequestScheduler"]=kr;Fh["RequestState"]=Fr;Fh["RequestType"]=Br;Fh["RuntimeError"]=Ur;Fh["sampleTerrain"]=Vr;Fh["sampleTerrainMostDetailed"]=zr;Fh["scaleToGeodeticSurface"]=qr;Fh["ScreenSpaceEventHandler"]=Gr;Fh["ScreenSpaceEventType"]=Hr;Fh["ShowGeometryInstanceAttribute"]=jr;Fh["Simon1994PlanetaryPositions"]=Wr;Fh["SimplePolylineGeometry"]=Yr;Fh["SphereGeometry"]=Xr;Fh["SphereOutlineGeometry"]=Qr;Fh["Spherical"]=Zr;Fh["Spline"]=Kr;Fh["subdivideArray"]=Jr;Fh["TaskProcessor"]=$r;Fh["TerrainData"]=ei;Fh["TerrainEncoding"]=ti;Fh["TerrainMesh"]=ri;Fh["TerrainProvider"]=ii;Fh["TerrainQuantization"]=ni;Fh["TileAvailability"]=ai;Fh["TileProviderError"]=oi;Fh["TilingScheme"]=si;Fh["TimeConstants"]=li;Fh["TimeInterval"]=ui;Fh["TimeIntervalCollection"]=ci;Fh["TimeStandard"]=di;Fh["Tipsify"]=fi;Fh["Transforms"]=hi;Fh["TranslationRotationScale"]=pi;Fh["TridiagonalSystemSolver"]=mi;Fh["TrustedServers"]=vi;Fh["VertexFormat"]=gi;Fh["VideoSynchronizer"]=_i;Fh["Visibility"]=yi;Fh["VRTheWorldTerrainProvider"]=bi;Fh["WallGeometry"]=wi;Fh["WallGeometryLibrary"]=Ci;Fh["WallOutlineGeometry"]=Si;Fh["WebGLConstants"]=Ti;Fh["WebMercatorProjection"]=Ei;Fh["WebMercatorTilingScheme"]=xi;Fh["WeightSpline"]=Pi;Fh["WindingOrder"]=Ai;Fh["wrapFunction"]=Oi;Fh["writeTextToCanvas"]=Di;Fh["BillboardGraphics"]=Ii;Fh["BillboardVisualizer"]=Mi;Fh["BoundingSphereState"]=Ri;Fh["BoxGeometryUpdater"]=Li;Fh["BoxGraphics"]=Ni;Fh["CallbackProperty"]=ki;Fh["CheckerboardMaterialProperty"]=Fi;Fh["ColorMaterialProperty"]=Bi;Fh["CompositeEntityCollection"]=Ui;Fh["CompositeMaterialProperty"]=Vi;Fh["CompositePositionProperty"]=zi;Fh["CompositeProperty"]=qi;Fh["ConstantPositionProperty"]=Gi;Fh["ConstantProperty"]=Hi;Fh["CorridorGeometryUpdater"]=ji;Fh["CorridorGraphics"]=Wi;Fh["createMaterialPropertyDescriptor"]=Yi;Fh["createPropertyDescriptor"]=Xi;Fh["createRawPropertyDescriptor"]=Qi;Fh["CustomDataSource"]=Zi;Fh["CylinderGeometryUpdater"]=Ki;Fh["CylinderGraphics"]=Ji;Fh["CzmlDataSource"]=$i;Fh["DataSource"]=en;Fh["DataSourceClock"]=tn;Fh["DataSourceCollection"]=rn;Fh["DataSourceDisplay"]=nn;Fh["dynamicGeometryGetBoundingSphere"]=an;Fh["DynamicGeometryUpdater"]=on;Fh["EllipseGeometryUpdater"]=sn;Fh["EllipseGraphics"]=ln;Fh["EllipsoidGeometryUpdater"]=un;Fh["EllipsoidGraphics"]=cn;Fh["Entity"]=dn;Fh["EntityCluster"]=fn;Fh["EntityCollection"]=hn;Fh["EntityView"]=pn;Fh["GeoJsonDataSource"]=mn;Fh["GeometryUpdater"]=vn;Fh["GeometryVisualizer"]=gn;Fh["GridMaterialProperty"]=_n;Fh["ImageMaterialProperty"]=yn;Fh["KmlDataSource"]=bn;Fh["LabelGraphics"]=wn;Fh["LabelVisualizer"]=Cn;Fh["MaterialProperty"]=Sn;Fh["ModelGraphics"]=Tn;Fh["ModelVisualizer"]=En;Fh["NodeTransformationProperty"]=xn;Fh["PathGraphics"]=Pn;Fh["PathVisualizer"]=An;Fh["PointGraphics"]=On;Fh["PointVisualizer"]=Dn;Fh["PolygonGeometryUpdater"]=In;Fh["PolygonGraphics"]=Mn;Fh["PolylineArrowMaterialProperty"]=Rn;Fh["PolylineDashMaterialProperty"]=Ln;Fh["PolylineGeometryUpdater"]=Nn;Fh["PolylineGlowMaterialProperty"]=kn;Fh["PolylineGraphics"]=Fn;Fh["PolylineOutlineMaterialProperty"]=Bn;Fh["PolylineVolumeGeometryUpdater"]=Un;Fh["PolylineVolumeGraphics"]=Vn;Fh["PositionProperty"]=zn;Fh["PositionPropertyArray"]=qn;Fh["Property"]=Gn;Fh["PropertyArray"]=Hn;Fh["PropertyBag"]=jn;Fh["RectangleGeometryUpdater"]=Wn;Fh["RectangleGraphics"]=Yn;Fh["ReferenceProperty"]=Xn;Fh["Rotation"]=Qn;Fh["SampledPositionProperty"]=Zn;Fh["SampledProperty"]=Kn;Fh["ScaledPositionProperty"]=Jn;Fh["StaticGeometryColorBatch"]=$n;Fh["StaticGeometryPerMaterialBatch"]=ea;Fh["StaticGroundGeometryColorBatch"]=ta;Fh["StaticOutlineGeometryBatch"]=ra;Fh["StripeMaterialProperty"]=ia;Fh["StripeOrientation"]=na;Fh["TimeIntervalCollectionPositionProperty"]=aa;Fh["TimeIntervalCollectionProperty"]=oa;Fh["VelocityOrientationProperty"]=sa;Fh["VelocityVectorProperty"]=la;Fh["Visualizer"]=ua;Fh["WallGeometryUpdater"]=ca;Fh["WallGraphics"]=da;Fh["AutomaticUniforms"]=fa;Fh["Buffer"]=ha;Fh["BufferUsage"]=pa;Fh["ClearCommand"]=ma;Fh["ComputeCommand"]=va;Fh["ComputeEngine"]=ga;Fh["Context"]=_a;Fh["ContextLimits"]=ya;Fh["createUniform"]=ba;Fh["createUniformArray"]=wa;Fh["CubeMap"]=Ca;Fh["CubeMapFace"]=Sa;Fh["DrawCommand"]=Ta;Fh["Framebuffer"]=Ea;Fh["loadCubeMap"]=xa;Fh["MipmapHint"]=Pa;Fh["modernizeShader"]=Aa;Fh["Pass"]=Oa;Fh["PassState"]=Da;Fh["PickFramebuffer"]=Ia;Fh["PixelDatatype"]=Ma;Fh["Renderbuffer"]=Ra;Fh["RenderbufferFormat"]=La;Fh["RenderState"]=Na;Fh["Sampler"]=ka;Fh["ShaderCache"]=Fa;Fh["ShaderProgram"]=Ba;Fh["ShaderSource"]=Ua;Fh["Texture"]=Va;Fh["TextureMagnificationFilter"]=za;Fh["TextureMinificationFilter"]=qa;Fh["TextureWrap"]=Ga;Fh["UniformState"]=Ha;Fh["VertexArray"]=ja;Fh["VertexArrayFacade"]=Wa;Fh["Appearance"]=Ya;Fh["ArcGisMapServerImageryProvider"]=Xa;Fh["AttributeType"]=Qa;Fh["Axis"]=Za;Fh["Batched3DModel3DTileContent"]=Ka;Fh["BatchTable"]=Ja;Fh["Billboard"]=$a;Fh["BillboardCollection"]=eo;Fh["BingMapsImageryProvider"]=to;Fh["BingMapsStyle"]=ro;Fh["BlendEquation"]=io;Fh["BlendFunction"]=no;Fh["BlendingState"]=ao;Fh["BlendOption"]=oo;Fh["BoxEmitter"]=so;Fh["BrdfLutGenerator"]=lo;Fh["Camera"]=uo;Fh["CameraEventAggregator"]=co;Fh["CameraEventType"]=fo;Fh["CameraFlightPath"]=ho;Fh["Cesium3DTile"]=po;Fh["Cesium3DTileBatchTable"]=mo;Fh["Cesium3DTileChildrenVisibility"]=vo;Fh["Cesium3DTileColorBlendMode"]=go;Fh["Cesium3DTileContent"]=_o;Fh["Cesium3DTileContentFactory"]=yo;Fh["Cesium3DTileContentState"]=bo;Fh["Cesium3DTileFeature"]=wo;Fh["Cesium3DTileFeatureTable"]=Co;Fh["Cesium3DTileOptimizationHint"]=So;Fh["Cesium3DTileOptimizations"]=To;Fh["Cesium3DTileRefine"]=Eo;Fh["Cesium3DTileset"]=xo;Fh["Cesium3DTilesetStatistics"]=Po;Fh["Cesium3DTilesetTraversal"]=Ao;Fh["Cesium3DTileStyle"]=Oo;Fh["Cesium3DTileStyleEngine"]=Do;Fh["CircleEmitter"]=Io;Fh["ClassificationPrimitive"]=Mo;Fh["ColorBlendMode"]=Ro;Fh["Composite3DTileContent"]=Lo;Fh["ConditionsExpression"]=No;Fh["ConeEmitter"]=ko;Fh["createOpenStreetMapImageryProvider"]=Fo;Fh["createTangentSpaceDebugPrimitive"]=Bo;Fh["createTileMapServiceImageryProvider"]=Uo;Fh["CreditDisplay"]=Vo;Fh["CullFace"]=zo;Fh["DebugAppearance"]=qo;Fh["DebugCameraPrimitive"]=Go;Fh["DebugModelMatrixPrimitive"]=Ho;Fh["DepthFunction"]=jo;Fh["DepthPlane"]=Wo;Fh["DeviceOrientationCameraController"]=Yo;Fh["DiscardMissingTileImagePolicy"]=Xo;Fh["EllipsoidPrimitive"]=Qo;Fh["EllipsoidSurfaceAppearance"]=Zo;Fh["Empty3DTileContent"]=Ko;Fh["Expression"]=Jo;Fh["ExpressionNodeType"]=$o;Fh["Fog"]=es;Fh["FrameRateMonitor"]=ts;Fh["FrameState"]=rs;Fh["FrustumCommands"]=is;Fh["FXAA"]=ns;Fh["getAttributeOrUniformBySemantic"]=as;Fh["getBinaryAccessor"]=os;Fh["GetFeatureInfoFormat"]=ss;Fh["Globe"]=ls;Fh["GlobeDepth"]=us;Fh["GlobeSurfaceShaderSet"]=cs;Fh["GlobeSurfaceTile"]=ds;Fh["GlobeSurfaceTileProvider"]=fs;Fh["GoogleEarthEnterpriseImageryProvider"]=hs;Fh["GoogleEarthEnterpriseMapsProvider"]=ps;Fh["GoogleEarthImageryProvider"]=ms;Fh["GridImageryProvider"]=vs;Fh["GroundPrimitive"]=gs;Fh["HeightReference"]=_s;Fh["HorizontalOrigin"]=ys;Fh["Imagery"]=bs;Fh["ImageryLayer"]=ws;Fh["ImageryLayerCollection"]=Cs;Fh["ImageryLayerFeatureInfo"]=Ss;Fh["ImageryProvider"]=Ts;Fh["ImagerySplitDirection"]=Es;Fh["ImageryState"]=xs;Fh["Instanced3DModel3DTileContent"]=Ps;Fh["JobScheduler"]=As;Fh["JobType"]=Os;Fh["Label"]=Ds;Fh["LabelCollection"]=Is;Fh["LabelStyle"]=Ms;Fh["MapboxImageryProvider"]=Rs;Fh["MapMode2D"]=Ls;Fh["Material"]=Ns;Fh["MaterialAppearance"]=ks;Fh["Model"]=Fs;Fh["ModelAnimation"]=Bs;Fh["ModelAnimationCache"]=Us;Fh["ModelAnimationCollection"]=Vs;Fh["ModelAnimationLoop"]=zs;Fh["ModelAnimationState"]=qs;Fh["ModelInstance"]=Gs;Fh["ModelInstanceCollection"]=Hs;Fh["ModelMaterial"]=js;Fh["ModelMesh"]=Ws;Fh["ModelNode"]=Ys;Fh["Moon"]=Xs;Fh["NeverTileDiscardPolicy"]=Qs;Fh["OIT"]=Zs;Fh["Particle"]=Ks;Fh["ParticleBurst"]=Js;Fh["ParticleEmitter"]=$s;Fh["ParticleSystem"]=el;Fh["PerformanceDisplay"]=tl;Fh["PerInstanceColorAppearance"]=rl;Fh["PickDepth"]=il;Fh["PointCloud3DTileContent"]=nl;Fh["PointPrimitive"]=al;Fh["PointPrimitiveCollection"]=ol;Fh["Polyline"]=sl;Fh["PolylineCollection"]=ll;Fh["PolylineColorAppearance"]=ul;Fh["PolylineMaterialAppearance"]=cl;Fh["Primitive"]=dl;Fh["PrimitiveCollection"]=fl;Fh["PrimitivePipeline"]=hl;Fh["PrimitiveState"]=pl;Fh["QuadtreeOccluders"]=ml;Fh["QuadtreePrimitive"]=vl;Fh["QuadtreeTile"]=gl;Fh["QuadtreeTileLoadState"]=_l;Fh["QuadtreeTileProvider"]=yl;Fh["Scene"]=bl;Fh["SceneMode"]=wl;Fh["SceneTransforms"]=Cl;Fh["SceneTransitioner"]=Sl;Fh["ScreenSpaceCameraController"]=Tl;Fh["ShadowMap"]=El;Fh["ShadowMapShader"]=xl;Fh["ShadowMode"]=Pl;Fh["SingleTileImageryProvider"]=Al;Fh["SkyAtmosphere"]=Ol;Fh["SkyBox"]=Dl;Fh["SphereEmitter"]=Il;Fh["StencilFunction"]=Ml;Fh["StencilOperation"]=Rl;Fh["StyleExpression"]=Ll;Fh["Sun"]=Nl;Fh["SunPostProcess"]=kl;Fh["TerrainState"]=Fl;Fh["TextureAtlas"]=Bl;Fh["TileBoundingRegion"]=Ul;Fh["TileBoundingSphere"]=Vl;Fh["TileBoundingVolume"]=zl;Fh["TileCoordinatesImageryProvider"]=ql;Fh["TileDiscardPolicy"]=Gl;Fh["TileImagery"]=Hl;Fh["TileOrientedBoundingBox"]=jl;Fh["TileReplacementQueue"]=Wl;Fh["Tileset3DTileContent"]=Yl;Fh["TileState"]=Xl;Fh["TileTerrain"]=Ql;Fh["TimeDynamicImagery"]=Zl;Fh["TweenCollection"]=Kl;Fh["UrlTemplateImageryProvider"]=Jl;Fh["VerticalOrigin"]=$l;Fh["ViewportQuad"]=eu;Fh["WebMapServiceImageryProvider"]=tu;Fh["WebMapTileServiceImageryProvider"]=ru;Fh._shaders["AdjustTranslucentFS"]=iu;Fh._shaders["AllMaterialAppearanceFS"]=nu;Fh._shaders["AllMaterialAppearanceVS"]=au;Fh._shaders["BasicMaterialAppearanceFS"]=ou;Fh._shaders["BasicMaterialAppearanceVS"]=su;Fh._shaders["EllipsoidSurfaceAppearanceFS"]=lu;Fh._shaders["EllipsoidSurfaceAppearanceVS"]=uu;Fh._shaders["PerInstanceColorAppearanceFS"]=cu;Fh._shaders["PerInstanceColorAppearanceVS"]=du;Fh._shaders["PerInstanceFlatColorAppearanceFS"]=fu;Fh._shaders["PerInstanceFlatColorAppearanceVS"]=hu;Fh._shaders["PolylineColorAppearanceVS"]=pu;Fh._shaders["PolylineMaterialAppearanceVS"]=mu;Fh._shaders["TexturedMaterialAppearanceFS"]=vu;Fh._shaders["TexturedMaterialAppearanceVS"]=gu;Fh._shaders["BillboardCollectionFS"]=_u;Fh._shaders["BillboardCollectionVS"]=yu;Fh._shaders["BrdfLutGeneratorFS"]=bu;Fh._shaders["degreesPerRadian"]=wu;Fh._shaders["depthRange"]=Cu;Fh._shaders["epsilon1"]=Su;Fh._shaders["epsilon2"]=Tu;Fh._shaders["epsilon3"]=Eu;Fh._shaders["epsilon4"]=xu;Fh._shaders["epsilon5"]=Pu;Fh._shaders["epsilon6"]=Au;Fh._shaders["epsilon7"]=Ou;Fh._shaders["infinity"]=Du;Fh._shaders["oneOverPi"]=Iu;Fh._shaders["oneOverTwoPi"]=Mu;Fh._shaders["passCesium3DTile"]=Ru;Fh._shaders["passCompute"]=Lu;Fh._shaders["passEnvironment"]=Nu;Fh._shaders["passGlobe"]=ku;Fh._shaders["passGround"]=Fu;Fh._shaders["passOpaque"]=Bu;Fh._shaders["passOverlay"]=Uu;Fh._shaders["passTranslucent"]=Vu;Fh._shaders["pi"]=zu;Fh._shaders["piOverFour"]=qu;Fh._shaders["piOverSix"]=Gu;Fh._shaders["piOverThree"]=Hu;Fh._shaders["piOverTwo"]=ju;Fh._shaders["radiansPerDegree"]=Wu;Fh._shaders["sceneMode2D"]=Yu;Fh._shaders["sceneMode3D"]=Xu;Fh._shaders["sceneModeColumbusView"]=Qu;Fh._shaders["sceneModeMorphing"]=Zu;Fh._shaders["solarRadius"]=Ku;Fh._shaders["threePiOver2"]=Ju;Fh._shaders["twoPi"]=$u;Fh._shaders["webMercatorMaxLatitude"]=ec;Fh._shaders["CzmBuiltins"]=tc;Fh._shaders["alphaWeight"]=rc;Fh._shaders["antialias"]=ic;Fh._shaders["cascadeColor"]=nc;Fh._shaders["cascadeDistance"]=ac;Fh._shaders["cascadeMatrix"]=oc;Fh._shaders["cascadeWeights"]=sc;Fh._shaders["columbusViewMorph"]=lc;Fh._shaders["computePosition"]=uc;Fh._shaders["cosineAndSine"]=cc;Fh._shaders["decompressTextureCoordinates"]=dc;Fh._shaders["eastNorthUpToEyeCoordinates"]=fc;Fh._shaders["ellipsoidContainsPoint"]=hc;Fh._shaders["ellipsoidNew"]=pc;Fh._shaders["ellipsoidWgs84TextureCoordinates"]=mc;Fh._shaders["equalsEpsilon"]=vc;Fh._shaders["eyeOffset"]=gc;Fh._shaders["eyeToWindowCoordinates"]=_c;Fh._shaders["fog"]=yc;Fh._shaders["geodeticSurfaceNormal"]=bc;Fh._shaders["getDefaultMaterial"]=wc;Fh._shaders["getLambertDiffuse"]=Cc;Fh._shaders["getSpecular"]=Sc;Fh._shaders["getWaterNoise"]=Tc;Fh._shaders["getWgs84EllipsoidEC"]=Ec;Fh._shaders["HSBToRGB"]=xc;Fh._shaders["HSLToRGB"]=Pc;Fh._shaders["hue"]=Ac;Fh._shaders["isEmpty"]=Oc;Fh._shaders["isFull"]=Dc;Fh._shaders["latitudeToWebMercatorFraction"]=Ic;Fh._shaders["luminance"]=Mc;Fh._shaders["metersPerPixel"]=Rc;Fh._shaders["modelToWindowCoordinates"]=Lc;Fh._shaders["multiplyWithColorBalance"]=Nc;Fh._shaders["nearFarScalar"]=kc;Fh._shaders["octDecode"]=Fc;Fh._shaders["packDepth"]=Bc;Fh._shaders["phong"]=Uc;Fh._shaders["pointAlongRay"]=Vc;Fh._shaders["rayEllipsoidIntersectionInterval"]=zc;Fh._shaders["RGBToHSB"]=qc;Fh._shaders["RGBToHSL"]=Gc;Fh._shaders["RGBToXYZ"]=Hc;Fh._shaders["saturation"]=jc;Fh._shaders["shadowDepthCompare"]=Wc;Fh._shaders["shadowVisibility"]=Yc;Fh._shaders["signNotZero"]=Xc;Fh._shaders["tangentToEyeSpaceMatrix"]=Qc;Fh._shaders["translateRelativeToEye"]=Zc;Fh._shaders["translucentPhong"]=Kc;Fh._shaders["transpose"]=Jc;Fh._shaders["unpackDepth"]=$c;Fh._shaders["windowToEyeCoordinates"]=ed;Fh._shaders["XYZToRGB"]=td;Fh._shaders["depthRangeStruct"]=rd;Fh._shaders["ellipsoid"]=id;Fh._shaders["material"]=nd;Fh._shaders["materialInput"]=ad;Fh._shaders["ray"]=od;Fh._shaders["raySegment"]=sd;Fh._shaders["shadowParameters"]=ld;Fh._shaders["CompositeOITFS"]=ud;Fh._shaders["DepthPlaneFS"]=cd;Fh._shaders["DepthPlaneVS"]=dd;Fh._shaders["EllipsoidFS"]=fd;Fh._shaders["EllipsoidVS"]=hd;Fh._shaders["GlobeFS"]=pd;Fh._shaders["GlobeVS"]=md;Fh._shaders["GroundAtmosphere"]=vd;Fh._shaders["BumpMapMaterial"]=gd;Fh._shaders["CheckerboardMaterial"]=_d;Fh._shaders["DotMaterial"]=yd;Fh._shaders["FadeMaterial"]=bd;Fh._shaders["GridMaterial"]=wd;Fh._shaders["NormalMapMaterial"]=Cd;Fh._shaders["PolylineArrowMaterial"]=Sd;Fh._shaders["PolylineDashMaterial"]=Td;Fh._shaders["PolylineGlowMaterial"]=Ed;Fh._shaders["PolylineOutlineMaterial"]=xd;Fh._shaders["RimLightingMaterial"]=Pd;Fh._shaders["StripeMaterial"]=Ad;Fh._shaders["Water"]=Od;Fh._shaders["PointPrimitiveCollectionFS"]=Dd;Fh._shaders["PointPrimitiveCollectionVS"]=Id;Fh._shaders["PolylineCommon"]=Md;Fh._shaders["PolylineFS"]=Rd;Fh._shaders["PolylineVS"]=Ld;Fh._shaders["AdditiveBlend"]=Nd;Fh._shaders["BrightPass"]=kd;Fh._shaders["FXAA"]=Fd;Fh._shaders["GaussianBlur1D"]=Bd;Fh._shaders["PassThrough"]=Ud;Fh._shaders["ReprojectWebMercatorFS"]=Vd;Fh._shaders["ReprojectWebMercatorVS"]=zd;Fh._shaders["ShadowVolumeFS"]=qd;Fh._shaders["ShadowVolumeVS"]=Gd;Fh._shaders["SkyAtmosphereFS"]=Hd;Fh._shaders["SkyAtmosphereVS"]=jd;Fh._shaders["SkyBoxFS"]=Wd;Fh._shaders["SkyBoxVS"]=Yd;Fh._shaders["SunFS"]=Xd;Fh._shaders["SunTextureFS"]=Qd;Fh._shaders["SunVS"]=Zd;Fh._shaders["ViewportQuadFS"]=Kd;Fh._shaders["ViewportQuadVS"]=Jd;Fh["Autolinker"]=$d;Fh["crunch"]=ef;Fh["earcut-2.1.1"]=tf;Fh["addDefaults"]=rf;Fh["addExtensionsRequired"]=nf;Fh["addExtensionsUsed"]=af;Fh["addPipelineExtras"]=of;Fh["addToArray"]=sf;Fh["byteLengthForComponentType"]=lf;Fh["findAccessorMinMax"]=uf;Fh["ForEach"]=cf;Fh["getAccessorByteStride"]=df;Fh["getJointCountForMaterials"]=ff;Fh["getUniqueId"]=hf;Fh["glslTypeToWebGLConstant"]=pf;Fh["numberOfComponentsForType"]=mf;Fh["parseBinaryGltf"]=vf;Fh["processModelMaterialsCommon"]=gf;Fh["processPbrMetallicRoughness"]=_f;Fh["removeExtensionsRequired"]=yf;Fh["removeExtensionsUsed"]=bf;Fh["removePipelineExtras"]=wf;Fh["techniqueParameterForSemantic"]=Cf;Fh["updateVersion"]=Sf;Fh["webGLConstantToGlslType"]=Tf;Fh["google-earth-dbroot-parser"]=Ef;Fh["jsep"]=xf;Fh["kdbush"]=Pf;Fh["knockout-3.4.0"]=Af;Fh["knockout-es5"]=Of;Fh["knockout"]=Df;Fh["measureText"]=If;Fh["mersenne-twister"]=Mf;Fh["NoSleep"]=Rf;Fh["pako_inflate"]=Lf;Fh["protobuf-minimal"]=Nf;Fh["FXAA3_11"]=kf;Fh["sprintf"]=Ff;Fh["topojson"]=Bf;Fh["Tween"]=Uf;Fh["Uri"]=Vf;Fh["when"]=zf;Fh["zip"]=qf;Fh["Animation"]=Gf;Fh["AnimationViewModel"]=Hf;Fh["BaseLayerPicker"]=jf;Fh["BaseLayerPickerViewModel"]=Wf;Fh["createDefaultImageryProviderViewModels"]=Yf;Fh["createDefaultTerrainProviderViewModels"]=Xf;Fh["ProviderViewModel"]=Qf;Fh["Cesium3DTilesInspector"]=Zf;Fh["Cesium3DTilesInspectorViewModel"]=Kf;Fh["CesiumInspector"]=Jf;Fh["CesiumInspectorViewModel"]=$f;Fh["CesiumWidget"]=eh;Fh["ClockViewModel"]=th;Fh["Command"]=rh;Fh["createCommand"]=ih;Fh["FullscreenButton"]=nh;Fh["FullscreenButtonViewModel"]=ah;Fh["Geocoder"]=oh;Fh["GeocoderViewModel"]=sh;Fh["getElement"]=lh;Fh["HomeButton"]=uh;Fh["HomeButtonViewModel"]=ch;Fh["InfoBox"]=dh;Fh["InfoBoxViewModel"]=fh;Fh["NavigationHelpButton"]=hh;Fh["NavigationHelpButtonViewModel"]=ph;Fh["PerformanceWatchdog"]=mh;Fh["PerformanceWatchdogViewModel"]=vh;Fh["ProjectionPicker"]=gh;Fh["ProjectionPickerViewModel"]=_h;Fh["SceneModePicker"]=yh;Fh["SceneModePickerViewModel"]=bh;Fh["SelectionIndicator"]=wh;Fh["SelectionIndicatorViewModel"]=Ch;Fh["subscribeAndEvaluate"]=Sh;Fh["SvgPathBindingHandler"]=Th;Fh["Timeline"]=Eh;Fh["TimelineHighlightRange"]=xh;Fh["TimelineTrack"]=Ph;Fh["ToggleButtonViewModel"]=Ah;Fh["Viewer"]=Oh;Fh["viewerCesium3DTilesInspectorMixin"]=Dh;Fh["viewerCesiumInspectorMixin"]=Ih;Fh["viewerDragDropMixin"]=Mh;Fh["viewerPerformanceWatchdogMixin"]=Rh;Fh["VRButton"]=Lh;Fh["VRButtonViewModel"]=Nh;Fh["createTaskProcessorWorker"]=kh;return Fh});require(["Cesium"],function(e){"use strict";var t=typeof window!=="undefined"?window:typeof self!=="undefined"?self:{};t.Cesium=e},undefined,true)})();var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};function C3D(e,t){var r=t;var i=viewer.scene.primitives.add(new Cesium.Cesium3DTileset({url:e,maximumScreenSpaceError:isMobile.any()?8:1,maximumNumberOfLoadedTiles:isMobile.any()?10:1e3}));i.readyPromise.then(function(e){var t=e.boundingSphere;var i=Cesium.Cartographic.fromCartesian(t.center);var n=Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,0);var a=Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,r);var o=Cesium.Cartesian3.subtract(a,n,new Cesium.Cartesian3);e.modelMatrix=Cesium.Matrix4.fromTranslation(o);console.log(e.modelMatrix)})}